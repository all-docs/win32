<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Installing the Provider</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Installing the Provider
description: The procedure for installing the DNS WMI Provider differs based on the version of Windows on which it is installed.
ms.assetid: 5f2bd11a-bc1d-4a43-92d4-26392d2504e7
keywords:</p>
<ul>
<li>Domain Name System, WMI provider, installing
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Installing the Provider</h1>
<p>The procedure for installing the DNS WMI Provider differs based on the version of Windows on which it is installed. The following procedure describes how to install and set up the DNS WMI Provider on WindowsÂ 2000. To obtain the DNS WMI Provider for WindowsÂ 2000, download the following file:</p>
<p><strong>WARNING:</strong> DNS WMI Provider files are not interchangeable. WindowsÂ 2000 DNS Servers require different files and a different procedure than Windows ServerÂ 2003 DNS Servers. The procedure for each is provided.</p>
<p><strong>To install the DNS WMI Provider on Windows 2000 Server</strong></p>
<ol>
<li>
<p>Obtain the DNS WMI Provider for WindowsÂ 2000 from the WindowsÂ 2000 Server Resource Kit, or download the file, Dnsprov.zip, from: <a href="ftp://ftp.microsoft.com/reskit/win2000/">ftp://ftp.microsoft.com/reskit/win2000/</a></p>
</li>
<li>
<p>Copy the DNS WMI Provider (Dnsprov.dll) and Dnsschema.mof files to the &lt;winntdir&gt;\system32\wbem directory.</p>
</li>
<li>
<p>Compile the MOF file. Doing so customizes the schema to match the server.</p>
<p><strong>mofcomp dnsschema.mof</strong></p>
</li>
<li>
<p>Register the DLL on the DNS Server.</p>
<p><strong>regsvr32 dnsprov.dll</strong></p>
</li>
<li>
<p>Scripts or programs that use the DNS WMI Provider to manage DNS Servers can then be used. The scripts or programs can be run from either the DNS Server, or from a client computer.</p>
<blockquote>
<p>[!Note]<br />
The WMI SDK is not required to run the DNS WMI Provider, but it contains many useful tools.</p>
</blockquote>
<p>Â </p>
</li>
</ol>
<p>The DNS WMI Provider must be installed on any DNS Server to be managed; the DNS scripts, however, can be run on the DNS Server or on a remote host.</p>
<p><strong>To install the DNS WMI Provider on Windows Server 2003</strong></p>
<ul>
<li>For Windows ServerÂ 2003 operating systems, the DNS WMI Provider is automatically installed and registered, and its MOF file is compiled when the DNS Server service is installed.</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
