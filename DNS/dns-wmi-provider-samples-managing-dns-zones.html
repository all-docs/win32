<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DNS WMI Provider Samplesâ€”Managing DNS Zones</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: DNS WMI Provider Samplesâ€”Managing DNS Zones
description: DNS WMI Provider Samplesâ€”Managing DNS Zones
ms.assetid: 12958b71-b47d-4dd7-bd08-409ecd369e4f
keywords:</p>
<ul>
<li>DNS WMI Provider Samples 8212;Managing DNS Zones
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>DNS WMI Provider Samplesâ€”Managing DNS Zones</h1>
<p>This section demonstrates scripting tasks associated with managing DNS zones. The following links link to subroutines in the script file.</p>
<ul>
<li><a href="#create-a-dns-zone">Create a DNS zone</a></li>
<li><a href="#modify-a-dns-zone">Modify a DNS zone</a></li>
<li><a href="#delete-a-dns-zone">Delete a DNS zone</a></li>
<li><a href="#add-a-zone-ip-address">Add a zone IP address</a></li>
<li><a href="#delete-a-zone-ip-address">Delete a zone IP address</a></li>
<li><a href="#pause-a-zone">Pause a zone</a></li>
<li><a href="#resume-a-zone">Resume a zone</a></li>
<li><a href="#update-a-zone">Update a zone</a></li>
<li><a href="#reload-a-zone">Reload a zone</a></li>
<li><a href="#refresh-a-zone">Refresh a zone</a></li>
</ul>
<pre lang="VB"><code>'***********************************************************
'*
'*  File:           DnsZones.vbs
'*
'*  Main Function:  Gets and sets DNS Zone information for a computer.
'*
'********************************************************************

OPTION EXPLICIT

    'Define constants
    CONST CONST_ERROR                   = 0
    CONST CONST_WSCRIPT                 = 1
    CONST CONST_CSCRIPT                 = 2
    CONST CONST_SHOW_USAGE              = 3
    CONST CONST_DISPLAY                 = 4
    CONST CONST_LIST                    = 5
    CONST CONST_CREATE                  = 6
    CONST CONST_MODIFY                  = 7
    CONST CONST_DELETE                  = 8
    CONST CONST_ADDIP                   = 9
    CONST CONST_DELETEIP                = 10
    CONST CONST_PAUSE                   = 11
    CONST CONST_RESUME                  = 12
    CONST CONST_WRITE                   = 13
    CONST CONST_UPDATE                  = 14
    CONST CONST_RELOAD                  = 15
    CONST CONST_REFRESH                 = 16
    
    ' Declare variables.
    Dim intOpMode, i
    Dim strServer, strUserName, strPassword, strOutputFile
    Dim strPropertyArray(), strValueArray(), strZoneArray()
    Dim blnContextHelp
    
    ' Ensure that the host is script, if not then abort.
    VerifyHostIsCscript()

    ' Parse the command line.
    intOpMode = intParseCmdLine(strServer        , _
                                strUserName      , _
                                strPassword      , _
                                strOutputFile    , _
                                strPropertyArray , _
                                strValueArray    , _
                                strZoneArray     , _
                                blnContextHelp     )

    Select Case intOpMode

        Case CONST_SHOW_USAGE
            Call ShowUsage()

        Case CONST_DISPLAY
            Call Display(strOutputFile, blnContextHelp)

        Case CONST_LIST
            Call DnsZoneList(strServer        , _
                             strUserName      , _
                             strPassword      , _
                             strOutputFile    , _
                             strPropertyArray , _
                             blnContextHelp     )

        Case CONST_CREATE
            Call DnsCreate(strServer        , _
                           strUserName      , _
                           strPassword      , _
                           strOutputFile    , _
                           strPropertyArray , _
                           blnContextHelp     )

        Case CONST_MODIFY
            Call DnsModify(strServer        , _
                           strUserName      , _
                           strPassword      , _
                           strOutputFile    , _
                           strPropertyArray , _
                           strValueArray    , _
                           strZoneArray     , _
                           blnContextHelp     )

        Case CONST_DELETE
            Call DnsDelete(strServer        , _
                           strUserName      , _
                           strPassword      , _
                           strOutputFile    , _
                           strPropertyArray , _
                           blnContextHelp     )

        Case CONST_ADDIP
            Call DnsADDIP(strServer        , _
                          strUserName      , _
                          strPassword      , _
                          strOutputFile    , _
                          strZoneArray     , _
                          strPropertyArray , _
                          strValueArray    , _
                          blnContextHelp     )

        Case CONST_DELETEIP
            Call DnsDELETEIP(strServer        , _
                             strUserName      , _
                             strPassword      , _
                             strOutputFile    , _
                             strZoneArray     , _
                             strPropertyArray , _
                             strValueArray    , _
                             blnContextHelp     )
        Case CONST_PAUSE
            Call DnsPause(strServer     , _
                          strUserName   , _
                          strPassword   , _
                          strOutputFile , _
                          strZoneArray  , _
                          blnContextHelp  )

        Case CONST_RESUME
            Call DnsResume(strServer     , _
                           strUserName   , _
                           strPassword   , _
                           strOutputFile , _
                           strZoneArray  , _
                           blnContextHelp  )

        Case CONST_WRITE
            Call DnsWrite(strServer     , _
                          strUserName   , _
                          strPassword   , _
                          strOutputFile , _
                          strZoneArray  , _
                          blnContextHelp  )

        Case CONST_UPDATE
            Call DnsUpdate(strServer     , _
                           strUserName   , _
                           strPassword   , _
                           strOutputFile , _
                           strZoneArray  , _
                           blnContextHelp  )

        Case CONST_RELOAD
            Call DnsReload(strServer     , _
                           strUserName   , _
                           strPassword   , _
                           strOutputFile , _
                           strZoneArray  , _
                           blnContextHelp  )

        Case CONST_REFRESH
            Call DnsRefresh(strServer     , _
                            strUserName   , _
                            strPassword   , _
                            strOutputFile , _
                            strZoneArray  , _
                            blnContextHelp  )

        Case CONST_ERROR
            Call Wscript.Echo(&quot;Error occurred in passing parameters.&quot;)

        Case Else                    ' Default - should never occur.
            Call Wscript.Echo(&quot;Error occurred in passing parameters.&quot;)

    End Select

'********************************************************************
'* End of Script
'********************************************************************

'********************************************************************
'*
'* Sub DnsZoneList()
'*
'* Purpose: Lists the value of all server properties.
'*
'* Input:   strServer           A server name
'*          strUserName         The current user name
'*          strPassword         The current user password
'*          strOutputFile       An output file name
'*          strPropertyArray    An array of zone properties
'*          blnContextHelp      Show context sensitve Help
'*
'* Output:  Results are either printed on screen or saved in 
'*          strOutputFile.
'*
'********************************************************************

Sub DnsZoneList(strServer        , _
                strUserName      , _
                strPassword      , _
                strOutputFile    , _
                strPropertyArray , _
                blnContextHelp     )


    ON ERROR RESUME NEXT

    Dim objFileSystem, objOutputFile, objService, objDNS, objInst
    Dim objServer, strMessage
    
    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Displays the current Zone settings.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo &quot;  DnsZones List [zonename] [/S &lt;server&gt;]&quot;
        Wscript.Echo &quot;                [/U &lt;username&gt;] [/W &lt;password&gt;]&quot;
        Wscript.Echo &quot;                [/O &lt;outputfile&gt;]&quot;
                Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   server        A server name&quot;
        Wscript.Echo &quot;   username      The current user name&quot;
        Wscript.Echo &quot;   password      The current user password&quot;
        Wscript.Echo &quot;   outputfile    The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;1.  DnsZones.vbs List&quot;
        Wscript.Echo &quot;    Displays a list of all zones.&quot;
        Wscript.Echo &quot;2.  DnsZones.vbs List example.com&quot;
        Wscript.Echo &quot;    Displays details on example.com.&quot;
        Wscript.Echo &quot;&quot;
        Exit Sub
    End If

    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    ' Establish a connection with the server.
    If blnConnect(&quot;root\microsoftdns&quot; , _
                   strUserName , _
                   strPassword , _
                   strServer   , _
                   objService  ) Then
        Call Wscript.Echo(&quot;&quot;)
        Call Wscript.Echo(&quot;Verify the server name, credentials and WBEM Core.&quot;)
        Exit Sub
    End If

    If IsEmpty(strPropertyArray(0)) then

        Set objDNS = objService.InstancesOf(&quot;MicrosoftDNS_Zone&quot;)
        If blnErrorOccurred(&quot;DNS Server not available.&quot;) then Exit Sub


        If objDNS.Count = 0 Then
          Call Wscript.Echo(&quot;No zones are available.&quot;)
          Exit Sub
        End If

        Call Wscript.Echo(&quot;Zones on Server &quot; &amp; strServer)
        Call Wscript.Echo(&quot;&quot;)

        strMessage = strPackString(&quot;Zone Name&quot;, 40, True, True)
        strMessage = strMessage + strPackString(&quot;Type&quot;, 10, True, True)
        strMessage = strMessage + strPackString(&quot;Revers&quot;, 10, True, True)
        strMessage = strMessage + strPackString(&quot;Pause&quot;, 10, True, True)
        strMessage = strMessage + strPackString(&quot;ShutDown&quot;, 10, True, True)
        Call WriteLine(strMessage, objOutputFile)

        For Each objInst In objDNS
            strMessage = strPackString(objInst.ContainerName, 40, True, True)
            strMessage = strMessage + strPackString(objInst.ZoneType,10, True, True)
            strMessage = strMessage + strPackString(objInst.Reverse, 10, True, True)
            strMessage = strMessage + strPackString(objInst.Paused, 10, True, True)
            strMessage = strMessage + strPackString(objInst.Shutdown, 10, True, True)
            Call WriteLine(strMessage, objOutputFile)

            Call WriteLine(&quot;&quot;, objOutputFile)
        Next
    Else
        set objServer = objService.Get (&quot;MicrosoftDNS_Server.name=&quot;&quot;.&quot;&quot;&quot;)
        Set objDNS = objService.Get( _ 
        &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; &amp; strPropertyArray(0) _
        &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; &amp; objServer.Name &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; _
        &amp; strPropertyArray(0) &amp; &quot;&quot;&quot;&quot;)
        If blnErrorOccurred(&quot;Zone not available.&quot;) then Exit Sub
        Call WriteLine(&quot;  Settings for Zone &quot; &amp; _ 
        strDisplayNull(objDns.ContainerName) &amp; &quot; on server &quot; _
        &amp; objServer.Name &amp; &quot;.&quot;, objOutputFile)
        Call WriteLine(&quot;&quot;, objOutputFile)
        Call WriteLine(&quot;AllowUpdate       : &quot; &amp; strDisplayNull(objDns.AllowUpdate), objOutputFile)
        Call WriteLine(&quot;AutoCreated       : &quot; &amp; strDisplayNull(objDns.AutoCreated), objOutputFile)
        Call WriteLine(&quot;DataFile          : &quot; &amp; strDisplayNull(objDns.DataFile), objOutputFile)
        Call WriteLine(&quot;DisableWins       : &quot; &amp; strDisplayNull(objDns.DisableWINSRecordReplication), _
        objOutputFile)
        Call WriteLine(&quot;Notify            : &quot; &amp; strDisplayNull(objDns.Notify), objOutputFile)
        Call WriteLine(&quot;Paused            : &quot; &amp; strDisplayNull(objDns.Paused), objOutputFile)
        Call WriteLine(&quot;Reverse           : &quot; &amp; strDisplayNull(objDns.Reverse), objOutputFile)
        Call WriteLine(&quot;SecureSecondaries : &quot; &amp; strDisplayNull(objDns.SecureSecondaries), objOutputFile)
        Call WriteLine(&quot;Shutdown          : &quot; &amp; strDisplayNull(objDns.Shutdown), objOutputFile)
        Call WriteLine(&quot;UseWins           : &quot; &amp; strDisplayNull(objDns.UseWins), objOutputFile)
        Call WriteLine(&quot;ZoneType          : &quot; &amp; strDisplayNull(objDns.ZoneType), objOutputFile)
        If IsNull(objDns.MastersIPAddressesArray) then
            Call WriteLine(&quot;MastersIPArray    : &lt;NULL&gt;&quot;, _
            objOutputFile)
        Else
            Call WriteLine(&quot;MastersIPArray    :&quot;, objOutputFile)
            For I = lbound(objDns.MastersIPAddressesArray) _
            to ubound(objDns.MastersIPAddressesArray)
                Call WriteLine(&quot;                    &quot; _
                &amp; objDns.MastersIPAddressesArray(I), objOutputFile)
            Next
        End If
        If IsNull(objDns.NotifyIPAddressesArray) then
            Call WriteLine(&quot;NotifyIPArray     : &lt;NULL&gt;&quot;, objOutputFile)
        Else
            Call WriteLine(&quot;NotifyIPArray     :&quot;, objOutputFile)
            For I = lbound(objDns.NotifyIPAddressesArray) _
            to ubound(objDns.NotifyIPAddressesArray)
                Call WriteLine(&quot;                    &quot; _
                &amp; objDns.NotifyIPAddressesArray(I), objOutputFile)
            Next
        End If
        If IsNull(objDns.SecondariesIPAddressesArray) then
            Call WriteLine(&quot;SecondariesIPArray: &lt;NULL&gt;&quot;, _
            objOutputFile)
        Else
            Call WriteLine(&quot;SecondariesIPArray:&quot;, objOutputFile)
            For I = lbound(objDns.SecondariesIPAddressesArray) _
            to ubound(objDns.SecondariesIPAddressesArray)
                Call WriteLine(&quot;                    &quot; _ 
                &amp; objDns.SecondariesIPAddressesArray(I), _
                objOutputFile)
            Next
        End If
        Call WriteLine(&quot;&quot;, objOutputFile)
    End If

    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; &amp; strOutputFile &amp; &quot;.&quot;)
    End If

End Sub          
</code></pre>
<h2>Create a DNS Zone</h2>
<pre lang="VB"><code>'***********************************************************
'*
'* Sub DnsCreate()
'*
'* Purpose: Creates a Zone.
'*
'* Input:   strServer           A server name
'*          strOutputFile       An output file name
'*          strUserName         The current user name
'*          strPassword         The current user password
'*          intServiceTask      The task to perform
'*
'* Output:  Results are either printed on screen or saved in 
'*          strOutputFile.
'*
'********************************************************************

Private Sub DnsCreate(strServer        , _
                      strUserName      , _
                      strPassword      , _
                      strOutputFile    , _
                      strPropertyArray , _
                      blnContextHelp     )

    ON ERROR RESUME NEXT

    Dim objFileSystem, objOutputFile, objService, objDnsSet
    Dim  objServer, objInst, strTempArray(0)

    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Creates a Zone.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo _ 
        &quot;  DnsZones Create [ Primary | Secondary | DSIntegrated]&quot;
        Wscript.Echo &quot;                  [ Forward | Reverse ]&quot;
        Wscript.Echo &quot;                  [ &lt;ZoneName&gt; ] &quot; _
        &amp; &quot;[ &lt;MasterIPAddress&gt;]&quot;
        Wscript.Echo &quot;               [ &lt;filename&gt; ] [/S &lt;server&gt;] &quot; _
        &amp; &quot;[/U &lt;username&gt;]&quot;
        Wscript.Echo &quot;             [/W &lt;password&gt;] [/O &lt;outputfile&gt;]&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   ZoneName         The name of the Zone to &quot; _
        &amp; &quot;Create.&quot;
        Wscript.Echo &quot;   MasterIPAddress  The address of the &quot; _
        &amp; &quot;primary Dns Server&quot;
        Wscript.Echo &quot;                    (Only required for &quot; _
        &amp; &quot;Secondary Zones)&quot;
        Wscript.Echo &quot;   filename         The Zone File name to use&quot;
        Wscript.Echo &quot;                    (This is only required &quot; _
        &amp; &quot;when creating&quot;
        Wscript.Echo &quot;                    a new zone from an &quot; _
        &amp; &quot;existing file.)&quot;
        Wscript.Echo &quot;   server           A server name&quot;
        Wscript.Echo &quot;   username         The current user name&quot;
        Wscript.Echo &quot;   password         The current user password&quot;
        Wscript.Echo &quot;   outputfile       The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;1.  DnsZones Create Primary Forward &quot; _
        &amp; &quot;example.com  /S MyMachine2&quot;
        Wscript.Echo &quot; Creates a Primary Forward zone on &quot; _
        &amp; &quot;MyMachine2 called example.com.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;2.  DnsZones Create Secondary &quot; _
        &amp; &quot;Reverse 15.251.123.in-addr.arpa 157.55.254.212&quot;
        Wscript.Echo &quot;    Creates a Secondary Reverse.&quot;
        Exit Sub
    End If

    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    ' Establish a connection with the server.
    If blnConnect(&quot;root\microsoftdns&quot; , _
                   strUserName , _
                   strPassword , _
                   strServer   , _
                   objService  ) Then
        Call Wscript.Echo(&quot;&quot;)
        Call Wscript.Echo(&quot;Verify the server name, &quot; _
                        &amp; &quot;credentials and WBEM Core.&quot;)
        Exit Sub
    End If

    set objServer = objService.Get(&quot;MicrosoftDNS_Server.name=&quot;&quot;.&quot;&quot;&quot;)
    Set objDNSSet = objService.Get(&quot;MicrosoftDNS_ZONE&quot;)
    If blnErrorOccurred(&quot; DNS Server not available.&quot;) then Exit Sub

    Select Case strPropertyArray(0)
        Case 2
            strTempArray(0) = strPropertyArray(4)
            If IsEmpty(strPropertyArray(3)) Then
                ObjInst = objDNSSet.CreateZone(strPropertyArray(2), _
                strPropertyArray(0),,strTempArray)
            Else
                ObjInst = objDNSSet.CreateZone(strPropertyArray(2), _
                strPropertyArray(0), strPropertyArray(3),strTempArray)
            End If
        
        Case Else
            If IsEmpty(strPropertyArray(3)) Then
                ObjInst = objDNSSet.CreateZone(strPropertyArray(2), _
                strPropertyArray(0))
            Else
                ObjInst = objDNSSet.CreateZone(strPropertyArray(2), _
                strPropertyArray(0), strPropertyArray(3))
            End If

    
    End Select

    If blnErrorOccurred(&quot; DNS Zone not created.&quot;) then
        Exit Sub
    Else
        Call WriteLine(&quot;Operation successful.&quot;, objOutputFile)
    End If

    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; _
        &amp; strOutputFile &amp; &quot;.&quot;)
    End If
    
End Sub
</code></pre>
<h2>Modify a DNS Zone</h2>
<pre lang="VB"><code>'***********************************************************
'*
'* Sub DnsModify()
'*
'* Purpose: Stops, starts, or restarts the DNS Server.
'*
'* Input:   strServer           A server name
'*          strOutputFile       An output file name
'*          strUserName         The current user name
'*          strPassword         The current user password
'*          strPropertyArray    The properties to change
'*          strValueArray       The new values
'*
'* Output:  Results are either printed on screen or saved in 
'*          strOutputFile.
'*
'********************************************************************

Private Sub DnsModify(strServer        , _
                      strUserName      , _
                      strPassword      , _
                      strOutputFile    , _
                      strPropertyArray , _
                      strValueArray    , _
                      strZoneArray     , _
                      blnContextHelp     )
                      
' ON ERROR RESUME NEXT
    Dim objFileSystem, objOutputFile, objService, objDnsSet, objServer
    Dim objInst, strTempArray(0), strZoneFile, strMastersIP(0), G
    Dim blnError, blnContinue

    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Modifies Dns Zone Properties.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo &quot;  DnsZones Modify &lt;ZoneName&gt; &lt;Property1&gt; &quot; _
        &amp; &quot;&lt;Value1&gt; [Modify &lt;ZoneName&gt; &lt;Property2&gt; &lt;Value2&gt;] [...]&quot;
        Wscript.Echo &quot;                [/S &lt;server&gt;]&quot;
        Wscript.Echo &quot;                [/U &lt;username&gt;] [/W &lt;password&gt;]&quot;
        Wscript.Echo &quot;                [/O &lt;outputfile&gt;]&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   server        A server name&quot;
        Wscript.Echo &quot;   username      The current user name&quot;
        Wscript.Echo &quot;   password      The current user password&quot;
        Wscript.Echo &quot;   outputfile    The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;  DnsZones.vbs Modify example.com ZoneType 1 &quot; _
        &amp; &quot;Modify example.com ZoneFile example.com.Dns&quot;
        Wscript.Echo &quot;  Changes the Zone Type to Primary using &quot; _
        &amp; &quot;example.com.Dns as the new Zone File.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;NOTE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;1.  Use the display command to see a list of &quot; _
        &amp; &quot;properties and descriptions.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;2.  If you are change a Zone from Primary to &quot; _
        &amp; &quot;Secondary you will need to&quot;
        Wscript.Echo &quot;    Specify a MastersIP address in one of &quot; _
        &amp; &quot;the properties.&quot;
        Exit Sub
    End If

    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    ' Establish a connection with the server.
    If blnConnect(&quot;root\microsoftdns&quot; , _
                   strUserName , _
                   strPassword , _
                   strServer   , _
                   objService  ) Then
        Call Wscript.Echo(&quot;&quot;)
        Call Wscript.Echo(&quot;Please verify the server name, &quot; _
                        &amp; &quot;credentials and WBEM Core.&quot;)
        Exit Sub
    End If

    set objServer = objService.Get(&quot;MicrosoftDNS_Server.name=&quot;&quot;.&quot;&quot;&quot;)
    ' Find ZoneType Changes
    For I = LBound(strZoneArray) to UBound(strZoneArray)
        If lcase(strPropertyArray(I)) = &quot;zonetype&quot; then
            Select Case strValueArray(I)
                Case 0
                    Set objDNSSet = objService.Get( _
                    &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; _
                    &amp; strZoneArray(i) &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; _ 
                    &amp; objServer.Name &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; _
                    &amp; strZoneArray(i) &amp; &quot;&quot;&quot;&quot;)
                    objInst = objDNSSet.ChangeZoneType(0)
                    strPropertyArray(I) = &quot;skip&quot;
                    Call WriteLine (&quot;Zone type has been changed to &quot; _
                    &amp; &quot;DS Intergrated.&quot;, objOutputFile)
                Case 1
                    For G = LBound(strZoneArray) to _
                    UBound(strZoneArray)
                        If lcase(strPropertyArray(G)) = _
                        &quot;zonefile&quot; then
                            blnContinue = True
                            strZoneFile = strValueArray(G)
                            strPropertyArray(G) = &quot;skip&quot;
                        End If
                    Next
                    If blnContinue = False then
                        Call WriteLine(&quot;In order to change the &quot; _
                        &amp; &quot;Zone Type to Primary you must specify a &quot; _
                        &amp; &quot;zonefile.&quot;, objOutputFile)
                        Exit Sub
                    End If
                    Set objDNSSet = objService.Get(_
                    &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; _
                     &amp; strZoneArray(i) &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; _
                     &amp; objServer.Name &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; _
                     &amp; strZoneArray(i) &amp; &quot;&quot;&quot;&quot;)
                    objInst = objDNSSet.ChangeZoneType(1,strZoneFile)
                    strPropertyArray(I) = &quot;skip&quot;
                    Call WriteLine (&quot;Zone type has been changed to Primary.&quot;, objOutputFile)
                Case 2
                    For G = Lbound(strZoneArray) _
                    to UBound(strZoneArray)
                        If lcase(strPropertyArray(G)) = _
                                                                                                        &quot;mastersip&quot; then
                            blnContinue = True
                            strMastersIP(0) = strValueArray(G)
                            strPropertyArray(G) = &quot;skip&quot;
                        End If
                    Next
                    If blnContinue = False then
                       Call WriteLine(&quot;To change the Zone &quot; _
                       &amp; &quot;Type to Secondary you must specify a &quot; _
                       &amp; &quot;Masters IP Address.&quot;, objOutputFile)
                       Exit Sub
                    End If
                    Set objDNSSet = objService.Get( _
                    &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; _
                    &amp; strZoneArray(i) &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; _
                    &amp; objServer.Name &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; _
                    &amp; strZoneArray(i) &amp; &quot;&quot;&quot;&quot;)
                    objInst = objDNSSet.ChangeZoneType(2,, _
                    strMastersIP)
                    strPropertyArray(I) = &quot;skip&quot;
                    Call WriteLine (&quot;Zone type has been changed to &quot; _
                    &amp; &quot;secondary.&quot;, objOutputFile)
            End Select
        End If
    Next
    For I = LBound(strZoneArray) to UBound(strZoneArray)
        If Not IsEmpty(strZoneArray(i)) then
            Set objDNSSet = objService.Get( _
            &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; &amp; strZoneArray(i) _
            &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; &amp; objServer.Name _
            &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; &amp; strZoneArray(i) &amp; &quot;&quot;&quot;&quot;)
            If blnErrorOccurred(&quot; DNS Server not available.&quot;) _
            then Exit Sub

            If Not IsEmpty(strPropertyArray(I)) then
                blnError = False
                Select Case lcase(strPropertyArray(I))
                    Case &quot;allowupdate&quot;
                        objDNSSet.AllowUpdate = strValueArray(I)
                        objDNSSet.Put_
                    Case &quot;disablewins&quot;
                        objDNSSet.DisableWins = strValueArray(I)
                        objDNSSet.Put_
                    Case &quot;notify&quot;
                        objDNSSet.Notify = strValueArray(I)
                        objDNSSet.Put_
                    Case &quot;reverse&quot;
                        objDNSSet.Reverse = strValueArray(I)
                        objDNSSet.Put_
                    Case &quot;securesecondaries&quot;
                        objDNSSet.SecureSecondaries = strValueArray(I)
                        objDNSSet.Put_
                    Case &quot;mastersip&quot;
                        strTempArray(0) = strValueArray(I)
                        objDnsSet.MastersIPAddressesArray = _
                        strTempArray
                        objDNSSet.Put_
                    Case &quot;skip&quot;
                        'Do Nothing
                    Case Else
                        blnError = True
                        Call WriteLine(strPropertyArray(I) _
                        &amp; &quot; is not valid.&quot;, objOutputFile)
                End Select
            End If
            
            If blnError = False then
                If strPropertyArray(I) &lt;&gt; &quot;skip&quot; then
                    Call WriteLine(strPropertyArray(I) _
                    &amp; &quot; updated.&quot;, objOutputFile)
                End If
            End If
        End If
    Next

    If blnErrorOccurred(&quot;Zone properties not updated.&quot;) then
        Exit Sub
    Else
        Call WriteLine(&quot;Zone properties are now updated.&quot;, objOutputFile)
    End If
        
    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; &amp; strOutputFile &amp; &quot;.&quot;)
    End If        

End Sub
</code></pre>
<h2>Delete a DNS Zone</h2>
<pre lang="VB"><code>'***********************************************************
'*
'* Sub DnsDelete()
'*
'* Purpose: Deletes a Zone.
'*
'* Input:   strServer           A server name
'*          strOutputFile       An output file name
'*          strUserName         The current user name
'*          strPassword         The current user password
'*
'* Output:  Results are either printed on screen or saved in 
'*          strOutputFile.
'*
'********************************************************************

Sub DnsDelete(strServer        , _
              strUserName      , _
              strPassword      , _
              strOutputFile    , _
              strPropertyArray , _
              blnContextHelp     )


    ON ERROR RESUME NEXT

    Dim objFileSystem, objOutputFile, objService, objDNS, objServer
    
    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Delets a Zone.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo &quot;  DnsZones Delete [zonename]&quot;
        Wscript.Echo &quot;                  [/S &lt;server&gt;] [/U &lt;username&gt;]&quot;
        Wscript.Echo &quot;                  [/W &lt;password&gt;]&quot;
        Wscript.Echo &quot;                  [/O &lt;outputfile&gt;]&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   server        A server name&quot;
        Wscript.Echo &quot;   username      The current user name&quot;
        Wscript.Echo &quot;   password      The current user password&quot;
        Wscript.Echo &quot;   outputfile    The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;1.  DnsZones.vbs Delete example.com&quot;
        Wscript.Echo &quot;    Deletes the zone example.com.&quot;
        Wscript.Echo &quot;2.  DnsZones.vbs Delete &quot; _
        &amp; &quot;example.com /s MyMachine2&quot;
        Wscript.Echo &quot;    Deletes the zone example.com &quot; _
        &amp; &quot;from server MyMachine2.&quot;
        Wscript.Echo &quot;&quot;
        Exit Sub
    End If

    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    ' Establish a connection with the server.
    If blnConnect(&quot;root\microsoftdns&quot; , _
                   strUserName , _
                   strPassword , _
                   strServer   , _
                   objService  ) Then
        Call Wscript.Echo(&quot;&quot;)
        Call Wscript.Echo(&quot;Please verify the server name, &quot; _
                        &amp; &quot;credentials and WBEM Core.&quot;)
        Exit Sub
    End If

    set objServer = objService.Get(&quot;MicrosoftDNS_Server.name=&quot;&quot;.&quot;&quot;&quot;)
    Set objDNS = objService.Get(&quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; _
    &amp; strPropertyArray(0) &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; &amp; objServer.Name _
    &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; &amp; strPropertyArray(0) &amp; &quot;&quot;&quot;&quot;)
    objDns.Delete_
    If blnErrorOccurred(&quot;Error Deleting zone.&quot;) then Exit Sub
    Call WriteLine(&quot;Zone deleted from server &quot; _
    &amp; objserver.name &amp; &quot;.&quot;, objOutputFile)
    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; &amp; strOutputFile &amp; &quot;.&quot;)
    End If

End Sub          
</code></pre>
<h2>Add a Zone IP Address</h2>
<pre lang="VB"><code>'************************************************************
'*
'* Sub DnsADDIP()
'*
'* Purpose: Adds an IP Addresses to an Array.
'*
'* Input:   strServer           A server name
'*          strOutputFile       An output file name
'*          strUserName         The current user name
'*          strPassword         The current user password
'*          strPropertyArray    The properties to change
'*          strValueArray       The new values
'*
'* Output:  Results are either printed on screen or saved in 
'*          strOutputFile.
'*
'********************************************************************

Private Sub DnsADDIP(strServer        , _
                     strUserName      , _
                     strPassword      , _
                     strOutputFile    , _
                     strZoneArray     , _
                     strPropertyArray , _
                     strValueArray    , _
                     blnContextHelp     )

    ' ON ERROR RESUME NEXT
    Dim objFileSystem, objOutputFile, objService, objServer, objDnsSet
    Dim strTempArray()
    Dim J, H
    Redim strTempArray(20)
    
    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Adds an IP address to a property.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo &quot;  DnsZones AddIP &lt;Zone&gt; &lt;Property1&gt; &lt;Value1&gt; &quot; _
        &amp; &quot;[AddIP &lt;Zone&gt; &lt;Property2&gt; &lt;Value2&gt;] [...]&quot;
        Wscript.Echo &quot;                  [/S &lt;server&gt;] &quot; _
        &amp; &quot;[/U &lt;username&gt;] [/W &lt;password&gt;]&quot;
        Wscript.Echo &quot;                  [/O &lt;outputfile&gt;]&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   server        A server name&quot;
        Wscript.Echo &quot;   username      The current user name&quot;
        Wscript.Echo &quot;   password      The current user password&quot;
        Wscript.Echo &quot;   outputfile    The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;  DnsZones.vbs AddIP example.com  &quot; _
        &amp; &quot;MastersIP 10.10.10.10&quot;
        Wscript.Echo &quot;  Adds 10.10.10.10 to the MastersIP &quot; _
        &amp; &quot;property.&quot;
        Wscript.Echo &quot;&quot;
        Exit Sub
    End If

    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    ' Establish a connection with the server.
    If blnConnect(&quot;root\microsoftdns&quot; , _
                   strUserName , _
                   strPassword , _
                   strServer   , _
                   objService  ) Then
        Call Wscript.Echo(&quot;&quot;)
        Call Wscript.Echo(&quot;Please verify the server name, &quot; _
                        &amp; &quot;credentials and WBEM Core.&quot;)
        Exit Sub
    End If

    set objServer = objService.Get(&quot;MicrosoftDNS_Server.name=&quot;&quot;.&quot;&quot;&quot;)

    For I = 0 to ubound(strZoneArray)
        Set objDNSset = objService.Get( _
        &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; &amp; strZoneArray(0) _
        &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; &amp; objServer.Name &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; _
        &amp; strZoneArray(0) &amp; &quot;&quot;&quot;&quot;)

        If blnErrorOccurred(&quot; DNS Server not available.&quot;) _ 
        then Exit Sub
    
        If Not IsEmpty(strZoneArray(I)) then
            Select Case lcase(strPropertyArray(I))
                Case &quot;mastersip&quot;
                    Redim strTempArray(20)
                    If IsNull(objDNSSet.MastersIPAddressesArray) then
                        strTempArray(0) = strValueArray(I)
                        Redim Preserve strTempArray(0)
                        objDNSSet.MastersIPAddressesArray = _
                        strTempArray
                    Else
                        J = 0
                        For H = _ 
                        lbound(objDNSSet.MastersIPAddressesArray) _
                        to ubound(objDNSSet.MastersIPAddressesArray)
                            strTempArray(H) = _
                            objDNSSet.MastersIPAddressesArray(H)
                            J = J + 1
                        Next
                        strTempArray(J) = strValueArray(I)
                        ReDim Preserve strTempArray(J)
                        objDNSSet.MastersIPAddressesArray = _
                        strTempArray
                    End If
                    objDNSSet.Put_
                    If err.Number &lt;&gt; 0 then
                        Call WriteLine(&quot;Error adding IP address.&quot;, _
                        objOutputFile)
                        Exit Sub                        
                    Else
                        Call WriteLine( _
                        &quot;IP address successfully added.&quot;, _
                        objOutputFile)
                    End If

                Case &quot;notifyip&quot;
                    Redim strTempArray(20)
                    If IsNull(objDNSSet.NotifyIPAddressesArray) then
                        strTempArray(0) = strValueArray(I)
                        Redim Preserve strTempArray(0)
                        objDNSSet.NotifyIPAddressesArray = _
                        strTempArray
                    Else
                        J = 0
                        For H = lbound( _
                        objDNSSet.NotifyIPAddressesArray) _
                        to ubound(objDNSSet.NotifyIPAddressesArray)
                            strTempArray(H) = _
                            objDNSSet.NotifyIPAddressesArray(H)
                            J = J + 1
                        Next
                        strTempArray(J) = strValueArray(I)
                        ReDim Preserve strTempArray(J)
                        objDNSSet.NotifyIPAddressesArray = _ 
                        strTempArray
                    End If
                    objDNSSet.Put_
                    If err.Number &lt;&gt; 0 then
                        Call WriteLine(&quot;Error adding IP address.&quot;, objOutputFile)
                        Exit Sub                        
                    Else
                        Call WriteLine(&quot;IP address successfully added.&quot;, objOutputFile)
                    End If

                Case &quot;secondariesip&quot;
                    Redim strTempArray(20)
                    If IsNull(objDNSSet.SecondariesIPAddressesArray) _
                    then
                        strTempArray(0) = strValueArray(I)
                        Redim Preserve strTempArray(0)
                        objDNSSet.SecondariesIPAddressesArray = strTempArray
                    Else
                        J = 0
                        For H = lbound( objDNSSet.SecondariesIPAddressesArray) _
                        to ubound( objDNSSet.SecondariesIPAddressesArray)
                            strTempArray(H) = _
                            objDNSSet.SecondariesIPAddressesArray(H)
                            J = J + 1
                        Next
                        strTempArray(J) = strValueArray(I)
                        ReDim Preserve strTempArray(J)
                        objDNSSet.SecondariesIPAddressesArray = strTempArray
                    End If
                    objDNSSet.Put_
                    If err.Number &lt;&gt; 0 then
                        Call WriteLine(&quot;Error adding IP address.&quot;, objOutputFile)
                        Exit Sub                        
                    Else
                        Call WriteLine( _
                        &quot;IP address successfully added.&quot;, objOutputFile)
                    End If
                
                Case Else
                    Call WriteLine(&quot;Cannot add an IP address to &quot; _
                          &amp; strPropertyArray(I), objOutputFile)

            End Select
        End If    
    Next

    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; &amp; strOutputFile &amp; &quot;.&quot;)
    End If

End Sub
</code></pre>
<h2>Delete a Zone IP Address</h2>
<pre lang="VB"><code>'************************************************************
'*
'* Sub DnsDeleteIP()
'*
'* Purpose: Adds an IP Addresses to an Array.
'*
'* Input:   strServer           A server name
'*          strOutputFile       An output file name
'*          strUserName         The current user name
'*          strPassword         The current user password
'*          strPropertyArray    The properties to change
'*          strValueArray       The new values
'*
'* Output:  Results are either printed on screen or saved in 
'*          strOutputFile.
'*
'********************************************************************

Private Sub DnsDeleteIP(strServer        , _
                        strUserName      , _
                        strPassword      , _
                        strOutputFile    , _
                        strZoneArray     , _
                        strPropertyArray , _
                        strValueArray    , _
                        blnContextHelp     )

    ON ERROR RESUME NEXT
    Dim objFileSystem, objOutputFile, objService, objServer, objDnsSet
    Dim J, H
    Dim strTempArray()
    Redim strTempArray(20)
    
    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Removes an IP address from a property.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo &quot;  DnsZones DeleteIP &lt;Zone&gt; &lt;Property1&gt; &quot; _
        &amp; &quot;&lt;Value1&gt; [AddIP &lt;Zone&gt; &lt;Property2&gt; &lt;Value2&gt;] [...]&quot;
        Wscript.Echo &quot;                    [/S &lt;server&gt;] &quot; _
        &amp; &quot;[/U &lt;username&gt;] [/W &lt;password&gt;]&quot;
        Wscript.Echo &quot;                    [/O &lt;outputfile&gt;]&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   server        A server name&quot;
        Wscript.Echo &quot;   username      The current user name&quot;
        Wscript.Echo &quot;   password      The current user password&quot;
        Wscript.Echo &quot;   outputfile    The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;  DnsZones.vbs DeleteIP MastersIP 10.10.10.10&quot;
        Wscript.Echo &quot; Removes 10.10.10.10 from the MastersIP property.&quot;
        Wscript.Echo &quot;&quot;
        Exit Sub
    End If

    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    ' Establish a connection with the server.
    If blnConnect(&quot;root\microsoftdns&quot; , _
                   strUserName , _
                   strPassword , _
                   strServer   , _
                   objService  ) Then
        Call Wscript.Echo(&quot;&quot;)
        Call Wscript.Echo(&quot;Please verify the server name, &quot; _
                        &amp; &quot;credentials and WBEM Core.&quot;)
        Exit Sub
    End If

    set objServer = objService.Get(&quot;MicrosoftDNS_Server.name=&quot;&quot;.&quot;&quot;&quot;)
    Set objDNSset = objService.Get( _
    &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; &amp; strZoneArray(0) _
    &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; &amp; objServer.Name &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; _
    &amp; strZoneArray(0) &amp; &quot;&quot;&quot;&quot;)

    For I = 0 to ubound(strPropertyArray)
        If Not IsEmpty(strPropertyArray(I)) then
            Select Case lcase(strPropertyArray(I))
                Case &quot;mastersip&quot;
                    Redim strTempArray(20)
                    If IsNull(objDNSSet.MastersIPAddressesArray) then
                       Call WriteLine(&quot;There are no IP addresses &quot; _
                       &amp; &quot;to delete.&quot;, objOutputFile)
                    Else
                        J = 0
                        For H = _
                        lbound(objDNSSet.MastersIPAddressesArray) _
                        to ubound(objDNSSet.MastersIPAddressesArray)
                            If strValueArray(I) &lt;&gt; _
                            objDNSSet.MastersIPAddressesArray(H) then
                                strTempArray(J) = _
                                objDNSSet.MastersIPAddressesArray(H)
                                J = J + 1
                            End If
                        Next
                        If J &lt;&gt; 0 then
                            ReDim Preserve strTempArray(J - 1)
                            objDNSSet.MastersIPAddressesArray = _
                            strTempArray
                        Else
                            objDnsSet.MastersIPAddressesArray = Null
                        End If
                    End If
                    objDNSSet.Put_
                    If err.Number &lt;&gt; 0 then
                        Call WriteLine(&quot;Error deleting IP address.&quot;, _
                        objOutputFile)
                        Exit Sub                        
                    Else
                        Call WriteLine(&quot;IP address successfully &quot; _
                        &amp; &quot;deleted.&quot;, objOutputFile)
                    End If

                Case &quot;notifyip&quot;
                    Redim strTempArray(20)
                    If IsNull(objDNSSet.NotifyIPAddressesArray) then
                        Call WriteLine(&quot;There are no IP addresses &quot; _
                        &amp; &quot;to delete.&quot;, objOutputFile)
                    Else
                        J = 0
                        For H = _
                        lbound(objDNSSet.NotifyIPAddressesArray) _
                        to ubound(objDNSSet.NotifyIPAddressesArray)
                            If strValueArray(I) &lt;&gt; _
                            objDNSSet.NotifyIPAddressesArray(H) then
                                strTempArray(J) = _
                                objDNSSet.NotifyIPAddressesArray(H)
                                J = J + 1
                            End If
                        Next
                        If J &lt;&gt; 0 then
                            ReDim Preserve strTempArray(J - 1)
                            objDNSSet.NotifyIPAddressesArray = _
                            strTempArray
                        Else
                            objDnsSet.NotifyIPAddressesArray = Null
                        End If
                    End If
                    objDNSSet.Put_
                    If err.Number &lt;&gt; 0 then
                        Call WriteLine(&quot;Error deleting IP address.&quot;, _
                        objOutputFile)
                        Exit Sub                        
                    Else
                        Call WriteLine(&quot;IP address successfully deleted.&quot;, objOutputFile)
                    End If

                Case &quot;secondariesip&quot;
                    Redim strTempArray(20)
                    If IsNull(objDNSSet.SecondariesIPAddressesArray) then
                        Call WriteLine(&quot;There are no IP addresses &quot; _
                        &amp; &quot;to delete.&quot;, objOutputFile)
                    Else
                      J = 0
                      For H = _
                      lbound(objDNSSet.SecondariesIPAddressesArray) _
                      to ubound(objDNSSet.SecondariesIPAddressesArray)
                          If strValueArray(I) &lt;&gt; objDNSSet.SecondariesIPAddressesArray(H) _
                          then
                              strTempArray(J) = objDNSSet.SecondariesIPAddressesArray(H)
                              J = J + 1
                          End If
                      Next
                      If J &lt;&gt; 0 then
                          ReDim Preserve strTempArray(J - 1)
                          objDNSSet.SecondariesIPAddressesArray = strTempArray
                      Else
                          objDnsSet.SecondariesIPAddressesArray = Null
                      End If
                    End If
                    objDNSSet.Put_
                    If err.Number &lt;&gt; 0 then
                        Call WriteLine(&quot;Error deleting IP address.&quot;, objOutputFile)
                        Exit Sub                        
                    Else
                        Call WriteLine(&quot;IP address successfully deleted.&quot;, objOutputFile)
                    End If


                Case Else
                    Call WriteLine(&quot;Cannot add an IP address to &quot; &amp; strPropertyArray(I), objOutputFile)

            End Select
        End If    
    
    Next
    

    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; &amp; strOutputFile &amp; &quot;.&quot;)
    End If

End Sub
</code></pre>
<h2>Pause a Zone</h2>
<pre lang="VB"><code>'**********************************************************
'*
'* Sub DnsPause()
'*
'* Purpose: Pauses a Zone.
'*
'* Input:   strServer           A server name
'*          strOutputFile       An output file name
'*          strUserName         The current user name
'*          strPassword         The current user password
'*
'* Output:  Results are either printed on screen or saved in 
'*          strOutputFile.
'*
'********************************************************************

Private Sub DnsPause(strServer        , _
                     strUserName      , _
                     strPassword      , _
                     strOutputFile    , _
                     strZoneArray     , _
                     blnContextHelp     )


    ON ERROR RESUME NEXT
    Dim objFileSystem, objOutputFile, objService, objDnsSet
    Dim objServer, Inst
    
    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Pauses a Zone.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo &quot;  DnsZones Pause &lt;Zone&gt;&quot;
        Wscript.Echo &quot;    [/S &lt;server&gt;] [/U &lt;username&gt;] &quot; _
        &amp; &quot;[/W &lt;password&gt;]&quot;
        Wscript.Echo &quot;    [/O &lt;outputfile&gt;]&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   server        A server name&quot;
        Wscript.Echo &quot;   username      The current user name&quot;
        Wscript.Echo &quot;   password      The current user password&quot;
        Wscript.Echo &quot;   outputfile    The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;  DnsZones.vbs Pause example.com /s MyMachine2&quot;
        Wscript.Echo &quot;  Pauses the zone example.com on server &quot; _
        &amp; &quot;MyMachine2&quot;
        Wscript.Echo &quot;&quot;
        Exit Sub
    End If

    
    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    ' Establish a connection with the server.
    If blnConnect(&quot;root\microsoftdns&quot; , _
                   strUserName , _
                   strPassword , _
                   strServer   , _
                   objService  ) Then
        Call Wscript.Echo(&quot;&quot;)
        Call Wscript.Echo(&quot;Please verify the server name, &quot; _
                        &amp; &quot;credentials and WBEM Core.&quot;)
        Exit Sub
    End If

    set objServer = objService.Get(&quot;MicrosoftDNS_Server.name=&quot;&quot;.&quot;&quot;&quot;)
    Set objDNSset = objService.Get( _
    &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; &amp; strZoneArray(0) _
    &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; &amp; objServer.Name &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; _
    &amp; strZoneArray(0) &amp; &quot;&quot;&quot;&quot;)
    If blnErrorOccurred(&quot; DNS Server not available.&quot;) then Exit Sub
    If objDnsset.Paused = False then
        Inst = objDNSSet.PauseZone
        If blnErrorOccurred(&quot; Zone not available.&quot;) then Exit Sub
        Call WriteLine(&quot;Zone &quot; &amp; objDNSSet.Name _ 
        &amp; &quot; paused on server &quot; &amp; objServer.Name &amp; &quot;.&quot;, objOutputFile)
    Else
        Call WriteLine(&quot;The Zone is already Paused.&quot;, objOutputFile)
    End If
    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; _
        &amp; strOutputFile &amp; &quot;.&quot;)
    End If


End Sub
</code></pre>
<h2>Resume a Zone</h2>
<pre lang="VB"><code>'***********************************************************
'*
'* Sub DnsResume()
'*
'* Purpose: UnPauses a Zone.
'*
'* Input:   strServer           A server name
'*          strOutputFile       An output file name
'*          strUserName         The current user name
'*          strPassword         The current user password
'*
'* Output:  Results are either printed on screen or saved in 
'*          strOutputFile.
'*
'********************************************************************

Private Sub DnsResume(strServer        , _
                      strUserName      , _
                      strPassword      , _
                      strOutputFile    , _
                      strZoneArray     , _
                      blnContextHelp     )


    ON ERROR RESUME NEXT
    Dim objFileSystem, objOutputFile, objService, objDnsSet
    Dim objServer, Inst
    
    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Resumes a Zone.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo &quot;  DnsZones Resume &lt;Zone&gt;&quot;
        Wscript.Echo &quot;    [/S &lt;server&gt;] [/U &lt;username&gt;] &quot; _
        &amp; &quot;[/W &lt;password&gt;]&quot;
        Wscript.Echo &quot;    [/O &lt;outputfile&gt;]&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   server        A server name&quot;
        Wscript.Echo &quot;   username      The current user name&quot;
        Wscript.Echo &quot;   password      The current user password&quot;
        Wscript.Echo &quot;   outputfile    The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;  DnsZones.vbs Resume example.com /s MyMachine2&quot;
        Wscript.Echo &quot;  Unpauses the zone example.com on server &quot; _
        &amp; &quot;MyMachine2.&quot;
        Exit Sub
    End If

    
    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    ' Establish a connection with the server.
    If blnConnect(&quot;root\microsoftdns&quot; , _
                   strUserName , _
                   strPassword , _
                   strServer   , _
                   objService  ) Then
        Call Wscript.Echo(&quot;&quot;)
        Call Wscript.Echo(&quot;Please verify the server name, &quot; _
                        &amp; &quot;credentials and WBEM Core.&quot;)
        Exit Sub
    End If
    set objServer = objService.Get(&quot;MicrosoftDNS_Server.name=&quot;&quot;.&quot;&quot;&quot;)
    Set objDNSset = objService.Get( _
    &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; &amp; strZoneArray(0) _
    &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; &amp; objServer.Name &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; _
    &amp; strZoneArray(0) &amp; &quot;&quot;&quot;&quot;)
    If blnErrorOccurred(&quot; DNS Server not available.&quot;) then Exit Sub
    If objDNSSet.Paused = True then
        Inst = objDNSSet.ResumeZone
        If blnErrorOccurred(&quot; Zone not available.&quot;) then Exit Sub
        Call WriteLine(&quot;Zone &quot; &amp; objDNSSet.Name _
        &amp; &quot; resumed on server &quot; &amp; objServer.Name _ 
        &amp; &quot;.&quot;, objOutputFile)
    Else
        Call WriteLine(&quot;The Zone is not paused.&quot;, objOutputFile)
    End If
    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; _
        &amp; strOutputFile &amp; &quot;.&quot;)
    End If


End Sub

'********************************************************************
'*
'* Sub DnsWrite()
'*
'* Purpose: Writes a Zone back to its file.
'*
'* Input:   strServer           A server name
'*          strOutputFile       An output file name
'*          strUserName         The current user name
'*          strPassword         The current user password
'*
'* Output:  Results are either printed on screen or saved in
'*          strOutputFile.
'*
'********************************************************************

Private Sub DnsWrite(strServer        , _
                     strUserName      , _
                     strPassword      , _
                     strOutputFile    , _
                     strZoneArray     , _
                     blnContextHelp     )


    ON ERROR RESUME NEXT
    Dim objFileSystem, objOutputFile, objService, objDnsSet
    Dim objServer, Inst
    
    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Writes a Zone back to its file.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo &quot;  DnsZones Write &lt;Zone&gt;&quot;
        Wscript.Echo &quot;    [/S &lt;server&gt;] [/U &lt;username&gt;] &quot; _
        &amp; &quot;[/W &lt;password&gt;]&quot;
        Wscript.Echo &quot;    [/O &lt;outputfile&gt;]&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   server        A server name&quot;
        Wscript.Echo &quot;   username      The current user name&quot;
        Wscript.Echo &quot;   password      The current user password&quot;
        Wscript.Echo &quot;   outputfile    The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;  DnsZones.vbs Write example.com&quot;
        Wscript.Echo &quot;  Writes any changes to example.com to its &quot; _
        &amp; &quot;zone file.&quot;
        Wscript.Echo &quot;&quot;
        Exit Sub
    End If

    
    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    'Establish a connection with the server.
    If blnConnect(&quot;root\microsoftdns&quot; , _
                   strUserName , _
                   strPassword , _
                   strServer   , _
                   objService  ) Then
        Call Wscript.Echo(&quot;&quot;)
        Call Wscript.Echo(&quot;Please verify the server name, &quot; _
                        &amp; &quot;credentials and WBEM Core.&quot;)
        Exit Sub
    End If
    set objServer = objService.Get(&quot;MicrosoftDNS_Server.name=&quot;&quot;.&quot;&quot;&quot;)
    Set objDNSset = objService.Get( _
    &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; &amp; strZoneArray(0) _
    &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; &amp; objServer.Name &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; _
    &amp; strZoneArray(0) &amp; &quot;&quot;&quot;&quot;)
    If blnErrorOccurred(&quot; DNS Server not available.&quot;) then Exit Sub
    Inst = objDNSSet.ResumeZone
    If blnErrorOccurred(&quot; Zone not available.&quot;) then Exit Sub
    Call WriteLine(&quot;Zone &quot; &amp; objDNSSet.Name &amp; &quot; has written its &quot; _
    &amp; &quot;contents back to the zone file on server &quot; &amp; _
                        objServer.Name &amp; &quot;.&quot;, objOutputFile)
    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; _
        &amp; strOutputFile &amp; &quot;.&quot;)
    End If


End Sub
</code></pre>
<h2>Update a Zone</h2>
<pre lang="VB"><code>'************************************************************
'*
'* Sub DnsUpdate()
'*
'* Purpose: Updates a DS integrated zone with data from the DS.
'*
'* Input:   strServer           A server name
'*          strOutputFile       An output file name
'*          strUserName         The current user name
'*          strPassword         The current user password
'*
'* Output:  Results are either printed on screen or saved in 
'*          strOutputFile.
'*
'********************************************************************

Private Sub DnsUpdate(strServer        , _
                      strUserName      , _
                      strPassword      , _
                      strOutputFile    , _
                      strZoneArray     , _
                      blnContextHelp     )


    ON ERROR RESUME NEXT
    Dim objFileSystem, objOutputFile, objService, objDnsSet 
    Dim objServer, Inst
    
    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Updates a DS integrated zone with data &quot; _
        &amp; &quot;from the Directory Services.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo &quot;  DnsZones Update &lt;Zone&gt;&quot;
        Wscript.Echo &quot;    [/S &lt;server&gt;] [/U &lt;username&gt;] &quot; _
        &amp; &quot;[/W &lt;password&gt;]&quot;
        Wscript.Echo &quot;    [/O &lt;outputfile&gt;]&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   server        A server name&quot;
        Wscript.Echo &quot;   username      The current user name&quot;
        Wscript.Echo &quot;   password      The current user password&quot;
        Wscript.Echo &quot;   outputfile    The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;  DnsZones.vbs Update example.com&quot;
        Wscript.Echo &quot;  Updates example.com from DS Data.&quot;
        Wscript.Echo &quot;&quot;
        Exit Sub
    End If

    
    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    'Establish a connection with the server.
    If blnConnect(&quot;root\microsoftdns&quot; , _
                   strUserName , _
                   strPassword , _
                   strServer   , _
                   objService  ) Then
        Call Wscript.Echo(&quot;&quot;)
        Call Wscript.Echo(&quot;Please verify the server name, &quot; _
                        &amp; &quot;credentials and WBEM Core.&quot;)
        Exit Sub
    End If
    set objServer = objService.Get(&quot;MicrosoftDNS_Server.name=&quot;&quot;.&quot;&quot;&quot;)
    Set objDNSset = objService.Get( _
    &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; &amp; strZoneArray(0) _
    &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; &amp; objServer.Name &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; _
    &amp; strZoneArray(0) &amp; &quot;&quot;&quot;&quot;)
    If blnErrorOccurred(&quot; DNS Server not available.&quot;) then Exit Sub
    If objDNSSet.ZoneType = 0 then
        Inst = objDNSSet.UpdateDSIntegratedZoneByDataFromDS
        If blnErrorOccurred(&quot; Zone not available.&quot;) then Exit Sub
        Call WriteLine(&quot;Zone &quot; &amp; objDNSSet.Name &amp; _ 
        &quot; has been updated from the directory services.&quot;, objOutputFile)
    Else
        Call WriteLine(&quot;Zone &quot; &amp; objDNSSet.Name &amp; &quot; is not a DS &quot; _
        &amp; &quot;Integreated (ZoneType = 0) Zone.&quot;, objOutputFile)
    End If
    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; &amp; strOutputFile &amp; &quot;.&quot;)
    End If


End Sub
</code></pre>
<h2>Reload a Zone</h2>
<pre lang="VB"><code>'************************************************************
'*
'* Sub DnsReload()
'*
'* Purpose: Reloads a Zone from its ZoneFile.
'*
'* Input:   strServer           A server name
'*          strOutputFile       An output file name
'*          strUserName         The current user name
'*          strPassword         The current user password
'*
'* Output:  Results are either printed on screen or saved in 
'*          strOutputFile.
'*
'********************************************************************

Private Sub DnsReload(strServer        , _
                      strUserName      , _
                      strPassword      , _
                      strOutputFile    , _
                      strZoneArray     , _
                      blnContextHelp     )


    ON ERROR RESUME NEXT
    Dim objFileSystem, objOutputFile, objService, objDnsSet 
    Dim objServer, Inst
    
    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Reloads a Zone from its Zone File.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo &quot;  DnsZones Reload &lt;Zone&gt;&quot;
        Wscript.Echo &quot;    [/S &lt;server&gt;] [/U &lt;username&gt;] &quot; _
        &amp; &quot;[/W &lt;password&gt;]&quot;
        Wscript.Echo &quot;    [/O &lt;outputfile&gt;]&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   server        A server name&quot;
        Wscript.Echo &quot;   username      The current user name&quot;
        Wscript.Echo &quot;   password      The current user password&quot;
        Wscript.Echo &quot;   outputfile    The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;  DnsZones.vbs Reload example.com&quot;
        Wscript.Echo &quot;  Reloads Zone example.com from its Zone File.&quot;
        Wscript.Echo &quot;&quot;
        Exit Sub
    End If

    
    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    'Establish a connection with the server.
    If blnConnect(&quot;root\microsoftdns&quot; , _
                   strUserName , _
                   strPassword , _
                   strServer   , _
                   objService  ) Then
        Call Wscript.Echo(&quot;&quot;)
        Call Wscript.Echo(&quot;Please verify the server name, &quot; _
                        &amp; &quot;credentials and WBEM Core.&quot;)
        Exit Sub
    End If
    set objServer = objService.Get(&quot;MicrosoftDNS_Server.name=&quot;&quot;.&quot;&quot;&quot;)
    Set objDNSset = objService.Get( _
    &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; &amp; strZoneArray(0) _
    &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; &amp; objServer.Name &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; _
    &amp; strZoneArray(0) &amp; &quot;&quot;&quot;&quot;)
    If blnErrorOccurred(&quot; DNS Server not available.&quot;) then Exit Sub
    Inst = objDNSSet.ReloadZone
    If blnErrorOccurred(&quot; Zone not available.&quot;) then Exit Sub
    Call WriteLine(&quot;Zone &quot; &amp; objDNSSet.Name &amp; &quot; has written its &quot; _
    &amp; &quot;contents back to the zone file on server &quot; &amp; objServer.Name _
    &amp; &quot;.&quot;, objOutputFile)
    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; &amp; strOutputFile &amp; &quot;.&quot;)
    End If


End Sub
</code></pre>
<h2>Refresh a Zone</h2>
<pre lang="VB"><code>'************************************************************
'*
'* Sub DnsRefresh()
'*
'* Purpose: Resfreshes a Secondary Zone from its Master Zone.
'*
'* Input:   strServer           A server name
'*          strOutputFile       An output file name
'*          strUserName         The current user name
'*          strPassword         The current user password
'*
'* Output:  Results are either printed on screen or saved in 
'*          strOutputFile.
'*
'********************************************************************

Private Sub DnsRefresh(strServer        , _
                      strUserName      , _
                      strPassword      , _
                      strOutputFile    , _
                      strZoneArray     , _
                      blnContextHelp     )


    ON ERROR RESUME NEXT
    Dim objFileSystem, objOutputFile, objService, objDnsSet
    Dim objServer, Inst
    
    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Resfreshes a Secondary Zone &quot; _
        &amp; &quot;from its Master Zone.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo &quot;  DnsZones DnsRefresh &lt;Zone&gt;&quot;
        Wscript.Echo &quot;    [/S &lt;server&gt;] [/U &lt;username&gt;] &quot; _
        &amp; &quot;[/W &lt;password&gt;]&quot;
        Wscript.Echo &quot;    [/O &lt;outputfile&gt;]&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   server        A server name&quot;
        Wscript.Echo &quot;   username      The current user name&quot;
        Wscript.Echo &quot;   password      The current user password&quot;
        Wscript.Echo &quot;   outputfile    The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;  DnsZones DnsRefresh example.com&quot;
        Wscript.Echo &quot;  Refreshes the secondary Zone example.com &quot; _
        &amp; &quot;from its Primary Zone.&quot;
        Wscript.Echo &quot;&quot;
        Exit Sub
    End If

    
    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    ' Establish a connection with the server.
    If blnConnect(&quot;root\microsoftdns&quot; , _
                   strUserName , _
                   strPassword , _
                   strServer   , _
                   objService  ) Then
        Call Wscript.Echo(&quot;&quot;)
        Call Wscript.Echo(&quot;Please verify the server name, &quot; _
                        &amp; &quot;credentials and WBEM Core.&quot;)
        Exit Sub
    End If
    set objServer = objService.Get(&quot;MicrosoftDNS_Server.name=&quot;&quot;.&quot;&quot;&quot;)
    Set objDNSset = objService.Get( _
    &quot;MicrosoftDNS_Zone.ContainerName=&quot;&quot;&quot; &amp; strZoneArray(0) _
    &amp; &quot;&quot;&quot;,DnsServerName=&quot;&quot;&quot; &amp; objServer.Name &amp; &quot;&quot;&quot;,Name=&quot;&quot;&quot; _
    &amp; strZoneArray(0) &amp; &quot;&quot;&quot;&quot;)
    If blnErrorOccurred(&quot; DNS Server not available.&quot;) then Exit Sub
    If objDNSset.ZoneType = 2 then
        Inst = objDNSSet.ForceRefreshOfSecondaryZoneFromMaster
        If blnErrorOccurred(&quot;An error occurred while refreshing &quot; _
        &amp; &quot;secondary zone.&quot;) then Exit Sub
        Call WriteLine(&quot;Zone &quot; &amp; objDNSSet.Name &amp; &quot; has written &quot; _
        &amp; &quot;its contents back to the zone file on server &quot; _
        &amp; objServer.Name &amp; &quot;.&quot;, objOutputFile)
    Else
        Call WriteLine(&quot;Zone &quot; &amp; objDNSSet.Name &amp; _
                        &quot; is not a secondary (ZoneType = 2) Zone.&quot;, objOutputFile)
    End If
    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; &amp; strOutputFile &amp; &quot;.&quot;)
    End If


End Sub

'********************************************************************
'*
'* Function intParseCmdLine()
'*
'* Purpose: Parses the command line.
'* Input:   
'*
'* Output:  strServer         A remote server (&quot;&quot; = local server&quot;)
'*          strUserName       The current user name
'*          strPassword       The current user password
'*          strOutputFile     An output file name
'*
'********************************************************************
Private Function intParseCmdLine( ByRef strServer        , _
                                  ByRef strUserName      , _
                                  ByRef strPassword      , _
                                  ByRef strOutputFile    , _
                                  ByRef strPropertyArray , _
                                  ByRef strValueArray    , _
                                  ByRef strZoneArray     , _
                                  ByRef blnContextHelp     )
    

    ON ERROR RESUME NEXT

    Dim strFlag, strProperty, strValue
    Dim intState, intArgIter, intPropertyCount
    Dim objFileSystem
    ReDim strPropertyArray(20)
    ReDim strValueArray(20)
    ReDim strZoneArray(20)

    blnContextHelp = False
    intPropertyCount = 0
    
    If Wscript.Arguments.Count &gt; 0 Then
        strFlag = Wscript.arguments.Item(0)
    End If

    If IsEmpty(strFlag) Then 
               'No arguments have been received
        intParseCmdLine = CONST_LIST
        Exit Function
    End If

    'Check if the user is asking for help or is just confused
    If (strFlag=&quot;help&quot;) OR (strFlag=&quot;/h&quot;) OR (strFlag=&quot;\h&quot;) OR _
    (strFlag=&quot;-h&quot;) OR (strFlag = &quot;\?&quot;) OR (strFlag = &quot;/?&quot;) OR _
    (strFlag = &quot;?&quot;) OR (strFlag=&quot;h&quot;) Then
        intParseCmdLine = CONST_SHOW_USAGE
        Exit Function
    End If

    'Retrieve the command line and set appropriate variables
    intArgIter = 0
    Do While intArgIter &lt;= Wscript.arguments.Count - 1
        Select Case lcase(Wscript.arguments.Item(intArgIter))
  
            Case &quot;/s&quot;
                If Not blnGetArg(&quot;Server&quot;, strServer, intArgIter) Then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                intArgIter = intArgIter + 1

            Case &quot;/o&quot;
                If Not blnGetArg(&quot;Output File&quot;, strOutputFile, _
                intArgIter) Then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                intArgIter = intArgIter + 1

            Case &quot;/u&quot;
                If Not blnGetArg(&quot;User Name&quot;, strUserName, _
                intArgIter) Then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                intArgIter = intArgIter + 1

            Case &quot;/w&quot;
                If Not blnGetArg(&quot;User Password&quot;, strPassword, _
                intArgIter) Then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                intArgIter = intArgIter + 1

            Case &quot;create&quot;
                intParseCmdLine = CONST_CREATE

                If Wscript.Arguments.Count &lt; intArgIter + 2 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                Select Case lcase(Wscript.Arguments(intArgIter + 1))
                    Case &quot;/?&quot;
                        blnContextHelp = True
                        intArgIter = intArgIter + 2
                        Exit Function
                    Case &quot;primary&quot;
                        strPropertyArray(0) = &quot;1&quot;
                    Case &quot;secondary&quot;
                        strPropertyArray(0) = &quot;2&quot;
                    Case &quot;dsintegrated&quot;
                        strPropertyArray(0) = &quot;0&quot;
                    Case Else
                        intParseCmdLine = CONST_ERROR
                        Exit Function
                End Select

                If  Wscript.Arguments.count &lt; intArgIter + 3 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                Select Case Lcase(Wscript.Arguments(intArgIter + 2))
                    Case &quot;forward&quot;
                        strPropertyArray(1) = &quot;False&quot;
                    Case &quot;reverse&quot;
                        strPropertyArray(1) = &quot;True&quot;
                    Case Else
                        intParseCmdLine = CONST_ERROR
                        Exit Function
                End Select

                If Wscript.Arguments.count &lt; intArgIter + 4 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                If Left(Wscript.Arguments(intArgIter + 3),1) = _ 
                &quot;/&quot; then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                strPropertyArray(2) = _
                Wscript.Arguments(intArgIter + 3)

                If strPropertyArray(0) = &quot;2&quot; then
                    If Wscript.Arguments.count &lt; intArgIter + 5 then
                        intParseCmdLine = CONST_ERROR
                        Exit Function
                    End If
                    If Left(Wscript.Arguments(intArgIter + 4),1) = _
                    &quot;/&quot; then
                        intParseCmdLine = CONST_ERROR
                        Exit Function
                    End If
                    strPropertyArray(4) = _
                    Wscript.Arguments(intArgIter + 4)

                    If Wscript.Arguments.Count &lt; intArgIter + 6 then
                        intArgIter = intArgIter + 5
                    Else
                        If Left(Wscript.Arguments(intArgIter + 5),1) _
                        = &quot;/&quot; then
                            intArgIter = intArgIter + 5
                        Else
                            strPropertyArray(3) = _
                            Wscript.Arguments(intArgIter + 5)
                            intArgIter = intArgITer + 6
                        End If
                    End If
                Else
                    If Wscript.Arguments.Count &lt; intArgIter + 5 then
                        intArgIter = intArgIter + 4
                    Else
                        If Left(Wscript.Arguments(intArgIter + 4),1) _
                        = &quot;/&quot; then
                            intArgIter = intArgIter + 4
                        Else
                            strPropertyArray(3) = _
                            Wscript.Arguments(intArgIter + 4)
                            intArgIter = intArgIter + 5
                        End If
                    End IF
                End If

            Case &quot;pause&quot;
                If Wscript.Arguments.Count &lt;= intArgIter + 1 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                If Wscript.Arguments(intArgIter + 1) = &quot;/?&quot; then
                    blnContextHelp = True
                    intParseCmdLine = CONST_PAUSE
                    intArgIter = intArgIter + 2
                Else
                    strZoneArray(0) = _
                    Wscript.Arguments(intArgIter + 1)
                    intParseCmdLine = CONST_PAUSE
                    intArgIter = intArgIter + 2
                End If

            Case &quot;resume&quot;
                If Wscript.Arguments.Count &lt;= intArgIter + 1 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                If Wscript.Arguments(intArgIter + 1) = &quot;/?&quot; then
                    blnContextHelp = True
                    intParseCmdLine = CONST_RESUME
                    intArgIter = intArgIter + 2
                Else
                    strZoneArray(0) = _
                    Wscript.Arguments(intArgIter + 1)
                    intParseCmdLine = CONST_RESUME
                    intArgIter = intArgIter + 2
                End If

            Case &quot;write&quot;
                If Wscript.Arguments.Count &lt;= intArgIter + 1 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                If Wscript.Arguments(intArgIter + 1) = &quot;/?&quot; then
                    blnContextHelp = True
                    intParseCmdLine = CONST_WRITE
                    intArgIter = intArgIter + 2
                Else
                    strZoneArray(0) = _
                    Wscript.Arguments(intArgIter + 1)
                    intParseCmdLine = CONST_WRITE
                    intArgIter = intArgIter + 2
                End If

            Case &quot;update&quot;
                If Wscript.Arguments.Count &lt;= intArgIter + 1 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                If Wscript.Arguments(intArgIter + 1) = &quot;/?&quot; then
                    blnContextHelp = True
                    intParseCmdLine = CONST_UPDATE
                    intArgIter = intArgIter + 2
                Else
                    strZoneArray(0) = _
                    Wscript.Arguments(intArgIter + 1)
                    intParseCmdLine = CONST_UPDATE
                    intArgIter = intArgIter + 2
                End If

            Case &quot;reload&quot;
                If Wscript.Arguments.Count &lt;= intArgIter + 1 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                If Wscript.Arguments(intArgIter + 1) = &quot;/?&quot; then
                    blnContextHelp = True
                    intParseCmdLine = CONST_RELOAD
                    intArgIter = intArgIter + 2
                Else
                    strZoneArray(0) = _
                    Wscript.Arguments(intArgIter + 1)
                    intParseCmdLine = CONST_RELOAD
                    intArgIter = intArgIter + 2
                End If

            Case &quot;refresh&quot;
                If Wscript.Arguments.Count &lt;= intArgIter + 1 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                If Wscript.Arguments(intArgIter + 1) = &quot;/?&quot; then
                    blnContextHelp = True
                    intParseCmdLine = CONST_REFRESH
                    intArgIter = intArgIter + 2
                Else
                    strZoneArray(0) = _
                    Wscript.Arguments(intArgIter + 1)
                    intParseCmdLine = CONST_REFRESH
                    intArgIter = intArgIter + 2
                End If

            Case &quot;delete&quot;
                If Wscript.Arguments.Count &lt;= intArgIter + 1 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                End If
                If Wscript.Arguments(intArgIter + 1) = &quot;/?&quot; then
                    blnContextHelp = True
                    intParseCmdLine = CONST_DELETE
                    intArgIter = intArgIter + 2
                Else
                    strPropertyArray(0) = _
                    Wscript.Arguments(intArgIter + 1)
                    intParseCmdLine = CONST_DELETE
                    intArgIter = intArgIter + 2
                End If

            Case &quot;list&quot;
                intParseCmdLine = CONST_LIST
                intArgIter = intArgIter + 1      
                If Wscript.Arguments.Count =&gt; intArgIter then
                    If Left(Wscript.Arguments(intArgIter),1) &lt;&gt; _
                    &quot;/&quot; then
                        strPropertyArray(0) = _
                        Wscript.Arguments(intArgIter)
                        intArgIter = intArgIter + 1
                    End If
                End If

            Case &quot;display&quot;
                intParseCmdLine = CONST_DISPLAY
                intArgIter = intArgIter + 1      

            Case &quot;addip&quot;
                If Wscript.arguments.count &lt;= intArgIter + 1 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                Else
                    If Wscript.arguments(intArgIter + 1) = &quot;/?&quot; then
                        blnContextHelp = True
                        intParseCmdLine = CONST_ADDIP
                        intArgIter = intArgIter + 2
                    Else
                        If Wscript.arguments.count &lt;= intArgIter + 3 _
                        then
                            intParseCmdLine = CONST_ERROR
                            Exit Function
                        End If
                        intParseCmdLine = CONST_ADDIP
                        strZoneArray(intPropertyCount) = _
                        Wscript.Arguments(intArgIter + 1)
                        strPropertyArray(intPropertyCount) = _
                        Wscript.Arguments(intArgIter + 2)
                        strValueArray(intPropertyCount) = _
                        Wscript.Arguments(intArgIter + 3)
                        intArgIter = intArgIter + 4
                        intPropertyCount = intPropertyCount + 1
                    End If
                End If

            Case &quot;deleteip&quot;
                If Wscript.arguments.count &lt;= intArgIter + 1 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                Else
                    If Wscript.arguments(intArgIter + 1) = &quot;/?&quot; then
                        blnContextHelp = True
                        intParseCmdLine = CONST_DELETEIP
                        intArgIter = intArgIter + 2
                    Else
                        If Wscript.arguments.count &lt;= intArgIter + 3 _
                        then
                            intParseCmdLine = CONST_ERROR
                            Exit Function
                        End If
                        intParseCmdLine = CONST_DELETEIP
                        strZoneArray(intPropertyCount) = _
                        Wscript.Arguments(intArgIter + 1)
                        strPropertyArray(intPropertyCount) = _
                        Wscript.Arguments(intArgIter + 2)
                        strValueArray(intPropertyCount) = _
                        Wscript.Arguments(intArgIter + 3)
                        intArgIter = intArgIter + 4
                        intPropertyCount = intPropertyCount + 1
                    End If
                End If

            Case &quot;modify&quot;
                If Wscript.arguments.count &lt;= intArgIter + 1 then
                    intParseCmdLine = CONST_ERROR
                    Exit Function
                Else
                    If Wscript.arguments(intArgIter + 1) = &quot;/?&quot; then
                        blnContextHelp = True
                        intParseCmdLine = CONST_MODIFY
                        intArgIter = intArgIter + 2
                    Else
                        If Wscript.arguments.count &lt;= intArgIter + 3 _
                        then
                            intParseCmdLine = CONST_ERROR
                            Exit Function
                        End If
                        intParseCmdLine = CONST_MODIFY
                        strZoneArray(intPropertyCount) = _
                        Wscript.Arguments(intArgIter + 1)
                        strPropertyArray(intPropertyCount) = _
                        Wscript.Arguments(intArgIter + 2)
                        strValueArray(intPropertyCount) = _
                        Wscript.Arguments(intArgIter + 3)
                        intArgIter = intArgIter + 4
                        intPropertyCount = intPropertyCount + 1
                    End If
                End If

            Case &quot;/?&quot;
               blnContextHelp = True
                intArgIter = intArgIter + 1
            
            Case Else
                intParseCmdLine = CONST_ERROR
                Exit Function
                
        End Select


    Loop '** intArgIter &lt;= Wscript.arguments.Count - 1
    
    If IsEmpty(intParseCmdLine) Then 
        If blnContextHelp = True then
            intParseCmdLine = CONST_SHOW_USAGE
        Else
            intParseCmdLine = CONST_LIST
        End If
    End If

End Function

'********************************************************************
'*
'* Sub ShowUsage()
'*
'* Purpose: Shows the correct usage to the user.
'*
'* Input:   None
'*
'* Output:  Help messages are displayed on screen.
'*
'********************************************************************
Private Sub ShowUsage()

    Wscript.Echo &quot;&quot;
    Wscript.Echo &quot;Gets and Sets DNS Server information &quot; _
    &amp; &quot;for a computer.&quot;
    Wscript.Echo &quot;&quot;
    Wscript.Echo &quot;SYNTAX:&quot;
    Wscript.Echo &quot;  DnsServer operation &lt;Parameter List&gt;&quot;
    Wscript.Echo &quot;                      [/S &lt;server&gt;] &quot; _
    &amp; &quot;[/U &lt;username&gt;] [/W &lt;password&gt;]&quot;
    Wscript.Echo &quot;                      [/O &lt;outputfile&gt;]&quot;
    Wscript.Echo &quot;&quot;
    Wscript.Echo &quot;  operation   [List | Create | Modify | Delete | &quot; _
    &amp; &quot;Pause | Resume |&quot;
    Wscript.Echo &quot;               Write | UpdateDS | Reload | &quot; _
    &amp; &quot;Refresh | AddIP | DeleteIP]&quot;
    Wscript.Echo &quot;&quot;
    Wscript.Echo &quot;    For help on a specific operation type:&quot;
    Wscript.Echo &quot;&quot;
    Wscript.Echo &quot;              DnsZones List /?&quot;
    Wscript.Echo &quot;              DnsZones Display /?&quot;
    Wscript.Echo &quot;              DnsZones Create /?&quot;
    Wscript.Echo &quot;              DnsZones Modify /?&quot;
    Wscript.Echo &quot;              DnsZones Delete /?&quot;
    Wscript.Echo &quot;              DnsZones AddIP /?&quot;
    Wscript.Echo &quot;              DnsZones DeleteIP /?&quot;
    Wscript.Echo &quot;              DnsZones Pause /?&quot;
    Wscript.Echo &quot;              DnsZones Resume /?&quot;
    Wscript.Echo &quot;              DnsZones Write /?&quot;
    Wscript.Echo &quot;              DnsZones UpdateDS /?&quot;
    Wscript.Echo &quot;              DnsZones Reload /?&quot;
    Wscript.Echo &quot;              DnsZones Refresh /?&quot;
    Wscript.Echo &quot;&quot;
    Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
    Wscript.Echo &quot;   server        A server name&quot;
    Wscript.Echo &quot;   username      The current user name&quot;
    Wscript.Echo &quot;   password      The current user password&quot;
    Wscript.Echo &quot;   outputfile    The output file name&quot;
    Wscript.Echo &quot;&quot;

End Sub

'********************************************************************
'*
'* Sub Display()
'*
'* Purpose: Shows a list of all available properties with
'*          descriptions.
'*
'* Input:   None
'*
'* Output:  Displayed on screen.
'*
'********************************************************************
Private Sub Display(strOutputFile, blnContextHelp)

    Dim objOutputFile

    ' Open a text file for output if the file is requested.
    If Not IsEmpty(strOutputFile) Then
        If (NOT blnOpenFile(strOutputFile, objOutputFile)) Then
            Call Wscript.Echo (&quot;Cannot open an output file.&quot;)
            Exit Sub
        End If
    End If

    If blnContextHelp then
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;Displays all available property types and &quot; _
        &amp; &quot;descriptions.&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;SYNTAX:&quot;
        Wscript.Echo &quot;  DnsServer Display [/S &lt;server&gt;] &quot; _
        &amp; &quot;[/U &lt;username&gt;] [/W &lt;password&gt;]&quot;
        Wscript.Echo &quot;                    [/O &lt;outputfile&gt;]&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;PARAMETER SPECIFIERS:&quot;
        Wscript.Echo &quot;   server        A server name&quot;
        Wscript.Echo &quot;   username      The current user name&quot;
        Wscript.Echo &quot;   password      The current user password&quot;
        Wscript.Echo &quot;   outputfile    The output file name&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;EXAMPLE&quot;
        Wscript.Echo &quot;&quot;
        Wscript.Echo &quot;  DnsZones.vbs Display&quot;
        Wscript.Echo &quot;&quot;
        Exit Sub
    End If

    Call WriteLine(&quot;Property            Type       Description&quot;,  _
    &amp; &quot;objOutputFile&quot;)
    Call WriteLine(&quot;-----------------------------------------------&quot; _
    &amp; &quot;------------------------------&quot;, objOutputFile)
    Call WriteLine(&quot; AllowUpdate        True/False This Boolean &quot; _
    &amp; &quot;indicates whether the Zone should&quot;, objOutputFile)
    Call WriteLine(&quot;                               accept dynamic &quot; _
    &amp; &quot;update requests.&quot;, objOutputFile)
    Call WriteLine(&quot; AutoCreated        read-only  This Boolean &quot; _
    &amp; &quot;indicates whether the Zone is&quot;, objOutputFile)
    Call WriteLine(&quot;                               autocreated.&quot;, _
    objOutputFile)
    Call WriteLine(&quot; ContainerName      read-only  Indicates the &quot; _
    &amp; &quot;Name of the Container (which&quot;, objOutputFile)
    Call WriteLine(&quot;                               could be a &quot; _
    &amp; &quot;Zone, Cache or RootHints)&quot;, objOutputFile)
    Call WriteLine(&quot;                               containing this &quot; _
    &amp; &quot;domain. In cases where the&quot;, objOutputFile)
    Call WriteLine(&quot;                               Container is a &quot; _
    &amp; &quot;Zone (an instance of the&quot;, objOutputFile)
    Call WriteLine(&quot;                               &quot; _
    &amp; &quot;MicrosoftDNS_Zone subclass), this property&quot;, objOutputFile)
    Call WriteLine(&quot;                               contains the &quot; _
    &amp; &quot;fully qualified domain name of&quot;, objOutputFile)
    Call WriteLine(&quot;                               the Zone. When &quot; _
    &amp; &quot;the Container is the root zone,&quot;, objOutputFile)
    Call WriteLine(&quot;                               the string, &quot; _
    &amp; &quot;&quot;&quot;.&quot;&quot;,should be used.  In cases&quot;, objOutputFile)
    Call WriteLine(&quot;                               where the &quot; _
    &amp; &quot;Container is the DNS' cache of&quot;, objOutputFile)
    Call WriteLine(&quot;                               resource &quot; _
    &amp; &quot;records (an instance of the&quot;, objOutputFile)
    Call WriteLine(&quot;                               &quot; _
    &amp; &quot;MicrosoftDNS_Cache subclass), this property is&quot;, objOutputFile)
    Call WriteLine(&quot;                               set to the &quot; _
    &amp; &quot;string, &quot;&quot;..Cache&quot;&quot;.  If the &quot;, objOutputFile)
    Call WriteLine(&quot;                               Container is &quot; _
    &amp; &quot;Root Hints (an instance of the&quot;, objOutputFile)
    Call WriteLine(&quot;                               &quot; _
    &amp; &quot;MicrosoftDNS_RootHints subclass), then this&quot;, objOutputFile)
    CAll WriteLine(&quot;                               property should &quot; _
    &amp; &quot;be set to &quot;&quot;..RootHints&quot;&quot;.&quot;, objOutputFile)
    Call WriteLine(&quot; ZoneFile           read-only  Indicates the &quot; _
    &amp; &quot;name of the zone file.&quot;, objOutputFile)
    Call WriteLine(&quot; DisableWins        True/False This Boolean &quot; _
    &amp; &quot;indicates whether the WINS record&quot;, objOutputFile)
    Call WriteLine(&quot;                               is NOT &quot; _
    &amp; &quot;replicated. If set to TRUE, WINS record&quot;, objOutputFile)
    Call WriteLine(&quot;                               replication &quot; _
    &amp; &quot;is disabled.&quot;, objOutputFile)
    Call WriteLine(&quot; Notify             True/False This Boolean &quot; _
    &amp; &quot;indicates whether the master Zone&quot;, objOutputFile)
    Call WriteLine(&quot;                               notifies &quot; _
    &amp; &quot;secondaries of any changes in its&quot;, objOutputFile)
    Call WriteLine(&quot;                               Resource &quot; _
    &amp; &quot;Records database. If set to TRUE,&quot;, objOutputFile)
    Call WriteLine(&quot;                               secondaries are &quot; _
    &amp; &quot;notified.&quot;, objOutputFile)
    Call WriteLine(&quot; Paused             read-only  This Boolean &quot; _
    &amp; &quot;indicates whether the Zone is&quot;, objOutputFile)
    Call WriteLine(&quot;                               paused.&quot;, _
    objOutputFile)
    Call WriteLine(&quot; Reverse            True/False This Boolean &quot; _
    &amp; &quot;indicates whether the Zone is&quot;, objOutputFile)
    Call WriteLine(&quot;                               reverse (TRUE) &quot; _
    &amp; &quot;or forward (FALSE).&quot;, objOutputFile)
    Call WriteLine(&quot; SecureSecondaries  True/False This Boolean &quot; _
    &amp; &quot;indicates whether zone transfer&quot;, objOutputFile)
    Call WriteLine(&quot;                               is allowed - &quot; _
    &amp; &quot;but only to designated&quot;, objOutputFile)
    Call WriteLine(&quot;                               secondaries.  &quot; _
    &amp; &quot;Designated secondaries are DNS&quot;, objOutputFile)
    Call WriteLine(&quot;                               servers &quot; _
    &amp; &quot;whose IP addresses are listed in the&quot;, objOutputFile)
    Call WriteLine(&quot;                               array, &quot; _
    &amp; &quot;SecondariesIPAddressesArray.&quot;, objOutputFile)
    Call WriteLine(&quot; Shutdown           read-only  This Boolean &quot; _
    &amp; &quot;indicates whether the copy of the&quot;, objOutputFile)
    Call WriteLine(&quot;                               Zone is &quot; _
    &amp; &quot;expired. If TRUE, the Zone is expired,&quot;, objOutputFile)
    Call WriteLine(&quot;                               or 'shutdown'.&quot;, _
    objOutputFile)
    Call WriteLine(&quot; UseWins            read-only  This Boolean &quot; _
    &amp; &quot;indicates whether the Zone uses&quot;, objOutputFile)
    Call WriteLine(&quot;                               WINS lookup.&quot;, _
    objOutputFile)
    Call WriteLine(&quot; ZoneType           Number     Indicates the &quot; _ 
    &amp; &quot;type of the Zone.&quot;, objOutputFile)    
    Call WriteLine(&quot;                    &quot;&quot;0&quot;&quot;        DS Integrated &quot; _
    &amp; &quot;Zone&quot;, objOutputFile)
    Call WriteLine(&quot;                    &quot;&quot;1&quot;&quot;        Primary Zone&quot;, _
    objOutputFile)
    Call WriteLine(&quot;                    &quot;&quot;2&quot;&quot;        Secondary &quot; _
    &amp; &quot;Zone&quot;, objOutputFile)
    Call WriteLine(&quot;&quot;, objOutputFile)
    Call WriteLine(&quot;IP Array            Type       Description&quot;, _
    objOutputFile)
    Call WriteLine(&quot;-----------------------------------------------&quot; _
    &amp; &quot;------------------------------&quot;, objOutputFile)
    Call WriteLine(&quot; NotifyIP           Array      This array of &quot; _
    &amp; &quot;strings enumerates the list of&quot;, objOutputFile)
    Call WriteLine(&quot;                               IP addresses of &quot; _
    &amp; &quot;the DNS servers that should be&quot;, objOutputFile)
    Call WriteLine(&quot;                               notified of &quot; _
    &amp; &quot;changes in this zone.&quot;, objOutputFile)
    Call WriteLine(&quot; MastersIP          Array      This array of &quot; _
    &amp; &quot;strings enumerates the list of&quot;, objOutputFile)
    Call WriteLine(&quot;                               IP addresses of &quot; _
    &amp; &quot;Master DNS servers, to be&quot;, objOutputFile)
    Call WriteLine(&quot;                               addressed for &quot; _
    &amp; &quot;zone replication. It is&quot;, objOutputFile)
    Call WriteLine(&quot;                               applicable to &quot; _
    &amp; &quot;secondary zones only (ZoneType =&quot;, objOutputFile)
    Call WriteLIne(&quot;                               2, &quot; _
    &amp; &quot; &quot;&quot;Secondary&quot;&quot;).&quot;, objOutputFile)
    Call WriteLine(&quot; SecondariesIP      Array      This array of &quot; _
    &amp; &quot;strings enumerates the list of&quot;, objOutputFile)
    Call WriteLine(&quot;                               IP addresses of &quot; _
    &amp; &quot;the DNS servers that are&quot;, objOutputFile)
    Call WriteLine(&quot;                               allowed to &quot; _
    &amp; &quot;receive this zone through zone&quot;, objOutputFile)
    Call WriteLine(&quot;                               replication.&quot;, _
    objOutputFile)
    Call WriteLine(&quot;&quot;, objOutputFile)
    
    
    If IsObject(objOutputFile) Then
        objOutputFile.Close
        Call Wscript.Echo (&quot;Results are saved in file &quot; _
        &amp; strOutputFile &amp; &quot;.&quot;)
    End If
    
End Sub

'********************************************************************
'* General Routines
'********************************************************************

'********************************************************************
'*
'* Function strDisplayNull()
'*
'* Purpose: Returns the input or a &quot;&lt;NULL&gt;&quot; string.
'*
'* Input:   strProperty     the property to be evaluated
'*
'* Output:  The input or a &quot;&lt;NULL&quot;&gt; string.
'*
'********************************************************************

Function strDisplayNull(strProperty)

    If IsNull(strProperty) then
        strDisplayNull = &quot;&lt;NULL&gt;&quot;
    Else
        strDisplayNull = strProperty
    End If

End Function

'********************************************************************
'*
'* Function strPackString()
'*
'* Purpose: Attaches spaces to a string to increase the length to 
'*          intWidth.
'*
'* Input:   strString   a string
'*          intWidth    the intended length of the string
'*          blnAfter    Should spaces be added after the string?
'*          blnTruncate specifies whether to truncate the string or
'*                      not if the string length is longer than 
'*                      intWidth
'*
'* Output:  strPackString is returned as the packed string.
'*
'********************************************************************
Private Function strPackString( ByVal strString, _
                                ByVal intWidth,  _
                                ByVal blnAfter,  _
                                ByVal blnTruncate)

    ON ERROR RESUME NEXT

    intWidth      = CInt(intWidth)
    blnAfter      = CBool(blnAfter)
    blnTruncate   = CBool(blnTruncate)

    If Err.Number Then
        Call Wscript.Echo (&quot;Argument type is incorrect!&quot;)
        Err.Clear
        Wscript.Quit
    End If

    If IsNull(strString) Then
        strPackString = &quot;null&quot; &amp; Space(intWidth-4)
        Exit Function
    End If

    strString = CStr(strString)
    If Err.Number Then
        Call Wscript.Echo (&quot;Argument type is incorrect!&quot;)
        Err.Clear
        Wscript.Quit
    End If

    If intWidth &gt; Len(strString) Then
        If blnAfter Then
            strPackString = strString &amp; Space(intWidth-Len(strString))
        Else
            strPackString = Space(intWidth-Len(strString)) _
            &amp; strString &amp; &quot; &quot;
        End If
    Else
        If blnTruncate Then
            strPackString = Left(strString, intWidth-1) &amp; &quot; &quot;
        Else
            strPackString = strString &amp; &quot; &quot;
        End If
    End If

End Function

'********************************************************************
'* 
'*  Function blnGetArg()
'*
'*  Purpose: Helper to intParseCmdLine()
'* 
'*  Usage:
'*
'*     Case &quot;/s&quot; 
'*       blnGetArg (&quot;server name&quot;, strServer, intArgIter)
'*
'********************************************************************
Private Function blnGetArg ( ByVal StrVarName,   _
                             ByRef strVar,       _
                             ByRef intArgIter) 

    blnGetArg = False 'failure, changed to 
                      'True upon successful completion

    If Len(Wscript.Arguments(intArgIter)) &gt; 2 then
        If Mid(Wscript.Arguments(intArgIter),3,1) = &quot;:&quot; then
            If Len(Wscript.Arguments(intArgIter)) &gt; 3 then
                strVar = Right(Wscript.Arguments(intArgIter), _
                         Len(Wscript.Arguments(intArgIter)) - 3)
                blnGetArg = True
                Exit Function
            Else
                intArgIter = intArgIter + 1
                If intArgIter &gt; (Wscript.Arguments.Count - 1) Then
                    Call Wscript.Echo( &quot;Invalid &quot; &amp; StrVarName &amp; &quot;.&quot;)
                    Call Wscript.Echo( &quot;Please check the input and try again.&quot;)
                    Exit Function
                End If

                strVar = Wscript.Arguments.Item(intArgIter)
                If Err.Number Then
                    Call Wscript.Echo( &quot;Invalid &quot; &amp; StrVarName &amp; &quot;.&quot;)
                    Call Wscript.Echo( &quot;Please check the input and try again.&quot;)
                    Exit Function
                End If

                If InStr(strVar, &quot;/&quot;) Then
                    Call Wscript.Echo( &quot;Invalid &quot; &amp; StrVarName)
                    Call Wscript.Echo( &quot;Please check the input and try again.&quot;)
                    Exit Function
                End If

                blnGetArg = True 'success
            End If
        Else
            strVar = Right(Wscript.Arguments(intArgIter), _
                     Len(Wscript.Arguments(intArgIter)) - 2)
            blnGetArg = True 'success
            Exit Function
        End If
    Else
        intArgIter = intArgIter + 1
        If intArgIter &gt; (Wscript.Arguments.Count - 1) Then
            Call Wscript.Echo( &quot;Invalid &quot; &amp; StrVarName &amp; &quot;.&quot;)
            Call Wscript.Echo( &quot;Please check the input and try again.&quot;)
            Exit Function
        End If

        strVar = Wscript.Arguments.Item(intArgIter)
        If Err.Number Then
            Call Wscript.Echo( &quot;Invalid &quot; &amp; StrVarName &amp; &quot;.&quot;)
            Call Wscript.Echo( &quot;Please check the input and try again.&quot;)
            Exit Function
        End If

        If InStr(strVar, &quot;/&quot;) Then
            Call Wscript.Echo( &quot;Invalid &quot; &amp; StrVarName)
            Call Wscript.Echo( &quot;Please check the input and try again.&quot;)
            Exit Function
        End If
        blnGetArg = True 'success
    End If
End Function

'********************************************************************
'*
'* Function blnConnect()
'*
'* Purpose: Connects to server strServer.
'*
'* Input:   strServer       A server name
'*          strNameSpace    a namespace
'*          strUserName     name of the current user
'*          strPassword     password of the current user
'*
'* Output:  objService is returned  as a service object.
'*          strServer is set to local host if left unspecified
'*
'********************************************************************
Private Function blnConnect(ByVal strNameSpace, _
                            ByVal strUserName,  _
                            ByVal strPassword,  _
                            ByRef strServer,    _
                            ByRef objService)

    ON ERROR RESUME NEXT

    Dim objLocator, objWshNet

    blnConnect = False     'There is no error.

    'Create Locator object to connect to remote CIM object manager
    Set objLocator = CreateObject(&quot;WbemScripting.SWbemLocator&quot;)
    If Err.Number then
        Call Wscript.Echo( &quot;Error 0x&quot; &amp; CStr(Hex(Err.Number)) &amp; _
                           &quot; occurred in creating a locator object.&quot; )
        If Err.Description &lt;&gt; &quot;&quot; Then
            Call Wscript.Echo( &quot;Error description: &quot; _
            &amp; Err.Description &amp; &quot;.&quot; )
        End If
        Err.Clear
        blnConnect = True     'An error occurred
        Exit Function
    End If

    'Connect to the namespace which is either local or remote
    Set objService = objLocator.ConnectServer (strServer, _
    strNameSpace, strUserName, strPassword)
    ObjService.Security_.impersonationlevel = 3
    If Err.Number then
        Call Wscript.Echo( &quot;Error 0x&quot; &amp; CStr(Hex(Err.Number)) &amp; _
                           &quot; occurred in connecting to server &quot; _
           &amp; strServer &amp; &quot;.&quot;)
        If Err.Description &lt;&gt; &quot;&quot; Then
            Call Wscript.Echo( &quot;Error description: &quot; _
            &amp; Err.Description &amp; &quot;.&quot; )
        End If
        Err.Clear
        blnConnect = True     'An error occurred
    End If

    'Get the current server's name if left unspecified
    If IsEmpty(strServer) Then
        Set objWshNet = CreateObject(&quot;Wscript.Network&quot;)
    strServer     = objWshNet.ComputerName
    End If

End Function

'********************************************************************
'*
'* Sub      VerifyHostIsCscript()
'*
'* Purpose: Determines which program is used to run this script.
'*
'* Input:   None
'*
'* Output:  If host is not cscript, then an error message is printed 
'*          and the script is aborted.
'*
'********************************************************************
Sub VerifyHostIsCscript()

    ON ERROR RESUME NEXT

    Dim strFullName, strCommand, i, j, intStatus

    strFullName = WScript.FullName

    If Err.Number then
        Call Wscript.Echo( &quot;Error 0x&quot; &amp; CStr(Hex(Err.Number)) _
        &amp; &quot; occurred.&quot; )
        If Err.Description &lt;&gt; &quot;&quot; Then
            Call Wscript.Echo( &quot;Error description: &quot; _
            &amp; Err.Description &amp; &quot;.&quot; )
        End If
        intStatus =  CONST_ERROR
    End If

    i = InStr(1, strFullName, &quot;.exe&quot;, 1)
    If i = 0 Then
        intStatus =  CONST_ERROR
    Else
        j = InStrRev(strFullName, &quot;\&quot;, i, 1)
        If j = 0 Then
            intStatus =  CONST_ERROR
        Else
            strCommand = Mid(strFullName, j+1, i-j-1)
            Select Case LCase(strCommand)
                Case &quot;cscript&quot;
                    intStatus = CONST_CSCRIPT
                Case &quot;wscript&quot;
                    intStatus = CONST_WSCRIPT
                Case Else       'should never happen
                    Call Wscript.Echo( &quot;An unexpected program was &quot; _
                    &amp; &quot;used to run this script.&quot; )
                    Call Wscript.Echo( &quot;Only CScript.Exe or &quot; _
                    &amp; &quot;WScript.Exe can be used to run this script.&quot; )
                    intStatus = CONST_ERROR
                End Select
        End If
    End If

    If intStatus &lt;&gt; CONST_CSCRIPT Then
        Call WScript.Echo( &quot;Please run this script using CScript.&quot; _
             &amp; vbCRLF &amp; &quot;This can be achieved by&quot; &amp; vbCRLF &amp; _
             &quot;1. Using &quot;&quot;CScript PS.VBS arguments&quot;&quot; for Windows &quot; _
             &amp; &quot;95/98 or &quot; &amp; vbCRLF &amp; &quot;2. Changing the default &quot; _
             &amp; &quot;Windows Script Host setting to CScript&quot; &amp; vbCRLF _
             &amp; &quot;    using &quot;&quot;CScript //H:CScript //S&quot;&quot; and running &quot; _
             &amp; &quot;the script using&quot; &amp; vbCRLF &amp; &quot;    &quot;&quot;PS.VBS &quot; _
             &amp; &quot;arguments&quot;&quot; for Windows NT/2000.&quot; )
        WScript.Quit
    End If

End Sub

'********************************************************************
'*
'* Sub WriteLine()
'* Purpose: Writes a text line either to a file or on screen.
'* Input:   strMessage  the string to print
'*          objFile     an output file object
'* Output:  strMessage is either displayed on screen or written to a
'*          file.
'*
'********************************************************************
Sub WriteLine(ByVal strMessage, ByVal objFile)

    On Error Resume Next
    If IsObject(objFile) then        'objFile should be a file object
        objFile.WriteLine strMessage
    Else
        Call Wscript.Echo( strMessage )
    End If

End Sub

'********************************************************************
'* 
'* Function blnErrorOccurred()
'*
'* Purpose: Reports error with a string that identifies
'*          what the error occurred in.
'*
'* Input:   strIn        String that identifies what the error 
'*                                                                                                                                                                                      occurred in.
'*
'* Output:  displayed on screen 
'* 
'********************************************************************
Private Function blnErrorOccurred (ByVal strIn)

    If Err.Number Then
        Call Wscript.Echo( &quot;Error 0x&quot; &amp; CStr(Hex(Err.Number)) &amp; &quot;: &quot;_
        &amp; strIn)
        If Err.Description &lt;&gt; &quot;&quot; Then
            Call Wscript.Echo(&quot;Error description: &quot; &amp; Err.Description)
        End If
        Err.Clear
        blnErrorOccurred = True
    Else
        blnErrorOccurred = False
    End If

End Function

'********************************************************************
'* 
'* Function blnOpenFile
'*
'* Purpose: Opens a file.
'*
'* Input:   strFileName        A string with the name of the file.
'*
'* Output:  Sets objOpenFile to a FileSystemObject and setis it to 
'*            Nothing upon Failure.
'* 
'********************************************************************
Private Function blnOpenFile(ByVal strFileName, ByRef objOpenFile)

    ON ERROR RESUME NEXT

    Dim objFileSystem

    Set objFileSystem = Nothing

    If IsEmpty(strFileName) OR strFileName = &quot;&quot; Then
        blnOpenFile = False
        Set objOpenFile = Nothing
        Exit Function
    End If

    ' Create a file object.
    Set objFileSystem = CreateObject(&quot;Scripting.FileSystemObject&quot;)
    If blnErrorOccurred(&quot;Could not create filesystem object.&quot;) Then
        blnOpenFile = False
        Set objOpenFile = Nothing
        Exit Function
    End If

    ' Open the file for output.
    Set objOpenFile = objFileSystem.OpenTextFile(strFileName, 8, True)
    If blnErrorOccurred(&quot;Could not open&quot;) Then
        blnOpenFile = False
        Set objOpenFile = Nothing
        Exit Function
    End If
    blnOpenFile = True

End Function

'********************************************************************
'*                                                                  *
'*                           End of File                            *
'*                                                                  *
'********************************************************************
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
