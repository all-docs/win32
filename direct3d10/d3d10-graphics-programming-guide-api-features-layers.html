<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>API Layers (Direct3D 10)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: API Layers (Direct3D 10)
ms.assetid: 19c81383-6ac7-49ea-98a3-bf761a32ab40
title: API Layers (Direct3D 10)
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>API Layers (Direct3D 10)</h1>
<p>The Direct3D 10 runtime is constructed with layers, starting with the basic functionality at the core and building optional and developer-assist functionality in outer layers.</p>
<h2>Core Layer</h2>
<p>The core layer exists by default; providing a very thin mapping between the API and the device driver, minimizing overhead for high-frequency calls. As the core layer is essential for performance, it only performs critical validation.</p>
<p>The remaining layers are optional. As a general rule, layers add functionality, but do not modify existing behavior. For example, core functions will have the same return values independent of the debug layer being instantiated, although additional debug output may be provided if the debug layer is instantiated.</p>
<p>Create layers when a device is created by calling <a href="/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice"><strong>D3D10CreateDevice</strong></a> and supplying one or more <a href="/windows/desktop/api/D3D10/ne-d3d10-d3d10_create_device_flag"><strong>D3D10_CREATE_DEVICE_FLAG</strong></a> values.</p>
<h2>Debug Layer</h2>
<p>The debug layer provides extensive additional parameter and consistency validation (such as validating shader linkage and resource binding, validating parameter consistency, and reporting error descriptions). The output generated by the debug layer consists of a queue of strings which are accessible using the <a href="/windows/desktop/api/D3D10SDKLayers/nn-d3d10sdklayers-id3d10infoqueue"><strong>ID3D10InfoQueue Interface</strong></a> (see <a href="d3d10-graphics-programming-guide-api-features-layers-info-queue.html">Customize Debug Output with ID3D10InfoQueue (Direct3D 10)</a>). Errors generated by the core layer are highlighted with warnings by the debug layer.</p>
<p>To create a device that supports the debug layer, you must install the DirectX SDK (to get D3D10SDKLayers.DLL), and then specify the D3D10_CREATE_DEVICE_DEBUG flag when calling <a href="/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice"><strong>D3D10CreateDevice</strong></a>. Of course, running an application with the debug layer will be substantially slower. To enable/disable debug messages for D3DX10 APIs, call <a href="d3dx10debugmute.html"><strong>D3DX10DebugMute</strong></a>.</p>
<p>When the debug layer lists memory leaks, it outputs a list of object interface pointers along with their friendly names. The default friendly name is &quot;&lt;unnamed&gt;&quot;. You can set the friendly name by using the <a href="/windows/desktop/api/D3D10/nf-d3d10-id3d10devicechild-setprivatedata"><strong>ID3D10DeviceChild::SetPrivateData</strong></a> method and the <strong>WKPDID_D3DDebugObjectName</strong> GUID that is in D3Dcommon.h. For example, to name pTexture with a SDKLayer name of mytexture.jpg, use the following code:</p>
<pre><code>const char c_szName[] = &quot;mytexture.jpg&quot;;
pTexture-&gt;SetPrivateData( WKPDID_D3DDebugObjectName, sizeof( c_szName ) - 1, c_szName );
</code></pre>
<p>Typically, you should compile these calls out of your production version.</p>
<h2>Switch-to-Reference Layer</h2>
<p>This layer enables an application to transition between a hardware device (HAL) and a reference or software device (REF). To switch a device, you must first create a device that supports the switch-to-reference layer (see <a href="/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice"><strong>D3D10CreateDevice</strong></a>) and then call <a href="/windows/desktop/api/D3D10SDKLayers/nf-d3d10sdklayers-id3d10switchtoref-setuseref"><strong>ID3D10SwitchToRef::SetUseRef</strong></a>.</p>
<p>All device states, resources and objects are maintained through this device transition. However, it is sometimes not possible to exactly match resource data. This is due to the fact that some information is available to a hardware device that is not available to a reference device.</p>
<p>Virtually all real-time applications use the HAL implementation of the pipeline. When the pipeline is switched from a hardware device to a reference device, rendering operations are done simultaneously in both hardware and software. As the software device is rendering, it will require that resources are downloaded to system memory. This may require other resources cached in system memory to be evicted to make room.</p>
<blockquote>
<p>[!Note]<br />
This switch-to-reference-layer feature is supported only in Direct3D 10 and Direct3D 10.1, and is no longer supported in Direct3D 11 and later versions.</p>
</blockquote>
<p>Â </p>
<h2>Thread-Safe Layer</h2>
<p>This layer is designed to allow multi-threaded applications to access the device from multiple threads.</p>
<p>A Direct3D 10 application can control a device synchronization using device functions. This enables an application to enable/disable critical sections (temporarily enabling/disabling multithreading protection), and take/release a critical-section lock over multiple Direct3D 10 API entry points. The thread-safe layer is enabled by default. For single-threaded applications, the thread-safe layer has no impact on performance.</p>
<p>Differences between Direct3D 9 and Direct3D 10:</p>
<ul>
<li>Unlike Direct3D 9, the Direct3D 10 API defaults to fully thread-safe.</li>
</ul>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="d3d10-graphics-programming-guide-api-features.html">API Features (Direct3D 10)</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
