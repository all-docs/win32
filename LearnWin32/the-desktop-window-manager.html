<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>The Desktop Window Manager</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: The Desktop Window Manager
description: The Desktop Window Manager
ms.assetid: 79250d49-dad5-46c6-892d-b92dac14b417
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>The Desktop Window Manager</h1>
<p>Before WindowsÂ Vista, a Windows program would draw directly to the screen. In other words, the program would write directly to the memory buffer shown by the video card. This approach can cause visual artifacts if a window does not repaint itself correctly. For example, if the user drags one window over another window, and the window underneath does not repaint itself quickly enough, the top-most window can leave a trail:</p>
<p><img src="images/graphics04.png" alt="a screenshot that shows repaint artifacts." /></p>
<p>The trail is caused because both windows paint to the same area of memory. As the top-most window is dragged, the window below it must be repainted. If the repainting is too slow, it causes the artifacts shown in the previous image.</p>
<p>WindowsÂ Vista fundamentally changed how windows are drawn, by introducing the Desktop Window Manager (DWM). When the DWM is enabled, a window no longer draws directly to the display buffer. Instead, each window draws to an offscreen memory buffer, also called an <em>offscreen surface</em>. The DWM then composites these surfaces to the screen.</p>
<p><img src="images/graphics05.png" alt="a diagram that shows how the dwm composites the desktop." /></p>
<p>The DWM provides several advantages over the old graphics architecture.</p>
<ul>
<li>Fewer repaint messages. When a window is obstructed by another window, the obstructed window does not need to repaint itself.</li>
<li>Reduced artifacts. Previously, dragging a window could create visual artifacts, as described.</li>
<li>Visual effects. Because the DWM is in charge of compositing the screen, it can render translucent and blurred areas of the window.</li>
<li>Automatic scaling for high DPI. Although scaling is not the ideal way to handle high DPI, it is a viable fallback for older applications that were not designed for high DPI settings. (We will return to this topic later, in the section <a href="dpi-and-device-independent-pixels.html">DPI and Device-Independent Pixels</a>.)</li>
<li>Alternative views. The DWM can use the offscreen surfaces in various interesting ways. For example, the DWM is the technology behind Windows Flip 3D, thumbnails, and animated transitions.</li>
</ul>
<p>Note, however, that the DWM is not guaranteed to be enabled. The graphics card might not support the DWM system requirements, and users can disable the DWM through the <strong>System Properties</strong> control panel. That means your program should not rely on the repainting behavior of the DWM. Test your program with DWM disabled to make sure that it repaints correctly.</p>
<h2>Next</h2>
<p><a href="retained-mode-versus-immediate-mode.html">Retained Mode Versus Immediate Mode</a></p>
<p>Â </p>
<p>Â </p>
</body>
