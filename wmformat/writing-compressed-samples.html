<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Writing Compressed Samples</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Writing Compressed Samples
description: Writing Compressed Samples
ms.assetid: f85ca719-1b9d-404f-b2b1-c9e3524e4bc6
keywords:</p>
<ul>
<li>Advanced Systems Format (ASF),writing compressed samples</li>
<li>ASF (Advanced Systems Format),writing compressed samples</li>
<li>Advanced Systems Format (ASF),passing compressed samples</li>
<li>ASF (Advanced Systems Format),passing compressed samples
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Writing Compressed Samples</h1>
<p>[The feature associated with this page, <a href="/windows/win32/wmformat/windows-media-format-11-sdk">Windows Media Format 11 SDK</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/medfound/source-reader">Source Reader</a> and <a href="/windows/win32/medfound/sink-writer">Sink Writer</a>. <strong>Source Reader</strong> and <strong>Sink Writer</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Source Reader</strong> and <strong>Sink Writer</strong> instead of <strong>Windows Media Format 11 SDK</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>For some audio or video streams, you may want to pass samples that are already compressed instead of passing raw data. This feature is used to copy an existing stream or to write samples compressed with a third-party codec. The process of writing a compressed sample is identical to writing an uncompressed sample, except that you use <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriteradvanced-writestreamsample"><strong>IWMWriterAdvanced::WriteStreamSample</strong></a> instead of <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-writesample"><strong>IWMWriter::WriteSample</strong></a>. For more information about writing uncompressed samples, see <a href="to-write-samples.html">To Write Samples</a>.</p>
<p>When you write compressed samples, for CBR profiles, the writer will drop some samples, if necessary, to keep the content within the specified bit rate and buffer window values. For VBR, the writer will not drop samples, but there is no way to be sure that the bit rate and buffer window values will be correct.</p>
<p>If you are copying a stream from one file to another, you should always copy the stream configuration object from the profile of the original file to the profile of the new file. This ensures that you have the correct bit rate and buffer window information. If you copy a compressed stream to a stream that has a lower buffer window set, samples will be dropped during file writing.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="writing-asf-files.html"><strong>Writing ASF Files</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
