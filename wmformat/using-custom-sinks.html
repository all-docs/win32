<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Custom Sinks</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Using Custom Sinks
description: Using Custom Sinks
ms.assetid: 7151583a-c7ab-40b0-a7bf-ddd56f93b7aa
keywords:</p>
<ul>
<li>Advanced Systems Format (ASF),custom sinks</li>
<li>ASF (Advanced Systems Format),custom sinks</li>
<li>Advanced Systems Format (ASF),sinks</li>
<li>ASF (Advanced Systems Format),sinks</li>
<li>sinks,custom sinks</li>
<li>custom sinks,about</li>
<li>writer sinks,custom sinks</li>
<li>custom sinks,IWMWriterSink interface</li>
<li>IWMWriterSink</li>
<li>writer sinks,IWMWriterSink interface
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Using Custom Sinks</h1>
<p>[The feature associated with this page, <a href="/windows/win32/wmformat/windows-media-format-11-sdk">Windows Media Format 11 SDK</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/medfound/source-reader">Source Reader</a> and <a href="/windows/win32/medfound/sink-writer">Sink Writer</a>. <strong>Source Reader</strong> and <strong>Sink Writer</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Source Reader</strong> and <strong>Sink Writer</strong> instead of <strong>Windows Media Format 11 SDK</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>If you have a special writing need, you can create your own writer sinks. The writer maintains one-way communication with a sink by making calls to the methods of <a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwritersink"><strong>IWMWriterSink</strong></a>. To create your own sink, implement the <strong>IWMWriterSink</strong> interface in a class in your application. This process is very similar to implementing any other callback interface used by the objects of the Windows Media Format SDK. For more information about callbacks, see <a href="using-the-callback-methods.html">Using the Callback Methods</a>.</p>
<p>The buffer received in <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwritersink-onheader"><strong>IWMWriterSink::OnHeader</strong></a> should be written to the beginning of the file, and all buffers received in <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwritersink-ondataunit"><strong>OnDataUnit</strong></a> should be written out sequentially. <strong>OnHeader</strong> will be called at the beginning but might be called at other times, too, and if it is, you should, if possible, overwrite the original header. If your application is not able to do this for some reason, then simply ignore the subsequent <strong>OnHeader</strong> calls.</p>
<p>Your custom sink should communicate its status to your writing application by making calls to the <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus"><strong>IWMStatusCallback::OnStatus</strong></a> callback method. If you implement your sink as a COM object, you may want to expose the <a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmregistercallback"><strong>IWMRegisterCallback</strong></a> interface. However, you can pass the address of the <strong>OnStatus</strong> callback to your sink and set a context in any way you like.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="working-with-writer-sinks.html"><strong>Working with Writer Sinks</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
