<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Creating Profiles</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Creating Profiles
description: Creating Profiles
ms.assetid: af4a8efe-d797-4d19-961d-b917e4c7c81a
keywords:</p>
<ul>
<li>Windows Media Format SDK,profiles</li>
<li>profiles,creating</li>
<li>profiles,IWMProfileManager interface</li>
<li>IWMProfileManager,creating profiles</li>
<li>profiles,WMCreateProfileManager function</li>
<li>WMCreateProfileManager
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Creating Profiles</h1>
<p>[The feature associated with this page, <a href="/windows/win32/wmformat/windows-media-format-11-sdk">Windows Media Format 11 SDK</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/medfound/source-reader">Source Reader</a> and <a href="/windows/win32/medfound/sink-writer">Sink Writer</a>. <strong>Source Reader</strong> and <strong>Sink Writer</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Source Reader</strong> and <strong>Sink Writer</strong> instead of <strong>Windows Media Format 11 SDK</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>In many cases, you will want to create an empty profile to configure for your needs. In other cases it is easier to edit an existing profile, like a system profile. For more information about using system profiles, see <a href="using-system-profiles.html">Using System Profiles</a>.</p>
<p>Creating an empty profile, ready for you to configure, requires a profile manager object. To get the <a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmprofilemanager"><strong>IWMProfileManager</strong></a> interface of a profile manager object, call the <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-wmcreateprofilemanager"><strong>WMCreateProfileManager</strong></a> function.</p>
<p>To create an empty profile, call <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmprofilemanager-createemptyprofile"><strong>IWMProfileManager::CreateEmptyProfile</strong></a>. When you create an empty profile, the only thing you specify is the version of the Windows Media Format SDK with which the profile complies. Unless you have a specific need to use a previous version, you should always use the latest version. The version dictates the structure of the profile; previous versions did not support some properties.</p>
<p>The following example code shows how to create a new profile. To compile this code in your application, include stdio.h. For more information about using this code, see <a href="using-the-code-examples.html">Using the Code Examples</a>.</p>
<pre lang="C++"><code>HRESULT CreateProfile(IWMProfileManager* pProfileMgr, IWMProfile** ppProfile)
{
    HRESULT hr = S_OK;

    // Create the empty profile.
    hr = pProfileMgr-&gt;CreateEmptyProfile(WMT_VER_9_0, ppProfile);
    if(FAILED(hr))
    {
        printf(&quot;Could not create the profile.\n&quot;);
        return hr;
    }

    return S_OK;
}
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="iwmprofile.html"><strong>IWMProfile Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmprofilemanager"><strong>IWMProfileManager Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="working-with-profiles.html"><strong>Working with Profiles</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
