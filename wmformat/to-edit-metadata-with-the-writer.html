<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>To Edit Metadata with the Writer</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: To Edit Metadata with the Writer
description: To Edit Metadata with the Writer
ms.assetid: 86badfe3-64bc-4285-a231-f6c0ebf4f262
keywords:</p>
<ul>
<li>Windows Media Format SDK,editing metadata with the writer</li>
<li>Windows Media Format SDK,metadata editing</li>
<li>Advanced Systems Format (ASF),editing metadata with the writer</li>
<li>ASF (Advanced Systems Format),editing metadata with the writer</li>
<li>Advanced Systems Format (ASF),metadata editing</li>
<li>ASF (Advanced Systems Format),metadata editing</li>
<li>metadata,editing with the writer
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>To Edit Metadata with the Writer</h1>
<p>[The feature associated with this page, <a href="/windows/win32/wmformat/windows-media-format-11-sdk">Windows Media Format 11 SDK</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/medfound/source-reader">Source Reader</a> and <a href="/windows/win32/medfound/sink-writer">Sink Writer</a>. <strong>Source Reader</strong> and <strong>Sink Writer</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Source Reader</strong> and <strong>Sink Writer</strong> instead of <strong>Windows Media Format 11 SDK</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>You can access, directly from the writer, the metadata that will go into the header of the file. Call the <strong>QueryInterface</strong> method of any interface in the writer object to obtain a pointer to the <a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmheaderinfo"><strong>IWMHeaderInfo</strong></a> or <a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmheaderinfo2"><strong>IWMHeaderInfo2</strong></a> interface. After you have a pointer to the appropriate interface, you can manipulate the metadata just as you would if you had loaded the file in the metadata editor object. For more information about editing metadata, see <a href="working-with-metadata.html">Working with Metadata</a>.</p>
<p>You must make all changes to the metadata before calling <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-beginwriting"><strong>IWMWriter::BeginWriting</strong></a>.</p>
<blockquote>
<p>[!Note]<br />
If you set metadata for a file, write the file, and then prepare to write a new file without releasing the writer, some metadata that was set for the first file will remain set and will be included with subsequent files. When writing several files with the same instance of the writer object, you have two options: check all the metadata before writing each file, or only write in the writer metadata that applies to all of the files you are writing.</p>
</blockquote>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="writing-asf-files.html"><strong>Writing ASF Files</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
