<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Writer Object</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Writer Object
description: Writer Object
ms.assetid: 8058b7fe-7d02-4572-ad43-6867d4ceb7e9
keywords:</p>
<ul>
<li>Windows Media Format SDK,writer objects</li>
<li>Advanced Systems Format (ASF),writer objects</li>
<li>ASF (Advanced Systems Format),writer objects</li>
<li>objects,writer objects</li>
<li>writer objects
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Writer Object</h1>
<p>[The feature associated with this page, <a href="/windows/win32/wmformat/windows-media-format-11-sdk">Windows Media Format 11 SDK</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/medfound/source-reader">Source Reader</a> and <a href="/windows/win32/medfound/sink-writer">Sink Writer</a>. <strong>Source Reader</strong> and <strong>Sink Writer</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Source Reader</strong> and <strong>Sink Writer</strong> instead of <strong>Windows Media Format 11 SDK</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The writer object is used to write digital media files using the advanced systems format (ASF) file structure. The process of writing a digital media file involves many steps internal to the writer, which coordinates compression, packetization, and multiplexing.</p>
<p>The writer object includes interfaces for output to files or a network, supports one callback interface, and can create one or more input media properties objects.</p>
<p>The writer object is created by the function <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-wmcreatewriter"><strong>WMCreateWriter</strong></a>, which sets a pointer to an <strong>IWMWriter</strong> interface. The other interfaces of the writer object can be obtained by calling the <strong>QueryInterface</strong> method.</p>
<p>The following interfaces are supported by the writer object.</p>
<table>
<thead>
<tr>
<th>Interface</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmdrmwriter"><strong>IWMDRMWriter</strong></a></td>
<td>Provides methods to generate <a href="wmformat-glossary.html"><em>DRM</em></a> keys.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmdrmwriter2"><strong>IWMDRMWriter2</strong></a></td>
<td>Configures the writer object to write a file containing a pre-encrypted stream that conforms to the Windows Media DRM 10 for Network Devices protocol.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmheaderinfo"><strong>IWMHeaderInfo</strong></a></td>
<td>Manages the specification and retrieval of header information, such as metadata, <a href="wmformat-glossary.html"><em>markers</em></a>, and so on.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmheaderinfo2"><strong>IWMHeaderInfo2</strong></a></td>
<td>Manages enumerating through the available codec information. Inherits all of the methods of <strong>IWMHeaderInfo</strong>.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmheaderinfo3"><strong>IWMHeaderInfo3</strong></a></td>
<td>Manages enumerating through the available codec information. Inherits all of the methods of <strong>IWMHeaderInfo</strong> and <strong>IWMHeaderInfo2</strong>.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwatermarkinfo"><strong>IWMWatermarkInfo</strong></a></td>
<td>Provides access to information about watermarking systems present on the system.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriter"><strong>IWMWriter</strong></a></td>
<td>Starts and stops the writing of ASF files; it includes methods for allocating buffers, setting and retrieving input properties, setting profiles and output file names, and unlocking the writer.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriteradvanced"><strong>IWMWriterAdvanced</strong></a></td>
<td>Adds, gets, and removes specified sink objects; retrieves statistics, number of sinks, and the clock time the writer is working to; and performs other advanced functions.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriteradvanced2"><strong>IWMWriterAdvanced2</strong></a></td>
<td>Provides some advanced functionality, particularly for handling deinterlaced video. Inherits all of the methods of <strong>IWMWriterAdvanced</strong>.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriteradvanced3"><strong>IWMWriterAdvanced3</strong></a></td>
<td>Provides additional writer functionality, including the ability to get detailed writer statistics. Inherits all of the methods of <strong>IWMWriterAdvanced</strong> and <strong>IWMWriterAdvanced2</strong>.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriterpostview"><strong>IWMWriterPostView</strong></a></td>
<td>Manages some advanced writing functionality related to postviewing samples. Postviewing is viewing the output, usually from an encoder, to check that the encoding/decoding process is working correctly.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriterpreprocess"><strong>IWMWriterPreprocess</strong></a></td>
<td>Manages preprocessing passes made by the writer. Preprocessing passes are used to improve the quality of encoded output.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The following callback interface must be implemented by the application to track the progress of postviewing.</p>
<table>
<thead>
<tr>
<th>Interface</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriterpostviewcallback"><strong>IWMWriterPostViewCallback</strong></a></td>
<td>Manages how uncompressed samples are received from the writer object to preview what the codec is doing.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="objects.html"><strong>Objects</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="writing-asf-files.html"><strong>Writing ASF Files</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
