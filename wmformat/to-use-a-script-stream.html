<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>To Use a Script Stream</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: To Use a Script Stream
description: To Use a Script Stream
ms.assetid: 502b1f66-213d-41d8-992a-9bef4f6209f9
keywords:</p>
<ul>
<li>Windows Media Format SDK,script streams</li>
<li>Advanced Systems Format (ASF),script streams</li>
<li>ASF (Advanced Systems Format),script streams</li>
<li>script streams,about
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>To Use a Script Stream</h1>
<p>[The feature associated with this page, <a href="/windows/win32/wmformat/windows-media-format-11-sdk">Windows Media Format 11 SDK</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/medfound/source-reader">Source Reader</a> and <a href="/windows/win32/medfound/sink-writer">Sink Writer</a>. <strong>Source Reader</strong> and <strong>Sink Writer</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Source Reader</strong> and <strong>Sink Writer</strong> instead of <strong>Windows Media Format 11 SDK</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>This section describes how to send script data to the writer for inclusion in a file. For information about including script streams in profiles, see <a href="configuring-arbitrary-stream-types.html">Configuring Arbitrary Stream Types</a>.</p>
<p>Each script consists of two strings, a <em>type</em> string and an <em>argument</em> string.</p>
<p>The script data must be formatted before it is sent to the writer. The strings should be concatenated, separated by a <strong>NULL</strong> character, and terminated with a <strong>NULL</strong> character. The following example shows a legitimate script:</p>
<table>
<thead>
<tr>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
<th> </th>
</tr>
</thead>
<tbody>
<tr>
<td>U</td>
<td>R</td>
<td>L</td>
<td> </td>
<td>h</td>
<td>t</td>
<td>t</td>
<td>p</td>
<td>:</td>
<td>/</td>
<td>/</td>
<td>w</td>
<td>w</td>
<td>w</td>
<td>.</td>
<td>a</td>
<td>d</td>
<td>a</td>
<td>t</td>
<td>u</td>
<td>m</td>
<td>.</td>
<td>c</td>
<td>o</td>
<td>m</td>
<td> </td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Each pair of script commands should be written as a sample to the writer. For more information about writing samples, see <a href="to-write-samples.html">To Write Samples</a>.</p>
<p>When the ASF file is played, the script commands will be delivered by the reader (or synchronous reader) in presentation time order. It is the responsibility of the application to parse the two strings and respond to the script command.</p>
<blockquote>
<p>[!Note]<br />
When using DRM to encrypt a file, no script command can have a presentation time of 0.</p>
</blockquote>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="using-script-commands.html"><strong>Using Script Commands</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
