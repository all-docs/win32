<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Buffer Object</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Buffer Object
description: Buffer Object
ms.assetid: 0812261c-698c-4071-929c-4363a16dd5a8
keywords:</p>
<ul>
<li>Windows Media Format SDK,buffer objects</li>
<li>Advanced Systems Format (ASF),buffer objects</li>
<li>ASF (Advanced Systems Format),buffer objects</li>
<li>objects,buffer objects</li>
<li>buffer objects
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Buffer Object</h1>
<p>[The feature associated with this page, <a href="/windows/win32/wmformat/windows-media-format-11-sdk">Windows Media Format 11 SDK</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/medfound/source-reader">Source Reader</a> and <a href="/windows/win32/medfound/sink-writer">Sink Writer</a>. <strong>Source Reader</strong> and <strong>Sink Writer</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Source Reader</strong> and <strong>Sink Writer</strong> instead of <strong>Windows Media Format 11 SDK</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>A buffer object is used to hold samples and deliver them between the objects of the Windows Media Format SDK and your application. When you write a file, you pass your input samples to the writer using buffer objects. When you read a file, the reader object or synchronous reader object provides samples to your application in buffer objects.</p>
<p>For writing samples to a file, you can create a buffer object using the <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-allocatesample"><strong>IWMWriter::AllocateSample</strong></a> method. For reading samples, the reader object and synchronous reader object both create buffer objects internally. If you choose to, you can allocate your own buffer objects for file reading by using <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderallocatorex-allocateforoutputex"><strong>IWMReaderAllocatorEx::AllocateForOutputEx</strong></a> or <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderallocatorex-allocateforstreamex"><strong>IWMReaderAllocatorEx::AllocateForStreamEx</strong></a>.</p>
<p>The following interfaces are supported by every buffer object.</p>
<table>
<thead>
<tr>
<th>Interface</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsbuffer/nn-wmsbuffer-inssbuffer"><strong>INSSBuffer</strong></a></td>
<td>Controls and provides access to the buffer.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsbuffer/nn-wmsbuffer-inssbuffer2"><strong>INSSBuffer2</strong></a></td>
<td>Not implemented.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsbuffer/nn-wmsbuffer-inssbuffer3"><strong>INSSBuffer3</strong></a></td>
<td>Supports buffer properties, which are used for data unit extensions.</td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/api/wmsbuffer/nn-wmsbuffer-inssbuffer4"><strong>INSSBuffer4</strong></a></td>
<td>Enumerates buffer properties.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="objects.html"><strong>Objects</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
