<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Getting Stream Configuration Information from Codecs</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Getting Stream Configuration Information from Codecs
description: Getting Stream Configuration Information from Codecs
ms.assetid: 76c734a1-6fe4-4958-8773-a65f5ced80c6
keywords:</p>
<ul>
<li>streams,configurations from codecs</li>
<li>codecs,getting stream configurations from</li>
<li>streams,codec formats</li>
<li>codecs,formats</li>
<li>streams,IWMCodecInfo interface</li>
<li>IWMCodecInfo,about
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Getting Stream Configuration Information from Codecs</h1>
<p>[The feature associated with this page, <a href="/windows/win32/wmformat/windows-media-format-11-sdk">Windows Media Format 11 SDK</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/medfound/source-reader">Source Reader</a> and <a href="/windows/win32/medfound/sink-writer">Sink Writer</a>. <strong>Source Reader</strong> and <strong>Sink Writer</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Source Reader</strong> and <strong>Sink Writer</strong> instead of <strong>Windows Media Format 11 SDK</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>For audio and video streams that use the Windows Media Audio and Video codecs, you should get the values for the stream configuration structures from the codec you want to use. While it is possible to set these values yourself, using the codecs ensures that the values are accurate. You should not alter the values in these structures unless the documentation specifically recommends a particular change.</p>
<p>Information from the codecs comes in the form of codec formats. Each codec format is a single stream format supported by the codec. For more information about stream formats, see <a href="formats.html">Formats</a>.</p>
<p>You can request information from the Windows Media codecs using the <a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmcodecinfo"><strong>IWMCodecInfo</strong></a>, <a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmcodecinfo2"><strong>IWMCodecInfo2</strong></a>, and <a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmcodecinfo3"><strong>IWMCodecInfo3</strong></a> interfaces of the profile manager object. To get the <a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmprofilemanager"><strong>IWMProfileManager</strong></a> interface of a profile manager object, call the <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-wmcreateprofilemanager"><strong>WMCreateProfileManager</strong></a> function. Call <strong>QueryInterface</strong> on <strong>IWMProfileManager</strong> to get <strong>IWMCodecInfo3</strong>.</p>
<p>The following sections describe how to get the information you need.</p>
<table>
<thead>
<tr>
<th>Section</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="to-enumerate-all-installed-windows-media-codecs.html">To Enumerate All Installed Windows Media Codecs</a></td>
<td>Describes how to use the methods of the <strong>IWMCodecInfo</strong> and <strong>IWMCodecInfo2</strong> interfaces to retrieve the name and codec index of each Windows Media codec installed.</td>
</tr>
<tr>
<td><a href="to-enumerate-codec-formats.html">To Enumerate Codec Formats</a></td>
<td>Describes how to get stream configuration objects from codecs for use in your profiles.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="configuring-streams.html"><strong>Configuring Streams</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
