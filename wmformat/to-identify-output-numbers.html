<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>To Identify Output Numbers</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: To Identify Output Numbers
description: To Identify Output Numbers
ms.assetid: a2135a71-52e6-4f62-8be8-b9886be9b37c
keywords:</p>
<ul>
<li>Windows Media Format SDK,identifying output numbers</li>
<li>Advanced Systems Format (ASF),identifying output numbers</li>
<li>ASF (Advanced Systems Format),identifying output numbers</li>
<li>Advanced Systems Format (ASF),output numbers and formats</li>
<li>ASF (Advanced Systems Format),output numbers and formats</li>
<li>output numbers and formats,identifying
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>To Identify Output Numbers</h1>
<p>[The feature associated with this page, <a href="/windows/win32/wmformat/windows-media-format-11-sdk">Windows Media Format 11 SDK</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/medfound/source-reader">Source Reader</a> and <a href="/windows/win32/medfound/sink-writer">Sink Writer</a>. <strong>Source Reader</strong> and <strong>Sink Writer</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Source Reader</strong> and <strong>Sink Writer</strong> instead of <strong>Windows Media Format 11 SDK</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>To identify the output numbers for a loaded file, perform the following steps. These procedures are identical for both the asynchronous reader and the synchronous reader. Where interface names vary, the synchronous reader methods are listed in parentheses after the methods of the asynchronous reader.</p>
<ol>
<li>Create a reader object and load a file for reading. For more information, see <a href="to-create-a-reader-and-open-a-file.html">To Create a Reader and Open a File</a> (or <a href="to-create-a-synchronous-reader-and-open-a-file.html">To Create a Synchronous Reader and Open a File</a>).</li>
<li>Retrieve the total number of outputs for the file by calling <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreader-getoutputcount"><strong>IWMReader::GetOutputCount</strong></a> (or <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmsyncreader-getoutputcount"><strong>IWMSyncReader::GetOutputCount</strong></a>).</li>
<li>Loop through the outputs one at a time, performing the following steps for each:
<ul>
<li>Retrieve the <a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmoutputmediaprops"><strong>IWMOutputMediaProps</strong></a> interface for the current output with a call to <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreader-getoutputprops"><strong>IWMReader::GetOutputProps</strong></a> (or <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmsyncreader-getoutputprops"><strong>IWMSyncReader::GetOutputProps</strong></a>).</li>
<li>Retrieve the <a href="/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wm_media_type"><strong>WM_MEDIA_TYPE</strong></a> structure for the output by making two calls to <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmmediaprops-getmediatype"><strong>IWMMediaProps::GetMediaType</strong></a>. Make the first call to get the size of the structure, then allocate memory for it and pass a pointer to the allocated memory on the second call. Alternatively, you can call <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmmediaprops-gettype"><strong>IWMMediaProps::GetType</strong></a>, which delivers the major type without requiring you to allocate memory for the <strong>WM_MEDIA_TYPE</strong> structure. You can skip outputs of the wrong major type.</li>
<li>Retrieve the major media type and media subtype from the <strong>WM_MEDIA_TYPE</strong> structure. These values are stored in data members <strong>majortype</strong> and <strong>subtype</strong> respectively.</li>
<li>Check the value of <strong>WM_MEDIA_TYPE.formattype</strong>. This specifies the type of structure contained in the buffer at <strong>WM_MEDIA_TYPE.pbFormat</strong>. For more information about format types, see <a href="media-types.html">Media Types</a>.</li>
<li>Allocate memory to hold the structure of the type identified in the previous step. Copy the structure to your allocated memory. For audio and video, this structure gives you essential information about how the data should be rendered.</li>
</ul>
</li>
</ol>
<p>The synchronous reader also provides methods to retrieve associations between output numbers and stream numbers. For more information, see <a href="to-find-stream-numbers-and-output-numbers.html">To Find Stream Numbers and Output Numbers</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="inputs-streams-and-outputs.html"><strong>Inputs, Streams and Outputs</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmmediaprops"><strong>IWMMediaProps Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmoutputmediaprops"><strong>IWMOutputMediaProps Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmreader"><strong>IWMReader Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmsyncreader"><strong>IWMSyncReader Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="working-with-outputs.html"><strong>Working with Outputs</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
