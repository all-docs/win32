<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using File Sinks</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Using File Sinks
description: Using File Sinks
ms.assetid: 0cc4320a-c975-452d-bd1c-394d43bd4585
keywords:</p>
<ul>
<li>Advanced Systems Format (ASF),file sinks</li>
<li>ASF (Advanced Systems Format),file sinks</li>
<li>Advanced Systems Format (ASF),sinks</li>
<li>ASF (Advanced Systems Format),sinks</li>
<li>sinks,file sinks</li>
<li>file sinks,about</li>
<li>file sinks,creating</li>
<li>file sinks,stopping</li>
<li>file sinks,starting</li>
<li>file sinks,closing</li>
<li>sinks,statistics
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Using File Sinks</h1>
<p>[The feature associated with this page, <a href="/windows/win32/wmformat/windows-media-format-11-sdk">Windows Media Format 11 SDK</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/medfound/source-reader">Source Reader</a> and <a href="/windows/win32/medfound/sink-writer">Sink Writer</a>. <strong>Source Reader</strong> and <strong>Sink Writer</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Source Reader</strong> and <strong>Sink Writer</strong> instead of <strong>Windows Media Format 11 SDK</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>Under normal circumstances, you can simply pass the writer an output file name using the <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-setoutputfilename"><strong>IWMWriter::SetOutputFilename</strong></a> method, and the writer object will write the file to disk automatically. In this case, the writer is actually creating and controlling a writer file sink object that handles writing the file to disk. A writer file sink object controls the flow of data from the writer object to a single file.</p>
<p>You can create your own file sinks to get more control over how the sink writes the file. You can also access the default writer file sink created by the writer in response to a call to <strong>SetOutputFilename</strong>.</p>
<h2>Creating File Sinks</h2>
<p>To create a file sink and add it to the writer, perform the following steps.</p>
<ol>
<li>Create a new sink by calling the <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-wmcreatewriterfilesink"><strong>WMCreateWriterFileSink</strong></a> function.</li>
<li>Supply a file name for the sink by calling <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriterfilesink-open"><strong>IWMWriterFileSink::Open</strong></a>.</li>
<li>Add the file sink to the writer by calling <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriteradvanced-addsink"><strong>IWMWriterAdvanced::AddSink</strong></a>.</li>
<li>Perform writing in the usual way.</li>
<li>After writing is completed, the sink will close the file automatically.</li>
</ol>
<h2>Stopping and Starting File Sinks</h2>
<p>After writing operations begin, you can stop writing to a file sink by calling <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriterfilesink2-stop"><strong>IWMWriterFileSink2::Stop</strong></a>.</p>
<p>There are many potential reasons why you would want to stop writing to a sink. For example, if you are recording from a live source, you may only be interested in some of the content.</p>
<p>You can resume writing to a file sink by calling <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriterfilesink2-start"><strong>IWMWriterFileSink2::Start</strong></a>. Both <strong>Stop</strong> and <strong>Start</strong> use presentation times to control approximately when the command is executed. You can use the <a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriterfilesink3"><strong>IWMWriterFileSink3</strong></a> methods to gain more control over start and stop times.</p>
<h2>Closing File Sinks</h2>
<p>Normally, a file sink is closed automatically. If you are finished writing to a sink, but writing operations to other sinks are continuing, you should explicitly close the sink to conserve resources. To close a file sink, call <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriterfilesink2-close"><strong>IWMWriterFileSink2::Close</strong></a>.</p>
<h2>Getting Sink Statistics</h2>
<p>You can get the file size and duration for an open sink by calling <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriterfilesink2-getfilesize"><strong>IWMWriterFileSink2::GetFileSize</strong></a> and <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriterfilesink2-getfileduration"><strong>IWMWriterFileSink2::GetFileDuration</strong></a> respectively.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriterfilesink"><strong>IWMWriterFileSink Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriterfilesink2"><strong>IWMWriterFileSink2 Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriterfilesink3"><strong>IWMWriterFileSink3 Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="writer-file-sink-object.html"><strong>Writer File Sink Object</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="writing-asf-files.html"><strong>Writing ASF Files</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
