<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>To Add Script Data to the Header</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: To Add Script Data to the Header
description: To Add Script Data to the Header
ms.assetid: 25f63d9e-c81a-4098-81d4-e848659a60e5
keywords:</p>
<ul>
<li>Windows Media Format SDK,adding script data to headers</li>
<li>Advanced Systems Format (ASF),adding script data to headers</li>
<li>ASF (Advanced Systems Format),adding script data to headers</li>
<li>scripts,adding data to headers
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>To Add Script Data to the Header</h1>
<p>[The feature associated with this page, <a href="/windows/win32/wmformat/windows-media-format-11-sdk">Windows Media Format 11 SDK</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/medfound/source-reader">Source Reader</a> and <a href="/windows/win32/medfound/sink-writer">Sink Writer</a>. <strong>Source Reader</strong> and <strong>Sink Writer</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Source Reader</strong> and <strong>Sink Writer</strong> instead of <strong>Windows Media Format 11 SDK</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>You can include script commands in the header of an ASF file. To write script commands to the header at the time of encoding, perform the following steps. Perform these steps prior to calling <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-beginwriting"><strong>IWMWriter::BeginWriting</strong></a>.</p>
<ol>
<li>Obtain a pointer to the <strong>IWMHeaderInfo</strong> interface by calling <strong>IWMWriter::QueryInterface</strong>.</li>
<li>Add each desired script command by calling <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmheaderinfo-addscript"><strong>IWMHeaderInfo::AddScript</strong></a>. Each call takes the two strings separately and the presentation time to be used for the command as parameters.</li>
</ol>
<p>When an application reads the file, it will need to retrieve all of the script commands. To find all script commands in the header of a file, perform the following steps. This should be done before starting playback.</p>
<ol>
<li>Obtain a pointer to the <strong>IWMHeaderInfo</strong> interface of the reader object (or synchronous reader object) by calling the <strong>QueryInterface</strong> method of another interface in the object.</li>
<li>Get the total number of scripts in the header by calling <a href="/previous-versions/windows/desktop/api/wmsdkidl/nf-wmsdkidl-iwmheaderinfo-getscriptcount"><strong>IWMHeaderInfo::GetScriptCount</strong></a>.</li>
<li>Loop through all of the scripts in the header one at a time using calls to <a href="/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmheaderinfo-getscript"><strong>IWMHeaderInfo::GetScript</strong></a>.</li>
<li>Create a list of the presentation times so that your application can react to the commands at the appropriate time.</li>
</ol>
<blockquote>
<p>[!Note]<br />
When using DRM to encrypt a file, no script command can have a presentation time of 0.</p>
</blockquote>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmheaderinfo"><strong>IWMHeaderInfo Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriter"><strong>IWMWriter Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="using-script-commands.html"><strong>Using Script Commands</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
