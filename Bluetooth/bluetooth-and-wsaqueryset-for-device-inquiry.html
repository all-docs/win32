<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Bluetooth and WSAQUERYSET for Device Inquiry</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Bluetooth and WSAQUERYSET for Device Inquiry
description: Used to facilitate the discovery of devices and services in the Bluetooth namespace, NS_BTH.
ms.assetid: 0c0d26f7-b6c3-42a9-8c01-118278c381cc
keywords:</p>
<ul>
<li>Bluetooth and WSAQUERYSET for Device Inquiry Bluetooth</li>
<li>WSAQUERYSET Bluetooth , for device inquiry
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Bluetooth and WSAQUERYSET for Device Inquiry</h1>
<p>In Bluetooth, the <a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a> structure, is used to facilitate the discovery of devices and services in the Bluetooth namespace, NS_BTH.</p>
<p>The <a href="/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina"><strong>WSALookupServiceBegin</strong></a> and <a href="/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta"><strong>WSALookupServiceNext</strong></a> functions use the <a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a> structure to obtain information about the device inquiry process. The following table lists and describes member values in the <strong>WSAQUERYSET</strong> structure.</p>
<table>
<thead>
<tr>
<th>Member</th>
<th>Input to WSALookupServiceBegin with LUP_CONTAINERS specified</th>
<th>Returned value from WSALookupServiceNext</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>dwSize</strong></td>
<td>Must be set to <strong>sizeof</strong>(<a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a>).</td>
<td><strong>sizeof</strong>(<a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a>) returned by system.</td>
</tr>
<tr>
<td><strong>dwOutputFlags</strong></td>
<td>Not used.</td>
<td>May have one or more of these flags set: <strong>BTHNS_RESULT_DEVICE_CONNECTED</strong> Specifies the device is connected.<!-- raw HTML omitted --> <strong>BTHNS_RESULT_DEVICE_REMEMBERED</strong> Specifies the device is a remembered device. Not all remembered devices are authenticated.<!-- raw HTML omitted --> <strong>BTHNS_RESULT_DEVICE_AUTHENTICATED</strong> Specifies the device is authenticated, paired, or bonded. All authenticated devices are remembered.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>lpszServiceInstanceName</strong></td>
<td>Not used.</td>
<td>Display name of the device, originally returned from a Bluetooth Remote Name Request operation, and possibly updated by the local user. Returned if <strong>LUP_RETURN_NAME</strong> is specified.</td>
</tr>
<tr>
<td><strong>lpServiceClassId</strong></td>
<td>Not used.</td>
<td>The 32-bit Bluetooth class of device (COD) field mapped to the <strong>Data1</strong> member of the GUID. Returned if <strong>LUP_RETURN_TYPE</strong> is specified.</td>
</tr>
<tr>
<td><strong>lpVersion</strong></td>
<td>Not used.</td>
<td>Not used.</td>
</tr>
<tr>
<td><strong>lpszComment</strong></td>
<td>Not used.</td>
<td>Not used.</td>
</tr>
<tr>
<td><strong>dwNameSpace</strong></td>
<td>Must be NS_BTH.</td>
<td>Returns <strong>NS_BTH</strong>.</td>
</tr>
<tr>
<td><strong>lpNSProviderId</strong></td>
<td>Not used.</td>
<td>Not used.</td>
</tr>
<tr>
<td><strong>lpszContext</strong></td>
<td>Not used.</td>
<td>Not used.</td>
</tr>
<tr>
<td><strong>dwNumberOfProtocols</strong></td>
<td>Not used.</td>
<td>Not used.</td>
</tr>
<tr>
<td><strong>lpafpProtocols</strong></td>
<td>Not used.</td>
<td>Not used.</td>
</tr>
<tr>
<td><strong>lpszQueryString</strong></td>
<td>Not used.</td>
<td>Not used.</td>
</tr>
<tr>
<td><strong>dwNumberOfCsAddrs</strong></td>
<td>Not used.</td>
<td>Indicates the number of elements in the array of <a href="/windows/desktop/api/nspapi/ns-nspapi-csaddr_info"><strong>CSADDR_INFO</strong></a> structures.</td>
</tr>
<tr>
<td><strong>lpcsaBuffer</strong></td>
<td>Not used.</td>
<td>Pointer to a <a href="/windows/desktop/api/nspapi/ns-nspapi-csaddr_info"><strong>CSADDR_INFO</strong></a> structure with its <strong>LocalAddr.lpSockaddr</strong> member pointing to a <a href="/windows/desktop/api/Ws2bth/ns-ws2bth-sockaddr_bth"><strong>SOCKADDR_BTH</strong></a> structure with the address of the remote device. Returned if <strong>LUP_RETURN_ADDR</strong> is specified.</td>
</tr>
<tr>
<td><strong>lpBlob</strong></td>
<td>Optional. May point to a <a href="/windows/desktop/api/nspapi/ns-nspapi-blob"><strong>BLOB</strong></a> structure that points to a <a href="/windows/desktop/api/Ws2bth/ns-ws2bth-bth_query_device"><strong>BTH_QUERY_DEVICE</strong></a> structure that may limit the length of non-cached device inquiry operations.</td>
<td>Pointer to a <a href="/windows/desktop/api/nspapi/ns-nspapi-blob"><strong>BLOB</strong></a> structure that points to a <a href="/windows/desktop/api/Bthdef/ns-bthdef-bth_device_info"><strong>BTH_DEVICE_INFO</strong></a> structure. <strong>lpBlob</strong> is returned if <strong>LUP_RETURN_BLOB</strong> is specified. Specify <strong>LUP_RETURN_NAME</strong> to retrieve the name field of <strong>BTH_DEVICE_INFO</strong>.</td>
</tr>
</tbody>
</table>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="bluetooth-and-wsaqueryset-for-set-service.html">Bluetooth and WSAQUERYSET for Set Service</a></p>
<!-- raw HTML omitted -->
<p><a href="bluetooth-and-wsaqueryset-for-service-inquiry.html">Bluetooth and WSAQUERYSET for Service Inquiry</a></p>
<!-- raw HTML omitted -->
<p><a href="bluetooth-and-blob.html">Bluetooth and BLOB</a></p>
<!-- raw HTML omitted -->
<p><a href="bluetooth-and-wsasetservice.html">Bluetooth and WSALookupServiceBegin</a></p>
<!-- raw HTML omitted -->
<p><a href="bluetooth-and-wsasetservice.html">Bluetooth and WSALookupServiceNext</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/nspapi/ns-nspapi-blob"><strong>BLOB</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Bthdef/ns-bthdef-bth_device_info"><strong>BTH_DEVICE_INFO</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Ws2bth/ns-ws2bth-bth_query_device"><strong>BTH_QUERY_DEVICE</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/nspapi/ns-nspapi-csaddr_info"><strong>CSADDR_INFO</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Ws2bth/ns-ws2bth-sockaddr_bth"><strong>SOCKADDR_BTH</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/WinSock/windows-sockets-start-page-2">Windows Sockets</a></p>
<!-- raw HTML omitted -->
</body>
