<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Bluetooth and WSASetService</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Bluetooth and WSASetService
description: Bluetooth uses the WSASetService function to register or remove a service instance within the Bluetooth namespace (NS_BTH) from the registry.
ms.assetid: 71c5ed9c-fade-4d15-848e-eb810ad4cbb2
keywords:</p>
<ul>
<li>Bluetooth Bluetooth</li>
<li>WSASetService Bluetooth</li>
<li>Bluetooth and WSASetService Bluetooth
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Bluetooth and WSASetService</h1>
<p>Bluetooth uses the <a href="/windows/desktop/api/winsock2/nf-winsock2-wsasetservicea"><strong>WSASetService</strong></a> function to register or remove a service instance within the Bluetooth namespace (NS_BTH) from the registry. The handle returned by this operation may only be used to delete the service.</p>
<p>Bluetooth has two means of advertising services using the <a href="/windows/desktop/api/winsock2/nf-winsock2-wsasetservicea"><strong>WSASetService</strong></a> function:</p>
<ul>
<li>The application can have the system advertise a simple Bluetooth SDP service record, constructed from standard members in the <a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a> structure.</li>
<li>The application can have the system advertise their own Bluetooth SDP record by passing a <a href="/windows/desktop/api/Ws2bth/ns-ws2bth-bth_set_service"><strong>BTH_SET_SERVICE</strong></a> structure in the <strong>lpBlob</strong> member of the <a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a> structure. This is a more complex approach.</li>
</ul>
<blockquote>
<p>[!Note]<br />
SDP records advertised by <a href="/windows/desktop/api/winsock2/nf-winsock2-wsasetservicea"><strong>WSASetService</strong></a> do not persist after the process that published them has quit.</p>
</blockquote>
<p>Â </p>
<p>Use of <a href="/windows/desktop/api/winsock2/nf-winsock2-wsasetservicea"><strong>WSASetService</strong></a> with Bluetooth has the following requirements:</p>
<ul>
<li>The <em>lpqsRegInfo</em> parameter is the address of the <a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a> structure to be registered.</li>
<li>The <em>essOperation</em> parameter is an enumeration that contains one of the operations shown in the following table.</li>
</ul>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>RNRSERVICE_REGISTER</td>
<td>Starts advertising the service to remote radios querying using the Bluetooth SDP protocol.</td>
</tr>
<tr>
<td>RNRSERVICE_DEREGISTER</td>
<td>Not valid. Returns an error.</td>
</tr>
<tr>
<td>RNRSERVICE_DELETE</td>
<td>Stops advertising the service.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<blockquote>
<p>[!Note]<br />
Service handles discovered during a <a href="/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina"><strong>WSALookupServiceBegin</strong></a> or <a href="/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta"><strong>WSALookupServiceNext</strong></a> call are incompatible with the RNRSERVICE_DELETE operation.</p>
</blockquote>
<p>Â </p>
<ul>
<li>The <em>dwControlFlags</em> parameter is reserved, and must be zero.</li>
</ul>
<p>For more information and a list of Bluetooth socket options, see <a href="bluetooth-and-socket-options.html">Bluetooth and Socket Options</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/WinSock/windows-sockets-start-page-2">Windows Sockets</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
