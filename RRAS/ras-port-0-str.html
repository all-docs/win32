<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>RAS_PORT_0 structure</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: RAS_PORT_0 structure (Rassapi.h)
description: The RAS_PORT_0 structure contains information that describes a RAS port.
ms.assetid: 750fc705-0770-427b-b7d6-7876b8b9118a
keywords:</p>
<ul>
<li>RAS_PORT_0 structure RAS</li>
<li>PRAS_PORT_0 structure pointer RAS
topic_type:</li>
<li>apiref
api_name:</li>
<li>RAS_PORT_0
api_location:</li>
<li>Rassapi.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>RAS_PORT_0 structure</h1>
<p>[This version of the <strong>RAS_PORT_0</strong> structure is not supported as of Windows Vista. Use the newer <a href="/windows/desktop/api/Mprapi/ns-mprapi-ras_port_0"><strong>RAS_PORT_0</strong></a> defined in mprapi.h instead.]</p>
<p>The <strong>RAS_PORT_0</strong> structure contains information that describes a RAS port.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>typedef struct _RAS_PORT_0 {
  WCHAR wszPortName[RASSAPI_MAX_PORT_NAME];
  WCHAR wszDeviceType[RASSAPI_MAX_DEVICETYPE_NAME];
  WCHAR wszDeviceName[RASSAPI_MAX_DEVICE_NAME];
  WCHAR wszMediaName[RASSAPI_MAX_MEDIA_NAME];
  DWORD reserved;
  DWORD Flags;
  WCHAR wszUserName[UNLEN + 1];
  WCHAR wszComputer[NETBIOS_NAME_LEN];
  DWORD dwStartSessionTime;
  WCHAR wszLogonDomain[DNLEN + 1];
  BOOL  fAdvancedServer;
} RAS_PORT_0, *PRAS_PORT_0;
</code></pre>
<h2>Members</h2>
<!-- raw HTML omitted -->
<p><strong>wszPortName</strong></p>
<!-- raw HTML omitted -->
<p>A null-terminated Unicode string that specifies the name of the port, such as &quot;COM1&quot;.</p>
<!-- raw HTML omitted -->
<p><strong>wszDeviceType</strong></p>
<!-- raw HTML omitted -->
<p>A null-terminated Unicode string that specifies the type of the device on which the connection was made, such as Modem or ISDN. The list of device types that might be specified in this member includes all the device types installed on the server, including third-party devices.</p>
<!-- raw HTML omitted -->
<p><strong>wszDeviceName</strong></p>
<!-- raw HTML omitted -->
<p>A null-terminated Unicode string that specifies the name of the device on which the connection was made, such as &quot;Hayes 9600&quot; or &quot;PCIMACISDN1&quot;.</p>
<!-- raw HTML omitted -->
<p><strong>wszMediaName</strong></p>
<!-- raw HTML omitted -->
<p>Specifies a null-terminated Unicode string that specifies the name of the media used for the connection, such as <em>rasser</em> or <em>rastapi</em>.</p>
<!-- raw HTML omitted -->
<p><strong>reserved</strong></p>
<!-- raw HTML omitted -->
<p>Reserved.</p>
<!-- raw HTML omitted -->
<p><strong>Flags</strong></p>
<!-- raw HTML omitted -->
<p>Specifies a set of bit flags that specify the nature of the connection made on this port. This member can be a combination of the following flags.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>GATEWAY_ACTIVE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set, the NetBIOS gateway is active on the server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MESSENGER_PRESENT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set, the messenger service is running on the remote client.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PORT_MULTILINKED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set, the port is multilinked with other ports. Use this information to display the connection status as a multilinked port. <!-- raw HTML omitted --> For a multilinked port, the <a href="ras-port-statistics-str.html"><strong>RAS_PORT_STATISTICS</strong></a> structure contains two sets of statistics: one for the port alone, and another for the combined ports in the multilink connection.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PPP_CLIENT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set, the remote client connected using PPP. If this flag is not set, the remote client connected using the AMB protocol.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>REMOTE_LISTEN</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set, the RemoteListen parameter of the NetBIOS gateway is set to 1 on the server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>USER_AUTHENTICATED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set, a remote client is connected to the server and the user has been authenticated. Check this flag to ensure that a client is actually connected to a port.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>If the MESSENGER_PRESENT, GATEWAY_ACTIVE, and REMOTE_LISTEN flags are set, use the messenger service to send an administrative message to the remote client. If MESSENGER_PRESENT and REMOTE_LISTEN are set, but GATEWAY_ACTIVE is not, send messages to the client only from the RAS server to which the client is connected.</p>
<!-- raw HTML omitted -->
<p><strong>wszUserName</strong></p>
<!-- raw HTML omitted -->
<p>A null-terminated Unicode string that specifies the name of the remote user connected to this port.</p>
<!-- raw HTML omitted -->
<p><strong>wszComputer</strong></p>
<!-- raw HTML omitted -->
<p>A null-terminated Unicode string that specifies the name of the remote client computer.</p>
<!-- raw HTML omitted -->
<p><strong>dwStartSessionTime</strong></p>
<!-- raw HTML omitted -->
<p>Specifies the time, in seconds from January 1, 1970, that the client connected to the RAS server on this port. Use the standard time functions to format this value for display.</p>
<!-- raw HTML omitted -->
<p><strong>wszLogonDomain</strong></p>
<!-- raw HTML omitted -->
<p>Specifies a null-terminated Unicode string that specifies the name of the domain on which the remote user was authenticated. This string is the domain name only, with no &quot;\\&quot; prefix.</p>
<!-- raw HTML omitted -->
<p><strong>fAdvancedServer</strong></p>
<!-- raw HTML omitted -->
<p>Specifies a flag that is nonzero if the RAS server associated with this port is an advanced server such as Windows 2000 Advanced Server. Use this information to determine the name of the server that has the user account database. If the RAS server is an advanced server, get the name of the user account server by concatenating the prefix &quot;\\&quot; to the name returned in the <strong>wszLogonDomain</strong> member. This is because for an advanced server the local logon domain name is the same as the server name. If the RAS server is a workstation, use the <a href="rasadmingetuseraccountserver.html"><strong>RasAdminGetUserAccountServer</strong></a> function to get the name of the user account server.</p>
<!-- raw HTML omitted -->
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>Windows XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of server support<!-- raw HTML omitted --></td>
<td>Windows Server 2003<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Rassapi.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="about-remote-access-service.html">Remote Access Service (RAS) Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="ras-server-administration-structures.html">RAS Server Administration Structures</a></p>
<!-- raw HTML omitted -->
<p><a href="ras-port-1-str.html"><strong>RAS_PORT_1</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="ras-port-statistics-str.html"><strong>RAS_PORT_STATISTICS</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="rasadmingetuseraccountserver.html"><strong>RasAdminGetUserAccountServer</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="rasadminportenum.html"><strong>RasAdminPortEnum</strong></a></p>
<!-- raw HTML omitted -->
</body>
