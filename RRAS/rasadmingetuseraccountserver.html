<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>RasAdminGetUserAccountServer function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: RasAdminGetUserAccountServer function (Rassapi.h)
description: The RasAdminGetUserAccountServer function retrieves the name of the server that has the user account database. Use the returned server name in the RasAdminUserGetInfo and RasAdminUserSetInfo functions to get or set information about a specified user.
ms.assetid: db91aa48-32af-49ac-87ed-8c484926ca15
keywords:</p>
<ul>
<li>RasAdminGetUserAccountServer function RAS
topic_type:</li>
<li>apiref
api_name:</li>
<li>RasAdminGetUserAccountServer
api_location:</li>
<li>Rassapi.dll
api_type:</li>
<li>DllExport
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>RasAdminGetUserAccountServer function</h1>
<p>[This function is provided only for backward compatibility with Windows NT Server 4.0. It returns ERROR_CALL_NOT_IMPLEMENTED on Windows Server 2003. Applications should use the <a href="/windows/desktop/api/Mprapi/nf-mprapi-mpradmingetpdcserver"><strong>MprAdminGetPDCServer</strong></a> function.]</p>
<p>The <strong>RasAdminGetUserAccountServer</strong> function retrieves the name of the server that has the user account database. Use the returned server name in the <a href="rasadminusergetinfo.html"><strong>RasAdminUserGetInfo</strong></a> and <a href="rasadminusersetinfo.html"><strong>RasAdminUserSetInfo</strong></a> functions to get or set information about a specified user.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>DWORD RasAdminGetUserAccountServer(
  _In_  const WCHAR  *lpszDomain,
  _In_  const WCHAR  *lpszServer,
  _Out_       LPWSTR lpszUserAccountServer
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>lpszDomain</em> [in]</p>
<!-- raw HTML omitted -->
<p>Pointer to a <strong>null</strong>-terminated Unicode string that specifies the name of the domain to which the RAS server belongs. This parameter is <strong>NULL</strong> for the RAS administration applications running on workstations or servers that are not members of a domain. If this parameter is <strong>NULL</strong>, the <em>lpszServer</em> parameter must be non-<strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpszServer</em> [in]</p>
<!-- raw HTML omitted -->
<p>Pointer to a <strong>null</strong>-terminated Unicode string that specifies the name of the RAS server. Specify the name with leading &quot;\\&quot; characters, in the form: \\<em>servername</em>. This parameter can be <strong>NULL</strong> if the <em>lpszDomain</em> parameter is not <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpszUserAccountServer</em> [out]</p>
<!-- raw HTML omitted -->
<p>Pointer to a buffer that receives a <strong>null</strong>-terminated Unicode string that specifies the name of a domain controller that has the user account database. The buffer should be big enough to hold the server name (UNCLEN +1). The function prefixes the returned server name with leading &quot;\\&quot; characters, in the form: \\<em>servername</em>.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, the return value is ERROR_SUCCESS.</p>
<p>If the function fails, the return value can be the following error code.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>ERROR_INVALID_PARAMETER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Both <em>lpszDomain</em> and <em>lpszServer</em> are <strong>NULL</strong>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>There is no extended error information for this function; do not call <a href="/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a>.</p>
<h2>Remarks</h2>
<p>The <strong>RasAdminGetUserAccountServer</strong> function obtains the name of the server with the user accounts database. This function requires the name of the RAS server or the name of the domain in which the RAS server resides.</p>
<p>The <em>lpszDomain</em> parameter should specify a valid domain name. This parameter is <strong>NULL</strong> for RAS administration applications running on servers that are not members of a domain (for example, the server is in its own workgroup). In this case, the <em>lpszServer</em> parameter must specify the server name. To get the server name, call the <a href="/windows/win32/api/winbase/nf-winbase-getcomputernamea"><strong>GetComputerName</strong></a> function. Be sure to prefix the server name with the &quot;\\&quot; characters.</p>
<p>If the server name specified by <em>lpszServer</em> is a stand-alone server (that is, the server or workstation is not a member of a domain), then the server name itself is returned in the <em>lpszUserAccountServer</em> buffer.</p>
<p>Then use the name of the user account server in a call to the <a href="/windows/win32/api/lmaccess/nf-lmaccess-netquerydisplayinformation"><strong>NetQueryDisplayInformation</strong></a> function to enumerate the users in the user account database.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of server support<!-- raw HTML omitted --></td>
<td>Windows 2000 Server<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Rassapi.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Rassapi.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Rassapi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="about-remote-access-service.html">Remote Access Service (RAS) Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="ras-server-administration-functions.html">RAS Server Administration Functions</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/winbase/nf-winbase-getcomputernamea"><strong>GetComputerName</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="rasadminusergetinfo.html"><strong>RasAdminUserGetInfo</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="rasadminusersetinfo.html"><strong>RasAdminUserSetInfo</strong></a></p>
<!-- raw HTML omitted -->
</body>
