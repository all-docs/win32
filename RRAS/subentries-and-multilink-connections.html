<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Subentries and Multilink Connections</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Subentries and Multilink Connections
description: WindowsÂ NT ServerÂ 4.0 provides support for phone-book subentries, which enable multilink connections. A multilink connection combines the bandwidth of multiple connections to provide a single connection with higher bandwidth.
ms.assetid: 19cf6e1a-cdba-47e4-8d8f-d6030ed6f9e3
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Subentries and Multilink Connections</h1>
<p>WindowsÂ NT ServerÂ 4.0 provides support for phone-book subentries, which enable multilink connections. A multilink connection combines the bandwidth of multiple connections to provide a single connection with higher bandwidth.</p>
<p>A RAS phone-book entry can have zero or more subentries. The <a href="/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa"><strong>RasGetEntryProperties</strong></a> function retrieves a <a href="/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)"><strong>RASENTRY</strong></a> structure that includes information about the subentries of a phone-book entry. The <strong>dwSubEntries</strong> member of the <strong>RASENTRY</strong> structure indicates the number of subentries. Phone-book entries initially have no subentries. To add subentries to a phone-book entry, use the <a href="/windows/desktop/api/Ras/nf-ras-rassetsubentrypropertiesa"><strong>RasSetSubEntryProperties</strong></a> function.</p>
<p>The properties for each subentry include a phone number and the name and type of the TAPI device to use when dialing the subentry. In addition, a subentry can include a list of alternate phone numbers to dial if RAS cannot make a connection using the primary number. The <a href="/windows/desktop/api/Ras/nf-ras-rassetsubentrypropertiesa"><strong>RasSetSubEntryProperties</strong></a> and <a href="/windows/desktop/api/Ras/nf-ras-rasgetsubentrypropertiesa"><strong>RasGetSubEntryProperties</strong></a> functions use the <a href="/previous-versions/windows/desktop/legacy/aa377839(v=vs.85)"><strong>RASSUBENTRY</strong></a> structure to set and retrieve the properties of a specified phone-book subentry. Subentries are identified by a one-based index.</p>
<p>You can call the <a href="/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa"><strong>RasSetEntryProperties</strong></a> function to configure a multilink RAS entry to connect all subentries when it is first dialed. Alternatively, you can configure an entry to provide variable bandwidth. In this case, RAS connects a single subentry initially, and then connects or disconnects additional subentries as needed. For a variable-bandwidth multilink connection, you can use the <a href="/previous-versions/windows/desktop/legacy/aa377238(v=vs.85)"><strong>RASDIALPARAMS</strong></a> structure to specify the initial subentry to connect when you call the <a href="/windows/desktop/api/Ras/nf-ras-rasdiala"><strong>RasDial</strong></a> function. When using the <a href="/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga"><strong>RasDialDlg</strong></a> function to connect a multilink entry, you can use the <a href="/previous-versions/windows/desktop/legacy/aa377023(v=vs.85)"><strong>RASDIALDLG</strong></a> structure to specify the initial subentry to connect.</p>
<p>For a variable-bandwidth multilink connection, use the <a href="/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)"><strong>RASENTRY</strong></a> structure with the <a href="/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa"><strong>RasSetEntryProperties</strong></a> function to specify the parameters for connecting and disconnecting the individual subentries. RAS connects an additional subentry when the bandwidth being used exceeds a specified percentage of the available bandwidth for a specified interval.</p>
<p>If you call the <a href="/windows/desktop/api/Ras/nf-ras-rasdiala"><strong>RasDial</strong></a> function to establish a multilink connection, you can specify a <a href="/windows/desktop/api/Ras/nc-ras-rasdialfunc2"><strong>RasDialFunc2</strong></a> callback function to receive notifications about the connection. <strong>RasDialFunc2</strong> is similar to the <a href="/windows/desktop/api/Ras/nc-ras-rasdialfunc1"><strong>RasDialFunc1</strong></a> callback function, except that it provides additional information for a multilink connection, such as the index of the subentry that caused the notification. RAS calls your <strong>RasDialFunc2</strong> function when it connects or disconnects a subentry.</p>
<p>You can use an <strong>HRASCONN</strong> connection handle to hang up or retrieve information about a multilink connection. You can get a connection handle for each of the subentry connections that make up the multilink, as well as for the combined multilink connection. When you call the <a href="/windows/desktop/api/Ras/nf-ras-rasdiala"><strong>RasDial</strong></a> function to establish a multilink connection, <strong>RasDial</strong> returns a handle to the combined multilink connection. Similarly, <a href="/windows/desktop/api/Ras/nf-ras-rasenumconnectionsa"><strong>RasEnumConnections</strong></a> returns the combined multilink handle when you enumerate connections. To get a handle to one of the subentry connections in a multilink connection, call the <a href="/windows/desktop/api/Ras/nf-ras-rasgetsubentryhandlea"><strong>RasGetSubEntryHandle</strong></a> function.</p>
<p>You can use the combined multilink connection handle and the subentry connection handles in the <a href="/windows/desktop/api/Ras/nf-ras-rashangupa"><strong>RasHangUp</strong></a>, <a href="/windows/desktop/api/Ras/nf-ras-rasgetconnectstatusa"><strong>RasGetConnectStatus</strong></a>, and <a href="/previous-versions/windows/embedded/ms897107(v=msdn.10)"><strong>RasGetProjectionInfo</strong></a> functions. Calling <strong>RasHangUp</strong> with a combined multilink handle terminates the entire connection; calling it with a subentry handle hangs up only that subentry connection. Similarly, <strong>RasGetConnectStatus</strong> returns information for the combined or individual connection, depending on the handle specified. The projection information returned by <strong>RasGetProjectionInfo</strong> for a multilink entry is the same for each of the subentry connection handles as it is for the main connection handle.</p>
<p>Â </p>
<p>Â </p>
</body>
