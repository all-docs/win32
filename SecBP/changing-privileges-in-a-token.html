<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Changing Privileges in a Token</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Explains how to change privileges in a token by using the AdjustTokenPrivileges and CreateRestrictedToken functions.
ms.assetid: b8e47d04-07c1-4d57-8209-6b0c397476e5
title: Changing Privileges in a Token
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Changing Privileges in a Token</h1>
<p>You can change the privileges in either a primary or an impersonation token in two ways:</p>
<ul>
<li>Enable or disable privileges by using the <a href="/windows/desktop/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges"><strong>AdjustTokenPrivileges</strong></a> function.</li>
<li>Restrict or remove privileges by using the <a href="/windows/desktop/api/securitybaseapi/nf-securitybaseapi-createrestrictedtoken"><strong>CreateRestrictedToken</strong></a> function.</li>
</ul>
<p><a href="/windows/desktop/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges"><strong>AdjustTokenPrivileges</strong></a> cannot add or remove privileges from the token. It can only enable existing privileges that are currently disabled or disable existing privileges that are currently enabled. For examples, see <a href="/windows/desktop/SecAuthZ/enabling-and-disabling-privileges-in-c--">Enabling and Disabling Privileges in C++</a>.</p>
<p>To assign privileges to a user account, see <a href="assigning-privileges-to-an-account.html">Assigning Privileges to an Account</a>.</p>
<p><a href="/windows/desktop/api/securitybaseapi/nf-securitybaseapi-createrestrictedtoken"><strong>CreateRestrictedToken</strong></a> has more extensive capabilities as follows:</p>
<ul>
<li>Removing a privilege. Note that removing a privilege is not the same as disabling one. After a privilege is removed from a token, it cannot be put back.</li>
<li>Attaching the deny-only attribute to SIDs in the token. This has the effect of disallowing specific groups or accounts, for example, denying the Everyone group delete access to a particular file. For more information on restricting SIDs, see <a href="/windows/desktop/SecAuthZ/sid-attributes-in-an-access-token">SID Attributes in an Access Token</a>.</li>
<li>Specifying a list of restricting SIDs in the token. For information about restricting SIDs, see <a href="/windows/desktop/SecAuthZ/restricted-tokens">Restricted Tokens</a>.</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
