<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PacketMonitorCreateLiveSession function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: PacketMonitorCreateLiveSession
description: Creates an independent Packet Monitor session.
ms.topic: reference
ms.date: 07/03/2024
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_type:</li>
<li>DllExport
api_location:</li>
<li>Pktmonapi.dll
api_name:</li>
<li>PacketMonitorCreateLiveSession</li>
</ul>
<hr />
<h1>PacketMonitorCreateLiveSession function</h1>
<h2>Description</h2>
<p>Creates an independent Packet Monitor session.</p>
<p>With the multisession feature, you can create multiple sessions, and configure each one with different sets of parameters to capture packets. This API supports the creation of an independent session for Packet Monitor.</p>
<h2>Syntax</h2>
<pre lang="cpp"><code>HRESULT
WINAPI
PacketMonitorCreateLiveSession(
    _In_ PACKETMONITOR_HANDLE handle,
    _In_ PCWSTR name,
    _Out_ PACKETMONITOR_SESSION* session
    );
</code></pre>
<h2>Parameters</h2>
<h3>[in] handle</h3>
<p>Handle to the pktmon driver which was obtained by first calling â€˜PacketMonitorInitializeâ€™.</p>
<h3>[in] name</h3>
<p>Name to identify the session. The maximum length allowed is 256. Minimum is 1.</p>
<h3>[out] session</h3>
<p>This is declared as â€˜DECLARE_HANDLE(PACKETMONITOR_SESSION)â€™.</p>
<p>If SUCCESS, this will contain the object to the session. Later, the session can be controlled through the same object for functions like:</p>
<p>PacketMonitorCloseSessionHandle</p>
<p>PacketMonitorSetSessionActive</p>
<p>PacketMonitorAddSingleDataSourceToSession</p>
<p>PacketMonitorAddCaptureConstraint</p>
<p>PacketMonitorAttachOutputToSession</p>
<h2>Returns</h2>
<p>If the function succeeds, it returns S_OK. Otherwise, it returns an HRESULT error code.</p>
<h2>Remarks</h2>
<p>The session needs to be activated to start monitoring the traffic on it. That can be done by calling â€˜PacketMonitorSetSessionActiveâ€™.</p>
<p>After a user is done working with a Packet Monitor session, they must call PacketMonitorCloseSessionHandle.</p>
<h2>See also</h2>
<p><a href="../pktmon-reference.html">Packet Monitor (Pktmon) reference</a></p>
</body>
