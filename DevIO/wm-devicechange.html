<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>WM_DEVICECHANGE message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Notifies an application of a change to the hardware configuration of a device or the computer.
ms.assetid: b64a3983-ee75-4199-9778-1e5b7cec59e4
title: WM_DEVICECHANGE message (Winuser.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>WM_DEVICECHANGE message</h1>
<p>Notifies an application of a change to the hardware configuration of a device or the computer.</p>
<p>A window receives this message through its <a href="/windows/win32/api/winuser/nc-winuser-wndproc"><strong>WindowProc</strong></a> function.</p>
<pre lang="C++"><code>LRESULT CALLBACK WindowProc(HWND   hwnd,     // handle to window
                            UINT   uMsg,     // WM_DEVICECHANGE
                            WPARAM wParam,   // device-change event
                            LPARAM lParam ); // event-specific data
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hwnd</em></p>
<!-- raw HTML omitted -->
<p>A handle to the window.</p>
<!-- raw HTML omitted -->
<p><em>uMsg</em></p>
<!-- raw HTML omitted -->
<p>The <strong>WM_DEVICECHANGE</strong> identifier.</p>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>The event that has occurred. This parameter can be one of the following values from the Dbt.h header file.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><a href="dbt-devnodes-changed.html">DBT_DEVNODES_CHANGED</a></strong><!-- raw HTML omitted -->0x0007</td>
<td>A device has been added to or removed from the system.</td>
</tr>
<tr>
<td><strong><a href="dbt-querychangeconfig.html">DBT_QUERYCHANGECONFIG</a></strong><!-- raw HTML omitted -->0x0017</td>
<td>Permission is requested to change the current configuration (dock or undock).</td>
</tr>
<tr>
<td><strong><a href="dbt-configchanged.html">DBT_CONFIGCHANGED</a></strong><!-- raw HTML omitted -->0x0018</td>
<td>The current configuration has changed, due to a dock or undock.</td>
</tr>
<tr>
<td><strong><a href="dbt-configchangecanceled.html">DBT_CONFIGCHANGECANCELED</a></strong><!-- raw HTML omitted -->0x0019</td>
<td>A request to change the current configuration (dock or undock) has been canceled.</td>
</tr>
<tr>
<td><strong><a href="dbt-devicearrival.html">DBT_DEVICEARRIVAL</a></strong><!-- raw HTML omitted -->0x8000</td>
<td>A device or piece of media has been inserted and is now available.</td>
</tr>
<tr>
<td><strong><a href="dbt-devicequeryremove.html">DBT_DEVICEQUERYREMOVE</a></strong><!-- raw HTML omitted -->0x8001</td>
<td>Permission is requested to remove a device or piece of media. Any application can deny this request and cancel the removal.</td>
</tr>
<tr>
<td><strong><a href="dbt-devicequeryremovefailed.html">DBT_DEVICEQUERYREMOVEFAILED</a></strong><!-- raw HTML omitted -->0x8002</td>
<td>A request to remove a device or piece of media has been canceled.</td>
</tr>
<tr>
<td><strong><a href="dbt-deviceremovepending.html">DBT_DEVICEREMOVEPENDING</a></strong><!-- raw HTML omitted -->0x8003</td>
<td>A device or piece of media is about to be removed. Cannot be denied.</td>
</tr>
<tr>
<td><strong><a href="dbt-deviceremovecomplete.html">DBT_DEVICEREMOVECOMPLETE</a></strong><!-- raw HTML omitted -->0x8004</td>
<td>A device or piece of media has been removed.</td>
</tr>
<tr>
<td><strong><a href="dbt-devicetypespecific.html">DBT_DEVICETYPESPECIFIC</a></strong><!-- raw HTML omitted -->0x8005</td>
<td>A device-specific event has occurred.</td>
</tr>
<tr>
<td><strong><a href="dbt-customevent.html">DBT_CUSTOMEVENT</a></strong><!-- raw HTML omitted -->0x8006</td>
<td>A custom event has occurred.</td>
</tr>
<tr>
<td><strong><a href="dbt-userdefined.html">DBT_USERDEFINED</a></strong><!-- raw HTML omitted -->0xFFFF</td>
<td>The meaning of this message is user-defined.</td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>A pointer to a structure that contains event-specific data. Its format depends on the value of the <em>wParam</em> parameter. For more information, refer to the documentation for each event.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Return <strong>TRUE</strong> to grant the request.</p>
<p>Return <strong>BROADCAST_QUERY_DENY</strong> to deny the request.</p>
<h2>Remarks</h2>
<p>For devices that offer software-controllable features, such as ejection and locking, the system typically sends a <a href="dbt-deviceremovepending.html">DBT_DEVICEREMOVEPENDING</a> message to let applications and device drivers end their use of the device gracefully. If the system forcibly removes a device, it may not send a <a href="dbt-devicequeryremove.html">DBT_DEVICEQUERYREMOVE</a> message before doing so.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client</td>
<td>Windows XP</td>
</tr>
<tr>
<td>Minimum supported server</td>
<td>Windows Server 2003</td>
</tr>
<tr>
<td>Header</td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winuser.h (include Windows.h or Dbt.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="dbt-configchangecanceled.html">DBT_CONFIGCHANGECANCELED</a></p>
<!-- raw HTML omitted -->
<p><a href="dbt-configchanged.html">DBT_CONFIGCHANGED</a></p>
<!-- raw HTML omitted -->
<p><a href="dbt-customevent.html">DBT_CUSTOMEVENT</a></p>
<!-- raw HTML omitted -->
<p><a href="dbt-devicearrival.html">DBT_DEVICEARRIVAL</a></p>
<!-- raw HTML omitted -->
<p><a href="dbt-devicequeryremove.html">DBT_DEVICEQUERYREMOVE</a></p>
<!-- raw HTML omitted -->
<p><a href="dbt-devicequeryremovefailed.html">DBT_DEVICEQUERYREMOVEFAILED</a></p>
<!-- raw HTML omitted -->
<p><a href="dbt-deviceremovecomplete.html">DBT_DEVICEREMOVECOMPLETE</a></p>
<!-- raw HTML omitted -->
<p><a href="dbt-deviceremovepending.html">DBT_DEVICEREMOVEPENDING</a></p>
<!-- raw HTML omitted -->
<p><a href="dbt-devicetypespecific.html">DBT_DEVICETYPESPECIFIC</a></p>
<!-- raw HTML omitted -->
<p><a href="dbt-devnodes-changed.html">DBT_DEVNODES_CHANGED</a></p>
<!-- raw HTML omitted -->
<p><a href="dbt-querychangeconfig.html">DBT_QUERYCHANGECONFIG</a></p>
<!-- raw HTML omitted -->
<p><a href="dbt-userdefined.html">DBT_USERDEFINED</a></p>
<!-- raw HTML omitted -->
</body>
