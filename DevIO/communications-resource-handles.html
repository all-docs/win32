<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Communications Resource Handles</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: A process uses the CreateFile function to open a handle to a communications resource.
ms.assetid: eaef6067-97a6-40c4-84ec-c0d86af6bb4a
title: Communications Resource Handles
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Communications Resource Handles</h1>
<p>A process uses the <a href="/windows/desktop/api/fileapi/nf-fileapi-createfilea"><strong>CreateFile</strong></a> function to open a handle to a communications resource. For example, specifying COM1 opens a handle to a serial port, and LPT1 opens a handle to a parallel port. If the specified resource is currently being used by another process, <strong>CreateFile</strong> fails. Any thread of the process can use the handle returned by <strong>CreateFile</strong> to identify the resource in any of the functions that access the resource.</p>
<p>When the process calls <a href="/windows/desktop/api/fileapi/nf-fileapi-createfilea"><strong>CreateFile</strong></a> to open a communications resource, it specifies the following attributes:</p>
<ul>
<li>What type of read/write access exists for the specified resource.</li>
<li>Whether the handle can be inherited by child processes.</li>
<li>Whether the handle can be used in overlapped (asynchronous) I/O operations. (For a description of overlapped operations, see <a href="/windows/desktop/Sync/synchronization">Synchronization</a>.)</li>
</ul>
<p>When the process uses <a href="/windows/desktop/api/fileapi/nf-fileapi-createfilea"><strong>CreateFile</strong></a> to open a communications resource, it must specify certain values for the following parameters:</p>
<ul>
<li>The <em>fdwShareMode</em> parameter must be zero, opening the resource for exclusive access.</li>
<li>The <em>fdwCreate</em> parameter must specify the OPEN_EXISTING flag.</li>
<li>The <em>hTemplateFile</em> parameter must be <strong>NULL</strong>.</li>
</ul>
<p>When using <a href="/windows/desktop/api/fileapi/nf-fileapi-createfilea"><strong>CreateFile</strong></a> to open a handle directly to a device, an application must use the special characters &quot; \\ .\&quot; to identify the device. For example, to open a handle to drive A, specify \\ .\a: for the <em>lpszName</em> parameter of <strong>CreateFile</strong>. The calling process can use the handle in the <a href="/windows/win32/api/ioapiset/nf-ioapiset-deviceiocontrol"><strong>DeviceIoControl</strong></a> function to send control codes to the device.</p>
<p>Â </p>
<p>Â </p>
</body>
