<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Read and Write Operations</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Windows supports both synchronous and asynchronous (overlapped) file I/O operations on serial communications resources.
ms.assetid: cee44596-ad73-4afb-b86a-744b0b46d9d5
title: Read and Write Operations
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Read and Write Operations</h1>
<p>Windows supports both synchronous and asynchronous (overlapped) file I/O operations on serial communications resources. Overlapped operations enable the calling thread to perform other tasks while the operation executes in the background. A thread uses the <a href="/windows/desktop/api/fileapi/nf-fileapi-readfile"><strong>ReadFile</strong></a> or <a href="/windows/desktop/api/fileapi/nf-fileapi-readfileex"><strong>ReadFileEx</strong></a> function to read from a communications resource, and the <a href="/windows/desktop/api/fileapi/nf-fileapi-writefile"><strong>WriteFile</strong></a> or <a href="/windows/desktop/api/fileapi/nf-fileapi-writefileex"><strong>WriteFileEx</strong></a> function to write to a communications resource. <strong>ReadFile</strong> and <strong>WriteFile</strong> can be performed synchronously or asynchronously. <strong>ReadFileEx</strong> and <strong>WriteFileEx</strong> can only be performed asynchronously.</p>
<p>The behavior of these read and write functions is affected by whether the function is executed as an overlapped operation, whether the time-out parameters are associated with the handle, and whether flow control parameters are associated with the handle.</p>
<p>A thread can also write to a communications resource by using the <a href="/windows/desktop/api/Winbase/nf-winbase-transmitcommchar"><strong>TransmitCommChar</strong></a> function, which transmits a specified character ahead of any pending data in the output buffer. This function is useful for transmitting a high priority signal character to the receiving system. Transmission of the high priority character is still subject to flow control and write time-outs, and the operation is performed synchronously.</p>
<p>A thread can use the <a href="/windows/desktop/api/Winbase/nf-winbase-purgecomm"><strong>PurgeComm</strong></a> function to discard all characters in a device's output or input buffer. <strong>PurgeComm</strong> can also terminate pending read or write operations, even if the operations have not been completed. If a thread uses <strong>PurgeComm</strong> to flush an output buffer, the deleted characters are not transmitted. To empty the output buffer while ensuring that the contents are transmitted, a thread can call the <a href="/windows/desktop/api/fileapi/nf-fileapi-flushfilebuffers"><strong>FlushFileBuffers</strong></a> function (a synchronous operation). Note, however, that <strong>FlushFileBuffers</strong> is subject to flow control but not to write time-outs, and it will not return until all pending write operations have been transmitted.</p>
<p>Â </p>
<p>Â </p>
</body>
