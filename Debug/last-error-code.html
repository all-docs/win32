<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Last-Error Code</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: When an error occurs, most system functions return an error code, usually 0, NULL, or &amp;#8211;1.
ms.assetid: fd5b0d6e-78cf-4f51-b61d-d32576cd485a
title: Last-Error Code
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Last-Error Code</h1>
<p>When an error occurs, most system functions return an error code, usually 0, <strong>NULL</strong>, or â€“1. Many system functions also set an additional error code called the <em>last-error code</em>. This error code is maintained separately for each running thread; an error in one thread does not overwrite the last-error code in another thread. Any function can call the <a href="/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror"><strong>SetLastError</strong></a> or <a href="/windows/desktop/api/Winuser/nf-winuser-setlasterrorex"><strong>SetLastErrorEx</strong></a> function to set the last-error code for the current thread. These functions are intended primarily for dynamic-link libraries (DLL), so they can provide information to the calling application. Note that some functions call <strong>SetLastError</strong> or <strong>SetLastErrorEx</strong> with 0 when they succeed, wiping out the error code set by the most recently failed function, while others do not.</p>
<p>An application can retrieve the last-error code by using the <a href="/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a> function; the error code may tell more about what actually occurred to make the function fail. The documentation for system functions will indicate the conditions under which the function sets the last-error code.</p>
<p>The system defines a set of error codes that can be set as last-error codes or be returned by these functions. Error codes are 32-bit values (bit 31 is the most significant bit). Bit 29 is reserved for application-defined error codes; no system error code has this bit set. If you define error codes for your application, set this bit to indicate that the error code has been defined by an application and to ensure that the error codes do not conflict with any system-defined error codes. For more information, see WinError.h and <a href="system-error-codes.html">System Error Codes</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
