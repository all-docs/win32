<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Windows Update Agent Object Model</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Programmers using Windows Update Agent (WUA) begin by adding a reference to Wuapi.dll to their current project (in Visual C++, Microsoft Visual Basic, or C#) or by referencing Wuapi.h and Wuguid.lib in a C or C++ project.
ms.assetid: ec9cbb0b-b5d4-41f2-8a25-143130d08a3b
title: Windows Update Agent Object Model
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Windows Update Agent Object Model</h1>
<p>Programmers using Windows Update Agent (WUA) begin by adding a reference to Wuapi.dll to their current project (in Visual C++, Microsoft Visual Basic, or C#) or by referencing Wuapi.h and Wuguid.lib in a C or C++ project. The first step in using the WUA API is to create an instance of one of the interfaces by creating an object from the appropriate coclass.</p>
<p>The following illustration describes the WUA object model. For more information, see the &quot;<a href="#wua-objects-and-associated-tasks">WUA Objects and Associated Tasks</a>&quot; section. For a complete list of all the WUA interfaces, see <a href="interfaces.html">Interfaces</a>.</p>
<p><img src="images/wua-object-model.png" alt="windows update agent object model" /></p>
<h2>WUA Objects and Associated Tasks</h2>
<p>The following table lists the WUA objects and the typical tasks that are associated with the WUA objects.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iautomaticupdates"><strong>AutomaticUpdates</strong></a></td>
<td>Begin, pause, or resume Automatic Updates.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iautomaticupdatessettings"><strong>AutomaticUpdatesSettings</strong></a></td>
<td>Retrieve or set the day and time to install updates. Specify how users are notified of an Automatic Updates event.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-icategory"><strong>Category</strong></a></td>
<td>Retrieve information about the update's category, including the name, ID, description, owner, and intended product. Retrieve a collection of updates that belong to this category. Retrieve a collection of the parent or child categories.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-icategorycollection"><strong>CategoryCollection</strong></a></td>
<td>Access a collection of Category objects.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-idownloadresult"><strong>DownloadResult</strong></a></td>
<td>Retrieve information about the result of a download.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iinstallationresult"><strong>InstallationResult</strong></a></td>
<td>Retrieve information about the result of an installation or uninstallation. Determine whether a system restart is required to complete the installation or uninstallation.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-isearchresult"><strong>SearchResult</strong></a></td>
<td>Retrieve information about the result of a search for categories or updates. Retrieve a collection of categories found on the destination computer by the search. Retrieve a collection of updates found by the search.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-isysteminformation"><strong>SystemInformation</strong></a></td>
<td>Retrieve information about OEM hardware and system restart requirements on the destination computer.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iupdate"><strong>Update</strong></a></td>
<td>Retrieve most information about the update, including bundled updates, source requirements, identity, description, uninstall options, download priority, size, and deadline.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iupdatecollection"><strong>UpdateCollection</strong></a></td>
<td>Access a collection of Update objects.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iupdatedownloader"><strong>UpdateDownloader</strong></a></td>
<td>Start an asynchronous or synchronous download of the files that are associated with the updates.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iupdatedownloadresult"><strong>UpdateDownloadResult</strong></a></td>
<td>Retrieve information about the result of the download for one update.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iupdateexception"><strong>UpdateException</strong></a></td>
<td>Retrieve the description and context of an exception that is thrown when an update error occurs.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iupdateexceptioncollection"><strong>UpdateExceptionCollection</strong></a></td>
<td>Access a collection of UpdateException objects.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iupdatehistoryentry"><strong>UpdateHistoryEntry</strong></a></td>
<td>Retrieve information about an update that has been installed or uninstalled, including the processed application, date, and description.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iupdatehistoryentrycollection"><strong>UpdateHistoryEntryCollection</strong></a></td>
<td>Access a collection of UpdateHistoryEntry objects.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iupdateinstallationresult"><strong>UpdateInstallationResult</strong></a></td>
<td>Retrieve information about the result of the installation or uninstallation for an update.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iupdateinstaller"><strong>UpdateInstaller</strong></a></td>
<td>Start an asynchronous or synchronous installation or uninstallation of an update. Start an interactive dialog sequence to guide the user through the steps to install updates.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iupdatesearcher"><strong>UpdateSearcher</strong></a></td>
<td>Searches for updates on the server by criteria such as the update type, the ID, or the category.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iupdatesession"><strong>UpdateSession</strong></a></td>
<td>Start a session to search, download, install, or uninstall the updates for an application.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wuapi/nn-wuapi-iwebproxy"><strong>WebProxy</strong></a></td>
<td>Retrieve and set HTTP proxy settings.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
