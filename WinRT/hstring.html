<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>HSTRING</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: A handle to a Windows Runtime string.
ms.assetid: 763ACE57-EFDD-482E-851E-668D7756C5DF
title: HSTRING (Hstring.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>HSTRING</h1>
<p>A handle to a Windows Runtime string.</p>
<pre lang="C++"><code>typedef HSTRING__* HSTRING;
</code></pre>
<h2>Remarks</h2>
<p>Use <strong>HSTRING</strong> to represent immutable strings in the Windows Runtime.</p>
<p>JavaScript and other languages, such as C#, and Microsoft Visual Basic, can use strings that are represented by using <strong>HSTRING</strong>. The following table shows how an <strong>HSTRING</strong> is represented in other languages.</p>
<table>
<thead>
<tr>
<th>Programming Language</th>
<th>String Representation</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/uwp/cpp-and-winrt-apis/intro-to-using-cpp-with-winrt">C++/WinRT</a></td>
<td><a href="/uwp/cpp-ref-for-winrt/hstring">winrt::hstring</a> class</td>
</tr>
<tr>
<td>VisualÂ C++ component extensions (<a href="/cpp/cppcx/visual-c-language-reference-c-cx">C++/CX</a>)</td>
<td><a href="/cpp/cppcx/platform-string-class">Platform::String</a> class</td>
</tr>
<tr>
<td>JavaScript</td>
<td>String object</td>
</tr>
<tr>
<td>.NET Framework</td>
<td>System.String class</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The <strong>HSTRING</strong> handle is a standard handle type. Semantically, an <strong>HSTRING</strong> containing the value <strong>NULL</strong> represents the empty string, which consists of zero content characters and a terminating <strong>NULL</strong> character. Creating a string via <a href="/windows/win32/api/winstring/nf-winstring-windowscreatestring"><strong>WindowsCreateString</strong></a> with zero characters will produce the handle value <strong>NULL</strong>. When calling <a href="/windows/win32/api/winstring/nf-winstring-windowsgetstringrawbuffer"><strong>WindowsGetStringRawBuffer</strong></a> with the value <strong>NULL</strong>, a pointer to an empty string followed only by the <strong>NUL</strong> terminating character will be returned. No distinct value exists to represent an <strong>HSTRING</strong> that is uninitialized.</p>
<p>Call the <a href="/windows/win32/api/winstring/nf-winstring-windowscreatestring"><strong>WindowsCreateString</strong></a> function to create a new <strong>HSTRING</strong>, and call the <a href="/windows/win32/api/winstring/nf-winstring-windowsdeletestring"><strong>WindowsDeleteString</strong></a> function to release the reference to the backing string memory. Call the <a href="/windows/win32/api/winstring/nf-winstring-windowscreatestringreference"><strong>WindowsCreateStringReference</strong></a> function to create a string reference, which is also called a <em>fast-pass string</em>.</p>
<p>Copy an <strong>HSTRING</strong> by calling the <a href="/windows/win32/api/winstring/nf-winstring-windowsduplicatestring"><strong>WindowsDuplicateString</strong></a> function.</p>
<p>Concatenate two strings by calling the <a href="/windows/win32/api/winstring/nf-winstring-windowsconcatstring"><strong>WindowsConcatString</strong></a> function.</p>
<p>Access the backing string memory by calling the <a href="/windows/win32/api/winstring/nf-winstring-windowsgetstringrawbuffer"><strong>WindowsGetStringRawBuffer</strong></a> function.</p>
<p><strong>HSTRING</strong> can store and use embedded <strong>NUL</strong> characters. Use the <a href="/windows/win32/api/winstring/nf-winstring-windowsstringhasembeddednull"><strong>WindowsStringHasEmbeddedNull</strong></a> function to check for embedded <strong>NUL</strong> characters before using any functions which may produce unexpected results. For example, most of the Windows functions use <strong>LPCWSTR</strong> as an input parameter, and they compute the length of the string only until the first <strong>NUL</strong> is encountered.</p>
<p>The backing string must remain immutable and null-terminated. When calling code creates a string reference by using the <a href="/windows/win32/api/winstring/nf-winstring-windowscreatestringreference"><strong>WindowsCreateStringReference</strong></a> function, the memory containing the backing string representation is owned by the caller. The Windows Runtime relies on the contents of the original string to remain unchanged. When passing a string reference into the Windows Runtime, it is the callerâ€™s responsibility to ensure that the stringâ€™s contents are unchanging and <strong>NUL</strong> terminated for the duration of the call. The Windows Runtime releases all references to the string reference when the call returns.</p>
<p>When you receive an <strong>HSTRING</strong> as an out parameter, it is good practice to set the handle to <strong>NULL</strong> when you are finished with it.</p>
<p>Call the <a href="/windows/win32/api/winstring/nf-winstring-windowspreallocatestringbuffer"><strong>WindowsPreallocateStringBuffer</strong></a> function to allocate a mutable string buffer that you can use to create an immutable <strong>HSTRING</strong>. When you have finished populating the buffer, you call the <a href="/windows/win32/api/winstring/nf-winstring-windowspromotestringbuffer"><strong>WindowsPromoteStringBuffer</strong></a> function to create the <strong>HSTRING</strong>. This two-phase construction pattern enables functionality that is similar to a &quot;string builder.&quot;</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 8<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2012<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Hstring.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/winstring/nf-winstring-windowscreatestring"><strong>WindowsCreateString</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/winstring/nf-winstring-windowsdeletestring"><strong>WindowsDeleteString</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/winstring/nf-winstring-windowsduplicatestring"><strong>WindowsDuplicateString</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/winstring/nf-winstring-windowspreallocatestringbuffer"><strong>WindowsPreallocateStringBuffer</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
