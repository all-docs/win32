<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Wecutil.exe</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Wecutil.exe
description: Wecutil.exe is a Windows Event Collector utility that enables an administrator to create and manage subscriptions to events forwarded from remote event sources that support the WS-Management protocol.
ms.assetid: 93ce25df-f829-43b9-96f2-7f2f291d100e
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>Wecutil.exe
topic_type:</li>
<li>apiref
api_name:</li>
<li>Wecutil.exe
api_type:</li>
<li>NA
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Wecutil.exe</h1>
<p>Wecutil.exe is a Windows Event Collector utility that enables an administrator to create and manage subscriptions to events forwarded from remote event sources that support the WS-Management protocol. Commands, options, and option values are case-insensitive for this utility.</p>
<p>If you receive a message that says &quot;The RPC server is unavailable&quot; or &quot;The interface is unknown&quot; when you try to run wecutil, then you need to start the Windows Event Collector service (wecsvc). To start wecsvc, at an elevated command prompt type <strong>net start wecsvc</strong>.</p>
<h2>List existing subscriptions</h2>
<p>The following syntax is used to list existing remote event subscriptions.</p>
<pre lang="syntax"><code>wecutil { es | enum-subscription }
</code></pre>
<p>If you use a script to get the names of the subscriptions from the output, you will need to bypass the UTF-8 BOM characters in the first line of the output. The following script shows an example of how you might skip the BOM characters.</p>
<pre lang="syntax"><code>setlocal enabledelayedexpansion

set bomskipped=
for /f %%i in ('wecutil es') do (
    set sub=%%i
    if not defined bomskipped (
        set sub=!sub:~3!
        set bomskipped=yes
    )
    echo !sub!
)
goto :eof

endlocal
</code></pre>
<h2>Get subscription configuration</h2>
<p>The following syntax is used to display remote event subscription configuration data.</p>
<pre lang="syntax"><code>wecutil { gs | get-subscription } SUBSCRIPTION_ID [/f:VALUE 
[/u:VALUE] ...]
</code></pre>
<h2>Get Configuration Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>SUBSCRIPTION_ID</strong></p>
<!-- raw HTML omitted -->
<p>A string that uniquely identifies a subscription. This identifier is specified in the <strong>SubscriptionId</strong> element in the XML configuration file used to create the subscription.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/f:<em>VALUE</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the output of the subscription configuration data. <em>VALUE</em> can be &quot;XML&quot; or &quot;Terse&quot;, and the default is &quot;Terse&quot;. If <em>VALUE</em> is &quot;XML&quot;, then the output is printed in &quot;XML&quot; format. If <em>VALUE</em> is &quot;Terse&quot;, then the output is printed in name-value pairs.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/u: <em>VALUE</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies whether the output is in Unicode format. <em>VALUE</em> can be &quot;true&quot; or &quot;false&quot;. If <em>VALUE</em> is &quot;true&quot;, then the output is in Unicode format, and if <em>VALUE</em> is &quot;false&quot;, then the output is not in Unicode format.</p>
<!-- raw HTML omitted -->
<h2>Get subscription runtime status</h2>
<p>The following syntax is used to display the subscription runtime status.</p>
<pre lang="syntax"><code>wecutil { gr | get-subscriptionruntimestatus } SUBSCRIPTION_ID
 [EVENT_SOURCE [EVENT_SOURCE] ...]
</code></pre>
<h2>Get Status Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>SUBSCRIPTION_ID</strong></p>
<!-- raw HTML omitted -->
<p>A string that uniquely identifies a subscription. This identifier is specified in the <strong>SubscriptionId</strong> element in the XML configuration file used to create the subscription.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>EVENT_SOURCE</strong></p>
<!-- raw HTML omitted -->
<p>A value that identifies a computer that is an event source for an event subscription. This value can be the fully qualified domain name for the computer, NetBIOS name, or IP address.</p>
<!-- raw HTML omitted -->
<h2>Set Subscription Configuration Information</h2>
<p>The following syntax is used to set subscription configuration data by changing subscription parameters from the command line or using an XML configuration file.</p>
<pre lang="syntax"><code>wecutil { ss | set_subscription } SUBSCRIPTION_ID [/e:VALUE] 
[/esa:EVENT_SOURCE [/ese:VALUE] [/aes] [/res] [/un:USERNAME] [/up:PASSWORD]] 
[/d:DESCRIPTION] [/uri:URI] [/cm:CONFIGURATION_MODE] [/ex:DATE_TIME] 
[/q:QUERY] [/dia:DIALECT] [/tn:TRANSPORTNAME] [/tp:TRANSPORTPORT] [/dm:MODE] 
[/dmi:NUMBER] [/dmlt:MS] [/hi:MS] [/cf:FORMAT] [/l:LOCALE] [/ree:[VALUE]] 
[/lf:FILENAME] [/pn:PUBLISHER] [/hn:NAME] [/ct:TYPE] 
[/cun:USERNAME] [/cup:PASSWORD] 
[/ica:THUMBPRINTS] [/as:ALLOWED] [/ds:DENIED] [/adc:SDDL]

wecutil {ss | set_subscription } /c:CONGIG_FILE [/cun:USERNAME] 
[/cup:PASSWORD]
</code></pre>
<h3>Remarks</h3>
<p>When an incorrect username or password is specified in the <strong>wecutil ss</strong> command, no error is reported until you view the runtime status of the subscription using the <strong>wecutil gr</strong> command.</p>
<h2>Set Configuration Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>SUBSCRIPTION_ID</strong></p>
<!-- raw HTML omitted -->
<p>A string that uniquely identifies a subscription. This identifier is specified in the <strong>SubscriptionId</strong> element in the XML configuration file used to create the subscription.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/c: <em>CONGIG_FILE</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the path to the XML file that contains subscription configuration information. The path can be absolute or relative to the current directory. This parameter can only be used with the optional /cus and /cup parameters, and is mutually exclusive with all the other parameters.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/e: <em>VALUE</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that determines whether to enable or disable the subscription. VALUE can be true or false. The default value is true, which enables the subscription.</p>
<blockquote>
<p>[!Note]<br />
When you disable a collector initiated subscription, the event source becomes inactive instead of disabled. In a collector initiated subscription, you can disable an event source independent of the subscription.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/d: <em>DESCRIPTION</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies a description for the event subscription.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/ex: <em>DATE_TIME</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the subscription expiration time. <em>DATE_TIME</em> is a value specified in standard XML or ISO8601 date-time format: &quot;yyyy-MM-ddThh:mm:ss[.sss][Z]&quot; where &quot;T&quot; is the time separator and &quot;Z&quot; indicates UTC time. For example, if <em>DATE_TIME</em> is &quot;2007-01-12T01:20:00&quot;, then the subscription expiration time is January 12th, 2007, 01:20.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/uri: <em>URI</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the type of events consumed by the subscription. The address of the event source computer along with the uniform resource identifier (URI) uniquely identifies the source of the events. The URI string is used for all event source addresses in the subscription.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/cm: <em>CONFIGURATION_MODE</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the configuration mode of the event subscription. <em>CONFIGURATION_MODE</em> can be one of the following strings: &quot;Normal&quot;, &quot;Custom&quot;, &quot;MinLatency&quot;, or &quot;MinBandwidth&quot;. The <a href="/windows/desktop/api/Evcoll/ne-evcoll-ec_subscription_configuration_mode"><strong>EC_SUBSCRIPTION_CONFIGURATION_MODE</strong></a> enumeration defines the configuration modes. The /dm, /dmi, /hi, and /dmlt parameters can only be specified if the configuration mode is set to Custom.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/q: <em>QUERY</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the query string for the subscription. The format of this string can be different for different URI values and applies to all event sources in the subscription.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/dia: <em>DIALECT</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the dialect the query string uses.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/cf: <em>FORMAT</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the format of the returned events. <em>FORMAT</em> can be &quot;Events&quot; or &quot;RenderedText&quot;. When the value is &quot;RenderedText&quot;, the events are returned with the localized strings (such as event description strings) attached to the events. The default value of <em>FORMAT</em> is &quot;RenderedText&quot;.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/l: <em>LOCALE</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the locale for delivery of the localized strings in rendered text format. <em>LOCALE</em> is a language/country culture identifier, for example, &quot;EN-us&quot;. This parameter is only valid when the /cf parameter is set to &quot;RenderedText&quot;.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/ree:[<em>VALUE</em>]</strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies which events are to be delivered for the subscription. <em>VALUE</em> can be true or false. When <em>VALUE</em> is true, all existing events are read from the subscription event sources. When <em>VALUE</em> is false, only future (arriving) events are delivered. The default is true when /ree is specified without a value, and the default is false if /ree is not specified.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/lf: <em>FILENAME</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the local event log that is used to store events received from the event subscription.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/pn: <em>PUBLISHER</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the event publisher (provider) name. It must be a publisher which owns or imports the log specified by the /lf parameter.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/dm: <em>MODE</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the subscription delivery mode. <em>MODE</em> can be either push or pull. This option is only valid if the /cm parameter is set to Custom.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/dmi: <em>NUMBER</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the maximum number of items for batched delivery in the event subscription. This option is only valid if the /cm parameter is set to Custom.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/dmlt: <em>MS</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the maximum latency allowed in delivering a batch of events. MS is the number of milliseconds allowed. This parameter is only valid if the /cm parameter is set to Custom.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/hi: <em>MS</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the heartbeat interval for the subscription. <em>MS</em> is the number of milliseconds used in the interval. This parameter is only valid if the /cm parameter is set to Custom.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/tn: <em>TRANSPORTNAME</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the name of the transport used to connect to the remote event source computer.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/esa: <em>EVENT_SOURCE</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the address of an event source computer. <em>EVENT_SOURCE</em> is a string that identifies an event source computer using the fully qualified domain name for the computer, NetBIOS name, or IP address. This parameter can be used with the /ese, /aes, /res, or /un and /up parameters.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/ese: <em>VALUE</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that determines whether to enable or disable an event source. <em>VALUE</em> can be true or false. The default value is true, which enables the event source. This parameter is only used if the /esa parameter is used.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/aes</strong></p>
<!-- raw HTML omitted -->
<p>A value that adds the event source specified by the /esa parameter if the event source is not already part of the event subscription. If the computer specified by the /esa parameter is already a part of the subscription, then an error is displayed. This parameter is allowed only if the /esa parameter is used.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/res</strong></p>
<!-- raw HTML omitted -->
<p>A value that removes the event source specified by the /esa parameter if the event source is already part of the event subscription. If the computer specified by the /esa parameter is not part of the subscription, then an error is displayed. This parameter is allowed only if the /esa parameter is used.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/un: <em>USERNAME</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the user name used in the credentials to connect to the event source specified in the /esa parameter. This parameter is allowed only if the /esa parameter is used.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/up: <em>PASSWORD</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the password for the user name specified in the /un parameter. The user name and password credentials are used to connect to the event source specified in the /esa parameter. This parameter is allowed only if the /un parameter is used.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/tp: <em>TRANSPORTPORT</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the port number used by the transport when connecting to a remote event source computer.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/hn: <em>NAME</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the DNS name of the local computer. This name is used by remote event sources to push back events and must be used for push subscriptions only.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/ct: <em>TYPE</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the credential type used for accessing remote event sources. <em>TYPE</em> can be &quot;default&quot;, &quot;negotiate&quot;, &quot;digest&quot;, &quot;basic&quot;, or &quot;localmachine&quot;. The default is &quot;default&quot;. These values are defined in the <a href="/windows/desktop/api/Evcoll/ne-evcoll-ec_subscription_credentials_type"><strong>EC_SUBSCRIPTION_CREDENTIALS_TYPE</strong></a> enumeration.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/cun: <em>USERNAME</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that sets the shared user credentials used for event sources that do not have their own user credentials.</p>
<blockquote>
<p>[!Note]<br />
If this parameter is used with the /c option, then user name and password settings for individual event sources from the configuration file are ignored. If you want to use different credentials for a specific event source, you can override this value by specifying the /un and /up parameters for a specific event source on the command line of another set-subscription command.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/cup: <em>PASSWORD</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that sets the user password for the shared user credentials. When <em>PASSWORD</em> is set to * (asterisk), then the password is read from the console. This option is only valid when the /cun parameter is specified.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/ica: <em>THUMBPRINTS</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that sets the list of issuer certificate thumb prints, in a comma-separated list.</p>
<blockquote>
<p>[!Note]<br />
This option is specific to source initiated subscriptions only.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/as: <em>ALLOWED</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that sets a comma-separated list of string that specify the DNS names of non-domain computers that are allowed to initiate subscriptions. The names can be specified using wildcards, such as &quot;*.mydomain.com&quot;. By default, this list is empty.</p>
<blockquote>
<p>[!Note]<br />
This option is specific to source initiated subscriptions only.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/ds: <em>DENIED</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that sets a comma-separated list of string that specify the DNS names of non-domain computers that are not allowed to initiate subscriptions. The names can be specified using wildcards, such as &quot;*.mydomain.com&quot;. By default, this list is empty.</p>
<blockquote>
<p>[!Note]<br />
This option is specific to source initiated subscriptions only.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/adc: <em>SDDL</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that sets a string, in SDDL format, that specifies which domain computers are allowed or not allowed to initiate subscriptions. The default is to allow all domain computers to initiate subscriptions.</p>
<blockquote>
<p>[!Note]<br />
This option is specific to source initiated subscriptions only.</p>
</blockquote>
<!-- raw HTML omitted -->
<h2>Create a New Subscription</h2>
<p>The following syntax is used to create an event subscription for events on a remote computer.</p>
<pre lang="syntax"><code>wecutil {cs | create-subscription } CONFIGURATION_FILE [/cun:USERNAME]
[/cup:PASSWORD] 
</code></pre>
<h3>Remarks</h3>
<p>When an incorrect username or password is specified in the <strong>wecutil cs</strong> command, no error is reported until you view the runtime status of the subscription using the <strong>wecutil gr</strong> command.</p>
<h2>Creation Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>CONFIGURATION_FILE</strong></p>
<!-- raw HTML omitted -->
<p>A value that specifies the path to the XML file that contains subscription configuration information. The path can be absolute or relative to the current directory.</p>
<p>The following XML is an example of a subscription configuration file that creates a collector initiated subscription to forward events from the Application event log of a remote computer to the ForwardedEvents log.</p>
<pre lang="XML"><code>&lt;Subscription xmlns=&quot;http://schemas.microsoft.com/2006/03/windows/events/subscription&quot;&gt;
    &lt;SubscriptionId&gt;SampleCISubscription&lt;/SubscriptionId&gt;
    &lt;SubscriptionType&gt;CollectorInitiated&lt;/SubscriptionType&gt;
    &lt;Description&gt;Collector Initiated Subscription Sample&lt;/Description&gt;
    &lt;Enabled&gt;true&lt;/Enabled&gt;
    &lt;Uri&gt;http://schemas.microsoft.com/wbem/wsman/1/windows/EventLog&lt;/Uri&gt;

    &lt;!-- Use Normal (default), Custom, MinLatency, MinBandwidth --&gt;
    &lt;ConfigurationMode&gt;Custom&lt;/ConfigurationMode&gt;

    &lt;Delivery Mode=&quot;Push&quot;&gt;
        &lt;Batching&gt;
            &lt;MaxItems&gt;20&lt;/MaxItems&gt;
            &lt;MaxLatencyTime&gt;60000&lt;/MaxLatencyTime&gt;
        &lt;/Batching&gt;
        &lt;PushSettings&gt;
            &lt;HostName&gt;thisMachine.myDomain.com&lt;/HostName&gt;
            &lt;Heartbeat Interval=&quot;60000&quot;/&gt;
        &lt;/PushSettings&gt;
    &lt;/Delivery&gt;

    &lt;Expires&gt;2010-01-01T00:00:00.000Z&lt;/Expires&gt;

    &lt;Query&gt;
        &lt;![CDATA[
            &lt;QueryList&gt;
                &lt;Query Path=&quot;Application&quot;&gt;
                    &lt;Select&gt;*&lt;/Select&gt;
                &lt;/Query&gt;
            &lt;/QueryList&gt;
        ]]&gt;
    &lt;/Query&gt;

    &lt;ReadExistingEvents&gt;false&lt;/ReadExistingEvents&gt;
    &lt;TransportName&gt;http&lt;/TransportName&gt;
    &lt;ContentFormat&gt;RenderedText&lt;/ContentFormat&gt;
    &lt;Locale Language=&quot;en-US&quot;/&gt;
    &lt;LogFile&gt;ForwardedEvents&lt;/LogFile&gt;
    &lt;CredentialsType&gt;Default&lt;/CredentialsType&gt;

    &lt;EventSources&gt;
        &lt;EventSource Enabled=&quot;true&quot;&gt;
            &lt;Address&gt;mySource.myDomain.com&lt;/Address&gt;
            &lt;UserName&gt;myUserName&lt;/UserName&gt;
        &lt;/EventSource&gt;
    &lt;/EventSources&gt;
&lt;/Subscription&gt;
</code></pre>
<p>The following XML is an example of a subscription configuration file that creates a source initiated subscription to forward events from the Application event log of a remote computer to the ForwardedEvents log.</p>
<pre lang="XML"><code>&lt;Subscription xmlns=&quot;http://schemas.microsoft.com/2006/03/windows/events/subscription&quot;&gt;
    &lt;SubscriptionId&gt;SampleSISubscription&lt;/SubscriptionId&gt;
    &lt;SubscriptionType&gt;SourceInitiated&lt;/SubscriptionType&gt;
    &lt;Description&gt;Source Initiated Subscription Sample&lt;/Description&gt;
    &lt;Enabled&gt;true&lt;/Enabled&gt;
    &lt;Uri&gt;http://schemas.microsoft.com/wbem/wsman/1/windows/EventLog&lt;/Uri&gt;

    &lt;!-- Use Normal (default), Custom, MinLatency, MinBandwidth --&gt;
    &lt;ConfigurationMode&gt;Custom&lt;/ConfigurationMode&gt;

    &lt;Delivery Mode=&quot;Push&quot;&gt;
        &lt;Batching&gt;
            &lt;MaxItems&gt;1&lt;/MaxItems&gt;
            &lt;MaxLatencyTime&gt;1000&lt;/MaxLatencyTime&gt;
        &lt;/Batching&gt;
        &lt;PushSettings&gt;
            &lt;Heartbeat Interval=&quot;60000&quot;/&gt;
        &lt;/PushSettings&gt;
    &lt;/Delivery&gt;

    &lt;Expires&gt;2018-01-01T00:00:00.000Z&lt;/Expires&gt;

    &lt;Query&gt;
        &lt;![CDATA[
            &lt;QueryList&gt;
                &lt;Query Path=&quot;Application&quot;&gt;
                    &lt;Select&gt;Event[System/EventID='999']&lt;/Select&gt;
                &lt;/Query&gt;
            &lt;/QueryList&gt;
        ]]&gt;
    &lt;/Query&gt;

    &lt;ReadExistingEvents&gt;true&lt;/ReadExistingEvents&gt;
    &lt;TransportName&gt;http&lt;/TransportName&gt;
    &lt;ContentFormat&gt;RenderedText&lt;/ContentFormat&gt;
    &lt;Locale Language=&quot;en-US&quot;/&gt;
    &lt;LogFile&gt;ForwardedEvents&lt;/LogFile&gt;
    &lt;AllowedSourceNonDomainComputers&gt;&lt;/AllowedSourceNonDomainComputers&gt;
    &lt;AllowedSourceDomainComputers&gt;O:NSG:NSD:(A;;GA;;;DC)(A;;GA;;;NS)&lt;/AllowedSourceDomainComputers&gt;
&lt;/Subscription&gt;
</code></pre>
<blockquote>
<p>[!Note]<br />
When creating a source initiated subscription, if <strong>AllowedSourceDomainComputers</strong>, <strong>AllowedSourceNonDomainComputers</strong>/<strong>IssuerCAList</strong>, <strong>AllowedSubjectList</strong>, and <strong>DeniedSubjectList</strong> are all empty, then a default will be provided for <strong>AllowedSourceDomainComputers</strong> - &quot;O:NSG:NSD:(A;;GA;;;DC)(A;;GA;;;NS)&quot;. This SDDL default grants members of the Domain Computers domain group, as well as the local Network Service group (for the local forwarder), the ability to raise events for this subscription.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/cun: <em>USERNAME</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that sets the shared user credentials used for event sources that do not have their own user credentials. This value applies to collector initiated subscriptions only.</p>
<blockquote>
<p>[!Note]<br />
If this parameter is specified, then user name and password settings for individual event sources from the configuration file are ignored. If you want to use different credentials for a specific event source, you can override this value by specifying the /un and /up parameters for a specific event source on the command line of another set-subscription command.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/cup: <em>PASSWORD</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that sets the user password for the shared user credentials. When <em>PASSWORD</em> is set to &quot;*&quot; (asterisk), then the password is read from the console. This option is only valid when the /cun parameter is specified.</p>
<!-- raw HTML omitted -->
<h2>Delete a Subscription</h2>
<p>The following syntax is used to delete an event subscription.</p>
<pre lang="syntax"><code>wecutil { ds | delete-subscription } SUBSCRIPTION_ID
</code></pre>
<h2>Deletion Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>SUBSCRIPTION_ID</strong></p>
<!-- raw HTML omitted -->
<p>A string that uniquely identifies a subscription. This identifier is specified in the <strong>SubscriptionId</strong> element in the XML configuration file used to create the subscription. The subscription identified in this parameter will be deleted.</p>
<!-- raw HTML omitted -->
<h2>Retry a subscription</h2>
<p>The following syntax is used to retry an inactive subscription by attempting to reactivate all or specified event sources by establishing a connection to each event source and sending a remote subscription request to the event source. Disabled event sources are not retried.</p>
<pre lang="syntax"><code>wecutil { rs | retry-subscription } SUBSCRIPTION_ID 
[EVENT_SOURCE [EVENT_SOURCE] ...]
</code></pre>
<h2>Retry Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>SUBSCRIPTION_ID</strong></p>
<!-- raw HTML omitted -->
<p>A string that uniquely identifies a subscription. This identifier is specified in the <strong>SubscriptionId</strong> element in the XML configuration file used to create the subscription. The subscription identified in this parameter will be retried.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>EVENT_SOURCE</strong></p>
<!-- raw HTML omitted -->
<p>A value that identifies a computer that is an event source for an event subscription. This value can be the fully qualified domain name for the computer, NetBIOS name, or IP address.</p>
<!-- raw HTML omitted -->
<h2>Configure the Windows Event Collector Service</h2>
<p>The following syntax is used to configure the Windows Event Collector service to ensure event subscriptions can be created and sustained through computer restarts. This includes the following procedure:</p>
<p><strong>To configure the Windows Event Collector service</strong></p>
<ol>
<li>Enable the ForwardedEvents channel if it is disabled.</li>
<li>Delay the start of the Windows Event Collector service.</li>
<li>Start the Windows Event Collector service if it is not running.</li>
</ol>
<pre lang="syntax"><code>wecutil { qc | quick-config } /q:VALUE
</code></pre>
<h2>Configure Event Collector Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/q: <em>VALUE</em></strong></p>
<!-- raw HTML omitted -->
<p>A value that determines whether the quick-config command will prompt for confirmation. VALUE can be true or false. If VALUE is true, then the command will prompt for confirmation. The default value is false.</p>
<!-- raw HTML omitted -->
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
