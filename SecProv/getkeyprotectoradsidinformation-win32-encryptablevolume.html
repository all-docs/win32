<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GetKeyProtectorAdSidInformation method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Retrieves the security identifier and flags used to protect a key.
ms.assetid: 5EF97F44-78FF-4FBF-9142-F2DD0A849057
title: GetKeyProtectorAdSidInformation method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.GetKeyProtectorCertificate
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>GetKeyProtectorAdSidInformation method of the Win32_EncryptableVolume class</h1>
<p>The <strong>GetKeyProtectorAdSidInformation</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class retrieves the security identifier and flags used to protect a key.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 GetKeyProtectorCertificate(
  [in]Â Â string VolumeKeyProtectorID,
  [out]Â string SidString,
  [out]Â uint32 Flags
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>VolumeKeyProtectorID</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A string identifier that can be used to manage an encrypted volume key protector.</p>
<!-- raw HTML omitted -->
<p><em>SidString</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A string that contains the security identifier (SID).</p>
<!-- raw HTML omitted -->
<p><em>Flags</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>uint32</strong></p>
<p>Flags that change the function behavior. This can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_DPAPI_NG_FLAG_NONE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>No effect.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_DPAPI_NG_FLAG_UNLOCK_AS_SERVICE_ACCOUNT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0001<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Specifies that the SID-based protector was protected to a service account. If this flag is specified, the caller should ensure that it is running as the appropriate service account before calling <a href="unlockwithadsid-win32-encryptablevolume.html"><strong>UnlockWithAdSid</strong></a> (by temporarily dropping impersonation, for example).<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>This method returns one of the following codes or another error code if it fails.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 8 Enterprise, WindowsÂ 8 Pro [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2012 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
