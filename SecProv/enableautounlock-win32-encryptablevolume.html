<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EnableAutoUnlock method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Allows a data volume to be automatically unlocked when the volume is mounted.
ms.assetid: ec77b17f-545b-40a7-91b2-ff0b32b8370d
title: EnableAutoUnlock method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.EnableAutoUnlock
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>EnableAutoUnlock method of the Win32_EncryptableVolume class</h1>
<p>The <strong>EnableAutoUnlock</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class allows a data volume to be automatically unlocked when the volume is mounted.</p>
<p>Automatic unlocking saves an external key to the operating system that can automatically unlock the volume onto the currently running operating system volume.</p>
<p>To use this method, the operating system volume must already be protected by BitLocker Drive Encryption or must have encryption in progress. In addition, there must already exist an external key for the data volume. Use <a href="protectkeywithexternalkey-win32-encryptablevolume.html"><strong>ProtectKeyWithExternalKey</strong></a> to create the external key that can automatically unlock the volume.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 EnableAutoUnlock(
  [in]Â string VolumeKeyProtectorID
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>VolumeKeyProtectorID</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A string that identifies the key protector of the type &quot;External Key&quot; used to automatically unlock the volume.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>This method returns one of the following codes or another error code if it fails.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_LOCKED_VOLUME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694912 (0x80310000)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The volume is locked.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_NOT_ACTIVATED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694920 (0x80310008)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>BitLocker is not enabled on the volume. Add a key protector to enable BitLocker. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_INVALIDARG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2147942487 (0x80070057)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>VolumeKeyProtectorID</em> parameter does not refer to a valid key protector of the type &quot;External Key&quot;.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_NOT_DATA_VOLUME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694937 (0x80310019)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method cannot be run for the currently running operating system volume.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_OS_NOT_PROTECTED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694944 (0x80310020)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method cannot be run if the currently running operating system volume is not protected by BitLocker Drive Encryption or does not have encryption in progress.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_VOLUME_BOUND_ALREADY</strong> <!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694943 (0x8031001F)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Automatic unlocking on the volume has previously been enabled.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>Given a valid volume key protector of the type &quot;External Key&quot;, the related 256-bit external key is extracted from the protector and stored into the registry of the currently running operating system, along with the volume key protector ID.</p>
<p>If the external key associated with the volume key protector ID is deleted, the functionality to automatically unlock the volume is disabled or suspended.</p>
<blockquote>
<p>[!Note]<br />
Removable media is not currently supported.</p>
</blockquote>
<p>Â </p>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista Enterprise, WindowsÂ Vista Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
