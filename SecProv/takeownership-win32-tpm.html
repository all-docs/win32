<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TakeOwnership method of the Win32_Tpm class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Installs an owner for the TPM.
ms.assetid: 7b4c8785-0925-41a8-a878-7c1f38d31853
title: TakeOwnership method of the Win32_Tpm class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_Tpm.TakeOwnership
api_type:</li>
<li>COM
api_location:</li>
<li>Win32_tpm.dll</li>
</ul>
<hr />
<h1>TakeOwnership method of the Win32_Tpm class</h1>
<p>The <strong>TakeOwnership</strong> method of the <a href="win32-tpm.html"><strong>Win32_Tpm</strong></a> class installs an owner for the TPM. The owner of the TPM can make full use of TPM capabilities. After an owner is set, no other user or software can claim ownership of the TPM.</p>
<p>The <a href="isenabled-win32-tpm.html"><strong>IsEnabled</strong></a>, <a href="isactivated-win32-tpm.html"><strong>IsActivated</strong></a>, and <a href="isownershipallowed-win32-tpm.html"><strong>IsOwnershipAllowed</strong></a> methods must all be true before the <strong>TakeOwnership</strong> method can succeed.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 TakeOwnership(
  [in, optional]Â string OwnerAuth
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>OwnerAuth</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A string that identifies the TPM owner. This string must be a base64-encoded null-terminated string that contains exactly 20 bytes of binary data. Use the <a href="converttoownerauth-win32-tpm.html"><strong>ConvertToOwnerAuth</strong></a> method to translate a passphrase to this expected format. The <em>OwnerAuth</em> parameter is read from the registry if none is provided.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>All TPM errors as well as errors specific to TPM Base Services can be returned.</p>
<p>The following table lists some of the common return codes.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_INVALIDARG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2147942487 (0x80070057)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>OwnerAuth</em> parameter is not valid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TPM_E_OWNER_SET</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150105108 (0x80280014)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An owner already exists on the TPM.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TPM_E_NO_ENDORSEMENT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150105123 (0x80280023)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>No endorsement key can be found on the TPM.<!-- raw HTML omitted --> To create an endorsement key pair on the TPM, see the <a href="createendorsementkeypair-win32-tpm.html"><strong>CreateEndorsementKeyPair</strong></a> method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TPM_E_INSTALL_DISABLED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150105099 (0x8028000B)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An owner cannot be installed on this TPM.<!-- raw HTML omitted --> For information about how to allow installation of a device owner, see <a href="setphysicalpresencerequest-win32-tpm.html"><strong>SetPhysicalPresenceRequest</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TPM_E_DEFEND_LOCK_RUNNING</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150107139 (0x80280803)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The TPM is defending against dictionary attacks and is in a time-out period. For more information, see the <a href="resetauthlockout-win32-tpm.html"><strong>ResetAuthLockOut</strong></a> method.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>The methods <a href="isenabled-win32-tpm.html"><strong>IsEnabled</strong></a>, <a href="isactivated-win32-tpm.html"><strong>IsActivated</strong></a>, and <a href="isownershipallowed-win32-tpm.html"><strong>IsOwnershipAllowed</strong></a> must all be true before <strong>TakeOwnership</strong> can succeed.</p>
<p>You should use the <a href="converttoownerauth-win32-tpm.html"><strong>ConvertToOwnerAuth</strong></a> method to change a passphrase into the input value used for the <em>OwnerAuth</em> parameter.</p>
<p>The <strong>TakeOwnership</strong> method backs up the owner authorization value to Active Directory if the appropriate Group Policy settings have been configured.</p>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftTpm<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_tpm.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_tpm.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-tpm.html"><strong>Win32_Tpm</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
