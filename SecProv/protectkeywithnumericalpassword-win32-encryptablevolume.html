<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ProtectKeyWithNumericalPassword method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Secures the volume's encryption key with a specially formatted 48-digit password.
ms.assetid: 23e0b79a-2feb-441a-9785-7ecd3bb4b6c6
title: ProtectKeyWithNumericalPassword method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.ProtectKeyWithNumericalPassword
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>ProtectKeyWithNumericalPassword method of the Win32_EncryptableVolume class</h1>
<p>The <strong>ProtectKeyWithNumericalPassword</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class secures the volume's encryption key with a specially formatted 48-digit password. This numerical password can be used to recover from the authentication failures of other key protectors (for example, TPM).</p>
<p>A key protector of type &quot;Numerical Password&quot; is created for the volume.</p>
<p>Use the <a href="isnumericalpasswordvalid-win32-encryptablevolume.html"><strong>IsNumericalPasswordValid</strong></a> method to validate the format of the numerical password.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 ProtectKeyWithNumericalPassword(
  [in, optional]Â string FriendlyName,
  [in, optional]Â string NumericalPassword,
  [out]Â Â Â Â Â Â Â Â Â Â string VolumeKeyProtectorID
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>FriendlyName</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A string that specifies a user-assigned identifier for this key protector. If this parameter is not specified, a blank value is used.</p>
<!-- raw HTML omitted -->
<p><em>NumericalPassword</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A string that specifies the specially formatted 48-digit numerical password.</p>
<p>The numerical password must contain 48 digits. These digits can be divided into 8 groups of 6 digits, with the last digit in each group indicating a checksum value for the group. Each group of 6 digits must be divisible by 11 and must be 720885 or less. Assuming a group of six digits is labeled as x1, x2, x3, x4, x5, and x6, the checksum x6 digit is calculated as â€“x1+x2â€“x3+x4â€“x5 mod 11.</p>
<p>The groups of digits can optionally be separated by a space or hyphen. Therefore, &quot;xxxxxx-xxxxxx-xxxxxx-xxxxxx-xxxxxx-xxxxxx-xxxxxx-xxxxxx&quot; or &quot;xxxxxx xxxxxx xxxxxx xxxxxx xxxxxx xxxxxx xxxxxx xxxxxx&quot; may also contain valid numerical passwords.</p>
<p>If no numerical password is specified, one is randomly generated. Use the <a href="getkeyprotectornumericalpassword-win32-encryptablevolume.html"><strong>GetKeyProtectorNumericalPassword</strong></a> method to obtain the randomly generated password.</p>
<!-- raw HTML omitted -->
<p><em>VolumeKeyProtectorID</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A string that is the unique identifier associated with the created protector and that can be used to manage the key protector.</p>
<p>If the drive supports hardware encryption and BitLocker has not taken band ownership, the ID string is set to &quot;BitLocker&quot; and the key protector is written to per band metadata.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>This method returns one of the following codes or another error code if it fails.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_INVALIDARG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2147942487 (0x80070057)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>NumericalPassword</em> parameter does not have a valid format.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_LOCKED_VOLUME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694912 (0x80310000)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The volume is locked.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_INVALID_PASSWORD_FORMAT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694965 (0x80310035)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>NumericalPassword</em> parameter does not have a valid format.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista Enterprise, WindowsÂ Vista Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
