<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GetKeyProtectorCertificate method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Retrieves the public key and certificate thumbprint for a public key protector.
ms.assetid: 86fd0562-feb9-4b85-b27b-30270f864d8e
title: GetKeyProtectorCertificate method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.GetKeyProtectorCertificate
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>GetKeyProtectorCertificate method of the Win32_EncryptableVolume class</h1>
<p>The <strong>GetKeyProtectorCertificate</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class retrieves the <a href="../secgloss/p-gly.html"><em>public key</em></a> and <a href="../secgloss/c-gly.html"><em>certificate</em></a> thumbprint for a public key protector.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 GetKeyProtectorCertificate(
  [in]Â Â string VolumeKeyProtectorID,
  [out]Â uint8 Â PublicKey[],
  [out]Â string CertThumbprint,
  [out]Â uint32 CertType
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>VolumeKeyProtectorID</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A unique string identifier used to manage an encrypted volume key protector.</p>
<!-- raw HTML omitted -->
<p><em>PublicKey</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>uint8[]</strong></p>
<p>An array of bytes that specifies the public key.</p>
<!-- raw HTML omitted -->
<p><em>CertThumbprint</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A string that specifies the certificate thumbprint.</p>
<!-- raw HTML omitted -->
<p><em>CertType</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>uint32</strong></p>
<p>An unsigned integer that specifies the type of the key protector. This integer is used to differentiate between data recovery agent (DRA) and user certificates.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The certificate is a DRA.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The certificate is not a DRA.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>This method returns one of the following codes or another error code if it fails.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_INVALIDARG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2147942487 (0x80070057)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The specified key protector is not a key protector. You must enter another key protector.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_LOCKED_VOLUME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694912 (0x80310000)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>This drive is locked by BitLocker Drive Encryption. You must unlock this volume from Control Panel. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_NOT_ACTIVATED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694920 (0x80310008)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>BitLocker is not enabled on the volume. Add a key protector to enable BitLocker. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_POLICY_USER_CERTIFICATE_REQUIRED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150695027 (0x80310073)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Group Policy requires the use of a user certificate, such as a smart card.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 7 Enterprise, WindowsÂ 7 Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008Â R2 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
