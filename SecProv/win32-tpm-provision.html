<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Win32_Tpm::Provision method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Attempts to provision the TPM to a completely ready state and will take the ownership of TPM if it is not already owned.
ms.assetid: D0C09A48-00D0-4BF2-8F0A-451A61EA7810
title: Win32_Tpm::Provision method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_Tpm.Provision
api_type:</li>
<li>COM
api_location:</li>
<li>Win32_tpm.dll</li>
</ul>
<hr />
<h1>Win32_Tpm::Provision method</h1>
<p>Attempts to provision the TPM to a completely ready state and will take the ownership of TPM if it is not already owned. This method is expensive to execute because it performs many checks. It is recommended applications use this method only when necessary.</p>
<p>This method is only accessible by local administrators.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>uint32 Provision(
  [in]Â Â BOOL Â Â ForceClear_Allowed,
  [in]Â Â BOOL Â Â PhysicalPresencePrompts_Allowed,
  [out]Â uint32 Information
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>ForceClear_Allowed</em> [in]</p>
<!-- raw HTML omitted -->
<p>When set to <strong>TRUE</strong> the method may request physical presence operations to clear the TPM. If set to <strong>FALSE</strong>, the method will not request a physical presence operation to clear the TPM.</p>
<!-- raw HTML omitted -->
<p><em>PhysicalPresencePrompts_Allowed</em> [in]</p>
<!-- raw HTML omitted -->
<p>When set to <strong>TRUE</strong> the method may request physical presence operations that require user involvement during the boot process to confirm the TPM state change.</p>
<!-- raw HTML omitted -->
<p><em>Information</em> [out]</p>
<!-- raw HTML omitted -->
<p>Returns a bitmask of as much information as is available of what is needed to fully provision the TPM. Mask values like INFORMATION_REBOOT indicate the method call should initiate a reboot to move the provisioning process forwards.</p>
<p>The <em>Information</em> parameter may consist of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_SHUTDOWN</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000002<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Platform restart is required (shutdown).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_REBOOT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000004<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Platform restart is required (reboot).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_FORCE_CLEAR</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000008<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The TPM is already owned. Either the TPM needs to be cleared or the TPM owner authorization value needs to be imported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_PHYSICAL_PRESENCE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000010<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Physical Presence is required to provision the TPM.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_ACTIVATE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000020<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The TPM is disabled or deactivated.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_TAKE_OWNERSHIP</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000040<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The TPM ownership was taken.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_CREATE_EK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000080<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An Endorsement Key (EK) exists in the TPM. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_OWNERAUTH</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000100<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The TPM owner authorization is not properly stored in the registry.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_SRK_AUTH</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x000000200<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The Storage Root Key (SRK) authorization value is not all zeros.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_DISABLE_OWNER_CLEAR</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000400<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If the operating system is configured to disable clearing of the TPM with the TPM owner authorization value and the TPM has not yet been configured to prevent clearing of the TPM with the TPM owner authorization value .<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_SRKPUB</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000800<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The operating system's registry information about the TPMâ€™s Storage Root Key does not match the TPM Storage Root Key.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_READ_SRKPUB</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00001000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The TPM permanent flag to allow reading of the Storage Root Key public value is not set.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_BOOT_COUNTER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00002000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The monotonic counter incremented during boot has not been created.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_AD_BACKUP</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00004000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The TPMâ€™s owner authorization has not been backed up to Active Directory.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_AD_BACKUP_PHASE_I</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00008000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The first portion of the TPM owner authorization information storage in Active Directory is in progress.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TPM_AD_BACKUP_PHASE_II</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00010000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The second portion of the TPM owner authorization information storage in Active Directory is in progress.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_LEGACY_CONFIGURATION</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00020000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Windows Group Policy is configured to not store any TPM owner authorization so the TPM cannot be fully ready.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_EK_CERTIFICATE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00040000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The EK Certificate was not read from the TPM NV Ram and stored in the registry. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_TCG_EVENT_LOG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00080000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The TCG event log is empty or cannot be read. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_NOT_REDUCED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00100000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The TPM is not owned.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_GENERIC_ERROR</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00200000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An error occurred, but not specific to a particular task.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>INFORMATION_DEVICE_LOCK_COUNTER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00400000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The device lock counter has not been created.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>All TPM errors as well as errors specific to <a href="../tbs/tbs-return-codes.html">TPM Base Services</a> can be returned.</p>
<p>Common return codes are listed below.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 8 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2012 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>\\.\root\CIMV2\Security\MicrosoftTpm<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_tpm.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_tpm.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-tpm.html"><strong>Win32_Tpm</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
