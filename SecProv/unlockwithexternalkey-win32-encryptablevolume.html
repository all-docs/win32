<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>UnlockWithExternalKey method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Uses a provided external key to access the contents of a data volume.
ms.assetid: e383767e-8557-469c-bc44-f67591c46f23
title: UnlockWithExternalKey method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.UnlockWithExternalKey
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>UnlockWithExternalKey method of the Win32_EncryptableVolume class</h1>
<p>The <strong>UnlockWithExternalKey</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class uses a provided external key to access the contents of a data volume.</p>
<p>The volume's encryption key must have been secured with one or more key protectors of the type &quot;External Key&quot; using the <a href="protectkeywithexternalkey-win32-encryptablevolume.html"><strong>ProtectKeyWithExternalKey</strong></a> method to be able to unlock the volume with this method.</p>
<blockquote>
<p>[!Note]<br />
If the disc supports hardware encryption this function sets the band status to &quot;unlocked&quot;&quot;</p>
</blockquote>
<p>Â </p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 UnlockWithExternalKey(
  [in]Â uint8 ExternalKey[]
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>ExternalKey</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>uint8[]</strong></p>
<p>An array of bytes that specifies the 256-bit external key used to unlock the volume. This key can be obtained by calling the <a href="getexternalkeyfromfile-win32-encryptablevolume.html"><strong>GetExternalKeyFromFile</strong></a> method.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>This method returns one of the following codes or another error code if it fails.</p>
<p>If the volume is already unlocked, this method returns 0.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>ERROR_NOT_FOUND</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->No value given (0x)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The volume does not have a key protector of the type &quot;External Key&quot;.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>ERROR_INVALID_PASSWORD</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->No value given (0x)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>One or more key protectors of the type &quot;External Key&quot; exist, but the specified <em>ExternalKey</em> parameter cannot unlock the volume.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_INVALIDARG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2147942487 (0x80070057)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>ExternalKey</em> parameter is not an array of size 4.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_NOT_ACTIVATED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694920 (0x80310008)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>BitLocker is not enabled on the volume. Add a key protector to enable BitLocker. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista Enterprise, WindowsÂ Vista Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
