<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GetProtectionStatus method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Indicates whether the volume and its encryption key are secured.
ms.assetid: bcd8fce5-da39-4aa8-93ff-0768deb900ec
title: GetProtectionStatus method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.GetProtectionStatus
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>GetProtectionStatus method of the Win32_EncryptableVolume class</h1>
<p>The <strong>GetProtectionStatus</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class indicates whether the volume and its encryption key (if any) are secured.</p>
<p>Protection is off if a volume is unencrypted or partially encrypted, or if the volume's encryption key is available in the clear on the hard disk.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 GetProtectionStatus(
  [out]Â uint32 ProtectionStatus
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>ProtectionStatus</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>uint32</strong></p>
<p>Specifies whether the volume and the encryption key (if any) are secured.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Unprotected<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->0<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>PROTECTION OFF<!-- raw HTML omitted --> For a standard HDD:<!-- raw HTML omitted --> The volume is unencrypted, partially encrypted, or the volume's encryption key is available in the clear on the hard disk. The encryption key is available in the clear on the hard disk if key protectors have been disabled by using the <!-- raw HTML omitted --><!-- raw HTML omitted -->DisableKeyProtectors<!-- raw HTML omitted --><!-- raw HTML omitted --> method or if no key protectors have been specified by using the following methods:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithCertificateFile<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithCertificateThumbprint<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithExternalKey<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithNumericalPassword<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithPassphrase<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithTPM<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithTPMAndPIN<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithTPMAndPINAndStartupKey<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithTPMAndStartupKey<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> For an EHDD:<!-- raw HTML omitted --> The band for the volume is perpetually unlocked, has no key manager, or is managed by a third party key manager.<!-- raw HTML omitted --> This can also mean that the band is managed by BitLocker but the <!-- raw HTML omitted --><!-- raw HTML omitted -->DisableKeyProtectors<!-- raw HTML omitted --><!-- raw HTML omitted --> method has been called and the drive is suspended.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Protected<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->1<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>PROTECTION ON<!-- raw HTML omitted --> For a standard HDD:<!-- raw HTML omitted --> The volume is fully encrypted and the encryption key for the volume is not available in the clear on the hard disk.<!-- raw HTML omitted --> For an EHDD:<!-- raw HTML omitted --> BitLocker is the key manager for the band. The drive can be locked or unlocked but cannot be perpetually unlocked.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Unknown<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->2<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>The volume protection status cannot be determined. This can be caused by the volume being in a locked state.<!-- raw HTML omitted --><!-- raw HTML omitted -->WindowsÂ Vista Ultimate, WindowsÂ Vista Enterprise and Windows ServerÂ 2008:<!-- raw HTML omitted --> This value is not supported. This value is supported beginning with WindowsÂ 7 and Windows ServerÂ 2008Â R2.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>This method returns one of the following codes or another error code if it fails.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>You can encrypt a volume only if you either call <a href="disablekeyprotectors-win32-encryptablevolume.html"><strong>DisableKeyProtectors</strong></a> first or use one of the following methods:</p>
<ul>
<li><a href="protectkeywithcertificatefile-win32-encryptablevolume.html"><strong>ProtectKeyWithCertificateFile</strong></a></li>
<li><a href="protectkeywithcertificatethumbprint-win32-encryptablevolume.html"><strong>ProtectKeyWithCertificateThumbprint</strong></a></li>
<li><a href="protectkeywithexternalkey-win32-encryptablevolume.html"><strong>ProtectKeyWithExternalKey</strong></a></li>
<li><a href="protectkeywithnumericalpassword-win32-encryptablevolume.html"><strong>ProtectKeyWithNumericalPassword</strong></a></li>
<li><a href="protectkeywithpassphrase-win32-encryptablevolume.html"><strong>ProtectKeyWithPassphrase</strong></a></li>
<li><a href="protectkeywithtpm-win32-encryptablevolume.html"><strong>ProtectKeyWithTPM</strong></a></li>
<li><a href="protectkeywithtpmandpin-win32-encryptablevolume.html"><strong>ProtectKeyWithTPMAndPIN</strong></a></li>
<li><a href="protectkeywithtpmandpinandstartupkey-win32-encryptablevolume.html"><strong>ProtectKeyWithTPMAndPINAndStartupKey</strong></a></li>
<li><a href="protectkeywithtpmandstartupkey-win32-encryptablevolume.html"><strong>ProtectKeyWithTPMAndStartupKey</strong></a></li>
</ul>
<p>Therefore, if the disk is encrypted and <em>ProtectionStatus</em> returns zero (PROTECTION OFF), keys are disabled.</p>
<p>Use <a href="getkeyprotectors-win32-encryptablevolume.html"><strong>GetKeyProtectors</strong></a> to list the key protectors that have been specified to secure the volume's encryption key. If key protectors exist but protection is zero (PROTECTION OFF), use <a href="enablekeyprotectors-win32-encryptablevolume.html"><strong>EnableKeyProtectors</strong></a> to turn on volume protection.</p>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista Enterprise, WindowsÂ Vista Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
