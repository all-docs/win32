<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DeleteKeyProtector method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Deletes a given key protector for the volume.
ms.assetid: fa6b89b0-83b6-4be2-8b7b-61b0501747d2
title: DeleteKeyProtector method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.DeleteKeyProtector
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>DeleteKeyProtector method of the Win32_EncryptableVolume class</h1>
<p>The <strong>DeleteKeyProtector</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class deletes a given key protector for the volume.</p>
<p>If an unencrypted volume has key protectors, when <strong>DeleteKeyProtector</strong> removes the last key protector, the volume reverts to a standard NTFS file system.</p>
<p>If a volume has never been encrypted, deleting the key protector will revert to NTFS.</p>
<p>If the volume is not yet fully decrypted, use <a href="disablekeyprotectors-win32-encryptablevolume.html"><strong>DisableKeyProtectors</strong></a> before removing the volume's last key protector to ensure that encrypted portions of the volume remain accessible.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 DeleteKeyProtector(
  [in]Â string VolumeKeyProtectorID
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>VolumeKeyProtectorID</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A unique string identifier used to manage an encrypted volume key protector.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>This method returns one of the following codes or another error code if it fails.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_LOCKED_VOLUME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694912 (0x80310000)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The volume is locked.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_NOT_ACTIVATED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694920 (0x80310008)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>BitLocker is not enabled on the volume. Add a key protector to enable BitLocker. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_INVALIDARG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2147942487 (0x80070057)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>VolumeKeyProtectorID</em> parameter does not refer to a valid key protector.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_KEY_REQUIRED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694941 (0x8031001D)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The last key protector for a partially or fully encrypted volume cannot be removed if key protectors are enabled. Use <a href="disablekeyprotectors-win32-encryptablevolume.html"><strong>DisableKeyProtectors</strong></a> before removing this last key protector to ensure that encrypted portions of the volume remain accessible. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_VOLUME_BOUND_ALREADY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694943 (0x8031001F)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>This key protector cannot be deleted because it is being used to automatically unlock the volume. <!-- raw HTML omitted --> Use <a href="disableautounlock-win32-encryptablevolume.html"><strong>DisableAutoUnlock</strong></a> to disable automatic unlocking before deleting this key protector.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista Enterprise, WindowsÂ Vista Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
