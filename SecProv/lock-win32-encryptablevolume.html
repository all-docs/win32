<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Lock method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Dismounts the volume and removes the volume's encryption key from system memory.
ms.assetid: '8d6e42a0-7b43-46d2-aa5e-941567ef2842'
title: Lock method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.Lock
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>Lock method of the Win32_EncryptableVolume class</h1>
<p>The <strong>Lock</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class dismounts the volume and removes the volume's encryption key from system memory. The contents of the volume remain inaccessible until it is unlocked by either the <a href="unlockwithexternalkey-win32-encryptablevolume.html"><strong>UnlockWithExternalKey</strong></a> method or the <a href="unlockwithnumericalpassword-win32-encryptablevolume.html"><strong>UnlockWithNumericalPassword</strong></a> method. This method cannot be successfully run for the currently running operating system volume.</p>
<blockquote>
<p>[!Note]<br />
If the disc supports hardware encryption, the band is set to &quot;locked&quot;.</p>
</blockquote>
<p>Â </p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 Lock(
  [in, optional]Â boolean ForceDismount
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>ForceDismount</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>boolean</strong></p>
<p>If <strong>true</strong> the disk is forcibly dismounted.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>This method returns one of the following codes or another error code if it fails.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_ACCESS_DENIED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2147942405 (0x80070005)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Applications are accessing this volume. If all access is nonexclusive, specifying the <em>ForceDismount</em> parameter as true allows the method to run successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_NOT_ENCRYPTED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694913 (0x80310001)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The volume is fully decrypted and cannot be locked.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_PROTECTION_DISABLED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694945 (0x80310021)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The volume's encryption key is available in the clear on the disk, preventing the volume from being locked.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_RECOVERY_KEY_REQUIRED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694946 (0x80310022)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The volume does not have key protectors of the type &quot;Numerical Password&quot; or &quot;External Key&quot; that are necessary to unlock the volume.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista Enterprise, WindowsÂ Vista Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
