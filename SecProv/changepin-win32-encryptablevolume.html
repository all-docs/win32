<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ChangePIN method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Changes the PIN associated with an encrypted volume.
ms.assetid: 8b0043cc-cf86-44e5-ab7c-038a6782f347
title: ChangePIN method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.ChangePIN
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>ChangePIN method of the Win32_EncryptableVolume class</h1>
<p>The <strong>ChangePIN</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class changes the PIN associated with an encrypted volume. If the &quot;Allow enhanced PINs for startup&quot; group policy is enabled, a PIN can contain letters, symbols, and spaces in addition to numbers.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 ChangePIN(
  [in]Â string VolumeKeyProtectorID,
  [in]Â string NewPIN
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>VolumeKeyProtectorID</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>The unique string identifier used to manage an encrypted volume key protector.</p>
<!-- raw HTML omitted -->
<p><em>NewPIN</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A user-specified personal identification string. This string must consist of a sequence of 4 to 20 digits or, if the &quot;Allow enhanced PINs for startup&quot; group policy is enabled, 4 to 20 letters, symbols, spaces, or numbers.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>This method returns one of the following codes or another error code if it fails.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_BOOTABLE_CDDVD</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694960 (0x80310030)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A bootable CD/DVD is found in this computer. Remove the CD/DVD and restart the computer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_INVALID_PIN_CHARS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150695066 (0x8031009A)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>NewPIN</em> parameter contains characters that are not valid. When the &quot;Allow enhanced PINs for startup&quot; Group Policy is disabled, only numbers are supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_INVALID_PROTECTOR_TYPE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694970 (0x8031003A)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>VolumeKeyProtectorID</em> parameter does not refer to a key protector of the type &quot;Numerical Password&quot; or &quot;External Key&quot;. Use either the <a href="protectkeywithnumericalpassword-win32-encryptablevolume.html"><strong>ProtectKeyWithNumericalPassword</strong></a> or <a href="protectkeywithexternalkey-win32-encryptablevolume.html"><strong>ProtectKeyWithExternalKey</strong></a> method to create a key protector of the appropriate type.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_LOCKED_VOLUME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694912 (0x80310000)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The volume is locked.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_NOT_ACTIVATED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694920 (0x80310008)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>BitLocker is not enabled on the volume. Add a key protector to enable BitLocker. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_POLICY_INVALID_PIN_LENGTH</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150695016 (0x80310068)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>NewPIN</em> parameter supplied is either longer than 20 characters, shorter than 4 characters, or shorter than the minimum length specified by Group Policy.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_PROTECTOR_NOT_FOUND</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694963 (0x80310033)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The provided key protector does not exist on the volume.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TBS_E_SERVICE_NOT_RUNNING</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150121480 (0x80284008)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>No compatible Trusted Platform Module (TPM) is found on this computer.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>The <strong>ChangePIN</strong> method creates a new TPM and PIN protector based on the existing protector information and the newly provided PIN. The new protector will have the same GUID. The <strong>ChangePIN</strong> method can also be called to change the PIN of any key protector that uses a PIN, for example, TPM and PIN or TPM with PIN and USB.</p>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 7 Enterprise, WindowsÂ 7 Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008Â R2 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
