<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SetPhysicalPresenceRequest method of the Win32_Tpm class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Requests a TPM operation that requires physical presence.
ms.assetid: e71eb6ab-b6ab-4586-8999-0a464f11047a
title: SetPhysicalPresenceRequest method of the Win32_Tpm class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_Tpm.SetPhysicalPresenceRequest
api_type:</li>
<li>COM
api_location:</li>
<li>Win32_tpm.dll</li>
</ul>
<hr />
<h1>SetPhysicalPresenceRequest method of the Win32_Tpm class</h1>
<p>The <strong>SetPhysicalPresenceRequest</strong> method of the <a href="win32-tpm.html"><strong>Win32_Tpm</strong></a> class requests a TPM operation that requires physical presence. After you have used this method to submit a request, apply the next step indicated in the <a href="getphysicalpresencetransition-win32-tpm.html"><strong>GetPhysicalPresenceTransition</strong></a> method. Finally, use the <a href="getphysicalpresenceresponse-win32-tpm.html"><strong>GetPhysicalPresenceResponse</strong></a> method to check whether the operation ran successfully. This method suspends BitLocker if calling could cause BitLocker recovery to be required. BitLocker would automatically resume once TPM has been provisioned.</p>
<p>These steps are necessary because physical presence operations can run only after the computer has detected the physically present user.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 SetPhysicalPresenceRequest(
  [in]Â uint32 Request
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Request</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>uint32</strong></p>
<p>An integer value that specifies the requested TPM operation that requires physical presence.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>No request.<!-- raw HTML omitted --> Use this value to clear a pending request.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Enable the TPM.<!-- raw HTML omitted --> This operation is reversed by operation 2.<!-- raw HTML omitted --> For more information, see the following related methods that do not involve physical presence: <a href="enable-win32-tpm.html"><strong>Enable</strong></a> and <a href="isenabled-win32-tpm.html"><strong>IsEnabled</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Disable the TPM.<!-- raw HTML omitted --> This operation is reversed by operation 1.<!-- raw HTML omitted --> For more information, see the following related method that does not involve physical presence: <a href="disable-win32-tpm.html"><strong>Disable</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->3<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Activate the TPM.<!-- raw HTML omitted --> This operation is reversed by operation 4.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->4<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Deactivate the TPM.<!-- raw HTML omitted --> This operation is reversed by operation 3.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->5<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Clear the TPM.<!-- raw HTML omitted --> This operation cannot be reversed.<!-- raw HTML omitted --> For more information, see the following related method that does not involve physical presence: <a href="clear-win32-tpm.html"><strong>Clear</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->6<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Enable and activate the TPM.<!-- raw HTML omitted --> This operation is reversed by operation 7.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->7<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Deactivate and disable the TPM.<!-- raw HTML omitted --> This operation is reversed by operation 6.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->8<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Allow the installation of a TPM owner.<!-- raw HTML omitted --> This operation is reversed by operation 9.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->9<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Prevent the installation of a TPM owner.<!-- raw HTML omitted --> This operation is reversed by operation 8. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->10<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Enable, activate, and allow the installation of a TPM owner.<!-- raw HTML omitted --> This operation is reversed by operation 11.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->11<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Deactivate, disable, and prevent the installation of a TPM owner.<!-- raw HTML omitted --> This operation is reversed by operation 10.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted -->12<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Deferred Physical PresenceunownedFieldUpgrade<!-- raw HTML omitted --> Physical presence setting has been updated.<!-- raw HTML omitted --> <strong>WindowsÂ 7, Windows ServerÂ 2008Â R2, WindowsÂ Vista and Windows ServerÂ 2008:</strong> This value is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->14<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Clear, enable, and activate the TPM.<!-- raw HTML omitted --> This operation cannot be reversed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->15<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>SetNoPPIProvision_False<!-- raw HTML omitted --> Sets the provision that you must be physically presence to set the TPM.<!-- raw HTML omitted --> This operation is reversed by operation 16.<!-- raw HTML omitted --> <strong>WindowsÂ 7, Windows ServerÂ 2008Â R2, WindowsÂ Vista and Windows ServerÂ 2008:</strong> This value is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->16<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>SetNoPPIProvision_True<!-- raw HTML omitted --> Sets the provision that you don't need to be physically presence to set the TPM.<!-- raw HTML omitted --> This operation is reversed by operation 15.<!-- raw HTML omitted --> <strong>WindowsÂ 7, Windows ServerÂ 2008Â R2, WindowsÂ Vista and Windows ServerÂ 2008:</strong> This value is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->17<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>SetNoPPIClear_False<!-- raw HTML omitted --> Sets the provision that you must be physically presence to clear the TPM.<!-- raw HTML omitted --> This operation is reversed by operation 18.<!-- raw HTML omitted --> <strong>WindowsÂ 7, Windows ServerÂ 2008Â R2, WindowsÂ Vista and Windows ServerÂ 2008:</strong> This value is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->18<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>SetNoPPIClear_True<!-- raw HTML omitted --> Sets the provision that you don't need to be physically presence to clear the TPM.<!-- raw HTML omitted --> This operation is reversed by operation 17.<!-- raw HTML omitted --> <strong>WindowsÂ 7, Windows ServerÂ 2008Â R2, WindowsÂ Vista and Windows ServerÂ 2008:</strong> This value is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->19<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>SetNoPPIMaintenance_False<!-- raw HTML omitted --> Sets the provision that you must be physically presence to maintain the TPM.<!-- raw HTML omitted --> This operation is reversed by operation 20.<!-- raw HTML omitted --> <strong>WindowsÂ 7, Windows ServerÂ 2008Â R2, WindowsÂ Vista and Windows ServerÂ 2008:</strong> This value is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->20<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>SetNoPPIMaintenance_True<!-- raw HTML omitted --> Sets the provision that you don't need to be physically presence to maintain the TPM.<!-- raw HTML omitted --> This operation is reversed by operation 19.<!-- raw HTML omitted --> <strong>WindowsÂ 7, Windows ServerÂ 2008Â R2, WindowsÂ Vista and Windows ServerÂ 2008:</strong> This value is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->21<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Enable + Activate + Clear<!-- raw HTML omitted --> Enable, activate, and clear the TPM.<!-- raw HTML omitted --> <strong>WindowsÂ 7, Windows ServerÂ 2008Â R2, WindowsÂ Vista and Windows ServerÂ 2008:</strong> This value is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->22<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Enable + Activate + Clear + Enable + Activate<!-- raw HTML omitted --> Enable, activate, and clear the TPM, and then enable and reactivate the TPM.<!-- raw HTML omitted --> <strong>WindowsÂ 7, Windows ServerÂ 2008Â R2, WindowsÂ Vista and Windows ServerÂ 2008:</strong> This value is not supported.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>All TPM errors as well as errors specific to TPM Base Services can be returned.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --> Use the <a href="getphysicalpresencetransition-win32-tpm.html"><strong>GetPhysicalPresenceTransition</strong></a> method to determine the next step that is needed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TPM_E_PPI_NOT_SUPPORTED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150171395 (0x80290303)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The computer does not support TPM physical presence operations by using this method.<!-- raw HTML omitted --> Consult your computer manufacturer for more information. Your computer's BIOS may have alternate support for configuring the TPM.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TPM_E_PPI_ACPI_FAILURE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150171392 (0x80290300)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A hardware failure occurred.<!-- raw HTML omitted --> Consult your computer manufacturer for more information.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>TPM physical presence operations do not require TPM owner authorization. However, they do require additional steps to help protect against unauthorized changes to the TPM.</p>
<p>Computers that support TPM physical presence operations will attempt to detect the physically present user before running the operation. While computers may differ in how this detection is performed, the idea is to have a physically present user or administrator authorize the operation.</p>
<p>For example, the computer may require the user to restart the computer. After the computer is restarted, the computer can display a BIOS confirmation dialog box that allows the user to confirm the operation by using the keyboard.</p>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftTpm<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_tpm.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_tpm.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-tpm.html"><strong>Win32_Tpm</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="enable-win32-tpm.html"><strong>Enable</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="isenabled-win32-tpm.html"><strong>IsEnabled</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="disable-win32-tpm.html"><strong>Disable</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="clear-win32-tpm.html"><strong>Clear</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
