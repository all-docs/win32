<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GetHardwareTestStatus method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Provides status information about a hardware test of a fully decrypted operating system volume.
ms.assetid: d76bc266-3718-443e-94f9-dcaa0ec53151
title: GetHardwareTestStatus method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.GetHardwareTestStatus
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>GetHardwareTestStatus method of the Win32_EncryptableVolume class</h1>
<p>The <strong>GetHardwareTestStatus</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class provides status information about a hardware test of a fully decrypted operating system volume.</p>
<p>Use this method to show whether a hardware test is pending, as well as the success or failure of a hardware test that completed on the last computer restart. To request a hardware test, use the <a href="encryptafterhardwaretest-win32-encryptablevolume.html"><strong>EncryptAfterHardwareTest</strong></a> method.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 GetHardwareTestStatus(
  [out]Â uint32 TestStatus,
  [out]Â uint32 TestError
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>TestStatus</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>uint32</strong></p>
<p>Specifies whether a hardware test is pending, as well as the success of failure of a hardware test that completed on the last computer restart.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->NotFailed_and_NonePending<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->0<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>If a test was requested, the test has succeeded on the last computer restart and volume encryption is now in progress. For the encryption status, see the <!-- raw HTML omitted --><!-- raw HTML omitted -->GetConversionStatus<!-- raw HTML omitted --><!-- raw HTML omitted --> method. Otherwise, no test ran on the last computer restart and none is pending. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Failed<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->1<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Volume encryption did not start. All key protectors were removed.<!-- raw HTML omitted --> To resolve a failed test:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Consult the information in the <!-- raw HTML omitted -->TestError<!-- raw HTML omitted --> parameter.<!-- raw HTML omitted --><!-- raw HTML omitted -->Add key protectors and use the <!-- raw HTML omitted --><!-- raw HTML omitted -->EncryptAfterHardwareTest<!-- raw HTML omitted --><!-- raw HTML omitted --> method again.<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Pending<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->2<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>A test has been requested and will run on the next computer restart.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>TestError</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>uint32</strong></p>
<p>Specifies the error from the last completed hardware test.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>No errors occurred or no hardware test ran on the last computer restart.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --> 2150694972 (0x8031003C)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>FVE_E_KEYFILE_NOT_FOUND<!-- raw HTML omitted --> A USB flash drive with an external key file was not found. If this failure persists, the computer cannot read USB drives during restart. You may not be able to use external keys to unlock the operating system volume during restart.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --> 2150694973 (0x8031003D)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>FVE_E_KEYFILE_INVALID<!-- raw HTML omitted --> The external key file on the USB flash drive was corrupt. Try a different USB flash drive to store the external key file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --> 2150694975 (0x8031003F)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>FVE_E_TPM_DISABLED<!-- raw HTML omitted --> The TPM is either disabled or deactivated or both disabled and deactivated. To turn on the TPM, use the <a href="win32-tpm.html"><strong>Win32_Tpm</strong></a> WMI provider or run the TPM management snap-in (Tpm.msc).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --> 2150694977 (0x80310041)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>FVE_E_TPM_INVALID_PCR<!-- raw HTML omitted --> The TPM detected a change in operating system restart services within the current platform validation profile. Remove any startup CD or DVD from the computer. If this failure persists, check that the latest firmware and BIOS upgrades are installed, and that the TPM is otherwise working properly.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694979 (0x80310043)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>FVE_E_PIN_INVALID<!-- raw HTML omitted --> The provided PIN was incorrect.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>The following table lists some of the common return codes.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method succeeded.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_LOCKED_VOLUME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694912 (0x80310000)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The volume is locked.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>To request a hardware test, use the <a href="encryptafterhardwaretest-win32-encryptablevolume.html"><strong>EncryptAfterHardwareTest</strong></a> method.</p>
<p>To run a hardware test when its status is pending, follow these steps:</p>
<ol>
<li>Insert into the computer a USB flash drive that contains an external key file. This step applies only if the volume has a key protector of type &quot;External Key&quot; or &quot;TPM And Startup Key&quot;.</li>
<li>Restart the computer. On computer restart, the hardware test runs automatically.</li>
</ol>
<p>To cancel the hardware test, use the <a href="encrypt-win32-encryptablevolume.html"><strong>Encrypt</strong></a> method.</p>
<p>A successful test determines that:</p>
<ul>
<li>The TPM can unlock the volume if a TPM-related key protector exists.</li>
<li>The computer can read a USB flash drive that contains an external key file during startup if the volume can be unlocked by an external key (including a startup key).</li>
</ul>
<p>Hardware test results will not be available after any changes in conversion or after the next computer restart. Check the System event log for the information about any hardware tests that previously ran on the computer.</p>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista Enterprise, WindowsÂ Vista Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
