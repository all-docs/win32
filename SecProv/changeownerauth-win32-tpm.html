<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ChangeOwnerAuth method of the Win32_Tpm class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Changes the TPM owner authorization value.
ms.assetid: ed280037-2360-4889-baba-cfa9e4fd473e
title: ChangeOwnerAuth method of the Win32_Tpm class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_Tpm.ChangeOwnerAuth
api_type:</li>
<li>COM
api_location:</li>
<li>Win32_tpm.dll</li>
</ul>
<hr />
<h1>ChangeOwnerAuth method of the Win32_Tpm class</h1>
<p>The <strong>ChangeOwnerAuth</strong> method of the <a href="win32-tpm.html"><strong>Win32_Tpm</strong></a> class changes the TPM owner authorization value.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 ChangeOwnerAuth(
  [in, optional]Â string OldOwnerAuth,
  [in, optional]Â string NewOwnerAuth
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>OldOwnerAuth</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A string that names the current TPM owner authorization value of the device. Use the <a href="converttoownerauth-win32-tpm.html"><strong>ConvertToOwnerAuth</strong></a> method to translate a password to this authorization value. The <em>OldOwnerAuth</em> parameter is not supplied or an empty string is provided, this method gets the value from the registry if present.</p>
<!-- raw HTML omitted -->
<p><em>NewOwnerAuth</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>A string that names the new TPM owner authorization value. Use the <a href="converttoownerauth-win32-tpm.html"><strong>ConvertToOwnerAuth</strong></a> method to translate a password to this authorization value. The <em>NewOwnerAuth</em> parameter cannot be empty or <strong>NULL.</strong></p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>All TPM errors as well as errors specific to TPM Base Services can be returned.</p>
<p>The following table lists some of the common return codes.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TPM_E_AUTHFAIL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150105089 (0x80280001)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The current TPM owner authorization value is incorrect.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TPM_E_DEFEND_LOCK_RUNNING</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150107139 (0x80280803)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The TPM is defending against dictionary attacks and is in a time-out period. For more information, see the <a href="resetauthlockout-win32-tpm.html"><strong>ResetAuthLockOut</strong></a> method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_AD_SCHEMA_NOT_INSTALLED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694922 (0x8031000A)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Cannot save recovery information to the network. The computer has been configured to store recovery information to Active Directory Domain Services. For instructions on how to set up Active Directory, see <a href="/previous-versions/windows/it-pro/windows-vista/cc766015(v=ws.10)">BitLocker Drive Encryption Configuration Guide: Backing Up BitLocker and TPM Recovery Information to Active Directory</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Connection Failed</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2147943755 (0x8007054B)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Cannot save recovery information to the network. The computer has been configured to store recovery information to Active Directory Domain Services. A network connection is required to continue.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>The <strong>ChangeOwnerAuth</strong> method backs up the new TPM owner authorization to Active Directory Domain Services if the appropriate Group Policy settings have been configured.</p>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftTpm<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_tpm.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_tpm.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-tpm.html"><strong>Win32_Tpm</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
