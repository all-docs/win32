<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EnableKeyProtectors method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Enables or resumes all disabled or suspended key protectors.
ms.assetid: 6f5a17a3-84f2-43a0-a85f-1037cd52439a
title: EnableKeyProtectors method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.EnableKeyProtectors
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>EnableKeyProtectors method of the Win32_EncryptableVolume class</h1>
<p>The <strong>EnableKeyProtectors</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class enables or resumes all disabled or suspended key protectors. You can use this method to reenable or resume BitLocker protection on an encrypted volume. This method ensures that the volume's encryption key is not exposed in the clear on the hard disk.</p>
<blockquote>
<p>[!Note]<br />
If the disc supports hardware encryption, the band state transitions to &quot;unlocked&quot; from &quot;always unlocked&quot;.</p>
</blockquote>
<p>Â </p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 EnableKeyProtectors();
</code></pre>
<h2>Parameters</h2>
<p>This method has no parameters.</p>
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>This method returns one of the following codes or another error code if it fails.</p>
<p>If key protectors are already enabled and no other errors occur, this method returns zero.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->S_OK<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->FVE_E_SECURE_KEY_REQUIRED<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->2150694919 (0x80310007)<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>No key protectors exist on the volume. Use one of the following methods to specify key protectors for the volume:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithCertificateFile<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithCertificateThumbprint<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithExternalKey<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithNumericalPassword<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithPassphrase<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithTPM<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithTPMAndPIN<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithTPMAndPINAndStartupKey<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ProtectKeyWithTPMAndStartupKey<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->FVE_E_NOT_ACTIVATED<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->2150694920 (0x80310008)<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>BitLocker is not enabled on the volume. Add a key protector to enable BitLocker. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>If the volume is fully encrypted, successfully running this method ensures that the volume is protected. If the volume is partially encrypted, successfully running this method implies that the volume will be protected when it becomes fully encrypted. For more information, see the <a href="getprotectionstatus-win32-encryptablevolume.html"><strong>GetProtectionStatus</strong></a> method.</p>
<p>If TPM-based key protectors exist for the volume, successfully running this method also refreshes these protectors so that the TPM validates against the current startup services on the platform. In other words, you are asserting that the current computer state is the correct state that the TPM will check against on future computer restarts.</p>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista Enterprise, WindowsÂ Vista Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="disablekeyprotectors-win32-encryptablevolume.html"><strong>DisableKeyProtectors</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="protectkeywithcertificatefile-win32-encryptablevolume.html"><strong>ProtectKeyWithCertificateFile</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="protectkeywithcertificatethumbprint-win32-encryptablevolume.html"><strong>ProtectKeyWithCertificateThumbprint</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="protectkeywithexternalkey-win32-encryptablevolume.html"><strong>ProtectKeyWithExternalKey</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="protectkeywithnumericalpassword-win32-encryptablevolume.html"><strong>ProtectKeyWithNumericalPassword</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="protectkeywithpassphrase-win32-encryptablevolume.html"><strong>ProtectKeyWithPassphrase</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="protectkeywithtpm-win32-encryptablevolume.html"><strong>ProtectKeyWithTPM</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="protectkeywithtpmandpin-win32-encryptablevolume.html"><strong>ProtectKeyWithTPMAndPIN</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="protectkeywithtpmandpinandstartupkey-win32-encryptablevolume.html"><strong>ProtectKeyWithTPMAndPINAndStartupKey</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="protectkeywithtpmandstartupkey-win32-encryptablevolume.html"><strong>ProtectKeyWithTPMAndStartupKey</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
