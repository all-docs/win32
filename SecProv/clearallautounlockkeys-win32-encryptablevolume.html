<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ClearAllAutoUnlockKeys method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Removes all external keys and related information saved onto the currently running operating system volume that are used to automatically unlock data volumes.
ms.assetid: a5fef793-0634-493d-b62d-cb842844b1e8
title: ClearAllAutoUnlockKeys method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.ClearAllAutoUnlockKeys
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>ClearAllAutoUnlockKeys method of the Win32_EncryptableVolume class</h1>
<p>The <strong>ClearAllAutoUnlockKeys</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class removes all external keys and related information saved onto the currently running operating system volume that are used to automatically unlock data volumes.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 ClearAllAutoUnlockKeys();
</code></pre>
<h2>Parameters</h2>
<p>This method has no parameters.</p>
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>This method returns one of the following codes or another error code if it fails.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_NOT_ACTIVATED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694920 (0x80310008)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>BitLocker is not enabled on the volume. Add a key protector to enable BitLocker. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FVE_E_NOT_OS_VOLUME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2150694952 (0x80310028)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method can only be run for the currently running operating system volume.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p><strong>ClearAllAutoUnlockKeys</strong> achieves the same functionality as running <a href="disableautounlock-win32-encryptablevolume.html"><strong>DisableAutoUnlock</strong></a> for every data volume that has ever been associated with the currently running operating system, even data volumes that are not currently connected to the computer. It also removes any stale unlocking information associated with data volumes that no longer exist.</p>
<p>Before calling <a href="decrypt-win32-encryptablevolume.html"><strong>Decrypt</strong></a> on the currently running operating system volume, use <strong>ClearAllAutoUnlockKeys</strong> to ensure that information placed in the operating system registry to automatically unlock data volumes is not accessible in the clear on disk.</p>
<p>After <strong>ClearAllAutoUnlockKeys</strong> runs successfully, the methods <a href="unlockwithexternalkey-win32-encryptablevolume.html"><strong>UnlockWithExternalKey</strong></a> or <a href="unlockwithnumericalpassword-win32-encryptablevolume.html"><strong>UnlockWithNumericalPassword</strong></a> can be used to unlock all data volumes on this computer. Use <a href="enableautounlock-win32-encryptablevolume.html"><strong>EnableAutoUnlock</strong></a> to re-enable automatic unlocking of a data volume.</p>
<p>If no other errors are returned, <strong>ClearAllAutoUnlockKeys</strong> removes from the registry any volume protector IDs and external keys used to automatically unlock any data volume that has ever been associated with the currently running operating system volume.</p>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista Enterprise, WindowsÂ Vista Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
