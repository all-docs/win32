<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GetLockStatus method of the Win32_EncryptableVolume class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Indicates whether the contents of the volume are accessible from Windows.
ms.assetid: 54b2a41b-11c6-40ec-97fa-74996c15554e
title: GetLockStatus method of the Win32_EncryptableVolume class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_EncryptableVolume.GetLockStatus
api_type:</li>
<li>COM
api_location:</li>
<li>Root\CIMV2\Security\MicrosoftVolumeEncryption</li>
</ul>
<hr />
<h1>GetLockStatus method of the Win32_EncryptableVolume class</h1>
<p>The <strong>GetLockStatus</strong> method of the <a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a> class indicates whether the contents of the volume are accessible from Windows.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 GetLockStatus(
  [out]Â uint32 LockStatus
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>LockStatus</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>uint32</strong></p>
<p>Specifies whether the contents of the volume are accessible from Windows.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Unlocked</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>For a standard HDD:<!-- raw HTML omitted --> The full contents of the volume are accessible. An unlocked volume is either fully decrypted or has the encryption key available in the clear on disk. The volume containing the current running operating system (for example, the running Windows volume) is always accessible and cannot be locked.<!-- raw HTML omitted --> For an EHDD:<!-- raw HTML omitted --> The band is perpetually unlocked.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Locked</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>For a standard HDD:<!-- raw HTML omitted --> All or a portion of the contents of the volume are not accessible. A locked volume must be partially or fully encrypted and must not have the encryption key available in the clear on disk.<!-- raw HTML omitted --> For an EHDD:<!-- raw HTML omitted --> The band is unlocked or locked.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<p>This method returns one of the following codes or another error code if it fails.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0 (0x0)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method was successful.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>Use the <a href="unlockwithexternalkey-win32-encryptablevolume.html"><strong>UnlockWithExternalKey</strong></a> and <a href="unlockwithnumericalpassword-win32-encryptablevolume.html"><strong>UnlockWithNumericalPassword</strong></a> to get access to the volume contents. Use the <a href="lock-win32-encryptablevolume.html"><strong>Lock</strong></a> method to relinquish access to volume contents.</p>
<p>The volume that contains the currently running operating system is always accessible and cannot be locked.</p>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Windows SDK. They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="../wmisdk/managed-object-format--mof-.html">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista Enterprise, WindowsÂ Vista Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2\Security\MicrosoftVolumeEncryption<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Win32_encryptablevolume.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-encryptablevolume.html"><strong>Win32_EncryptableVolume</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
