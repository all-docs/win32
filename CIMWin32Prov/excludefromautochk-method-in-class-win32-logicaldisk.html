<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ExcludeFromAutochk method of the Win32_LogicalDisk class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Excludes disks from the autochk operation to be run at the next reboot.
ms.assetid: 5df2bc3b-e149-4853-aa02-af4cb8af6da0
ms.tgt_platform: multiple
title: ExcludeFromAutochk method of the Win32_LogicalDisk class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_LogicalDisk.ExcludeFromAutochk
api_type:</li>
<li>COM
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>ExcludeFromAutochk method of the Win32_LogicalDisk class</h1>
<p>The <strong>ExcludeFromAutochk</strong> method excludes disks from the <strong>autochk</strong> operation to be run at the next reboot.</p>
<p>This topic uses Managed Object Format (MOF) syntax. For more information about using this method, see <a href="/windows/desktop/WmiSdk/calling-a-method">Calling a Method</a>.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 ExcludeFromAutochk(
  [in] string LogicalDisk[]
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>LogicalDisk</em> [in]</p>
<!-- raw HTML omitted -->
<p>List of drives that should be excluded from <strong>autochk</strong> at the next reboot. The string syntax consists of the drive letter followed by a colon for the logical disk.</p>
<p>Example: &quot;C:&quot;</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns a value of 0 (zero) when no error occurs. Values are listed in the following list. For additional error codes, see <a href="/windows/desktop/WmiSdk/wmi-error-constants"><strong>WMI Error Constants</strong></a> or <a href="/windows/desktop/api/wbemdisp/ne-wbemdisp-wbemerrorenum"><strong>WbemErrorEnum</strong></a>. For general <strong>HRESULT</strong> values, see <a href="/windows/desktop/Debug/system-error-codes">System Error Codes</a>.</p>
<!-- raw HTML omitted -->
<p><strong>Success</strong> (0)</p>
<!-- raw HTML omitted -->
<p><strong>Error - Remote Drive</strong> (1)</p>
<!-- raw HTML omitted -->
<p><strong>Error - Removable Drive</strong> (2)</p>
<!-- raw HTML omitted -->
<p><strong>Error - Drive Not Root Directory</strong> (3)</p>
<!-- raw HTML omitted -->
<p><strong>Error - Unknown Drive</strong> (4)</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>If not excluded, <strong>autochk</strong> is performed on the disk when the dirty bit is set for the disk. Note that the calls to exclude disks are not cumulative. If a call is made to exclude some disks, then the new list is not added to the list of disks that are already marked for exclusion. The new list of disks overwrites the previous list. This method is only applicable to those instances of logical disk that represent a physical disk in the machine. It is not applicable to mapped logical drives.</p>
<h2>Examples</h2>
<p>The following VBScript code sample ensures that Autochk.exe will not run against drive C the next time the computer reboots, even if the &quot;dirty bit&quot; has been set on drive C.</p>
<pre lang="VB"><code>strComputer = &quot;.&quot; 
Set objWMIService = GetObject(&quot;winmgmts:&quot; _ 
    &amp; &quot;{impersonationLevel=impersonate}!\\&quot; &amp; strComputer &amp; &quot;\root\cimv2&quot;) 
 
Set objDisk = objWMIService.Get(&quot;Win32_LogicalDisk&quot;) 
 
errReturn = objDisk.ExcludeFromAutoChk(Array(&quot;C:&quot;)) 
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-logicaldisk.html"><strong>Win32_LogicalDisk</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="computer-system-hardware-classes.html">Computer System Hardware Classes</a></p>
<!-- raw HTML omitted -->
</body>
