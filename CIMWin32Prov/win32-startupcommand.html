<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Win32_StartupCommand class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The Win32_StartupCommand&amp;#8194;WMI class represents a command that runs automatically when a user logs onto the computer system.
ms.assetid: 7184ade8-fcc9-47b3-af04-8054b2fca937
ms.tgt_platform: multiple
title: Win32_StartupCommand class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_StartupCommand</li>
<li>Win32_StartupCommand.Caption</li>
<li>Win32_StartupCommand.Description</li>
<li>Win32_StartupCommand.SettingID</li>
<li>Win32_StartupCommand.Command</li>
<li>Win32_StartupCommand.Location</li>
<li>Win32_StartupCommand.Name</li>
<li>Win32_StartupCommand.User</li>
<li>Win32_StartupCommand.UserSID
api_type:</li>
<li>DllExport
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>Win32_StartupCommand class</h1>
<p>The <strong>Win32_StartupCommand</strong>â€‚<a href="../wmisdk/retrieving-a-class.html">WMI class</a> represents a command that runs automatically when a user logs onto the computer system.</p>
<p>The following syntax is simplified from Managed Object Format (MOF) code and includes all of the inherited properties. Properties and methods are in alphabetic order, not MOF order.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[Dynamic, Provider(&quot;CIMWin32&quot;), Privileges(&quot;SeRestorePrivilege&quot;), UUID(&quot;{8502C50A-5FBB-11D2-AAC1-006008C78BC7}&quot;), AMENDMENT]
class Win32_StartupCommand : CIM_Setting
{
  string Caption;
  string Description;
  string SettingID;
  string Command;
  string Location;
  string Name;
  string User;
  string UserSID;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>Win32_StartupCommand</strong> class has these types of members:</p>
<ul>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Properties</h3>
<p>The <strong>Win32_StartupCommand</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>Caption</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>MaxLen</strong></a> (64)</p>
<!-- raw HTML omitted -->
<p>Short textual description of the current object.</p>
<p>This property is inherited from <a href="cim-setting.html"><strong>CIM_Setting</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>Command</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/key-qualifier.html"><strong>key</strong></a>, <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;Win32Registry|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run&quot;)</p>
<!-- raw HTML omitted -->
<p>Command run by the startup command.</p>
<p>WMI obtains this data from the registry key</p>
<p><strong>HKEY_LOCAL_MACHINE</strong>\<strong>SOFTWARE</strong>\<strong>Microsoft</strong>\<strong>Windows</strong>\<strong>CurrentVersion</strong>\<strong>Run</strong></p>
<p>Example: &quot;C:\Windows\notepad.exe myfile.txt&quot;</p>
<!-- raw HTML omitted -->
<p><strong>Description</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Textual description of the current object.</p>
<p>This property is inherited from <a href="cim-setting.html"><strong>CIM_Setting</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>Location</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/key-qualifier.html"><strong>key</strong></a>, <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;Win32Registry|\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\Windows&quot;)</p>
<!-- raw HTML omitted -->
<p>Path where the startup command resides on the disk file system.</p>
<p>For example: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Startup</strong> (&quot;Startup&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Common Startup</strong> (&quot;Common Startup&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</strong> (&quot;HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunServices</strong> (&quot;HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunServices&quot;)</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>Name</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/key-qualifier.html"><strong>key</strong></a>, <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;Win32API|File Structures|<a href="/windows/win32/api/minwinbase/ns-minwinbase-win32_find_dataa"><strong>WIN32_FIND_DATA</strong></a>|cFileName&quot;)</p>
<!-- raw HTML omitted -->
<p>File name of the startup command.</p>
<p>Example: &quot;FindFast&quot;</p>
<!-- raw HTML omitted -->
<p><strong>SettingID</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>MaxLen</strong></a> (256)</p>
<!-- raw HTML omitted -->
<p>Identifier by which the current object is known.</p>
<p>This property is inherited from <a href="cim-setting.html"><strong>CIM_Setting</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>User</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/key-qualifier.html"><strong>key</strong></a>, <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;WMI&quot;)</p>
<!-- raw HTML omitted -->
<p>User name for whom this startup command will run.</p>
<p>Example: &quot;mydomain\myname&quot;</p>
<!-- raw HTML omitted -->
<p><strong>UserSID</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;WMI&quot;)</p>
<!-- raw HTML omitted -->
<p>The UserSID property indicates the SID of the user for whom this startup command will run. That User property may be empty but UserSID still has a value if the user name can't be resolved (like in the case of a deleted user). The property is helpful to distinguish between commands associated w/ two different users with unresolved names. It may be NULL when the command is associated with items not actually identifying a user like All Users.</p>
<p>Example:S-1-5-21-1579938362-1064596589-3161144252-1006</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The <strong>Win32_StartupCommand</strong> class is derived from <a href="cim-setting.html"><strong>CIM_Setting</strong></a>.</p>
<p>Computer startup does not end after the operating system has been loaded. Instead, the Windows operating system can be configured so that startup commands are run each time Windows starts. Startup commands are stored in the registry or as part of the user profile and are used to automatically start specified scripts or applications each time Windows is loaded.</p>
<p>In most cases, autostart programs are useful; they ensure that certain applications, such as antivirus tools, are automatically started and run each time Windows is loaded. However, autostart programs also can be responsible for problems such as:</p>
<ul>
<li>Computers that take an exceptionally long time to start. This might be the result of a large number of applications that must be started each time Windows starts.</li>
<li>Applications that are represented in the Taskbar or in Task Manager, even though the user did not start them. Although these applications do not necessarily cause problems, they can result in help desk calls from users who are confused as to where these programs came from and why they are running.</li>
<li>Computers experiencing problems even when they seem idle. These problems are often traced to startup commands that are running when no one is aware that they are running.</li>
</ul>
<p>Identifying the applications and scripts that automatically run at startup is an important but difficult administrative task, because startup commands can be stored in many different locations:</p>
<ul>
<li>HKLM\Software\Microsoft\Windows\CurrentVersion\Run</li>
<li>HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce</li>
<li>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</li>
<li>HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce</li>
<li>HKU\ProgID\Software\Microsoft\Windows\CurrentVersion\Run</li>
<li>systemdrive\Documents and Settings\All Users\Start Menu\Programs\Startup</li>
<li>systemdrive\Documents and Settings\username\Start Menu\Programs\Startup</li>
</ul>
<p>You can use the WMI Win32_StartupCommand class to enumerate autostart programs regardless of where the information is stored.</p>
<p>The calling process that uses this class must have the <strong>SE_RESTORE_NAME</strong> privilege on the computer in which the registry resides. For example, if you enumerate this class on the local computer, the account under which your application runs must have this privilege. For more information, see <a href="../wmisdk/executing-privileged-operations.html">Executing Privileged Operations</a>.</p>
<p>You can change the registry values where <strong>Win32_StartupCommand</strong> obtains data by calling the WMI <a href="/previous-versions/windows/desktop/regprov/system-registry-provider">System Registry Provider</a> methods in script or in C++. For more information, see <a href="../wmisdk/modifying-the-system-registry.html">Modifying the System Registry</a>.</p>
<h2>Examples</h2>
<p>The following VBScript enumerates the startup commands on a computer.</p>
<pre lang="VB"><code>strComputer = &quot;.&quot;
Set objWMIService = GetObject(&quot;winmgmts:&quot; _
 &amp; &quot;{impersonationLevel=impersonate}!\\&quot; &amp; strComputer &amp; &quot;\root\cimv2&quot;)
Set colStartupCommands = objWMIService.ExecQuery _
 (&quot;SELECT * FROM Win32_StartupCommand&quot;)
For Each objStartupCommand in colStartupCommands
 Wscript.Echo &quot;Command: &quot; &amp; objStartupCommand.Command
 Wscript.Echo &quot;Description: &quot; &amp; objStartupCommand.Description
 Wscript.Echo &quot;Location: &quot; &amp; objStartupCommand.Location
 Wscript.Echo &quot;Name: &quot; &amp; objStartupCommand.Name
 Wscript.Echo &quot;SettingID: &quot; &amp; objStartupCommand.SettingID
 Wscript.Echo &quot;User: &quot; &amp; objStartupCommand.User
Next
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cim-setting.html"><strong>CIM_Setting</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="./operating-system-classes.html">Operating System Classes</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
