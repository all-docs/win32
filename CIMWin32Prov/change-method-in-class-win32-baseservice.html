<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Change method of the Win32_BaseService class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Modifies a service object derived from Win32_BaseService.
ms.assetid: d5f4f472-e7d9-4664-9430-9c77034a5978
ms.tgt_platform: multiple
title: Change method of the Win32_BaseService class (Mbnapi.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_BaseService.Change
api_type:</li>
<li>COM
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>Change method of the Win32_BaseService class</h1>
<p>The <strong>Change</strong> <a href="/windows/desktop/WmiSdk/retrieving-a-class">WMI class</a> method modifies a service object derived from <a href="win32-baseservice.html"><strong>Win32_BaseService</strong></a>. The <a href="win32-loadordergroup.html"><strong>Win32_LoadOrderGroup</strong></a> parameter represents a group of system services that define execution dependencies. The services must be initiated in the order specified by the Load Order Group, because the services depend on each other. These dependent services require antecedent services to function correctly.</p>
<p>This topic uses Managed Object Format (MOF) syntax. For more information about using this method, see <a href="/windows/desktop/WmiSdk/calling-a-method">Calling a Method</a>.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 Change(
  [in] string  DisplayName,
  [in] string  PathName,
  [in] uint8   ServiceType,
  [in] uint8   ErrorControl,
  [in] string  StartMode,
  [in] boolean DesktopInteract,
  [in] string  StartName,
  [in] string  StartPassword,
  [in] string  LoadOrderGroup,
  [in] string  LoadOrderGroupDependencies[],
  [in] string  ServiceDependencies[]
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>DisplayName</em> [in]</p>
<!-- raw HTML omitted -->
<p>The display name for a service. This string has a maximum length of 256 characters. The name is case preserved in the service control manager. <em>DisplayName</em> comparisons are always case insensitive.</p>
<p>Constraints: Accepts the same value as the <em>Name</em> parameter.</p>
<p>Example: &quot;Atdisk&quot;.</p>
<!-- raw HTML omitted -->
<p><em>PathName</em> [in]</p>
<!-- raw HTML omitted -->
<p>The fully qualified path to the executable file that implements a service.</p>
<p>Example: &quot;\SystemRoot\System32\drivers\afd.sys&quot;.</p>
<!-- raw HTML omitted -->
<p><em>ServiceType</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type of services provided to processes that call them.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Kernel Driver</strong> (1)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>File System Driver</strong> (2)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Adapter</strong> (4)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Recognizer Driver</strong> (8)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Own Process</strong> (16)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Share Process</strong> (32)</p>
<!-- raw HTML omitted -->
<p>(256)</p>
<!-- raw HTML omitted -->
<p>Interactive Process</p>
<!-- raw HTML omitted -->
<p><em>ErrorControl</em> [in]</p>
<!-- raw HTML omitted -->
<p>Severity of an error if this service does not start during startup. The value indicates the action that the startup program takes if failure occurs. The system logs all errors.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Ignore</strong> (0)</p>
<!-- raw HTML omitted -->
<p>User is not notified.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Normal</strong> (1)</p>
<!-- raw HTML omitted -->
<p>Normal. User is notified.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Severe</strong> (2)</p>
<!-- raw HTML omitted -->
<p>System is restarted with the last good configuration.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Critical</strong> (3)</p>
<!-- raw HTML omitted -->
<p>System attempts to restart with a good configuration.</p>
<!-- raw HTML omitted -->
<p><em>StartMode</em> [in]</p>
<!-- raw HTML omitted -->
<p>Start mode of the Windows base service.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Boot Start</strong> (&quot;Boot&quot;)</p>
<!-- raw HTML omitted -->
<p>Device driver that the operating system loader starts.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>System Start</strong> (&quot;System&quot;)</p>
<!-- raw HTML omitted -->
<p>Device driver started by the operating system initialization process. This value is valid only for driver services.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Auto Start</strong> (&quot;Automatic&quot;)</p>
<!-- raw HTML omitted -->
<p>Service to start automatically by the service control manager during system startup.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Demand Start</strong> (&quot;Manual&quot;)</p>
<!-- raw HTML omitted -->
<p>Service to start by the service control manager when a process calls the <a href="startservice-method-in-class-win32-baseservice.html"><strong>StartService</strong></a> method.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Disabled</strong> (&quot;Disabled&quot;)</p>
<!-- raw HTML omitted -->
<p>Service that cannot be started.</p>
<!-- raw HTML omitted -->
<p><em>DesktopInteract</em> [in]</p>
<!-- raw HTML omitted -->
<p>If <strong>True</strong>, the service can create or communicate with a window on the desktop.</p>
<!-- raw HTML omitted -->
<p><em>StartName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Account name that the service runs under, which depends on the service type. The account name may be in the form of DomainName\Username or .\Username. When it runs, the service process is logged by using one of the previous two forms. If the account belongs to the built-in domain, .\Username can be specified. If an empty string is specified, the service is logged on as the LocalSystem account. For kernel or system-level drivers, <em>StartName</em> contains the driver object name, for example, \FileSystem\Rdr or \Driver\Xns, which the input and output (I/O) system uses to load the device driver. If <strong>NULL</strong> is specified, the driver runs with a default object name that the I/O system creates based on the service name, for example, DWDOM\Admin.</p>
<p>You also can use the User Principal Name (UPN) format to specify the <strong>StartName</strong>, for example, <em>Username@DomainName</em>.</p>
<!-- raw HTML omitted -->
<p><em>StartPassword</em> [in]</p>
<!-- raw HTML omitted -->
<p>Password to the account name that the <em>StartName</em> parameter specifies. Specify <strong>NULL</strong> when you do not change the password. Specify an empty string if the service does not have a password.</p>
<blockquote>
<p>[!Note]<br />
When you change a service from local system to network or from network to local system, <em>StartPassword</em> must be an empty string (&quot;&quot;) and not <strong>NULL</strong>.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><em>LoadOrderGroup</em> [in]</p>
<!-- raw HTML omitted -->
<p>Group name that it is associated with. Load order groups are contained in the system registry, and determine the sequence that services are loaded into an operating system. If the pointer is <strong>NULL</strong>, or points to an empty string, the service does not belong to a group. Dependencies between groups should be listed in the <em>LoadOrderGroupDependencies</em> parameter. Services in the load-ordering group list are started first, followed by services in groups not in the load-ordering group list, followed by services that do not belong to a group. The system registry has a list of load ordering groups located at <strong>HKEY_LOCAL_MACHINE</strong>\<strong>System</strong>\<strong>CurrentControlSet</strong>\<strong>Control</strong>\<strong>ServiceGroupOrder</strong>.</p>
<!-- raw HTML omitted -->
<p><em>LoadOrderGroupDependencies</em> [in]</p>
<!-- raw HTML omitted -->
<p>List of load-ordering groups that must start before this service starts. The array is doubly <strong>null</strong>-terminated. If the pointer is <strong>NULL</strong>, or if it points to an empty string, the service does not have dependencies. Group names must be prefixed by the <strong>SC_GROUP_IDENTIFIER</strong> (defined in the Winsvc.h file) character to differentiate them from service names, because services and service groups share the same namespace. Dependency on a group means that this service can run if at least one member of the group is running after an attempt to start all of the members of the group.</p>
<!-- raw HTML omitted -->
<p><em>ServiceDependencies</em> [in]</p>
<!-- raw HTML omitted -->
<p>List that contains the names of services that must start before this service starts. The array is doubly <strong>null</strong>-terminated. If the pointer is <strong>NULL</strong>, or points to an empty string, the service does not have dependencies. Dependency on a service means that this service can run only if the service it depends on is running.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns one of the values listed in the following list, or a different value to indicate an error.</p>
<!-- raw HTML omitted -->
<p><strong>Success</strong></p>
<!-- raw HTML omitted -->
<p>0</p>
<p>The request is accepted.</p>
<!-- raw HTML omitted -->
<p><strong>Not Supported</strong></p>
<!-- raw HTML omitted -->
<p>1</p>
<p>The request is not supported.</p>
<!-- raw HTML omitted -->
<p><strong>Access Denied</strong></p>
<!-- raw HTML omitted -->
<p>2</p>
<p>The user does not have the necessary access privileges.</p>
<!-- raw HTML omitted -->
<p><strong>Dependent Services Running</strong></p>
<!-- raw HTML omitted -->
<p>3</p>
<p>The service cannot be stopped because other services that are running are dependent on it.</p>
<!-- raw HTML omitted -->
<p><strong>Invalid Service Control</strong></p>
<!-- raw HTML omitted -->
<p>4</p>
<p>The requested control code is not valid, or is unacceptable to the service.</p>
<!-- raw HTML omitted -->
<p><strong>Service Cannot Accept Control</strong></p>
<!-- raw HTML omitted -->
<p>5</p>
<p>The requested control code cannot be sent to the service because the <a href="win32-baseservice.html"><strong>State</strong></a> property in the <a href="win32-baseservice.html"><strong>Win32_BaseService</strong></a> object is equal to 0, 1, or 2.</p>
<!-- raw HTML omitted -->
<p><strong>Service Not Active</strong></p>
<!-- raw HTML omitted -->
<p>6</p>
<p>The service has not been started.</p>
<!-- raw HTML omitted -->
<p><strong>Service Request Timeout</strong></p>
<!-- raw HTML omitted -->
<p>7</p>
<p>The service does not respond to the start request quickly.</p>
<!-- raw HTML omitted -->
<p><strong>Unknown Failure</strong></p>
<!-- raw HTML omitted -->
<p>8</p>
<p>Interactive process.</p>
<!-- raw HTML omitted -->
<p><strong>Path Not Found</strong></p>
<!-- raw HTML omitted -->
<p>9</p>
<p>The directory path to the service executable file is not found.</p>
<!-- raw HTML omitted -->
<p><strong>Service Already Running</strong></p>
<!-- raw HTML omitted -->
<p>10</p>
<p>The service is already running.</p>
<!-- raw HTML omitted -->
<p><strong>Service Database Locked</strong></p>
<!-- raw HTML omitted -->
<p>11</p>
<p>The database to add a new service is locked.</p>
<!-- raw HTML omitted -->
<p><strong>Service Dependency Deleted</strong></p>
<!-- raw HTML omitted -->
<p>12</p>
<p>A dependency for which this service relies on is removed from the system.</p>
<!-- raw HTML omitted -->
<p><strong>Service Dependency Failure</strong></p>
<!-- raw HTML omitted -->
<p>13</p>
<p>The service does not find the service needed from a dependent service.</p>
<!-- raw HTML omitted -->
<p><strong>Service Disabled</strong></p>
<!-- raw HTML omitted -->
<p>14</p>
<p>The service is disabled from the system.</p>
<!-- raw HTML omitted -->
<p><strong>Service Logon Failed</strong></p>
<!-- raw HTML omitted -->
<p>15</p>
<p>The service does not have the correct authentication to run on the system.</p>
<!-- raw HTML omitted -->
<p><strong>Service Marked For Deletion</strong></p>
<!-- raw HTML omitted -->
<p>16</p>
<p>This service is being removed from the system.</p>
<!-- raw HTML omitted -->
<p><strong>Service No Thread</strong></p>
<!-- raw HTML omitted -->
<p>17</p>
<p>There is no execution thread for the service.</p>
<!-- raw HTML omitted -->
<p><strong>Status Circular Dependency</strong></p>
<!-- raw HTML omitted -->
<p>18</p>
<p>There are circular dependencies when starting the service.</p>
<!-- raw HTML omitted -->
<p><strong>Status Duplicate Name</strong></p>
<!-- raw HTML omitted -->
<p>19</p>
<p>There is a service running under the same name.</p>
<!-- raw HTML omitted -->
<p><strong>Status Invalid Name</strong></p>
<!-- raw HTML omitted -->
<p>20</p>
<p>There are invalid characters in the name of the service.</p>
<!-- raw HTML omitted -->
<p><strong>Status Invalid Parameter</strong></p>
<!-- raw HTML omitted -->
<p>21</p>
<p>Invalid parameters have been passed to the service.</p>
<!-- raw HTML omitted -->
<p><strong>Status Invalid Service Account</strong></p>
<!-- raw HTML omitted -->
<p>22</p>
<p>The account for this service to run under is not valid or does not have the permissions to run the service.</p>
<!-- raw HTML omitted -->
<p><strong>Status Service Exists</strong></p>
<!-- raw HTML omitted -->
<p>23</p>
<p>The service exists in the database of services available from the system.</p>
<!-- raw HTML omitted -->
<p><strong>Service Already Paused</strong></p>
<!-- raw HTML omitted -->
<p>24</p>
<p>The service is currently paused in the system.</p>
<!-- raw HTML omitted -->
<p><strong>Other</strong></p>
<!-- raw HTML omitted -->
<p>25 4294967295</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>To change a service from a network to a local system, use the following values for the <em>StartName</em> and <em>StartPassword</em> parameters:</p>
<pre lang="C++"><code>StartName = &quot;LocalSystem&quot;
StartPassword = &quot;&quot; // - empty string, not NULL
</code></pre>
<p>To change a service from a local system to a network, use the following values for the <em>StartName</em> and <em>StartPassword</em> parameters:</p>
<pre lang="C++"><code>StartName = &quot;NT AUTHORITY\NetworkService&quot;
StartPassword = &quot;&quot; // - empty string, not NULL
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mbnapi.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/previous-versions//aa392727(v=vs.85)">Operating System Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="win32-baseservice.html"><strong>Win32_BaseService</strong></a></p>
<!-- raw HTML omitted -->
</body>
