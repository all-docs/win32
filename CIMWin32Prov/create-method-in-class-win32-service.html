<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Create method of the Win32_Service class (CIMWin32 WMI Providers)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Create method of the Win32_Service class (CIMWin32 WMI Providers) - Creates a new system service.
ms.assetid: 164e9065-bb0d-4c93-a9fe-c86db1ea7cb7
ms.tgt_platform: multiple
title: Create method of the Win32_Service class (CIMWin32 WMI Providers)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_Service.Create
api_type:</li>
<li>COM
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>Create method of the Win32_Service class (CIMWin32 WMI Providers)</h1>
<p>The <strong>Create</strong> <a href="/windows/desktop/WmiSdk/retrieving-a-class">WMI class</a> method creates a new system service.</p>
<p>This topic uses Managed Object Format (MOF) syntax. For more information about using this method, see <a href="/windows/desktop/WmiSdk/calling-a-method">Calling a Method</a>.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 Create(
  [in] string  Name,
  [in] string  DisplayName,
  [in] string  PathName,
  [in] uint8   ServiceType,
  [in] uint8   ErrorControl,
  [in] string  StartMode,
  [in] boolean DesktopInteract,
  [in] string  StartName,
  [in] string  StartPassword,
  [in] string  LoadOrderGroup,
  [in] string  LoadOrderGroupDependencies[],
  [in] string  ServiceDependencies[]
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Name</em> [in]</p>
<!-- raw HTML omitted -->
<p>Name of the service to install to the <strong>Create</strong> method. The maximum string length is 256 characters. The Service Control Manager database preserves the case of the characters, but service name comparisons are always case-insensitive. Forward-slashes (/) and double back-slashes (\) are invalid service name characters.</p>
<!-- raw HTML omitted -->
<p><em>DisplayName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Display name of the service. This string has a maximum length of 256 characters. The name is case-preserved in the Service Control Manager. <em>DisplayName</em> comparisons are always case-insensitive.</p>
<p>Constraints: Accepts the same value as the <em>Name</em> parameter.</p>
<p>Example: &quot;Atdisk&quot;.</p>
<!-- raw HTML omitted -->
<p><em>PathName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Fully qualified path to the executable file that implements the service.</p>
<p>Example: &quot;\SystemRoot\System32\drivers\afd.sys&quot;.</p>
<!-- raw HTML omitted -->
<p><em>ServiceType</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type of services provided to processes that call them.</p>
<!-- raw HTML omitted -->
<p>1 (0x1)</p>
<!-- raw HTML omitted -->
<p>Kernel Driver</p>
<!-- raw HTML omitted -->
<p>2 (0x2)</p>
<!-- raw HTML omitted -->
<p>File System Driver</p>
<!-- raw HTML omitted -->
<p>4 (0x4)</p>
<!-- raw HTML omitted -->
<p>Adapter</p>
<!-- raw HTML omitted -->
<p>8 (0x8)</p>
<!-- raw HTML omitted -->
<p>Recognizer Driver</p>
<!-- raw HTML omitted -->
<p>16 (0x10)</p>
<!-- raw HTML omitted -->
<p>Own Process</p>
<!-- raw HTML omitted -->
<p>32 (0x20)</p>
<!-- raw HTML omitted -->
<p>Share Process</p>
<!-- raw HTML omitted -->
<p>256 (0x100)</p>
<!-- raw HTML omitted -->
<p>Interactive Process</p>
<!-- raw HTML omitted -->
<p><em>ErrorControl</em> [in]</p>
<!-- raw HTML omitted -->
<p>Severity of the error if the <strong>Create</strong> method fails to start. The value indicates the action taken by the startup program if failure occurs. All errors are logged by the system.</p>
<!-- raw HTML omitted -->
<p>0</p>
<!-- raw HTML omitted -->
<p>User is not notified.</p>
<!-- raw HTML omitted -->
<p>1</p>
<!-- raw HTML omitted -->
<p>User is notified.</p>
<!-- raw HTML omitted -->
<p>2</p>
<!-- raw HTML omitted -->
<p>System is restarted with the last-known-good configuration.</p>
<!-- raw HTML omitted -->
<p>3</p>
<!-- raw HTML omitted -->
<p>System attempts to start with a good configuration.</p>
<!-- raw HTML omitted -->
<p><em>StartMode</em> [in]</p>
<!-- raw HTML omitted -->
<p>Start mode of the Windows base service.</p>
<!-- raw HTML omitted -->
<p>Boot</p>
<!-- raw HTML omitted -->
<p>Device driver started by the operating system loader. This value is valid only for driver services.</p>
<!-- raw HTML omitted -->
<p>System</p>
<!-- raw HTML omitted -->
<p>Device driver started by the operating system initialization process. This value is valid only for driver services.</p>
<!-- raw HTML omitted -->
<p>Automatic</p>
<!-- raw HTML omitted -->
<p>Service to be started automatically by the Service Control Manager during system startup.</p>
<!-- raw HTML omitted -->
<p>Manual</p>
<!-- raw HTML omitted -->
<p>Service to be started by the Service Control Manager when a process calls the <a href="startservice-method-in-class-win32-service.html"><strong>StartService</strong></a> method.</p>
<!-- raw HTML omitted -->
<p>Disabled</p>
<!-- raw HTML omitted -->
<p>Service that can no longer be started.</p>
<!-- raw HTML omitted -->
<p><em>DesktopInteract</em> [in]</p>
<!-- raw HTML omitted -->
<p>If <strong>true</strong>, the service can create or communicate with windows on the desktop.</p>
<!-- raw HTML omitted -->
<p><em>StartName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Account name under which the service runs. Depending on the service type, the account name may be in the form of DomainName\Username or User Principal Name (UPN) format (Username@DomainName). The service process is logged using one of these two forms when it runs. If the account belongs to the built-in domain, .\Username can be specified. If <strong>NULL</strong> is specified, the service is logged on as the LocalSystem account. For a kernel or system-level drivers, <em>StartName</em> contains the driver object name (that is, \FileSystem\Rdr or \Driver\Xns) which the input and output (I/O) system uses to load the device driver. If <strong>NULL</strong> is specified, the driver runs with a default object name created by the I/O system based on the service name. Example: DWDOM\Admin.</p>
<!-- raw HTML omitted -->
<p><em>StartPassword</em> [in]</p>
<!-- raw HTML omitted -->
<p>Password to the account name specified by the <em>StartName</em> parameter. Specify <strong>NULL</strong> if you are not changing the password. Specify an empty string if the service has no password.</p>
<!-- raw HTML omitted -->
<p><em>LoadOrderGroup</em> [in]</p>
<!-- raw HTML omitted -->
<p>Group name associated with the new service. Load order groups are contained in the registry, and determine the sequence in which services are loaded into the operating system. If the pointer is <strong>NULL</strong> or if it points to an empty string, the service does not belong to a group. Dependencies between groups should be listed in the <em>LoadOrderGroupDependencies</em> parameter. Services in the load-ordering group list are started first, followed by services in groups not in the load-ordering group list, followed by services that do not belong to a group. The registry has a list of load ordering groups located at:</p>
<p><strong>HKEY_LOCAL_MACHINE</strong>\<strong>System</strong>\<strong>CurrentControlSet</strong>\<strong>Control</strong>\<strong>ServiceGroupOrder</strong></p>
<!-- raw HTML omitted -->
<p><em>LoadOrderGroupDependencies</em> [in]</p>
<!-- raw HTML omitted -->
<p>Array of load-ordering groups that must start before this service. Each item in the array is delimited by <strong>NULL</strong> and the list is terminated by two <strong>NULL</strong> values. In Visual Basic or script you can pass a vbArray. If the pointer is <strong>NULL</strong> or if it points to an empty string, the service has no dependencies. Group names must be prefixed by the <strong>SC_GROUP_IDENTIFIER</strong> (defined in the Winsvc.h file) character to differentiate it from a service name, because services and service groups share the same namespace. Dependency on a group means that this service can run if at least one member of the group is running after an attempt to start all of the members of the group.</p>
<!-- raw HTML omitted -->
<p><em>ServiceDependencies</em> [in]</p>
<!-- raw HTML omitted -->
<p>Array that contains names of services that must start before this service starts. Each item in the array is delimited by <strong>NULL</strong> and the list is terminated by two <strong>NULL</strong> values. In Visual Basic or script you can pass a vbArray. If the pointer is <strong>NULL</strong>, or if it points to an empty string, the service has no dependencies. Dependency on a service means that this service can only run if the service it depends on is running.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns one of the values listed in the following list or any other value to indicate an error. For additional error codes, see <a href="/windows/desktop/WmiSdk/wmi-error-constants"><strong>WMI Error Constants</strong></a> or <a href="/windows/desktop/api/wbemdisp/ne-wbemdisp-wbemerrorenum"><strong>WbemErrorEnum</strong></a>. For general <strong>HRESULT</strong> values, see <a href="/windows/desktop/Debug/system-error-codes">System Error Codes</a>.</p>
<!-- raw HTML omitted -->
<p><strong>0</strong></p>
<!-- raw HTML omitted -->
<p>The request was accepted.</p>
<!-- raw HTML omitted -->
<p><strong>1</strong></p>
<!-- raw HTML omitted -->
<p>The request is not supported.</p>
<!-- raw HTML omitted -->
<p><strong>2</strong></p>
<!-- raw HTML omitted -->
<p>The user did not have the necessary access.</p>
<!-- raw HTML omitted -->
<p><strong>3</strong></p>
<!-- raw HTML omitted -->
<p>The service cannot be stopped because other services that are running are dependent on it.</p>
<!-- raw HTML omitted -->
<p><strong>4</strong></p>
<!-- raw HTML omitted -->
<p>The requested control code is not valid, or it is unacceptable to the service.</p>
<!-- raw HTML omitted -->
<p><strong>5</strong></p>
<!-- raw HTML omitted -->
<p>The requested control code cannot be sent to the service because the state of the service (<strong>State</strong> property of the <a href="win32-baseservice.html"><strong>Win32_BaseService</strong></a> class) is equal to 0, 1, or 2.</p>
<!-- raw HTML omitted -->
<p><strong>6</strong></p>
<!-- raw HTML omitted -->
<p>The service has not been started.</p>
<!-- raw HTML omitted -->
<p><strong>7</strong></p>
<!-- raw HTML omitted -->
<p>The service did not respond to the start request in a timely fashion.</p>
<!-- raw HTML omitted -->
<p><strong>8</strong></p>
<!-- raw HTML omitted -->
<p>Unknown failure when starting the service.</p>
<!-- raw HTML omitted -->
<p><strong>9</strong></p>
<!-- raw HTML omitted -->
<p>The directory path to the service executable file was not found.</p>
<!-- raw HTML omitted -->
<p><strong>10</strong></p>
<!-- raw HTML omitted -->
<p>The service is already running.</p>
<!-- raw HTML omitted -->
<p><strong>11</strong></p>
<!-- raw HTML omitted -->
<p>The database to add a new service is locked.</p>
<!-- raw HTML omitted -->
<p><strong>12</strong></p>
<!-- raw HTML omitted -->
<p>A dependency this service relies on has been removed from the system.</p>
<!-- raw HTML omitted -->
<p><strong>13</strong></p>
<!-- raw HTML omitted -->
<p>The service failed to find the service needed from a dependent service.</p>
<!-- raw HTML omitted -->
<p><strong>14</strong></p>
<!-- raw HTML omitted -->
<p>The service has been disabled from the system.</p>
<!-- raw HTML omitted -->
<p><strong>15</strong></p>
<!-- raw HTML omitted -->
<p>The service does not have the correct authentication to run on the system.</p>
<!-- raw HTML omitted -->
<p><strong>16</strong></p>
<!-- raw HTML omitted -->
<p>This service is being removed from the system.</p>
<!-- raw HTML omitted -->
<p><strong>17</strong></p>
<!-- raw HTML omitted -->
<p>The service has no execution thread.</p>
<!-- raw HTML omitted -->
<p><strong>18</strong></p>
<!-- raw HTML omitted -->
<p>The service has circular dependencies when it starts.</p>
<!-- raw HTML omitted -->
<p><strong>19</strong></p>
<!-- raw HTML omitted -->
<p>A service is running under the same name.</p>
<!-- raw HTML omitted -->
<p><strong>20</strong></p>
<!-- raw HTML omitted -->
<p>The service name has invalid characters.</p>
<!-- raw HTML omitted -->
<p><strong>21</strong></p>
<!-- raw HTML omitted -->
<p>Invalid parameters have been passed to the service.</p>
<!-- raw HTML omitted -->
<p><strong>22</strong></p>
<!-- raw HTML omitted -->
<p>The account under which this service runs is either invalid or lacks the permissions to run the service.</p>
<!-- raw HTML omitted -->
<p><strong>23</strong></p>
<!-- raw HTML omitted -->
<p>The service exists in the database of services available from the system.</p>
<!-- raw HTML omitted -->
<p><strong>24</strong></p>
<!-- raw HTML omitted -->
<p>The service is currently paused in the system.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>Services are generally installed in one of two ways: either as a part of the operating system installation or by using an installation program provided by the service developer. However, some services, particularly those created in-house, might not have an installation program. In those instances, you can use the <strong>Create</strong> method to programmatically install services.</p>
<p>Despite the name, the Create method does not actually create a service; it merely installs an existing service. To use this command, you need to copy the service executable file to a computer and then use <strong>Create</strong> to install the service.</p>
<p>The <strong>Create</strong> method is similar to the <a href="change-method-in-class-win32-service.html"><strong>Change</strong></a> method. In both cases, the properties of the service are passed as parameters to the method. As with the parameters used with the <strong>Change</strong> method, the order in which these parameters are passed is very important.</p>
<p>The <em>LoadOrderGroup</em> parameter represents a grouping of system services defining execution dependencies. The services must be initiated in the order specified by the Load Order Group, as the services are dependent on each other. These dependent services require the presence of the antecedent services to function correctly.</p>
<h2>Examples</h2>
<p>The following VBScript installs a service named DbService</p>
<pre lang="VB"><code>Const OWN_PROCESS = 16
Const NOT_INTERACTIVE = True
strComputer = &quot;.&quot;
Set objWMIService = GetObject(&quot;winmgmts:&quot; _
 &amp; &quot;{impersonationLevel=impersonate}!\\&quot; &amp; strComputer &amp; &quot;\root\cimv2&quot;)
Set objService = objWMIService.Get(&quot;Win32_BaseService&quot;)
errReturn = objService.Create (&quot;DbService&quot;, &quot;Personnel Database&quot;, _
&quot;c:\windows\system32\db.exe&quot;, OWN_PROCESS ,2 ,&quot;Automatic&quot; , _
 NOT_INTERACTIVE ,&quot;.\LocalSystem&quot; ,&quot;&quot;)
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/previous-versions//aa392727(v=vs.85)">Operating System Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="win32-service.html"><strong>Win32_Service</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/WmiSdk/wmi-tasks--services">WMI Tasks: Services</a></p>
<!-- raw HTML omitted -->
</body>
