<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Chkdsk method of the Win32_LogicalDisk class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Invokes the chkdsk operation on the disk.
ms.assetid: 65942702-b660-46cd-b614-e3e1ec3df7b9
ms.tgt_platform: multiple
title: Chkdsk method of the Win32_LogicalDisk class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_LogicalDisk.Chkdsk
api_type:</li>
<li>COM
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>Chkdsk method of the Win32_LogicalDisk class</h1>
<p>The <strong>Chkdsk</strong> instance method invokes the <strong>chkdsk</strong> operation on the disk.</p>
<p>This topic uses Managed Object Format (MOF) syntax. For more information about using this method, see <a href="/windows/desktop/WmiSdk/calling-a-method">Calling a Method</a>.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 Chkdsk(
  [in] boolean FixErrors = ,
  [in] boolean VigorousIndexCheck = ,
  [in] boolean SkipFolderCycle = ,
  [in] boolean ForceDismount = ,
  [in] boolean RecoverBadSectors = ,
  [in] boolean OKToRunAtBootUp = 
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>FixErrors</em> [in]</p>
<!-- raw HTML omitted -->
<p>Indicates what should be done to errors found on the disk. If <strong>true</strong>, then errors are fixed. The default is <strong>false</strong>.</p>
<!-- raw HTML omitted -->
<p><em>VigorousIndexCheck</em> [in]</p>
<!-- raw HTML omitted -->
<p>If <strong>true</strong>, a less vigorous check of index entries should be performed. The default is <strong>false</strong>.</p>
<!-- raw HTML omitted -->
<p><em>SkipFolderCycle</em> [in]</p>
<!-- raw HTML omitted -->
<p>If <strong>true</strong>, the folder cycle checking should be skipped. The default is <strong>true</strong>.</p>
<!-- raw HTML omitted -->
<p><em>ForceDismount</em> [in]</p>
<!-- raw HTML omitted -->
<p>If <strong>true</strong>, the drive should be forced to dismount before checking. The default is <strong>false</strong>.</p>
<!-- raw HTML omitted -->
<p><em>RecoverBadSectors</em> [in]</p>
<!-- raw HTML omitted -->
<p>If <strong>true</strong>, the bad sectors should be located and the readable information should be recovered from these sectors. The default is <strong>false</strong>.</p>
<!-- raw HTML omitted -->
<p><em>OKToRunAtBootUp</em> [in]</p>
<!-- raw HTML omitted -->
<p>If <strong>true</strong>, the <strong>chkdsk</strong> operation should be performed at next boot up time, in case the operation could not be performed because the disk is locked at time this method is called. The default is <strong>false</strong>.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns a value of 0 (zero) if successful. Other values are listed in the following list. For additional error codes, see <a href="/windows/desktop/WmiSdk/wmi-error-constants"><strong>WMI Error Constants</strong></a> or <a href="/windows/desktop/api/wbemdisp/ne-wbemdisp-wbemerrorenum"><strong>WbemErrorEnum</strong></a>. For general <strong>HRESULT</strong> values, see <a href="/windows/desktop/Debug/system-error-codes">System Error Codes</a>.</p>
<!-- raw HTML omitted -->
<p><strong>Success - Chkdsk completed</strong></p>
<!-- raw HTML omitted -->
<p>0</p>
<p>Success - <a href="chkdsk-method-in-class-win32-logicaldisk.html"><strong>Chkdsk</strong></a> Completed</p>
<!-- raw HTML omitted -->
<p><strong>Success - Locked and chkdsk scheduled on reboot</strong></p>
<!-- raw HTML omitted -->
<p>1</p>
<!-- raw HTML omitted -->
<p><strong>Failure - Unknown file system</strong></p>
<!-- raw HTML omitted -->
<p>2</p>
<!-- raw HTML omitted -->
<p><strong>Failure - Unknown error</strong></p>
<!-- raw HTML omitted -->
<p>3</p>
<!-- raw HTML omitted -->
<p><strong>Failure - Unsupported File System</strong></p>
<!-- raw HTML omitted -->
<p>4</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>This method is only applicable to those instances of logical disk that represent a physical disk in the machine. It is not applicable to mapped logical drives.</p>
<h2>Examples</h2>
<p>The following VBScript code sample Runs ChkDsk.exe against drive D on a computer.</p>
<pre lang="VB"><code>Const FIX_ERRORS = True 
 
strComputer = &quot;.&quot; 
Set objWMIService = GetObject(&quot;winmgmts:&quot; _ 
    &amp; &quot;{impersonationLevel=impersonate}!\\&quot; &amp; strComputer &amp; &quot;\root\cimv2&quot;) 
 
Set objDisk = objWMIService.Get(&quot;Win32_LogicalDisk.DeviceID='D:'&quot;) 
 
errReturn = objDisk.ChkDsk(FIX_ERRORS) 
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-logicaldisk.html"><strong>Win32_LogicalDisk</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="computer-system-hardware-classes.html">Computer System Hardware Classes</a></p>
<!-- raw HTML omitted -->
</body>
