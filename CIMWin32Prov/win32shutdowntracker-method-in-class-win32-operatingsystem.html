<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Win32ShutdownTracker method of the Win32_OperatingSystem class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The Win32ShutdownTracker method provides the same set of shutdown options supported by the Win32Shutdown method in Win32_OperatingSystem, but it also allows you to specify comments, a reason for shutdown, or a timeout.
ms.assetid: 2c5502c9-9ec0-4f9e-b661-1f8015556008
ms.tgt_platform: multiple
title: Win32ShutdownTracker method of the Win32_OperatingSystem class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_OperatingSystem.Win32ShutdownTracker
api_type:</li>
<li>COM
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>Win32ShutdownTracker method of the Win32_OperatingSystem class</h1>
<p>The <strong>Win32ShutdownTracker</strong> method provides the same set of shutdown options supported by the <a href="win32shutdown-method-in-class-win32-operatingsystem.html"><strong>Win32Shutdown</strong></a> method in <a href="win32-operatingsystem.html"><strong>Win32_OperatingSystem</strong></a>, but it also allows you to specify comments, a reason for shutdown, or a timeout.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 Win32ShutdownTracker(
  [in]Â uint32 Timeout,
  [in]Â string Comment,
  [in]Â uint32 ReasonCode,
  [in]Â sint32 Flags
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Timeout</em> [in]</p>
<!-- raw HTML omitted -->
<p>Time, in seconds, before shutdown takes place. The default value is 0 (zero).</p>
<!-- raw HTML omitted -->
<p><em>Comment</em> [in]</p>
<!-- raw HTML omitted -->
<p>Message to display in the shutdown dialog box that is also stored as a comment in the event log entry.</p>
<!-- raw HTML omitted -->
<p><em>ReasonCode</em> [in]</p>
<!-- raw HTML omitted -->
<p>Reason for initiating the shutdown.</p>
<!-- raw HTML omitted -->
<p><em>Flags</em> [in]</p>
<!-- raw HTML omitted -->
<p>Bitmapped set of flags to shut the computer down. To force a command, add the Force flag (4) to the command value. Using Force in conjunction with Shutdown or Reboot on a remote computer immediately shuts down everything (including WMI, COM, and so on), or reboots the remote computer. This results in an indeterminate return value.</p>
<!-- raw HTML omitted -->
<p>0 (0x0)</p>
<!-- raw HTML omitted -->
<p>Log Off</p>
<!-- raw HTML omitted -->
<p>4 (0x4)</p>
<!-- raw HTML omitted -->
<p>Forced Log Off (0 + 4)</p>
<!-- raw HTML omitted -->
<p>1 (0x1)</p>
<!-- raw HTML omitted -->
<p>Shutdown</p>
<!-- raw HTML omitted -->
<p>5 (0x5)</p>
<!-- raw HTML omitted -->
<p>Forced Shutdown (1 + 4)</p>
<!-- raw HTML omitted -->
<p>2 (0x2)</p>
<!-- raw HTML omitted -->
<p>Reboot</p>
<!-- raw HTML omitted -->
<p>6 (0x6)</p>
<!-- raw HTML omitted -->
<p>Forced Reboot (2 + 4)</p>
<!-- raw HTML omitted -->
<p>8 (0x8)</p>
<!-- raw HTML omitted -->
<p>Power Off</p>
<!-- raw HTML omitted -->
<p>12 (0xC)</p>
<!-- raw HTML omitted -->
<p>Forced Power Off (8 + 4)</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns zero (0) to indicate success. Any other number indicates an error. For error codes, see <a href="../wmisdk/wmi-error-constants.html"><strong>WMI Error Constants</strong></a> or <a href="/windows/win32/api/wbemdisp/ne-wbemdisp-wbemerrorenum"><strong>WbemErrorEnum</strong></a>. For general <strong>HRESULT</strong> values, see <a href="../debug/system-error-codes.html">System Error Codes</a>.</p>
<!-- raw HTML omitted -->
<p><strong>Success</strong> (0)</p>
<!-- raw HTML omitted -->
<p><strong>Other</strong> (1â€“4294967295)</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The calling process must have the <strong>SE_SHUTDOWN_NAME</strong> privilege.</p>
<h2>Examples</h2>
<p>The following VBScript code sample describes how to call <strong>Win32ShutdownTracker</strong>.</p>
<pre lang="VB"><code>Set objArgs = Wscript.Arguments 

intTimeOut = objArgs(0) 'Countdown time (in seconds) before action
strComment = objArgs(1) 'Message to display
intFlags = objArgs(2) 'Set of flags to shutdown the computer:
'0 = Logoff, 4 = Forced Logoff (0+4), 1 = Shutdown, 2 = Reboot, 6 = Forced Reboot (2+4), 8 = Power Off, 12 = Forced Power Off (8+4) - 2 (Reboot) 

strComputer = &quot;.&quot; 

Set objWMIService = GetObject(&quot;winmgmts:{impersonationLevel=impersonate,(Shutdown)}!\\&quot; &amp; strComputer &amp; &quot;\root\cimv2&quot;)

Set colOperatingSystems = objWMIService.ExecQuery (&quot;Select * from Win32_OperatingSystem&quot;) 

For Each objOperatingSystem in colOperatingSystems 
objOperatingSystem.Win32ShutdownTracker intTimeOut,strComment,0,intFlags 
Next
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="./operating-system-classes.html">Operating System Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="win32-operatingsystem.html"><strong>Win32_OperatingSystem</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="win32shutdown-method-in-class-win32-operatingsystem.html"><strong>Win32Shutdown</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
