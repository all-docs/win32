<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Compress method of the Win32_Directory class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Compresses the logical directory entry file (or directory) specified in the object path.
ms.assetid: 4db13622-75c5-45db-8536-451059c0e477
ms.tgt_platform: multiple
title: Compress method of the Win32_Directory class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_Directory.Compress
api_type:</li>
<li>COM
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>Compress method of the Win32_Directory class</h1>
<p>The <strong>Compress</strong> <a href="/windows/desktop/WmiSdk/retrieving-a-class">WMI class</a> method compresses the logical directory entry file (or directory) specified in the object path.</p>
<p>This topic uses Managed Object Format (MOF) syntax. For more information about using this method, see <a href="/windows/desktop/WmiSdk/calling-a-method">Calling a Method</a>.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 Compress();
</code></pre>
<h2>Parameters</h2>
<p>This method has no parameters.</p>
<h2>Return value</h2>
<p>Returns a value of 0 (zero) if the file was successfully compressed, and any other number to indicate an error.</p>
<!-- raw HTML omitted -->
<p><strong>0</strong></p>
<!-- raw HTML omitted -->
<p>The request was successful.</p>
<!-- raw HTML omitted -->
<p><strong>2</strong></p>
<!-- raw HTML omitted -->
<p>Access was denied.</p>
<!-- raw HTML omitted -->
<p><strong>8</strong></p>
<!-- raw HTML omitted -->
<p>An unspecified failure occurred.</p>
<!-- raw HTML omitted -->
<p><strong>9</strong></p>
<!-- raw HTML omitted -->
<p>The name specified was not valid.</p>
<!-- raw HTML omitted -->
<p><strong>10</strong></p>
<!-- raw HTML omitted -->
<p>The object specified already exists.</p>
<!-- raw HTML omitted -->
<p><strong>11</strong></p>
<!-- raw HTML omitted -->
<p>The file system is not an NTFS.</p>
<!-- raw HTML omitted -->
<p><strong>12</strong></p>
<!-- raw HTML omitted -->
<p>The platform is not Windows.</p>
<!-- raw HTML omitted -->
<p><strong>13</strong></p>
<!-- raw HTML omitted -->
<p>The drive is not the same.</p>
<!-- raw HTML omitted -->
<p><strong>14</strong></p>
<!-- raw HTML omitted -->
<p>The directory is not empty.</p>
<!-- raw HTML omitted -->
<p><strong>15</strong></p>
<!-- raw HTML omitted -->
<p>There has been a sharing violation.</p>
<!-- raw HTML omitted -->
<p><strong>16</strong></p>
<!-- raw HTML omitted -->
<p>The start file specified was not valid.</p>
<!-- raw HTML omitted -->
<p><strong>17</strong></p>
<!-- raw HTML omitted -->
<p>A privilege required for the operation is not held.</p>
<!-- raw HTML omitted -->
<p><strong>21</strong></p>
<!-- raw HTML omitted -->
<p>A parameter specified is not valid.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>Compression provides a way to free additional storage space on a disk drive without purchasing new hardware and without removing files or folders. Depending on the size of your hard disk and the type of files stored on that disk, you might be able to recover hundreds of megabytes of disk space and thus preclude the need to purchase a new hard drive and to take the computer offline until the new drive is installed.</p>
<p>The Compress method compresses all the files and subfolders within a specified folder. In addition, the class also includes an Uncompress method that removes compression from all the files and subfolders in a folder. Similar methods are also provided with the CIM_Datafile class. This allows you to selectively compress or uncompress specific files within a folder.</p>
<p>Because compression imparts a slight performance penalty, it is not recommended for files or folders that are accessed on a routine basis; for example, you probably do not want to compress database files, log files, or user profile folders. Better candidates for compression are files and folders that are not accessed very often. For example, you might write a script to return a collection of folders on a drive that have not been accessed for a month or more and then compress each of those folders.</p>
<p>The amount of disk space freed by compressing folders varies depending on the type of files stored in that folder. For example, .jpg files are already compressed, and further compression has little effect on the size of the file. With other file types, however, the savings can be considerable. For example, a new folder was created on a Windows 2000-based test computer, and 33 Microsoft Word documents, taking up a total of 15 megabytes (MB) of disk space, were copied into that folder. When the documents were compressed, the folder took up only 7 MB of disk space.</p>
<h2>Examples</h2>
<p>The following VBScript sample compresses the folder C:\Scripts.</p>
<pre lang="VB"><code>strComputer = &quot;.&quot;
Set objWMIService = GetObject(&quot;winmgmts:&quot; _
 &amp; &quot;{impersonationLevel=impersonate}!\\&quot; &amp; strComputer &amp; &quot;\root\cimv2&quot;)
Set colFolders = objWMIService.ExecQuery _
 (&quot;SELECT * FROM Win32_Directory WHERE Name = 'c:\\Scripts'&quot;)
For Each objFolder in colFolders
 errResults = objFolder.Compress
 Wscript.Echo errResults
Next
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/previous-versions//aa392727(v=vs.85)">Operating System Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="win32-directory.html"><strong>Win32_Directory</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="uncompress-method-in-class-win32-directory.html"><strong>Uncompress</strong></a></p>
<!-- raw HTML omitted -->
</body>
