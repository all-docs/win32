<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Win32_PowerManagementEvent class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The Win32_PowerManagementEvent &amp;#32; WMI class represents power management events resulting from power state changes.
ms.assetid: b5781805-87c7-4eaf-afbb-a1770fcff41c
ms.tgt_platform: multiple
title: Win32_PowerManagementEvent class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_PowerManagementEvent</li>
<li>Win32_PowerManagementEvent.SECURITY_DESCRIPTOR</li>
<li>Win32_PowerManagementEvent.TIME_CREATED</li>
<li>Win32_PowerManagementEvent.EventType</li>
<li>Win32_PowerManagementEvent.OEMEventCode
api_type:</li>
<li>DllExport
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>Win32_PowerManagementEvent class</h1>
<p>The <strong>Win32_PowerManagementEvent</strong> <a href="../wmisdk/retrieving-a-class.html">WMI class</a> represents power management events resulting from power state changes. These state changes are associated with either the Advanced Power Management (APM) or the Advanced Configuration and Power Interface (ACPI) system management protocols.</p>
<p>The following syntax is simplified from Managed Object Format (MOF) code and includes all of the inherited properties. Properties are listed in alphabetic order, not MOF order.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[UUID(&quot;{86460B6B-E709-11d2-B139-00105A1F77A1}&quot;), AMENDMENT]
class Win32_PowerManagementEvent : __ExtrinsicEvent
{
  uint8Â  SECURITY_DESCRIPTOR[];
  uint64 TIME_CREATED;
  uint16 EventType;
  uint16 OEMEventCode;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>Win32_PowerManagementEvent</strong> class has these types of members:</p>
<ul>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Properties</h3>
<p>The <strong>Win32_PowerManagementEvent</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>EventType</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint16</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;Win32API|Power Management Events&quot;)</p>
<!-- raw HTML omitted -->
<p>Type of change in the system power state.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Entering Suspend</strong> (4)</p>
<!-- raw HTML omitted -->
<p>While suspended, the computer appears to be off; however, it can be &quot;awakened&quot; in response to various events, including user input (such as moving the mouse or pressing a key on the keyboard). While the computer is suspended, power consumption is reduced to one of several levels depending on how the system is to be used. The lower the level of power consumption, the more time it takes the system to return to the working state. When the computer enters the suspend state, the desktop is locked, and you must press CTRL+ALT+DELETE and provide a valid user name and password to resume operations</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Resume from Suspend</strong> (7)</p>
<!-- raw HTML omitted -->
<p>Indicates that a Resume from Suspend message has been sent, enabling the computer to return to its regular power state.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Power Status Change</strong> (10)</p>
<!-- raw HTML omitted -->
<p>Indicates a change in the power status of the computer, such as a switch from battery power to AC, or from AC to an uninterruptible power supply. The system also broadcasts this event when remaining battery power slips below the threshold specified by the user or if the battery power changes by a specified percentage.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>OEM Event</strong> (11)</p>
<!-- raw HTML omitted -->
<p>Indicates that an Advanced Power Management (APM) BIOS has sent an OEM event. The value of the event will be captured in the <strong>OEMEventCode</strong> property. Because some APM BIOS implementations do not provide OEM event notifications, this event might never be broadcast on some computers. APM is a legacy power management scheme. Although still supported, APM has been largely superseded by ACPI (Advanced Configuration and Power Interface).</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Resume Automatic</strong> (18)</p>
<!-- raw HTML omitted -->
<p>Indicates that the computer has awakened in response to an event. If the system detects user activity (such as a mouse click), the ResumeSuspend message will be broadcast, letting applications know that they can resume full interactivity with the user.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>OEMEventCode</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint16</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;Win32API|Power Management Events&quot;)</p>
<!-- raw HTML omitted -->
<p>System power state defined by the original equipment manufacturer (OEM) when the <strong>EventType</strong> property of this class is set to 11 (OEM Event); otherwise, this property is set to <strong>NULL</strong>. OEM events are generated when an APM BIOS signals an APM OEM event. OEM event codes are in the range 0x0200h - 0x02FFh.</p>
<!-- raw HTML omitted -->
<p><strong>SECURITY_DESCRIPTOR</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint8</strong> array</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Descriptor used by the event provider to determine which users can receive the event. This property is inherited from <a href="../wmisdk/--event.html"><strong>__Event</strong></a>. For more information about constants used to set this security descriptor, see <a href="../wmisdk/wmi-security-constants.html">WMI Security Constants</a>.</p>
<!-- raw HTML omitted -->
<p><strong>TIME_CREATED</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint64</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Unique value that indicates the time at which the event was generated. This is a 64-bit value that represents the number of 100-nanosecond intervals after January 1, 1601. The information is in the Coordinated Universal Times (UTC) format.</p>
<p>This property is inherited from <a href="../wmisdk/--event.html"><strong>__Event</strong></a>.</p>
<p>For more information about using <strong>uint64</strong> values in scripts, see <a href="../wmisdk/creating-a-wmi-script.html">Scripting in WMI</a>.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The <strong>Win32_PowerManagementEvent</strong> class is derived from <a href="../wmisdk/--extrinsicevent.html"><strong>__ExtrinsicEvent</strong></a>.</p>
<p>Changes in power status often indicate that a problem has occurred with a computer or with another managed device. If a server suddenly switches from AC power to an uninterruptible power supply, this change can indicate that an electrical problem of some kind has occurred, either with the computer itself or with the electrical system in the room in which the computer is kept.</p>
<p>Administrators need to monitor these changes in power status and be notified of such changes immediately. This enables them to take action before the device loses power entirely. (Uninterruptible power supply systems, for example, might run for only 15 minutes or so before shutting down.)</p>
<p>The <strong>Win32_PowerManagementEvent</strong> class can be used to monitor changes in power status on a computer. These changes can include a switch from one power source to another as well as a change in computer power state (for example, entering or exiting Suspend mode).</p>
<p>The <strong>Win32_PowerManagementEvent</strong> class has only two properties: EventType, used to indicate the type of power change event that occurred, and OEMEventType, which is used by some original equipment manufacturers to define additional power change events.</p>
<p>For more information on responding to Windows power events, see the <a href="https://devblogs.microsoft.com/scripting/monitor-and-respond-to-windows-power-events-with-powershell/">Monitor and Respond to Windows Power Events with PowerShell</a> article on the Hey! Scripting Guy! blog.</p>
<h2>Examples</h2>
<p>The following VBScript monitors changes in power status on a computer.</p>
<pre lang="VB"><code>Set colMonitoredEvents = GetObject(&quot;winmgmts:&quot;)._
 ExecNotificationQuery(&quot;SELECT * FROM Win32_PowerManagementEvent&quot;)
Do
 Set strLatestEvent = colMonitoredEvents.NextEvent
 Wscript.Echo strLatestEvent.EventType
Loop
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="../wmisdk/--extrinsicevent.html"><strong>__ExtrinsicEvent</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="computer-system-hardware-classes.html">Computer System Hardware Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/tn-archive/ee176537(v=technet.10)">Monitoring Changes in Computer Power Status</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
