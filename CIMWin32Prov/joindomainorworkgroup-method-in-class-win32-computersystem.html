<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JoinDomainOrWorkgroup method of the Win32_ComputerSystem class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Joins a computer system to a domain or workgroup.
ms.assetid: b9421f04-9b56-4413-af5c-12dffeb6f0c8
ms.tgt_platform: multiple
title: JoinDomainOrWorkgroup method of the Win32_ComputerSystem class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_ComputerSystem.JoinDomainOrWorkgroup
api_type:</li>
<li>COM
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>JoinDomainOrWorkgroup method of the Win32_ComputerSystem class</h1>
<p>The <strong>JoinDomainOrWorkgroup</strong> method joins a computer system to a domain or workgroup.</p>
<p>This topic uses Managed Object Format (MOF) syntax. For more information about using this method, see <a href="/windows/desktop/WmiSdk/calling-a-method">Calling a Method</a>.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 JoinDomainOrWorkgroup(
  [in] string Name,
  [in] string Password,
  [in] string UserName,
  [in] string AccountOU,
  [in] uint32 FJoinOptions = 
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Name</em> [in]</p>
<!-- raw HTML omitted -->
<p>Specifies the domain or workgroup to join. Cannot be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>Password</em> [in]</p>
<!-- raw HTML omitted -->
<p>If the <em>UserName</em> parameter specifies an account name, the <em>Password</em> parameter must point to the password to use when connecting to the domain controller. Otherwise, this parameter must be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>UserName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Pointer to a constant <strong>null</strong>-terminated character string that specifies the account name to use when connecting to the domain controller. Must specify a domain NetBIOS name and user account, for example, Domain\user. If this parameter is <strong>NULL</strong>, the caller information is used.</p>
<p>You can also use the user principal name (UPPED) in the form user@domain.</p>
<!-- raw HTML omitted -->
<p><em>AccountOU</em> [in]</p>
<!-- raw HTML omitted -->
<p>Specifies the pointer to a constant <strong>null</strong>-terminated character string that contains the <a href="https://www.ietf.org/rfc/rfc1779.txt">RFC 1779</a> format name of the organizational unit (OU) for the computer account. If you specify this parameter, the string must contain a full path, otherwise <em>Accent</em> must be <strong>NULL</strong>.</p>
<p>Example: &quot;OU=testOU; DC=domain; DC=Domain; DC=com&quot;</p>
<!-- raw HTML omitted -->
<p><em>FJoinOptions</em> [in]</p>
<!-- raw HTML omitted -->
<p>Set of bit flags that define the join options.</p>
<!-- raw HTML omitted -->
<p>(0)</p>
<!-- raw HTML omitted -->
<p>Default. No join options.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_JOIN_DOMAIN</strong> (0x00000001)</p>
<!-- raw HTML omitted -->
<p>Joins the computer to a domain. If this value is not specified, joins the computer to a workgroup.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_ACCT_CREATE</strong> (0x00000002)</p>
<!-- raw HTML omitted -->
<p>Creates the account on the domain.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_WIN9X_UPGRADE</strong> (0x00000010)</p>
<!-- raw HTML omitted -->
<p>The join operation is occurring as part of an upgrade.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_DOMAIN_JOIN_IF_JOINED</strong> (0x00000020)</p>
<!-- raw HTML omitted -->
<p>Allows a join to a new domain even if the computer is already joined to a domain.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_JOIN_UNSECURE</strong> (0x00000040)</p>
<!-- raw HTML omitted -->
<p>Performs an unsecured join.</p>
<p>This option requests a domain join to a pre-created account without authenticating with domain user credentials. This option can be used in conjunction with <strong>NETSETUP_MACHINE_PWD_PASSED</strong> option. In this case, <em>Password</em> is the password of the pre-created machine account.</p>
<p>Prior to Windows Vista with SP1 and Windows Server 2008, an unsecure join did not authenticate to the domain controller. All communication was performed using a null (unauthenticated) session. Starting with Windows Vista with SP1 and Windows Server 2008, the machine account name and password are used to authenticate to the domain controller.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_MACHINE_PWD_PASSED</strong> (0x00000080)</p>
<!-- raw HTML omitted -->
<p>Indicates that the <em>Password</em> parameter specifies a local machine account password rather than a user password. This flag is valid only for unsecured joins, which you must indicate by also setting the NETSETUP_JOIN_UNSECURE flag.</p>
<p>If you set this flag, then after the join operation succeeds, the machine password will be set to the value of <em>Password</em>, if that value is a valid machine password.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_DEFER_SPN_SET</strong> (0x00000100)</p>
<!-- raw HTML omitted -->
<p>Indicates that the service principal name (SPN) and the DnsHostName properties on the computer object should not be updated at this time.</p>
<p>Typically, these properties are updated during the join operation. Instead, these properties should be updated during a subsequent call to the <a href="rename-method-in-class-win32-computersystem.html"><strong>Rename</strong></a> method. These properties are always updated during the rename operation.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_JOIN_DC_ACCOUNT</strong> (0x00000200)</p>
<!-- raw HTML omitted -->
<p>Allow the domain join if existing account is a domain controller.</p>
<blockquote>
<p>[!Note]<br />
This flag is supported on Windows Vista and later.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_AMBIGUOUS_DC</strong> (0x00001000)</p>
<!-- raw HTML omitted -->
<p>When joining the domain don't try to set the preferred domain controller in the registry.</p>
<blockquote>
<p>[!Note]<br />
This flag is supported on Windows 7, Windows Server 2008 R2, and later.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_NO_NETLOGON_CACHE</strong> (0x00002000)</p>
<!-- raw HTML omitted -->
<p>When joining the domain don't create the Netlogon cache.</p>
<blockquote>
<p>[!Note]<br />
This flag is supported on Windows 7, Windows Server 2008 R2, and later.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_DONT_CONTROL_SERVICES</strong> (0x00004000)</p>
<!-- raw HTML omitted -->
<p>When joining the domain don't force Netlogon service to start.</p>
<blockquote>
<p>[!Note]<br />
This flag is supported on Windows 7, Windows Server 2008 R2, and later.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_SET_MACHINE_NAME</strong> (0x00008000)</p>
<!-- raw HTML omitted -->
<p>When joining the domain for offline join only, set target machine hostname and NetBIOS name.</p>
<blockquote>
<p>[!Note]<br />
This flag is supported on Windows 7, Windows Server 2008 R2, and later.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_FORCE_SPN_SET</strong> (0x00010000)</p>
<!-- raw HTML omitted -->
<p>When joining the domain, override other settings during domain join and set the service principal name (SPN).</p>
<blockquote>
<p>[!Note]<br />
This flag is supported on Windows 7, Windows Server 2008 R2, and later.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_NO_ACCT_REUSE</strong> (0x00020000)</p>
<!-- raw HTML omitted -->
<p>When joining the domain, do not reuse an existing account.</p>
<blockquote>
<p>[!Note]<br />
This flag is supported on Windows 7, Windows Server 2008 R2, and later.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NETSETUP_IGNORE_UNSUPPORTED_FLAGS</strong> (0x10000000)</p>
<!-- raw HTML omitted -->
<p>If this bit is set, unrecognized flags will be ignored by the <strong>JoinDomainOrWorkgroup</strong> function and <a href="/windows/desktop/api/lmjoin/nf-lmjoin-netjoindomain"><strong>NetJoinDomain</strong></a> will behave as if the flags were not set.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns a <a href="/windows/desktop/Debug/system-error-codes">system error code</a>, which may include one of the following numeric values. Any other number indicates an error. For additional error codes, see <a href="/windows/desktop/WmiSdk/wmi-error-constants"><strong>WMI Error Constants</strong></a> or <a href="/windows/desktop/api/wbemdisp/ne-wbemdisp-wbemerrorenum"><strong>WbemErrorEnum</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>Success</strong></p>
<!-- raw HTML omitted -->
<p>0</p>
<!-- raw HTML omitted -->
<p><strong>5</strong></p>
<!-- raw HTML omitted -->
<p>Access is denied.</p>
<!-- raw HTML omitted -->
<p><strong>87</strong></p>
<!-- raw HTML omitted -->
<p>The parameter is incorrect.</p>
<!-- raw HTML omitted -->
<p><strong>110</strong></p>
<!-- raw HTML omitted -->
<p>The system cannot open the specified object.</p>
<!-- raw HTML omitted -->
<p><strong>1323</strong></p>
<!-- raw HTML omitted -->
<p>Unable to update the password.</p>
<!-- raw HTML omitted -->
<p><strong>1326</strong></p>
<!-- raw HTML omitted -->
<p>Logon failure: unknown username or bad password.</p>
<!-- raw HTML omitted -->
<p><strong>1355</strong></p>
<!-- raw HTML omitted -->
<p>The specified domain either does not exist or could not be contacted.</p>
<!-- raw HTML omitted -->
<p><strong>2224</strong></p>
<!-- raw HTML omitted -->
<p>The account already exists.</p>
<!-- raw HTML omitted -->
<p><strong>2691</strong></p>
<!-- raw HTML omitted -->
<p>The machine is already joined to the domain.</p>
<!-- raw HTML omitted -->
<p><strong>2692</strong></p>
<!-- raw HTML omitted -->
<p>The machine is not currently joined to a domain.</p>
<!-- raw HTML omitted -->
<p><strong>WBEM_E_ENCRYPTED_CONNECTION_REQUIRED</strong></p>
<!-- raw HTML omitted -->
<p>0x80041087</p>
<p><em>Password</em> and <em>UserName</em> are specified but the authentication level is not <strong>RPC_C_AUTHN_LEVEL_PKT_PRIVACY</strong>. For Visual Basic, <strong>wbemErrEncryptedConnectionRequired</strong> is returned.</p>
<!-- raw HTML omitted -->
<p><strong>Other</strong></p>
<!-- raw HTML omitted -->
<p>1 4294967295</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>When moving a computer from a domain to a workgroup, you must remove the computer from the domain (with a call to <a href="unjoindomainorworkgroup-method-in-class-win32-computersystem.html"><strong>UnjoinDomainOrWorkgroup</strong></a>) before calling this method to join a workgroup (with a call to <strong>JoinDomainOrWorkgroup</strong>). After calling this method, restart the affected computer to apply the changes.</p>
<p><em>UserName</em> and <em>Password</em> can be left <strong>null</strong>. However, the authentication of the connection to WMI must be 6 in script or <strong>WbemAuthenticationLevelPktPrivacy</strong> in Visual Basic and other languages that can use the <a href="/windows/desktop/WmiSdk/using-the-wmi-scripting-type-library">wbemdisp.dll</a> library. For more information, see <a href="/windows/desktop/WmiSdk/setting-the-default-process-security-level-using-vbscript">Setting the Default Process Security Level Using VBScript</a>.</p>
<p>In C++, set the authentication at <strong>RPC_C_AUTHN_LEVEL_PKT_PRIVACY</strong> either in <a href="/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity"><strong>CoInitializeSecurity</strong></a>, for the entire process, or in <a href="/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket"><strong>CoSetProxyBlanket</strong></a>, for a connection to the <a href="/windows/desktop/api/wbemcli/nn-wbemcli-iwbemservices"><strong>IWbemServices</strong></a> proxy. For more information, see <a href="/windows/desktop/WmiSdk/setting-authentication-using-c-">Setting Authentication Using C++</a> and <a href="/windows/desktop/WmiSdk/setting-the-security-on-iwbemservices-and-other-proxies">Setting the Security on IWbemServices and Other Proxies</a>.</p>
<h2>Examples</h2>
<p>The following VBScript code example joins a computer to a domain and creates the computer's account in Active Directory.</p>
<pre lang="VB"><code>Const JOIN_DOMAIN             = 1
Const ACCT_CREATE             = 2
Const ACCT_DELETE             = 4
Const WIN9X_UPGRADE           = 16
Const DOMAIN_JOIN_IF_JOINED   = 32
Const JOIN_UNSECURE           = 64
Const MACHINE_PASSWORD_PASSED = 128
Const DEFERRED_SPN_SET        = 256
Const INSTALL_INVOCATION      = 262144
strDomain   = &quot;FABRIKAM&quot;
strPassword = &quot;ls4k5ywA&quot;
strUser     = &quot;shenalan&quot;
Set objNetwork = CreateObject(&quot;WScript.Network&quot;)
strComputer = objNetwork.ComputerName
Set objComputer = GetObject(&quot;winmgmts:{impersonationLevel=Impersonate}!\\&quot; &amp; strComputer &amp; _
                            &quot;\root\cimv2:Win32_ComputerSystem.Name='&quot; &amp; strComputer &amp; &quot;'&quot;)
ReturnValue = objComputer.JoinDomainOrWorkGroup(strDomain, _
                                                strPassword, _
                                                strDomain &amp; &quot;\&quot; &amp; strUser, _
                                                NULL, _
                                                JOIN_DOMAIN + ACCT_CREATE)
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-computersystem.html"><strong>Win32_ComputerSystem</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="unjoindomainorworkgroup-method-in-class-win32-computersystem.html"><strong>UnjoinDomainOrWorkgroup method</strong></a></p>
<!-- raw HTML omitted -->
</body>
