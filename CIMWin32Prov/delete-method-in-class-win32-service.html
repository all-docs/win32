<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Delete method of the Win32_Service class (CIMWin32 WMI Providers)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Delete method of the Win32_Service class (CIMWin32 WMI Providers) - The Delete&amp;#8194;WMI class method deletes an existing service.
ms.assetid: aa4e7630-3b19-47dd-acd1-4d1735acb819
ms.tgt_platform: multiple
title: Delete method of the Win32_Service class (CIMWin32 WMI Providers)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_Service.Delete
api_type:</li>
<li>COM
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>Delete method of the Win32_Service class (CIMWin32 WMI Providers)</h1>
<p>The <strong>Delete</strong> <a href="/windows/desktop/WmiSdk/retrieving-a-class">WMI class</a> method deletes an existing service.</p>
<p>This topic uses Managed Object Format (MOF) syntax. For more information about using this method, see <a href="/windows/desktop/WmiSdk/calling-a-method">Calling a Method</a>.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 Delete();
</code></pre>
<h2>Parameters</h2>
<p>This method has no parameters.</p>
<h2>Return value</h2>
<p>Returns one of the values listed in the following list or any other value to indicate an error. For additional error codes, see <a href="/windows/desktop/WmiSdk/wmi-error-constants"><strong>WMI Error Constants</strong></a> or <a href="/windows/desktop/api/wbemdisp/ne-wbemdisp-wbemerrorenum"><strong>WbemErrorEnum</strong></a>. For general <strong>HRESULT</strong> values, see <a href="/windows/desktop/Debug/system-error-codes">System Error Codes</a>.</p>
<!-- raw HTML omitted -->
<p><strong>0</strong></p>
<!-- raw HTML omitted -->
<p>The request was accepted.</p>
<!-- raw HTML omitted -->
<p><strong>1</strong></p>
<!-- raw HTML omitted -->
<p>The request is not supported.</p>
<!-- raw HTML omitted -->
<p><strong>2</strong></p>
<!-- raw HTML omitted -->
<p>The user did not have the necessary access.</p>
<!-- raw HTML omitted -->
<p><strong>3</strong></p>
<!-- raw HTML omitted -->
<p>The service cannot be stopped because other services that are running are dependent on it.</p>
<!-- raw HTML omitted -->
<p><strong>4</strong></p>
<!-- raw HTML omitted -->
<p>The requested control code is not valid, or it is unacceptable to the service.</p>
<!-- raw HTML omitted -->
<p><strong>5</strong></p>
<!-- raw HTML omitted -->
<p>The requested control code cannot be sent to the service because the state of the service (<a href="win32-baseservice.html"><strong>Win32_BaseService</strong></a>.<strong>State</strong> property) is equal to 0, 1, or 2.</p>
<!-- raw HTML omitted -->
<p><strong>6</strong></p>
<!-- raw HTML omitted -->
<p>The service has not been started.</p>
<!-- raw HTML omitted -->
<p><strong>7</strong></p>
<!-- raw HTML omitted -->
<p>The service did not respond to the start request in a timely fashion.</p>
<!-- raw HTML omitted -->
<p><strong>8</strong></p>
<!-- raw HTML omitted -->
<p>Unknown failure when starting the service.</p>
<!-- raw HTML omitted -->
<p><strong>9</strong></p>
<!-- raw HTML omitted -->
<p>The directory path to the service executable file was not found.</p>
<!-- raw HTML omitted -->
<p><strong>10</strong></p>
<!-- raw HTML omitted -->
<p>The service is already running.</p>
<!-- raw HTML omitted -->
<p><strong>11</strong></p>
<!-- raw HTML omitted -->
<p>The database to add a new service is locked.</p>
<!-- raw HTML omitted -->
<p><strong>12</strong></p>
<!-- raw HTML omitted -->
<p>A dependency this service relies on has been removed from the system.</p>
<!-- raw HTML omitted -->
<p><strong>13</strong></p>
<!-- raw HTML omitted -->
<p>The service failed to find the service needed from a dependent service.</p>
<!-- raw HTML omitted -->
<p><strong>14</strong></p>
<!-- raw HTML omitted -->
<p>The service has been disabled from the system.</p>
<!-- raw HTML omitted -->
<p><strong>15</strong></p>
<!-- raw HTML omitted -->
<p>The service does not have the correct authentication to run on the system.</p>
<!-- raw HTML omitted -->
<p><strong>16</strong></p>
<!-- raw HTML omitted -->
<p>This service is being removed from the system.</p>
<!-- raw HTML omitted -->
<p><strong>17</strong></p>
<!-- raw HTML omitted -->
<p>The service has no execution thread.</p>
<!-- raw HTML omitted -->
<p><strong>18</strong></p>
<!-- raw HTML omitted -->
<p>The service has circular dependencies when it starts.</p>
<!-- raw HTML omitted -->
<p><strong>19</strong></p>
<!-- raw HTML omitted -->
<p>A service is running under the same name.</p>
<!-- raw HTML omitted -->
<p><strong>20</strong></p>
<!-- raw HTML omitted -->
<p>The service name has invalid characters.</p>
<!-- raw HTML omitted -->
<p><strong>21</strong></p>
<!-- raw HTML omitted -->
<p>Invalid parameters have been passed to the service.</p>
<!-- raw HTML omitted -->
<p><strong>22</strong></p>
<!-- raw HTML omitted -->
<p>The account under which this service runs is either invalid or lacks the permissions to run the service.</p>
<!-- raw HTML omitted -->
<p><strong>23</strong></p>
<!-- raw HTML omitted -->
<p>The service exists in the database of services available from the system.</p>
<!-- raw HTML omitted -->
<p><strong>24</strong></p>
<!-- raw HTML omitted -->
<p>The service is currently paused in the system.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>As your organization changes, you might decide to remove certain services from certain computers. In-house and third-party services can be removed by using WMI, while operating system services can be removed by using Sysocmgr.exe.</p>
<p>When preparing to remove services, keep the following information in mind:</p>
<ul>
<li>
<p>Services must be stopped before you remove them. If the service is running when you issue the delete command, the service is marked for deletion, but it continues to run until it stops and all open handles are closed.</p>
<p>If the service is never stopped, that service will never be deleted.</p>
</li>
<li>
<p>Removing a service does not remove the service's executable file.</p>
<p>Removing a service by using WMI deletes the related registry entries under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services. As a result, the service is no longer installed and is not available through the Services snap-in. However, WMI does not delete the executable file, meaning you could easily reinstall the service. To delete the executable file, you must retrieve the path name and then delete the file.</p>
</li>
<li>
<p>Removing a base Windows 2000 service (for example, DHCP) by using WMI deletes the registry entries for that service but does not remove the shortcut from the Administrative Tools menu or remove the service from the Windows Components Wizard. This can confuse anyone trying to determine how the computer has been configured.</p>
<p>For example, if you remove the DHCP service by using a WMI script, the DHCP service is no longer listed in the Services snap-in. However, a nonfunctioning shortcut to the DHCP console remains in the Administrative Tools menu, and if you start the Windows Component Wizard, it indicates that the DHCP service is installed.</p>
<p>Because of this, you should always use Sysocmgr.exe to programmatically remove Windows 2000 services.</p>
</li>
</ul>
<h2>Examples</h2>
<p>The following VBScript code sample describes how to delete a service.</p>
<pre lang="VB"><code>strComputer = &quot;.&quot;
Set objWMIService = GetObject(&quot;winmgmts:&quot; _
 &amp; &quot;{impersonationLevel=impersonate}!\\&quot; &amp; strComputer &amp; &quot;\root\cimv2&quot;)
Set colListOfServices = objWMIService.ExecQuery _
 (&quot;SELECT * FROM Win32_Service WHERE Name = 'DbService'&quot;)
For Each objService in colListOfServices
 objService.StopService()
 objService.Delete()
Next
</code></pre>
<p>The following Perl code sample describes how to delete a service.</p>
<pre><code>use strict;
use Win32::OLE;

my ($Service, $ServiceSet) ;
eval {$ServiceSet = Win32::OLE-&gt;GetObject(&quot;winmgmts:{impersonationLevel=impersonate}&quot;)-&gt;
 ExecQuery(&quot;SELECT * FROM Win32_Service WHERE Name='MyService'&quot;);};
unless($@)
{
 foreach $Service (in $ServiceSet)
 {
  my $RetVal = $Service-&gt;Delete();
  if ($RetVal == 0)  
  {
   print &quot;Service deleted \n&quot;; 
  }
  else  
  {
   print &quot;Delete failed: %d&quot;, $RetVal;
  }
 }
}
else
{
 print STDERR Win32::OLE-&gt;LastError, &quot;\n&quot;;
}
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/previous-versions//aa392727(v=vs.85)">Operating System Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="win32-service.html"><strong>Win32_Service</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/WmiSdk/wmi-tasks--services">WMI Tasks: Services</a></p>
<!-- raw HTML omitted -->
</body>
