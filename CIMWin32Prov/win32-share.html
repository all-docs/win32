<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Win32_Share class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The Win32_Share class represents a shared resource on a computer system running Windows. This may be a disk drive, printer, interprocess communication, or other sharable device. For more information about retrieving WMI classes, see Retrieving a Class.
ms.assetid: 2d47b726-a0fe-47f3-9e96-d1d507655e56
ms.tgt_platform: multiple
title: Win32_Share class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_Share</li>
<li>Win32_Share.Caption</li>
<li>Win32_Share.Description</li>
<li>Win32_Share.InstallDate</li>
<li>Win32_Share.Status</li>
<li>Win32_Share.AccessMask</li>
<li>Win32_Share.AllowMaximum</li>
<li>Win32_Share.MaximumAllowed</li>
<li>Win32_Share.Name</li>
<li>Win32_Share.Path</li>
<li>Win32_Share.Type
api_type:</li>
<li>DllExport
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>Win32_Share class</h1>
<p>The <strong>Win32_Share</strong> class represents a shared resource on a computer system running Windows. This may be a disk drive, printer, interprocess communication, or other sharable device. For more information about retrieving WMI classes, see <a href="../wmisdk/retrieving-a-class.html">Retrieving a Class</a>.</p>
<p>The following syntax is simplified from Managed Object Format (MOF) code and includes all of the inherited properties. Properties and methods are in alphabetic order, not MOF order.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[Dynamic, Provider(&quot;CIMWin32&quot;), UUID(&quot;{8502C4D6-5FBB-11D2-AAC1-006008C78BC7}&quot;), SupportsCreate, CreateBy(&quot;Create&quot;), SupportsDelete, DeleteBy(&quot;DeleteInstance&quot;), AMENDMENT]
class Win32_Share : CIM_LogicalElement
{
  stringÂ Â  Caption;
  stringÂ Â  Description;
  datetime InstallDate;
  stringÂ Â  Status;
  uint32Â Â  AccessMask;
  booleanÂ  AllowMaximum;
  uint32Â Â  MaximumAllowed;
  stringÂ Â  Name;
  stringÂ Â  Path;
  uint32Â Â  Type;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>Win32_Share</strong> class has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>Win32_Share</strong> class has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="create-method-in-class-win32-share.html"><strong>Create</strong></a></td>
<td align="left">Class method that initiates sharing for a server resource.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="delete-method-in-class-win32-share.html"><strong>Delete</strong></a></td>
<td align="left">Class method that deletes a share name from a server's list of shared resources, disconnecting connections to the shared resource.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="getaccessmask-method-in-class-win32-share.html"><strong>GetAccessMask</strong></a></td>
<td align="left">Returns the access rights to the share held by the user or group on whose behalf the instance is returned. You should use this method in place of the <strong>AccessMask</strong> property, which is always <strong>NULL</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="setshareinfo-method-in-class-win32-share.html"><strong>SetShareInfo</strong></a></td>
<td align="left">Class method that sets the parameters of a shared resource.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Properties</h3>
<p>The <strong>Win32_Share</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>AccessMask</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-wmi-qualifiers.html"><strong>DEPRECATED</strong></a></p>
<!-- raw HTML omitted -->
<p>This property is obsolete and is no longer used. Use the <a href="getaccessmask-method-in-class-win32-share.html"><strong>Win32_Share.GetAccessMask</strong></a> method instead. The value of the <strong>AccessMask</strong> property is set to <strong>null</strong> by WMI. For more information about setting access when a share is created, see the <a href="create-method-in-class-win32-share.html"><strong>Create</strong></a> method.</p>
<!-- raw HTML omitted -->
<p><strong>AllowMaximum</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;Win32API|Network Management Structures|<a href="/windows/win32/api/lmshare/ns-lmshare-share_info_502"><strong>SHARE_INFO_502</strong></a>|shi502_max_uses&quot;)</p>
<!-- raw HTML omitted -->
<p>Number of concurrent users for this resource has been limited. If <strong>True</strong>, the value in the <strong>MaximumAllowed</strong> property is ignored.</p>
<!-- raw HTML omitted -->
<p><strong>Caption</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>MaxLen</strong></a> (64), <a href="../wmisdk/standard-qualifiers.html"><strong>DisplayName</strong></a> (&quot;Caption&quot;)</p>
<!-- raw HTML omitted -->
<p>A short textual description of the object.</p>
<p>This property is inherited from <a href="cim-managedsystemelement.html"><strong>CIM_ManagedSystemElement</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>Description</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>DisplayName</strong></a> (&quot;Description&quot;)</p>
<!-- raw HTML omitted -->
<p>A textual description of the object.</p>
<p>This property is inherited from <a href="cim-managedsystemelement.html"><strong>CIM_ManagedSystemElement</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>InstallDate</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>datetime</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;MIF.DMTF|ComponentID|001.5&quot;), <a href="../wmisdk/standard-qualifiers.html"><strong>DisplayName</strong></a> (&quot;Install Date&quot;)</p>
<!-- raw HTML omitted -->
<p>Indicates when the object was installed. Lack of a value does not indicate that the object is not installed.</p>
<p>This property is inherited from <a href="cim-managedsystemelement.html"><strong>CIM_ManagedSystemElement</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>MaximumAllowed</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;Win32API|Network Management Structures|<a href="/windows/win32/api/lmshare/ns-lmshare-share_info_502"><strong>SHARE_INFO_502</strong></a>|shi502_max_uses&quot;)</p>
<!-- raw HTML omitted -->
<p>Limit on the maximum number of users allowed to use this resource concurrently. The value is only valid if the <strong>AllowMaximum</strong> property is set to <strong>FALSE</strong>.</p>
<!-- raw HTML omitted -->
<p><strong>Name</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/key-qualifier.html"><strong>key</strong></a>, <a href="../wmisdk/standard-qualifiers.html"><strong>Override</strong></a> (&quot;Name&quot;), <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;Win32API|Network Management Structures|<a href="/windows/win32/api/lmshare/ns-lmshare-share_info_1"><strong>SHARE_INFO_1</strong></a>|shi1_netname&quot;)</p>
<!-- raw HTML omitted -->
<p>Alias given to a path set up as a share on a computer system running Windows.</p>
<p>Windows 2008 example: &quot;\SERVER01\public&quot; - Windows Server 2008 requires that you place the UNC in the name.</p>
<!-- raw HTML omitted -->
<p><strong>Path</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;Win32API|Network Management Structures|<a href="/windows/win32/api/lmshare/ns-lmshare-share_info_502"><strong>SHARE_INFO_502</strong></a>|shi502_path&quot;)</p>
<!-- raw HTML omitted -->
<p>Local path of the Windows share.</p>
<p>Example: &quot;C:\Program Files&quot;</p>
<!-- raw HTML omitted -->
<p><strong>Status</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>MaxLen</strong></a> (10), <a href="../wmisdk/standard-qualifiers.html"><strong>DisplayName</strong></a> (&quot;Status&quot;)</p>
<!-- raw HTML omitted -->
<p>String that indicates the current status of the object. Operational and non-operational status can be defined. Operational status can include &quot;OK&quot;, &quot;Degraded&quot;, and &quot;Pred Fail&quot;. &quot;Pred Fail&quot; indicates that an element is functioning properly, but is predicting a failure (for example, a SMART-enabled hard disk drive).</p>
<p>Non-operational status can include &quot;Error&quot;, &quot;Starting&quot;, &quot;Stopping&quot;, and &quot;Service&quot;. &quot;Service&quot; can apply during disk mirror-resilvering, reloading a user permissions list, or other administrative work. Not all such work is online, but the managed element is neither &quot;OK&quot; nor in one of the other states.</p>
<p>This property is inherited from <a href="cim-managedsystemelement.html"><strong>CIM_ManagedSystemElement</strong></a>.</p>
<p>Values include the following:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>OK</strong> (&quot;OK&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Error</strong> (&quot;Error&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Degraded</strong> (&quot;Degraded&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Unknown</strong> (&quot;Unknown&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Pred Fail</strong> (&quot;Pred Fail&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Starting</strong> (&quot;Starting&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Stopping</strong> (&quot;Stopping&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Service</strong> (&quot;Service&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Stressed</strong> (&quot;Stressed&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>NonRecover</strong> (&quot;NonRecover&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>No Contact</strong> (&quot;No Contact&quot;)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Lost Comm</strong> (&quot;Lost Comm&quot;)</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>Type</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="../wmisdk/standard-qualifiers.html"><strong>MappingStrings</strong></a> (&quot;Win32API|Network Management Structures|<a href="/windows/win32/api/lmshare/ns-lmshare-share_info_502"><strong>SHARE_INFO_502</strong></a>|shi502_type&quot;)</p>
<!-- raw HTML omitted -->
<p>Type of resource being shared. Types include: disk drives, print queues, interprocess communications (IPC), and general devices.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Disk Drive</strong> (0)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Print Queue</strong> (1)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Device</strong> (2)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>IPC</strong> (3)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Disk Drive Admin</strong> (2147483648)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Print Queue Admin</strong> (2147483649)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Device Admin</strong> (2147483650)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>IPC Admin</strong> (2147483651)</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The <strong>Win32_Share</strong> class is derived from <a href="cim-logicalelement.html"><strong>CIM_LogicalElement</strong></a>.</p>
<p>The Create method in this class is a static method. The <strong>Delete</strong>, <strong>GetAccessMask</strong> and <strong>SetShareInfo</strong> methods are all instance methods.</p>
<p>Depending on your security permissions, you may not be able to retrieve all of the properties of this class. For example, <strong>AllowMaximum</strong>, <strong>MaximumAllowed</strong>, <strong>Path</strong>, and <strong>Type</strong> properties may return null. Generally speaking, Power Users and Administrators will be able to retrieve all property values.</p>
<h2>Examples</h2>
<p>The following PowerShell sample displays the shares on the local system.</p>
<pre lang="PowerShell"><code>$shares = Get-WMIObject -class Win32_share
&quot;Shares on : {0}&quot; -f $((gwmi win32_computersystem).name)
$shares | sort name | ft -auto
</code></pre>
<p>Alternately, if you wish to filter more precisely, you can use the following PowerShell snippet:</p>
<pre lang="PowerShell"><code>gwmi -q &quot;SELECT * FROM Win32_Share WHERE Name != 'ADMIN$' AND Name != 'IPC$'&quot;
</code></pre>
<p>The Following VBScript sample displays the shares on the local system.</p>
<pre lang="VB"><code>strComputer = &quot;.&quot; 
Set objWMIService = GetObject(&quot;winmgmts:\\&quot; &amp; strComputer &amp; &quot;\root\CIMV2&quot;) 
Set colItems = objWMIService.ExecQuery(&quot;SELECT * FROM Win32_Share&quot;)


For Each objItem in colItems 
 Wscript.Echo &quot;Name: &quot; &amp; objItem.Name
 Wscript.Echo &quot;Caption: &quot; &amp; objItem.Caption &amp; &quot;=&quot; &amp; objItem.Path
Next
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cim-logicalelement.html"><strong>CIM_LogicalElement</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="./operating-system-classes.html">Operating System Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="../wmisdk/wmi-tasks--files-and-folders.html">WMI Tasks: Files and Folders</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
