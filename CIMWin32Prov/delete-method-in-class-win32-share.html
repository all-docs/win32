<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Delete method of the Win32_Share class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Deletes a share name from a server's list of shared resources, disconnecting connections to the shared resource.
ms.assetid: 175f9c0e-0017-4a86-8e05-ad78e2c93c11
ms.tgt_platform: multiple
title: Delete method of the Win32_Share class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_Share.Delete
api_type:</li>
<li>COM
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>Delete method of the Win32_Share class</h1>
<p>The <strong>Delete</strong> <a href="/windows/desktop/WmiSdk/retrieving-a-class">WMI class</a> method deletes a share name from a server's list of shared resources, disconnecting connections to the shared resource.</p>
<p>This topic uses Managed Object Format (MOF) syntax. For more information about using this method, see <a href="/windows/desktop/WmiSdk/calling-a-method">Calling a Method</a>.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 Delete();
</code></pre>
<h2>Parameters</h2>
<p>This method has no parameters.</p>
<h2>Return value</h2>
<p>Returns one of the values listed in the following list, or any other value to indicate an error. For additional error codes, see <a href="/windows/desktop/WmiSdk/wmi-error-constants"><strong>WMI Error Constants</strong></a> or <a href="/windows/desktop/api/wbemdisp/ne-wbemdisp-wbemerrorenum"><strong>WbemErrorEnum</strong></a>. For general <strong>HRESULT</strong> values, see <a href="/windows/desktop/Debug/system-error-codes">System Error Codes</a>.</p>
<!-- raw HTML omitted -->
<p><strong>Success</strong> (0)</p>
<!-- raw HTML omitted -->
<p><strong>Access denied</strong> (2)</p>
<!-- raw HTML omitted -->
<p><strong>Unknown failure</strong> (8)</p>
<!-- raw HTML omitted -->
<p><strong>Invalid name</strong> (9)</p>
<!-- raw HTML omitted -->
<p><strong>Invalid level</strong> (10)</p>
<!-- raw HTML omitted -->
<p><strong>Invalid parameter</strong> (21)</p>
<!-- raw HTML omitted -->
<p><strong>Duplicate share</strong> (22)</p>
<!-- raw HTML omitted -->
<p><strong>Redirected path</strong> (23)</p>
<!-- raw HTML omitted -->
<p><strong>Unknown device or directory</strong> (24)</p>
<!-- raw HTML omitted -->
<p><strong>Net name not found</strong> (25)</p>
<!-- raw HTML omitted -->
<p><strong>Other</strong> (26 4294967295)</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The <strong>Delete</strong> method is an object method and is used on an instance of a class.</p>
<p>Only members of the Administrators or Account Operators local group or those with Communication, Print, or Server operator group membership can successfully execute the method. The Print operator can delete only printer queues. The Communication operator can delete only communication-device queues.</p>
<h2>Examples</h2>
<p>The following VBScript code sample deletes the specified share.</p>
<pre lang="VB"><code>On Error Resume Next

ComputerName = InputBox(&quot;Enter the computer name:&quot;, &quot;Delete Share&quot;, &quot;localhost&quot;)

SName = InputBox(&quot;Enter the name of the share:&quot;, &quot;Delete Share&quot;)



Set Shares = GetObject(&quot;winmgmts:\\&quot; &amp; ComputerName &amp; _
 &quot;\root\cimv2&quot;).ExecQuery(&quot;SELECT * FROM Win32_Share WHERE name = '&quot; &amp; SName &amp; &quot;'&quot;)



For Each Share in Shares
 Share.Delete()
Next
</code></pre>
<p>The following PowerShell code sample deletes blank shares.</p>
<pre lang="PowerShell"><code>$Shares = Get-WMIObject Win32_Share | Where {$_.Name -eq &quot;&quot;}

Foreach ($Share in $Shares) {
   $Share.Delete()
}
&quot;{0} blank shares found and removed&quot; -f $shares.count
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/previous-versions//aa392727(v=vs.85)">Operating System Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="win32-share.html"><strong>Win32_Share</strong></a></p>
<!-- raw HTML omitted -->
</body>
