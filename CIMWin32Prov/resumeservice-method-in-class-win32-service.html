<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ResumeService method of the Win32_Service class (CIMWin32 WMI Providers)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: ResumeService method of the Win32_Service class (CIMWin32 WMI Providers) - Attempts to place the referenced service in the resumed state.
ms.assetid: 3b4228bf-9ff5-44ab-bfe2-f7dd8fb62007
ms.tgt_platform: multiple
title: ResumeService method of the Win32_Service class (CIMWin32 WMI Providers)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_Service.ResumeService
api_type:</li>
<li>COM
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>ResumeService method of the Win32_Service class (CIMWin32 WMI Providers)</h1>
<p>The <strong>ResumeService</strong> <a href="/windows/desktop/WmiSdk/retrieving-a-class">WMI class</a> method attempts to place the referenced service in the resumed state.</p>
<p>This topic uses Managed Object Format (MOF) syntax. For more information about using this method, see <a href="/windows/desktop/WmiSdk/calling-a-method">Calling a Method</a>.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 ResumeService();
</code></pre>
<h2>Parameters</h2>
<p>This method has no parameters.</p>
<h2>Return value</h2>
<p>Returns one of the values listed in the following list, or any other value to indicate an error. For additional error codes, see <a href="/windows/desktop/WmiSdk/wmi-error-constants"><strong>WMI Error Constants</strong></a> or <a href="/windows/desktop/api/wbemdisp/ne-wbemdisp-wbemerrorenum"><strong>WbemErrorEnum</strong></a>. For general <strong>HRESULT</strong> values, see <a href="/windows/desktop/Debug/system-error-codes">System Error Codes</a>.</p>
<!-- raw HTML omitted -->
<p><strong>0</strong></p>
<!-- raw HTML omitted -->
<p>The request was accepted.</p>
<!-- raw HTML omitted -->
<p><strong>1</strong></p>
<!-- raw HTML omitted -->
<p>The request is not supported.</p>
<!-- raw HTML omitted -->
<p><strong>2</strong></p>
<!-- raw HTML omitted -->
<p>The user did not have the necessary access.</p>
<!-- raw HTML omitted -->
<p><strong>3</strong></p>
<!-- raw HTML omitted -->
<p>The service cannot be stopped because other services that are running are dependent on it.</p>
<!-- raw HTML omitted -->
<p><strong>4</strong></p>
<!-- raw HTML omitted -->
<p>The requested control code is not valid, or it is unacceptable to the service.</p>
<!-- raw HTML omitted -->
<p><strong>5</strong></p>
<!-- raw HTML omitted -->
<p>The requested control code cannot be sent to the service because the state of the service (<a href="win32-baseservice.html"><strong>Win32_BaseService</strong></a>.<strong>State</strong> property) is equal to 0, 1, or 2.</p>
<!-- raw HTML omitted -->
<p><strong>6</strong></p>
<!-- raw HTML omitted -->
<p>The service has not been started.</p>
<!-- raw HTML omitted -->
<p><strong>7</strong></p>
<!-- raw HTML omitted -->
<p>The service did not respond to the start request in a timely fashion.</p>
<!-- raw HTML omitted -->
<p><strong>8</strong></p>
<!-- raw HTML omitted -->
<p>Unknown failure when starting the service.</p>
<!-- raw HTML omitted -->
<p><strong>9</strong></p>
<!-- raw HTML omitted -->
<p>The directory path to the service executable file was not found.</p>
<!-- raw HTML omitted -->
<p><strong>10</strong></p>
<!-- raw HTML omitted -->
<p>The service is already running.</p>
<!-- raw HTML omitted -->
<p><strong>11</strong></p>
<!-- raw HTML omitted -->
<p>The database to add a new service is locked.</p>
<!-- raw HTML omitted -->
<p><strong>12</strong></p>
<!-- raw HTML omitted -->
<p>A dependency this service relies on has been removed from the system.</p>
<!-- raw HTML omitted -->
<p><strong>13</strong></p>
<!-- raw HTML omitted -->
<p>The service failed to find the service needed from a dependent service.</p>
<!-- raw HTML omitted -->
<p><strong>14</strong></p>
<!-- raw HTML omitted -->
<p>The service has been disabled from the system.</p>
<!-- raw HTML omitted -->
<p><strong>15</strong></p>
<!-- raw HTML omitted -->
<p>The service does not have the correct authentication to run on the system.</p>
<!-- raw HTML omitted -->
<p><strong>16</strong></p>
<!-- raw HTML omitted -->
<p>This service is being removed from the system.</p>
<!-- raw HTML omitted -->
<p><strong>17</strong></p>
<!-- raw HTML omitted -->
<p>The service has no execution thread.</p>
<!-- raw HTML omitted -->
<p><strong>18</strong></p>
<!-- raw HTML omitted -->
<p>The service has circular dependencies when it starts.</p>
<!-- raw HTML omitted -->
<p><strong>19</strong></p>
<!-- raw HTML omitted -->
<p>A service is running under the same name.</p>
<!-- raw HTML omitted -->
<p><strong>20</strong></p>
<!-- raw HTML omitted -->
<p>The service name has invalid characters.</p>
<!-- raw HTML omitted -->
<p><strong>21</strong></p>
<!-- raw HTML omitted -->
<p>Invalid parameters have been passed to the service.</p>
<!-- raw HTML omitted -->
<p><strong>22</strong></p>
<!-- raw HTML omitted -->
<p>The account under which this service runs is either invalid or lacks the permissions to run the service.</p>
<!-- raw HTML omitted -->
<p><strong>23</strong></p>
<!-- raw HTML omitted -->
<p>The service exists in the database of services available from the system.</p>
<!-- raw HTML omitted -->
<p><strong>24</strong></p>
<!-- raw HTML omitted -->
<p>The service is currently paused in the system.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>Although there might appear to be no practical difference between a service that is stopped and a service that is paused, the two states appear differently to the SCM. A stopped service is a service that is not running and must go through the entire service start procedure. A paused service, however, is still running but has had its functioning is suspended. Because of this, a paused service does not need to go through the entire service start procedure but needs a different procedure to resume functioning.</p>
<p>You must use the proper method to start a service that has been stopped or to resume a service that has been paused. The <a href="win32-service.html"><strong>Win32_Service</strong></a> methods <a href="startservice-method-in-class-win32-service.html"><strong>StartService</strong></a> and <strong>ResumeService</strong> should be used in the following situations:</p>
<ul>
<li>If a service is currently stopped, you must use the <a href="startservice-method-in-class-win32-service.html"><strong>StartService</strong></a> method to restart it; <strong>ResumeService</strong> cannot start a service that is currently stopped.</li>
<li>If a service is paused, you must use <strong>ResumeService</strong>. If you use the <a href="startservice-method-in-class-win32-service.html"><strong>StartService</strong></a> method on a paused service, you receive the message, &quot;The service is already running.&quot; However, the service remains paused until the resume service control code is sent to it.</li>
</ul>
<h2>Examples</h2>
<p>The following VBScript code sample describes how to resume a paused service from instances of <a href="win32-service.html"><strong>Win32_Service</strong></a>.</p>
<blockquote>
<p>[!Note]<br />
The service must support pausing and be running already.</p>
</blockquote>
<pre lang="VB"><code>Set ServiceSet = GetObject(&quot;winmgmts:&quot;).ExecQuery(&quot;select * from Win32_Service where Name='Schedule'&quot;)

for each Service in ServiceSet
 SupportsPause = Service.AcceptPause
 if SupportsPause = true then
  RetVal = Service.ResumeService()
  if RetVal = 0 then 
   WScript.Echo &quot;Service resumed&quot;   
  else
   if RetVal = 1 then 
    WScript.Echo &quot;Pause not supported&quot; 
   else WScript.Echo &quot;An error occurred:&quot; &amp; RetVal
   End If
  End If
 else
  WScript.Echo &quot;Service does not support pause&quot;
 end if
next
</code></pre>
<p>The following Perl code sample describes how to resume a paused service from instances of <a href="win32-service.html"><strong>Win32_Service</strong></a>.</p>
<blockquote>
<p>[!Note]<br />
The service must support pausing and be running already.</p>
</blockquote>
<pre lang="Perl"><code>use strict;
use Win32::OLE;

my $ServiceSet;

eval { $ServiceSet = Win32::OLE-&gt;GetObject(&quot;winmgmts:{impersonationLevel=impersonate}!\\\\.\\Root\\CIMv2&quot;)-&gt;
 ExecQuery(&quot;SELECT * FROM Win32_Service WHERE Name='Schedule'&quot;); };

if (!$@ &amp;&amp; defined $ServiceSet)
{
 foreach my $Service (in $ServiceSet)
 {
  my $SupportsPause = $Service-&gt;{AcceptPause};
  if ($SupportsPause)
  {
   my $RetVal = $Service-&gt;ResumeService();
   if ($RetVal == 0)
   {
    print &quot;\nService resumed\n&quot;;
   }
   else
   {
    if ($RetVal == 1)
    {
     print STDERR &quot;\nPause not supported\n&quot;;
    }
    else
    {
     print STDERR &quot;\nAn error occurred: &quot;, $RetVal, &quot;\n&quot;;
    }
   }
  }
  else
  {
   print &quot;\nService does not support pause\n&quot;;
  }
 }
}
else
{
 print STDERR Win32::OLE-&gt;LastError, &quot;\n&quot;;
}
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMv2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/previous-versions//aa392727(v=vs.85)">Operating System Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="win32-service.html"><strong>Win32_Service</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/WmiSdk/wmi-tasks--services">WMI Tasks: Services</a></p>
<!-- raw HTML omitted -->
</body>
