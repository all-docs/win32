<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GetAccessMask method of the Win32_Share class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: GetAccessMask method of the Win32_Share class - Returns a uint32 bitmap with the access rights to the share held by the user or group on whose behalf the instance is returned.
ms.assetid: 234f44a4-ffff-431d-a973-98f2bd313c7d
ms.tgt_platform: multiple
title: GetAccessMask method of the Win32_Share class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Win32_Share.GetAccessMask
api_type:</li>
<li>COM
api_location:</li>
<li>CIMWin32.dll</li>
</ul>
<hr />
<h1>GetAccessMask method of the Win32_Share class</h1>
<p>The <strong>GetAccessMask</strong> method returns a uint32 bitmap with the access rights to the share held by the user or group on whose behalf the instance is returned.</p>
<p>This topic uses Managed Object Format (MOF) syntax. For more information about using this method, see <a href="/windows/desktop/WmiSdk/calling-a-method">Calling a Method</a>.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 GetAccessMask();
</code></pre>
<h2>Parameters</h2>
<p>This method has no parameters.</p>
<h2>Return value</h2>
<p>Access rights to the share held by the user or group.</p>
<!-- raw HTML omitted -->
<p><strong>FILE_LIST_DIRECTORY</strong></p>
<!-- raw HTML omitted -->
<p>1 (0x1)</p>
<p>Grants the right to read data from the file. For a directory, this value grants the right to list the contents of the directory.</p>
<!-- raw HTML omitted -->
<p><strong>FILE_ADD_FILE</strong></p>
<!-- raw HTML omitted -->
<p>2 (0x2)</p>
<p>Grants the right to write data to the file. For a directory, this value grants the right to create a file in the directory.</p>
<!-- raw HTML omitted -->
<p><strong>FILE_ADD_SUBDIRECTORY</strong></p>
<!-- raw HTML omitted -->
<p>4 (0x4)</p>
<p>Grants the right to append data to the file. For a directory, this value grants the right to create a subdirectory.</p>
<!-- raw HTML omitted -->
<p><strong>FILE_READ_EA</strong></p>
<!-- raw HTML omitted -->
<p>8 (0x8)</p>
<p>Grants the right to read extended attributes.</p>
<!-- raw HTML omitted -->
<p><strong>FILE_WRITE_EA</strong></p>
<!-- raw HTML omitted -->
<p>16 (0x10)</p>
<p>Grants the right to write extended attributes.</p>
<!-- raw HTML omitted -->
<p><strong>FILE_TRAVERSE</strong></p>
<!-- raw HTML omitted -->
<p>32 (0x20)</p>
<p>Grants the right to execute a file. For a directory, the directory can be traversed.</p>
<!-- raw HTML omitted -->
<p><strong>FILE_DELETE_CHILD</strong></p>
<!-- raw HTML omitted -->
<p>64 (0x40)</p>
<p>Grants the right to delete a directory and all of the files it contains (its children), even if the files are read-only.</p>
<!-- raw HTML omitted -->
<p><strong>FILE_READ_ATTRIBUTES</strong></p>
<!-- raw HTML omitted -->
<p>128 (0x80)</p>
<p>Grants the right to read file attributes.</p>
<!-- raw HTML omitted -->
<p><strong>FILE_WRITE_ATTRIBUTES</strong></p>
<!-- raw HTML omitted -->
<p>256 (0x100)</p>
<p>Grants the right to change file attributes.</p>
<!-- raw HTML omitted -->
<p><strong>DELETE</strong></p>
<!-- raw HTML omitted -->
<p>65536 (0x10000)</p>
<p>Grants delete access.</p>
<!-- raw HTML omitted -->
<p><strong>READ_CONTROL</strong></p>
<!-- raw HTML omitted -->
<p>131072 (0x20000)</p>
<p>Grants read access to the security descriptor and owner.</p>
<!-- raw HTML omitted -->
<p><strong>WRITE_DAC</strong></p>
<!-- raw HTML omitted -->
<p>262144 (0x40000)</p>
<p>Grants write access to the discretionary access control list (DACL).</p>
<!-- raw HTML omitted -->
<p><strong>WRITE_OWNER</strong></p>
<!-- raw HTML omitted -->
<p>524288 (0x80000)</p>
<p>Assigns the write owner.</p>
<!-- raw HTML omitted -->
<p><strong>SYNCHRONIZE</strong></p>
<!-- raw HTML omitted -->
<p>1048576 (0x100000)</p>
<p>Synchronizes access and allows a process to wait for an object to enter the signaled state.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p><strong>GetAccessMask</strong> method is an object method and is used on an occurrence of this class.</p>
<h2>Examples</h2>
<p>The following VBScript code example creates a share folder and then gets the value of the access mask in the security descriptor that secures the share folder.</p>
<pre lang="VB"><code>Const FILE_SHARE = 0
Const MAXIMUM_CONNECTIONS = 4000 
strComputer = &quot;.&quot;

Set objWMIService = GetObject(&quot;winmgmts:{impersonationLevel=impersonate}!\\&quot; &amp; strComputer &amp; &quot;\root\cimv2&quot;)
Set objNewShare = objWMIService.Get(&quot;Win32_Share&quot;)
Return = objNewShare.Create (&quot;C:\Temp&quot;, &quot;TestShare&quot;, FILE_SHARE, MAXIMUM_CONNECTIONS, &quot;test share&quot;)

If Return &lt;&gt; 0 Then
          WScript.Echo Return
          WScript.Quit
End If

Set objShare = objWMIService.Get(&quot;Win32_Share.Name='TestShare'&quot;)
Return = objShare.GetAccessMask
WScript.Echo Return
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMV2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CIMWin32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-share.html"><strong>Win32_Share</strong></a></p>
<!-- raw HTML omitted -->
</body>
