<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DS-Heuristics attribute</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: DS-Heuristics attribute
description: Contains global settings for the entire forest.
ms.assetid: d5fd990b-7bbf-4ede-a3af-7f3f7ac959b3
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>DS-Heuristics attribute AD Schema</li>
<li>dSHeuristics attribute AD Schema
topic_type:</li>
<li>apiref
api_name:</li>
<li>DS-Heuristics
api_type:</li>
<li>Schema
ms.topic: reference
ms.date: 09/05/2024</li>
</ul>
<hr />
<h1>DS-Heuristics attribute</h1>
<p>Contains global settings for the entire forest.</p>
<p>There is information about adminSDholder exclusion bits available on the Microsoft Support article, <a href="https://support.microsoft.com/topic/delegated-permissions-are-not-available-and-inheritance-is-automatically-disabled-56a70fa8-6d17-35ac-0f2c-87ec14b61980">Delegated permissions are not available and inheritance is automatically disabled</a>.</p>
<table>
<thead>
<tr>
<th>Entry</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>CN</td>
<td>DS-Heuristics</td>
</tr>
<tr>
<td>Ldap-Display-Name</td>
<td>dSHeuristics</td>
</tr>
<tr>
<td>Size</td>
<td>-</td>
</tr>
<tr>
<td>Update Privilege</td>
<td>-</td>
</tr>
<tr>
<td>Update Frequency</td>
<td>-</td>
</tr>
<tr>
<td>Attribute-Id</td>
<td>1.2.840.113556.1.2.212</td>
</tr>
<tr>
<td>System-Id-Guid</td>
<td>f0f8ff86-1191-11d0-a060-00aa006c33ed</td>
</tr>
<tr>
<td>Syntax</td>
<td><a href="s-string-unicode.html"><strong>String(Unicode)</strong></a></td>
</tr>
</tbody>
</table>
<h2>Implementations</h2>
<ul>
<li><a href="#windows-2000-server"><strong>Windows 2000 Server</strong></a></li>
<li><a href="#windows-server-2003"><strong>Windows Server 2003</strong></a></li>
<li><a href="#adam"><strong>ADAM</strong></a></li>
<li><a href="#windows-server-2003-r2"><strong>Windows Server 2003 R2</strong></a></li>
<li><a href="#windows-server-2008"><strong>Windows Server 2008</strong></a></li>
<li><a href="#windows-server-2008-r2"><strong>Windows Server 2008 R2</strong></a></li>
<li><a href="#windows-server-2012"><strong>Windows Server 2012</strong></a></li>
</ul>
<h2>Windows 2000 Server</h2>
<table>
<thead>
<tr>
<th>Entry</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Link-Id</td>
<td>-</td>
</tr>
<tr>
<td>MAPI-Id</td>
<td>-</td>
</tr>
<tr>
<td>System-Only</td>
<td>False</td>
</tr>
<tr>
<td>Is-Single-Valued</td>
<td>True</td>
</tr>
<tr>
<td>Is Indexed</td>
<td>False</td>
</tr>
<tr>
<td>In Global Catalog</td>
<td>False</td>
</tr>
<tr>
<td>NT-Security-Descriptor</td>
<td>O:BAG:BAD:S:</td>
</tr>
<tr>
<td>Range-Lower</td>
<td>-</td>
</tr>
<tr>
<td>Range-Upper</td>
<td>-</td>
</tr>
<tr>
<td>Search-Flags</td>
<td>0x00000000</td>
</tr>
<tr>
<td>System-Flags</td>
<td>0x00000010</td>
</tr>
<tr>
<td>Classes used in</td>
<td><a href="c-ntdsservice.html">NTDS-Service</a></td>
</tr>
</tbody>
</table>
<h2>Windows Server 2003</h2>
<table>
<thead>
<tr>
<th>Entry</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Link-Id</td>
<td>-</td>
</tr>
<tr>
<td>MAPI-Id</td>
<td>-</td>
</tr>
<tr>
<td>System-Only</td>
<td>False</td>
</tr>
<tr>
<td>Is-Single-Valued</td>
<td>True</td>
</tr>
<tr>
<td>Is Indexed</td>
<td>False</td>
</tr>
<tr>
<td>In Global Catalog</td>
<td>False</td>
</tr>
<tr>
<td>NT-Security-Descriptor</td>
<td>O:BAG:BAD:S:</td>
</tr>
<tr>
<td>Range-Lower</td>
<td>-</td>
</tr>
<tr>
<td>Range-Upper</td>
<td>-</td>
</tr>
<tr>
<td>Search-Flags</td>
<td>0x00000000</td>
</tr>
<tr>
<td>System-Flags</td>
<td>0x00000010</td>
</tr>
<tr>
<td>Classes used in</td>
<td><a href="c-ntdsservice.html">NTDS-Service</a></td>
</tr>
</tbody>
</table>
<h2>ADAM</h2>
<table>
<thead>
<tr>
<th>Entry</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Link-Id</td>
<td>-</td>
</tr>
<tr>
<td>MAPI-Id</td>
<td>-</td>
</tr>
<tr>
<td>System-Only</td>
<td>False</td>
</tr>
<tr>
<td>Is-Single-Valued</td>
<td>True</td>
</tr>
<tr>
<td>Is Indexed</td>
<td>False</td>
</tr>
<tr>
<td>In Global Catalog</td>
<td>False</td>
</tr>
<tr>
<td>NT-Security-Descriptor</td>
<td>O:BAG:BAD:S:</td>
</tr>
<tr>
<td>Range-Lower</td>
<td>-</td>
</tr>
<tr>
<td>Range-Upper</td>
<td>-</td>
</tr>
<tr>
<td>Search-Flags</td>
<td>0x00000000</td>
</tr>
<tr>
<td>System-Flags</td>
<td>0x00000010</td>
</tr>
<tr>
<td>Classes used in</td>
<td><a href="c-ntdsservice.html">NTDS-Service</a></td>
</tr>
</tbody>
</table>
<h2>Windows Server 2003 R2</h2>
<table>
<thead>
<tr>
<th>Entry</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Link-Id</td>
<td>-</td>
</tr>
<tr>
<td>MAPI-Id</td>
<td>-</td>
</tr>
<tr>
<td>System-Only</td>
<td>False</td>
</tr>
<tr>
<td>Is-Single-Valued</td>
<td>True</td>
</tr>
<tr>
<td>Is Indexed</td>
<td>False</td>
</tr>
<tr>
<td>In Global Catalog</td>
<td>False</td>
</tr>
<tr>
<td>NT-Security-Descriptor</td>
<td>O:BAG:BAD:S:</td>
</tr>
<tr>
<td>Range-Lower</td>
<td>-</td>
</tr>
<tr>
<td>Range-Upper</td>
<td>-</td>
</tr>
<tr>
<td>Search-Flags</td>
<td>0x00000000</td>
</tr>
<tr>
<td>System-Flags</td>
<td>0x00000010</td>
</tr>
<tr>
<td>Classes used in</td>
<td><a href="c-ntdsservice.html">NTDS-Service</a></td>
</tr>
</tbody>
</table>
<h2>Windows Server 2008</h2>
<table>
<thead>
<tr>
<th>Entry</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Link-Id</td>
<td>-</td>
</tr>
<tr>
<td>MAPI-Id</td>
<td>-</td>
</tr>
<tr>
<td>System-Only</td>
<td>False</td>
</tr>
<tr>
<td>Is-Single-Valued</td>
<td>True</td>
</tr>
<tr>
<td>Is Indexed</td>
<td>False</td>
</tr>
<tr>
<td>In Global Catalog</td>
<td>False</td>
</tr>
<tr>
<td>NT-Security-Descriptor</td>
<td>O:BAG:BAD:S:</td>
</tr>
<tr>
<td>Range-Lower</td>
<td>-</td>
</tr>
<tr>
<td>Range-Upper</td>
<td>-</td>
</tr>
<tr>
<td>Search-Flags</td>
<td>0x00000000</td>
</tr>
<tr>
<td>System-Flags</td>
<td>0x00000010</td>
</tr>
<tr>
<td>Classes used in</td>
<td><a href="c-ntdsservice.html">NTDS-Service</a></td>
</tr>
</tbody>
</table>
<h2>Windows Server 2008 R2</h2>
<table>
<thead>
<tr>
<th>Entry</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Link-Id</td>
<td>-</td>
</tr>
<tr>
<td>MAPI-Id</td>
<td>-</td>
</tr>
<tr>
<td>System-Only</td>
<td>False</td>
</tr>
<tr>
<td>Is-Single-Valued</td>
<td>True</td>
</tr>
<tr>
<td>Is Indexed</td>
<td>False</td>
</tr>
<tr>
<td>In Global Catalog</td>
<td>False</td>
</tr>
<tr>
<td>NT-Security-Descriptor</td>
<td>O:BAG:BAD:S:</td>
</tr>
<tr>
<td>Range-Lower</td>
<td>-</td>
</tr>
<tr>
<td>Range-Upper</td>
<td>-</td>
</tr>
<tr>
<td>Search-Flags</td>
<td>0x00000000</td>
</tr>
<tr>
<td>System-Flags</td>
<td>0x00000010</td>
</tr>
<tr>
<td>Classes used in</td>
<td><a href="c-ntdsservice.html">NTDS-Service</a></td>
</tr>
</tbody>
</table>
<h2>Windows Server 2012</h2>
<table>
<thead>
<tr>
<th>Entry</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Link-Id</td>
<td>-</td>
</tr>
<tr>
<td>MAPI-Id</td>
<td>-</td>
</tr>
<tr>
<td>System-Only</td>
<td>False</td>
</tr>
<tr>
<td>Is-Single-Valued</td>
<td>True</td>
</tr>
<tr>
<td>Is Indexed</td>
<td>False</td>
</tr>
<tr>
<td>In Global Catalog</td>
<td>False</td>
</tr>
<tr>
<td>NT-Security-Descriptor</td>
<td>O:BAG:BAD:S:</td>
</tr>
<tr>
<td>Range-Lower</td>
<td>-</td>
</tr>
<tr>
<td>Range-Upper</td>
<td>-</td>
</tr>
<tr>
<td>Search-Flags</td>
<td>0x00000000</td>
</tr>
<tr>
<td>System-Flags</td>
<td>0x00000010</td>
</tr>
<tr>
<td>Classes used in</td>
<td><a href="c-ntdsservice.html">NTDS-Service</a></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>Each Active Directory forest contains a DS-Heuristics attribute that contains settings for the entire forest. The DS-Heuristics attribute is an attribute of the &quot;CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration,&lt;Domain&gt;&quot; object.</p>
<p>DS-Heuristics is a Unicode string in which each character contains a value for a single domain-wide setting. The DS-Heuristics string takes the following format.</p>
<pre lang="syntax"><code>|&lt;1&gt;|&lt;2&gt;|&lt;3&gt;|&lt;4&gt;|&lt;5&gt;|&lt;6&gt;|&lt;7&gt;|&lt;8&gt;|&lt;9&gt;|&lt;10&gt;|&lt;11&gt;|&lt;12&gt;|&lt;13&gt;|&lt;14&gt;|&lt;15&gt;|&lt;16&gt;|&lt;17&gt;|&lt;18&gt;|&lt;19&gt;|&lt;20&gt;|&lt;21&gt;|&lt;22&gt;|&lt;23&gt;|&lt;24&gt;|&lt;25&gt;|
</code></pre>
<p>To provide data validation, each tenth character is set to the character number divided by ten. For example, the tenth character is '1'; the twentieth character is '2', and so on.</p>
<p>Any character that is not set is assumed to be a '0'. If the DS-Heuristics attribute is not set, all values are assumed to be '0'. There are currently 25 characters being used and it is not necessary to pad the string to fill all 25 characters. For example, if the highest character being used is 7, then the string &quot;0000002&quot; is acceptable.</p>
<p>For details about each character, see <a href="/openspecs/windows_protocols/ms-adts/e5899be4-862e-496f-9a38-33950617d2c5">dSHeuristics in [MS-ADTS] Active Directory Technical Specification</a>.</p>
<h3>ANR Search Filters</h3>
<p>Characters 1, 2, and 4 are used to modify the behavior of ANR search filters. If character 1 is set to '1', then the expansion of the ANR filter to include <strong>GivenName</strong> - <strong>Surname</strong> (when space is found) is disabled. If character 2 is set to '1', the expansion of the ANR filter to include <strong>Surname</strong> - <strong>GivenName</strong> is disabled. If an embedded space is present in the search string, the search string will normally be divided into two strings, which are compared pair-wise against the <strong>GivenName</strong> and <strong>Surname</strong> attributes. Setting characters 1 and 2 to '1' will prevent those matches from being attempted. This matching might be disabled if the administrator is confident that searches for &quot;Jeff Smith&quot; would always be provided as &quot;jeff smith&quot; and not &quot;smith, jeff&quot;. Normally only one or the other match would be suppressed, according to local convention.</p>
<p>If the character 4 is set to '1' then Active Directory will perform &quot;pre-emptive nickname resolution&quot;. That is, if the search string exactly matches the nickname of exactly one object in the search scope, that one object is returned as the result of the search, and the rest of ANR is skipped. Note that while the rest of ANR searching is available through LDAP, pre-emptive nickname resolution (also known as &quot;nickname snap&quot;) is available only through MAPI.</p>
<h2>See also</h2>
<p><a href="/openspecs/windows_protocols/ms-adts/e5899be4-862e-496f-9a38-33950617d2c5">dSHeuristics in [MS-ADTS] Active Directory Technical Specification</a></p>
</body>
