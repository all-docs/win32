<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>version attribute</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: version attribute
description: The \ version\ interface attribute identifies a particular version among multiple versions of an RPC interface. With the version attribute, you ensure that only compatible versions of client and server software are allowed to bind.
ms.assetid: 66ac5cf3-2230-44fd-aaf6-8013e4a4ae81
keywords:</p>
<ul>
<li>version attribute MIDL
topic_type:</li>
<li>apiref
api_name:</li>
<li>version
api_type:</li>
<li>NA
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>version attribute</h1>
<p>The <strong>[version]</strong> interface attribute identifies a particular version among multiple versions of an RPC interface. With the version attribute, you ensure that only compatible versions of client and server software are allowed to bind.</p>
<pre lang="syntax"><code>version ( major-value[[. minor-value]] )
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>major-value</em></p>
<!-- raw HTML omitted -->
<p>Specifies a short unsigned integer between zero and 65,535, inclusive, that represents the major version number.</p>
<!-- raw HTML omitted -->
<p><em>minor-value</em></p>
<!-- raw HTML omitted -->
<p>Specifies a short unsigned integer between zero and 65,535, inclusive, that represents the minor version number. The minor version value is optional. If present, the minor version value is separated from the major version number by a period character (.). If not specified, the minor version value is zero.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The MIDL compiler does not support multiple versions of a COM interface. As a result, an interface attribute list that includes the <strong>[</strong><a href="object.html"><strong>object</strong></a><strong>]</strong> attribute cannot include the <strong>[version]</strong> attribute. To create a new version of an existing COM interface, use interface inheritance. A derived COM interface has a different UUID but inherits the interface member functions, status codes, and interface attributes of the base interface.</p>
<p>In combination with the <strong>[</strong><a href="uuid.html"><strong>uuid</strong></a><strong>]</strong> value, the <strong>[version]</strong> value uniquely identifies the interface. The run-time library passes the <strong>[version]</strong> and <strong>[uuid]</strong> values to the server when the client calls a remote function. A client can bind to a server for a given interface if:</p>
<ul>
<li>The <strong>[uuid]</strong> value is the same.</li>
<li>The major version number is the same.</li>
<li>The client's minor version number is less than or equal to the server's minor version number.</li>
</ul>
<p>It is to your benefit and your users' benefit to retain upward compatibility among versionsÃ‚Â that is, to modify the interface so that only the minor version number changes. You can retain upward compatibility when you add new data types that are not used by existing functions and when you add new functions without changing the interface specification for existing functions.</p>
<p>Change the major version number if any one of the following conditions apply:</p>
<ul>
<li>If you change a data type that is used by an existing function.</li>
<li>If you change the interface specification for an existing function (such as adding or removing a parameter).</li>
<li>If you add callbacks that are called by existing functions.</li>
</ul>
<p>Change the minor version number if all of the following conditions apply:</p>
<ul>
<li>If you add type definitions or constants that are not used by any existing functions or callbacks.</li>
<li>If you do not change any existing functions and you add new functions to the interface.</li>
<li>If you add callbacks that are not called by any existing functions and the new callbacks follow any existing functions.</li>
</ul>
<p>If your modifications qualify as an upward-compatible change to the interface, use the following procedure.</p>
<p><strong>To modify the interface (IDL) file</strong></p>
<ol>
<li>Add new constant and type definitions to the interface file.</li>
<li>Add callback functions to the end of the interface file.</li>
<li>Add new functions to the end of the interface file.</li>
</ol>
<p>The <strong>[version]</strong> attribute can occur at most once in the interface header.</p>
<p>When the version attribute is not present, the interface has a default version of 0.0.</p>
<p>The period character between the major and minor numbers is a delimiter and does not represent a decimal point. The minor number is treated as an integer. Leading zeroes are not significant. Trailing zeroes are significant.</p>
<p>For example, the version setting 1.11 represents a major value of one and a minor value of eleven. Version 1.11 does not represent a value between 1.1 and 1.2.</p>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="interface-definition-idl-file.html">Interface Definition (IDL) File</a></p>
<!-- raw HTML omitted -->
<p><a href="interface.html"><strong>interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="object.html"><strong>object</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="uuid.html"><strong>uuid</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
