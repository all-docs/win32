<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>oleautomation attribute</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: oleautomation attribute
description: MIDL oleautomation attribute and compatibility with Automation.
ms.assetid: 4a1c9a02-d637-4595-87b3-5fe903149357
keywords:</p>
<ul>
<li>oleautomation attribute MIDL
topic_type:</li>
<li>apiref
api_name:</li>
<li>oleautomation
api_type:</li>
<li>NA
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>oleautomation attribute</h1>
<p>The <strong>oleautomation</strong> attribute indicates that an interface is compatible with Automation.</p>
<pre lang="syntax"><code>[ 
    oleautomation, 
    uuid(string-uuid)
    [ , interface-attribute-list] 
] 
interface interface-name : base-interface
{
    ...
}
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>string-uuid</em></p>
<!-- raw HTML omitted -->
<p>Specifies a UUID string generated by the Uuidgen utility.</p>
<!-- raw HTML omitted -->
<p><em>interface-attribute-list</em></p>
<!-- raw HTML omitted -->
<p>Specifies other attributes that apply to the interface as a whole.</p>
<!-- raw HTML omitted -->
<p><em>interface-name</em></p>
<!-- raw HTML omitted -->
<p>Specifies the name of the interface.</p>
<!-- raw HTML omitted -->
<p><em>base-interface</em></p>
<!-- raw HTML omitted -->
<p>Specifies the name of an Automation interface from which this derived interface inherits member functions, status codes, and interface attributes. All Automation interfaces are derived from <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> or <a href="/windows/win32/api/oaidl/nn-oaidl-idispatch"><strong>IDispatch</strong></a>.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The parameters and return types specified for the members of an <strong>[oleautomation]</strong> interface must be Automation-compatible, as listed in the following table.</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>boolean</strong></td>
<td>Data item that can have the value VARIANT_TRUE or VARIANT_FALSE. The size corresponds to VARIANT_BOOL.</td>
</tr>
<tr>
<td><strong>unsigned char</strong></td>
<td>8-bit unsigned data item.</td>
</tr>
<tr>
<td><strong>double</strong></td>
<td>64-bit IEEE floating-point number.</td>
</tr>
<tr>
<td><strong>float</strong></td>
<td>32-bit IEEE floating-point number.</td>
</tr>
<tr>
<td><strong>int</strong></td>
<td>Signed integer, whose size is system dependent. On 32-bit platforms, MIDL treats <a href="int.html"><strong>int</strong></a> as a 32-bit signed integer.</td>
</tr>
<tr>
<td><strong>long</strong></td>
<td>32-bit signed integer.</td>
</tr>
<tr>
<td><strong>short</strong></td>
<td>16-bit signed integer.</td>
</tr>
<tr>
<td><strong>BSTR</strong></td>
<td>Length-prefixed string, as described in the Automation topic <a href="/previous-versions/windows/desktop/automat/bstr">BSTR</a>.</td>
</tr>
<tr>
<td><strong>CURRENCY</strong></td>
<td>8-byte, fixed floating-point number.</td>
</tr>
<tr>
<td><strong>DATE</strong></td>
<td>64-bit, floating point fractional number of days since December 30, 1899.</td>
</tr>
<tr>
<td><strong>SCODE</strong></td>
<td>For 16-bit systemsâ€“built-in error type that corresponds to VT_ERROR.</td>
</tr>
<tr>
<td><strong>Typedef enum</strong>Ã‚Â <em>myenum</em></td>
<td>Signed integer, whose size is system dependent.</td>
</tr>
<tr>
<td><strong>Interface IDispatch *</strong></td>
<td>Pointer to the <a href="/windows/win32/api/oaidl/nn-oaidl-idispatch"><strong>IDispatch</strong></a> interface (VT_DISPATCH).</td>
</tr>
<tr>
<td><strong>Interface IUnknown *</strong></td>
<td>Pointer to an interface that does not derive from <a href="/windows/win32/api/oaidl/nn-oaidl-idispatch"><strong>IDispatch</strong></a> (VT_UNKNOWN). (Any OLE interface can be represented by its <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> interface.)</td>
</tr>
<tr>
<td><strong>dispinterface</strong>Ã‚Â <em>Typename *</em></td>
<td>Pointer to an interface derived from <a href="/windows/win32/api/oaidl/nn-oaidl-idispatch"><strong>IDispatch</strong></a> (VT_DISPATCH).</td>
</tr>
<tr>
<td><strong>Coclass</strong>Ã‚Â <em>Typename *</em></td>
<td>Pointer to a coclass name (VT_UNKNOWN).</td>
</tr>
<tr>
<td><strong>[oleautomation] interface</strong>Ã‚Â  <em>Typename *</em></td>
<td>Pointer to an interface that derives from <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a>.</td>
</tr>
<tr>
<td><strong>SAFEARRAY</strong>(<em>TypeName</em>)</td>
<td><em>TypeName</em> is any of the above types. Array of these types.</td>
</tr>
<tr>
<td><strong>TypeName *</strong></td>
<td><em>TypeName</em> is any of the above types. Pointer to a type.</td>
</tr>
<tr>
<td><strong>Decimal</strong></td>
<td>96-bit unsigned binary integer scaled by a variable power of 10. A decimal data type that provides a size and a scale for a number (as in coordinates).</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>A parameter is compatible with Automation if its type is an Automation-compatible type, a pointer to an Automation-compatible type, or a SAFEARRAY of an Automation-compatible type.</p>
<p>A return type is compatible with Automation if its type is an HRESULT, SCODE or <a href="void.html"><strong>void</strong></a>. However, MIDL requires that interface methods return either HRESULT or SCODE. Returning <strong>void</strong> generates a compiler error.</p>
<p>A member is compatible with Automation if its return type and all its parameters are Automation compatible.</p>
<p>An interface is compatible with Automation if it is derived from <a href="/windows/win32/api/oaidl/nn-oaidl-idispatch"><strong>IDispatch</strong></a> or <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a>, it has the <strong>[oleautomation]</strong> attribute, and all of its VTBL entries are Automation compatible. For 32-bit platforms, the calling convention for all methods in the interface must be STDCALL. For 16-bit systems, all methods must have the CDECL calling convention.</p>
<p>Every <a href="dispinterface.html"><strong>dispinterface</strong></a> is implicitly Automation-compatible. Therefore you should not use the <strong>[oleautomation]</strong> attribute on <strong>dispinterface</strong>.</p>
<p>The <strong>[oleautomation]</strong> attribute is not available when you compile using the MIDL compiler <a href="-osf.html"><strong>/osf</strong></a> switch.</p>
<h3>Flags</h3>
<p>TYPEFLAG_FOLEAUTOMATION</p>
<h2>Examples</h2>
<pre lang="syntax"><code>library Hello
{
    importlib(&quot;stdole32.tlb&quot;);
    [
        uuid(12345678-1234-1234-1234-123456789ABC),
        helpstring(&quot;Application object for the Hello application.&quot;),
        oleautomation,
        dual
    ]
    interface IHello : IDispatch
    {
        // Interface definition statements.
    }

    // Other library definition statements.
}
</code></pre>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="interface-definition-idl-file.html">Interface Definition (IDL) File</a></p>
<!-- raw HTML omitted -->
<p><a href="generating-a-type-library-with-midl-2.html">Generating a Type Library With MIDL</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/automat/odl-file-example">ODL File Example</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/automat/odl-file-syntax">ODL File Syntax</a></p>
<!-- raw HTML omitted -->
<p><a href="-osf.html"><strong>/osf</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="uuid.html"><strong>uuid</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
