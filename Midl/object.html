<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>object attribute</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: object attribute
description: The \ object\ interface attribute identifies a COM interface.
ms.assetid: 51e34ef3-eea7-45f4-b961-a9f742700fe5
keywords:</p>
<ul>
<li>object attribute MIDL
topic_type:</li>
<li>apiref
api_name:</li>
<li>object
api_type:</li>
<li>NA
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>object attribute</h1>
<p>The <strong>[object]</strong> interface attribute identifies a COM interface. (An interface attribute list that does not include the <strong>[object]</strong> attribute indicates a DCE RPC interface.)</p>
<pre lang="syntax"><code>[ 
    object, 
    uuid(string-uuid)
    [ , interface-attribute-list] 
] 
interface interface-name : base-interface
{
...    
}
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>string-uuid</em></p>
<!-- raw HTML omitted -->
<p>A UUID string generated by the Uuidgen utility. You can enclose the UUID string in quotes.</p>
<!-- raw HTML omitted -->
<p><em>interface-attribute-list</em></p>
<!-- raw HTML omitted -->
<p>Other attributes that apply to the interface as a whole.</p>
<!-- raw HTML omitted -->
<p><em>interface-name</em></p>
<!-- raw HTML omitted -->
<p>The name of the interface.</p>
<!-- raw HTML omitted -->
<p><em>base-interface</em></p>
<!-- raw HTML omitted -->
<p>The COM interface from which this interface derives. The base interface must be <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a>, <a href="/windows/win32/api/oaidl/nn-oaidl-idispatch"><strong>IDispatch</strong></a>, or another COM interface that derives, either directly or indirectly, from <strong>IUnknown</strong> or <strong>IDispatch</strong>.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>An interface attribute list for a COM interface must include the <strong>[</strong><a href="uuid.html"><strong>uuid</strong></a><strong>]</strong> attribute, but it cannot include the <strong>[</strong><a href="version.html"><strong>version</strong></a><strong>]</strong> attribute.</p>
<p>By default, compiling a COM interface with the MIDL compiler generates the files needed to build a proxy DLL. This DLL contains the code to support the use of the custom COM interface by both client applications and object servers. However, if the interface attribute list for a COM interface specifies the <strong>[</strong><a href="local.html"><strong>local</strong></a><strong>]</strong> attribute, the MIDL compiler generates only the interface header file.</p>
<p>The MIDL compiler automatically generates an interface data type for a COM interface. As an alternative, you can use <a href="typedef.html"><strong>typedef</strong></a> with the <a href="interface.html"><strong>interface</strong></a> keyword to explicitly define an interface data type. The interface specification can then use the interface data type in function parameters and return values, <a href="struct.html"><strong>struct</strong></a> and <a href="union.html"><strong>union</strong></a> members, and other type declarations. The following example illustrates the use of an automatically generated <a href="/windows/desktop/api/objidl/nn-objidl-istream"><strong>IStream</strong></a> data type:</p>
<pre lang="syntax"><code>[
    object, 
    uuid (ABCDEFOO-1234-1234-5678-ABCDEF123456)
] 
interface IStream : IUnknown
{ 
    typedef IStream * LPSTREAM; 
    // Other interface definition statements.
}
</code></pre>
<p>In a COM interface, all the interface member functions are assumed to be virtual functions. A virtual function has an implicit <strong>this</strong> pointer as the first parameter. The virtual function table contains an entry for each interface member function.</p>
<p>Non-<strong>[</strong><a href="local.html"><strong>local</strong></a><strong>]</strong> object interface member functions must have a return value of HRESULT or SCODE. (Note that earlier versions of MIDL allowed member functions to return <a href="void.html"><strong>void</strong></a>. However, beginning with MIDL version 3.0, returning <strong>void</strong> generates a compiler error.) Having a return value of HRESULT or SCODE means that if an exception is generated during a remote call, the generated proxies catch the exception and return the exception code in the return value. If your application can afford to ignore errors that occur during a remote procedure call, you can specify HRESULT as the return type without checking the return value after the call.</p>
<p>If you are recompiling an old application, changing the return types can introduce backward compatibility problems when the server sends the newly introduced result to the client. As an alternative to changing the return type, you can label the function that returns <a href="void.html"><strong>void</strong></a> with the <strong>[</strong><a href="call-as.html"><strong>call_as</strong></a><strong>]</strong> attribute, thus making it a local function. Then define a related remote function with the same parameters but with the return type of HRESULT. The local function can raise an exception based on that HRESULT value, if necessary.</p>
<p>The <strong>[object]</strong> attribute is not available when you compile using the MIDL compiler <a href="-osf.html"><strong>/osf</strong></a> switch.</p>
<h2>Examples</h2>
<pre lang="syntax"><code>[
    uuid(12345678-1234-1234-1234-123456789ABC), 
    object
] 
interface IMyInterface : IUnknown
{
    // Interface definition statements.
}

[
    uuid(87654321-1234-1234-1234-123456789ABC), 
    object, 
    local
] 
interface ILocalInterface : ISomeOldCOMInterface
{
    // Interface definition statements.
}
</code></pre>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="call-as.html"><strong>call_as</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="interface-definition-idl-file.html">Interface Definition (IDL) File</a></p>
<!-- raw HTML omitted -->
<p><a href="iid-is.html"><strong>iid_is</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="interface.html"><strong>interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="local.html"><strong>local</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="-osf.html"><strong>/osf</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="typedef.html"><strong>typedef</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="uuid.html"><strong>uuid</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="version.html"><strong>version</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
