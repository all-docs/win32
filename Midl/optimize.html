<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>optimize attribute</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: optimize attribute
description: The \ optimize\ ACF attribute is used to fine tune the level of gradation for marshaling data.
ms.assetid: d636d940-0550-417f-a21a-065bdeaeb5d9
keywords:</p>
<ul>
<li>optimize attribute MIDL
topic_type:</li>
<li>apiref
api_name:</li>
<li>optimize
api_type:</li>
<li>NA
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>optimize attribute</h1>
<p>The <strong>[optimize]</strong> ACF attribute is used to fine tune the level of gradation for marshaling data.</p>
<blockquote>
<p>[!Note]<br />
This keyword is superceeded and should not be used. Current MIDL compilations should use <a href="-oi.html"><strong>/Oicf</strong></a><a href="-robust.html"><strong>/robust</strong></a> instead.</p>
</blockquote>
<p>Â </p>
<pre lang="syntax"><code>optimize (&quot;optimization-options&quot;)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>optimization-options</em></p>
<!-- raw HTML omitted -->
<p>Specifies the method of marshaling data. Use either &quot;s&quot; for mixed-mode marshaling or &quot;i&quot; for interpreted marshaling.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>This version of RPC provides two methods for marshaling data: mixed-mode (&quot;s&quot;) and interpreted (&quot;i&quot;). These methods correspond to the <a href="-os.html"><strong>/Os</strong></a> and <a href="-oi.html"><strong>/Oi</strong></a> command-line switches. The interpreted method marshals data completely offline. While this can reduce the size of the stub considerably, performance can be affected.</p>
<p>If performance is a concern, the mixed-mode method can be the best approach. Mixed-mode allows the MIDL compiler to make the determination between which data will be marshaled inline and which will be marshaled by a call to an offline dynamic-link library. If many procedures use the same data types, a single procedure can be called repeatedly to marshal the data. In this way, data that is most suited to inline marshaling is processed inline while other data can be more efficiently marshaled offline.</p>
<p>Note that the <strong>[optimize]</strong> attribute can be used as an interface attribute or as an operation attribute. If it is used as an interface attribute, it sets the default for the entire interface, overriding command-line switches. If, however, it is used as an operation attribute, it affects only that operation, overriding command-line switches and the interface default.</p>
<h2>Examples</h2>
<pre lang="syntax"><code>optimize (&quot;s&quot;) HRESULT FasterProcedure(...); 
optimize (&quot;i&quot;) HRESULT SmallerProcedure(...);
</code></pre>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="application-configuration-file-acf-.html">Application Configuration File (ACF)</a></p>
<!-- raw HTML omitted -->
<p><a href="-oi.html"><strong>/Oi</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="-os.html"><strong>/Os</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="-robust.html"><strong>/robust</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
