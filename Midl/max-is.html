<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>max_is attribute</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: max_is attribute
description: The \ max_is\ attribute designates the maximum value for a valid array index.
ms.assetid: 8d09f610-cae6-45f6-815c-5ba916d8a5e7
keywords:</p>
<ul>
<li>max_is attribute MIDL
topic_type:</li>
<li>apiref
api_name:</li>
<li>max_is
api_type:</li>
<li>NA
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>max_is attribute</h1>
<p>The <strong>[max_is]</strong> attribute designates the maximum value for a valid array index.</p>
<pre lang="syntax"><code>[max_is(limited-expression-list )]
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>limited-expression-list</em></p>
<!-- raw HTML omitted -->
<p>Specifies one or more C-language expressions. Each expression evaluates to an integer that represents the highest valid array index. The MIDL compiler supports conditional expressions, logical expressions, relational expressions, and arithmetic expressions. MIDL does not allow function invocations in expressions and does not allow increment and decrement operators. Separate multiple expressions with commas.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The <strong>[max_is]</strong> attribute does not necessarily correspond to the number of elements in the array. For an array of size <em>n</em> in C, where the first array element is element number zero, the maximum value for a valid array index is <em>n</em>â€“1.</p>
<p>The <strong>[max_is]</strong> attribute cannot be used as a field attribute at the same time as the <strong>[</strong><a href="size-is.html"><strong>size_is</strong></a><strong>]</strong> attribute.</p>
<p>While it is legal to use the <strong>[max_is]</strong> attribute with a constant expression, doing so is inefficient and unnecessary. For example, use a fixed size array:</p>
<pre lang="syntax"><code>/* transmits values of a[0]... a[MAX_SIZE-1] */ 
HRESULT Proc3([in] short Arr[MAX_SIZE]); 
</code></pre>
<p>instead of:</p>
<pre lang="syntax"><code>/* legal but marshaling code is much slower */ 
HRESULT Proc3([in max_is(MAX_SIZE-1)] short Arr[] );
</code></pre>
<h2>Examples</h2>
<pre lang="syntax"><code>/* if m = 10, there are 11 transmitted elements (a[0]...a[10])*/ 
HRESULT Proc1( 
    [in] short m, 
    [in, max_is(m)] short a[]);  
 
/* if m = 10, the valid range for b is b[0...10][20] */ 
HRESULT Proc2( 
    [in] short m, 
    [in, max_is(m)] short b[][20];
</code></pre>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/Rpc/field-attributes">Field Attributes</a></p>
<!-- raw HTML omitted -->
<p><a href="interface-definition-idl-file.html">Interface Definition (IDL) File</a></p>
<!-- raw HTML omitted -->
<p><a href="min-is.html"><strong>min_is</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="size-is.html"><strong>size_is</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
