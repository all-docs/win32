<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Generating a Type Library with MIDL</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Generating a Type Library with MIDL
description: The top-level element of the ODL syntax is the library statement (library block).
ms.assetid: e21a9e6e-4e10-4280-af8f-24534cb2ab90
keywords:</p>
<ul>
<li>Microsoft Interface Definition Language MIDL , tasks, generating a type library
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Generating a Type Library with MIDL</h1>
<p>The top-level element of the ODL syntax is the library statement (library block). Every other ODL statement, with the exception of the attributes that are applied to the library statement, must be defined within the library block. When the MIDL compiler sees a library block, it generates a type library in much the same way that MkTypLib does. With a few exceptions, described in <a href="differences-between-midl-and-mktyplib.html">Differences Between MIDL and MKTYPLIB</a>, the statements within the library block should follow the same syntax as in the ODL language and MkTypLib.</p>
<blockquote>
<p>[!Note]<br />
The Mktyplib.exe tool is obsolete. Use the MIDL compiler instead.</p>
</blockquote>
<p>Â </p>
<p>You can apply ODL attributes to elements that are defined either inside or outside the library block. These attributes have no effect outside the library block unless the element they are applied to is referenced from within the library block. Statements inside the library block can reference an outside element either by using it as a base type, inheriting from it, or by referencing it on a line as shown:</p>
<pre lang="syntax"><code>&lt;some IDL definitions including definitions for interface IFace and struct bar&gt;
[&lt;some attributes&gt;]
library a
{
    interface IFace;
    struct this_struct;
...
};
</code></pre>
<p>If an element defined outside the library block is referenced within the library block, then its definition will be put into the generated type library. The MIDL compiler treats the statements outside of a library block as a typical IDL file and parses those statements as it has always done. Normally, this means generating C-language stubs for an RPC application.</p>
<p>For more information about the general syntax for an ODL file see <a href="/previous-versions/windows/desktop/automat/odl-file-syntax">ODL File Syntax</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
