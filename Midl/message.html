<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>message attribute</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: message attribute
description: The \ message\ attribute indicates that the remote procedure call is to be treated as a message from the client to the server.
ms.assetid: ec616bf5-a845-4e7e-9f39-20947d2074f7
keywords:</p>
<ul>
<li>message attribute MIDL
topic_type:</li>
<li>apiref
api_name:</li>
<li>message
api_type:</li>
<li>NA
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>message attribute</h1>
<p>The <strong>[message]</strong> attribute indicates that the remote procedure call is to be treated as a message from the client to the server.</p>
<pre lang="syntax"><code>[message, optional-attribute-list] void function-name(
    [in, optional-parameter-attributes] param-name,. . .);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>optional-attribute-list</em></p>
<!-- raw HTML omitted -->
<p>Other attributes that apply to the function. Only the <strong>[</strong><a href="local.html"><strong>local</strong></a><strong>]</strong>, <strong>[</strong><a href="nocode.html"><strong>nocode</strong></a><strong>]</strong>, <strong>[</strong><a href="code.html"><strong>code</strong></a><strong>],</strong> and <strong>[</strong><a href="optimize.html"><strong>optimize</strong></a><strong>]</strong> attributes may be used with the <strong>[message]</strong> attribute.</p>
<!-- raw HTML omitted -->
<p><em>function-name</em></p>
<!-- raw HTML omitted -->
<p>The name of the function as defined in the IDL file.</p>
<!-- raw HTML omitted -->
<p><em>optional-parameter-attributes</em></p>
<!-- raw HTML omitted -->
<p>Zero or more MIDL attributes that will be applied to the parameter.</p>
<!-- raw HTML omitted -->
<p><em>param-name</em></p>
<!-- raw HTML omitted -->
<p>The name of the parameter as defined in the IDL file.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>As messages from the client, remote procedure calls with the <strong>[message]</strong> attribute are delivered to the server asynchronously over the <a href="ncadg-mq.html"><strong>ncadg_mq</strong></a> message-queuing transport. You can indicate synchronous-mode messaging by specifying the <strong>ncadg_mq</strong> transport protocol without using the <strong>[message]</strong> attribute.</p>
<p>By specifying asynchronous-mode messaging, the <strong>[message]</strong> attribute allows the client to make the remote procedure call and return immediately, even when the server application is not responding. If the target server is not available, the call will be stored until the server becomes available.</p>
<p>In addition, asynchronous-mode messaging lets you control message-queue properties of the receive queue for the server. See <a href="/windows/desktop/api/rpcdce/nf-rpcdce-rpcbindingsetoption"><strong>RpcBindingSetOption</strong></a> for more information on selecting quality of service, call priority, and call lifetime for the server process.</p>
<p>The following restrictions also apply to the <strong>[message]</strong> attribute:</p>
<ul>
<li>Microsoft Message Queuing must be implemented in the client and server systems and the systems must be visible to each other as determined by the scope of the message queue installation.</li>
<li>The binding must use well-known endpoints and the <a href="ncadg-mq.html"><strong>ncadg_mq</strong></a> transport protocol.</li>
<li>The function cannot contain output parameters or a return type other than <a href="void.html"><strong>void</strong></a>. Note that the latter restriction makes the <strong>[message]</strong> attribute unsuitable for COM (object) interface methods, at this time. The next release of MIDL will permit <strong>[message]</strong> functions to return error_status_t or HRESULT.</li>
<li>Any interface that contains at least one <strong>[message]</strong> call must be registered by calling <a href="/windows/desktop/api/rpcdce/nf-rpcdce-rpcserverregisterif"><strong>RpcServerRegisterIf</strong></a> or <a href="/windows/desktop/api/rpcdce/nf-rpcdce-rpcserverregisterifex"><strong>RpcServerRegisterIfEx</strong></a> before calling <a href="/windows/desktop/api/rpcdce/nf-rpcdce-rpcserveruseprotseqepex"><strong>RpcServerUseProtseqEpEx(ncadg_mq)</strong></a>. Otherwise, calls that were waiting on the queue for the server will be read before the interface is registered, and the calls will fail.</li>
</ul>
<h2>Examples</h2>
<pre lang="syntax"><code>[message] void DisplayString(
    [in, string] char * p1);
 
[message] void VarDataArray(
    [in, size_is(iSize)] ARRAY_TYPE lpMyArray,
    [in] int iSize,
    [in] unsigned long ulChksum);
</code></pre>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="code.html"><strong>code</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="local.html"><strong>local</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="ncadg-mq.html"><strong>ncadg_mq</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="nocode.html"><strong>nocode</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="optimize.html"><strong>optimize</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/Rpc/rpc-message-queuing">RPC Message Queuing</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/rpcdce/nf-rpcdce-rpcbindingsetoption"><strong>RpcBindingSetOption</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/rpcdce/nf-rpcdce-rpcbindinginqoption"><strong>RpcBindingInqOption</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="void.html"><strong>void</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
