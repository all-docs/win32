<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Marshaling OLE Data Types</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Marshaling OLE Data Types
description: Marshaling Automation and OLE data types.
ms.assetid: 0cab4208-d40d-40a1-88f2-4933b52c0c29
keywords:</p>
<ul>
<li>MIDL and COM MIDL , marshaling OLE data types</li>
<li>marshaling MIDL</li>
<li>OLE data MIDL
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Marshaling OLE Data Types</h1>
<p>To make it easier to use certain Automation and OLE data types, as well as some system handles frequently used in COM, typedefs for these data types and their related helper functions are available by importing Windows IDL files and linking to the OLE and Automation DLL files. These files are automatically installed on your system.</p>
<ul>
<li>To use the <a href="/previous-versions/windows/desktop/automat/bstr"><strong>BSTR</strong></a> data type in remote procedure calls, import the wtypes.idl file into your interface definition (IDL) file and link to Oleaut32.lib when building your distributed application. This will let your stubs use the ready-made helper functions <strong>BSTR_UserSize</strong>, <strong>BSTR_UserMarshal</strong>, <strong>BSTR_UserUnmarshal</strong>, and <strong>BSTR_UserFree</strong>.</li>
<li>To use other Automation data types, such as <a href="/windows/win32/api/oaidl/ns-oaidl-variant"><strong>VARIANT</strong></a> and <a href="/windows/win32/api/oaidl/ns-oaidl-safearray"><strong>SAFEARRAY</strong></a>, or types that use those types (for example, <a href="/windows/win32/api/oaidl/ns-oaidl-dispparams"><strong>DISPPARAMS</strong></a> and <a href="/windows/win32/api/oaidl/ns-oaidl-excepinfo"><strong>EXCEPINFO</strong></a>), import the objidl.idl file into your IDL file and link to the oleaut32.lib at build time. This will allow you to use the appropriate helper routines.</li>
<li>To use OLE data types (such as CLIPFORMAT, SNB, STGMEDIUM, ASYNC_STGMEDIUM), or system handles (such as HMETAFILE_PICT, HENHMETAFILE, HMETAFILE, HBITMAP, HPALETTE, and HGLOBAL), import the objidl.idl file into your interface definition file and link to the ole32.lib at build time.</li>
<li>The following OLE handles are also defined with the <strong>[wire_marshal]</strong> attribute, but only as handles within a computer since they cannot be used in remote procedure calls to other computers at this time: HWND, HMENU, HACCEL, HDC, HFONT, HICON, HBRUSH. Import the objidl.idl file into your IDL file and link to ole32.lib at build time to use these handles in interprocess communication on a single computer.</li>
</ul>
<p>For more information, see <a href="/windows/desktop/Rpc/the-wire-marshal-attribute">The wire_marshal Attribute</a>, <a href="/windows/desktop/Rpc/the-type-usersize-function">The type_UserSize Function</a>, <a href="/windows/desktop/Rpc/the-type-usermarshal-function">The type_UserMarshal Function</a>, <a href="/windows/desktop/Rpc/the-type-userunmarshal-function">The type_UserUnmarshal Function</a>, <a href="/windows/desktop/Rpc/the-type-userfree-function">The type_UserFree Function</a>, and <a href="targeting-stubs-for-specific-32-bit-or-64-bit-platforms.html">Targeting Stubs for Specific 32-bit or 64-bit Platforms</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
