<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ptr attribute</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: ptr attribute
description: The \ ptr\ attribute designates a pointer as a full pointer.
ms.assetid: a1233a25-b651-4a01-8abf-a64dc9ee168e
keywords:</p>
<ul>
<li>ptr attribute MIDL
topic_type:</li>
<li>apiref
api_name:</li>
<li>ptr
api_type:</li>
<li>NA
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>ptr attribute</h1>
<p>The <strong>[ptr]</strong> attribute designates a pointer as a full pointer.</p>
<pre lang="syntax"><code>pointer_default(ptr)

typedef [ ptr [ , type-attribute-list ] ] type-specifier declarator-list; 

typedef [ struct | union ]
{
    [ ptr [ , field-attribute-list ] ] type-specifier declarator-list;
    ...
}

[ ptr [ , function-attribute-list ] ] type-specifier ptr-decl function-name(
    [ [ parameter-attribute-list ] ] type-specifier [standard-declarator]
    , ...);

[[ [ function-attribute-list ] ]] type-specifier [[ptr-decl]] function-name(
    [ ptr [[ , parameter-attribute-list ]] ] type-specifier [[standard-declarator]]
    , ...);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>type-attribute-list</em></p>
<!-- raw HTML omitted -->
<p>Specifies one or more attributes that apply to the type. Valid type attributes include <strong>[</strong><a href="handle.html"><strong>handle</strong></a><strong>]</strong>, <strong>[</strong><a href="switch-type.html"><strong>switch_type</strong></a><strong>]</strong>, <strong>[</strong><a href="transmit-as.html"><strong>transmit_as</strong></a><strong>]</strong>; the pointer attribute <strong>[</strong><a href="ref.html"><strong>ref</strong></a><strong>]</strong>, <strong>[</strong><a href="unique.html"><strong>unique</strong></a>, or <strong>[ptr]</strong>; and the usage attributes <strong>[</strong><a href="context-handle.html"><strong>context_handle</strong></a><strong>]</strong>, <strong>[</strong><a href="string.html"><strong>string</strong></a><strong>]</strong>, and <strong>[</strong><a href="ignore.html"><strong>ignore</strong></a><strong>]</strong>. Separate multiple attributes with commas.</p>
<!-- raw HTML omitted -->
<p><em>type-specifier</em></p>
<!-- raw HTML omitted -->
<p>Specifies a <a href="midl-base-types.html">base type</a>, <a href="struct.html"><strong>struct</strong></a>, <a href="union.html"><strong>union</strong></a>, or <a href="enum.html"><strong>enum</strong></a> type or type identifier. An optional storage specification can precede <em>type-specifier</em>.</p>
<!-- raw HTML omitted -->
<p><em>standard-declarator</em></p>
<!-- raw HTML omitted -->
<p>Specifies a standard C declarator, such as an identifier, a pointer declarator, or an array declarator. For more information, see <a href="array-and-sized-pointer-attributes.html">Array and Sized-Pointer Attributes</a>, <a href="arrays-1.html"><strong>arrays</strong></a>, and <a href="/windows/desktop/Rpc/arrays-and-pointers">Arrays and Pointers</a>.</p>
<!-- raw HTML omitted -->
<p><em>declarator-list</em></p>
<!-- raw HTML omitted -->
<p>Specifies standard C declarators, such as identifiers, pointer declarators, and array declarators. For more information, see <a href="array-and-sized-pointer-attributes.html">Array and Sized-Pointer Attributes</a>, <a href="arrays-1.html"><strong>arrays</strong></a>, and <a href="/windows/desktop/Rpc/arrays-and-pointers">Arrays and Pointers</a>. The <em>declarator-list</em> consists of one or more declarators separated by commas. The parameter-name identifier in the function declarator is optional.</p>
<!-- raw HTML omitted -->
<p><em>field-attribute-list</em></p>
<!-- raw HTML omitted -->
<p>Specifies zero or more field attributes that apply to the structure or union member or function parameter. Valid field attributes include <strong>[</strong><a href="first-is.html"><strong>first_is</strong></a><strong>]</strong>, <strong>[</strong><a href="last-is.html"><strong>last_is</strong></a><strong>]</strong>, <strong>[</strong><a href="length-is.html"><strong>length_is</strong></a><strong>]</strong>, <strong>[</strong><a href="max-is.html"><strong>max_is</strong></a><strong>]</strong>, <strong>[</strong><a href="size-is.html"><strong>size_is</strong></a><strong>]</strong>; the usage attributes <strong>[</strong><a href="string.html"><strong>string</strong></a><strong>]</strong>, <strong>[</strong><a href="ignore.html"><strong>ignore</strong></a><strong>]</strong>, and <strong>[</strong><a href="context-handle.html"><strong>context_handle</strong></a><strong>]</strong>; the pointer attribute <strong>[</strong><a href="ref.html"><strong>ref</strong></a><strong>]</strong>, <strong>[</strong><a href="unique.html"><strong>unique</strong></a><strong>]</strong>, or <strong>[ptr]</strong>; and the union attribute <strong>[</strong><a href="switch-type.html"><strong>switch_type</strong></a><strong>]</strong>. Separate multiple field attributes with commas.</p>
<!-- raw HTML omitted -->
<p><em>function-attribute-list</em></p>
<!-- raw HTML omitted -->
<p>Specifies zero or more attributes that apply to the function. Valid function attributes are <strong>[</strong><a href="callback.html"><strong>callback</strong></a><strong>]</strong>, <strong>[</strong><a href="local.html"><strong>local</strong></a><strong>]</strong>; the pointer attribute <strong>[</strong><a href="ref.html"><strong>ref</strong></a><strong>]</strong>, <strong>[</strong><a href="unique.html"><strong>unique</strong></a><strong>]</strong>, or <strong>[ptr]</strong>; and the usage attributes <strong>[</strong><a href="string.html"><strong>string</strong></a><strong>]</strong>, <strong>[</strong><a href="ignore.html"><strong>ignore</strong></a><strong>]</strong>, and <strong>[</strong><a href="context-handle.html"><strong>context_handle</strong></a><strong>]</strong>.</p>
<!-- raw HTML omitted -->
<p><em>ptr-decl</em></p>
<!-- raw HTML omitted -->
<p>Specifies at least one pointer declarator to which the <strong>[ptr]</strong> attribute applies. A pointer declarator is the same as the pointer declarator used in C; it is constructed from the * designator, modifiers such as <strong>far</strong>, and the qualifier <a href="const.html"><strong>const</strong></a>.</p>
<!-- raw HTML omitted -->
<p><em>function-name</em></p>
<!-- raw HTML omitted -->
<p>Specifies the name of the remote procedure.</p>
<!-- raw HTML omitted -->
<p><em>parameter-attribute-list</em></p>
<!-- raw HTML omitted -->
<p>Consists of zero or more attributes appropriate for the specified parameter type. Parameter attributes can take the directional attributes <a href="in.html"><strong>in</strong></a> and <a href="out-idl.html"><strong>out</strong></a>; the field attributes <a href="first-is.html"><strong>first_is</strong></a>, <a href="last-is.html"><strong>last_is</strong></a>, <a href="length-is.html"><strong>length_is</strong></a>, <a href="max-is.html"><strong>max_is</strong></a>, <a href="size-is.html"><strong>size_is</strong></a>, and <a href="switch-type.html"><strong>switch_type</strong></a>; the pointer attribute <a href="ref.html"><strong>ref</strong></a>, <a href="unique.html"><strong>unique</strong></a>, or <strong>[ptr]</strong>; and the usage attributes <a href="context-handle.html"><strong>context_handle</strong></a> and <a href="string.html"><strong>string</strong></a>. The usage attribute <a href="ignore.html"><strong>ignore</strong></a> cannot be used as a parameter attribute. Separate multiple attributes with commas.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The full pointer designated by the <strong>[ptr]</strong> attribute approaches the full functionality of the C-language pointer. The full pointer can have the value <strong>NULL</strong> and can change during the call from <strong>NULL</strong> to non-<strong>NULL</strong>. Storage pointed to by full pointers can be reached by other names in the application supporting aliasing and cycles. This functionality requires more overhead during a remote procedure call to identify the data referred to by the pointer, determine whether the value is <strong>NULL</strong>, and to discover if two pointers point to the same data.</p>
<p>Use full pointers for:</p>
<ul>
<li>Remote return values.</li>
<li>Double pointers, when the size of an output parameter is not known.</li>
<li><strong>NULL</strong> pointers.</li>
</ul>
<p>Full (and unique) pointers cannot be used to describe the size of an array or union because these pointers can have the value <strong>NULL</strong>. This restriction by MIDL prevents an error that can result when a <strong>NULL</strong> value is used as the size.</p>
<p>Reference and unique pointers are assumed to cause no aliasing of data. A directed graph obtained by starting from a unique or reference pointer and following only unique or reference pointers contains neither reconvergence nor cycles.</p>
<p>To avoid aliasing, all pointer values should be obtained from an input pointer of the same class of pointer. If more than one pointer points to the same memory location, all such pointers must be full pointers.</p>
<p>In some cases, full and unique pointers can be mixed. A full pointer can be assigned the value of a unique pointer, as long as the assignment does not violate the restrictions on changing the value of a unique pointer. However, when you assign a unique pointer the value of a full pointer, you may cause aliasing.</p>
<p>Mixing full and unique pointers can cause aliasing, as demonstrated in the following example:</p>
<pre lang="syntax"><code>typedef struct 
{ 
    [ptr] short * pdata;          // full pointer  
} GRAPH_NODE_TYPE; 
 
typedef struct 
{ 
    [unique] graph_node * left;   // unique pointer  
    [unique] graph_node * right;  // unique pointer 
} TREE_NODE_TYPE; 
 
// application code: 
short a = 5; 
TREE_NODE_TYPE * t; 
GRAPH_NODE_TYPE g, h; 
 
g.pdata = h.pdata = &amp;a; 
t-&gt;left = &amp;g; 
t-&gt;right = &amp;h; 
// t-&gt;left-&gt;pdata == t-&gt;right-&gt;pdata == &amp;a
</code></pre>
<p>Although &quot;t-&gt;left&quot; and &quot;t-&gt;right&quot; point to unique memory locations, &quot;t-&gt;left-&gt;pdata&quot; and &quot;t-&gt;right-&gt;pdata&quot; are aliased. For this reason, aliasing-support algorithms must follow all pointers (including unique and reference pointers) that may eventually reach a full pointer.</p>
<h2>Examples</h2>
<pre lang="syntax"><code>pointer_default(ptr) 
 
typedef [ptr, string] unsigned char * MY_STRING_TYPE; 
 
[ptr] char * MyFunction([in, out, unique] long * plNumber);
</code></pre>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="arrays-1.html"><strong>arrays</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/Rpc/arrays-and-pointers">Arrays and Pointers</a></p>
<!-- raw HTML omitted -->
<p><a href="array-and-sized-pointer-attributes.html">Array and Sized-Pointer Attributes</a></p>
<!-- raw HTML omitted -->
<p><a href="midl-base-types.html">MIDL Base Types</a></p>
<!-- raw HTML omitted -->
<p><a href="callback.html"><strong>callback</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="const.html"><strong>const</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="context-handle.html"><strong>context_handle</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="enum.html"><strong>enum</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="first-is.html"><strong>first_is</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="handle.html"><strong>handle</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="interface-definition-idl-file.html">Interface Definition (IDL) File</a></p>
<!-- raw HTML omitted -->
<p><a href="ignore.html"><strong>ignore</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="last-is.html"><strong>last_is</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="length-is.html"><strong>length_is</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="local.html"><strong>local</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="max-is.html"><strong>max_is</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="pointer-default.html"><strong>pointer_default</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="ref.html"><strong>ref</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="size-is.html"><strong>size_is</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="string.html"><strong>string</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="struct.html"><strong>struct</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="switch-type.html"><strong>switch_type</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="transmit-as.html"><strong>transmit_as</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="union.html"><strong>union</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="unique.html"><strong>unique</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
