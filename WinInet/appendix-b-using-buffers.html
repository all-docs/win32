<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using String Buffers</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Using String Buffers
description: Functions that return strings contain an input parameter, lpszBuffer, and a size parameter, lpdwBufferLength. Although lpszBuffer can be NULL, lpdwBufferLength must be a valid pointer to a DWORD variable.
ms.assetid: ae7f84ba-15d4-483b-bdda-0042854f9e1b
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using String Buffers</h1>
<p>Functions that return strings contain an input parameter, <em>lpszBuffer</em>, and a size parameter, <em>lpdwBufferLength</em>. Although <em>lpszBuffer</em> can be <strong>NULL</strong>, <em>lpdwBufferLength</em> must be a valid pointer to a <strong>DWORD</strong> variable. If the input buffer pointed to by <em>lpszBuffer</em> is <strong>NULL</strong> or too small to hold the output string, the function fails and <a href="/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a> returns <strong>ERROR_INSUFFICIENT_BUFFER</strong>. The variable pointed to by <em>lpdwBufferLength</em> contains a number that represents the number of bytes the function requires to return the requested string, including the <strong>null</strong> terminator. The application should allocate a buffer of this size, set the variable pointed to by <em>lpdwBufferLength</em> to this value, and resubmit the request. If the buffer size is sufficient to receive the requested string, the string is copied to the output buffer with a <strong>null</strong> terminator and the function returns a success indication. The variable pointed to by <em>lpdwBufferLength</em> now contains the number of characters stored in the buffer, excluding the <strong>null</strong> terminator.</p>
<blockquote>
<p>[!Note]<br />
WinINet does not support server implementations. In addition, it should not be used from a service. For server implementations or services use <a href="/windows/desktop/WinHttp/winhttp-start-page">Microsoft Windows HTTP Services (WinHTTP)</a>.</p>
</blockquote>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
