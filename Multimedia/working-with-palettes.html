<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Working with Palettes</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Working with Palettes
description: Working with Palettes
ms.assetid: 0ad0d78b-4c2c-499c-ad5e-8324b59e89fc
keywords:</p>
<ul>
<li>WM_CAP_PAL_PASTE message</li>
<li>capPalettePaste macro</li>
<li>WM_CAP_PAL_OPEN message</li>
<li>capPaletteOpen macro</li>
<li>WM_CAP_PAL_AUTOCREATE message</li>
<li>capPaletteAuto macro</li>
<li>WM_CAP_PAL_MANUALCREATE message</li>
<li>capPaletteManual macro
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Working with Palettes</h1>
<p>Initially, if the video capture format requires a palette, the capture window uses the palette supplied by the capture driver. This palette might consist of gray-scale values for black-and-white reproduction, or a broad selection of color values. You can retrieve an existing palette to replace the default palette by using the <a href="wm-cap-pal-paste.html"><strong>WM_CAP_PAL_PASTE</strong></a> or <a href="wm-cap-pal-open.html"><strong>WM_CAP_PAL_OPEN</strong></a> message (or the <a href="/windows/desktop/api/Vfw/nf-vfw-cappalettepaste"><strong>capPalettePaste</strong></a> or <a href="/windows/desktop/api/Vfw/nf-vfw-cappaletteopen"><strong>capPaletteOpen</strong></a> macro). Alternatively, you can create a custom palette to replace the default palette by using the <a href="wm-cap-pal-autocreate.html"><strong>WM_CAP_PAL_AUTOCREATE</strong></a> or <a href="wm-cap-pal-manualcreate.html"><strong>WM_CAP_PAL_MANUALCREATE</strong></a> message (or the <a href="/windows/desktop/api/Vfw/nf-vfw-cappaletteauto"><strong>capPaletteAuto</strong></a> or <a href="/windows/desktop/api/Vfw/nf-vfw-cappalettemanual"><strong>capPaletteManual</strong></a> macro). After you replace the default palette, the capture window and driver use the replacement palette until you create or open another palette.</p>
<p>The WM_CAP_PAL_AUTOCREATE or WM_CAP_PAL_MANUALCREATE message creates an optimized palette based on the current video input. This custom palette gives a video sequence the best color fidelity because it is based on colors that exist in the sequence. The capture window creates a three-dimensional histogram of the colors it samples. It reduces the number of colors by examining the absolute error between adjacent colors and consolidating those with the smallest error value.</p>
<p>When sending WM_CAP_PAL_AUTOCREATE, you must specify the number of frames for AVICap to sample, and specify the size of the color palette. When specifying the number of frames, include enough frames to ensure that all colors in the sequence are sampled.</p>
<p>You can sample the current frame by using WM_CAP_PAL_MANUALCREATE. By using this message with several manually selected frames, you can create a palette that contains the colors you want to appear in the palette.</p>
<p>A palette can contain up to 256 colors. If you merge palettes or if the video sequence is to be displayed simultaneously with other video or images, you should use a smaller color selection so that colors from each image or video clip can coexist.</p>
<p>You save a new palette by using the <a href="wm-cap-pal-save.html"><strong>WM_CAP_PAL_SAVE</strong></a> message (or the <a href="/windows/desktop/api/Vfw/nf-vfw-cappalettesave"><strong>capPaletteSave</strong></a> macro) and later retrieve it by using the <a href="wm-cap-pal-open.html"><strong>WM_CAP_PAL_OPEN</strong></a> message. You can save a palette for post-processing of the palette or for use in another application.</p>
<p>You can paste a palette from the clipboard into the capture window by using the <a href="wm-cap-pal-paste.html"><strong>WM_CAP_PAL_PASTE</strong></a> message. The capture window passes the palette to the capture driver. Other applications can copy palettes to the clipboard. You can also copy a palette to the clipboard by using the <a href="wm-cap-edit-copy.html"><strong>WM_CAP_EDIT_COPY</strong></a> message (or the <a href="/windows/desktop/api/Vfw/nf-vfw-capeditcopy"><strong>capEditCopy</strong></a> macro). This message copies the video frame buffer, including the palette, onto the clipboard.</p>
<p>Â </p>
<p>Â </p>
</body>
