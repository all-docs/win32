<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MCIWNDM_GETMODE message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MCIWNDM_GETMODE message (Vfw.h)
description: The MCIWNDM_GETMODE message retrieves the current operating mode of an MCI device. MCI devices have several operating modes, which are designated by constants. You can send this message explicitly or by using the MCIWndGetMode macro.
ms.assetid: cc327281-434e-4047-9e15-c04a10953f47
keywords:</p>
<ul>
<li>MCIWNDM_GETMODE message Windows Multimedia
topic_type:</li>
<li>apiref
api_name:</li>
<li>MCIWNDM_GETMODE
api_location:</li>
<li>Vfw.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MCIWNDM_GETMODE message</h1>
<p>The <strong>MCIWNDM_GETMODE</strong> message retrieves the current operating mode of an MCI device. MCI devices have several operating modes, which are designated by constants. You can send this message explicitly or by using the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndgetmode"><strong>MCIWndGetMode</strong></a> macro.</p>
<pre lang="C++"><code>MCIWNDM_GETMODE 
wParam = (WPARAM) (UINT) len; 
lParam = (LPARAM) (LPSTR) lp; 
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>len</em></p>
<!-- raw HTML omitted -->
<p>Size, in bytes, of the buffer.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>lp</em></p>
<!-- raw HTML omitted -->
<p>Pointer to the application-defined buffer used to return the mode.</p>
<!-- raw HTML omitted -->
<h2>Return Value</h2>
<p>Returns an integer corresponding to the MCI constant defining the mode.</p>
<h2>Remarks</h2>
<p>If the null-terminated string describing the mode is longer than the buffer, it is truncated.</p>
<p>Not all devices can operate in every mode. For example, the MCIAVI device is a playback device; it doesn't support the recording mode. The following modes can be retrieved by using <strong>MCIWNDM_GETMODE</strong>.</p>
<table>
<thead>
<tr>
<th>Operating mode</th>
<th>MCI constant</th>
</tr>
</thead>
<tbody>
<tr>
<td>not ready</td>
<td>MCI_MODE_NOT_READY</td>
</tr>
<tr>
<td>open</td>
<td>MCI_MODE_OPEN</td>
</tr>
<tr>
<td>paused</td>
<td>MCI_MODE_PAUSE</td>
</tr>
<tr>
<td>playing</td>
<td>MCI_MODE_PLAY</td>
</tr>
<tr>
<td>recording</td>
<td>MCI_MODE_RECORD</td>
</tr>
<tr>
<td>seeking</td>
<td>MCI_MODE_SEEK</td>
</tr>
<tr>
<td>stopped</td>
<td>MCI_MODE_STOP</td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Vfw.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Vfw/nf-vfw-mciwndgetmode"><strong>MCIWndGetMode</strong></a></p>
<!-- raw HTML omitted -->
</body>
