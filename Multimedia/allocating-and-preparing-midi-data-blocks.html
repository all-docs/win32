<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Allocating and Preparing MIDI Data Blocks</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Allocating and Preparing MIDI Data Blocks
description: Allocating and Preparing MIDI Data Blocks
ms.assetid: b3a70441-e8f9-4886-bf22-426ebd74d045
keywords:</p>
<ul>
<li>Musical Instrument Digital Interface (MIDI),allocating data blocks</li>
<li>MIDI (Musical Instrument Digital Interface),allocating data blocks</li>
<li>MIDI services,allocating data blocks</li>
<li>allocating MIDI data blocks</li>
<li>Musical Instrument Digital Interface (MIDI),preparing data blocks</li>
<li>MIDI (Musical Instrument Digital Interface),preparing data blocks</li>
<li>MIDI services,preparing data blocks</li>
<li>preparing MIDI data blocks</li>
<li>Musical Instrument Digital Interface (MIDI),data blocks</li>
<li>MIDI (Musical Instrument Digital Interface),data blocks</li>
<li>MIDI services,data blocks
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Allocating and Preparing MIDI Data Blocks</h1>
<p>The <a href="/windows/win32/api/mmeapi/nf-mmeapi-midioutlongmsg"><strong>midiOutLongMsg</strong></a>, <a href="/windows/win32/api/mmeapi/nf-mmeapi-midiinaddbuffer"><strong>midiInAddBuffer</strong></a>, and <a href="/windows/win32/api/mmeapi/nf-mmeapi-midistreamout"><strong>midiStreamOut</strong></a> functions require that applications to allocate data blocks to pass to the device drivers for playback or recording purposes. Each of these functions uses a <a href="/windows/win32/api/mmeapi/ns-mmeapi-midihdr"><strong>MIDIHDR</strong></a> structure to describe its data block.</p>
<p>Before you use one of these functions to pass a data block to a device driver, you must allocate memory for the buffer and the header structure that describes the data block.</p>
<p>Windows provides the following functions for preparing and cleaning up MIDI data blocks.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/mmeapi/nf-mmeapi-midiinprepareheader"><strong>midiInPrepareHeader</strong></a></td>
<td>Prepares a MIDI input data block.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/mmeapi/nf-mmeapi-midiinunprepareheader"><strong>midiInUnprepareHeader</strong></a></td>
<td>Cleans up the preparation of a MIDI input data block.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/mmeapi/nf-mmeapi-midioutprepareheader"><strong>midiOutPrepareHeader</strong></a></td>
<td>Prepares a MIDI output data block.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/mmeapi/nf-mmeapi-midioutunprepareheader"><strong>midiOutUnprepareHeader</strong></a></td>
<td>Cleans up the preparation of a MIDI output data block.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Before you pass a MIDI data block to a device driver, you must prepare the buffer by passing it to the <a href="/windows/win32/api/mmeapi/nf-mmeapi-midiinprepareheader"><strong>midiInPrepareHeader</strong></a> or <a href="/windows/win32/api/mmeapi/nf-mmeapi-midioutprepareheader"><strong>midiOutPrepareHeader</strong></a> function. When the device driver is finished with the buffer and returns it, you must clean up this preparation by passing the buffer to the <a href="/windows/win32/api/mmeapi/nf-mmeapi-midiinunprepareheader"><strong>midiInUnprepareHeader</strong></a> or <a href="/windows/win32/api/mmeapi/nf-mmeapi-midioutunprepareheader"><strong>midiOutUnprepareHeader</strong></a> function before any allocated memory can be freed.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="midi-services.html">MIDI Services</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
