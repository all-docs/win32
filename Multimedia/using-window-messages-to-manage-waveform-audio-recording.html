<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Window Messages to Manage Waveform-Audio Recording</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Using Window Messages to Manage Waveform-Audio Recording
description: Using Window Messages to Manage Waveform-Audio Recording
ms.assetid: 65637d51-9d30-48db-8681-48332442130e
keywords:</p>
<ul>
<li>waveform audio,managing recording with messages</li>
<li>waveform-audio interface,managing recording with messages</li>
<li>recording waveform audio,managing recording with messages</li>
<li>waveform audio,messages</li>
<li>waveform-audio interface,messages</li>
<li>recording waveform audio,messages</li>
<li>MM_WIM_CLOSE message</li>
<li>MM_WIM_DATA message</li>
<li>MM_WIM_OPEN message
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Using Window Messages to Manage Waveform-Audio Recording</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/waveform-audio">Waveform Audio</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/coreaudio/wasapi">WASAPI</a> and <a href="/windows/uwp/audio-video-camera/audio-graphs">Audio Graphs</a>. <strong>WASAPI</strong> and <strong>Audio Graphs</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>WASAPI</strong> and <strong>Audio Graphs</strong> instead of <strong>Waveform Audio</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The following messages can be sent to a window procedure function for managing waveform-audio recording.</p>
<table>
<thead>
<tr>
<th>Message</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="mm-wim-close.html"><strong>MM_WIM_CLOSE</strong></a></td>
<td>Sent when the device is closed by using the <a href="/windows/win32/api/mmeapi/nf-mmeapi-waveinclose"><strong>waveInClose</strong></a> function.</td>
</tr>
<tr>
<td><a href="mm-wim-data.html"><strong>MM_WIM_DATA</strong></a></td>
<td>Sent when the device driver is finished with a buffer sent by using the <a href="/windows/win32/api/mmeapi/nf-mmeapi-waveinaddbuffer"><strong>waveInAddBuffer</strong></a> function.</td>
</tr>
<tr>
<td><a href="mm-wim-open.html"><strong>MM_WIM_OPEN</strong></a></td>
<td>Sent when the device is opened by using the <a href="/windows/win32/api/mmeapi/nf-mmeapi-waveinopen"><strong>waveInOpen</strong></a> function.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The <em>lParam</em> parameter of <a href="mm-wim-data.html"><strong>MM_WIM_DATA</strong></a> specifies a pointer to a <a href="/windows/win32/api/mmeapi/ns-mmeapi-wavehdr"><strong>WAVEHDR</strong></a> structure that identifies the buffer. This buffer might not be completely filled with waveform-audio data; recording can stop before the buffer is filled. Use the <strong>dwBytesRecorded</strong> member of the <strong>WAVEHDR</strong> structure to determine the amount of valid data present in the buffer.</p>
<p>The most useful message is probably <a href="mm-wim-data.html"><strong>MM_WIM_DATA</strong></a>. When your application finishes using the data block sent by the device driver, you can clean up and free the data block. Unless you need to allocate memory or initialize variables, you probably do not need to use the <a href="mm-wim-open.html"><strong>MM_WIM_OPEN</strong></a> and <a href="mm-wim-close.html"><strong>MM_WIM_CLOSE</strong></a> messages.</p>
<p>The callback function for waveform-audio input devices is supplied by the application. For information about this callback function, see the <a href="/previous-versions//dd743849(v=vs.85)"><strong>waveInProc</strong></a> function.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="recording-waveform-audio.html">Recording Waveform Audio</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
