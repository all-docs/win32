<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MCI_INFO command</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MCI_INFO command (Mmsystem.h)
description: The MCI_INFO command retrieves string information from a device.
ms.assetid: aed3fed3-87b9-4673-9171-4f57770d765c
keywords:</p>
<ul>
<li>MCI_INFO command Windows Multimedia
topic_type:</li>
<li>apiref
api_name:</li>
<li>MCI_INFO
api_location:</li>
<li>Mmsystem.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MCI_INFO command</h1>
<p>The MCI_INFO command retrieves string information from a device. All devices recognize this command. Information is returned in the <strong>lpstrReturn</strong> member of the structure identified by <em>lpInfo</em>. The <strong>dwRetSize</strong> member specifies the buffer length for the returned data.</p>
<p>To send this command, call the <a href="/previous-versions//dd757160(v=vs.85)"><strong>mciSendCommand</strong></a> function with the following parameters.</p>
<pre lang="C++"><code>MCIERROR mciSendCommand(
  MCIDEVICEID wDeviceID, 
  MCI_INFO, 
  DWORD dwFlags, 
  (DWORD) (LPMCI_INFO_PARMS) lpInfo
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>wDeviceID</em></p>
<!-- raw HTML omitted -->
<p>Device identifier of the MCI device that is to receive the command message.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>dwFlags</em></p>
<!-- raw HTML omitted -->
<p>MCI_NOTIFY, MCI_WAIT, or, for digital-video and VCR devices, MCI_TEST. For information about these flags, see <a href="the-wait-notify-and-test-flags.html">The Wait, Notify, and Test Flags</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>lpInfo</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <a href="mci-info-parms.html"><strong>MCI_INFO_PARMS</strong></a> structure. (Devices with extended command sets might replace this structure with a device-specific structure.)</p>
<!-- raw HTML omitted -->
<h2>Return Value</h2>
<p>Returns zero if successful or an error otherwise.</p>
<h2>Remarks</h2>
<p>The following additional standard and command-specific flag applies to all devices supporting MCI_INFO:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_INFO_PRODUCT</p>
<!-- raw HTML omitted -->
<p>Obtains a description of the hardware associated with a device. Devices should supply a description that identifies both the driver and the hardware used.</p>
<!-- raw HTML omitted -->
<p>The following additional flags apply to the <strong>cdaudio</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_INFO_MEDIA_IDENTITY</p>
<!-- raw HTML omitted -->
<p>Produces a unique identifier for the audio CD currently loaded in the player being queried. This flag returns a string of 16 hexadecimal digits.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_INFO_MEDIA_UPC</p>
<!-- raw HTML omitted -->
<p>Produces the Universal Product Code (UPC) that is encoded on an audio CD. The UPC is a string of digits. It might not be available for all CDs.</p>
<!-- raw HTML omitted -->
<p>The following additional flags apply to the <strong>digitalvideo</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_INFO_ITEM</p>
<!-- raw HTML omitted -->
<p>A constant indicating the information desired is included in the <strong>dwItem</strong> member of the structure identified by <em>lpInfo</em>. The following constants are defined for digital-video devices:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_INFO_AUDIO_ALG</p>
<!-- raw HTML omitted -->
<p>Returns the name for the current audio compression algorithm.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_INFO_AUDIO_QUALITY</p>
<!-- raw HTML omitted -->
<p>Returns the name for the current audio quality descriptor.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_INFO_STILL_ALG</p>
<!-- raw HTML omitted -->
<p>Returns the name for the current still image compression algorithm.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_INFO_STILL_QUALITY</p>
<!-- raw HTML omitted -->
<p>Returns the name for the current still image quality descriptor.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_INFO_USAGE</p>
<!-- raw HTML omitted -->
<p>Returns a string describing usage restrictions that might be imposed by the owner of the visual or audible data in the workspace.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_INFO_VIDEO_ALG</p>
<!-- raw HTML omitted -->
<p>Returns the name for the current video compression algorithm.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_INFO_VIDEO_QUALITY</p>
<!-- raw HTML omitted -->
<p>Returns the name for the current video quality descriptor.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_INFO_VERSION</p>
<!-- raw HTML omitted -->
<p>Returns the release level of the device driver and hardware. Device driver developers must document the syntax of the returned string.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_INFO_TEXT</p>
<!-- raw HTML omitted -->
<p>Obtains the window caption.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_INFO_FILE</p>
<!-- raw HTML omitted -->
<p>Obtains the path and filename of the last file specified with the <a href="mci-open.html">MCI_OPEN</a> or <a href="mci-load.html">MCI_LOAD</a> command. If a file has not been specified, the device returns a null-terminated string. This flag is supported only by devices that return <strong>TRUE</strong> to the MCI_GETDEVCAPS_USES_FILES flag of the <a href="mci-getdevcaps.html">MCI_GETDEVCAPS</a> command.</p>
<!-- raw HTML omitted -->
<p>For digital-video devices, <em>lpInfo</em> points to an <a href="/windows/desktop/api/Digitalv/ns-digitalv-mci_dgv_info_parmsa"><strong>MCI_DGV_INFO_PARMS</strong></a> structure.</p>
<p>The following additional flags apply to the <strong>sequencer</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_INFO_COPYRIGHT</p>
<!-- raw HTML omitted -->
<p>Obtains the MIDI file copyright notice from the copyright meta event.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_INFO_FILE</p>
<!-- raw HTML omitted -->
<p>Obtains the filename of the current file. This flag is supported only by devices that return <strong>TRUE</strong> when you call the <a href="mci-getdevcaps.html">MCI_GETDEVCAPS</a> command with the MCI_GETDEVCAPS_USES_FILES flag.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_INFO_NAME</p>
<!-- raw HTML omitted -->
<p>Obtains the sequence name from the sequence/track name meta event.</p>
<!-- raw HTML omitted -->
<p>The following additional flag applies to the <strong>vcr</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_VCR_INFO_VERSION</p>
<!-- raw HTML omitted -->
<p>Sets <strong>lpstrReturn</strong> member of the <a href="mci-info-parms.html"><strong>MCI_INFO_PARMS</strong></a> structure to point to the version number. Also sets the <strong>dwRetSize</strong> member equal to the length of the string pointed to.</p>
<!-- raw HTML omitted -->
<p>The following additional flags apply to the <strong>overlay</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_INFO_FILE</p>
<!-- raw HTML omitted -->
<p>Obtains the filename of the current file. This flag is supported only by devices that return <strong>TRUE</strong> to the MCI_GETDEVCAPS_USES_FILES flag of the <a href="mci-getdevcaps.html">MCI_GETDEVCAPS</a> command.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OVLY_INFO_TEXT</p>
<!-- raw HTML omitted -->
<p>Obtains the caption of the window associated with the video-overlay device.</p>
<!-- raw HTML omitted -->
<p>The following additional flags apply to the <strong>waveaudio</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_INFO_FILE</p>
<!-- raw HTML omitted -->
<p>Obtains the filename of the current file. This flag is supported by devices that return <strong>TRUE</strong> when you call the <a href="mci-getdevcaps.html">MCI_GETDEVCAPS</a> command with the MCI_GETDEVCAPS_USES_FILES flag.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_WAVE_INPUT</p>
<!-- raw HTML omitted -->
<p>Obtains the product name of the current input.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_WAVE_OUTPUT</p>
<!-- raw HTML omitted -->
<p>Obtains the product name of the current output and its value is device specific.</p>
<!-- raw HTML omitted -->
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mmsystem.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="mci.html">MCI</a></p>
<!-- raw HTML omitted -->
<p><a href="mci-commands.html">MCI Commands</a></p>
<!-- raw HTML omitted -->
</body>
