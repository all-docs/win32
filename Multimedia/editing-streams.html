<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Editing Streams</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Editing Streams
description: Editing Streams
ms.assetid: 1653ff90-e96a-43fc-b509-6d8ad4ddcd2c
keywords:</p>
<ul>
<li>CreateEditableStream function</li>
<li>EditStreamCut function</li>
<li>EditStreamCopy function</li>
<li>EditStreamPaste function</li>
<li>EditStreamClone function</li>
<li>EditStreamSetInfo function
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Editing Streams</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/avifile-functions-and-macros">AVIFile Functions and Macros</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/medfound/source-reader">Source Reader</a>. <strong>Source Reader</strong> has been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Source Reader</strong> instead of <strong>AVIFile Functions and Macros</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>You can create a stream that you can edit by using the <a href="/windows/desktop/api/Vfw/nf-vfw-createeditablestream"><strong>CreateEditableStream</strong></a> function. This function initializes the environment for editing a stream. This includes creating an interface to the new stream, and internal edit tables that track changes made to the stream. <strong>CreateEditableStream</strong> returns a stream pointer to an editable stream that is required by other stream-editing functions. The editable stream pointer can also be used by other AVIFile functions that accept stream pointers.</p>
<p>You can cut one or more samples from an editable stream by using the <a href="/windows/desktop/api/Vfw/nf-vfw-editstreamcut"><strong>EditStreamCut</strong></a> function. To remove samples from the editable stream, this function adds an entry to the edit table. The function then places a copy of the cut samples in a new temporary stream whose interface pointer is returned in a variable.</p>
<p>You can copy one or more samples from an editable stream into a temporary stream by using the <a href="/windows/desktop/api/Vfw/nf-vfw-editstreamcopy"><strong>EditStreamCopy</strong></a> function. <strong>EditStreamCopy</strong> places copies of the samples in a new temporary stream whose interface pointer is returned in a variable.</p>
<p>You can copy one or more samples from a stream and paste them into an editable stream by using the <a href="/windows/desktop/api/Vfw/nf-vfw-editstreampaste"><strong>EditStreamPaste</strong></a> function. To insert the samples at the specified position, this function adds an entry in the edit table of the target editable stream.</p>
<p>You can duplicate an editable stream by using the <a href="/windows/desktop/api/Vfw/nf-vfw-editstreamclone"><strong>EditStreamClone</strong></a> function. This function returns a pointer to the stream interface of the new stream. You can copy these streams to the clipboard or use them to maintain a trail of edits made to a stream.</p>
<p>You can change several of the characteristics of an editable stream by using the <a href="/windows/desktop/api/Vfw/nf-vfw-editstreamsetinfoa"><strong>EditStreamSetInfo</strong></a> function. This function updates the priority setting, language, scale and rate, starting time, quality setting, destination rectangle dimensions and coordinates, and the textual description of the stream. These items are stored in the <a href="/windows/desktop/api/Vfw/ns-vfw-avistreaminfoa"><strong>AVISTREAMINFO</strong></a> structure associated with the editable stream.</p>
<p>You can also change the textual description of an editable stream by using the <a href="/windows/desktop/api/Vfw/nf-vfw-editstreamsetnamea"><strong>EditStreamSetName</strong></a> function. This function updates the <strong>szName</strong> member of the <strong>AVISTREAMINFO</strong> structure associated with the editable stream.</p>
<p>The editing functions work on streams. You need to cut and paste each stream individually, and then use the <a href="/windows/desktop/api/Vfw/nf-vfw-avimakefilefromstreams"><strong>AVIMakeFileFromStreams</strong></a> function to create a new file pointer.</p>
<blockquote>
<p>[!Note]<br />
The edit tables in an editable stream maintain all the changes for a stream. The source stream is never changed.</p>
</blockquote>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
