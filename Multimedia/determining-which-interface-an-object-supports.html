<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Determining Which Interface an Object Supports</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Determining Which Interface an Object Supports
description: Determining Which Interface an Object Supports
ms.assetid: cf2aacb7-5315-4907-a49b-3eb3bbfd13d1
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>Determining Which Interface an Object Supports</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/custom-file-and-stream-handlers">Custom File and Stream Handlers</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Core.MediaStreamSource">MediaStreamSource class</a>. <strong>MediaStreamSource class</strong> has been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaStreamSource class</strong> instead of <strong>Custom File and Stream Handlers</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The <strong>QueryInterface</strong> method lets an application query an object to determine which interfaces it supports. The sample application sets the <em>ppv</em> pointer to the current interface.</p>
<pre lang="C++"><code>STDMETHODIMP CAVIFileCF::QueryInterface( 
    const IID FAR&amp; iid, 
    void FAR* FAR* ppv) 
{ 
    if (iid == IID_IUnknown) 
        *ppv = this;                     // set the interface pointer 
                                         // to this instance 
    else if (iid == IID_IClassFactory) 
        *ppv = this;                     // second chance to set the 
                                         // interface pointer to this 
                                         // instance 
    else 
        return ResultFromScode(E_NOINTERFACE); 
    AddRef();  //Increment the reference count 
    return NULL; 
} 

</code></pre>
<p>Â </p>
<p>Â </p>
</body>
