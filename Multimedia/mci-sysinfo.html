<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MCI_SYSINFO command</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MCI_SYSINFO command (Mmsystem.h)
description: The MCI_SYSINFO command retrieves information about MCI devices.
ms.assetid: 605efd25-8849-42aa-99fd-b36b6fd2c7b7
keywords:</p>
<ul>
<li>MCI_SYSINFO command Windows Multimedia
topic_type:</li>
<li>apiref
api_name:</li>
<li>MCI_SYSINFO
api_location:</li>
<li>Mmsystem.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MCI_SYSINFO command</h1>
<p>The MCI_SYSINFO command retrieves information about MCI devices. MCI supports this command directly rather than passing it to the device. Any MCI application can use this command. String information is returned in the application-supplied buffer pointed to by the <strong>lpstrReturn</strong> member of the structure identified by <em>lpSysInfo</em>. Numeric information is returned as a <strong>DWORD</strong> value placed in the application-supplied buffer. The <strong>dwRetSize</strong> member specifies the buffer length.</p>
<p>To send this command, call the <a href="/previous-versions//dd757160(v=vs.85)"><strong>mciSendCommand</strong></a> function with the following parameters.</p>
<pre lang="C++"><code>MCIERROR mciSendCommand(
  MCIDEVICEID wDeviceID, 
  MCI_SYSINFO, 
  DWORD dwFlags, 
  (DWORD) (LPMCI_SYSINFO_PARMS) lpSysInfo
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>wDeviceID</em></p>
<!-- raw HTML omitted -->
<p>Device identifier of the MCI device that is to receive the command message.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>dwFlags</em></p>
<!-- raw HTML omitted -->
<p>One or more of the following standard and command-specific flags:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_SYSINFO_INSTALLNAME</p>
<!-- raw HTML omitted -->
<p>Obtains the name (listed in the registry or the SYSTEM.INI file) used to install the device.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_SYSINFO_NAME</p>
<!-- raw HTML omitted -->
<p>Obtains a device name corresponding to the device number specified in the <strong>dwNumber</strong> member of the structure identified by<strong>lpSysInfo</strong>. If the MCI_SYSINFO_OPEN flag is set, MCI returns the names of open devices.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_SYSINFO_OPEN</p>
<!-- raw HTML omitted -->
<p>Obtains the quantity or name of open devices.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_SYSINFO_QUANTITY</p>
<!-- raw HTML omitted -->
<p>Obtains the number of devices of the specified type that are listed in the registry or the [mci] section of the SYSTEM.INI file. If the MCI_SYSINFO_OPEN flag is set, the number of open devices is returned.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>lpSysInfo</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <a href="mci-sysinfo-parms.html"><strong>MCI_SYSINFO_PARMS</strong></a> structure.</p>
<!-- raw HTML omitted -->
<h2>Return Value</h2>
<p>Returns zero if successful or an error otherwise.</p>
<h2>Remarks</h2>
<p>The <strong>wDeviceType</strong> member of the structure identified by <em>lpSysInfo</em> is used to indicate the device type of the query. If the <em>wDeviceID</em> parameter is set to MCI_ALL_DEVICE_ID, it overrides the value of <strong>wDeviceType</strong>. For a list of device types, see <a href="mci-device-types.html">MCI Device Types</a>.</p>
<p>Integer return values are <strong>DWORD</strong> values returned in the buffer pointed to by the <strong>lpstrReturn</strong> member of the structure identified by <em>lpSysInfo</em>.</p>
<p>String return values are null-terminated strings returned in the buffer pointed to by the <strong>lpstrReturn</strong> member of the structure identified by <em>lpSysInfo</em>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mmsystem.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="mci.html">MCI</a></p>
<!-- raw HTML omitted -->
<p><a href="mci-commands.html">MCI Commands</a></p>
<!-- raw HTML omitted -->
</body>
