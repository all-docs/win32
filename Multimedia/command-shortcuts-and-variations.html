<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Command Shortcuts and Variations</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Command Shortcuts and Variations
description: Command Shortcuts and Variations
ms.assetid: 4f854c78-435c-4a10-8938-645ad605fff3
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>Command Shortcuts and Variations</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/mci">MCI</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>. <strong>MediaPlayer</strong> has been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong> instead of <strong>MCI</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>You can use several shortcuts when working with MCI commands. These shortcuts enable you to use a single identifier to refer to all the devices your application has opened, or to open a device without explicitly issuing an <a href="open.html"><strong>open</strong></a> (<a href="mci-open.html"><strong>MCI_OPEN</strong></a>) command.</p>
<p>You can specify &quot;all&quot; (MCI_ALL_DEVICE_ID) as a device identifier for any command that does not return information. When you specify &quot;all&quot;, MCI sends the command sequentially to all devices opened by the current application.</p>
<p>For example, the <a href="close.html"><strong>close</strong></a> &quot;all&quot; command closes all open devices and the <a href="play.html"><strong>play</strong></a> &quot;all&quot; command starts playing all devices opened by the application. Because MCI sequentially sends the commands to the MCI devices, there is an interval between when the first and last devices receive the command.</p>
<p>Using &quot;all&quot; is a convenient way to broadcast a command to all your devices, but you should not rely on it to synchronize devices; the timing between messages can vary.</p>
<p>When you issue a command and specify a device that is not open, MCI tries to open the device before implementing the command. The following rules apply to automatically opening devices:</p>
<ul>
<li>The automatic open feature works only with the command-string interface.</li>
<li>The automatic open feature fails for commands that are specific to custom device drivers.</li>
<li>Automatically opened devices do not respond to commands that use &quot;all&quot; as a device name.</li>
<li>The automatic open feature does not let your application specify the &quot;type&quot; flag. Without the device name, MCI determines the device name from the entries in the registry. To use a specific device, you can combine the device name with the filename by using the exclamation point, as described in the reference material for the <a href="open.html"><strong>open</strong></a> command.</li>
</ul>
<p>If an application uses the automatic open feature to open a device, the application should check the return value of every subsequent open command to verify that the device is still open. MCI also automatically closes any device that it automatically opens. MCI typically closes a device in the following situations:</p>
<ul>
<li>The command is completed.</li>
<li>You abort the command.</li>
<li>You request notification in a subsequent command.</li>
<li>MCI detects a failure.</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
