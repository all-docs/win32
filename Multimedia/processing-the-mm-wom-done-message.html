<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Processing the MM_WOM_DONE Message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Processing the MM_WOM_DONE Message
description: Processing the MM_WOM_DONE Message
ms.assetid: 215167d0-3020-453d-b6b3-cee5803836c9
keywords:</p>
<ul>
<li>waveform audio,messages</li>
<li>auxiliary audio,messages</li>
<li>waveform audio,MM_WOM_DONE message</li>
<li>auxiliary audio,MM_WOM_DONE message</li>
<li>MM_WOM_DONE message
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Processing the MM_WOM_DONE Message</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/waveform-audio">Waveform Audio</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/coreaudio/wasapi">WASAPI</a> and <a href="/windows/uwp/audio-video-camera/audio-graphs">Audio Graphs</a>. <strong>WASAPI</strong> and <strong>Audio Graphs</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>WASAPI</strong> and <strong>Audio Graphs</strong> instead of <strong>Waveform Audio</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The following example shows how to process the <a href="mm-wom-done.html"><strong>MM_WOM_DONE</strong></a> message. This example assumes the application does not play multiple data blocks, so it can close the output device after playing a single data block.</p>
<pre lang="C++"><code>// WndProc--Main window procedure. 
LRESULT FAR PASCAL WndProc(HWND hWnd, UINT msg, WPARAM wParam, 
    LPARAM lParam) 
{ 
switch (msg) 
{ 
    case MM_WOM_DONE: 
 
    // A waveform-audio data block has been played and 
    // can now be freed. 
    waveOutUnprepareHeader((HWAVEOUT) wParam, 
        (LPWAVEHDR) lParam, sizeof(WAVEHDR) ); 
    
    // Free hData memory. 
    
    waveOutClose((HWAVEOUT) wParam); 
    break; 
    } 
    return DefWindowProc(hWnd, msg, wParam, lParam); 
} 
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
