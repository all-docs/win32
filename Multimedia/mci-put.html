<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MCI_PUT command</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MCI_PUT command (Mmsystem.h)
description: The MCI_PUT command sets the source, destination, and frame rectangles. Digital-video and video-overlay devices recognize this command.
ms.assetid: 9d81682b-6546-4e6d-a6df-e2de8c013b66
keywords:</p>
<ul>
<li>MCI_PUT command Windows Multimedia
topic_type:</li>
<li>apiref
api_name:</li>
<li>MCI_PUT
api_location:</li>
<li>Mmsystem.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MCI_PUT command</h1>
<p>The MCI_PUT command sets the source, destination, and frame rectangles. Digital-video and video-overlay devices recognize this command.</p>
<p>To send this command, call the <a href="/previous-versions//dd757160(v=vs.85)"><strong>mciSendCommand</strong></a> function with the following parameters.</p>
<pre lang="C++"><code>MCIERROR mciSendCommand(
  MCIDEVICEID wDeviceID, 
  MCI_PUT, 
  DWORD dwFlags, 
  (DWORD) (LPMCI_GENERIC_PARMS) lpDest
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>wDeviceID</em></p>
<!-- raw HTML omitted -->
<p>Device identifier of the MCI device that is to receive the command message.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>dwFlags</em></p>
<!-- raw HTML omitted -->
<p>MCI_NOTIFY, MCI_WAIT, or, for digital-video devices, MCI_TEST. For information about these flags, see <a href="the-wait-notify-and-test-flags.html">The Wait, Notify, and Test Flags</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>lpDest</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <a href="mci-generic-parms.html"><strong>MCI_GENERIC_PARMS</strong></a> structure. (Devices with extended command sets might replace this structure with a device-specific structure.)</p>
<!-- raw HTML omitted -->
<h2>Return Value</h2>
<p>Returns zero if successful or an error otherwise.</p>
<h2>Remarks</h2>
<p>The following additional flags are used with the <strong>digitalvideo</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_PUT_CLIENT</p>
<!-- raw HTML omitted -->
<p>The rectangle defined for MCI_DGV_RECT applies to the position of the client window. The rectangle specified is relative to the parent window of the display window. MCI_DGV_PUT_WINDOW must be set concurrently with this flag.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_PUT_DESTINATION</p>
<!-- raw HTML omitted -->
<p>The rectangle defined for MCI_DGV_RECT specifies a destination rectangle. The destination rectangle specifies the portion of the client window associated with this device driver instance that shows the image or video.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_PUT_FRAME</p>
<!-- raw HTML omitted -->
<p>The rectangle defined for MCI_DGV_RECT applies to the frame rectangle. The frame rectangle specifies the portion of the frame buffer used as the destination of the video images obtained from the video rectangle. The video should be scaled to fit within the frame buffer rectangle.</p>
<p>The rectangle is specified in frame buffer coordinates. The default rectangle is the full frame buffer. Specifying this rectangle lets the device scale the image as it digitizes the data. Devices that cannot scale the image reject this command with MCIERR_UNSUPPORTED_FUNCTION. You can use the MCI_GETDEVCAPS_CAN_STRETCH flag with the <a href="mci-getdevcaps.html">MCI_GETDEVCAPS</a> command to determine if a device scales the image. A device returns <strong>FALSE</strong> if it cannot scale the image.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_PUT_SOURCE</p>
<!-- raw HTML omitted -->
<p>The rectangle defined for MCI_DGV_RECT specifies a source rectangle. The source rectangle specifies which portion of the frame buffer is to be scaled to fit into the destination rectangle.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_PUT_VIDEO</p>
<!-- raw HTML omitted -->
<p>The rectangle defined for MCI_DGV_RECT applies to the video rectangle. The video rectangle specifies which portion of the current presentation source is stored in the frame buffer. The rectangle is specified using the natural coordinates of the presentation source. It allows the specification of cropping that occurs prior to storing images and video in the frame buffer. The default rectangle is the full active scan area or the full decompressed images and video.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_PUT_WINDOW</p>
<!-- raw HTML omitted -->
<p>The rectangle defined for MCI_DGV_RECT applies to the display window. This rectangle is relative to the parent window of the display window (usually the desktop). If the window is not specified, it defaults to the initial window size and position.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_RECT</p>
<!-- raw HTML omitted -->
<p>The <strong>rc</strong> member of the structure identified by <em>lpDest</em> contains a valid rectangle.</p>
<!-- raw HTML omitted -->
<p>For digital-video devices, <em>lpDest</em> points to an <a href="/previous-versions//dd743397(v=vs.85)"><strong>MCI_DGV_PUT_PARMS</strong></a> structure.</p>
<p>The following additional flags are used with the <strong>overlay</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OVLY_PUT_DESTINATION</p>
<!-- raw HTML omitted -->
<p>The rectangle defined for MCI_OVLY_RECT specifies the area of the client window used to display an image. The rectangle contains the offset and visible extent of the image relative to the window origin. If the frame is being stretched, the source is stretched to the destination rectangle.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OVLY_PUT_FRAME</p>
<!-- raw HTML omitted -->
<p>The rectangle defined for MCI_OVLY_RECT specifies the area of the video buffer used to receive the video image. The rectangle contains the offset and extent of the buffer area relative to the video buffer origin.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OVLY_PUT_SOURCE</p>
<!-- raw HTML omitted -->
<p>The rectangle defined for MCI_OVLY_RECT specifies the area of the video buffer used as the source of the digital image. The rectangle contains the offset and extent of the clipping rectangle for the video buffer relative to its origin.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OVLY_PUT_VIDEO</p>
<!-- raw HTML omitted -->
<p>The rectangle defined for MCI_OVLY_RECT specifies the area of the video source capture by the video buffer. The rectangle contains the offset and extent of the clipping rectangle for the video source relative to its origin.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OVLY_RECT</p>
<!-- raw HTML omitted -->
<p>The <strong>rc</strong> member of the structure identified by <em>lpDest</em> contains a valid display rectangle. If this flag is not specified, the default rectangle matches the coordinates of the video buffer or window being clipped.</p>
<!-- raw HTML omitted -->
<p>For video-overlay devices, <em>lpDest</em> points to an <a href="mci-ovly-rect-parms.html"><strong>MCI_OVLY_RECT_PARMS</strong></a> structure.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mmsystem.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="mci.html">MCI</a></p>
<!-- raw HTML omitted -->
<p><a href="mci-commands.html">MCI Commands</a></p>
<!-- raw HTML omitted -->
</body>
