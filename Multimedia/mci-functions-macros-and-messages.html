<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MCI Functions Macros and Messages</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MCI Functions Macros and Messages
description: MCI Functions Macros and Messages
ms.assetid: 7cedc46f-f67b-4b1a-b1e0-7ac32c250132
keywords:</p>
<ul>
<li>MCI messages
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>MCI Functions Macros and Messages</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/mci">MCI</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>. <strong>MediaPlayer</strong> has been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong> instead of <strong>MCI</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>Most MCI applications use the <a href="/previous-versions//dd757161(v=vs.85)"><strong>mciSendString</strong></a> and <a href="/previous-versions//dd757160(v=vs.85)"><strong>mciSendCommand</strong></a> functions dozens of times. MCI provides some other useful functions that your application will use less frequently.</p>
<p>The device identifier required by most MCI commands is typically retrieved in a call to the <a href="open.html"><strong>open</strong></a> (<a href="mci-open.html"><strong>MCI_OPEN</strong></a>) command. If you need a device identifier but do not want to open the device â€” for example, if you want to query the capabilities of the device before taking any other action â€” you can call the <a href="/previous-versions//dd757156(v=vs.85)"><strong>mciGetDeviceID</strong></a> function.</p>
<p>The <a href="/previous-versions//dd757155(v=vs.85)"><strong>mciGetCreatorTask</strong></a> function allows your application to use a device identifier to retrieve a handle to the task that created that identifier.</p>
<p>You can use the <a href="/previous-versions//dd757159(v=vs.85)"><strong>mciGetYieldProc</strong></a> and <a href="/previous-versions//dd757163(v=vs.85)"><strong>mciSetYieldProc</strong></a> functions to assign and retrieve the address of the callback function associated with the &quot;wait&quot; (MCI_WAIT) flag.</p>
<p>The <a href="/previous-versions//dd757158(v=vs.85)"><strong>mciGetErrorString</strong></a> function retrieves a string that describes an MCI error value. Each string that MCI returns, whether data or an error description, is a maximum of 128 characters. Dialog box fields that are smaller than 128 characters will truncate the longer strings returned by MCI. For more information about these strings, see <a href="mcierr-return-values.html">MCIERR Return Values</a>.</p>
<p>The MCI macros are tools you can use to create and disassemble values that specify time formats. These time formats are used in many MCI commands. The formats acted on by the macros are hours/minutes/seconds (HMS), minutes/seconds/frames (MSF), and tracks/minutes/seconds/frames (TMSF). The following table lists the macros and their descriptions.</p>
<table>
<thead>
<tr>
<th>Macro</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="mci-hms-hour.html"><strong>MCI_HMS_HOUR</strong></a></td>
<td>Retrieves the hours component from an HMS value.</td>
</tr>
<tr>
<td><a href="mci-hms-minute.html"><strong>MCI_HMS_MINUTE</strong></a></td>
<td>Retrieves the minutes component from an HMS value.</td>
</tr>
<tr>
<td><a href="mci-hms-second.html"><strong>MCI_HMS_SECOND</strong></a></td>
<td>Retrieves the seconds component from an HMS value.</td>
</tr>
<tr>
<td><a href="mci-make-hms.html"><strong>MCI_MAKE_HMS</strong></a></td>
<td>Creates an HMS value.</td>
</tr>
<tr>
<td><a href="mci-make-msf.html"><strong>MCI_MAKE_MSF</strong></a></td>
<td>Creates an MSF value.</td>
</tr>
<tr>
<td><a href="mci-make-tmsf.html"><strong>MCI_MAKE_TMSF</strong></a></td>
<td>Creates a TMSF value.</td>
</tr>
<tr>
<td><a href="/previous-versions//dd743438(v=vs.85)"><strong>MCI_MSF_FRAME</strong></a></td>
<td>Retrieves the frames component from an MSF value.</td>
</tr>
<tr>
<td><a href="mci-msf-minute.html"><strong>MCI_MSF_MINUTE</strong></a></td>
<td>Retrieves the minutes component from an MSF value.</td>
</tr>
<tr>
<td><a href="mci-msf-second.html"><strong>MCI_MSF_SECOND</strong></a></td>
<td>Retrieves the seconds component from an MSF value.</td>
</tr>
<tr>
<td><a href="mci-tmsf-frame.html"><strong>MCI_TMSF_FRAME</strong></a></td>
<td>Retrieves the frames component from a TMSF value.</td>
</tr>
<tr>
<td><a href="mci-tmsf-minute.html"><strong>MCI_TMSF_MINUTE</strong></a></td>
<td>Retrieves the minutes component from a TMSF value.</td>
</tr>
<tr>
<td><a href="mci-tmsf-second.html"><strong>MCI_TMSF_SECOND</strong></a></td>
<td>Retrieves the seconds component from a TMSF value.</td>
</tr>
<tr>
<td><a href="mci-tmsf-track.html"><strong>MCI_TMSF_TRACK</strong></a></td>
<td>Retrieves the tracks component from a TMSF value.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>MCI also provides two messages: <a href="mm-mcinotify.html"><strong>MM_MCINOTIFY</strong></a> and <a href="mm-mcisignal.html"><strong>MM_MCISIGNAL</strong></a>. The MM_MCINOTIFY message notifies an application of the outcome of an MCI command whenever that command specifies the &quot;notify&quot; (MCI_NOTIFY) flag. The MM_MCISIGNAL message is specific to digital-video devices; it notifies the application when a specified position is reached.</p>
<p>Â </p>
<p>Â </p>
</body>
