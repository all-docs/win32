<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Obtaining and Setting Timer Resolution</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Obtaining and Setting Timer Resolution
description: Obtaining and Setting Timer Resolution
ms.assetid: 237a6770-89b9-4922-b9e9-0e0bf3e0c9b6
keywords:</p>
<ul>
<li>multimedia timers,resolution</li>
<li>timers,resolution</li>
<li>minimum timer resolution</li>
<li>maximum timer resolution</li>
<li>multimedia timers,maximum resolution</li>
<li>timers,maximum resolution</li>
<li>multimedia timers,minimum resolution</li>
<li>timers,minimum resolution</li>
<li>timeGetDevCaps function</li>
<li>timeBeginPeriod function
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Obtaining and Setting Timer Resolution</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/multimedia-timers">Multimedia Timers</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/procthread/multimedia-class-scheduler-service">Multimedia Class Scheduler Service</a>. <strong>Multimedia Class Scheduler Service</strong> has been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>Multimedia Class Scheduler Service</strong> instead of <strong>Multimedia Timers</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The following example calls the <a href="/windows/desktop/api/TimeAPI/nf-timeapi-timegetdevcaps"><strong>timeGetDevCaps</strong></a> function to determine the minimum and maximum timer resolutions supported by the timer services. Before it sets up any timer events, the example establishes the minimum timer resolution by using the <a href="/windows/desktop/api/TimeAPI/nf-timeapi-timebeginperiod"><strong>timeBeginPeriod</strong></a> function.</p>
<pre lang="C++"><code>#define TARGET_RESOLUTION 1         // 1-millisecond target resolution

TIMECAPS tc;
UINT     wTimerRes;

if (timeGetDevCaps(&amp;tc, sizeof(TIMECAPS)) != TIMERR_NOERROR) 
{
    // Error; application can't continue.
}

wTimerRes = min(max(tc.wPeriodMin, TARGET_RESOLUTION), tc.wPeriodMax);
timeBeginPeriod(wTimerRes); 
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="using-multimedia-timers.html">Using Multimedia Timers</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
