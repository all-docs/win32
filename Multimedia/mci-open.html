<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MCI_OPEN command</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MCI_OPEN command (Mmsystem.h)
description: The MCI_OPEN command initializes a device or file. All devices recognize this command.
ms.assetid: e2ee92b5-b10b-4408-950e-3002fe775b25
keywords:</p>
<ul>
<li>MCI_OPEN command Windows Multimedia
topic_type:</li>
<li>apiref
api_name:</li>
<li>MCI_OPEN
api_location:</li>
<li>Mmsystem.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MCI_OPEN command</h1>
<p>The MCI_OPEN command initializes a device or file. All devices recognize this command.</p>
<p>To send this command, call the <a href="/previous-versions//dd757160(v=vs.85)"><strong>mciSendCommand</strong></a> function with the following parameters.</p>
<pre lang="C++"><code>MCIERROR mciSendCommand(
  MCIDEVICEID wDeviceID, 
  MCI_OPEN, 
  DWORD dwFlags, 
  (DWORD) (LPMCI_OPEN_PARMS) lpOpen
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>wDeviceID</em></p>
<!-- raw HTML omitted -->
<p>Device identifier of the MCI device that is to receive the command message.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>dwFlags</em></p>
<!-- raw HTML omitted -->
<p>MCI_NOTIFY or MCI_WAIT. For information about these flags, see <a href="the-wait-notify-and-test-flags.html">The Wait, Notify, and Test Flags</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>lpOpen</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <a href="mci-open-parms.html"><strong>MCI_OPEN_PARMS</strong></a> structure. (Devices with extended command sets might replace this structure with a device-specific structure.)</p>
<!-- raw HTML omitted -->
<h2>Return Value</h2>
<p>Returns zero if successful or an error otherwise.</p>
<h2>Remarks</h2>
<p>The MCI_OPEN_TYPE flag must be used whenever a device is specified in the <a href="/previous-versions//dd757160(v=vs.85)"><strong>mciSendCommand</strong></a> function. If you open a device by specifying a device-type constant, you must specify the MCI_OPEN_TYPE_ID flag in addition to MCI_OPEN_TYPE. For a list of device-type constants, see <a href="mci-device-types.html">MCI Device Types</a>.</p>
<p>If the MCI_OPEN_SHAREABLE flag is not specified when a device or file is initially opened, all subsequent MCI_OPEN commands to the device or file will fail. If the device or file is already open and this flag is not specified, the call will fail even if the first open command specified MCI_OPEN_SHAREABLE. Files opened for the MCISEQ.DRV and MCIWAVE.DRV devices are nonsharable.</p>
<p>Case is ignored in the device name, but there cannot be leading or trailing blanks.</p>
<p>To use automatic type selection (via the entries in the registry), assign the filename and file extension to the <strong>lpstrElementName</strong> member of the structure identified by <em>lpOpen</em>, set the <strong>lpstrDeviceType</strong> member to <strong>NULL</strong>, and set the MCI_OPEN_ELEMENT flag.</p>
<p>The following additional flags apply to all devices supporting MCI_OPEN:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OPEN_ALIAS</p>
<!-- raw HTML omitted -->
<p>An alias is included in the <strong>lpstrAlias</strong> member of the structure identified by <em>lpOpen</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OPEN_SHAREABLE</p>
<!-- raw HTML omitted -->
<p>The device or file should be opened as sharable.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OPEN_TYPE</p>
<!-- raw HTML omitted -->
<p>A device type name or constant is included in the <strong>lpstrDeviceType</strong> member of the structure identified by <em>lpOpen</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OPEN_TYPE_ID</p>
<!-- raw HTML omitted -->
<p>The low-order word of the <strong>lpstrDeviceType</strong> member of the structure identified by <em>lpOpen</em> contains a standard MCI device type identifier and the high-order word optionally contains the ordinal index for the device. Use this flag with the MCI_OPEN_TYPE flag.</p>
<!-- raw HTML omitted -->
<p>The following additional flags apply to compound devices:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OPEN_ELEMENT</p>
<!-- raw HTML omitted -->
<p>A filename is included in the <strong>lpstrElementName</strong> member of the structure identified by <em>lpOpen</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OPEN_ELEMENT_ID</p>
<!-- raw HTML omitted -->
<p>The <strong>lpstrElementName</strong> member of the structure identified by <em>lpOpen</em> is interpreted as a <strong>DWORD</strong> value and has meaning internal to the device. Use this flag with the MCI_OPEN_ELEMENT flag.</p>
<!-- raw HTML omitted -->
<p>The following additional flags are used with the <strong>digitalvideo</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_OPEN_NOSTATIC</p>
<!-- raw HTML omitted -->
<p>The device should reduce the number of static (system) colors in the palette. This increases the number of colors available for rendering the video stream. This flag applies only to devices that share a palette with Windows.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_OPEN_PARENT</p>
<!-- raw HTML omitted -->
<p>The parent window handle is specified in the <strong>hWndParent</strong> member of the structure identified by <em>lpOpen</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_OPEN_WS</p>
<!-- raw HTML omitted -->
<p>A window style is specified in the <strong>dwStyle</strong> member of the structure identified by <em>lpOpen</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_OPEN_16BIT</p>
<!-- raw HTML omitted -->
<p>Indicates a preference for 16-bit MCI device support.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_OPEN_32BIT</p>
<!-- raw HTML omitted -->
<p>Indicates a preference for 32-bit MCI device support.</p>
<!-- raw HTML omitted -->
<p>For digital-video devices, the <em>lpOpen</em> parameter points to an <a href="/windows/desktop/api/Digitalv/ns-digitalv-mci_dgv_open_parmsa"><strong>MCI_DGV_OPEN_PARMS</strong></a> structure.</p>
<p>The following additional flags are used with the <strong>overlay</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OVLY_OPEN_PARENT</p>
<!-- raw HTML omitted -->
<p>The parent window handle is specified in the <strong>hWndParent</strong> member of the structure identified by <em>lpOpen</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_OVLY_OPEN_WS</p>
<!-- raw HTML omitted -->
<p>A window style is specified in the <strong>dwStyle</strong> member of the structure identified by <em>lpOpen</em>. The <strong>dwStyle</strong> value specifies the style of the window that the driver will create and display if the application does not provide one. The style parameter takes an integer that defines the window style. These constants are the same as the standard window styles (such as WS_CHILD, WS_OVERLAPPEDWINDOW, or WS_POPUP).</p>
<!-- raw HTML omitted -->
<p>For video-overlay devices, the <em>lpOpen</em> parameter points to an <a href="mci-ovly-open-parms.html"><strong>MCI_OVLY_OPEN_PARMS</strong></a> structure.</p>
<p>The following additional flag is used with the <strong>waveaudio</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_WAVE_OPEN_BUFFER</p>
<!-- raw HTML omitted -->
<p>A buffer length is specified in the <strong>dwBufferSeconds</strong> member of the structure identified by <em>lpOpen</em>.</p>
<!-- raw HTML omitted -->
<p>For waveform-audio devices, the <em>lpOpen</em> parameter points to an <a href="mci-wave-open-parms.html"><strong>MCI_WAVE_OPEN_PARMS</strong></a> structure. The MCIWAVE driver requires an asynchronous waveform-audio device.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mmsystem.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="mci.html">MCI</a></p>
<!-- raw HTML omitted -->
<p><a href="mci-commands.html">MCI Commands</a></p>
<!-- raw HTML omitted -->
</body>
