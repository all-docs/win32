<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Connecting a Capture Window to a Capture Driver</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Connecting a Capture Window to a Capture Driver
description: Connecting a Capture Window to a Capture Driver
ms.assetid: 78d4aaf5-6216-4eec-84d4-6727d1822983
keywords:</p>
<ul>
<li>WM_CAP_DRIVER_CONNECT message</li>
<li>capDriverConnect macro</li>
<li>capGetDriverDescription function</li>
<li>WM_CAP_DRIVER_GET_NAME message</li>
<li>capDriverGetName macro</li>
<li>WM_CAP_DRIVER_GET_VERSION message</li>
<li>capDriverGetVersion macro</li>
<li>WM_CAP_DRIVER_DISCONNECT message</li>
<li>capDriverDisconnect macro
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Connecting a Capture Window to a Capture Driver</h1>
<p>You can dynamically connect or disconnect a capture window to a capture driver. You can connect or associate a capture window with a capture driver by using the <a href="wm-cap-driver-connect.html"><strong>WM_CAP_DRIVER_CONNECT</strong></a> message (or the <a href="/windows/desktop/api/Vfw/nf-vfw-capdriverconnect"><strong>capDriverConnect</strong></a> macro). After a capture window and capture driver are connected, you can send device-specific messages to the capture driver associated with a capture window.</p>
<p>If you have more than one capture device installed on a system, you can connect a capture window to a particular video capture device driver by specifying an integer for the <em>wParam</em> parameter of the WM_CAP_DRIVER_CONNECT message. The integer is an index that identifies a video capture driver listed in the registry or in the [drivers] section of the SYSTEM.INI file. Use zero for the first index entry.</p>
<p>You can retrieve the name and version of an installed capture driver by using the <a href="/windows/desktop/api/Vfw/nf-vfw-capgetdriverdescriptiona"><strong>capGetDriverDescription</strong></a> function. Your application can use this function to enumerate the installed capture devices and drivers, so the user can select a capture device to connect to a capture window.</p>
<p>You can retrieve the name of the capture device driver connected to a capture window by using the <a href="wm-cap-driver-get-name.html"><strong>WM_CAP_DRIVER_GET_NAME</strong></a> message (or the <a href="/windows/desktop/api/Vfw/nf-vfw-capdrivergetname"><strong>capDriverGetName</strong></a> macro). To retrieve the version of an installed capture driver, use the <a href="wm-cap-driver-get-version.html"><strong>WM_CAP_DRIVER_GET_VERSION</strong></a> message (or the <a href="/windows/desktop/api/Vfw/nf-vfw-capdrivergetversion"><strong>capDriverGetVersion</strong></a> macro).</p>
<p>You can disconnect a capture window from a capture driver by using the <a href="wm-cap-driver-disconnect.html"><strong>WM_CAP_DRIVER_DISCONNECT</strong></a> message (or the <a href="/windows/desktop/api/Vfw/nf-vfw-capdriverdisconnect"><strong>capDriverDisconnect</strong></a> macro).</p>
<p>When an capture window is destroyed, any connected video capture device drivers are automatically disconnected.</p>
<p>Â </p>
<p>Â </p>
</body>
