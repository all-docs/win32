<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Creating a File or Stream Handler</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Creating a File or Stream Handler
description: Creating a File or Stream Handler
ms.assetid: 9ec1af9a-f428-4323-a4f8-3eb923ce78d7
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>Creating a File or Stream Handler</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/custom-file-and-stream-handlers">Custom File and Stream Handlers</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Core.MediaStreamSource">MediaStreamSource class</a>. <strong>MediaStreamSource class</strong> has been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaStreamSource class</strong> instead of <strong>Custom File and Stream Handlers</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>In an application written in the C programming language, a file or stream handler usually creates a function for each method. Your application accesses these functions through an array of function pointers the stream handler creates. An <strong>IAVIStreamVtbl</strong> structure contains the array of function pointers. A stream handler can assign any name it wants to functions it creates for the methods. The position of the function pointer in the structure implies the correspondence of the function to the method. For example, the first function pointer in the structure corresponds to the <strong>QueryInterface</strong> method. Your stream handler must provide all the functions of an interface.</p>
<p>Â </p>
<p>Â </p>
</body>
