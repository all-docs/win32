<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Handling MCI Errors</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Handling MCI Errors
description: Handling MCI Errors
ms.assetid: 01a2ff95-34a2-434f-9c7e-d0cdac826c02
keywords:</p>
<ul>
<li>mciSendCommand function
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Handling MCI Errors</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/mci">MCI</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>. <strong>MediaPlayer</strong> has been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong> instead of <strong>MCI</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>You should always check the return value of the <a href="/previous-versions//dd757160(v=vs.85)"><strong>mciSendCommand</strong></a> function. If it indicates an error, you can use <a href="/previous-versions//dd757158(v=vs.85)"><strong>mciGetErrorString</strong></a> to get a textual description of the error.</p>
<p>The following example passes the MCI error code specified by <em>dwError</em> to <strong>mciGetErrorString</strong>, and then displays the resulting textual error description using the <a href="/windows/win32/api/winuser/nf-winuser-messagebox">MessageBox</a> function.</p>
<pre lang="C++"><code>// Use mciGetErrorString to get a textual description of an MCI error.
// Display the error description using MessageBox.

void showError(DWORD dwError)
{
    char szErrorBuf[MAXERRORLENGTH];
    MessageBeep(MB_ICONEXCLAMATION);
    if(mciGetErrorString(dwError, (LPSTR) szErrorBuf, MAXERRORLENGTH))
    {
        MessageBox(hMainWnd, szErrorBuf, &quot;MCI Error&quot;,
        MB_ICONEXCLAMATION);
    }
    else
    {
        MessageBox(hMainWnd, &quot;Unknown Error&quot;, &quot;MCI Error&quot;,
            MB_ICONEXCLAMATION);
    }
}
 
</code></pre>
<blockquote>
<p>[!Note]<br />
To interpret an <a href="/previous-versions//dd757160(v=vs.85)"><strong>mciSendCommand</strong></a> error return value yourself, mask the high-order word (the low-order word contains the error code). If you pass the error return value to <a href="/previous-versions//dd757158(v=vs.85)"><strong>mciGetErrorString</strong></a>, however, you must pass the entire doubleword value.</p>
</blockquote>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
