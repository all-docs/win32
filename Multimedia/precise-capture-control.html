<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Precise Capture Control</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Precise Capture Control
description: Precise Capture Control
ms.assetid: 497c9d77-f392-4cbb-88f3-8418e1e9fc6b
keywords:</p>
<ul>
<li>AVICap callback functions,precise capture control
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Precise Capture Control</h1>
<p>A capture window can provide the capture-control callback function with precise control over the moments that streaming capture begin and end. The first message sent from the capture driver to the callback procedure sets the <em>nState</em> parameter to CONTROLCALLBACK_PREROLL after allocating all buffers and all other capture preparations are complete. This message gives the application the ability to preroll the video sources. (The callback function specifies <em>nState</em> as its second parameter.) The callback function then returns at the exact moment recording is to begin. A return value of <strong>TRUE</strong> from the callback function continues capture. A return value of <strong>FALSE</strong> aborts capture. Once capture begins, the callback function is called frequently with <em>nState</em> set to CONTROLCALLBACK_CAPTURING to allow the application to end capture by returning <strong>FALSE</strong>.</p>
<p>Â </p>
<p>Â </p>
</body>
