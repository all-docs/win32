<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Retrieving the Current Playback Position</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Retrieving the Current Playback Position
description: Retrieving the Current Playback Position
ms.assetid: a08fe5da-8945-486f-9413-877c7d13d5de
keywords:</p>
<ul>
<li>waveform audio,current playback position</li>
<li>waveform-audio interface,current playback position</li>
<li>playing waveform-audio files,current playback position</li>
<li>waveOutGetPosition function
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Retrieving the Current Playback Position</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/waveform-audio">Waveform Audio</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/coreaudio/wasapi">WASAPI</a> and <a href="/windows/uwp/audio-video-camera/audio-graphs">Audio Graphs</a>. <strong>WASAPI</strong> and <strong>Audio Graphs</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>WASAPI</strong> and <strong>Audio Graphs</strong> instead of <strong>Waveform Audio</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>You can monitor the current playback position within the file while waveform audio is playing by using the <a href="/windows/win32/api/mmeapi/nf-mmeapi-waveoutgetposition"><strong>waveOutGetPosition</strong></a> function.</p>
<p>For waveform-audio devices, samples are the preferred time format in which to represent the current position. Thus, the current position of a waveform-audio device is specified as the number of samples for one channel from the beginning of the waveform-audio file. To query the current position of a waveform-audio device, set the <strong>wType</strong> member of the <a href="/previous-versions//dd757347(v=vs.85)"><strong>MMTIME</strong></a> structure to TIME_SAMPLES and pass this structure to <strong>waveOutGetPosition</strong>.</p>
<p>The <strong>MMTIME</strong> structure can represent time in one or more different formats, including milliseconds, samples, SMPTE (Society of Motion Picture and Television Engineers), and MIDI song pointer formats. The <strong>wType</strong> member specifies the format used to represent time. Before calling a function that uses the <strong>MMTIME</strong> structure, you must set <strong>wType</strong> to indicate your requested time format. Be sure to check <strong>wType</strong> after the call to see whether the requested time format is supported. If the requested time format is not supported, the device driver specifies the time in an alternate time format and changes the <strong>wType</strong> member to the selected time format.</p>
<p>For more information about the <strong>MMTIME</strong> structure, see <a href="multimedia-timers.html">Multimedia Timers</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
