<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using MCIWnd Palettes</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Using MCIWnd Palettes
description: Using MCIWnd Palettes
ms.assetid: 2b99ca57-f321-4286-8ebf-ae3344d8d2c9
keywords:</p>
<ul>
<li>MCIWndGetPalette macro</li>
<li>MCIWndSetPalette macro</li>
<li>MCIWndRealize macro
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Using MCIWnd Palettes</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/mciwnd-window-class">MCIWnd Window Class</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>. <strong>MediaPlayer</strong> has been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong> instead of <strong>MCIWnd Window Class</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>Playing video clips with 8-bit color depth (256-color capacity) requires a palette to define the colors being used. Sometimes, the palette included with a video clip is not the most appropriate palette to use during playback. In this case, MCIWnd provides three ways to manage palettes for playback:</p>
<ul>
<li>Retrieve a handle to the palette associated with an MCIWnd window by using the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndgetpalette"><strong>MCIWndGetPalette</strong></a> macro. The palette is not necessarily associated exclusively with the MCIWnd window. Other applications can access, and even invalidate, the palette handle. Consequently, your application should anticipate the global use of the palette and, when finished with the palette, should not free it.</li>
<li>Specify a new palette to use with the video clip associated with an MCIWnd window by using the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndsetpalette"><strong>MCIWndSetPalette</strong></a> macro.</li>
<li>Realize the palette associated with an MCIWnd window to the system palette by using the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndrealize"><strong>MCIWndRealize</strong></a> macro. This macro calls the <a href="/windows/desktop/api/wingdi/nf-wingdi-realizepalette"><strong>RealizePalette</strong></a> function with the palette associated with the MCIWnd window. If your application message handlers for <a href="/windows/desktop/gdi/wm-palettechanged"><strong>WM_PALETTECHANGED</strong></a> and <a href="/windows/desktop/gdi/wm-querynewpalette"><strong>WM_QUERYNEWPALETTE</strong></a> call only <strong>RealizePalette</strong> or <strong>MCIWndRealize</strong>, you must forward these messages to MCIWnd if you do not handle them yourself.</li>
</ul>
<blockquote>
<p>[!Note]<br />
When a video clip with 8-bit color depth is loaded into the MCIWnd window, the palette included with that clip replaces the palette associated with the MCIWnd window.</p>
</blockquote>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="playback-enhancements.html">Playback Enhancements</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
