<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using a Window or Thread to Manage Buffered Playback</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Using a Window or Thread to Manage Buffered Playback
description: Using a Window or Thread to Manage Buffered Playback
ms.assetid: 3c8145a8-e56a-449d-ad45-2ae016f79697
keywords:</p>
<ul>
<li>Musical Instrument Digital Interface (MIDI),buffered playback</li>
<li>MIDI (Musical Instrument Digital Interface),buffered playback</li>
<li>playing MIDI files,buffered playback</li>
<li>buffered playback</li>
<li>MM_MOM_CLOSE message</li>
<li>MM_MOM_DONE message</li>
<li>MM_MOM_OPEN message</li>
<li>Musical Instrument Digital Interface (MIDI),sending messages</li>
<li>MIDI (Musical Instrument Digital Interface),sending messages</li>
<li>playing MIDI files,sending messages</li>
<li>sending MIDI messages
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Using a Window or Thread to Manage Buffered Playback</h1>
<p>The following messages can be sent to a window or thread for managing playback of MIDI system-exclusive messages or stream buffers.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="mm-mom-close.html"><strong>MM_MOM_CLOSE</strong></a></td>
<td>Sent when the device is closed by using the <a href="/windows/win32/api/mmeapi/nf-mmeapi-midioutclose"><strong>midiOutClose</strong></a> function.</td>
</tr>
<tr>
<td><a href="mm-mom-done.html"><strong>MM_MOM_DONE</strong></a></td>
<td>Sent when the device driver is finished with a data block sent by using the <a href="/windows/win32/api/mmeapi/nf-mmeapi-midioutlongmsg"><strong>midiOutLongMsg</strong></a> or <a href="/windows/win32/api/mmeapi/nf-mmeapi-midistreamout"><strong>midiStreamOut</strong></a> function.</td>
</tr>
<tr>
<td><a href="mm-mom-open.html"><strong>MM_MOM_OPEN</strong></a></td>
<td>Sent when the device is opened by using the <a href="/windows/win32/api/mmeapi/nf-mmeapi-midioutopen"><strong>midiOutOpen</strong></a> function.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>A <em>wParam</em> parameter and an <em>lParam</em> parameter are associated with each of these messages. The <em>wParam</em> parameter always specifies the handle of an open MIDI device. For <a href="mm-mom-done.html"><strong>MM_MOM_DONE</strong></a>, <em>lParam</em> specifies an address of a <a href="/windows/win32/api/mmeapi/ns-mmeapi-midihdr"><strong>MIDIHDR</strong></a> structure identifying the completed data block. The <em>lParam</em> parameter is unused for <a href="mm-mom-close.html"><strong>MM_MOM_CLOSE</strong></a> and <a href="mm-mom-open.html"><strong>MM_MOM_OPEN</strong></a>.</p>
<p>The most useful message is probably MM_MOM_DONE. Unless you need to allocate memory or initialize variables, you probably do not need to process MM_MOM_OPEN and MM_MOM_CLOSE. When playback of a data block is complete, you can clean up and free the data block.</p>
<p>Â </p>
<p>Â </p>
</body>
