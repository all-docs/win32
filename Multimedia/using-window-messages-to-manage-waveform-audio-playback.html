<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Window Messages to Manage Waveform-Audio Playback</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Using Window Messages to Manage Waveform-Audio Playback
description: Using Window Messages to Manage Waveform-Audio Playback
ms.assetid: 217968fd-4bb3-405d-a371-c129e29637ab
keywords:</p>
<ul>
<li>waveform audio,managing playback with messages</li>
<li>waveform-audio interface,managing playback with messages</li>
<li>playing waveform-audio files,managing playback with messages</li>
<li>waveform audio,messages</li>
<li>waveform-audio interface,messages</li>
<li>playing waveform-audio files,messages</li>
<li>MM_WOM_CLOSE message</li>
<li>MM_WOM_DONE message</li>
<li>MM_WOM_OPEN message
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Using Window Messages to Manage Waveform-Audio Playback</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/waveform-audio">Waveform Audio</a>, is a legacy feature. It has been superseded by <a href="/windows/win32/coreaudio/wasapi">WASAPI</a> and <a href="/windows/uwp/audio-video-camera/audio-graphs">Audio Graphs</a>. <strong>WASAPI</strong> and <strong>Audio Graphs</strong> have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>WASAPI</strong> and <strong>Audio Graphs</strong> instead of <strong>Waveform Audio</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The following messages can be sent to a window procedure function for managing waveform-audio playback.</p>
<table>
<thead>
<tr>
<th>Message</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="mm-wom-close.html"><strong>MM_WOM_CLOSE</strong></a></td>
<td>Sent when the device is closed by using the <a href="/windows/win32/api/mmeapi/nf-mmeapi-waveoutclose"><strong>waveOutClose</strong></a> function.</td>
</tr>
<tr>
<td><a href="mm-wom-done.html"><strong>MM_WOM_DONE</strong></a></td>
<td>Sent when the device driver is finished with a data block sent by using the <a href="/windows/win32/api/mmeapi/nf-mmeapi-waveoutwrite"><strong>waveOutWrite</strong></a> function.</td>
</tr>
<tr>
<td><a href="mm-wom-open.html"><strong>MM_WOM_OPEN</strong></a></td>
<td>Sent when the device is opened by using the <a href="/windows/win32/api/mmeapi/nf-mmeapi-waveoutopen"><strong>waveOutOpen</strong></a> function.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>A <em>wParam</em> and <em>lParam</em> parameter is associated with each of these messages. The <em>wParam</em> parameter always specifies a handle of the open waveform-audio device. For the <a href="mm-wom-done.html"><strong>MM_WOM_DONE</strong></a> message, <em>lParam</em> specifies a pointer to a <a href="/windows/win32/api/mmeapi/ns-mmeapi-wavehdr"><strong>WAVEHDR</strong></a> structure that identifies the completed data block. The <em>lParam</em> parameter is unused for the <a href="mm-wom-close.html"><strong>MM_WOM_CLOSE</strong></a> and <a href="mm-wom-open.html"><strong>MM_WOM_OPEN</strong></a> messages.</p>
<p>The most useful message is probably MM_WOM_DONE. When this message signals that playback of a data block is complete, you can clean up and free the data block. Unless you need to allocate memory or initialize variables, you probably do not need to process the MM_WOM_OPEN and MM_WOM_CLOSE messages.</p>
<p>The callback function for waveform-audio output devices is supplied by the application. For information about this callback function, see the <a href="/previous-versions//dd743869(v=vs.85)"><strong>waveOutProc</strong></a> function.</p>
<p>Â </p>
<p>Â </p>
</body>
