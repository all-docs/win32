<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Adding User-Controlled Playback</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Adding User-Controlled Playback
description: Adding User-Controlled Playback
ms.assetid: c865bbc1-f78a-4d88-ab60-fba76818d175
keywords:</p>
<ul>
<li>MCIWndCreate function
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Adding User-Controlled Playback</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/mciwnd-window-class">MCIWnd Window Class</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>. <strong>MediaPlayer</strong> has been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong> instead of <strong>MCIWnd Window Class</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>You can add user-controlled playback to an existing application by calling the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndcreatea"><strong>MCIWndCreate</strong></a> function as follows:</p>
<pre lang="C++"><code>MCIWndCreate(hwndParent, hInstModule, NULL, &quot;filename.typ&quot;); 
</code></pre>
<p>The <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndcreatea"><strong>MCIWndCreate</strong></a> parameters identify handles to the parent window and to the module instance associated with the MCIWnd window. They also specify window styles and the filename (or device name) to associate with the MCIWnd window.</p>
<p><strong>MCIWndCreate</strong> automatically performs the following steps that, for other window classes, you would implement in your code yourself:</p>
<ol>
<li>Register the MCIWnd window class.</li>
<li>Create the MCIWnd window.</li>
<li>Load the specified content.</li>
<li>Establish the current playback position at the beginning of the content.</li>
<li>Display the device control.</li>
<li>Display the playback area of the window, if needed.</li>
</ol>
<p>Â </p>
<p>Â </p>
</body>
