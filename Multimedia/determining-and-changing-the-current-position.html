<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Determining and Changing the Current Position</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Determining and Changing the Current Position
description: Determining and Changing the Current Position
ms.assetid: 20f78dcd-3259-43c2-8da3-8cfc299252e6
keywords:</p>
<ul>
<li>MCIWndGetStart macro</li>
<li>MCIWndGetEnd macro
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Determining and Changing the Current Position</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/mciwnd-window-class">MCIWnd Window Class</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>. <strong>MediaPlayer</strong> has been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong> instead of <strong>MCIWnd Window Class</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>When a file or device is associated with an MCIWnd window, the playback position is initially set at the start of the content, regardless of the media type. During playback, the playback position moves linearly through the content and, if playback is uninterrupted, eventually reaches the end of the content. If an interruption occurs, the current playback position is the location at which playback was stopped or paused.</p>
<p>You can retrieve the locations for the beginning and end of the content by using the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndgetstart"><strong>MCIWndGetStart</strong></a> and <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndgetend"><strong>MCIWndGetEnd</strong></a> macros. You can determine the length of the content by subtracting the value returned by <strong>MCIWndGetStart</strong> from the value returned by <strong>MCIWndGetEnd</strong>, or by using the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndgetlength"><strong>MCIWndGetLength</strong></a> macro. You can retrieve the current playback position by using the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndgetposition"><strong>MCIWndGetPosition</strong></a> macro, or you can retrieve the playback position as a null-terminated string by using the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndgetpositionstring"><strong>MCIWndGetPositionString</strong></a> macro.</p>
<p>To change the current playback position, use the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndhome"><strong>MCIWndHome</strong></a>, <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndend"><strong>MCIWndEnd</strong></a>, and <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndseek"><strong>MCIWndSeek</strong></a> macros. You can move the playback position to the start of the content by using <strong>MCIWndHome</strong> or to the end of the content by using <strong>MCIWndEnd</strong>. Use <strong>MCIWndSeek</strong> to move the playback position to any location in the content.</p>
<p>You can also step through the content by using the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndstep"><strong>MCIWndStep</strong></a> macro. Beginning from the current playback position, this macro moves the playback position forward or backward by a specified increment.</p>
<blockquote>
<p>[!Note]<br />
The units used to specify position vary among the different media types and devices. For example, the playback position for AVI files used by the MCIAVI device is measured in frames; the playback position for CD audio, waveform-audio, and MIDI files is measured in milliseconds.</p>
</blockquote>
<p>Â </p>
<p>Devices for other media types and third-party devices might use other units. For information about determining these units, see <a href="playback-enhancements.html">Playback Enhancements</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
