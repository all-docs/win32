<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MCI_CAPTURE command</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MCI_CAPTURE command (Mmsystem.h)
description: The MCI_CAPTURE command captures the contents of the frame buffer and stores it in a specified file. Digital-video devices recognize this command.
ms.assetid: bdebddc5-a0a0-449e-889e-37c7d6612c60
keywords:</p>
<ul>
<li>MCI_CAPTURE command Windows Multimedia
topic_type:</li>
<li>apiref
api_name:</li>
<li>MCI_CAPTURE
api_location:</li>
<li>Mmsystem.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MCI_CAPTURE command</h1>
<p>The MCI_CAPTURE command captures the contents of the frame buffer and stores it in a specified file. Digital-video devices recognize this command.</p>
<p>To send this command, call the <a href="/previous-versions//dd757160(v=vs.85)"><strong>mciSendCommand</strong></a> function with the following parameters.</p>
<pre lang="C++"><code>MCIERROR mciSendCommand(
  MCIDEVICEID wDeviceID, 
  MCI_CAPTURE, 
  DWORD dwFlags, 
  (DWORD) (LPMCI_DGV_CAPTURE_PARMS) lpCapture
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>wDeviceID</em></p>
<!-- raw HTML omitted -->
<p>Device identifier of the MCI device that is to receive the command message.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>dwFlags</em></p>
<!-- raw HTML omitted -->
<p>MCI_NOTIFY, MCI_WAIT, or MCI_TEST. For information about these flags, see <a href="the-wait-notify-and-test-flags.html">The Wait, Notify, and Test Flags</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>lpCapture</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <a href="/windows/desktop/api/Digitalv/ns-digitalv-mci_dgv_capture_parmsa"><strong>MCI_DGV_CAPTURE_PARMS</strong></a> structure.</p>
<!-- raw HTML omitted -->
<h2>Return Value</h2>
<p>Returns zero if successful or an error otherwise.</p>
<h2>Remarks</h2>
<p>The following additional flags apply to digital-video devices:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_CAPTURE_AS</p>
<!-- raw HTML omitted -->
<p>The <strong>lpstrFileName</strong> member of the structure identified by <em>lpCapture</em> contains an address of a buffer specifying the destination path and filename. (This flag is required.)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_CAPTURE_AT</p>
<!-- raw HTML omitted -->
<p>The <strong>rc</strong> member of the structure identified by <em>lpCapture</em> contains a valid rectangle. The rectangle specifies the rectangular region within the frame buffer that is cropped and saved to disk. If omitted, the cropped region defaults to the rectangle specified or defaulted on a previous <a href="mci-put.html">MCI_PUT</a> command that specifies the source area for this instance of the device driver.</p>
<!-- raw HTML omitted -->
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mmsystem.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="mci.html">MCI</a></p>
<!-- raw HTML omitted -->
<p><a href="mci-commands.html">MCI Commands</a></p>
<!-- raw HTML omitted -->
</body>
