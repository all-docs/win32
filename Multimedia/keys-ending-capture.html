<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Keys Ending Capture</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Keys Ending Capture
description: Keys Ending Capture
ms.assetid: 932ed4ee-0928-41f7-a242-8b7435313647
keywords:</p>
<ul>
<li>WM_CAP_GET_SEQUENCE_SETUP message</li>
<li>capCaptureGetSetup macro</li>
<li>CAPTUREPARMS structure</li>
<li>WM_CAP_SET_SEQUENCE_SETUP message</li>
<li>capCaptureSetSetup macro
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Keys Ending Capture</h1>
<p>You can allow the user to abort a capture session by pressing a key or keystroke combination from the keyboard, or by pressing the right or left mouse button. If the user aborts a real-time capture session, the contents of the capture file are discarded. If the user aborts a step-frame capture session, the contents of the capture file up to the point of aborting the capture are saved.</p>
<p>You can retrieve the settings for aborting a capture session by using the <a href="wm-cap-get-sequence-setup.html"><strong>WM_CAP_GET_SEQUENCE_SETUP</strong></a> message (or the <a href="/windows/desktop/api/Vfw/nf-vfw-capcapturegetsetup"><strong>capCaptureGetSetup</strong></a> macro). The current keystroke setting is stored in the <strong>vKeyAbort</strong> member of the <a href="/windows/win32/api/vfw/ns-vfw-captureparms"><strong>CAPTUREPARMS</strong></a> structure; the current mouse settings are stored in the <strong>fAbortLeftMouse</strong> and <strong>fAbortRightMouse</strong> members. You can set a new key or keystroke combination by specifying the keycode or keycode combination (as in a CTRL or SHIFT key combination) as the value of <strong>vKeyAbort</strong>, or set the left or right mouse button as the abort key by specifying the <strong>fAbortLeftMouse</strong> or <strong>fAbortRightMouse</strong> member. After you set these members, send the updated <strong>CAPTUREPARMS</strong> structure to the capture window by using the <a href="wm-cap-set-sequence-setup.html"><strong>WM_CAP_SET_SEQUENCE_SETUP</strong></a> message (or the <a href="/windows/desktop/api/Vfw/nf-vfw-capcapturesetsetup"><strong>capCaptureSetSetup</strong></a> macro). The default value of <strong>vKeyAbort</strong> is VK_ESCAPE. You must call the <a href="/windows/win32/api/winuser/nf-winuser-registerhotkey">RegisterHotKey</a> function before specifying a keystroke that can abort a capture session. The default values of <strong>fAbortLeftMouse</strong> and <strong>fAbortRightMouse</strong> are <strong>TRUE</strong>.</p>
<p>Â </p>
<p>Â </p>
</body>
