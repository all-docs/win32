<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MCI_SETAUDIO command</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MCI_SETAUDIO command (Mmsystem.h)
description: The MCI_SETAUDIO command sets values associated with audio playback and capture. Digital-video and VCR devices recognize this command.
ms.assetid: 78624596-e465-4ef1-8988-edcfe9a46f89
keywords:</p>
<ul>
<li>MCI_SETAUDIO command Windows Multimedia
topic_type:</li>
<li>apiref
api_name:</li>
<li>MCI_SETAUDIO
api_location:</li>
<li>Mmsystem.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MCI_SETAUDIO command</h1>
<p>The MCI_SETAUDIO command sets values associated with audio playback and capture. Digital-video and VCR devices recognize this command.</p>
<p>To send this command, call the <a href="/previous-versions//dd757160(v=vs.85)"><strong>mciSendCommand</strong></a> function with the following parameters.</p>
<pre lang="C++"><code>MCIERROR mciSendCommand(
  MCIDEVICEID wDeviceID, 
  MCI_SETAUDIO, 
  DWORD dwFlags, 
  (DWORD) (LPMCI_GENERIC_PARMS) lpSetAudio
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>wDeviceID</em></p>
<!-- raw HTML omitted -->
<p>Device identifier of the MCI device that is to receive the command message.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>dwFlags</em></p>
<!-- raw HTML omitted -->
<p>MCI_NOTIFY, MCI_WAIT, or MCI_TEST. For information about these flags, see <a href="the-wait-notify-and-test-flags.html">The Wait, Notify, and Test Flags</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>lpSetAudio</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <a href="mci-generic-parms.html"><strong>MCI_GENERIC_PARMS</strong></a> structure. (Devices with extended command sets might replace this structure with a device-specific structure.)</p>
<!-- raw HTML omitted -->
<h2>Return Value</h2>
<p>Returns zero if successful or an error otherwise.</p>
<h2>Remarks</h2>
<p>The following flags apply to the <strong>digitalvideo</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_ALG</p>
<!-- raw HTML omitted -->
<p>The <strong>lpstrAlgorithm</strong> member of the structure identified by <em>lpSetAudio</em> contains an address of a buffer containing the name of an audio compression algorithm. The compression algorithm is used by subsequent <a href="mci-reserve.html">MCI_RESERVE</a> or <a href="mci-record.html">MCI_RECORD</a> commands. The available algorithms are device dependent. If the algorithm is incompatible with the current file format, the file format is changed to the default format for the algorithm.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_CLOCKTIME</p>
<!-- raw HTML omitted -->
<p>The time specified is in milliseconds and is absolute time when used with MCI_DGV_SETAUDIO_OVER. (This time is not in step with the playing of the workspace.)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_INPUT</p>
<!-- raw HTML omitted -->
<p>Modifies the bass, treble, or volume flag so that it affects the input signal and modifies what is recorded. If possible, this is the default when monitoring the input.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_ITEM</p>
<!-- raw HTML omitted -->
<p>An audio constant is specified in the <strong>dwItem</strong> member of the structure identified by <em>lpSetAudio</em>. The constant identifies the value that is being set. The following constants are defined:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_AVGBYTESPERSEC</p>
<!-- raw HTML omitted -->
<p>The average number of bytes is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetAudio</em>. This value sets the average number of bytes per second for playing or recording in the PCM (Pulse Code Modulation) and ADPCM (Adaptive Differential Pulse Code Modulation) formats. The file is saved in this format.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_BASS</p>
<!-- raw HTML omitted -->
<p>The audio low frequency level is specified as a factor in the <strong>dwValue</strong> member of the structure identified by <em>lpSetAudio</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_BITSPERSAMPLE</p>
<!-- raw HTML omitted -->
<p>The number of bits per sample is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetAudio</em>. This value sets the number of bits per sample played or recorded in the PCM format. The file is saved in this format.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_BLOCKALIGN</p>
<!-- raw HTML omitted -->
<p>The data block alignment is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetAudio</em>. This value sets the alignment of data blocks relative to the start of input waveform data.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_SAMPLESPERSEC</p>
<!-- raw HTML omitted -->
<p>The sample rate is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetAudio</em>. This value sets the sample rate for playing and recording with the PCM and ADPCM algorithms. The file is saved in this format.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_SOURCE</p>
<!-- raw HTML omitted -->
<p>A constant specifying the source of audio input is included in the <strong>dwValue</strong> member of the structure identified by <em>lpSetAudio</em>. The following constants are defined for the audio input sources:</p>
<p>MCI_DGV_SETAUDIO_SOURCE_AVERAGE</p>
<p>The average of the left and right audio channels.</p>
<p>MCI_DGV_SETAUDIO_SOURCE_LEFT</p>
<p>Left audio channel.</p>
<p>MCI_DGV_SETAUDIO_SOURCE_RIGHT</p>
<p>Right audio channel.</p>
<p>MCI_DGV_SETAUDIO_SOURCE_STEREO</p>
<p>Stereo.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_STREAM</p>
<!-- raw HTML omitted -->
<p>An audio-stream is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetAudio</em>. The integer value specifies the audio stream played back from the workspace. If the stream is not specified, the first physically interleaved audio stream is played.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_TREBLE</p>
<!-- raw HTML omitted -->
<p>The audio high-frequency level is specified as a factor in the <strong>dwValue</strong> member of the structure identified by <em>lpSetAudio</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_VOLUME</p>
<!-- raw HTML omitted -->
<p>The audio level for one or both audio channels is specified as a factor in the <strong>dwValue</strong> member of the structure identified by <em>lpSetAudio</em>. If the left and right volumes have been set to different values, then the ratio of left to right volume is approximately unchanged.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_LEFT</p>
<!-- raw HTML omitted -->
<p>Enables the left audio channel when used with MCI_SET_ON. Disables the left audio channel when used with MCI_SET_OFF. When this flag is used with the combination of MCI_DGV_SETAUDIO_VALUE and MCI_DGV_SETAUDIO_VOLUME, it sets the volume of the left audio channel. When this flag is used with MCI_DGV_SETAUDIO_SOURCE, it specifies the left audio channel as the source for the audio input digitizer.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_OVER</p>
<!-- raw HTML omitted -->
<p>A transition length parameter is included in the <strong>dwOver</strong> member of the structure identified by <em>lpSetAudio</em>. The length value specifies how long (in units of the current time format) it should take to make a change that uses a factor. If this flag is not used, changes occur immediately.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_QUALITY</p>
<!-- raw HTML omitted -->
<p>The <strong>lpstrQuality</strong> member of the structure identified by <em>lpSetAudio</em> contains an address of a buffer defining the audio quality. A text-string within the buffer specifies the characteristics of the audio compression algorithm.</p>
<p>The MCI_DGV_SETAUDIO_ALG flag can be used to select a quality descriptor for the specified algorithm. If this flag is omitted, then the current algorithm is used.</p>
<p>The algorithms and descriptor names available depend on the device. Each device supplies documentation for the available algorithms and a description of the applicable descriptor names. The <a href="mci-quality.html">MCI_QUALITY</a> command can define additional descriptor names.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_RECORD</p>
<!-- raw HTML omitted -->
<p>Specifies whether recording includes or excludes audio data. When combined with MCI_SET_ON, audio data is recorded. When combined with MCI_SET_OFF, audio data is excluded. The default includes audio data.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_RIGHT</p>
<!-- raw HTML omitted -->
<p>Enables the right audio channel when used with MCI_SET_ON. Disables the right audio channel when used with MCI_SET_OFF. When this flag is used with the combination of MCI_DGV_SETAUDIO_VALUE and MCI_DGV_SETAUDIO_VOLUME, it sets the volume of the right audio channel.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETAUDIO_VALUE</p>
<!-- raw HTML omitted -->
<p>A value is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetAudio</em>. The meaning of the value is specified by the constant defined for the MCI_DGV_SETAUDIO_ITEM flag.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_SET_OFF</p>
<!-- raw HTML omitted -->
<p>Disables the specified audio channel.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_SET_ON</p>
<!-- raw HTML omitted -->
<p>Enables the specified audio channel.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_SETAUDIO_OUTPUT</p>
<!-- raw HTML omitted -->
<p>Modifies the bass, treble, or volume flag so that it modifies only the played signal and not what is recorded. If possible, this is the default when monitoring the input.</p>
<!-- raw HTML omitted -->
<p>For digital-video devices, the <em>lpSetAudio</em> parameter points to an <a href="/windows/desktop/api/Digitalv/ns-digitalv-mci_dgv_setaudio_parmsa"><strong>MCI_DGV_SETAUDIO_PARMS</strong></a> structure.</p>
<p>The following additional flags are used with the <strong>vcr</strong> device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_VCR_SETAUDIO_RECORD</p>
<!-- raw HTML omitted -->
<p>Sets the audio recording to on or off, which is used in conjunction with one of following flags:</p>
<p>MCI_SET_ON</p>
<p>Audio recording on.</p>
<p>MCI_SET_OFF</p>
<p>Audio recording off. It might be necessary to first turn off the assemble recording (using the <a href="mci-set.html">MCI_SET</a> command with the MCI_VCR_SET_ASSEMBLE_RECORD flag set to off) before the audio recording can be turned off.</p>
<p>MCI_TRACK</p>
<p>The <strong>dwTrack</strong> member of the structure identified by <em>lpSetAudio</em> specifies which track is affected by the command.</p>
<p>MCI_VCR_SETAUDIO_SOURCE</p>
<p>Sets the audio source. This flag must be used with the MCI_VCR_SETAUDIO_TO flag.</p>
<p>MCI_VCR_SETAUDIO_MONITOR</p>
<p>Sets the audio source monitor. This flag must be used with the MCI_VCR_SETAUDIO_TO flag.</p>
<p>MCI_VCR_SETAUDIO_TO</p>
<p>The <strong>dwTo</strong> member of the structure identified by <em>lpSetAudio</em> contains a constant describing the type of input or monitored input. It must be one of the following:</p>
<!-- raw HTML omitted -->
<p>MCI_VCR_SRC_TYPE_TUNER</p>
<p>Type is tuner.</p>
<!-- raw HTML omitted -->
<p>MCI_VCR_SRC_TYPE_LINE</p>
<p>Type is line.</p>
<!-- raw HTML omitted -->
<p>MCI_VCR_SRC_TYPE_AUX</p>
<p>Type is auxiliary.</p>
<!-- raw HTML omitted -->
<p>MCI_VCR_SRC_TYPE_GENERIC</p>
<p>Type is generic.</p>
<!-- raw HTML omitted -->
<p>MCI_VCR_SRC_TYPE_MUTE</p>
<p>Type is mute. This can be used only with the MCI_VCR_SETAUDIO_SOURCE flag.</p>
<!-- raw HTML omitted -->
<p>MCI_VCR_SRC_TYPE_OUTPUT</p>
<p>Type is output.</p>
<!-- raw HTML omitted -->
<p>MCI_VCR_SETAUDIO_NUMBER</p>
<p>The dwNumber member of the structure identified by lpSetAudio contains the audio input (of the type specified in the dwTo member) to use.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>For VCR devices, the <em>lpSetAudio</em> parameter points to an <a href="mci-vcr-setaudio-parms.html"><strong>MCI_VCR_SETAUDIO_PARMS</strong></a> structure.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mmsystem.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="mci.html">MCI</a></p>
<!-- raw HTML omitted -->
<p><a href="mci-commands.html">MCI Commands</a></p>
<!-- raw HTML omitted -->
</body>
