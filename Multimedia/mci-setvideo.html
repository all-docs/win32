<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MCI_SETVIDEO command</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MCI_SETVIDEO command (Mmsystem.h)
description: The MCI_SETVIDEO command sets values associated with video playback. Digital-video and VCR devices recognize this command.
ms.assetid: b84956d8-01a0-49f6-a96c-2693a25e6f2a
keywords:</p>
<ul>
<li>MCI_SETVIDEO command Windows Multimedia
topic_type:</li>
<li>apiref
api_name:</li>
<li>MCI_SETVIDEO
api_location:</li>
<li>Mmsystem.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MCI_SETVIDEO command</h1>
<p>The MCI_SETVIDEO command sets values associated with video playback. Digital-video and VCR devices recognize this command.</p>
<p>To send this command, call the <a href="/previous-versions//dd757160(v=vs.85)"><strong>mciSendCommand</strong></a> function with the following parameters.</p>
<pre lang="C++"><code>MCIERROR mciSendCommand(
  MCIDEVICEID wDeviceID, 
  MCI_SETVIDEO, 
  DWORD dwFlags, 
  (DWORD) (LPMCI_GENERIC_PARMS) lpSetVideo
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>wDeviceID</em></p>
<!-- raw HTML omitted -->
<p>Device identifier of the MCI device that is to receive the command message.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>dwFlags</em></p>
<!-- raw HTML omitted -->
<p><strong>MCI_NOTIFY</strong>, <strong>MCI_WAIT</strong>, or <strong>MCI_TEST</strong>. For information about these flags, see <a href="the-wait-notify-and-test-flags.html">The Wait, Notify, and Test Flags</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>lpSetVideo</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <a href="mci-generic-parms.html"><strong>MCI_GENERIC_PARMS</strong></a> structure. (Devices with extended command sets might replace this structure with a device-specific structure.)</p>
<!-- raw HTML omitted -->
<h2>Return Value</h2>
<p>Returns zero if successful or an error otherwise.</p>
<h2>Remarks</h2>
<p>The following additional flags are used with the &quot;digitalvideo&quot; device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_ALG</p>
<!-- raw HTML omitted -->
<p>The <strong>lpstrAlgorithm</strong> member of the structure identified by <em>lpSetVideo</em> contains an address of a buffer containing the name of a video compression algorithm. The compression algorithm is used by subsequent <a href="mci-reserve.html">MCI_RESERVE</a> or <a href="mci-record.html">MCI_RECORD</a> commands. The available algorithms are device dependent.</p>
<p>If the specified algorithm is incompatible with the current file format, the file format is changed to the default format for the algorithm.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_CLOCKTIME</p>
<!-- raw HTML omitted -->
<p>When used with <strong>MCI_DGV_SETVIDEO_OVER</strong>, indicates time is specified in milliseconds and is absolute time. (This time is not in step with the playing of the workspace.)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_INPUT</p>
<!-- raw HTML omitted -->
<p>Modifies the <strong>MCI_DGV_SETVIDEO_BRIGHTNESS</strong>, <strong>MCI_DGV_SETVIDEO_COLOR</strong>, <strong>MCI_DGV_SETVIDEO_CONTRAST</strong>, <strong>MCI_DGV_SETVIDEO_GAMMA</strong>, <strong>MCI_DGV_SETVIDEO_SHARPNESS</strong>, or <strong>MCI_DGV_SETVIDEO_TINT</strong> so that it affects the input signal and modifies what is recorded. If possible, this is the default when monitoring the input.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_ITEM</p>
<!-- raw HTML omitted -->
<p>A video constant is specified in the <strong>dwItem</strong> member of the structure identified by <em>lpSetVideo</em>. The constant identifies the value that is being set. You can specify the following constants with this flag:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_AVI_SETVIDEO_DRAW_PROCEDURE</p>
<!-- raw HTML omitted -->
<p>A new drawing procedure address is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>. You can specify a new drawing procedure only when the device is idle. This flag is recognized only by the MCIAVI digital-video driver. There is no equivalent to this flag in the string command interface.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_AVI_SETVIDEO_PALETTE_COLOR</p>
<!-- raw HTML omitted -->
<p>A new palette color is specified in the <strong>dwOver</strong> and <strong>dwValue</strong> members of the structure identified by <em>lpSetVideo</em>. The <strong>dwOver</strong> member specifies the palette index of the color to be changed and the <strong>dwValue</strong> member specifies the new color, as an RGB value. You must also specify the <strong>MCI_DGV_SETVIDEO_OVER</strong> and <strong>MCI_DGV_SETVIDEO_VALUE</strong> flags with <strong>MCI_DGV_SETVIDEO_ITEM</strong> when you use this constant. This flag is recognized only by the MCIAVI digital-video driver.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_AVI_SETVIDEO_PALETTE_HALFTONE</p>
<!-- raw HTML omitted -->
<p>Indicates that the halftone palette should be used, instead of the default palette. This flag is recognized only by the MCIAVI digital-video driver.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_BITSPERPEL</p>
<!-- raw HTML omitted -->
<p>The number of bits per pixel is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>. The number of bits per pixel is used for saving captured or recorded data</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_BRIGHTNESS</p>
<!-- raw HTML omitted -->
<p>The video brightness level is specified as a factor in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_COLOR</p>
<!-- raw HTML omitted -->
<p>The video color saturation level is specified as a factor in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_CONTRAST</p>
<!-- raw HTML omitted -->
<p>The video contrast level is specified as a factor in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_FRAME_RATE</p>
<!-- raw HTML omitted -->
<p>A frame rate is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>. The rate is specified in units of frames per second times 1000. For example, 29.97 frames per second is specified as 29970.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_GAMMA</p>
<!-- raw HTML omitted -->
<p>A gamma correction exponent value is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>. Gamma correction adjusts the mapping between the intensity encoded in the presentation source and the displayed brightness. The value is the exponent multiplied by 1000. For example, 2200 indicates an exponent of 2.2. A value of 1000 indicates an exponent of 1, which applies no gamma correction.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_KEY_COLOR</p>
<!-- raw HTML omitted -->
<p>A key color is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>. The key color is an RGB value.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_KEY_INDEX</p>
<!-- raw HTML omitted -->
<p>A key index value is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>. The index parameter is a physical palette index.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_PALHANDLE</p>
<!-- raw HTML omitted -->
<p>A palette handle is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>. The palette handle is contained in the low-order word. Digital-video devices should not free the palette passed with this command. Applications should free it after they close the device. This flag is supported only by devices that use palettes. If this specified palette handle is zero, then the default palette is used.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_SHARPNESS</p>
<!-- raw HTML omitted -->
<p>A video sharpness value is specified as a factor in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_SOURCE</p>
<!-- raw HTML omitted -->
<p>A constant specifying the source of the video input is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>. The following constants are defined:</p>
<ul>
<li><strong>MCI_DGV_SETVIDEO_SRC_NTSC</strong>: NTSC television.</li>
<li>MCI_DGV_SETVIDEO_SRC_PAL: PAL television.</li>
<li>MCI_DGV_SETVIDEO_SRC_RGB: RGB video.</li>
<li>MCI_DGV_SETVIDEO_SRC_SECAM: SECAM television.</li>
<li>MCI_DGV_SETVIDEO_SRC_SVIDEO: S-Video.</li>
</ul>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_STREAM</p>
<!-- raw HTML omitted -->
<p>A video stream is specified in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>. The integer value specifies the video stream played back from the workspace. If the stream is not specified and the file format does not define a default stream, the first physically interleaved video stream is played.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_TINT</p>
<!-- raw HTML omitted -->
<p>A video tint value is specified as a factor in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>. Typically, this adjustment is modeled after the tint control of many color television sets, with 250 defined as green, 750 defined as red, and 0 (or 1000) defined as blue. The nominal value is always 500.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_OUTPUT</p>
<!-- raw HTML omitted -->
<p>The <strong>MCI_DGV_SETVIDEO_BRIGHTNESS</strong>, <strong>MCI_DGV_SETVIDEO_COLOR</strong>, <strong>MCI_DGV_SETVIDEO_CONTRAST</strong>, <strong>MCI_DGV_SETVIDEO_GAMMA</strong>, <strong>MCI_DGV_SETVIDEO_SHARPNESS</strong>, or <strong>MCI_DGV_SETVIDEO_TINT</strong> flag is modified so that it affects only the displayed signal and not what is recorded. If possible, this is the default when monitoring a file.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_OVER</p>
<!-- raw HTML omitted -->
<p>A transition length parameter is included in the <strong>dwOver</strong> member of the structure identified by <em>lpSetVideo</em>. The transition length specifies how long (in the current time format) it should take to make a change. If this flag is not used, the change occurs immediately.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_QUALITY</p>
<!-- raw HTML omitted -->
<p>The <strong>lpstrQuality</strong> member of the structure identified by <em>lpSetVideo</em> contains an address of a buffer describing the video quality. A text-string in the buffer specifies the characteristics of the video compression algorithm.</p>
<p>The <strong>MCI_DGV_SETVIDEO_ALG</strong> flag can be used to select a quality descriptor for the specified algorithm. If this flag is omitted, then the current algorithm is used.</p>
<p>The algorithms and descriptor names available depend on the device. Each device supplies documentation for the available algorithms and a description of the applicable descriptor names. The <a href="mci-quality.html">MCI_QUALITY</a> command can define additional descriptor names. All devices support the descriptors &quot;low&quot;, &quot;medium&quot;, and &quot;high&quot;. The default is driver specific.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_RECORD</p>
<!-- raw HTML omitted -->
<p>Specifies whether recording includes or excludes video data. When combined with <strong>MCI_SET_ON</strong>, video data is recorded. When combined with <strong>MCI_SET_OFF</strong>, video data is excluded. The default includes video data.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_SRC_NUMBER</p>
<!-- raw HTML omitted -->
<p>A number for the video source is specified in the <strong>dwSourceNumber</strong> member of the structure identified by <em>lpSetVideo</em>. If there is more than one input of the type specified by <strong>MCI_DGV_SETVIDEO_VALUE</strong>, the value selects the input. This flag must always be used with <strong>MCI_DGV_SETVIDEO_SOURCE</strong>. If <strong>MCI_DGV_SETVIDEO_VALUE</strong> is omitted, however, the specified source number indicates the absolute source to use as specified in the <a href="mci-list.html">MCI_LIST</a> command.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_STILL</p>
<!-- raw HTML omitted -->
<p>The algorithm name or quality value specified applies to still images.</p>
<p>Every device driver must support an algorithm of &quot;none&quot;, which means no compression. This is the default. In this case, digital-video devices save still images as RGB device-independent bitmaps (DIBs).</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_DGV_SETVIDEO_VALUE</p>
<!-- raw HTML omitted -->
<p>A value is included in the <strong>dwValue</strong> member of the structure identified by <em>lpSetVideo</em>. The meaning of the value is specified by the <strong>MCI_DGV_SETVIDEO_ITEM</strong> flag.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_SET_OFF</p>
<!-- raw HTML omitted -->
<p>Disables video output. For digital-video devices, disabling video sets the pixels in the destination rectangle defined by the <a href="mci-put.html">MCI_PUT</a> command (or its default, the client region of the current window) to a solid color, but it has no effect on the frame buffer. You can hide the window with the <a href="mci-window.html">MCI_WINDOW</a> command if desired. The source of video, whether it's the workspace or an external input, might continue to store new images in the frame buffer, but they are not displayed until the video is enabled. While applications should use the MCI_SETVIDEO command to control this function, digital-video devices must still support this flag. The default value after an open is on.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_SET_ON</p>
<!-- raw HTML omitted -->
<p>Enables video output.</p>
<!-- raw HTML omitted -->
<p>For digital-video devices, the <em>lpSetVideo</em> parameter points to an <a href="/windows/desktop/api/Digitalv/ns-digitalv-mci_dgv_setvideo_parmsa"><strong>MCI_DGV_SETVIDEO_PARMS</strong></a> structure.</p>
<p>The following additional flags are used with the &quot;vcr&quot; device type:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_VCR_SETVIDEO_RECORD</p>
<!-- raw HTML omitted -->
<p>Sets the video recording to on or off. Used in conjunction with one of following flags:</p>
<ul>
<li><strong>MCI_SET_ON</strong>. Video recording on.</li>
<li><strong>MCI_SET_OFF</strong>. Video recording off. It might be necessary to first turn off the assemble recording (using the <a href="mci-set.html">MCI_SET</a> command with the <strong>MCI_VCR_SET_ASSEMBLE_RECORD</strong> flag set to off) before the video recording can be turned off.</li>
</ul>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_TRACK</p>
<!-- raw HTML omitted -->
<p>The <strong>dwTrack</strong> member of the structure identified by <em>lpSetVideo</em> specifies which track is affected by the command.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_VCR_SETVIDEO_SOURCE</p>
<!-- raw HTML omitted -->
<p>Sets the video source, and must be used with the <strong>MCI_VCR_SETVIDEO_TO</strong> flag.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_VCR_SETVIDEO_MONITOR</p>
<!-- raw HTML omitted -->
<p>Sets the video source monitor, and must be used with the MCI_VCR_SETVIDEO_TO flag.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MCI_VCR_SETVIDEO_TO</p>
<!-- raw HTML omitted -->
<p>The <strong>dwTo</strong> member of the structure identified by <em>lpSetVideo</em> contains one of the following constants:</p>
<!-- raw HTML omitted -->
<p>The <strong>dwNumber</strong> member of the structure identified by <em>lpSetVideo</em> contains the video input (of the type specified in the <strong>dwTo</strong> member) to use.</p>
<!-- raw HTML omitted -->
<p>For VCR devices, the <em>lpSetVideo</em> parameter points to an <a href="mci-vcr-setvideo-parms.html"><strong>MCI_VCR_SETVIDEO_PARMS</strong></a> structure.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mmsystem.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="mci.html">MCI</a></p>
<!-- raw HTML omitted -->
<p><a href="mci-commands.html">MCI Commands</a></p>
<!-- raw HTML omitted -->
</body>
