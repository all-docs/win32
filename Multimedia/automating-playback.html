<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Automating Playback</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Automating Playback
description: Automating Playback
ms.assetid: 3aa05a54-58d7-4d14-93ee-459aa860b20e
keywords:</p>
<ul>
<li>MCIWndCreate macro</li>
<li>MCIWndPlay macro
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>Automating Playback</h1>
<p>[The feature associated with this page, <a href="/windows/win32/multimedia/mciwnd-window-class">MCIWnd Window Class</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>. <strong>MediaPlayer</strong> has been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong> instead of <strong>MCIWnd Window Class</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>You can automate playback in your application by using <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndcreatea"><strong>MCIWndCreate</strong></a> and the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndplay"><strong>MCIWndPlay</strong></a> macro, along with either the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwnddestroy"><strong>MCIWndDestroy</strong></a> or the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndclose"><strong>MCIWndClose</strong></a> macro. To automate playback, specify the MCIWNDF_NOPLAYBAR and MCIWNDF_NOTIFYMODE styles in the <strong>MCIWndCreate</strong><em>dwStyle</em> parameter. Specify the MCIWNDF_NOPLAYBAR style to hide the toolbar, and the MCIWNDF_NOTIFYMODE style to issue an appropriate notification message when the device stops playing.</p>
<p>You can play the device or file specified in <strong>MCIWndCreate</strong> by using <strong>MCIWndPlay</strong>. The MCIWndPlay macro starts playing the content from its current playback position and continues to its end.</p>
<p>You can destroy or close an MCIWnd window by using the <a href="/windows/desktop/api/Vfw/nf-vfw-mciwnddestroy"><strong>MCIWndDestroy</strong></a> or <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndclose"><strong>MCIWndClose</strong></a> macro. The <strong>MCIWndDestroy</strong> macro closes the device or file and destroys the MCIWnd window by invalidating its handle. If your application can reuse the MCIWnd window, use <strong>MCIWndClose</strong> to close the device without destroying the window.</p>
<p>Your application can detect when the device stops playing and automatically close the window. To do this, specify the MCIWNDF_NOTIFYMODE style for the <em>dwStyle</em> parameter of <a href="/windows/desktop/api/Vfw/nf-vfw-mciwndcreatea"><strong>MCIWndCreate</strong></a>. This causes the device to send a <a href="mciwndm-notifymode.html"><strong>MCIWNDM_NOTIFYMODE</strong></a> message whenever it changes modes. Your application can trap this message to determine whether the device has stopped playing. When the device stops playing, the application closes the window.</p>
<p>Â </p>
<p>Â </p>
</body>
