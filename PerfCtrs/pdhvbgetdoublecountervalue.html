<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PdhVbGetDoubleCounterValue function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The PdhVbGetDoubleCounterValue function returns the current value of the specified counter as a double-precision floating point value.
ms.assetid: a2ee63dd-da39-4104-921d-371172bcb45c
title: PdhVbGetDoubleCounterValue function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>PdhVbGetDoubleCounterValue
api_type:</li>
<li>DllExport
api_location:</li>
<li>Pdh.dll</li>
</ul>
<hr />
<h1>PdhVbGetDoubleCounterValue function</h1>
<p>The <strong>PdhVbGetDoubleCounterValue</strong> function returns the current value of the specified counter as a double-precision floating point value. You should check <em>CounterStatus</em> before using the returned number, because the counter may not be valid when it is read. To check the counter status, call the <a href="pdhvbisgoodstatus.html"><strong>PdhVbIsGoodStatus</strong></a> function.</p>
<blockquote>
<p>[!IMPORTANT]
The function that this topic describes may be altered or unavailable in the future. Instead, Microsoft recommends that you use the functions described in <a href="performance-counters-functions.html">Performance Counters Functions</a>.</p>
</blockquote>
<p>Function PdhVbGetDoubleCounterValue( _ ByVal CounterHandle As Long, _ ByRef CounterStatus As Long _ ) As Double</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>CounterHandle</em></p>
<!-- raw HTML omitted -->
<p>ID of the counter whose current value is to be read.</p>
<!-- raw HTML omitted -->
<p><em>CounterStatus</em></p>
<!-- raw HTML omitted -->
<p>Variable in which the current status of the counter value is returned to the caller. The returned data value is valid if and only if the value returned in CounterStatus is PDH_CSTATUS_VALID_DATA or PDH_CSTATUS_NEW_DATA (see PDH error codes). If the value returned in CounterStatus is any other value, do not use the data.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>The function returns the double-precision floating point value of the current counter, computed and formatted as defined by the counter type.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Pdh.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Pdh.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="pdhvbisgoodstatus.html"><strong>PdhVbIsGoodStatus</strong></a></p>
<!-- raw HTML omitted -->
</body>
