<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Checking Counter Data Status Codes</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The return value of PDH functions indicates the success or failure of the function call, which is different from the status of the counter data.
ms.assetid: 00ea5521-bc28-4a87-aba9-46c911631503
title: Checking Counter Data Status Codes
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Checking Counter Data Status Codes</h1>
<p>The return value of PDH functions indicates the success or failure of the function call, which is different from the status of the counter data. Always check the <strong>CStatus</strong> member of a counter value returned in the PDH structures to ensure that the data returned is valid before you use it. If the value of the <strong>CStatus</strong> member does not indicate success, do not use the data. The following are the possible status values for counters:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>PDH_CSTATUS_NO_MACHINE</td>
<td>PDH was unable to connect to the computer specified in the counter path. If this status is returned when the counter is being added, the counter is not completely initialized. Each time the query is updated, PDH retries the connection. When the connection is established, normal data collection resumes.</td>
</tr>
<tr>
<td>PDH_CSTATUS_NO_OBJECT</td>
<td>The specified computer was found, but the specified performance object was found on the computer. If this status is returned when the counter is being added, the specified counter is not included in the query. If this status is returned by an active counter, the data for that counter is invalid. Each time the data is requested, PDH tries to obtain this counter data.</td>
</tr>
<tr>
<td>PDH_CSTATUS_NO_INSTANCE</td>
<td>The specified instance was not found in the object. If this status is returned while the counter is being added to the query, the counter is successfully added to the query, but no data is available until the specific instance appears and a successful status is returned.</td>
</tr>
<tr>
<td>PDH_CSTATUS_NO_COUNTER</td>
<td>The specified counter was not found in the specified object. If this status is returned when the counter is being added, then the counter is not added to the query. If this status is returned after data collection, the data for that counter is invalid. Each time the data is requested, PDH tries to obtain this counter data.</td>
</tr>
<tr>
<td>PDH_CSTATUS_INVALID_DATA</td>
<td>The counter was successfully found, but the data returned is not valid. This error can occur if the counter value is less than the previous value. (Because counter values always increment, the counter value rolls over to zero when it reaches its maximum value.) Another possible cause is a system timer that is not correct.</td>
</tr>
<tr>
<td>PDH_CSTATUS_VALID_DATA</td>
<td>The data for the counter was returned successfully, but is unchanged from the last time the counter was read.</td>
</tr>
<tr>
<td>PDH_CSTATUS_NEW_DATA</td>
<td>The data for the counter was returned successfully and is different from the last time the counter was read. PDH_CSTATUS_NEW_DATA can be returned on a rate counter even if the resulting rate is the same as the last sample. This is because the raw data value that is used in the determination of this status value has changed, not the computed rate.</td>
</tr>
<tr>
<td>PDH_MORE_DATA</td>
<td>The supplied buffer was not large enough to store all of the counter data. Allocate a larger buffer and execute the function again.</td>
</tr>
<tr>
<td>PDH_CSTATUS_ITEM_NOT_VALIDATED</td>
<td>The counter has been added to the query, but has not been validated nor accessed. No additional status information on this counter is available.</td>
</tr>
<tr>
<td>PDH_CSTATUS_NO_COUNTERNAME</td>
<td>No counter name was specified in the query.</td>
</tr>
<tr>
<td>PDH_CSTATUS_NO_COUNTER</td>
<td>The specified counter name could not be found.</td>
</tr>
<tr>
<td>PDH_CSTATUS_NO_OBJECT</td>
<td>The specified performance object could not be found.</td>
</tr>
<tr>
<td>PDH_CALC_NEGATIVE_DENOMINATOR</td>
<td>A counter has a negative denominator value.</td>
</tr>
<tr>
<td>PDH_CALC_NEGATIVE_TIMEBASE</td>
<td>A counter has a negative timebase value.</td>
</tr>
<tr>
<td>PDH_CALC_NEGATIVE_VALUE</td>
<td>A counter has a negative value.</td>
</tr>
<tr>
<td>PDH_CSTATUS_NO_COUNTERNAME</td>
<td>No counter path was specified.</td>
</tr>
<tr>
<td>PDH_CSTATUS_BAD_COUNTERNAME</td>
<td>The counter path format is incorrect.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
