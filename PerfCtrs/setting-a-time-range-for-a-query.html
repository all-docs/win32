<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Setting a Time Range for a Query</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: If the data source is a log file, you can specify a time range for the query.
ms.assetid: 8d9c3e96-3645-4875-9b5f-a6c9ddf23ec3
title: Setting a Time Range for a Query
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Setting a Time Range for a Query</h1>
<p>If the data source is a log file, you can specify a time range for the query. The query retrieves counter data from the log file that was collected during the specified time range. To set the time range, call the <a href="/windows/desktop/api/Pdh/nf-pdh-pdhsetquerytimerange"><strong>PdhSetQueryTimeRange</strong></a> function. <strong>PdhSetQueryTimeRange</strong> is not used to query performance data from real time data sources.</p>
<p>To create time value, use the following steps.</p>
<ol>
<li>Allocate a <a href="/windows/desktop/api/minwinbase/ns-minwinbase-systemtime"><strong>SYSTEMTIME</strong></a> structure and initialize the fields with the desired time value.</li>
<li>Call <a href="/windows/desktop/api/timezoneapi/nf-timezoneapi-systemtimetofiletime"><strong>SystemTimeToFileTime</strong></a> to convert the <a href="/windows/desktop/api/minwinbase/ns-minwinbase-systemtime"><strong>SYSTEMTIME</strong></a> structure time value to a <a href="/windows/desktop/api/minwinbase/ns-minwinbase-filetime"><strong>FILETIME</strong></a> structure time.</li>
<li>Cast the <a href="/windows/desktop/api/minwinbase/ns-minwinbase-filetime"><strong>FILETIME</strong></a> structure as a LONGLONG variable, keeping in mind the structure member padding conventions of your platform and compiler.</li>
<li>Copy the LONGLONG value to the appropriate field in the <a href="/windows/desktop/api/Pdh/ns-pdh-pdh_time_info"><strong>PDH_TIME_INFO</strong></a> structure.</li>
</ol>
<p>To retrieve the time range of all of the performance data contained in a log file, call the <a href="/windows/desktop/api/Pdh/nf-pdh-pdhgetdatasourcetimerangea"><strong>PdhGetDataSourceTimeRange</strong></a> function.</p>
<p>Â </p>
<p>Â </p>
</body>
