<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PdhVbOpenQuery function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The PdhVbOpenQuery function creates and initializes a unique query structure that is used to manage the collection of performance data.
ms.assetid: 9cf535ef-76ad-4773-8414-8e289f3c52f6
title: PdhVbOpenQuery function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>PdhVbOpenQuery
api_type:</li>
<li>DllExport
api_location:</li>
<li>Pdh.dll</li>
</ul>
<hr />
<h1>PdhVbOpenQuery function</h1>
<p>The <strong>PdhVbOpenQuery</strong> function creates and initializes a unique query structure that is used to manage the collection of performance data.</p>
<blockquote>
<p>[!IMPORTANT]
The function that this topic describes may be altered or unavailable in the future. Instead, Microsoft recommends that you use the functions described in <a href="performance-counters-functions.html">Performance Counters Functions</a>.</p>
</blockquote>
<p>Function PdhVbOpenQuery( _ ByVal QueryHandle As Long _ ) As Long</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>QueryHandle</em></p>
<!-- raw HTML omitted -->
<p>Variable that is cleared (equals 0) before the function is called and, if the function is successful, contains the unique ID of the query that is created and opened. This handle is used in the subsequent calls to other PDH functions to identify the query.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, it returns a <strong>Long</strong> integer equal to ERROR_SUCCESS and a new handle in the <em>QueryHandle</em> variable.</p>
<p>If the function fails, the return value is a <a href="/windows/desktop/Debug/system-error-codes">system error code</a> or a <a href="pdh-error-codes.html">PDH error code</a>. The following are possible values.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PDH_INVALID_ARGUMENT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The argument is invalid or incorrect.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PDH_MEMORY_ALLOCATION_FAILURE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A temporary memory buffer could not be allocated.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Pdh.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Pdh.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Pdh/nf-pdh-pdhclosequery"><strong>PdhCloseQuery</strong></a></p>
<!-- raw HTML omitted -->
</body>
