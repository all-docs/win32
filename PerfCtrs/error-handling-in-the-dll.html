<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Error Handling in the DLL</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Use event logging to record errors that occur in the performance DLL.
ms.assetid: 61bc4fa1-8185-4e07-a3b5-4bd357f0f75a
title: Error Handling in the DLL
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Error Handling in the DLL</h1>
<p>Use event logging to record errors that occur in the performance DLL. Logging error events aids in troubleshooting applications that provide performance data during development and after installation. You should limit the amount of error logging that occurs in the <a href="/windows/win32/api/winperf/nc-winperf-pm_collect_proc"><strong>CollectPerformanceData</strong></a> function because data collection can be frequent.</p>
<p>The system logs the following errors to the event log if there are problems with the <a href="/previous-versions/windows/desktop/legacy/aa372200(v=vs.85)"><strong>OpenPerformanceData</strong></a> function. If one of the following errors occurs, the system does not call the performance DLL again. Instead, the DLL is unloaded.</p>
<ul>
<li><strong>PERFLIB_OPEN_PROC_NOT_FOUND</strong>â€”Logged when the procedure name defined in the registry could not be found in the DLL as an exported function. This usually occurs when the DLL or the service is not installed correctly or the function name has been renamed without updating the installation procedure.</li>
<li><strong>PERFLIB_OPEN_PROC_FAILURE</strong>â€”Logged when the open procedure returned an error status other than ERROR_SUCCESS. Should this happen, the DLL should have also entered an event log entry describing the conditions that caused the failure.</li>
<li><strong>PERFLIB_OPEN_PROC_EXCEPTION</strong>â€”Logged when the open procedure encounters an unhandled exception. This is usually due to an unexpected error condition encountered by the open procedure.</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
