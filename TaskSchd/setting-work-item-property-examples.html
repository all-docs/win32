<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Setting Work Item Property Examples</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Setting Work Item Property Examples
description: To set the properties of a work item, call ITaskScheduler Activate to retrieve the interface of the work item object, then call the appropriate method to set the task property you are interested in. Currently, the only valid work items are tasks.
ms.assetid: 80a158de-d312-499d-8ff0-b95e794cf169
keywords:</p>
<ul>
<li>setting work item properties Task Scheduler
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Setting Work Item Property Examples</h1>
<p>To set the properties of a work item, call <a href="/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate"><strong>ITaskScheduler::Activate</strong></a> to retrieve the interface of the work item object, then call the appropriate method to set the task property you are interested in. Currently, the only valid work items are tasks.</p>
<p>The code examples listed at the bottom of the page show how to set the properties that apply to all work items. For other properties that are unique to tasks, see <a href="setting-task-property-examples.html">Setting Task Property Examples</a>.</p>
<blockquote>
<p>[!Note]<br />
In the following code example, all interfaces are released after they are no longer needed.</p>
</blockquote>
<p>Â </p>
<p>In the following examples, the modified object is always saved to disk by a call to <a href="/windows/win32/api/objidl/nf-objidl-ipersistfile-save"><strong>IPersistFile::Save</strong></a>. (The <a href="/windows/win32/api/objidl/nn-objidl-ipersistfile"><strong>IPersistFile</strong></a> interface is a standard COM interface inherited by the task object.)</p>
<p>The following procedure describes how to set a task property.</p>
<p><strong>To set a task property</strong></p>
<ol>
<li>Call <a href="/windows/win32/api/objbase/nf-objbase-coinitialize"><strong>CoInitialize</strong></a> to initialize the COM library and <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> to get a Task Scheduler object. (These examples assume that the Task Scheduler service is running.)</li>
<li>Call <a href="/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate"><strong>ITaskScheduler::Activate</strong></a> to get the <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a> interface of the task object. (Note that tasks are currently the only valid type of work item.)</li>
<li>Call the appropriate <a href="/windows/desktop/api/Mstask/nn-mstask-ischeduledworkitem"><strong>IScheduledWorkItem</strong></a> method to set the property you are interested in. Note that <strong>IScheduledWorkItem</strong> methods are inherited by the <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a> interface.</li>
<li>Call <a href="/windows/win32/api/objidl/nf-objidl-ipersistfile-save"><strong>IPersistFile::Save</strong></a> to store the modified task object to disk.</li>
</ol>
<table>
<thead>
<tr>
<th>For a code example of</th>
<th>See</th>
</tr>
</thead>
<tbody>
<tr>
<td>Setting the account information for a known task</td>
<td><a href="c-c-code-example-setting-task-account-information.html">C/C++ Code Example: Setting Task Account Information</a></td>
</tr>
<tr>
<td>Setting the comment of a known task</td>
<td><a href="c-c-code-example-setting-task-comment.html">C/C++ Code Example: Setting Task Comment</a></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="task-scheduler-1-0-examples.html">Task Scheduler 1.0 Examples</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
