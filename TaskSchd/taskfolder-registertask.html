<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TaskFolder.RegisterTask method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: TaskFolder.RegisterTask method
description: For scripting, registers (creates) a new task in the folder using XML to define the task.
ms.assetid: '9bf5c59b-5aa1-42b3-a307-f583cdf59a39'
keywords:</p>
<ul>
<li>RegisterTask method Task Scheduler</li>
<li>RegisterTask method Task Scheduler , TaskFolder object</li>
<li>TaskFolder object Task Scheduler , RegisterTask method
topic_type:</li>
<li>apiref
api_name:</li>
<li>TaskFolder.RegisterTask
api_location:</li>
<li>taskschd.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>TaskFolder.RegisterTask method</h1>
<p>For scripting, registers (creates) a new task in the folder using XML to define the task.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>TaskFolder.RegisterTask( _
  ByVal path, _
  ByVal xmlText, _
  ByVal flags, _
  ByVal userId, _
  ByVal password, _
  ByVal logonType, _
  [ ByVal sddl ], _
  ByRef pTask _
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>path</em> [in]</p>
<!-- raw HTML omitted -->
<p>The name of the task. If this value is <strong>Nothing</strong>, the task will be registered in the root task folder and the task name will be a GUID value that is created by the Task Scheduler service.</p>
<p>A task name cannot begin or end with a space character. The '.' character cannot be used to specify the current task folder and the '..' characters cannot be used to specify the parent task folder in the path.</p>
<!-- raw HTML omitted -->
<p><em>xmlText</em> [in]</p>
<!-- raw HTML omitted -->
<p>An XML-formatted description of the task.</p>
<p>The following topics contain tasks defined using XML.</p>
<ul>
<li><a href="time-trigger-example--xml-.html">Time Trigger Example (XML)</a></li>
<li><a href="/previous-versions//aa446889(v=vs.85)">Event Trigger Example (XML)</a></li>
<li><a href="daily-trigger-example--xml-.html">Daily Trigger Example (XML)</a></li>
<li><a href="registration-trigger-example--xml-.html">Registration Trigger Example (XML)</a></li>
<li><a href="weekly-trigger-example--xml-.html">Weekly Trigger Example (XML)</a></li>
<li><a href="logon-trigger-example--xml-.html">Logon Trigger Example (XML)</a></li>
<li><a href="boot-trigger-example--xml-.html">Boot Trigger Example (XML)</a></li>
</ul>
<!-- raw HTML omitted -->
<p><em>flags</em> [in]</p>
<!-- raw HTML omitted -->
<p>A <a href="/windows/desktop/api/taskschd/ne-taskschd-task_creation"><strong>TASK_CREATION</strong></a> constant.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_VALIDATE_ONLY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The Task Scheduler checks the syntax of the XML that describes the task but does not register the task. This constant cannot be combined with the <strong>TASK_CREATE</strong>, <strong>TASK_UPDATE</strong>, or <strong>TASK_CREATE_OR_UPDATE</strong> values.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_CREATE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The Task Scheduler registers the task as a new task.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_UPDATE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x4<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The Task Scheduler registers the task as an updated version of an existing task. When a task with a registration trigger is updated, the task will execute after the update occurs.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_CREATE_OR_UPDATE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x6<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The Task Scheduler either registers the task as a new task or as an updated version if the task already exists. Equivalent to TASK_CREATE | TASK_UPDATE.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_DISABLE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x8<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The Task Scheduler disables the existing task.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_DONT_ADD_PRINCIPAL_ACE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x10<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The Task Scheduler is prevented from adding the allow access-control entry (ACE) for the context principal. When the <strong>TaskFolder.RegisterTask</strong> function is called with this flag to update a task, the Task Scheduler service does not add the ACE for the new context principal and does not remove the ACE from the old context principal.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_IGNORE_REGISTRATION_TRIGGERS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x20<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The Task Scheduler creates the task, but ignores the registration triggers in the task. By ignoring the registration triggers, the task will not execute when it is registered unless a time-based trigger causes it to execute on registration.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>userId</em> [in]</p>
<!-- raw HTML omitted -->
<p>The user credentials that are used to register the task.</p>
<blockquote>
<p>[!Note]<br />
If the task is defined as a Task Scheduler 1.0 task, then do not use a group name (rather than a specific user name) in this userId parameter. A task is defined as a Task Scheduler 1.0 task when the version attribute of the Task element in the task's XML is set to 1.1.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><em>password</em> [in]</p>
<!-- raw HTML omitted -->
<p>The password for the userId that is used to register the task. When the TASK_LOGON_SERVICE_ACCOUNT logon type is used, the password must be an empty <strong>VARIANT</strong> value such as <strong>VT_NULL</strong> or <strong>VT_EMPTY</strong>.</p>
<!-- raw HTML omitted -->
<p><em>logonType</em> [in]</p>
<!-- raw HTML omitted -->
<p>Defines what logon technique is used to run the registered task.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_NONE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The logon method is not specified. Used for non-NT credentials. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_PASSWORD</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Use a password for logging on the user. The password must be supplied at registration time.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_S4U</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Use an existing interactive token to run a task. The user must log on using a service for user (S4U) logon. When an S4U logon is used, no password is stored by the system and there is no access to either the network or to encrypted files.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_INTERACTIVE_TOKEN</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->3<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>User must already be logged on. The task will be run only in an existing interactive session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_GROUP</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->4<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Group activation. The <strong>groupId</strong> field specifies the group.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_SERVICE_ACCOUNT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->5<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Indicates that a Local System, Local Service, or Network Service account is being used as a security context to run the task.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_INTERACTIVE_TOKEN_OR_PASSWORD</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->6<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>First use the interactive token. If the user is not logged on (no interactive token is available), then the password is used. The password must be specified when a task is registered. This flag is not recommended for new tasks because it is less reliable than TASK_LOGON_PASSWORD.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>sddl</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The security descriptor that is associated with the registered task. You can specify the access control list (ACL) in the security descriptor for a task in order to allow or deny certain users and groups access to a task.</p>
<blockquote>
<p>[!Note]<br />
If the Local System account is denied access to a task, then the Task Scheduler service can produce unexpected results.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><em>pTask</em> [out]</p>
<!-- raw HTML omitted -->
<p>A <a href="registeredtask.html"><strong>RegisteredTask</strong></a> object that represents the new task.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>For a task, that contains a message box action, the message box will be displayed if the task is activated and the task has an interactive logon type. To set the task logon type to interactive, specify 3 (<strong>TASK_LOGON_INTERACTIVE_TOKEN</strong>) or 4 (<strong>TASK_LOGON_GROUP</strong>) in the <a href="principal-logontype.html"><strong>LogonType</strong></a> property of the task principal, or in the <em>logonType</em> parameter of <strong>TaskFolder.RegisterTask</strong> or <a href="taskfolder-registertaskdefinition.html"><strong>TaskFolder.RegisterTaskDefinition</strong></a>.</p>
<p>Only a member of the Administrators group can create a task with a boot trigger.</p>
<p>You can successfully register a task with a group specified in the <em>userId</em> parameter and 3 (<strong>TASK_LOGON_INTERACTIVE_TOKEN</strong>) specified in the <em>logonType</em> parameter of <strong>TaskFolder.RegisterTask</strong> or <a href="taskfolder-registertaskdefinition.html"><strong>TaskFolder.RegisterTaskDefinition</strong></a>, but the task will not run.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Type library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Taskschd.tlb<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Taskschd.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="task-scheduler-start-page.html">Task Scheduler</a></p>
<!-- raw HTML omitted -->
<p><a href="registeredtask.html"><strong>RegisteredTask</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="taskfolder.html"><strong>TaskFolder</strong></a></p>
<!-- raw HTML omitted -->
</body>
