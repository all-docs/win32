<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Enumerating Tasks Example</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Enumerating Tasks Example
description: To enumerate tasks, you must call ITaskScheduler Enum to create an enumeration object. Then, use the enumeration object's IEnumWorkItems interface to enumerate the tasks in the Scheduled Tasks folder.
ms.assetid: 65a8a8af-f4d8-4948-8dd4-b592f1381bfe
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Enumerating Tasks Example</h1>
<p>To enumerate tasks, you must call <a href="/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-enum"><strong>ITaskScheduler::Enum</strong></a> to create an <a href="e.html"><em>enumeration object</em></a>. Then, use the enumeration object's <a href="/windows/desktop/api/Mstask/nn-mstask-ienumworkitems"><strong>IEnumWorkItems</strong></a> interface to enumerate the tasks in the Scheduled Tasks folder.</p>
<p>The following procedure describes how to enumerate the tasks in the Scheduled Tasks folder.</p>
<p><strong>To enumerate the tasks in the Scheduled Tasks folder</strong></p>
<ol>
<li>Call <a href="/windows/win32/api/objbase/nf-objbase-coinitialize"><strong>CoInitialize</strong></a> to initialize the COM library and <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> to get a Task Scheduler object. (This example assumes that the Task Scheduler service is running.)</li>
<li>Call <a href="/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-enum"><strong>ITaskScheduler::Enum</strong></a> to get an enumeration object.</li>
<li>Call <a href="/windows/desktop/api/Mstask/nf-mstask-ienumworkitems-next"><strong>IEnumWorkItems::Next</strong></a> to retrieve the tasks. (This example tries to retrieve five tasks with each call.)</li>
<li>Process the tasks returned. (This example simply prints the name of each task to the screen.</li>
<li>Release resources. Call <a href="/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree"><strong>CoTaskMemFree</strong></a> to free the memory used for names.</li>
</ol>
<table>
<thead>
<tr>
<th>For a code example of</th>
<th>See</th>
</tr>
</thead>
<tbody>
<tr>
<td>Enumerating all the tasks in the Scheduled Tasks folder of the local computer</td>
<td><a href="c-c-code-example-enumerating-tasks.html">C/C++ Code Example: Enumerating Tasks</a></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="task-scheduler-1-0-examples.html">Task Scheduler 1.0 Examples</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
