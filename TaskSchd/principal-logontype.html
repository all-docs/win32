<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Principal.LogonType property</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Principal.LogonType property
description: For scripting, gets or sets the security logon method that is required to run the tasks that are associated with the principal.
ms.assetid: 'ac6fd7a1-00ef-4478-920f-de391a5a2c8c'
keywords:</p>
<ul>
<li>LogonType property Task Scheduler</li>
<li>LogonType property Task Scheduler , Principal object</li>
<li>Principal object Task Scheduler , LogonType property
topic_type:</li>
<li>apiref
api_name:</li>
<li>Principal.LogonType
api_location:</li>
<li>taskschd.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Principal.LogonType property</h1>
<p>For scripting, gets or sets the security logon method that is required to run the tasks that are associated with the principal.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>Principal.LogonType As Integer
</code></pre>
<h2>Property value</h2>
<p>Set to one of the following <a href="/windows/desktop/api/taskschd/ne-taskschd-task_logon_type"><strong>TASK_LOGON TYPE</strong></a> enumeration constants.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_NONE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The logon method is not specified. Used for non-NT credentials. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_PASSWORD</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Use a password for logging on the user. The password must be supplied at registration time.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_S4U</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Use an existing interactive token to run a task. The user must log on using a service for user (S4U) logon. When an S4U logon is used, no password is stored by the system and there is no access to either the network or encrypted files.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_INTERACTIVE_TOKEN</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->3<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>User must already be logged on. The task will be run only in an existing interactive session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_GROUP</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->4<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Group activation. The userId field specifies the group.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_SERVICE_ACCOUNT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->5<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Indicates that a Local System, Local Service, or Network Service account is being used as a security context to run the task.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TASK_LOGON_INTERACTIVE_TOKEN_OR_PASSWORD</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->6<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>First use the interactive token. If the user is not logged on (no interactive token is available), then the password is used. The password must be specified when a task is registered. This flag is not recommended for new tasks because it is less reliable than TASK_LOGON_PASSWORD.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>This property is valid only when a user identifier is specified by the <a href="principal-userid.html"><strong>UserId</strong></a> property.</p>
<p>When reading or writing XML for a task, the logon type is specified in the <a href="taskschedulerschema-logontype-principaltype-element.html"><strong>&lt;LogonType&gt;</strong></a> element of the Task Scheduler schema.</p>
<p>For a task, that contains a message box action, the message box will be displayed if the task is activated and the task has an interactive logon type. To set the task logon type to interactive, specify 3 (<strong>TASK_LOGON_INTERACTIVE_TOKEN</strong>) or 4 (<strong>TASK_LOGON_GROUP</strong>) in the <strong>LogonType</strong> property of the task principal, or in the <em>logonType</em> parameter of <a href="taskfolder-registertask.html"><strong>TaskFolder.RegisterTask</strong></a> or <a href="taskfolder-registertaskdefinition.html"><strong>TaskFolder.RegisterTaskDefinition</strong></a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Type library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Taskschd.tlb<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Taskschd.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="task-scheduler-start-page.html">Task Scheduler</a></p>
<!-- raw HTML omitted -->
<p><a href="principal.html"><strong>Principal</strong></a></p>
<!-- raw HTML omitted -->
</body>
