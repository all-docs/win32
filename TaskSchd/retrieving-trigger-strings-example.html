<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Retrieving Trigger Strings Example</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Retrieving Trigger Strings Example
description: You can retrieve the trigger strings of a known trigger using the IScheduledWorkItem or ITaskTrigger interface, depending on the type of object you are working with.
ms.assetid: adfa95b1-54f0-4bcd-a260-ca76fd77d43e
keywords:</p>
<ul>
<li>retrieving trigger strings Task Scheduler
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Retrieving Trigger Strings Example</h1>
<p>You can retrieve the trigger strings of a known trigger using the <a href="/windows/desktop/api/Mstask/nn-mstask-ischeduledworkitem"><strong>IScheduledWorkItem</strong></a> or <a href="/windows/desktop/api/Mstask/nn-mstask-itasktrigger"><strong>ITaskTrigger</strong></a> interface, depending on the type of object you are working with.</p>
<p>When working with a <a href="t.html"><em>task object</em></a>, use the methods of the <a href="/windows/desktop/api/Mstask/nn-mstask-ischeduledworkitem"><strong>IScheduledWorkItem</strong></a> interface to retrieve the trigger strings of a work item.</p>
<p>When you are working with a <a href="t.html"><em>task trigger object</em></a>, use the methods of the <a href="/windows/desktop/api/Mstask/nn-mstask-itasktrigger"><strong>ITaskTrigger</strong></a> interface to retrieve the trigger string of the trigger.</p>
<p>The following example shows how to use <a href="/windows/desktop/api/Mstask/nf-mstask-ischeduledworkitem-gettriggerstring"><strong>IScheduledWorkItem::GetTriggerString</strong></a> to display the strings of all triggers associated with a known task.</p>
<p>The following procedure describes how to retrieve the trigger strings of a task.</p>
<p><strong>To retrieve the trigger strings of a task</strong></p>
<ol>
<li>Call <a href="/windows/win32/api/objbase/nf-objbase-coinitialize"><strong>CoInitialize</strong></a> to initialize the COM library and <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> to get a Task Scheduler object. (This example assumes that the Task Scheduler service is running.)</li>
<li>Call <a href="/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate"><strong>ITaskScheduler::Activate</strong></a> to get the <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a> interface of the task object. (Note that this example gets the &quot;Test Task&quot; task.)</li>
<li>Call <strong>ITask::GetTriggerCount</strong> to find out how many triggers are associated with a task. (Note that <a href="/windows/desktop/api/Mstask/nf-mstask-ischeduledworkitem-gettriggercount"><strong>GetTriggerCount</strong></a> is an <a href="/windows/desktop/api/Mstask/nn-mstask-ischeduledworkitem"><strong>IScheduledWorkItem</strong></a> method inherited by <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a>.)</li>
<li>Display the trigger strings, calling <strong>ITask::GetTriggerString</strong> for each trigger associated with the task. (Note that <a href="/windows/desktop/api/Mstask/nf-mstask-ischeduledworkitem-gettriggerstring"><strong>GetTriggerString</strong></a> is an <a href="/windows/desktop/api/Mstask/nn-mstask-ischeduledworkitem"><strong>IScheduledWorkItem</strong></a> method inherited by <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a>.)</li>
<li>Release all resources. Call <a href="/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree"><strong>CoTaskMemFree</strong></a> to release the trigger strings and <strong>ITask::Release</strong> to release the <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a> interface. (Note that <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-release"><strong>Release</strong></a> is an <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> method inherited by <strong>ITask</strong>.)</li>
</ol>
<table>
<thead>
<tr>
<th>For a code example of</th>
<th>See</th>
</tr>
</thead>
<tbody>
<tr>
<td>Retrieving a trigger string for all the triggers associated with a known task</td>
<td><a href="c-c-code-example-retrieving-trigger-strings.html">Code Example: Retrieving Trigger Strings</a></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="task-scheduler-1-0-examples.html">Task Scheduler 1.0 Examples</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
