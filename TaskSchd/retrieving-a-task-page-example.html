<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Retrieving a Task Page Example</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Retrieving a Task Page Example
description: To retrieve a task page you must call ITask QueryInterface to retrieve the IProvideTaskPage interface, then call IProvideTaskPage GetPage. The GetPage method returns a handle to the page, which can then be used to display the page you requested.
ms.assetid: 97525419-c480-465a-97c6-e701043c0af2
keywords:</p>
<ul>
<li>retrieving task page Task Scheduler
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Retrieving a Task Page Example</h1>
<p>To retrieve a task page you must call <strong>ITask::QueryInterface</strong> to retrieve the <a href="/windows/desktop/api/Mstask/nn-mstask-iprovidetaskpage"><strong>IProvideTaskPage</strong></a> interface, then call <a href="/windows/desktop/api/Mstask/nf-mstask-iprovidetaskpage-getpage"><strong>IProvideTaskPage::GetPage</strong></a>. The <strong>GetPage</strong> method returns a handle to the page, which can then be used to display the page you requested.</p>
<blockquote>
<p>[!Note]<br />
In the following code example, all interfaces are released after they are no longer needed.</p>
</blockquote>
<p>Â </p>
<p>The following procedure describes how to create a new trigger.</p>
<p><strong>To create a new trigger</strong></p>
<ol>
<li>Call <a href="/windows/win32/api/objbase/nf-objbase-coinitialize"><strong>CoInitialize</strong></a> to initialize the COM library and <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> to get a Task Scheduler object. (This example assumes that the Task Scheduler service is running.)</li>
<li>Call <a href="/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate"><strong>ITaskScheduler::Activate</strong></a> to get the <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a> interface of the task object. (Note that this example gets the &quot;Test Task&quot; task.)</li>
<li>Call <strong>ITask::QueryInterface</strong> to retrieve the <a href="/windows/desktop/api/Mstask/nn-mstask-iprovidetaskpage"><strong>IProvideTaskPage</strong></a> interface and <a href="/windows/desktop/api/Mstask/nf-mstask-iprovidetaskpage-getpage"><strong>IProvideTaskPage::GetPage</strong></a> to retrieve the page.</li>
<li>Using the returned page handle, display the page.</li>
</ol>
<table>
<thead>
<tr>
<th>For a code example of</th>
<th>See</th>
</tr>
</thead>
<tbody>
<tr>
<td>Retrieving and displaying the Task page of a known task</td>
<td><a href="c-c-code-example-retrieving-a-task-page.html">Retrieving a Task Page</a></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="task-scheduler-1-0-examples.html">Task Scheduler 1.0 Examples</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
