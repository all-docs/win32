<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Creating a New Trigger</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Creating a New Trigger
description: To create a trigger you must use three interfaces.
ms.assetid: c0f121ff-d0a5-4b6c-935c-6f47b4ea26d5
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Creating a New Trigger</h1>
<p>To create a trigger you must use three interfaces. <a href="/windows/desktop/api/Mstask/nn-mstask-ischeduledworkitem"><strong>IScheduledWorkItem</strong></a> provides the <a href="/windows/desktop/api/Mstask/nf-mstask-ischeduledworkitem-createtrigger"><strong>IScheduledWorkItem::CreateTrigger</strong></a> method for creating the trigger object, <a href="/windows/desktop/api/Mstask/nn-mstask-itasktrigger"><strong>ITaskTrigger</strong></a> provides the <a href="/windows/desktop/api/Mstask/nf-mstask-itasktrigger-settrigger"><strong>ITaskTrigger::SetTrigger</strong></a> method for setting the criteria for the trigger, and the COM interface <a href="/windows/win32/api/objidl/nn-objidl-ipersistfile"><strong>IPersistFile</strong></a> provides a <strong>Save</strong> method for saving the new trigger to disk.</p>
<p>The following procedure describes how to create a new trigger.</p>
<p><strong>To create a new trigger</strong></p>
<ol>
<li>Call <a href="/windows/win32/api/objbase/nf-objbase-coinitialize"><strong>CoInitialize</strong></a> to initialize the COM library and <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> to get a Task Scheduler object. (This example assumes that the Task Scheduler service is running.)</li>
<li>Call <a href="/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate"><strong>ITaskScheduler::Activate</strong></a> to get the <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a> interface of the task object. (Note that this example gets the &quot;Test Task&quot; task.)</li>
<li>Call <a href="/windows/desktop/api/Mstask/nf-mstask-ischeduledworkitem-createtrigger"><strong>CreateTrigger</strong></a> to create a trigger object. (Note that <a href="/windows/desktop/api/Mstask/nf-mstask-ischeduledworkitem-createtrigger"><strong>CreateTrigger</strong></a> is inherited from <a href="/windows/desktop/api/Mstask/nn-mstask-ischeduledworkitem"><strong>IScheduledWorkItem</strong></a>.)</li>
<li>Define a <a href="/windows/desktop/api/Mstask/ns-mstask-task_trigger"><strong>TASK_TRIGGER</strong></a> structure. Note that wBeginDay, wBeginMonth, and wBeginYear members of <strong>TASK_TRIGGER</strong> must be set to a valid day, month, and year respectively.</li>
<li>Call <a href="/windows/desktop/api/Mstask/nf-mstask-itasktrigger-settrigger"><strong>ITaskTrigger::SetTrigger</strong></a> to set the trigger criteria.</li>
<li>Save the task with the new trigger to disk using <a href="/windows/win32/api/objidl/nf-objidl-ipersistfile-save"><strong>IPersistFile::Save</strong></a>. (The <a href="/windows/win32/api/objidl/nn-objidl-ipersistfile"><strong>IPersistFile</strong></a> interface is a standard COM interface supported by the <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a> interface.)</li>
<li>Call <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-release"><strong>Release</strong></a> to release all resources. (Note that <strong>Release</strong> is an <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> method inherited by <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a>.)</li>
</ol>
<table>
<thead>
<tr>
<th>For a code example of</th>
<th>See</th>
</tr>
</thead>
<tbody>
<tr>
<td>Creating a new trigger for an existing task</td>
<td><a href="c-c-code-example-creating-a-task-trigger.html">C/C++ Code Example: Creating a Task Trigger</a></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="task-scheduler-1-0-examples.html">Task Scheduler 1.0 Examples</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
