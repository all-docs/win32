<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TaskService.Connect method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: TaskService.Connect method
description: For scripting, connects to a remote machine and associates all subsequent calls on this interface with a remote session.
ms.assetid: '206087df-307c-4ba9-9e83-915f5287f281'
keywords:</p>
<ul>
<li>Connect method Task Scheduler</li>
<li>Connect method Task Scheduler , TaskService object</li>
<li>TaskService object Task Scheduler , Connect method
topic_type:</li>
<li>apiref
api_name:</li>
<li>TaskService.Connect
api_location:</li>
<li>taskschd.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>TaskService.Connect method</h1>
<p>For scripting, connects to a remote machine and associates all subsequent calls on this interface with a remote session. If the serverName parameter is empty, then this method will execute on the local computer. If the userId is not specified, then the current token is used.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>TaskService.Connect( _
  [ ByVal serverName ], _
  [ ByVal user ], _
  [ ByVal domain ], _
  [ ByVal password ] _
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>serverName</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The name of the computer that you want to connect to. If the serverName parameter is empty, then this method will execute on the local computer.</p>
<!-- raw HTML omitted -->
<p><em>user</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The user name that is used during the connection to the computer. If the user is not specified, then the current token is used.</p>
<!-- raw HTML omitted -->
<p><em>domain</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The domain of the user specified in the <em>user</em> parameter.</p>
<!-- raw HTML omitted -->
<p><em>password</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The password that is used to connect to the computer. If the user name and password are not specified, then the current token is used.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>The <strong>TaskService.Connect</strong> method should be called before calling any of the other <a href="taskservice.html"><strong>TaskService</strong></a> methods.</p>
<p>If the Connect method fails, you can collect the error identifier to find the meaning of the error. The following table lists the error identifiers and their descriptions.</p>
<table>
<thead>
<tr>
<th>Error Identifier</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x80070005</td>
<td>Access is denied to connect to the Task Scheduler service.</td>
</tr>
<tr>
<td>0x80041315</td>
<td>The Task Scheduler service is not running.</td>
</tr>
<tr>
<td>0x8007000e</td>
<td>The application does not have enough memory to complete the operation or the <!-- raw HTML omitted -->user<!-- raw HTML omitted -->, <!-- raw HTML omitted -->password<!-- raw HTML omitted -->, or <!-- raw HTML omitted -->domain<!-- raw HTML omitted --> has at least one null and one non-null value.</td>
</tr>
<tr>
<td>53</td>
<td>This error is returned in the following situations:<!-- raw HTML omitted --><!-- raw HTML omitted -->The computer name specified in the <!-- raw HTML omitted -->serverName<!-- raw HTML omitted --> parameter does not exist.<!-- raw HTML omitted --><!-- raw HTML omitted -->When you are trying to connect to a Windows Server 2003 or Windows XP computer, and the remote computer does not have the File and Printer Sharing firewall exception enabled or the Remote Registry service is not running.<!-- raw HTML omitted --><!-- raw HTML omitted -->When you are trying to connect to a Windows Vista computer, and the remote computer does not have the Remote Scheduled Tasks Management firewall exception enabled and the File and Printer Sharing firewall exception enabled, or the Remote Registry service is not running.<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>50</td>
<td>The <!-- raw HTML omitted -->user<!-- raw HTML omitted -->, <!-- raw HTML omitted -->password<!-- raw HTML omitted -->, or <!-- raw HTML omitted -->domain<!-- raw HTML omitted --> parameters cannot be specified when connecting to a remote Windows XP or Windows Server 2003 computer from a Windows Vista computer.</td>
</tr>
</tbody>
</table>
<p>If you are to connecting to a remote Windows Vista computer from a Windows Vista, you need to allow the Remote Scheduled Tasks Management firewall exception on the remote computer. To allow this exception click Start, Control Panel, Security, Allow a program through Windows Firewall, and then select the Remote Scheduled Tasks Management check box. Then click the Ok button in the Windows Firewall Settings dialog box.</p>
<p>If you are connecting to a remote Windows XP or Windows Server 2003 computer from a Windows Vista computer, you need to allow the File and Printer Sharing firewall exception on the remote computer. To allow this exception click Start, Control Panel, double-click Windows Firewall, select the Exceptions tab, and then select the File and Printer Sharing firewall exception. Then click the OK button in the Windows Firewall dialog box. The Remote Registry service must also be running on the remote computer.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Type library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Taskschd.tlb<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Taskschd.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
