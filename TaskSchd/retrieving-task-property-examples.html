<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Retrieving Task Property Examples</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Retrieving Task Property Examples
description: To retrieve the properties of a task, call ITaskScheduler Activate to get retrieve the interface of the task object, then call the appropriate ITask method to retrieve the task property that you are interested in.
ms.assetid: 9ec9d836-c735-4a32-96b1-3dbd0a31b22a
keywords:</p>
<ul>
<li>retrieving task properties Task Scheduler
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Retrieving Task Property Examples</h1>
<p>To retrieve the properties of a task, call <a href="/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate"><strong>ITaskScheduler::Activate</strong></a> to get retrieve the interface of the task object, then call the appropriate <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a> method to retrieve the task property that you are interested in. The code examples listed at the bottom of the page show how to retrieve the different task properties.</p>
<p>The code examples listed at the bottom of the page show how to retrieve the properties that are unique to task objects. For other <a href="w.html"><em>work item</em></a> properties that also apply to tasks, see <a href="retrieving-work-item-property-examples.html">Retrieving Work Item Examples</a>.</p>
<blockquote>
<p>[!Note]<br />
In the following code example, all interfaces are released after they are no longer needed.</p>
</blockquote>
<p>Â </p>
<p>Note that if you are retrieving a string property (such as the application name, parameters, or working directory), you must call <a href="/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree">CoTaskMemFree</a> to free the memory allocated for the returned string.</p>
<p>The following procedure describes how to retrieve a task property.</p>
<p><strong>To retrieve a task property</strong></p>
<ol>
<li>Call <a href="/windows/win32/api/objbase/nf-objbase-coinitialize"><strong>CoInitialize</strong></a> to initialize the COM library and <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> to get a Task Scheduler object. (These examples assume that the Task Scheduler service is running.)</li>
<li>Call <a href="/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate"><strong>ITaskScheduler::Activate</strong></a> to get the <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a> interface of the task object. (Note that this example gets the &quot;Test Task&quot; task.)</li>
<li>Call the appropriate <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a> method to retrieve the property you are interested in.</li>
<li>Process the property as needed. (These examples print the property to the screen.)</li>
<li>If the returned property is a string, call <a href="/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree">CoTaskMemFree</a> to free the memory allocated for the returned string.</li>
</ol>
<table>
<thead>
<tr>
<th>For a code example of</th>
<th>See</th>
</tr>
</thead>
<tbody>
<tr>
<td>Retrieving the name of the application associated with a given task</td>
<td><a href="c-c-code-example-retrieving-the-task-application-name.html">C/C++ Code Example: Retrieving the Task Application Name</a></td>
</tr>
<tr>
<td>Retrieving the maximum amount of time the task can run and displaying that number on the screen</td>
<td><a href="c-c-code-example-retrieving-the-task-maxruntime.html">C/C++ Code Example: Retrieving the Task MaxRunTime</a></td>
</tr>
<tr>
<td>Retrieving the parameter string that is executed when the task is run and displaying that string on the screen</td>
<td><a href="c-c-code-example-retrieving-task-parameters.html">C/C++ Code Example: Retrieving Task Parameters</a></td>
</tr>
<tr>
<td>Retrieving the <a href="p.html"><em>priority level</em></a> of the task</td>
<td><a href="c-c-code-example-retrieving-task-priority.html">C/C++ Code Example: Retrieving Task Priority</a></td>
</tr>
<tr>
<td>Retrieving the <a href="w.html"><em>working directory</em></a> of a task and displaying the path to the working directory on the screen</td>
<td><a href="c-c-code-example-retrieving-the-task-working-directory.html">C/C++ Code Example: Retrieving the Task Working Directory</a></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="task-scheduler-1-0-examples.html">Task Scheduler 1.0 Examples</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
