<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Retrieving Work Item Property Examples</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Retrieving Work Item Property Examples
description: To retrieve the properties of a work item, call ITaskScheduler Activate to retrieve the interface of the work item object, then call the appropriate method to retrieve the task property you are interested in.
ms.assetid: d9723dea-1a82-4993-b4d0-bc7d944e775f
keywords:</p>
<ul>
<li>retrieving work item properties Task Scheduler
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Retrieving Work Item Property Examples</h1>
<p>To retrieve the properties of a work item, call <a href="/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate"><strong>ITaskScheduler::Activate</strong></a> to retrieve the interface of the work item object, then call the appropriate method to retrieve the task property you are interested in. Currently, the only valid work items are tasks.</p>
<p>The code examples listed at the bottom of this page show how to retrieve the properties that apply to all work items. For other properties that are unique to tasks, see <a href="setting-task-property-examples.html">Setting Task Property Examples</a>.</p>
<blockquote>
<p>[!Note]<br />
In the following code example, all interfaces are released after they are no longer needed.</p>
</blockquote>
<p>Â </p>
<p>Note that if you are retrieving a string property (such as comment for a work item), you must call <a href="/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree"><strong>CoTaskMemFree</strong></a> to free the memory allocated for the returned string.</p>
<p>The following procedure describes how to retrieve a task property.</p>
<p><strong>To retrieve a task property</strong></p>
<ol>
<li>Call <a href="/windows/win32/api/objbase/nf-objbase-coinitialize"><strong>CoInitialize</strong></a> to initialize the COM library and <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> to get a Task Scheduler object. (These examples assume that the Task Scheduler service is running.)</li>
<li>Call <a href="/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate"><strong>ITaskScheduler::Activate</strong></a> to get the <a href="/windows/desktop/api/Mstask/nn-mstask-itask"><strong>ITask</strong></a> interface of the task object. (Note that tasks are currently the only valid type of work item.)</li>
<li>Call the appropriate method to retrieve the property you are interested in.</li>
<li>Process the property as needed. (These examples simply print the property to the screen.)</li>
<li>If the returned property is a string, call <a href="/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree"><strong>CoTaskMemFree</strong></a> to free the memory allocated for the returned string.</li>
</ol>
<table>
<thead>
<tr>
<th>For a code example of</th>
<th>See</th>
</tr>
</thead>
<tbody>
<tr>
<td>Retrieving the account information of a known task</td>
<td><a href="c-c-code-example-retrieving-task-account-information.html">C/C++ Code Example: Retrieving Task Account Information</a></td>
</tr>
<tr>
<td>Retrieving the comment string of a known task</td>
<td><a href="c-c-code-example-retrieving-a-task-comment.html">C/C++ Code Example: Retrieving a Task Comment</a></td>
</tr>
<tr>
<td>Retrieving the name of the creator of the task and displaying it on the screen</td>
<td><a href="c-c-code-example-retrieving-the-task-creator.html">C/C++ Code Example: Retrieving the Task Creator</a></td>
</tr>
<tr>
<td>Retrieving the last exit code returned by a known task</td>
<td><a href="c-c-code-example-retrieving-task-exit-code.html">C/C++ Code Example: Retrieving Task Exit Code</a></td>
</tr>
<tr>
<td>Retrieving the idle-wait time of the task and displaying it on the screen</td>
<td><a href="c-c-code-example-retrieving-task-idle-wait-time.html">C/C++ Code Example: Retrieving Task Idle-wait Time</a></td>
</tr>
<tr>
<td>Retrieving the time the task was last run and displaying it on the screen</td>
<td><a href="c-c-code-example-retrieving-the-task-mostrecentrun-time.html">C/C++ Code Example: Retrieving the Task MostRecentRun Time</a></td>
</tr>
<tr>
<td>Retrieving the next time the task is scheduled to run and displaying that time on the screen</td>
<td><a href="c-c-code-example-retrieving-the-task-nextrun-time.html">C/C++ Code Example: Retrieving the Task NextRun Time</a></td>
</tr>
<tr>
<td>Retrieving the run times of the task and displaying them on the screen</td>
<td><a href="c-c-code-example-retrieving-task-run-times.html">C/C++ Code Example: Retrieving Task Run Times</a></td>
</tr>
<tr>
<td>Retrieving the current status of the task and displaying it on the screen</td>
<td><a href="c-c-code-example-retrieving-task-status.html">C/C++ Code Example: Retrieving Task Status</a></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="task-scheduler-1-0-examples.html">Task Scheduler 1.0 Examples</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
