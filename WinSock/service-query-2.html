<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Service Query</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Name service query in Windows Sockets (Winsock).
ms.assetid: 94d77f7b-824a-4686-b270-9c662976bbc0
title: Service Query
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Service Query</h1>
<ul>
<li><a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin"><strong>NSPLookupServiceBegin</strong></a></li>
<li><a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext"><strong>NSPLookupServiceNext</strong></a></li>
<li><a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupserviceend"><strong>NSPLookupServiceEnd</strong></a></li>
</ul>
<p>A name service query involves a series of calls: <a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin"><strong>NSPLookupServiceBegin</strong></a>, followed by one or more calls to <a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext"><strong>NSPLookupServiceNext</strong></a> and ending with a call to <a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupserviceend"><strong>NSPLookupServiceEnd</strong></a>. <a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin"><strong>NSPLookupServiceBegin</strong></a> takes a <a href="/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a> structure as input in order to define the query parameters along with a set of flags to provide additional control over the search operation. It returns a query handle which is used in the subsequent calls to <strong>NSPLookupServiceNext</strong> and <strong>NSPLookupServiceEnd</strong>.</p>
<p>The namespace SPI client invokes <a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext"><strong>NSPLookupServiceNext</strong></a> to obtain query results, with results supplied in an client-supplied <a href="/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a> buffer. The client continues to call <strong>NSPLookupServiceNext</strong> until the error code WSA_E_NO_MORE is returned indicating that all results have been retrieved. The search is then terminated by a call to <a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupserviceend"><strong>NSPLookupServiceEnd</strong></a>. The <strong>NSPLookupServiceEnd</strong> function can also be used to cancel a currently pending <strong>NSPLookupServiceNext</strong> when called from another thread.</p>
<p>In Windows Sockets 2, conflicting error codes are defined for WSAENOMORE (10102) and WSA_E_NO_MORE (10110). The error code WSAENOMORE will be removed in a future version and only WSA_E_NO_MORE will remain. Namespace providers should switch to using the WSA_E_NO_MORE error code as soon as possible to maintain compatibility with the widest possible range of applications.</p>
<p>Â </p>
<p>Â </p>
</body>
