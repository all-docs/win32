<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Function Interface Model</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Windows Sockets transport and namespace&amp;#8211;service providers are DLLs with a single exported procedure entry point for the service provider initialization function WSPStartup or NSPStartup, respectively.
ms.assetid: a3422513-92e2-4011-a756-04ed853e9d56
title: Function Interface Model
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Function Interface Model</h1>
<p>Windows Sockets transport and namespaceâ€“service providers are DLLs with a single exported procedure entry point for the service provider initialization function <a href="/windows/desktop/api/Ws2spi/nf-ws2spi-wspstartup"><strong>WSPStartup</strong></a> or <a href="/windows/desktop/api/Ws2spi/nf-ws2spi-nspstartup"><strong>NSPStartup</strong></a>, respectively. All other service provider functions are made accessible to the Ws2_32.dll through the service provider's dispatch table. Service provider DLL's are loaded into memory by the Ws2_32.dll only when needed, and are unloaded when their services are no longer required.</p>
<p>The SPI also defines several circumstances in which a transport service provider calls up into the Ws2_32.dll (upcalls) to obtain DLL support services. The transport service provider DLL is given the Ws2_32.dll's upcall dispatch table through the <em>UpcallTable</em> parameter to <a href="/windows/desktop/api/Ws2spi/nf-ws2spi-wspstartup"><strong>WSPStartup</strong></a>.</p>
<p>Service providers should have their file name extension changed from &quot;DLL&quot; to &quot;.WSP&quot; or &quot;.NSP&quot;. This requirement is not strict. A service provider will still operate with the Ws2_32.dll with any file name extension.</p>
<p>The Winsock SPI uses the following function prefix naming convention:</p>
<table>
<thead>
<tr>
<th>Prefix</th>
<th>Meaning</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>WSP</td>
<td>Windows Sockets Service Provider</td>
<td>Transport service provider entry points</td>
</tr>
<tr>
<td>WPU</td>
<td>Windows Sockets Provider Upcall</td>
<td>Ws2_32.dll entry points for service providers</td>
</tr>
<tr>
<td>WSC</td>
<td>Windows Sockets Configuration</td>
<td>WS2_32.dll entry points for installation applets</td>
</tr>
<tr>
<td>NSP</td>
<td>Namespace Provider</td>
<td>Namespace provider entry points</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>As described above, these entry points are not exported (with the exception of <a href="/windows/desktop/api/Ws2spi/nf-ws2spi-wspstartup"><strong>WSPStartup</strong></a> and <a href="/windows/desktop/api/Ws2spi/nf-ws2spi-nspstartup"><strong>NSPStartup</strong></a>), but are accessed through an exchange of dispatch tables.</p>
<p>Â </p>
<p>Â </p>
</body>
