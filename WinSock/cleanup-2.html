<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Cleanup</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The Ws2_32.dll (and layered protocols) will call WSPCleanup once for each invocation of WSPStartup.
ms.assetid: c3b7b648-5727-47d6-9ddc-9d9f6511949d
title: Cleanup
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Cleanup</h1>
<p>The Ws2_32.dll (and layered protocols) will call <a href="/previous-versions/windows/hardware/network/ff566270(v=vs.85)"><strong>WSPCleanup</strong></a> once for each invocation of <a href="/windows/desktop/api/Ws2spi/nf-ws2spi-wspstartup"><strong>WSPStartup</strong></a>. On each invocation, <strong>WSPCleanup</strong> should decrement a per-process reference counter, and when the counter reaches zero, the service provider must prepare itself to be unloaded from memory. The first order of business is to finish transmitting any unsent data on sockets that are configured for a graceful close. Thereafter, any and all resources held by the provider are to be freed. The service provider must be left in a state where it can be immediately reinitialized by a call to <strong>WSPStartup</strong>.</p>
<p>Â </p>
<p>Â </p>
</body>
