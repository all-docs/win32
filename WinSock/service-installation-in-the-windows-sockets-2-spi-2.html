<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Service Installation in the Windows Sockets 2 SPI</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Service installation in the Windows Sockets 2 (Winsock) SPI.
ms.assetid: a303fbcf-9122-422a-9b12-d00a5df0fc0f
title: Service Installation in the Windows Sockets 2 SPI
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Service Installation in the Windows Sockets 2 SPI</h1>
<ul>
<li><a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspinstallserviceclass"><strong>NSPInstallServiceClass</strong></a></li>
<li><a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspremoveserviceclass"><strong>NSPRemoveServiceClass</strong></a></li>
<li><a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspsetservice"><strong>NSPSetService</strong></a></li>
</ul>
<p>When the required service class does not already exist, a namespace SPI client uses <a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspinstallserviceclass"><strong>NSPInstallServiceClass</strong></a> to install a new service class by supplying a service class name, a GUID for the service class identifier, and a series of <a href="/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow"><strong>WSANSCLASSINFO</strong></a> structures. These structures are each specific to a particular namespace, and supply common values such as recommended TCP port numbers or NetWare SAP Identifiers. A service class can be removed by calling <a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspremoveserviceclass"><strong>NSPRemoveServiceClass</strong></a> and supplying the GUID corresponding to the class identifier.</p>
<p>Once a service class exists, specific instances of a service can be installed or removed via <a href="/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspsetservice"><strong>NSPSetService</strong></a>. This function takes a <a href="/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a> structure as an input parameter along with an operation code and operation flags. The operation code indicates whether the service is being installed or removed. The <strong>WSAQUERYSET</strong> structure provides all of the relevant information about the service including service class identifier, service name (for this instance), applicable namespace identifier and protocol information, and a set of transport addresses to which the service listens.</p>
<p>Â </p>
<p>Â </p>
</body>
