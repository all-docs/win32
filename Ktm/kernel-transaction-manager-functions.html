<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Kernel Transaction Manager Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The following functions are used with transactions.
ms.assetid: e9704ea8-e67d-4278-b77e-1d4787224d52
title: Kernel Transaction Manager Functions
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Kernel Transaction Manager Functions</h1>
<p>The following functions are used with transactions.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-committransaction"><strong>CommitTransaction</strong></a></td>
<td>Requests that the specified transaction be committed.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-committransactionasync"><strong>CommitTransactionAsync</strong></a></td>
<td>Requests that the specified transaction be committed.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/KtmW32/nf-ktmw32-createtransaction"><strong>CreateTransaction</strong></a></td>
<td>Creates a new transaction object.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-gettransactionid"><strong>GetTransactionId</strong></a></td>
<td>Obtains the ID for the specified transaction.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-gettransactioninformation"><strong>GetTransactionInformation</strong></a></td>
<td>Returns the requested information about the specified transaction.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-opentransaction"><strong>OpenTransaction</strong></a></td>
<td>Opens an existing transaction.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-rollbackcomplete"><strong>RollbackComplete</strong></a></td>
<td>Indicates that the resource manager (RM) has successfully completed rolling back a transaction.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-rollbacktransaction"><strong>RollbackTransaction</strong></a></td>
<td>Requests that the specified transaction be rolled back.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-rollbacktransactionasync"><strong>RollbackTransactionAsync</strong></a></td>
<td>Requests that the specified transaction be rolled back. This function returns asynchronously.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-settransactioninformation"><strong>SetTransactionInformation</strong></a></td>
<td>Sets the transaction information for the specified transaction.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The following functions are used with enlistments.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-commitcomplete"><strong>CommitComplete</strong></a></td>
<td>Indicates that a RM has finished committing a transaction that was requested by the transaction manager (TM).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/KtmW32/nf-ktmw32-commitenlistment"><strong>CommitEnlistment</strong></a></td>
<td>Commits the transaction for the specified enlistment.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-getenlistmentid"><strong>GetEnlistmentId</strong></a></td>
<td>Obtains the ID for the specified enlistment.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/KtmW32/nf-ktmw32-createenlistment"><strong>CreateEnlistment</strong></a></td>
<td>Creates an enlistment, sets its initial state, and opens a handle to the enlistment with the specified access.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-getenlistmentrecoveryinformation"><strong>GetEnlistmentRecoveryInformation</strong></a></td>
<td>Retrieves an opaque structure of recovery data from KTM. Recovery information is stored in a log on behalf of a RM by calling the <a href="/windows/desktop/api/Ktmw32/nf-ktmw32-setenlistmentrecoveryinformation"><strong>SetEnlistmentRecoveryInformation</strong></a> function. After a failure, the RM can use the <a href="/windows/desktop/api/Ktmw32/nf-ktmw32-getenlistmentrecoveryinformation"><strong>GetEnlistmentRecoveryInformation</strong></a> function to retrieve the information.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-openenlistment"><strong>OpenEnlistment</strong></a></td>
<td>Opens an existing enlistment object, and returns a handle to the enlistment.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/KtmW32/nf-ktmw32-prepareenlistment"><strong>PrepareEnlistment</strong></a></td>
<td>Called by superior TM to indicate that their pre-prepares work has been completed.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/KtmW32/nf-ktmw32-preprepareenlistment"><strong>PrePrepareEnlistment</strong></a></td>
<td>Called by superior TM to indicate that their pre-prepares work has been completed.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-recoverenlistment"><strong>RecoverEnlistment</strong></a></td>
<td>Recovers an enlistment's state.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-readonlyenlistment"><strong>ReadOnlyEnlistment</strong></a></td>
<td>Requests that the specified enlistment be converted to a read-only enlistment. A read-only enlistment cannot participate in the outcome of the transaction and is not durably recorded for recovery.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-rollbackenlistment"><strong>RollbackEnlistment</strong></a></td>
<td>Rolls back the specified transaction that is associated with an enlistment. This function cannot be called for read-only enlistments.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-setenlistmentrecoveryinformation"><strong>SetEnlistmentRecoveryInformation</strong></a></td>
<td>Sets an opaque, user-defined structure of recovery data from KTM. Recovery information is stored in a log on behalf of a RM by calling <a href="/windows/desktop/api/Ktmw32/nf-ktmw32-setenlistmentrecoveryinformation"><strong>SetEnlistmentRecoveryInformation</strong></a>. After a failure, the RM can use <a href="/windows/desktop/api/Ktmw32/nf-ktmw32-getenlistmentrecoveryinformation"><strong>GetEnlistmentRecoveryInformation</strong></a> to retrieve the information.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-singlephasereject"><strong>SinglePhaseReject</strong></a></td>
<td>Indicates that the RM is refusing a single-phase request. When a TM receives this call, it initiates a two-phase commit and sends a prepare request to all enlisted RMs.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The following functions are used with resource managers.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-createresourcemanager"><strong>CreateResourceManager</strong></a></td>
<td>Creates a new RM object, and associates the RM with a transaction manager (TM).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/KtmW32/nf-ktmw32-getnotificationresourcemanager"><strong>GetNotificationResourceManager</strong></a></td>
<td>Requests and receives a notification for RM. This function is used by the RM register to receive notifications when a transaction changes state.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/KtmW32/nf-ktmw32-getnotificationresourcemanagerasync"><strong>GetNotificationResourceManagerAsync</strong></a></td>
<td>Requests and receives asynchronous notification for a RM. This function is used by the RM to register to receive notifications when a transaction changes state.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-openresourcemanager"><strong>OpenResourceManager</strong></a></td>
<td>Opens an existing RM.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-preparecomplete"><strong>PrepareComplete</strong></a></td>
<td>Indicates that the RM has completed all processing necessary to guarantee that a commit or abort operation will succeed for the specified transaction.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-prepreparecomplete"><strong>PrePrepareComplete</strong></a></td>
<td>Signals that this RM has completed its preprepare work, so that other RMs can now begin their prepare operations.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-recoverresourcemanager"><strong>RecoverResourceManager</strong></a></td>
<td>Recovers a RM's state from its log file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-setresourcemanagercompletionport"><strong>SetResourceManagerCompletionPort</strong></a></td>
<td>Associates the specified I/O completion port with the specified RM. This port receives all notifications for the RM.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The following functions are used with transaction managers.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-createtransactionmanager"><strong>CreateTransactionManager</strong></a></td>
<td>Creates a new TM object and returns a handle with the specified access.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-getcurrentclocktransactionmanager"><strong>GetCurrentClockTransactionManager</strong></a></td>
<td>Obtains a virtual clock value from a TM.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-gettransactionmanagerid"><strong>GetTransactionManagerId</strong></a></td>
<td>Obtains an identifier for the specified TM.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-opentransactionmanager"><strong>OpenTransactionManager</strong></a></td>
<td>Opens an existing TM.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-opentransactionmanagerbyid"><strong>OpenTransactionManagerById</strong></a></td>
<td>Opens an existing TM.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ktmw32/nf-ktmw32-recovertransactionmanager"><strong>RecoverTransactionManager</strong></a></td>
<td>Recovers a TM's state from its log file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/KtmW32/nf-ktmw32-renametransactionmanager"><strong>RenameTransactionManager</strong></a></td>
<td>Renames a TM.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/KtmW32/nf-ktmw32-rollforwardtransactionmanager"><strong>RollforwardTransactionManager</strong></a></td>
<td>Recovers TM's state from its log file to the specified virtual clock value.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
