<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetReadFile Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetReadFile Function&quot;
title: JetReadFile Function
TOCTitle: JetReadFile Function
ms:assetid: 59dc9e04-7e02-4835-9aed-95cfcf74d780
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg269257(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg269257(v=EXCHG.10)</a>
ms:contentKeyID: 32765559
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetReadFile
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>DLLExport</li>
<li>COM
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetReadFile Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetReadFile Function</h2>
<p>The <strong>JetReadFile</strong> function retrieves the contents of a file opened with <a href="./jetopenfile-function.html">JetOpenFile</a>.</p>
<pre lang="cpp"><code>    JET_ERR JET_API JetReadFile(
      __in          JET_HANDLE hfFile,
      __out         void* pv,
      __in          unsigned long cb,
      __out_opt     unsigned long* pcbActual
    );
</code></pre>
<h3>Parameters</h3>
<p><em>hfFile</em></p>
<p>The handle of the file to be read.</p>
<p><em>pv</em></p>
<p>Output buffer that will receive the file data.</p>
<p><em>cb</em></p>
<p>The maximum size in bytes of the output buffer.</p>
<p><em>pcbActual</em></p>
<p>Receives the actual amount of file data retrieved.</p>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errBackupAbortByServer<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation failed because the current external backup has been aborted by a call to <!-- raw HTML omitted -->JetStopService<!-- raw HTML omitted -->. This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errClientRequestToStopJetService<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because all activity on the instance associated with the session has ceased as a result of a call to <!-- raw HTML omitted -->JetStopService<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInstanceUnavailable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has encountered a fatal error that requires that access to all data be revoked to protect the integrity of that data. This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidParameter<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->One of the parameters provided contained an unexpected value or contained a value that did not make sense when combined with the value of another parameter. This can happen for <!-- raw HTML omitted -->JetReadFile<!-- raw HTML omitted --> when:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The specified instance handle is invalid. WindowsÂ XP and later releases.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The output buffer size is not a multiple of the database page size (<!-- raw HTML omitted -->JET_paramDatabasePageSize<!-- raw HTML omitted -->). WindowsÂ XP and later releases.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The output buffer size is smaller than three database pages (<!-- raw HTML omitted -->JET_paramDatabasePageSize<!-- raw HTML omitted -->) and this is the first call to <!-- raw HTML omitted -->JetReadFile<!-- raw HTML omitted --> for the specified handle. WindowsÂ XP and later releases.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNoBackup<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation failed because no external backup is in progress.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNotInitialized<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has not been initialized yet.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errReadVerifyFailure<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation failed because non-recoverable data corruption was detected while reading a database page from a database file or database patch file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errLogReadVerifyFailure<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation failed because non-recoverable data corruption was detected while reading a transaction log file. This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRestoreInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because a restore operation is in progress on the instance associated with the session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRunningInMultiInstanceMode<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation failed because an attempt was made to use the engine in legacy mode (WindowsÂ 2000 compatibility mode) where only one instance is supported when in fact multiple instances already exist.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTermInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session is being shut down.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>On success, the next chunk of data from the file will be read into the output buffer. The actual number of bytes retrieved will also be returned. The file offset at which the next read will occur will be advanced by this amount.</p>
<p>On failure, the state of the output buffer is undefined. The failure will result in the cancellation of the entire backup process for the instance. On WindowsÂ XP and later releases, the backup will not be canceled if an error occurred while reading a database file. However, the backup of that database file will still be canceled and the corresponding handle will automatically be closed.</p>
<h4>Remarks</h4>
<p>Any call to <strong>JetReadFile</strong> using a handle that has already returned all the data in the underlying file (such as a previous call returned less bytes than the size of the output buffer) will always succeed but return zero bytes of data.</p>
<p>A large output buffer should be used to maximize backup performance. Some experimentation may be required to find the right tradeoff between resource consumption and throughput for a given situation. The output buffer should be no smaller than 64KB in any case.</p>
<p>Multiple concurrent calls to <strong>JetReadFile</strong> using the same file handle are not supported. This means that it is not possible to queue several buffers for read concurrently against the same file to achieve high sequential throughput. A single large buffer should be used instead.</p>
<p>If the instance is configured such that database page scrubbing is enabled (see JET_paramZeroDatabaseDuringBackup in System Parameters) then deleted data will be removed from the database as a side effect of a call to <strong>JetReadFile</strong> against the database file.</p>
<p>It is very important to understand how backup and data corruption interact. If the database engine detects data corruption during a backup then it will either fail the backup of the affected database or of the entire instance. This is a conscious design decision intended to protect against data loss. If the database engine allowed a backup to succeed where data corruption was present then it is possible that an older, uncorrupted backup could be discarded as a result. This would be unfortunate because it would be possible to fix the data corruption on the live instance by restoring that backup and replaying all the transaction log files against that database. This zero data loss scenario presumes that circular logging is not enabled (see <a href="./transaction-log-parameters.html">JET_paramCircularLog</a> in <a href="./extensible-storage-engine-system-parameters.html">System Parameters</a>).</p>
<p>It is also important to understand that when data corruption is present streaming backup will be the most likely place that it will first be detected. This is the case because streaming backup is the only process that routinely scans every single page of the database file. It is also likely that streaming backup will be the first process to detect the early signs of hardware failure as manifested by intermittent data corruption errors. This is due to the amount of data retrieved by backup as well as the speed at which it is retrieved.</p>
<p>Data corruption is detected by the database engine through the use of block checksums. These checksums are set just prior to a database page write and are verified on a database page read. This scheme enables the database engine to determine that data has been corrupted at some point but it does not enable the database engine to determine the source of that corruption. Historically, the predominant cause of such corruption has been found to come from sources other than the database engine itself.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista, WindowsÂ XP, or WindowsÂ 2000 Professional.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008, Windows ServerÂ 2003, or WindowsÂ 2000 Server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-handle.html">JET_HANDLE</a><br />
<a href="./jet-instance.html">JET_INSTANCE</a><br />
<a href="./jetopenfile-function.html">JetOpenFile</a><br />
<a href="./jetstopservice-function.html">JetStopService</a><br />
<a href="./extensible-storage-engine-system-parameters.html">System Parameters</a></p>
</body>
