<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetCreateIndex2 Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetCreateIndex2 Function&quot;
title: JetCreateIndex2 Function
TOCTitle: JetCreateIndex2 Function
ms:assetid: 8810eaed-40cb-4561-aafc-9a9bbdb0d05b
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg269324(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg269324(v=EXCHG.10)</a>
ms:contentKeyID: 32765614
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetCreateIndex2W</li>
<li>JetCreateIndex2A</li>
<li>JetCreateIndex2
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>DLLExport</li>
<li>COM
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetCreateIndex2 Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetCreateIndex2 Function</h2>
<p>The <strong>JetCreateIndex2</strong> function creates indexes over data in an ESE database, which can be used to locate specific data quickly.</p>
<pre lang="cpp"><code>    JET_ERR JET_API JetCreateIndex2(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in          JET_INDEXCREATE* pindexcreate,
      __in          unsigned long cIndexCreate
    );
</code></pre>
<h3>Parameters</h3>
<p><em>sesid</em></p>
<p>The database session context to use for the API call.</p>
<p><em>tableid</em></p>
<p>The table on which the index will be created.</p>
<p><em>pindexcreate</em></p>
<p>An array of <a href="./jet-indexcreate-structure.html">JET_INDEXCREATE</a> structures, each of which defines an index to be created.</p>
<p><em>cIndexCreate</em></p>
<p>The number of elements in the <em>pindexcreate</em> array.</p>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errCannotIndex<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An attempt was made to index over an escrow-update or SLV column (note that SLV columns are deprecated).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errColumnNotFound<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An attempt was made to index over a non-existent column. Attempting to conditionally index over a non-existent column can also produce this error.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errDensityInvalid<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->This error will be returned if the <!-- raw HTML omitted -->ulDensity<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure is set to a number less than 20 or more than 100.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexDuplicate<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An attempt to define two identical indexes was made.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexHasPrimary<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An attempt was made to specify more than one primary index for a table. A table must have exactly one primary index. If no primary index is specified, the database engine will transparently create one.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexInvalidDef<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An invalid index definition was specified. Some of the possible reasons for receiving this error are:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->A primary index is conditional (<!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member of <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> has JET_bitIndexPrimary set, and the <!-- raw HTML omitted -->cConditionalColumn<!-- raw HTML omitted --> member of <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> is greater than zero).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Windows ServerÂ 2003 and later. Attempting to create a tuple index with tuple limits, but without passing information in the <!-- raw HTML omitted -->ptuplelimits<!-- raw HTML omitted --> member in <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> (that is, <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> has JET_bitIndexTupleLimits set, but the <!-- raw HTML omitted -->ptuplelimits<!-- raw HTML omitted --> pointer is NULL).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Passing in an invalid key definition in the <!-- raw HTML omitted -->szKey<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure. See <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> for a discussion of valid definitions.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Setting the <!-- raw HTML omitted -->cbVarSegMac<!-- raw HTML omitted --> member in <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> to be greater than JET_cbPrimaryKeyMost (for a primary index) or greater than JET_cbSecondaryKeyMost (for a secondary index).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Passing an invalid combination for a user-defined Unicode index (one which has the JET_bitIndexUnicode bit set in the <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member of <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted -->). Some common causes may be that the pidxunicode field of the <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure is NULL, or the LCID specified in the pidxunicode structure is invalid.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Specifying a multi-valued column for a primary index.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Trying to index too many conditional columns. The <!-- raw HTML omitted -->cConditionalColumn<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure must not be greater than JET_ccolKeyMost.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesInvalidLimits<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->WindowsÂ XP and later. A <!-- raw HTML omitted -->JET_TUPLELIMITS<!-- raw HTML omitted --> structure was specified, and its limits are not supported. See the remarks section of the <!-- raw HTML omitted -->JET_TUPLELIMITS<!-- raw HTML omitted --> structure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesNonUniqueOnly<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->WindowsÂ XP and later. A tuple index cannot be unique (<!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> must not have both JET_bitIndexTuples and JET_bitIndexUnique set).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesOneColumnOnly<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->WindowsÂ XP and later. A tuple index can only be over a single column (that is, the <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure has JET_bitIndexTuples set, and the <!-- raw HTML omitted -->szKey<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure specifies more than one column).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesSecondaryIndexOnly<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->WindowsÂ XP and later. A tuple index cannot be a primary index (that is, the <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure must not have both JET_bitIndexPrimary and JET_bitIndexTuples set).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesTextColumnsOnly<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->WindowsÂ XP and later. A tuple index can only be on a text or Unicode column. An attempt to index other columns (for example, binary columns) will result in JET_errIndexTuplesTextColumnsOnly.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesVarSegMacNotAllowed<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->WindowsÂ XP and later. A tuple index does not allow the <!-- raw HTML omitted -->cbVarSegMac<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure to be set.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInTransaction<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An attempt was made to create an index without version information while in a transaction.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidgrbit<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The index definition is invalid because the <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure contains inconsistent values. Some possible reasons are:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->A primary index had an ignore bit specified (JET_bitIndexPrimary was passed with one of JET_bitIndexIgnoreNull, JET_bitIndexIgnoreAnyNull, or JET_bitIndexIgnoreFirstNull).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->An empty index does not ignore any NULL fields (that is, <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure has JET_bitIndexEmpty set, but does not have JET_bitIndexIgnoreAnyNull set).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Passing in a <!-- raw HTML omitted -->JET_CONDITIONALCOLUMN<!-- raw HTML omitted --> structure with an invalid <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member. See <!-- raw HTML omitted -->JET_CONDITIONALCOLUMN<!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->When creating several indexes at once (that is, if the <!-- raw HTML omitted -->cIndexCreate<!-- raw HTML omitted --> parameter is greater than one), none of the indexes may contain any of the following bits:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->JET_bitIndexPrimary<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->JET_bitIndexUnversioned<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->JET_bitIndexEmpty<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidLanguageId<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An invalid Locale ID (LCID) was passed in (either through the <!-- raw HTML omitted -->lcid<!-- raw HTML omitted --> member in the <!-- raw HTML omitted -->JET_UNICODEINDEX<!-- raw HTML omitted --> structure, which the <!-- raw HTML omitted -->pidxunicode<!-- raw HTML omitted --> member in the <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure contains a pointer to, or through the <!-- raw HTML omitted -->lcid<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidName<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An invalid index name was specified. See <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> for more details.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidParameter<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An invalid parameter was passed into the API. Some of the reasons this error may be returned are:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The <!-- raw HTML omitted -->cbKey<!-- raw HTML omitted --> field of a <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure is set to zero.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The <!-- raw HTML omitted -->cbStruct<!-- raw HTML omitted --> member of a <!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> structure is not set to sizeof(<!-- raw HTML omitted -->JET_INDEXCREATE<!-- raw HTML omitted --> ).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errUnicodeTranslationFail<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An error occurred attempting to normalize a Unicode column. This can be caused by running out of system resources.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>Remarks</h4>
<p>The return value is JET_errSuccess on successful completion of all indexes specified.</p>
<p><strong>JetCreateIndex2</strong> iterates through the indexes given in <strong>pindexcreate</strong>, and will sometimes abort on the first failure. Any indexes after the first index with an error may not have been attempted, even though the <strong>err</strong> member of the <a href="./jet-indexcreate-structure.html">JET_INDEXCREATE</a> structure contains JET_errSuccess.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista, WindowsÂ XP, or WindowsÂ 2000 Professional.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008, Windows ServerÂ 2003, or WindowsÂ 2000 Server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Unicode<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Implemented as <!-- raw HTML omitted -->JetCreateIndex2W<!-- raw HTML omitted --> (Unicode) and <!-- raw HTML omitted -->JetCreateIndex2A<!-- raw HTML omitted --> (ANSI).<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./jet-conditionalcolumn-structure.html">JET_CONDITIONALCOLUMN</a><br />
<a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-grbit.html">JET_GRBIT</a><br />
<a href="./jet-sesid.html">JET_SESID</a><br />
<a href="./jet-tableid.html">JET_TABLEID</a><br />
<a href="./jet-indexcreate-structure.html">JET_INDEXCREATE</a><br />
<a href="./jetcreateindex-function.html">JetCreateIndex</a><br />
<a href="./jetcreatetablecolumnindex-function.html">JetCreateTableColumnIndex</a><br />
<a href="./jetcreatetablecolumnindex2-function.html">JetCreateTableColumnIndex2</a></p>
</body>
