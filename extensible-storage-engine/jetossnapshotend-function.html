<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetOSSnapshotEnd Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetOSSnapshotEnd Function&quot;
title: JetOSSnapshotEnd Function
TOCTitle: JetOSSnapshotEnd Function
ms:assetid: f7f4db8b-8e40-48d7-bc7b-0c80d0d0f77f
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg294136(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg294136(v=EXCHG.10)</a>
ms:contentKeyID: 32765750
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetOSSnapshotEnd
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>COM</li>
<li>DLLExport
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetOSSnapshotEnd Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetOSSnapshotEnd Function</h2>
<p>The <strong>JetOSSnapshotEnd</strong> function notifies the engine that the snapshot session finished.</p>
<p>**WindowsÂ Vista:**Â Â <strong>JetOSSnapshotEnd</strong> is introduced in WindowsÂ Vista:.</p>
<pre lang="cpp"><code>    JET_ERR JET_API JetOSSnapshotEnd(
      __in          const JET_OSSNAPID snapId,
      __in          const JET_GRBIT grbit
    );
</code></pre>
<h3>Parameters</h3>
<p><em>snapId</em></p>
<p>The identifier of the snapshot session.</p>
<p><em>grbit</em></p>
<p>The options for this call. This parameter can have a combination of the following values.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Value<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Meaning<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->0<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The successful end of the snapshot session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitAbortSnapshot<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The snapshot session aborted.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidGrbit<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->One of the options requested is invalid, used incorrectly, or not implemented.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errOSSnapshotInvalidSequence<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->A snapshot session is already in progress. This is not allowed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errOSSnapshotInvalidSnapId<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The identifier for the snapshot session is not valid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errOSSnapshotTimeOut<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The snapshot session had an internal timeout before this call occurred. As a result, the IO operations returned to normal before this call was made.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>If this function succeeds, a snapshot session will complete and the normal engine behavior will resume. A new snapshot session can be started later.</p>
<p>If this function fails, the JET_errOSSnapshotTimeOut return code returns and the current snapshot session ends but the freeze of IOs during the snapshot period was not respected internally. For all other errors, the snapshot session state will not be changed.</p>
<h4>Remarks</h4>
<p>This function is called only if <a href="./jetossnapshotthaw-function.html">JetOSSnapshotThaw</a> was called with JET_bitContinueAfterThaw.</p>
<p>The snapshot session must complete for the snapshot verification and log truncation to take place. Event log entries will be generated for the different steps of the snapshot.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./error-handling-parameters.html">Error Handling Parameters</a><br />
<a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a><br />
<a href="./jet-err.html">JET_ERR</a><br />
<a href="./jetossnapshotthaw-function.html">JetOSSnapshotThaw</a></p>
</body>
