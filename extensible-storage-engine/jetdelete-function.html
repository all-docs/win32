<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetDelete Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetDelete Function&quot;
title: JetDelete Function
TOCTitle: JetDelete Function
ms:assetid: 807de5ba-2f4b-4779-ab29-a1f094beecc1
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg269315(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg269315(v=EXCHG.10)</a>
ms:contentKeyID: 32765605
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetDelete
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>COM</li>
<li>DLLExport
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetDelete Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetDelete Function</h2>
<p>The <strong>JetDelete</strong> function deletes the current record in a database table.</p>
<pre lang="cpp"><code>    JET_ERR JET_API JetDelete(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid
    );
</code></pre>
<h3>Parameters</h3>
<p><em>sesid</em></p>
<p>The database session context that will be used for the API call.</p>
<p><em>tableid</em></p>
<p>The cursor on a database table. The current row will be deleted.</p>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errCallbackFailed<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The callback function failed in some manner. For example, access violations in callback functions are caught and translated into JET_errCallbackFailed. This error will only be returned by WindowsÂ XP and later.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errClientRequestToStopJetService<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because all activity on the instance associated with the session has ceased as a result of a call to <!-- raw HTML omitted -->JetStopService<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIllegalOperation<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The cursor specified by <!-- raw HTML omitted -->tableid<!-- raw HTML omitted --> does not support deletion. See the Remarks section.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInstanceUnavailable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has encountered a fatal error that requires that access to all data be revoked to protect the integrity of that data. This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNoCurrentRecord<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The cursor specified by <!-- raw HTML omitted -->tableid<!-- raw HTML omitted --> is not on a record.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNotInitialized<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has not been initialized yet.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRestoreInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because a restore operation is in progress on the instance associated with the session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errPermissionDenied<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The database engine does not have sufficient permissions to delete the record. This may happen if the database file was opened with read-only access.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRollbackError<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An update buffer (see <!-- raw HTML omitted -->JetPrepareUpdate<!-- raw HTML omitted -->) exists, but not all of the changes made to columns of type JET_coltypLongText and/or columns of type JET_coltypLongBinary could be rolled back.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errSessionSharingViolation<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is illegal to use the same session from more than one thread at the same time. This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTermInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session is being shut down.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTransReadOnly<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The transaction is a read-only transaction, and does not support deletes.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errVersionStoreOutOfMemory<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation failed because there is not enough memory to retain transactional information about the update.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errWriteConflict<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Another session has previously locked the record for update. The update attempted by this session will fail.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>On success, the currency is left just before the next record. If the deleted record was the last in the table, the currency is left at the end of the table (that is, after the new last record). If the deleted record was the only record in the table, the currency is set to the beginning.</p>
<p>The appropriate indexes are automatically updated.</p>
<p>If an update is prepared (using <a href="./jetprepareupdate-function.html">JetPrepareUpdate</a>), it will be canceled. The update buffer will be reset.</p>
<p>On failure, the currency remains unchanged. If an update is prepared (see <a href="./jetprepareupdate-function.html">JetPrepareUpdate</a>), the update buffer may be reset.</p>
<h4>Remarks</h4>
<p>Not all tables support deletion of rows. A temporary table does not normally support deletion of rows. Deletion of records may be enabled on temporary tables for many reasons, some of which are:</p>
<ul>
<li>
<p>JET_bitTTUpdatable was specified during creation.</p>
</li>
<li>
<p>Large temporary tables can support deletion if they were created with JET_bitTTScrollable or JET_bitTTIndexed. The threshold at which a temporary table becomes &quot;large&quot; is currently 64 kilobytes, but it may be changed in future releases.</p>
</li>
</ul>
<p>WindowsÂ XP and later. Callback functions can be invoked by <strong>JetDelete</strong>, including JET_cbtypBeforeDelete and JET_cbtypAfterDelete.</p>
<p>It is important to understand the impact of performing a large number of update operations inside of a single transaction. Each update to the database must be tracked by the database engine in the version store. The version store holds a live record of all the different versions of each record or index entry in the database that can be seen by all active transactions. These versions are used to support the multi-versioned concurrency control in use by the database engine to support transactions using snapshot isolation. Once the database engine has exhausted the resources used to store these versions then it can no longer accept further changes until some transactions have concluded to allow these resources to be reclaimed. When the engine is in this state, all updates will fail with JET_errVersionStoreOutOfMemory. The resources available to the database engine to store these versions can be controlled using <a href="./jetsetsystemparameter-function.html">JetSetSystemParameter</a> with <em>JET_paramMaxVerPages</em> and <em>JET_paramGlobalMinVerPages</em>.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista, WindowsÂ XP or Windows 2000 Professional.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008, Windows ServerÂ 2003, or Windows 2000 Server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-sesid.html">JET_SESID</a><br />
<a href="./jet-tableid.html">JET_TABLEID</a><br />
<a href="./jetopentemptable-function.html">JetOpenTempTable</a><br />
<a href="./jetprepareupdate-function.html">JetPrepareUpdate</a><br />
<a href="./extensible-storage-engine-system-parameters.html">System Parameters</a></p>
</body>
