<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetStopBackup Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetStopBackup Function&quot;
title: JetStopBackup Function
TOCTitle: JetStopBackup Function
ms:assetid: b7545284-2fdb-4470-8466-fc2109ad63c5
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg294067(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg294067(v=EXCHG.10)</a>
ms:contentKeyID: 32765682
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetStopBackup
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>COM</li>
<li>DLLExport
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetStopBackup Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetStopBackup Function</h2>
<p>The <strong>JetStopBackup</strong> function prevents any streaming backup-related activity from continuing on a specific running instance, thus ending the streaming backup in a predictable way.</p>
<p>**WindowsÂ XP:**Â Â This function is introduced in WindowsÂ XP.</p>
<p><a href="./jetstopservice-function.html">JetStopService</a> is the legacy call when only one instance is allowed. In this case, the only active instance is the one being prepared for termination.</p>
<pre lang="cpp"><code>JET_ERR JET_API JetStopBackup(void);
</code></pre>
<h3>Parameters</h3>
<p>This function has no parameters.</p>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRunningInMultiInstanceMode<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not clear which instance to prepare for termination when using <!-- raw HTML omitted -->JetStopService<!-- raw HTML omitted --> with multiple instance mode.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WindowsÂ XP:<!-- raw HTML omitted -->Â Â This return value is introduced in WindowsÂ XP.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>If this function succeeds, the instance will start failing any new streaming backup APIs.</p>
<p>If this function fails, no steps to prepare for the backup termination on the instance will be taken and no change to the instance state will occur.</p>
<h4>Remarks</h4>
<p>Backup is usually triggered by an event outside the process mechanism and by using this API, the ESENT application itself will make any further calls to the streaming backup APIs to fail. The majority of streaming backup APIs will start failing with JET_errBackupAbortByServer. As such, any streaming backup progress (like <a href="./jetreadfileinstance-function.html">JetReadFileInstance</a>) will return an error. Backup operations which are part of the backup termination (such as <a href="./jetendexternalbackupinstance-function.html">JetEndExternalBackupInstance</a>) will still be allowed.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista, WindowsÂ XP, or WindowsÂ 2000 Professional.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008, Windows ServerÂ 2003, or WindowsÂ 2000 Server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./jetendexternalbackupinstance-function.html">JetEndExternalBackupInstance</a><br />
<a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-instance.html">JET_INSTANCE</a><br />
<a href="./jetreadfileinstance-function.html">JetReadFileInstance</a><br />
<a href="./jetstopservice-function.html">JetStopService</a></p>
</body>
