<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetOSSnapshotAbort Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetOSSnapshotAbort Function&quot;
title: JetOSSnapshotAbort Function
TOCTitle: JetOSSnapshotAbort Function
ms:assetid: 629455af-b526-4366-9b9a-112757f72c32
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg269265(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg269265(v=EXCHG.10)</a>
ms:contentKeyID: 32765567
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetOSSnapshotAbort
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>COM</li>
<li>DLLExport
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetOSSnapshotAbort Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetOSSnapshotAbort Function</h2>
<p>The <strong>JetOSSnapshotAbort</strong> function notifies the engine that it can resume normal IO operations after a freeze period ended with a failed snapshot.</p>
<p>**Windows ServerÂ 2003:**Â Â <strong>JetOSSnapshotAbort</strong> is introduced in Windows ServerÂ 2003.</p>
<pre lang="cpp"><code>    JET_ERR JET_API JetOSSnapshotAbort(
      __in          const JET_OSSNAPID snapId,
      __in          const JET_GRBIT grbit
    );
</code></pre>
<h3>Parameters</h3>
<p><em>snapId</em></p>
<p>The identifier of the snapshot session.</p>
<p><em>grbit</em></p>
<p>The options for this call. This parameter is reserved for future use and the only valid value supported is 0 (zero).</p>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidParameter<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The snapshot session is invalid or the grbit parameter is invalid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errOSSnapshotInvalidSnapId<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The identifier for the snapshot session is not valid.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>If this function succeeds, the snapshot session will end and the normal engine behavior will resume. A new snapshot session can be started at a later point.</p>
<p>If this function fails, the snapshot session will not be aborted.</p>
<h4>Remarks</h4>
<p>This function should be called instead of <a href="./jetossnapshotthaw-function.html">JetOSSnapshotThaw</a> to inform the engine that the snapshot was aborted for reasons that don't relate to the engine. This information can be used later to help issue event log messages about the snapshot session or to help determine other appropriate actions.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008 or Windows ServerÂ 2003.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-ossnapid.html">JET_OSSNAPID</a><br />
<a href="./jetossnapshotfreeze-function.html">JetOSSnapshotFreeze</a><br />
<a href="./jetossnapshotprepare-function.html">JetOSSnapshotPrepare</a><br />
<a href="./jetossnapshotthaw-function.html">JetOSSnapshotThaw</a></p>
</body>
