<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetRetrieveColumns Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetRetrieveColumns Function&quot;
title: JetRetrieveColumns Function
TOCTitle: JetRetrieveColumns Function
ms:assetid: f7158fe8-ba4b-420c-9d45-185791a5759b
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg294135(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg294135(v=EXCHG.10)</a>
ms:contentKeyID: 32765749
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetRetrieveColumns
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>COM</li>
<li>DLLExport
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetRetrieveColumns Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetRetrieveColumns Function</h2>
<p>The <strong>JetRetrieveColumns</strong> function retrieves multiple column values from the current record in a single operation. An array of <a href="./jet-retrievecolumn-structure.html">JET_RETRIEVECOLUMN</a> structures is used to describe the set of column values to be retrieved, and to describe output buffers for each column value to be retrieved.</p>
<pre lang="cpp"><code>    JET_ERR JET_API JetRetrieveColumns(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in_out_opt  JET_RETRIEVECOLUMN* pretrievecolumn,
      __in          unsigned long cretrievecolumn
    );
</code></pre>
<h3>Parameters</h3>
<p><em>sesid</em></p>
<p>The session to use for this call.</p>
<p><em>tableid</em></p>
<p>The cursor to use for this call.</p>
<p><em>pretrievecolumn</em></p>
<p>A pointer to an array of one or more <a href="./jet-retrievecolumn-structure.html">JET_RETRIEVECOLUMN</a> structures. Each structure includes descriptions of which column value to retrieve and where to store returned data.</p>
<p><em>cretrievecolumn</em></p>
<p>The number of <a href="./jet-retrievecolumn-structure.html">JET_RETRIEVECOLUMN</a> structures in the array given by <em>pretrievecolumn</em>.</p>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errBadItagSequence<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An invalid multi-valued column sequence number value has been passed in pretinfo-&gt;itagSequence. Valid values for the multi-valued column value sequence numbers are 1 or greater. A value of 0 (zero) is valid for this function but is invalid for <!-- raw HTML omitted -->JetRetrieveColumn<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errBadColumnId<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column ID given is outside the legal limits of a column ID.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errClientRequestToStopJetService<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because all activity on the instance associated with the session has ceased as a result of a call to <!-- raw HTML omitted -->JetStopService<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errColumnNotFound<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column described by the given <!-- raw HTML omitted -->columnid<!-- raw HTML omitted --> does not exist in the table.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesCannotRetrieveFromIndex<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Columns indexed as substrings cannot be retrieved from the index, since only a small portion of the column is typically present in each index entry.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidBufferSize<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->In some cases, the buffer given for the retrieve column must be sufficiently sized in order to return any amount of the column value. For example, escrow updatable columns are adjusted to be consistent for the transactional context of the calling session and this adjustment requires the buffer provided by the caller. If insufficient buffer space is supplied, then JET_errInvalidBufferSize is returned and no column data whatsoever is returned.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidgrbit<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The options supplied are unknown or an illegal combination of known bit settings.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidParameter<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->One or more of the parameters given is incorrect. This can happen if the retinfo.cbStruct is smaller that the size of <!-- raw HTML omitted -->JET_RETINFO<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInstanceUnavailable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has encountered a fatal error that requires that access to all data be revoked to protect the integrity of that data.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WindowsÂ XP:<!-- raw HTML omitted -->Â Â This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNoCurrentRecord<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The cursor is not positioned on a record. This can happen for many different reasons. For example, this will happen if the cursor is currently positioned after the last record on the current index.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNotInitialized<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has not been initialized yet.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRestoreInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because a restore operation is in progress on the instance associated with the session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errSessionSharingViolation<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The same session cannot be used for more than one thread at the same time.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WindowsÂ XP:<!-- raw HTML omitted -->Â Â This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTermInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session is being shut down.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_wrnBufferTruncated<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The entire column value could not be retrieved because the given buffer is smaller than the size of the column.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>On success, columns data and column size are returned in provided buffers described in array of <a href="./jet-retrievecolumn-structure.html">JET_RETRIEVECOLUMN</a> structures. If an <em>itagSequence</em> was set to 0 (zero) to indicate that the number of instances of a multi-valued field was desired instead of column data, then the number of instances of a multi-valued column is returned in the <em>itagSequence</em> field itself. Each <a href="./jet-retrievecolumn-structure.html">JET_RETRIEVECOLUMN</a> structure has an error field that contains warnings for the column retrieved. If the column was <strong>NULL</strong> valued, then the error code will be set to JET_wrnColumnNull.</p>
<p>On failure, the cursor location is left unchanged and no data is copied into the provided buffer.</p>
<h4>Remarks</h4>
<p><strong>JetRetrieveColumns</strong> supports one feature that <a href="./jetretrievecolumn-function.html">JetRetrieveColumn</a> does not. This is the ability to retrieve the number of instances of a multi-valued column. The purpose of this feature is to allow an application to retrieve all values of a column. This can be done by first determining the number of values that a column has. Next, their lengths can be determined by calling <strong>JetRetrieveColumns</strong> again with one <a href="./jet-retrievecolumn-structure.html">JET_RETRIEVECOLUMN</a> structure allocated for each value to determine the length of column data. This can be done by passing <strong>NULL</strong><em>pvData</em> pointers with <em>cbMax</em> of 0 (zero) and retrieving the column length in <em>cbActual</em>. The third and last call can be made with allocated memory for the column value data.</p>
<p>If any column retrieved is truncated due to an insufficient length buffer, then the API will return JET_wrnBufferTruncated. However, other errors, JET_wrnColumnNull are returned only in the error field in <a href="./jet-retrievecolumn-structure.html">JET_RETRIEVECOLUMN</a>. The reason for this is that applications often want to ensure that all data has been retrieved and returning this error from <strong>JetRetrieveColumns</strong> facilitates this understanding.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista, WindowsÂ XP, or WindowsÂ 2000 Professional.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008, Windows ServerÂ 2003, or WindowsÂ 2000 Server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-sesid.html">JET_SESID</a><br />
<a href="./jet-tableid.html">JET_TABLEID</a><br />
<a href="./jet-retrievecolumn-structure.html">JET_RETRIEVECOLUMN</a><br />
<a href="./jetenumeratecolumns-function.html">JetEnumerateColumns</a><br />
<a href="./jetretrievecolumn-function.html">JetRetrieveColumn</a><br />
<a href="./jetsetcolumns-function.html">JetSetColumns</a></p>
</body>
