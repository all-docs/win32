<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetDupCursor Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetDupCursor Function&quot;
title: JetDupCursor Function
TOCTitle: JetDupCursor Function
ms:assetid: 154b7d2d-4656-46b3-873c-2e194a9059b4
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg269193(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg269193(v=EXCHG.10)</a>
ms:contentKeyID: 32765496
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetDupCursor
topic_type:</li>
<li>kbArticle</li>
<li>apiref
api_type:</li>
<li>DLLExport</li>
<li>COM
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetDupCursor Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetDupCursor Function</h2>
<p>The <strong>JetDupCursor</strong> function duplicates an open cursor and returns a handle to the duplicated cursor. If the cursor that was duplicated was a read-only cursor then the duplicated cursor is also a read-only cursor. Any state related to constructing a search key or updating a record is not copied into the duplicated cursor. In addition, the location of the original cursor is not duplicated into the duplicated cursor. The duplicated cursor is always opened on the clustered index and its location is always on the first row of the table.</p>
<pre lang="cpp"><code>    JET_ERR JET_API JetDupCursor(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __out         JET_TABLEID* ptableid,
      __in          JET_GRBIT grbit
    );
</code></pre>
<h3>Parameters</h3>
<p><em>sesid</em></p>
<p>The session to use for this call.</p>
<p><em>tableid</em></p>
<p>The cursor to use for this call.</p>
<p><em>ptableid</em></p>
<p>Pointer to <em>tableid</em>.</p>
<p><em>grbit</em></p>
<p>Reserved for future use.</p>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errClientRequestToStopJetService<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because all activity on the instance associated with the session has ceased as a result of a call to <!-- raw HTML omitted -->JetStopService<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInstanceUnavailable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has encountered a fatal error that requires that access to all data be revoked to protect the integrity of that data. This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNotInitialized<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has not been initialized yet.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errOutOfCursors<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->No available cursor resources exist.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRestoreInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because a restore operation is in progress on the instance associated with the session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errSessionSharingViolation<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The same session cannot be used for more than one thread at the same time. This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTermInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session is being shut down.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>On success, <em>ptableid</em> is set to a duplicated cursor.</p>
<p>On failure, no changes are made. The state of <em>tableid</em> is unchanged.</p>
<h4>Remarks</h4>
<p>The duplicated cursor does not have the entire cursor state copied. The location of the duplicated cursor, including the current index, is usually different from the given cursor. The duplicated cursor is always returned on the clustered index and on the first row in the table. If the table is empty, the duplicated cursor is not on any row.</p>
<p>Tables opened with <strong>JetDupCursor</strong> should usually be closed with <a href="./jetclosetable-function.html">JetCloseTable</a>. The exception to this rule happens when <strong>JetDupCursor</strong> is called in a transaction and the transaction is rolled back (with <a href="./jetrollback-function.html">JetRollback</a>). When rolling back a transaction, the cursor is automatically closed. In this case, it is an error to close the table with <a href="./jetclosetable-function.html">JetCloseTable</a>.</p>
<p>The number of tables that can be opened simultaneously is affected directly by <a href="./resource-parameters.html">JET_paramMaxOpenTables</a>. See <a href="./extensible-storage-engine-system-parameters.html">System Parameters</a> for details.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista, WindowsÂ XP, or WindowsÂ 2000 Professional.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008, Windows ServerÂ 2003, or WindowsÂ 2000 Server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./jet-grbit.html">JET_GRBIT</a><br />
<a href="./jet-sesid.html">JET_SESID</a><br />
<a href="./jet-tableid.html">JET_TABLEID</a><br />
<a href="./jetclosetable-function.html">JetCloseTable</a><br />
<a href="./jetrollback-function.html">JetRollback</a><br />
<a href="./jetstopservice-function.html">JetStopService</a><br />
<a href="./extensible-storage-engine-system-parameters.html">System Parameters</a></p>
</body>
