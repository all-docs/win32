<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetIntersectIndexes Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetIntersectIndexes Function&quot;
title: JetIntersectIndexes Function
TOCTitle: JetIntersectIndexes Function
ms:assetid: 6e111d10-6882-46ac-a70b-7896662d3b5d
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg269289(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg269289(v=EXCHG.10)</a>
ms:contentKeyID: 32765581
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetIntersectIndexes
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>COM</li>
<li>DLLExport
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetIntersectIndexes Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetIntersectIndexes Function</h2>
<p>The <strong>JetIntersectIndexes</strong> function computes the intersection between multiple sets of index entries from different secondary indices over the same table. This operation is useful for finding the set of records in a table that match two or more criteria that can be expressed using index ranges.</p>
<pre lang="cpp"><code>    JET_ERR JET_API JetIntersectIndexes(
      __in          JET_SESID sesid,
      __in          JET_INDEXRANGE* rgindexrange,
      __in          unsigned long cindexrange,
      __in_out      JET_RECORDLIST* precordlist,
      __in          JET_GRBIT grbit
    );
</code></pre>
<h3>Parameters</h3>
<p><em>sesid</em></p>
<p>The session to use for this call.</p>
<p><em>rgindexrange</em></p>
<p>A pointer to an array of <a href="./jet-indexrange-structure.html">JET_IndexRange</a> structures. Each structure includes a <a href="./jet-tableid.html">JET_TABLEID</a> that has been set up to hold one of the index ranges to be intersected. For more information, see <a href="./jet-indexrange-structure.html">JET_IndexRange</a>.</p>
<p><em>cindexrange</em></p>
<p>The number of <a href="./jet-indexrange-structure.html">JET_IndexRange</a> structures in the array that is contained in the <em>rgindexrange</em> parameter.</p>
<p><em>precordlist</em></p>
<p>Pointer to a <a href="./jet-recordlist-structure.html">JET_RECORDLIST</a> structure. This structure will be populated with enough information to traverse the temporary table with the results from <strong>JetIntersectIndexes</strong>.</p>
<p>The output buffer that receives a <a href="./jet-recordlist-structure.html">JET_RECORDLIST</a> structure. The structure contains a description of the result set of the intersection.</p>
<p><em>grbit</em></p>
<p>Reserved for future use.</p>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errClientRequestToStopJetService<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because all activity on the instance associated with the session has ceased as a result of a call to <!-- raw HTML omitted -->JetStopService<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInstanceUnavailable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has encountered a fatal error that requires that access to all data be revoked to protect the integrity of that data.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WindowsÂ XP:<!-- raw HTML omitted -->Â Â This return value is introduced in WindowsÂ XP.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidgrbit<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->One of the options requested was invalid, used incorrectly, or not implemented.<!-- raw HTML omitted --><!-- raw HTML omitted -->This error is returned by <!-- raw HTML omitted -->JetIntersectIndexes<!-- raw HTML omitted --> when:<!-- raw HTML omitted --><!-- raw HTML omitted -->The <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> contained in the <!-- raw HTML omitted -->JET_IndexRange<!-- raw HTML omitted --> structure pointed to by any element in the <!-- raw HTML omitted -->rgindexrange<!-- raw HTML omitted --> array is not equal to JET_bitRecordInIndex.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidParameter<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->One of the parameters provided contains an unexpected value or a value that is inconsistent when combined with the value of another parameter.<!-- raw HTML omitted --><!-- raw HTML omitted -->This error is returned by <!-- raw HTML omitted -->JetIntersectIndexes<!-- raw HTML omitted --> for of the following reasons:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The <!-- raw HTML omitted -->precordlist<!-- raw HTML omitted --> parameter is NULL.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The <!-- raw HTML omitted -->cbStruct<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_RECORDLIST<!-- raw HTML omitted --> structure specified in the <!-- raw HTML omitted -->precordlist<!-- raw HTML omitted --> parameter is not equal to size of the <!-- raw HTML omitted -->JET_RECORDLIST<!-- raw HTML omitted --> structure.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The <!-- raw HTML omitted -->cindexrange<!-- raw HTML omitted --> parameter is zero.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The <!-- raw HTML omitted -->cindexrange<!-- raw HTML omitted --> parameter is greater than 64.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The <!-- raw HTML omitted -->cbStruct<!-- raw HTML omitted --> member for any element in the array specified by the <!-- raw HTML omitted -->rgindexrange<!-- raw HTML omitted --> parameter is not equal to the size of the <!-- raw HTML omitted -->JET_IndexRange<!-- raw HTML omitted --> structure.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The elements in the <!-- raw HTML omitted -->rgindexrange<!-- raw HTML omitted --> array contain <!-- raw HTML omitted -->JET_TABLEID<!-- raw HTML omitted -->s from different tables.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->An element in the <!-- raw HTML omitted -->rgindexrange<!-- raw HTML omitted --> array contains a <!-- raw HTML omitted -->JET_TABLEID<!-- raw HTML omitted --> that is not positioned on a secondary index.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->One or more of the elements in the <!-- raw HTML omitted -->rgindexrange<!-- raw HTML omitted --> array contain <!-- raw HTML omitted -->JET_TABLEID<!-- raw HTML omitted -->s positioned on the same secondary index.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidSesid<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The session handle is invalid or refers to a closed session.<!-- raw HTML omitted --><!-- raw HTML omitted -->This error is not returned under all circumstances. Handles are validated on a best effort basis only.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNotInitialized<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has not been initialized.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errOutOfCursors<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation failed because the engine could not allocate the resources required to open a new cursor. Cursor resources are configured by calling <!-- raw HTML omitted -->JetSetSystemParameter<!-- raw HTML omitted --> with <!-- raw HTML omitted -->JET_paramMaxCursors<!-- raw HTML omitted --> specified in the <!-- raw HTML omitted -->paramid<!-- raw HTML omitted --> parameter.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errOutOfMemory<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation failed because not enough memory could be allocated to complete it.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->JetIntersectIndexes<!-- raw HTML omitted --> can return JET_errOutOfMemory if the address space of the host process becomes too fragmented. The temporary table manager will always allocate a 1MB chunk of address space for every temporary table created regardless of the amount of data to be stored. <!-- raw HTML omitted -->JetIntersectIndexes<!-- raw HTML omitted --> will create one temporary table for each <!-- raw HTML omitted -->JET_IndexRange<!-- raw HTML omitted --> specified in the <!-- raw HTML omitted -->rgindexrange<!-- raw HTML omitted --> parameter, and one temporary table for the output in <!-- raw HTML omitted -->JET_RECORDLIST<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRestoreInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because a restore operation is in progress on the instance associated with the session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errSessionSharingViolation<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is illegal to use the same session from more than one thread at the same time.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WindowsÂ XP:<!-- raw HTML omitted -->Â Â This return value is introduced in WindowsÂ XP.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTermInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session is being shut down.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTooManyOpenIndexes<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation failed because the engine could not allocate the resources required to cache the indices of the table. The number of indices whose schema can be cached is configured using <!-- raw HTML omitted -->JetSetSystemParameter<!-- raw HTML omitted --> with <!-- raw HTML omitted -->JET_paramMaxOpenTables<!-- raw HTML omitted --> specified in the <!-- raw HTML omitted -->paramid<!-- raw HTML omitted --> parameter.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTooManyOpenTables<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation failed because the engine could not allocate the resources required to cache the schema of the table. The number of tables whose schema can be cached is configured using <!-- raw HTML omitted -->JetSetSystemParameter<!-- raw HTML omitted --> with <!-- raw HTML omitted -->JET_paramMaxOpenTables<!-- raw HTML omitted --> specified in the <!-- raw HTML omitted -->paramid<!-- raw HTML omitted --> parameter.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTooManySorts<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation failed because the engine could not allocate the resources required to create a temporary table. Temporary table resources are configured using <!-- raw HTML omitted -->JetSetSystemParameter<!-- raw HTML omitted --> with JET_paramMaxTemporaryTables specified in the <!-- raw HTML omitted -->paramid<!-- raw HTML omitted --> parameter.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>On success, a new temporary table is returned that contains the bookmarks of the records that match the criteria represented by each of the input index range descriptions.</p>
<p>On failure, the temporary table containing the results will not be created. The state of the temporary database may be changed. The state of any ordinary databases in use by the database engine will remain unchanged. The current position of the <a href="./jet-tableid.html">JET_TABLEID</a>s provided to this function may be changed.</p>
<h4>Remarks</h4>
<p><strong>JetIntersectIndexes</strong> can be used to efficiently filter the records in a table by multiple criteria if those criteria can be expressed in terms of the secondary indices over that table. For example, consider that you have a very large table containing people. The table can have columns for their user id, first name, last name, and so on. Suppose that each of these columns is indexed separately and that the primary index of the table is over user id. If you wanted to find everyone whose first name starts with an A and whose last name starts with G, you would perform the following steps:</p>
<ol>
<li>
<p>Open a new cursor on the table, and set that cursor to use the index over the &quot;first name&quot; column. Then setup an index range for all people whose &quot;first name&quot; started with 'A', and build a <a href="./jet-indexrange-structure.html">JET_IndexRange</a> struct that contains this cursor.</p>
</li>
<li>
<p>Repeat step 1 with a new cursor on the &quot;last name&quot; index for all people whose &quot;last name&quot; started with 'G'.</p>
</li>
<li>
<p>Pass these criteria to <strong>JetIntersectIndexes</strong> to compute the result into a temporary table.</p>
</li>
<li>
<p>Traverse the temporary table and retrieve each of the records that pass the criteria by bookmark.</p>
</li>
</ol>
<p>The temporary table containing the result set is a simple table with one column that contains the bookmark of each record that passed all the criteria used to compute the intersection. The result set is sorted in the same order as the primary index and contains no duplicate entries. The application can enumerate the results of the intersection by enumerating the rows in the temporary table, retrieving the bookmark for each result using <a href="./jetretrievecolumn-function.html">JetRetrieveColumn</a>, and then visiting the record in the database by calling <a href="./jetgotobookmark-function.html">JetGotoBookmark</a> with that bookmark on a cursor positioned on the primary index.</p>
<p>The temporary table returned by <strong>JetIntersectIndexes</strong> can only be scanned in a forward direction. It should also be closed via <a href="./jetclosetable-function.html">JetCloseTable</a> when the scan has been completed. For more information about temporary tables and how they work, see <a href="./jetopentemporarytable-function.html">JetOpenTemporaryTable</a>.</p>
<p><strong>JetIntersectIndexes</strong> is generally an efficient and convenient way to filter records based on multiple indexed criteria. However, there are some important tips that should be followed to maximize the usefulness of this feature. If you know that one of the criteria is so restrictive that the resulting index range has very few records then it is probably better to simply walk that index range and filter the records at the application level. Further, if you know that you have criteria that are much less restrictive than other criteria in your intersection then you might consider dropping those much less restrictive criteria from the intersection. Finally, if you know that one of the criteria is not at all restrictive such that the resulting index range is almost as large as the primary index then it is unlikely that intersecting with that index range will benefit (reduce the size of) the result set. In all cases, you should be selecting criteria in a manner that will take the fewest possible index entries on input and generate the most specific set of bookmarks on output for maximum performance.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista, WindowsÂ XP, or WindowsÂ 2000 Professional.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008, Windows ServerÂ 2003, or WindowsÂ 2000 Server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-grbit.html">JET_GRBIT</a><br />
<a href="./jet-sesid.html">JET_SESID</a><br />
<a href="./jet-tableid.html">JET_TABLEID</a><br />
<a href="./jet-indexrange-structure.html">JET_IndexRange</a><br />
<a href="./jet-recordlist-structure.html">JET_RECORDLIST</a><br />
<a href="./jetgotobookmark-function.html">JetGotoBookmark</a><br />
<a href="./jetretrievecolumn-function.html">JetRetrieveColumn</a><br />
<a href="./jetsetindexrange-function.html">JetSetIndexRange</a></p>
</body>
