<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetCreateIndex4W Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetCreateIndex4W Function&quot;
title: JetCreateIndex4W Function
TOCTitle: JetCreateIndex4W Function
ms:assetid: 968745a2-66ce-4c7f-ab5b-43282adc5313
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/JJ835044(v=EXCHG.10)">https://msdn.microsoft.com/library/JJ835044(v=EXCHG.10)</a>
ms:contentKeyID: 49894666
ms.date: 04/11/2016
ms.topic: reference
dev_langs:</p>
<ul>
<li>c++
api_name:</li>
<li>JetCreateIndex4W
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>DLLExport
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetCreateIndex4W Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<p>The <strong>JetCreateIndex4W</strong> function creates indexes over data in an Extensible Storage Engine (ESE) database, which can be used to locate specific data quickly.</p>
<p>The <strong>JetCreateIndex4W</strong> function was introduced in the WindowsÂ 8 operating system.</p>
<pre lang="c++"><code>JET_ERR JET_API JetCreateIndex4W(
  __in          JET_SESID sesid,
  __in          JET_TABLEID tableid,
  __in          JET_INDEXCREATE2* pindexcreate,
  __in          unsigned long cIndexCreate
);
</code></pre>
<h3>Parameters</h3>
<p><em>sesid</em></p>
<p>The database session context to use for the API call.</p>
<p><em>tableid</em></p>
<p>The table on which the index will be created.</p>
<p><em>pindexcreate</em></p>
<p>An array of <a href="./jet-indexcreate2-structure.html">JET_INDEXCREATE2</a> structures, each of which defines an index to be created.</p>
<p><em>cIndexCreate</em></p>
<p>The number of elements in the <em>pindexcreate</em> array.</p>
<h3>Return value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> data type with one of the return codes listed in the following table. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errCannotIndex<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An attempt was made to index over an escrow-update or SLV column (note that SLV columns are deprecated).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errColumnNotFound<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An attempt was made to index over a nonexistent column. An attempt to conditionally index over a nonexistent column can also produce this error.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errDensityInvalid<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->This error will be returned if the <!-- raw HTML omitted -->ulDensity<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure is set to a number less than 20 or greater than 100.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexDuplicate<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An attempt to define two identical indexes was made.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexHasPrimary<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An attempt was made to specify more than one primary index for a table. A table must have exactly one primary index. If no primary index is specified, the database engine will transparently create one.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexInvalidDef<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An invalid index definition was specified. The following are some possible reasons for this error:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->A primary index is conditional (<!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member of <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> has <!-- raw HTML omitted -->JET_bitIndexPrimary<!-- raw HTML omitted --> set, and the <!-- raw HTML omitted -->cConditionalColumn<!-- raw HTML omitted --> member of <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> is greater than zero).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Applies to versions of Windows starting with Windows ServerÂ 2003. An attempt was made to create a tuple index with tuple limits, but without passing information in the <!-- raw HTML omitted -->ptuplelimits<!-- raw HTML omitted --> member in <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> (that is, <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> has <!-- raw HTML omitted -->JET_bitIndexTupleLimits<!-- raw HTML omitted --> set, but the <!-- raw HTML omitted -->ptuplelimits<!-- raw HTML omitted --> pointer is null).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Passing in an invalid key definition in the <!-- raw HTML omitted -->szKey<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure. For information about valid definitions, see <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Setting the <!-- raw HTML omitted -->cbVarSegMac<!-- raw HTML omitted --> member in <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> to be greater than <!-- raw HTML omitted -->JET_cbPrimaryKeyMost<!-- raw HTML omitted --> (for a primary index) or greater than <!-- raw HTML omitted -->JET_cbSecondaryKeyMost<!-- raw HTML omitted --> (for a secondary index).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Passing an invalid combination for a user-defined Unicode index (one which has the <!-- raw HTML omitted -->JET_bitIndexUnicode<!-- raw HTML omitted --> bit set in the <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member of <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted -->). Some common causes may be that the pidxunicode field of the <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure is null, or the LCID specified in the pidxunicode structure is invalid.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Specifying a multivalued column for a primary index.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Trying to index too many conditional columns. The <!-- raw HTML omitted -->cConditionalColumn<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure must not be greater than <!-- raw HTML omitted -->JET_ccolKeyMost<!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesInvalidLimits<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Applies to versions of Windows starting with WindowsÂ XP. A <!-- raw HTML omitted -->JET_TUPLELIMITS<!-- raw HTML omitted --> structure was specified, and its limits are not supported. For more information, see the remarks section of the <!-- raw HTML omitted -->JET_TUPLELIMITS<!-- raw HTML omitted --> structure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesNonUniqueOnly<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Applies to versions of Windows starting with WindowsÂ XP. A tuple index cannot be unique (<!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> must not have both <!-- raw HTML omitted -->JET_bitIndexTuples<!-- raw HTML omitted --> and <!-- raw HTML omitted -->JET_bitIndexUnique<!-- raw HTML omitted --> set).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesOneColumnOnly<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Applies to versions of Windows starting with WindowsÂ XP. A tuple index can only be over a single column (that is, the <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure has <!-- raw HTML omitted -->JET_bitIndexTuples<!-- raw HTML omitted --> set, and the <!-- raw HTML omitted -->szKey<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure specifies more than one column).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesSecondaryIndexOnly<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Applies to versions of Windows starting with WindowsÂ XP. A tuple index cannot be a primary index (that is, the <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure must not have both <!-- raw HTML omitted -->JET_bitIndexPrimary<!-- raw HTML omitted --> and <!-- raw HTML omitted -->JET_bitIndexTuples<!-- raw HTML omitted --> set).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesTextColumnsOnly<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Applies to versions of Windows starting with WindowsÂ XP. A tuple index can only be on a text or Unicode column. An attempt to index other columns (for example, binary columns) will result in <!-- raw HTML omitted -->JET_errIndexTuplesTextColumnsOnly<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errIndexTuplesVarSegMacNotAllowed<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Applies to versions of Windows starting with WindowsÂ XP. A tuple index does not allow the <!-- raw HTML omitted -->cbVarSegMac<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure to be set.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInTransaction<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An attempt was made to create an index without version information while in a transaction.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidgrbit<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The index definition is invalid because the <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure contains inconsistent values. The following are some possible reasons:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->A primary index had an ignore bit specified (JET_bitIndexPrimary was passed with one of <!-- raw HTML omitted -->JET_bitIndexIgnoreNull<!-- raw HTML omitted -->, <!-- raw HTML omitted -->JET_bitIndexIgnoreAnyNull<!-- raw HTML omitted -->, or <!-- raw HTML omitted -->JET_bitIndexIgnoreFirstNull<!-- raw HTML omitted -->).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->An empty index does not ignore any null fields (that is, <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure has <!-- raw HTML omitted -->JET_bitIndexEmpty<!-- raw HTML omitted --> set, but does not have <!-- raw HTML omitted -->JET_bitIndexIgnoreAnyNull<!-- raw HTML omitted --> set).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Passing in a <!-- raw HTML omitted -->JET_CONDITIONALCOLUMN<!-- raw HTML omitted --> structure with an invalid <!-- raw HTML omitted -->grbit<!-- raw HTML omitted --> member. See <!-- raw HTML omitted -->JET_CONDITIONALCOLUMN<!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->When creating several indexes at once (that is, if the <!-- raw HTML omitted -->cIndexCreate<!-- raw HTML omitted --> parameter is greater than one), none of the indexes may contain any of the following bits:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->JET_bitIndexPrimary<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->JET_bitIndexUnversioned<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->JET_bitIndexEmpty<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidLanguageId<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An invalid Locale ID (LCID) was passed in (either through the <!-- raw HTML omitted -->lcid<!-- raw HTML omitted --> member in the <!-- raw HTML omitted -->JET_UNICODEINDEX<!-- raw HTML omitted --> structure, which the <!-- raw HTML omitted -->pidxunicode<!-- raw HTML omitted --> member in the <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure contains a pointer to, or through the <!-- raw HTML omitted -->lcid<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidName<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An invalid index name was specified. See <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> for more details.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidParameter<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An invalid parameter was passed into the API. The following are some reasons why this error may be returned:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The <!-- raw HTML omitted -->cbKey<!-- raw HTML omitted --> field of a <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure is set to zero.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The <!-- raw HTML omitted -->cbStruct<!-- raw HTML omitted --> member of a <!-- raw HTML omitted -->JET_INDEXCREATE2<!-- raw HTML omitted --> structure is not set to sizeof(JET_INDEXCREATE2).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errUnicodeTranslationFail<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An error occurred while trying to normalize a Unicode column. This can be caused by running out of system resources.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errSpaceHintsInvalid<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An element of the JET space hints structure was not correct or actionable.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>Remarks</h4>
<p>The <strong>JetCreateIndex4W</strong> function iterates through the indexes given in the <em>pindexcreate</em> parameter, and will sometimes abort on the first failure. Any indexes after the first index with an error may not have been attempted, even though the <strong>err</strong> member of the <a href="./jet-indexcreate2-structure.html">JET_INDEXCREATE2</a> structure contains JET_errSuccess.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows 8.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2012.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See also</h4>
<p><a href="./jet-conditionalcolumn-structure.html">JET_CONDITIONALCOLUMN</a><br />
<a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-grbit.html">JET_GRBIT</a><br />
<a href="./jet-sesid.html">JET_SESID</a><br />
<a href="./jet-tableid.html">JET_TABLEID</a><br />
<a href="./jet-indexcreate2-structure.html">JET_INDEXCREATE2</a><br />
<a href="./jetcreateindex-function.html">JetCreateIndex</a><br />
<a href="./jetcreatetablecolumnindex-function.html">JetCreateTableColumnIndex</a><br />
<a href="./jetcreatetablecolumnindex2-function.html">JetCreateTableColumnIndex2</a><br />
<a href="./jet-spacehints-structure.html">JET_SPACEHINTS</a></p>
</body>
