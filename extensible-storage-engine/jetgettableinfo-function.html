<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetGetTableInfo Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetGetTableInfo Function&quot;
title: JetGetTableInfo Function
TOCTitle: JetGetTableInfo Function
ms:assetid: 0602186c-b5c3-44b5-87df-482680442afd
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg269177(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg269177(v=EXCHG.10)</a>
ms:contentKeyID: 32765480
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetGetTableInfoW</li>
<li>JetGetTableInfo</li>
<li>JetGetTableInfoA
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>DLLExport</li>
<li>COM
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetGetTableInfo Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetGetTableInfo Function</h2>
<p>The <strong>JetGetTableInfo</strong> function retrieves various pieces of information about a table in a database.</p>
<pre lang="cpp"><code>    JET_ERR JET_API JetGetTableInfo(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __out         void* pvResult,
      __in          unsigned long cbMax,
      __in          unsigned long InfoLevel
    );
</code></pre>
<h3>Parameters</h3>
<p><em>sesid</em></p>
<p>The database session context to use for the API call.</p>
<p><em>tableid</em></p>
<p>The table that the information applies to.</p>
<p><em>pvResult</em></p>
<p>Pointer to a buffer that will receive the information. The type of the buffer is dependent on <em>InfoLevel</em>. It is the responsibility of the caller to align the buffer appropriately.</p>
<p><em>cbMax</em></p>
<p>The size, in bytes, of the buffer that was passed in <em>pvResult</em>.</p>
<p><em>InfoLevel</em></p>
<p>The type of information that will be retrieved for the table that is specified by <em>tableid</em>. The format of the data that is stored in <em>pvResult</em> is dependent on <em>InfoLevel</em>.</p>
<p>The following options can be set for this parameter:</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Value<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Meaning<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfo<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->pvResult<!-- raw HTML omitted --> is interpreted as a <!-- raw HTML omitted -->JET_OBJECTINFO<!-- raw HTML omitted --> structure. If the method succeeds, the <!-- raw HTML omitted -->JET_OBJECTINFO<!-- raw HTML omitted --> structure is filled in with the appropriate data. If it fails, the contents are undefined.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfoDbid<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->pvResult<!-- raw HTML omitted --> is treated as an array of two <!-- raw HTML omitted -->JET_DBID<!-- raw HTML omitted --> objects. The database identifier of the database that owns the table is stored in this array twice.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfoDumpTable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->JET_TblInfoDumpTable is deprecated. The API will return JET_errFeatureNotAvailable.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfoName<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->JET_TblInfoName retrieves the name of the table and stores it in <!-- raw HTML omitted -->pvResult<!-- raw HTML omitted -->. If the buffer is too small, the behavior is undefined.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfoMostMany<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->JET_TblInfoMostMany retrieves the name of the table and stores it in <!-- raw HTML omitted -->pvResult<!-- raw HTML omitted -->. If the buffer is too small, the behavior is undefined.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfoOLC<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->JET_TblInfoOLC is deprecated. The API will return JET_errFeatureNotAvailable.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfoRvt<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->JET_TblInfoRvt is deprecated. The API will return JET_errQueryNotSupported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfoResetOLC<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->JET_TblInfoResetOLC is deprecated. The API will return JET_errFeatureNotAvailable.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfoSpaceAlloc<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->pvResult<!-- raw HTML omitted --> is interpreted as an array of two ULONGs:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The first <!-- raw HTML omitted -->ULONG<!-- raw HTML omitted --> is the number of pages in the table.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The second <!-- raw HTML omitted -->ULONG<!-- raw HTML omitted --> is the target density of pages for the table.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfoSpaceAvailable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->pvResult<!-- raw HTML omitted --> is interpreted as a <!-- raw HTML omitted -->ULONG<!-- raw HTML omitted -->. The <!-- raw HTML omitted -->ULONG<!-- raw HTML omitted --> is the sum of the number of pages that are available in the table, its indexes, and the long value tree.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfoSpaceOwned<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->pvResult<!-- raw HTML omitted --> is interpreted as a <!-- raw HTML omitted -->ULONG<!-- raw HTML omitted -->. The <!-- raw HTML omitted -->ULONG<!-- raw HTML omitted --> is the sum of the number of pages that are owned by the table (including its indexes, and the long value tree and any available pages therein).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfoSpaceUsage<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The behavior of the API depends on how large the buffer that is passed to the API is. Two <!-- raw HTML omitted -->cbMax<!-- raw HTML omitted --> values must be at least ( 2 * sizeof( ULONG ) ).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->If <!-- raw HTML omitted -->cbMax<!-- raw HTML omitted --> is ( 2 * sizeof( ULONG ) ), <!-- raw HTML omitted -->pvResult<!-- raw HTML omitted --> is interpreted as an array of two ULONGs:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The first <!-- raw HTML omitted -->ULONG<!-- raw HTML omitted --> is the number of Owned Extents of the table.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The second <!-- raw HTML omitted -->ULONG<!-- raw HTML omitted --> is the number of Available Extents of the table.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->pvResult<!-- raw HTML omitted --> is interpreted as an array of:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The first <!-- raw HTML omitted -->ULONG<!-- raw HTML omitted --> is the number of Owned Extents of the table.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The second <!-- raw HTML omitted -->ULONG<!-- raw HTML omitted --> is the number of Available Extents of the table.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_TblInfoTemplateTableName<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->pvResult<!-- raw HTML omitted --> is interpreted as a string buffer. The buffer must be at least JET_cbNameMost + 1, including the terminating <!-- raw HTML omitted -->NULL<!-- raw HTML omitted -->. If the table is a derived table, the buffer will be filled in with the name of the table from which the derived table inherited its DDL. If the table is not a derived table, the buffer will an empty string.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errBufferTooSmall<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The buffer was too small.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errFeatureNotAvailable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->A deprecated <!-- raw HTML omitted -->InfoLevel<!-- raw HTML omitted --> was specified.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidBufferSize<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The buffer was not the right size.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidOperation<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The table that was passed in was a temporary table, and the requested <!-- raw HTML omitted -->InfoLevel<!-- raw HTML omitted --> cannot be retrieved for a temporary table.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errObjectNotFound<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The table that was passed in was a temporary table, and the requested <!-- raw HTML omitted -->InfoLevel<!-- raw HTML omitted --> cannot be retrieved for a temporary table.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errQueryNotSupported<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The <!-- raw HTML omitted -->InfoLevel<!-- raw HTML omitted --> is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTableInUse<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The table is being used by another database operation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTableLocked<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The table is locked by another database operation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_wrnTableInUseBySystem<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The table is being used by the system. This warning is nonfatal.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>Remarks</h4>
<p>Some pieces of information are not valid for temporary tables (See <a href="./jetopentemptable-function.html">JetOpenTempTable</a>).</p>
<p>The table statistics include the number of records and the number of pages in the clustered index (that is, the index containing the record data). The index statistics are accessed separately by name, using <a href="./jetgetindexinfo-function.html">JetGetIndexInfo</a> or <a href="./jetgettableindexinfo-function.html">JetGetTableIndexInfo</a>.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista, WindowsÂ XP, or WindowsÂ 2000 Professional.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008, Windows ServerÂ 2003, or WindowsÂ 2000 Server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Unicode<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Implemented as <!-- raw HTML omitted -->JetGetTableInfoW<!-- raw HTML omitted --> (Unicode) and <!-- raw HTML omitted -->JetGetTableInfoA<!-- raw HTML omitted --> (ANSI).<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-grbit.html">JET_GRBIT</a><br />
<a href="./jet-sesid.html">JET_SESID</a><br />
<a href="./jet-tableid.html">JET_TABLEID</a><br />
<a href="./jet-objectinfo-structure.html">JET_OBJECTINFO</a><br />
<a href="./jetgetindexinfo-function.html">JetGetIndexInfo</a><br />
<a href="./jetgetobjectinfo-function.html">JetGetObjectInfo</a><br />
<a href="./jetgettableindexinfo-function.html">JetGetTableIndexInfo</a><br />
<a href="./jetopentemptable-function.html">JetOpenTempTable</a></p>
</body>
