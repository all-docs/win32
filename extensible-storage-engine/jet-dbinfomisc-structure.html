<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JET_DBINFOMISC Structure</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JET_DBINFOMISC Structure&quot;
title: JET_DBINFOMISC Structure
TOCTitle: JET_DBINFOMISC Structure
ms:assetid: ff287087-35b8-495e-9922-418ec2439e19
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg294147(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg294147(v=EXCHG.10)</a>
ms:contentKeyID: 32765761
ms.date: 04/11/2016
ms.topic: reference
api_name:
topic_type:</p>
<ul>
<li>kbArticle</li>
<li>apiref
api_type:</li>
<li>COM
api_location:
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JET_DBINFOMISC Structure</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JET_DBINFOMISC Structure</h2>
<p>The <strong>JET_DBINFOMISC</strong> structure holds miscellaneous information about a database. This is the information that is contained in the database header.</p>
<pre lang="cpp"><code>    typedef struct {
      unsigned long ulVersion;
      unsigned long ulUpdate;
      JET_SIGNATURE signDb;
      unsigned long dbstate;
      JET_LGPOS lgposConsistent;
      JET_LOGTIME logtimeConsistent;
      JET_LOGTIME logtimeAttach;
      JET_LGPOS lgposAttach;
      JET_LOGTIME logtimeDetach;
      JET_LGPOS lgposDetach;
      JET_SIGNATURE signLog;
      JET_BKINFO bkinfoFullPrev;
      JET_BKINFO bkinfoIncPrev;
      JET_BKINFO bkinfoFullCur;
      unsigned long fShadowingDisabled;
      unsigned long fUpgradeDb;
      unsigned long dwMajorVersion;
      unsigned long dwMinorVersion;
      unsigned long dwBuildNumber;
      long lSPNumber;
      unsigned long cbPageSize;
    } JET_DBINFOMISC;
</code></pre>
<h3>Members</h3>
<p><strong>ulVersion</strong></p>
<p>The native version of the database engine that created the database. See <a href="./jetgetversion-function.html">JetGetVersion</a> to retrieve the native version for the current database engine.</p>
<p><strong>ulUpdate</strong></p>
<p>Tracks incremental database format updates that are backward compatible.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->ulVersion, ulUpdate =<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Meaning<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->0x620,0<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Original operating system Beta format (4/22/97).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->0x620,1<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Add columns in the catalog for conditional indexing and OLD (5/29/97).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->0x620,2<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Add the fLocalizedText flag in IDB (6/5/97).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->0x620,3<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Add SPLIT_BUFFER to space tree root pages (10/30/97).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->0x620,2<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Revert revision in order for ESE97 to remain forward-compatible (1/28/98).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->0x620,3<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Add new tagged columns to catalog (&quot;CallbackData&quot; and &quot;CallbackDependencies&quot;).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->0x620,4<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->SLV support: signSLV, fSLVExists in db header (5/5/98).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->0x620,5<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->New SLV space tree (5/29/98).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->0x620,6<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->SLV space map (10/12/98).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->0x620,7<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->4-byte IDXSEG (12/10/98).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->0x620,8<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->New template column format (1/25/99).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->0x620,9<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Sorted template columns (6/24/99).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->0x623,0<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->New Space Manager (5/15/99).<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p><strong>signDb</strong></p>
<p>Signature of the database (including creation time). This structure is 28 bytes.</p>
<p><strong>dbstate</strong></p>
<p>This is the database state.</p>
<p>The following options are available for this member.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Value<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Meaning<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_dbstateJustCreated<!-- raw HTML omitted -->1<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The database was just created.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_dbstateDirtyShutdown<!-- raw HTML omitted -->2<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The database requires hard or soft recovery to be run in order to become usable or moveable. One should not try to move databases in this state.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_dbstateCleanShutdown<!-- raw HTML omitted -->3<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The database is in a clean state. The database can be attached without any log files.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_dbstateBeingConverted<!-- raw HTML omitted -->4<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The database is being upgraded.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_dbstateForceDetach<!-- raw HTML omitted -->5<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Internal.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p><strong>lgposConsistent</strong></p>
<p>Null if the database is in a dirty state. This is the log position that was used when the database was last brought to a clean shutdown state.</p>
<p><strong>logtimeConsistent</strong></p>
<p>Null if the database is in a dirty state. This is the time when the database was last brought to a clean shutdown state.</p>
<p><strong>logtimeAttach</strong></p>
<p>The time when the database was last attached with <a href="./jetattachdatabase-function.html">JetAttachDatabase</a>.</p>
<p><strong>lgposAttach</strong></p>
<p>The log position that was used the last time the database was attached with <a href="./jetattachdatabase-function.html">JetAttachDatabase</a>.</p>
<p><strong>logtimeDetach</strong></p>
<p>The time when the database was last detached with <a href="./jetdetachdatabase-function.html">JetDetachDatabase</a>.</p>
<p><strong>lgposDetach</strong></p>
<p>The log position that was used the last time the database was detached with <a href="./jetdetachdatabase-function.html">JetDetachDatabase</a>.</p>
<p><strong>signLog</strong></p>
<p>Supports the ESE infrastructure and cannot be used in your code.</p>
<p><strong>bkinfoFullPrev</strong></p>
<p>Supports the ESE infrastructure and cannot be used in your code.</p>
<p><strong>bkinfoIncPrev</strong></p>
<p>Supports the ESE infrastructure and cannot be used in your code.</p>
<p><strong>bkinfoFullCur</strong></p>
<p>Supports the ESE infrastructure and cannot be used in your code.</p>
<p><strong>fShadowingDisabled</strong></p>
<p>Supports the ESE infrastructure and cannot be used in your code.</p>
<p><strong>fUpgradeDb</strong></p>
<p>Supports the ESE infrastructure and cannot be used in your code.</p>
<p><strong>dwMajorVersion</strong></p>
<p>Represents the WindowsÂ NT version numbers when the databases indexes were updated. Used for updating indexes.</p>
<p><strong>dwMinorVersion</strong></p>
<p>Represents the WindowsÂ NT version numbers when the databases indexes were updated. Used for updating indexes.</p>
<p><strong>dwBuildNumber</strong></p>
<p>Represents the WindowsÂ NT version numbers when the databases indexes were updated. Used for updating indexes.</p>
<p><strong>lSPNumber</strong></p>
<p>Represents the WindowsÂ NT version numbers when the databases indexes were updated. Used for updating indexes.</p>
<p><strong>cbPageSize</strong></p>
<p>Database page size. 0 means the page size is 4 KB.</p>
<p>This value is retrieved only if JET_DbInfoMisc was passed to <a href="./jetgetdatabaseinfo-function.html">JetGetDatabaseInfo</a> or <a href="./jetgetdatabasefileinfo-function.html">JetGetDatabaseFileInfo</a>.</p>
<h3>Requirements</h3>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista, WindowsÂ XP, or WindowsÂ 2000 Professional.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008, Windows ServerÂ 2003, or WindowsÂ 2000 Server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>See Also</h3>
<p><a href="./jet-bkinfo-structure.html">JET_BKINFO</a><br />
<a href="./jet-logtime-structure.html">JET_LOGTIME</a><br />
<a href="./jet-lgpos-structure.html">JET_LGPOS</a><br />
<a href="./jet-signature-structure.html">JET_SIGNATURE</a><br />
<a href="./jetgetdatabaseinfo-function.html">JetGetDatabaseInfo</a><br />
<a href="./jetgetdatabasefileinfo-function.html">JetGetDatabaseFileInfo</a></p>
</body>
