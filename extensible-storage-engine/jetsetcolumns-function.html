<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetSetColumns Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetSetColumns Function&quot;
title: JetSetColumns Function
TOCTitle: JetSetColumns Function
ms:assetid: a5b011dc-0da6-44bf-aaf5-352d8a57e5bf
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg294050(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg294050(v=EXCHG.10)</a>
ms:contentKeyID: 32765649
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetSetColumns
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>DLLExport</li>
<li>COM
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetSetColumns Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetSetColumns Function</h2>
<p>The <strong>JetSetColumns</strong> function is similar in behavior to <a href="./jetsetcolumn-function.html">JetSetColumn</a> but allows an application to set multiple column values in a single operation. An array of <a href="./jet-setcolumn-structure.html">JET_SETCOLUMN</a> structures is used to describe the set of column values to be set, and to describe input buffers for each column value to be set.</p>
<pre lang="cpp"><code>    JET_ERR JET_API JetSetColumns(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in_out_opt  JET_SETCOLUMN* psetcolumn,
      __in          unsigned long csetcolumn
    );
</code></pre>
<h3>Parameters</h3>
<p><em>sesid</em></p>
<p>The session to use for this call.</p>
<p><em>tableid</em></p>
<p>The cursor to use for this call.</p>
<p><em>psetcolumn</em></p>
<p>A pointer to an array of one or more <a href="./jet-setcolumn-structure.html">JET_SETCOLUMN</a> structures. Each structure includes descriptions of which column value to set and from where to get column data to set.</p>
<p><em>csetcolumn</em></p>
<p>The number of <a href="./jet-setcolumn-structure.html">JET_SETCOLUMN</a> structures in the array given by <em>psetcolumn</em>.</p>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errBadColumnId<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column ID given is outside the legal limits of a column ID.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errClientRequestToStopJetService<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because all activity on the instance associated with the session has ceased as a result of a call to <!-- raw HTML omitted -->JetStopService<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errColumnIllegalNull<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Same as JET_errNullInvalid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errColumnNotFound<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column described by the given <!-- raw HTML omitted -->columnid<!-- raw HTML omitted --> does not exist in the table.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errColumnNotUpdatable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An illegal attempt was made to update a long value during a insert copy delete original update operation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errColumnTooBig<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The given column value data given in the input buffer exceeds the size limitation either natural for a fixed length column or configured for fixed length text or binary columns. This error is also returned when passing more than 1024 bytes of data for a long column and setting the JET_bitSetIntrinsicLV flag.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInstanceUnavailable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has encountered a fatal error that requires that access to all data be revoked to protect the integrity of that data. This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidBufferSize<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The given column value data size does not match what is natural for the fixed length data type.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidColumnType<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An illegal attempt was made to update an auto-increment column either during an insert or update operation, or to update a version column during a replace operation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidgrbit<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The options supplied are unknown or an illegal combination of known bit settings.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidParameter<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The given psetinfo-&gt;cbStruct is not a valid size for the <!-- raw HTML omitted -->JET_SETINFO<!-- raw HTML omitted --> structure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errMultiValuedDuplicate<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The set column operation attempted to create a duplicate value and specified either JET_bitSetUniqueMultiValues or JET_bitSetUniqueNormalizedMultiValues.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNotInitialized<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has not been initialized yet.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNotInTransaction<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An illegal attempt was made to update a long column value when the calling session was not in a transaction.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNullInvalid<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An illegal attempt was made to set a non-NULL column to NULL.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRecordTooBig<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column value could not be set to the value in the input buffer because it would have caused the record to exceed its page size related size limitation. Columns of type <!-- raw HTML omitted -->JET_coltypLongText<!-- raw HTML omitted --> or <!-- raw HTML omitted -->JET_coltypLongBinary<!-- raw HTML omitted --> can be stored separately from the remaining record data. However, other columns must be stored with the record and can cause the record size limitation to be exceeded. Even long columns require 5-bytes of space within the record as a linkage and this too can lead to JET_errRecordTooBig being returned.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRestoreInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because a restore operation is in progress on the instance associated with the session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errSessionSharingViolation<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The same session cannot be used for more than one thread at the same time. This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTermInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session is being shut down.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errUpdateNotPrepared<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The cursor is not currently in the process of either inserting a new record or updating an existing record.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_wrnColumnMaxTruncated<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column value in the input buffer exceeded the maximum configured length for a variable length column and was truncated.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>On success, for each column described in the psetcolumns, the desired portion of the column value is set with data copied from the input buffer. The column data set may have been truncated if it exceeded the maximum length specified for a variable length column.</p>
<p>On failure, the cursor location is left unchanged and no column value data is updated in the copy buffer.</p>
<h4>Remarks</h4>
<p>If any individual set column operation returns an error then the whole <strong>JetSetColumns</strong> operation will return an error. Warnings, in general, are returned in the psetcolumns-&gt;error and not in the return code from this function. However, if the last column set has a warning, then this warning will be returned from <strong>JetSetColumns</strong> itself.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista, WindowsÂ XP, or WindowsÂ 2000 Professional.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008, Windows ServerÂ 2003, or WindowsÂ 2000 Server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./jet-coltyp.html">JET_COLTYP</a><br />
<a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-sesid.html">JET_SESID</a><br />
<a href="./jet-tableid.html">JET_TABLEID</a><br />
<a href="./jet-setcolumn-structure.html">JET_SETCOLUMN</a><br />
<a href="./jetretrievecolumns-function.html">JetRetrieveColumns</a><br />
<a href="./jetsetcolumn-function.html">JetSetColumn</a></p>
</body>
