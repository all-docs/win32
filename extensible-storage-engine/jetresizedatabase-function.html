<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetResizeDatabase Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetResizeDatabase Function&quot;
title: JetResizeDatabase Function
TOCTitle: JetResizeDatabase Function
ms:assetid: b6420de7-acff-480e-838b-f0e5acc29c65
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/JJ835047(v=EXCHG.10)">https://msdn.microsoft.com/library/JJ835047(v=EXCHG.10)</a>
ms:contentKeyID: 49894669
ms.date: 04/11/2016
ms.topic: reference
dev_langs:</p>
<ul>
<li>c++
api_name:</li>
<li>JetResizeDatabase
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>DLLExport
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetResizeDatabase Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<p>The <strong>JetResizeDatabase</strong> function extends or shrinks the size of a database that is currently open.</p>
<p>The <strong>JetResizeDatabase</strong> function was introduced in the WindowsÂ 8 operating system.</p>
<pre lang="c++"><code>JET_ERR JET_API JetResizeDatabase(
  __in          JET_SESID sesid,
  __in          JET_DBID dbid,
  __in          unsigned long cpg,
  __out         unsigned long* pcpgActual,
  __in          const JET_GRBIT grbit
);
</code></pre>
<h3>Parameters</h3>
<p><em>sesid</em></p>
<p>The database session context to use for the API call.</p>
<p><em>dbid</em></p>
<p>The database that will be extended.</p>
<p><em>cpg</em></p>
<p>The requested size of the database, in pages.</p>
<p><em>pcpgActual</em></p>
<p>A pointer to a number that receives the size of the database, in pages, after the API call. If the API call fails, the contents of <em>pcpgActual</em> parameter are undefined.</p>
<p><em>grbit</em></p>
<p>A group of bits that specifies zero or more of the values listed in the following table.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Value<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Meaning<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_bitResizeDatabaseOnlyGrow<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Only grow the database. If the resize call would shrink the database, do nothing.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Return value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the return codes listed in the following table. For more information about the possible Extensible Storage Engine (ESE) errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errDiskFull<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->There is insufficient free space on the volume to perform the grow operation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errDiskIO<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->A file-related error was returned by the <!-- raw HTML omitted -->JetSetDatabaseSize<!-- raw HTML omitted --> function. For more information about other file-related errors that might be returned, see <!-- raw HTML omitted -->JetSetDatabaseSize<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>Remarks</h4>
<p>If the <strong>JetResizeDatabase</strong> function is called prior to inserting large amounts of data, the database file will be grown in one operation. This will reduce the likelihood of the database file becoming fragmented at the file system level, and also reduce the number of times the database file has to be grown. Growing the database file once can be faster than growing it several times.</p>
<p>To set the size of a database that is not opened, see <a href="./jetsetdatabasesize-function.html">JetSetDatabaseSize</a>.</p>
<p>The file size might not match the number of pages that are returned in the <em>pcpgReal</em> parameter. Two additional reserved pages might not be counted in the <em>pcpgReal</em> parameter.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows 8.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2012.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See also</h4>
<p><a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-grbit.html">JET_GRBIT</a><br />
<a href="./jet-sesid.html">JET_SESID</a><br />
<a href="./jet-tableid.html">JET_TABLEID</a><br />
<a href="./jet-objectinfo-structure.html">JET_OBJECTINFO</a><br />
<a href="./jet-objectlist-structure.html">JET_OBJECTLIST</a><br />
<a href="./jetsetdatabasesize-function.html">JetSetDatabaseSize</a></p>
</body>
