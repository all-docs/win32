<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetRenameColumn Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetRenameColumn Function&quot;
title: JetRenameColumn Function
TOCTitle: JetRenameColumn Function
ms:assetid: 30967765-355b-417c-b0d6-8b59e677cc98
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg269218(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg269218(v=EXCHG.10)</a>
ms:contentKeyID: 32765521
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetRenameColumn
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>DLLExport</li>
<li>COM
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetRenameColumn Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetRenameColumn Function</h2>
<p>The <strong>JetRenameColumn</strong> function can be used to change the name of an existing column on a table.</p>
<p>**WindowsÂ XP:**Â Â <strong>JetRenameColumn</strong> is introduced in WindowsÂ XP.</p>
<pre lang="cpp"><code>    JET_ERR JET_API JetRenameColumn(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in          JET_PCSTR szName,
      __in          JET_PCSTR szNameNew,
      __in          JET_GRBIT grbit
    );
</code></pre>
<h3>Parameters</h3>
<p><em>sesid</em></p>
<p>The session to use for this call.</p>
<p><em>tableid</em></p>
<p>The cursor to use for this call.</p>
<p><em>szName</em></p>
<p>The current name of the column that will be renamed.</p>
<p><em>szNameNew</em></p>
<p>The new name for the column that will be renamed.</p>
<p><em>grbit</em></p>
<p>This parameter must be 0.</p>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errClientRequestToStopJetService<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because all activity on the instance associated with the session has ceased as a result of a call to <!-- raw HTML omitted -->JetStopService<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errColumnNotFound<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->This specified column does not exist for this table.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidName<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->One of the specified object names was invalid. All object names must conform to the same set of rules. These rules are as follows:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Object names must be composed of ASCII characters.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Object names must be at least one character in length.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Object names may not exceed JET_cbNameMost (64) characters in length.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Object names may not begin with a space - object names may not contain ASCII control characters (0x00 through 0x1F).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Object names may not contain an exclamation point (!), period (.), left bracket ([), or right bracket (]) character.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Once validated, only the portion of the string up to the first space (if any) will be used for the object name. This effectively means that object names may not contain a space either.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidParameter<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->One of the parameters provided contained an unexpected value or contained a value that did not make sense when combined with the value of another parameter. This can happen for <!-- raw HTML omitted -->JetRenameColumn<!-- raw HTML omitted --> when:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->szName<!-- raw HTML omitted --> is NULL.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->szNameNew<!-- raw HTML omitted --> is NULL.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInstanceUnavailable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has encountered a fatal error that requires that access to all data be revoked to protect the integrity of that data. This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInTransaction<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->This operation may only be performed when the session is not currently inside a transaction.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNotInitialized<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session has not been initialized yet.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRestoreInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because a restore operation is in progress on the instance associated with the session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errSessionSharingViolation<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The same session cannot be used for more than one thread at the same time. This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTermInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->It is not possible to complete the operation because the instance associated with the session is being shut down.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTransReadOnly<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->An update cannot be done while inside the scope of a read-only transaction. A read-only transaction is a transaction that has been started using a call to <!-- raw HTML omitted -->JetBeginTransaction2<!-- raw HTML omitted --> with JET_bitTransactionReadOnly. This error will only be returned by WindowsÂ XP and later releases.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>On success, the name of the specified column in the table associated with the cursor is permanently changed to the new name. Any indexes that reference that column will also be updated.</p>
<p>On failure, no change to the database state will occur.</p>
<h4>Remarks</h4>
<p>The column rename operation is unusual because, unlike other schema operations, it is not carried out as a transaction. When a column in a given table is renamed in one session then any other session using that table will see the change immediately, even if they are in a transaction that would prevent that session from seeing any other change made by the session doing the rename operation.</p>
<p>The column ID of a column is not affected by the rename operation.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista or WindowsÂ XP.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008 or Windows ServerÂ 2003.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Unicode<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Implemented as <!-- raw HTML omitted -->JetRenameColumnW<!-- raw HTML omitted --> (Unicode) and <!-- raw HTML omitted -->JetRenameColumnA<!-- raw HTML omitted --> (ANSI).<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-grbit.html">JET_GRBIT</a><br />
<a href="./jet-sesid.html">JET_SESID</a><br />
<a href="./jet-tableid.html">JET_TABLEID</a><br />
<a href="./jetbegintransaction2-function.html">JetBeginTransaction2</a></p>
</body>
