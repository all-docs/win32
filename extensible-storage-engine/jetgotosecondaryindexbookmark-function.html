<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JetGotoSecondaryIndexBookmark Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JetGotoSecondaryIndexBookmark Function&quot;
title: JetGotoSecondaryIndexBookmark Function
TOCTitle: JetGotoSecondaryIndexBookmark Function
ms:assetid: 06983b1e-503a-469b-9be5-b37e7551de67
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg269180(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg269180(v=EXCHG.10)</a>
ms:contentKeyID: 32765483
ms.date: 04/11/2016
ms.topic: reference
api_name:</p>
<ul>
<li>JetGotoSecondaryIndexBookmark
topic_type:</li>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>DLLExport</li>
<li>COM
api_location:</li>
<li>ESENT.DLL
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JetGotoSecondaryIndexBookmark Function</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JetGotoSecondaryIndexBookmark Function</h2>
<p>The <strong>JetGotoSecondaryIndexBookmark</strong> function positions a cursor to an index entry that is associated with the specified secondary index bookmark. The secondary index bookmark must be used with the same index over the same table from which it was originally retrieved. The secondary index bookmark for an index entry can be retrieved using <strong>JetGotoSecondaryIndexBookmark</strong>.</p>
<p>**WindowsÂ XP:**Â Â <strong>JetGotoSecondaryIndexBookmark</strong> is introduced in WindowsÂ XP.</p>
<pre lang="cpp"><code>    JET_ERR JET_API JetGotoSecondaryIndexBookmark(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in          void* pvSecondaryKey,
      __in          unsigned long cbSecondaryKey,
      __in_opt      void* pvPrimaryBookmark,
      __in          unsigned long cbPrimaryBookmark,
      __in          const JET_GRBIT grbit
    );
</code></pre>
<h3>Parameters</h3>
<p><em>sesid</em></p>
<p>The session to use for this call.</p>
<p><em>tableid</em></p>
<p>The cursor to use for this call.</p>
<p><em>pvSecondaryKey</em></p>
<p>The buffer that contains the secondary key to use to position the cursor.</p>
<p><em>cbSecondaryKey</em></p>
<p>The size of the secondary key in the buffer.</p>
<p><em>pvPrimaryBookmark</em></p>
<p>The buffer that contains the primary key bookmark to use to position the cursor.</p>
<p><em>cbPrimaryBookmark</em></p>
<p>The size of the primary key bookmark in the buffer.</p>
<p><em>grbit</em></p>
<p>A group of bits that specifies zero or more of the following options.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Value<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Meaning<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_bitBookmarkPermitVirtualCurrency<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->In the event that the index entry can no longer be found, the cursor will be left positioned where that index entry was previously found. The operation will still fail with JET_errRecordDeleted; however, it will be possible to move to the next or previous index entry relative to the index entry that is now missing.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Return Value</h3>
<p>This function returns the <a href="./jet-err.html">JET_ERR</a> datatype with one of the following return codes. For more information about the possible ESE errors, see <a href="./extensible-storage-engine-errors.html">Extensible Storage Engine Errors</a> and <a href="./error-handling-parameters.html">Error Handling Parameters</a>.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Return code<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Description<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_errSuccess<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation completed successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errClientRequestToStopJetService<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation cannot complete because all activity on the instance that is associated with the session has ceased as a result of a call to <!-- raw HTML omitted -->JetStopService<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInstanceUnavailable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation cannot complete because is because the instance that is associated with the session has encountered a fatal error that requires that access to all data be revoked to protect the integrity of that data.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WindowsÂ XP:<!-- raw HTML omitted -->Â Â This return value is introduced in WindowsÂ XP.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errInvalidBookmark<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The secondary index bookmark that was provided was invalid. This error might have occurred because the secondary key is zero or the secondary key buffer pointer is <!-- raw HTML omitted -->NULL<!-- raw HTML omitted -->. This error occurs because<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The current secondary index does not have a uniqueness constraint and the size of the provided bookmark is zero.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The bookmark buffer pointer is <!-- raw HTML omitted -->NULL<!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNoCurrentIndex<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The cursor is not currently on a secondary index. It is not meaningful to go to a secondary index bookmark when the cursor is not currently using a secondary index. <!-- raw HTML omitted -->JetGotoBookmark<!-- raw HTML omitted --> should be used when the cursor is not on a secondary index.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errNotInitialized<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation cannot complete because the instance that is associated with the session has not yet been initialized.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRecordDeleted<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The index entry that is associated with the secondary index bookmark could not be found.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errRestoreInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation cannot complete because a restore operation is in progress on the instance that is associated with the session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errSessionSharingViolation<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The same session cannot be used for more than one thread at the same time.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WindowsÂ XP:<!-- raw HTML omitted -->Â Â This return value is introduced in WindowsÂ XP.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_errTermInProgress<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The operation cannot complete because the instance that is associated with the session is being shut down.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>If this function succeeds, the cursor will be positioned at an index entry that is associated with the specified secondary index bookmark. If a record has been prepared for update, that update will be canceled. If an index range is in effect, that index range will be canceled. If a search key has been constructed for the cursor to use, that search key will be deleted. No change to the database state will occur.</p>
<p>If this function fails, the position of the cursor remains unchanged unless JET_errRecordDeleted is returned and JET_bitBookmarkPermitVirtualCurrency is specified. In that case, the cursor will be positioned where the index entry that is associated with the specified secondary index bookmark would have been. The cursor can be moved relative to that position, but is still not on a valid index entry.</p>
<p>If a record has been prepared for update, that update will be canceled. If an index range is in effect, that index range will be canceled. If a search key has been constructed for the cursor to use, that search key will be deleted. In any case, no change to the database state will occur.</p>
<h4>Requirements</h4>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista or WindowsÂ XP.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008 or Windows ServerÂ 2003.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Library<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use ESENT.lib.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->DLL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires ESENT.dll.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4>See Also</h4>
<p><a href="./jet-err.html">JET_ERR</a><br />
<a href="./jet-grbit.html">JET_GRBIT</a><br />
<a href="./jet-sesid.html">JET_SESID</a><br />
<a href="./jet-tableid.html">JET_TABLEID</a><br />
<a href="./jetgetsecondaryindexbookmark-function.html">JetGetSecondaryIndexBookmark</a><br />
<a href="./jetgotobookmark-function.html">JetGotoBookmark</a><br />
<a href="./jetstopservice-function.html">JetStopService</a></p>
</body>
