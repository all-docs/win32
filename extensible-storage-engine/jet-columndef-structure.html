<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>JET_COLUMNDEF Structure</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: &quot;Learn more about: JET_COLUMNDEF Structure&quot;
title: JET_COLUMNDEF Structure
TOCTitle: JET_COLUMNDEF Structure
ms:assetid: ee1fc473-bff5-438e-98ae-247de12e76f9
ms:mtpsurl: <a href="https://msdn.microsoft.com/library/Gg294130(v=EXCHG.10)">https://msdn.microsoft.com/library/Gg294130(v=EXCHG.10)</a>
ms:contentKeyID: 32765744
ms.date: 04/11/2016
ms.topic: reference
api_name:
topic_type:</p>
<ul>
<li>apiref</li>
<li>kbArticle
api_type:</li>
<li>COM
api_location:
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>JET_COLUMNDEF Structure</h1>
<p><em><strong>Applies to:</strong> WindowsÂ | Windows Server</em></p>
<h2>JET_COLUMNDEF Structure</h2>
<p>The <strong>JET_COLUMNDEF</strong> structure defines the data that can be stored in a column.</p>
<pre lang="cpp"><code>    typedef struct {
      unsigned long cbStruct;
      JET_COLUMNID columnid;
      JET_COLTYP coltyp;
      unsigned short wCountry;
      unsigned short langid;
      unsigned short cp;
      unsigned short wCollate;
      unsigned long cbMax;
      JET_GRBIT grbit;
    } JET_COLUMNDEF;
</code></pre>
<h3>Members</h3>
<p><strong>cbStruct</strong></p>
<p>The size of the structure, in bytes. It must be set to sizeof( JET_COLUMNDEF).</p>
<p><strong>columnid</strong></p>
<p>Reserved. <strong>columnid</strong> must be set to 0 (zero).</p>
<p><strong>coltyp</strong></p>
<p>The type of the column (for example, text, binary, or numerical). For more information, see <a href="./jet-coltyp.html">JET_COLTYP</a>.</p>
<p><strong>wCountry</strong></p>
<p>Reserved. <strong>wCountry</strong> must be set to 0 (zero).</p>
<p><strong>langid</strong></p>
<p>Obsolete. <strong>langid</strong> should be set to 0 (zero).</p>
<p><strong>cp</strong></p>
<p>The code page for the column. The only valid values for text columns are English (1252) and Unicode (1200). A value of zero means the default will be used (English, 1252). If the column is not a text column, the code page automatically gets set to zero.</p>
<p><strong>wCollate</strong></p>
<p>Reserved. <strong>wCollate</strong> must be set to 0 (zero).</p>
<p><strong>cbMax</strong></p>
<p>The maximum length, in bytes, of a variable-length column, or the length of a fixed-length column.</p>
<p><strong>grbit</strong></p>
<p>A group of bits that contain the options to be used for this call, which include zero or more of the following values.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->Value<!-- raw HTML omitted --></th>
<th><!-- raw HTML omitted -->Meaning<!-- raw HTML omitted --></th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnFixed<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column will be fixed. It will always use the same amount of space in a row, regardless of how much data is being stored in the column. JET_bitColumnFixed cannot be used with JET_bitColumnTagged. This bit cannot be used with long values (that is <!-- raw HTML omitted -->JET_coltypLongText<!-- raw HTML omitted --> and <!-- raw HTML omitted -->JET_coltypLongBinary<!-- raw HTML omitted -->).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnTagged<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column will be tagged. Tagged columns do not take up any space in the database if they do not contain data. This bit cannot be used with JET_bitColumnFixed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnNotNULL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column must never be set to a NULL value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnVersion<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column is a version column that specifies the version of the row. The value of this column starts at zero and will be automatically incremented for each update on the row.<!-- raw HTML omitted --><!-- raw HTML omitted -->This bit can only be applied to <!-- raw HTML omitted -->JET_coltypLong<!-- raw HTML omitted --> columns. This bit cannot be used with JET_bitColumnAutoincrement, JET_bitColumnEscrowUpdate, or JET_bitColumnTagged.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnAutoincrement<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column will automatically be incremented. The number is an increasing number, and is guaranteed to be unique within a table. The numbers, however, might not be continuous. For example, if five rows are inserted into a table, the &quot;autoincrement&quot; column could contain the values { 1, 2, 6, 7, 8 }. This bit can only be used on columns of type <!-- raw HTML omitted -->JET_coltypLong<!-- raw HTML omitted --> or <!-- raw HTML omitted -->JET_coltypCurrency<!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WindowsÂ 2000:Â Â <!-- raw HTML omitted -->In WindowsÂ 2000, this bit can only be used on columns of type <!-- raw HTML omitted -->JET_coltypLong<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnUpdatable<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->This bit is valid only on calls to <!-- raw HTML omitted -->JetGetColumnInfo<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnTTKey<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->This bit is valid only on calls to <!-- raw HTML omitted -->JetOpenTable<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnTTDescending<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->This bit is valid only on calls to <!-- raw HTML omitted -->JetOpenTempTable<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnMultiValued<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column can be multi-valued. A multi-valued column can have zero, one, or more values associated with it. The various values in a multi-valued column are identified by a number called the <!-- raw HTML omitted -->itagSequence<!-- raw HTML omitted --> member, which belongs to various structures, including: <!-- raw HTML omitted -->JET_RETINFO<!-- raw HTML omitted -->, <!-- raw HTML omitted -->JET_SETINFO<!-- raw HTML omitted -->, <!-- raw HTML omitted -->JET_SETCOLUMN<!-- raw HTML omitted -->, <!-- raw HTML omitted -->JET_RETRIEVECOLUMN<!-- raw HTML omitted -->, and <!-- raw HTML omitted -->JET_ENUMCOLUMNVALUE<!-- raw HTML omitted -->. Multi-valued columns must be tagged columns; that is, they cannot be fixed-length or variable-length columns.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnEscrowUpdate<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Specifies that a column is an escrow update column. An escrow update column can be updated concurrently by different sessions with <!-- raw HTML omitted -->JetEscrowUpdate<!-- raw HTML omitted --> and will maintain transactional consistency. An escrow update column must also meet the following conditions:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->An escrow update column can be created only when the table is empty.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->An escrow update column must be of type <!-- raw HTML omitted -->JET_coltypLong<!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->An escrow update column must have a default value (that is <!-- raw HTML omitted -->cbDefault<!-- raw HTML omitted --> must be positive).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->JET_bitColumnEscrowUpdate cannot be used in conjunction with JET_bitColumnTagged, JET_bitColumnVersion, or JET_bitColumnAutoincrement.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnUnversioned<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column will be created in an without version information. This means that other transactions that attempt to add a column with the same name will fail. This bit is only useful with <!-- raw HTML omitted -->JetAddColumn<!-- raw HTML omitted -->. It cannot be used within a transaction.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnMaybeNull<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Reserved for future use.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnFinalize<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Use JET_bitColumnDeleteOnZero instead of JET_bitColumnFinalize. JET_bitColumnFinalize that a column can be finalized. When a column that can be finalized has an escrow update column that reaches zero, the row will be deleted. Future versions might invoke a callback function instead (For more information, see <!-- raw HTML omitted -->JET_CALLBACK<!-- raw HTML omitted -->). A column that can be finalized must be an escrow update column. JET_bitColumnFinalize cannot be used with JET_bitColumnUserDefinedDefault.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnUserDefinedDefault<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The default value for a column will be provided by a callback function. See <!-- raw HTML omitted -->JET_CALLBACK<!-- raw HTML omitted -->. A column that has a user-defined default must be a tagged column. Specifying JET_bitColumnUserDefinedDefault means that <!-- raw HTML omitted -->pvDefault<!-- raw HTML omitted --> must point to a <!-- raw HTML omitted -->JET_USERDEFINEDDEFAULT<!-- raw HTML omitted --> structure, and <!-- raw HTML omitted -->cbDefault<!-- raw HTML omitted --> must be set to sizeof( <!-- raw HTML omitted -->JET_USERDEFINEDDEFAULT<!-- raw HTML omitted --> ).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->JET_bitColumnUserDefinedDefault cannot be used in conjunction with JET_bitColumnFixed, JET_bitColumnNotNULL, JET_bitColumnVersion, JET_bitColumnAutoincrement, JET_bitColumnUpdatable, JET_bitColumnEscrowUpdate, JET_bitColumnFinalize, JET_bitColumnDeleteOnZero, or JET_bitColumnMaybeNull.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->JET_bitColumnDeleteOnZero<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->The column is an escrow update column, and when it reaches zero, the record will be deleted. A common use for a column that can be finalized is to use it as a reference count field, and when the field reaches zero the record gets deleted. JET_bitColumnDeleteOnZero is related to JET_bitColumnFinalize. A Delete-on-zero column must be an escrow update column. JET_bitColumnDeleteOnZero cannot be used with JET_bitColumnFinalize. JET_bitColumnDeleteOnZero cannot be used with user defined default columns.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Requirements</h3>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Client<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires WindowsÂ Vista, WindowsÂ XP, or WindowsÂ 2000 Professional.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Server<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Requires Windows ServerÂ 2008, Windows ServerÂ 2003, or WindowsÂ 2000 Server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Header<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Declared in Esent.h.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>See Also</h3>
<p><a href="./jet-callback-callback-function.html">JET_CALLBACK</a><br />
<a href="./jet-coltyp.html">JET_COLTYP</a><br />
<a href="./jet-columncreate-structure.html">JET_COLUMNCREATE</a><br />
<a href="./jet-columnid.html">JET_COLUMNID</a><br />
<a href="./jet-grbit.html">JET_GRBIT</a><br />
<a href="./jet-userdefineddefault-structure.html">JET_USERDEFINEDDEFAULT</a><br />
<a href="./jetaddcolumn-function.html">JetAddColumn</a><br />
<a href="./jetescrowupdate-function.html">JetEscrowUpdate</a><br />
<a href="./jetgettablecolumninfo-function.html">JetGetTableColumnInfo</a><br />
<a href="./jetopentemptable-function.html">JetOpenTempTable</a><br />
<a href="./jetopentemptable2-function.html">JetOpenTempTable2</a><br />
<a href="./jetopentemptable3-function.html">JetOpenTempTable3</a><br />
<a href="./jetrenamecolumn-function.html">JetRenameColumn</a></p>
</body>
