<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>enrollSimpleUserCert</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Enrolls an end user with a certification authority (CA) by using a template, the subject name, and the length, in bits, of the key.
ms.assetid: ee290c78-dbfa-4414-8489-aa886360652b
title: enrollSimpleUserCert
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>enrollSimpleUserCert</h1>
<p>The enrollSimpleUserCert sample enrolls an end user with a certification authority (CA) by using a template, the subject name, and the length, in bits, of the key.</p>
<h2>Location</h2>
<p>When you install the Microsoft Windows Software Development Kit (SDK), a C++ version of the sample is installed, by default, in the <em>%ProgramFiles%</em>\Microsoft SDKs\Windows\v7.0\Samples\Security\X509 Certificate Enrollment\VC\enrollSimpleUserCert folder. A C# version is installed in the <em>%ProgramFiles%</em>\Microsoft SDKs\Windows\v7.0\Samples\X509 Certificate Enrollment\CSharp\EnrollSimpleUserCert folder.</p>
<h2>Discussion</h2>
<p>The enrollSimpleUserCert sample:</p>
<ol>
<li>Processes the command line arguments. The command line should contain the name of the template, the subject name, and the key length.</li>
<li>Creates an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> object and initializes it by using the template.</li>
<li>Retrieves the inner certificate request object from the enrollment object and queries it for the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10"><strong>IX509CertificateRequestPkcs10</strong></a> object. The innermost request is always a PKCS #10 request.</li>
<li>Retrieves the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey"><strong>IX509PrivateKey</strong></a> object from the PKCS #10 request and sets the key length specified on the command line.</li>
<li>Creates an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix500distinguishedname"><strong>IX500DistinguishedName</strong></a> object, uses it to encode the X.500 subject name, and adds the name to the PKCS #10 request.</li>
<li>Attempts to enroll the end user with the CA and monitors the progress of the enrollment process. The checkEnrollStatus function is defined in enrollCommon.cpp.</li>
</ol>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="pkcs--10-request.html">PKCS #10 Request</a></p>
<!-- raw HTML omitted -->
<p><a href="using-the-included-samples.html">Using the Included Samples</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
