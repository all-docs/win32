<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>enrollCommon</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The enrollCommon folder contains the following helper functions and macros used by the samples provided with the Certificate Enrollment SDK.
ms.assetid: a9b3532d-9640-4373-a6c6-7828cb6f55c7
title: enrollCommon
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>enrollCommon</h1>
<p>The enrollCommon folder contains the following helper functions and macros used by the samples provided with the Certificate Enrollment SDK. It is installed by default in the <em>%ProgramFiles%</em>\Microsoft SDKs\Windows\v7.0\Samples\Security\X509 Certificate Enrollment\VC\enrollCommon folder.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>_JumpIfError</td>
<td>Macro that accepts an <!-- raw HTML omitted -->HRESULT<!-- raw HTML omitted --> value, a label, and an error string, prints the string, and transfers program control to the first statement following the label.</td>
</tr>
<tr>
<td>_JumpError</td>
<td>Same as the _JumpIfError macro.</td>
</tr>
<tr>
<td>_PrintIfError</td>
<td>Not currently used.</td>
</tr>
<tr>
<td>_PrintError</td>
<td>Macro that prints an error message and an <!-- raw HTML omitted -->HRESULT<!-- raw HTML omitted --> value.</td>
</tr>
<tr>
<td>convertWszToSz</td>
<td>Converts a wide-character string to an ASCII character string by using the <!-- raw HTML omitted -->WideCharToMultiByte<!-- raw HTML omitted --> function and the current ANSI code-page identifier for the system. This function is used by the decConvertFromUnicode and findOIDFromTemplateName functions defined in enrollCommon.cpp.</td>
</tr>
<tr>
<td>convertSzToWsz</td>
<td>Converts an ASCII string to a wide-character string by using the <!-- raw HTML omitted -->MultiByteToWideChar<!-- raw HTML omitted --> function and the current ANSI code-page identifier for the system. This function is used by the findCertByTemplate function defined in enrollCommon.cpp.</td>
</tr>
<tr>
<td>convertSzToBstr</td>
<td>Converts an ASCII string to a <!-- raw HTML omitted -->BSTR<!-- raw HTML omitted --> by using the <!-- raw HTML omitted -->MultiByteToWideChar<!-- raw HTML omitted --> function. This function is not currently used.</td>
</tr>
<tr>
<td>convertWszToBstr</td>
<td>Converts a wide-character string to a <!-- raw HTML omitted -->BSTR<!-- raw HTML omitted -->. This function is used by the installResponseFromPFX sample.</td>
</tr>
<tr>
<td>checkEnrollStatus</td>
<td>Checks the status of the certificate enrollment process by using the <!-- raw HTML omitted --><!-- raw HTML omitted -->IX509Enrollment<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IX509EnrollmentStatus<!-- raw HTML omitted --><!-- raw HTML omitted --> interfaces. This function is used by the enrollEOBOCMC, enrollPKCS7, enrollRenewalPKCS7, enrollSimpleMachineCert, and enrollSimpleUserCert samples.</td>
</tr>
<tr>
<td>findCertByKeyUsage</td>
<td>Enumerates the personal certificate store of the current user to find the first certificate for which the intended use of the public key matches a specified value. The value specified can be a bitwise combination of the following flags:<!-- raw HTML omitted --><!-- raw HTML omitted -->CERT_DATA_ENCIPHERMENT_KEY_USAGE<!-- raw HTML omitted --><!-- raw HTML omitted -->CERT_DIGITAL_SIGNATURE_KEY_USAGE<!-- raw HTML omitted --><!-- raw HTML omitted -->CERT_KEY_AGREEMENT_KEY_USAGE<!-- raw HTML omitted --><!-- raw HTML omitted -->CERT_KEY_CERT_SIGN_KEY_USAGE<!-- raw HTML omitted --><!-- raw HTML omitted -->CERT_KEY_ENCIPHERMENT_KEY_USAGE<!-- raw HTML omitted --><!-- raw HTML omitted -->CERT_NON_REPUDIATION_KEY_USAGE<!-- raw HTML omitted --><!-- raw HTML omitted -->CERT_OFFLINE_CRL_SIGN_KEY_USAGE<!-- raw HTML omitted --><!-- raw HTML omitted -->This function is used by the enrollFromPublicKey sample.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>findCertByEKU</td>
<td>Enumerates the personal certificate store of the current user to find the first certificate for which the Enhanced Key Usage (EKU) extension matches that specified on input. For more information about the EKU extension, see the <!-- raw HTML omitted --><!-- raw HTML omitted -->IX509ExtensionEnhancedKeyUsage<!-- raw HTML omitted --><!-- raw HTML omitted --> interface. This function is used by the enrollEOBOCMC sample.</td>
</tr>
<tr>
<td>findCertByTemplate</td>
<td>Enumerates the personal certificate store of the current user to find the first certificate for which the template matches that specified, by name, on input. This function is used by the enrollPKCS7 and enrollRenewalPKCS7 samples.</td>
</tr>
<tr>
<td>enrollCertByTemplate</td>
<td>Initializes an <!-- raw HTML omitted --><!-- raw HTML omitted -->IX509Enrollment<!-- raw HTML omitted --><!-- raw HTML omitted --> object by using a template, attempts to enroll the implicitly created certificate request, and monitors the status of the enrollment process. This function is used by the enrollEOBOCMC, enrollFromPublicKey, enrollPKCS7, and enrollRenewalPKCS7 samples.</td>
</tr>
<tr>
<td>verifyCertContext</td>
<td>Verifies compliance of the certificate chain against the specified (base) policy and, optionally, against a specified Enhanced Key Usage (EKU) extension. For more information, see the <!-- raw HTML omitted --><!-- raw HTML omitted -->CertVerifyCertificateChainPolicy<!-- raw HTML omitted --><!-- raw HTML omitted --> function and the <!-- raw HTML omitted --><!-- raw HTML omitted -->CERT_CHAIN_POLICY_PARA<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->CERT_CHAIN_PARA<!-- raw HTML omitted --><!-- raw HTML omitted --> structures. This function is used by the enrollEOBOCMC, enrollFromPublicKey, enrollPKCS7, and enrollRenewalPKCS7 samples.</td>
</tr>
<tr>
<td>decConvertFromUnicode</td>
<td>Converts a string of double-byte Unicode characters to a string of single-byte ANSI characters. This function is used by the DecodeFileW function defined in enrollCommon.cpp.</td>
</tr>
<tr>
<td>DecodeFileW</td>
<td>Decodes an encoded certificate or certificate request file to a byte array. This function is used by the installResponseFromPFX sample.</td>
</tr>
<tr>
<td>EncodeToFileW</td>
<td>Encodes a certificate or certificate request and saves it to a file. This function is used by the createCNGCustomCMC, enrollEOBOCMC, and enrollFromPublicKey samples.</td>
</tr>
<tr>
<td>findOIDFromTemplateName</td>
<td>Retrieves the object identifier for a template specified by name. This function is used by the findCertByTemplate function defined in enrollCommon.cpp.</td>
</tr>
</tbody>
</table>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="using-the-included-samples.html">Using the Included Samples</a></p>
<!-- raw HTML omitted -->
</body>
