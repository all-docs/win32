<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Personal Information Exchange Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Each of the following sections discusses a function exported by Xenroll.dll to manage Personal Information Exchange (PFX) messages.
ms.assetid: f7e6b3a6-eae4-49f8-a624-609742741560
title: Personal Information Exchange Functions
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Personal Information Exchange Functions</h1>
<p>Each of the following sections discusses a function exported by Xenroll.dll to manage Personal Information Exchange (PFX) messages. Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists.</p>
<h2>createFilePFXWStr</h2>
<p>The <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll4-createfilepfxwstr"><strong>createFilePFXWStr</strong></a> function in Xenroll.dll saves a certificate chain and <a href="/windows/desktop/SecGloss/p-gly"><em>private key</em></a> in a file by using the PFX format.</p>
<p>The CertEnroll.dll library does not directly implement functionality to copy the PFX message to a file. You can, however, use the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createpfx"><strong>CreatePFX</strong></a> method on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> interface to create an encoded PFX message and write a custom function to save the message in a file.</p>
<h2>createPFXWStr</h2>
<p>The <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll4-createpfxwstr"><strong>createPFXWStr</strong></a> function in Xenroll.dll saves a certificate chain and private key in a PFX format string.</p>
<p>You can use the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createpfx"><strong>CreatePFX</strong></a> method on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> interface to create an encoded PFX message that contains the certificate chain and key. You can specify a password, export options, and encoding type. To retrieve a string that is equivalent to that returned from <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll4-createpfxwstr"><strong>createPFXWStr</strong></a>, pass the XCN_CRYPT_STRING_BINARY flag in the in the <em>Encoding</em> parameter of the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createpfx"><strong>CreatePFX</strong></a> method.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="mapping-xenroll-dll-to-certenroll-dll.html">Mapping Xenroll.dll to CertEnroll.dll</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
