<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>enrollEOBOCMC</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Creates a CMC certificate request on behalf of another user and enrolls the user in a certificate hierarchy.
ms.assetid: 14cc76c9-0e2b-498f-b058-244af6e9111e
title: enrollEOBOCMC
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>enrollEOBOCMC</h1>
<p>The enrollEOBOCMC sample creates a CMC certificate request on behalf of another user and enrolls the user in a certificate hierarchy. Enrollment on behalf of another user requires that the certificate request be signed by using an enrollment agent certificate.</p>
<h2>Location</h2>
<p>When you install the Microsoft Windows Software Development Kit (SDK), the sample is installed, by default, in the <em>%ProgramFiles%</em>\Microsoft SDKs\Windows\v7.0\Samples\Security\X509 Certificate Enrollment\VC\enrollEOBOCMC folder.</p>
<h2>Discussion</h2>
<p>The enrollEOBOCMC sample:</p>
<ol>
<li>Processes the following command line arguments:
<ul>
<li>The name of a certificate template.</li>
<li>The name of the user requesting the certificate.</li>
<li>The name of a Personal Information Exchange (PFX) file in which to save the request.</li>
<li>A password to use with the PFX file.</li>
<li>An optional enrollment agent template name. The template is used to create an enrollment agent certificate if none exists in the certificate store.</li>
</ul>
</li>
<li>Creates an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc"><strong>IX509CertificateRequestCmc</strong></a> object and initializes it by using the certificate template specified on the command line.</li>
<li>Adds the name of the requester to the CMC request object.</li>
<li>Retrieves an existing enrollment agent certificate or, if one cannot be found, creates a certificate request from the enrollment agent template specified on the command line and attempts to enroll it.</li>
<li>Verifies the certificate chain that contains the enrollment agent certificate.</li>
<li>Creates an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-isignercertificate"><strong>ISignerCertificate</strong></a> object, initializes it by using the enrollment agent certificate, retrieves the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-isignercertificates"><strong>ISignerCertificates</strong></a> collection from the CMC request object, and adds the enrollment agent signing certificate object to the collection. The <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> object discussed in the next step uses the certificate to sign the CMC request.</li>
<li>Creates an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> object, initializes it by using the CMC request, attempts to enroll it, and checks the progress of the enrollment process.</li>
<li>Exports the installed certificate to a PFX file. The file is protected by using the password specified on the command line. The EncodeToFileW function is defined in enrollCommon.cpp.</li>
<li>Deletes the certificate from the certificate store. The functions used in the following code example can be found in the CryptoAPI documentation.</li>
<li>Deletes the private key from the computer.</li>
</ol>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="cmc-eobo-request.html">CMC EOBO Request</a></p>
<!-- raw HTML omitted -->
<p><a href="pkcs--10-request.html">PKCS #10 Request</a></p>
<!-- raw HTML omitted -->
<p><a href="using-the-included-samples.html">Using the Included Samples</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
