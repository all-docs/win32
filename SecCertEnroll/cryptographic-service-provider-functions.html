<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Cryptographic Service Provider Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Functions exported by Xenroll.dll that can be used to manage a cryptographic provider.
ms.assetid: 4f6f353d-6b06-45b4-8808-56998d3727a4
title: Cryptographic Service Provider Functions
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Cryptographic Service Provider Functions</h1>
<p>Each of the following sections identifies a function exported by Xenroll.dll that can be used to manage a cryptographic provider. Each topic also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</p>
<ul>
<li><a href="#enumalgs">EnumAlgs</a></li>
<li><a href="#enumcontainerswstr">enumContainersWStr</a></li>
<li><a href="#enumproviderswstr">enumProvidersWStr</a></li>
<li><a href="#getalgnamewstr">GetAlgNameWStr</a></li>
<li><a href="#getprovidertypewstr">getProviderTypeWStr</a></li>
<li><a href="#hashalgid">HashAlgID</a></li>
<li><a href="#hashalgorithmwstr">HashAlgorithmWStr</a></li>
<li><a href="#providerflags">ProviderFlags</a></li>
<li><a href="#providernamewstr">ProviderNameWStr</a></li>
<li><a href="#getprovidertypewstr">ProviderType</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>EnumAlgs</h2>
<p>The <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll2-enumalgs"><strong>EnumAlgs</strong></a> function in Xenroll.dll retrieves a cryptographic algorithm collection.</p>
<p>When using CertEnroll.dll, you can perform the following actions to retrieve information about the algorithms supported by a <a href="/windows/desktop/SecGloss/c-gly"><em>cryptographic service provider</em></a> (CSP):</p>
<ol>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request"><strong>Request</strong></a> property on an existing <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> object.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest"><strong>GetInnerRequest</strong></a> method on the request returned from step 1 to retrieve the innermost request.</li>
<li>Call <strong>QueryInterface</strong> on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest"><strong>IX509CertificateRequest</strong></a> object returned from step 2 to cast to an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10"><strong>IX509CertificateRequestPkcs10</strong></a> object.</li>
<li>Call the <a href="/windows/desktop/SecCrypto/privatekey"><strong>PrivateKey</strong></a> property on the PKCS #10 request.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_cspinformations"><strong>CspInformations</strong></a> property on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey"><strong>IX509PrivateKey</strong></a> object retrieved from step 4.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-icspinformation-get_cspalgorithms"><strong>CspAlgorithms</strong></a> property on a specific <a href="/windows/desktop/api/CertEnroll/nn-certenroll-icspinformation"><strong>ICspInformation</strong></a> object in the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-icspinformations"><strong>ICspInformations</strong></a> collection retrieved in step 5.</li>
</ol>
<h2>enumContainersWStr</h2>
<p>The <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll-enumcontainerswstr"><strong>enumContainersWStr</strong></a> function in Xenroll.dll retrieves a key container from the collection by index.</p>
<p>The CertEnroll.dll library does not directly implement this functionality.</p>
<h2>enumProvidersWStr</h2>
<p>The <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll-enumproviderswstr"><strong>enumProvidersWStr</strong></a> function in Xenroll.dll retrieves a CSP from the collection by index.</p>
<p>When using CertEnroll.dll, you can perform the following actions to retrieve the collection of cryptographic containers:</p>
<ol>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request"><strong>Request</strong></a> property on an existing <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> object.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest"><strong>GetInnerRequest</strong></a> method on the request returned from step 1 to retrieve the innermost request.</li>
<li>Call <strong>QueryInterface</strong> on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest"><strong>IX509CertificateRequest</strong></a> object returned from step 2 to cast to an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10"><strong>IX509CertificateRequestPkcs10</strong></a> object.</li>
<li>Call the <a href="/windows/desktop/SecCrypto/privatekey"><strong>PrivateKey</strong></a> property on the PKCS #10 request.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_cspinformations"><strong>CspInformations</strong></a> property on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey"><strong>IX509PrivateKey</strong></a> object retrieved from step 4.</li>
</ol>
<h2>GetAlgNameWStr</h2>
<p>The <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getalgnamewstr"><strong>GetAlgNameWStr</strong></a> function in Xenroll.dll retrieves the name of a <a href="/windows/desktop/SecGloss/c-gly"><em>cryptographic algorithm</em></a>.</p>
<p>When using CertEnroll.dll, you can perform the following actions to retrieve the algorithm name:</p>
<ol>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request"><strong>Request</strong></a> property on an existing <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> object.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest"><strong>GetInnerRequest</strong></a> method on the request returned from step 1 to retrieve the innermost request.</li>
<li>Call <strong>QueryInterface</strong> on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest"><strong>IX509CertificateRequest</strong></a> object returned from step 2 to cast to an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10"><strong>IX509CertificateRequestPkcs10</strong></a> object.</li>
<li>Call the <a href="/windows/desktop/SecCrypto/privatekey"><strong>PrivateKey</strong></a> property on the PKCS #10 request.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_algorithm"><strong>Algorithm</strong></a> property on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey"><strong>IX509PrivateKey</strong></a> object to retrieve the algorithm object identifier.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-iobjectid-get_friendlyname"><strong>FriendlyName</strong></a> property on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-iobjectid"><strong>IObjectId</strong></a> interface to retrieve the algorithm display name.</li>
</ol>
<h2>getProviderTypeWStr</h2>
<p>The <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getprovidertypewstr"><strong>getProviderTypeWStr</strong></a> function in Xenroll.dll retrieves the cryptographic provider type.</p>
<p>When using CertEnroll.dll, you can perform the following actions to retrieve the provider type:</p>
<ol>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request"><strong>Request</strong></a> property on an existing <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> object.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest"><strong>GetInnerRequest</strong></a> method on the request returned from step 1 to retrieve the innermost request.</li>
<li>Call <strong>QueryInterface</strong> on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest"><strong>IX509CertificateRequest</strong></a> object returned from step 2 to cast to an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10"><strong>IX509CertificateRequestPkcs10</strong></a> object.</li>
<li>Call the <a href="/windows/desktop/SecCrypto/privatekey"><strong>PrivateKey</strong></a> property on the PKCS #10 request.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_providertype"><strong>ProviderType</strong></a> property on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey"><strong>IX509PrivateKey</strong></a> object retrieved from step 4.</li>
</ol>
<h2>HashAlgID</h2>
<p>The <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_hashalgid"><strong>HashAlgID</strong></a> function in Xenroll.dll retrieves an integer value that contains the ID of the algorithm used to sign a request.</p>
<p>When using CertEnroll.dll, you can perform the following actions to retrieve the hashing algorithm:</p>
<ul>
<li>Retrieve an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509signatureinformation"><strong>IX509SignatureInformation</strong></a> interface by calling the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_signatureinformation"><strong>SignatureInformation</strong></a> property on a PKCS #10 or CMC request or the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-get_signercertificate"><strong>SignerCertificate</strong></a> property on a <a href="/windows/desktop/SecGloss/p-gly"><em>PKCS #7</em></a> request.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509signatureinformation-get_hashalgorithm"><strong>HashAlgorithm</strong></a> property on the signature information object to retrieve the hash algorithm object identifier.</li>
</ul>
<h2>HashAlgorithmWStr</h2>
<p>The <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_hashalgorithmwstr"><strong>HashAlgorithmWStr</strong></a> function in Xenroll.dll specifies or retrieves a string value that identifies the hashing algorithm used to sign a request.</p>
<p>When using CertEnroll.dll, you can perform the following actions to retrieve the hashing algorithm:</p>
<ul>
<li>Retrieve an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509signatureinformation"><strong>IX509SignatureInformation</strong></a> interface by calling the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_signatureinformation"><strong>SignatureInformation</strong></a> property on a PKCS #10 or CMC request or the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-get_signercertificate"><strong>SignerCertificate</strong></a> property on a PKCS #7 request.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509signatureinformation-get_hashalgorithm"><strong>HashAlgorithm</strong></a> property on the signature information object to retrieve the hash algorithm object identifier.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-iobjectid-get_friendlyname"><strong>FriendlyName</strong></a> property on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-iobjectid"><strong>IObjectId</strong></a> interface returned in step 2 to retrieve the algorithm display name.</li>
</ul>
<h2>ProviderFlags</h2>
<p>The <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_providerflags"><strong>ProviderFlags</strong></a> function in Xenroll.dll specifies or retrieves the flags used when acquiring a handle to a CSP.</p>
<p>The CertEnroll.dll library does not map this function perfectly, but you can obtain rich property information from the enrollment object and the <a href="/windows/desktop/SecGloss/p-gly"><em>private key</em></a>. For more information, examine the properties exposed by the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> and <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey"><strong>IX509PrivateKey</strong></a> interfaces.</p>
<h2>ProviderNameWStr</h2>
<p>The <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_providernamewstr"><strong>ProviderNameWStr</strong></a> function in Xenroll.dll specifies or retrieves the name of a CSP.</p>
<p>When using CertEnroll.dll, you can perform the following actions to retrieve the provider name:</p>
<ol>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request"><strong>Request</strong></a> property on an existing <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> object.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest"><strong>GetInnerRequest</strong></a> method on the request returned from step 1 to retrieve the innermost request.</li>
<li>Call <strong>QueryInterface</strong> on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest"><strong>IX509CertificateRequest</strong></a> object returned from step 2 to cast to an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10"><strong>IX509CertificateRequestPkcs10</strong></a> object.</li>
<li>Call the <a href="/windows/desktop/SecCrypto/privatekey"><strong>PrivateKey</strong></a> property on the PKCS #10 request.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_providername"><strong>ProviderName</strong></a> property on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey"><strong>IX509PrivateKey</strong></a> object retrieved from step 4.</li>
</ol>
<h2>ProviderType</h2>
<p>The <a href="/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_providertype"><strong>ProviderType</strong></a> function in Xenroll.dll specifies or retrieves an integer value that identifies the type of the CSP.</p>
<p>When using CertEnroll.dll, you can perform the following actions to retrieve the provider type:</p>
<ol>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request"><strong>Request</strong></a> property on an existing <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> object.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest"><strong>GetInnerRequest</strong></a> method on the request returned from step 1 to retrieve the innermost request.</li>
<li>Call <strong>QueryInterface</strong> on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest"><strong>IX509CertificateRequest</strong></a> object returned from step 2 to cast to an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10"><strong>IX509CertificateRequestPkcs10</strong></a> object.</li>
<li>Call the <a href="/windows/desktop/SecCrypto/privatekey"><strong>PrivateKey</strong></a> property on the PKCS #10 request.</li>
<li>Call the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_providertype"><strong>ProviderType</strong></a> property on the <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey"><strong>IX509PrivateKey</strong></a> object retrieved from step 4.</li>
</ol>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="mapping-xenroll-dll-to-certenroll-dll.html">Mapping Xenroll.dll to CertEnroll.dll</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/CertEnroll/nn-certenroll-icspalgorithm"><strong>ICspAlgorithm</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/CertEnroll/nn-certenroll-icspalgorithms"><strong>ICspAlgorithms</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/CertEnroll/nn-certenroll-icspinformation"><strong>ICspInformation</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/CertEnroll/nn-certenroll-icspinformations"><strong>ICspInformations</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey"><strong>IX509PrivateKey</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
