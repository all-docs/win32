<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>enrollRenewalPKCS7</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Creates a PKCS #7 request object to renew an existing certificate. The request object uses a new key pair but retains the cryptographic provider associated with the certificate being renewed.
ms.assetid: 12a3f1b4-b31e-470e-8ce6-87f497841240
title: enrollRenewalPKCS7
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>enrollRenewalPKCS7</h1>
<p>The enrollRenewalPKCS7 sample creates a PKCS #7 request object to renew an existing certificate. The request object uses a new key pair but retains the cryptographic provider associated with the certificate being renewed.</p>
<h2>Location</h2>
<p>When you install the Microsoft Windows Software Development Kit (SDK), the sample is installed, by default, in the <em>%ProgramFiles%</em>\Microsoft SDKs\Windows\v7.0\Samples\Security\X509 Certificate Enrollment\VC\enrollRenewalPKCS7 folder.</p>
<h2>Discussion</h2>
<p>The enrollRenewalPKCS7 sample:</p>
<ol>
<li>Processes the command line arguments. The command line should contain the name of the template used to create the certificate request.</li>
<li>Retrieves an existing certificate by using the name of the template specified on the command line or, if a certificate cannot be found, attempts to enroll one by using the template. The findCertByTemplate and enrollCertByTemplate functions are defined in enrollCommon.cpp.</li>
<li>Verifies the certificate chain and converts the certificate to a <strong>BSTR</strong>.</li>
<li>Creates an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs7"><strong>IX509CertificateRequestPkcs7</strong></a> object and initializes it by using the existing certificate. Because the <em>inheritOptions</em> parameter is set to InheritDefault, a new key pair is created for the request but the cryptographic provider in the existing certificate is used. For more information, see the <a href="/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-initializefromcertificate"><strong>InitializeFromCertificate</strong></a> method.</li>
<li>Creates an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> object, initializes it by using the PKCS #7 request object, attempts to enroll it with the CA and monitors the status of the enrollment process. The checkEnrollStatus function is defined in enrollCommon.cpp.</li>
</ol>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="cmc-request.html">CMC Request</a></p>
<!-- raw HTML omitted -->
<p><a href="pkcs--7--renewal-request.html">PKCS #7 Renewal Request</a></p>
<!-- raw HTML omitted -->
<p><a href="using-the-included-samples.html">Using the Included Samples</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
