<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>enrollCustomPKCS10_2</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Creates a custom PKCS #10 request and attempts to enroll it in an enterprise certification authority (CA).
ms.assetid: ACBD3CE1-6A2A-47EE-9482-7398ABE15F5C
title: enrollCustomPKCS10_2
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>enrollCustomPKCS10_2</h1>
<p>The enrollCustomPKCS10_2 sample creates a custom PKCS #10 request and attempts to enroll it in an enterprise <a href="/windows/desktop/SecGloss/c-gly"><em>certification authority</em></a> (CA).</p>
<h2>Location</h2>
<p>When you install the Microsoft Windows Software Development Kit (SDK), the sample is installed by default in the <em>%ProgramFiles%</em>\Microsoft SDKs\Windows\v7.0\Samples\Security\X509 Certificate Enrollment\VC\enrollCustomPKCS10_2 folder.</p>
<h2>Discussion</h2>
<p>The enrollCustomPKCS10_2 sample:</p>
<ol>
<li>Processes the command line arguments. The command line should contain the name of a template and the name of a cryptographic provider.</li>
<li>Creates an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment"><strong>IX509Enrollment</strong></a> object and initializes it by using the name of the template specified on the command line.</li>
<li>Retrieves the <a href="/windows/desktop/SecGloss/c-gly"><em>certificate request</em></a> from the enrollment object.</li>
<li>Retrieves the innermost PKCS#10 request from the certificate request object obtained in step 3.</li>
<li>Retrieves a <a href="/windows/desktop/SecGloss/p-gly"><em>private key</em></a> from the PKCS#10 request.</li>
<li>Creates an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-icspinformations"><strong>ICspInformations</strong></a> collection and adds the available cryptographic providers to the collection and then retrieves an <a href="/windows/desktop/api/CertEnroll/nn-certenroll-icspstatus"><strong>ICspStatus</strong></a> object for the provider specified on the command line.</li>
<li>Sets the status object on the private key.</li>
<li>Attempts to enroll the <a href="/windows/desktop/SecGloss/c-gly"><em>certificate request</em></a>.</li>
</ol>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="pkcs--10-request.html">PKCS #10 Request</a></p>
<!-- raw HTML omitted -->
<p><a href="using-the-included-samples.html">Using the Included Samples</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
