<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ORCreateKey function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Creates the specified registry key in an offline registry hive. If the key already exists, the function opens it.
ms.assetid: 40e7468d-e781-4945-9023-580c06088b87
title: ORCreateKey function (Offreg.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>ORCreateKey
api_type:</li>
<li>DllExport
api_location:</li>
<li>Offreg.dll</li>
</ul>
<hr />
<h1>ORCreateKey function</h1>
<p>Creates the specified registry key in an offline registry hive. If the key already exists, the function opens it.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>DWORD ORCreateKey(
  _In_Â Â Â Â Â Â ORHKEY Â Â Â Â Â Â Â Â Â Â Â Â Â Â Handle,
  _In_Â Â Â Â Â Â PCWSTR Â Â Â Â Â Â Â Â Â Â Â Â Â Â lpSubKey,
  _In_opt_Â Â PWSTR Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lpClass,
  _In_opt_Â Â DWORD Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â dwOptions,
  _In_opt_Â Â PSECURITY_DESCRIPTOR pSecurityDescriptor,
  _Out_Â Â Â Â Â PORHKEY Â Â Â Â Â Â Â Â Â Â Â Â Â phkResult,
  _Out_opt_Â PDWORD Â Â Â Â Â Â Â Â Â Â Â Â Â Â pdwDisposition
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Handle</em> [in]</p>
<!-- raw HTML omitted -->
<p>A handle to an open registry key in an offline registry hive.</p>
<!-- raw HTML omitted -->
<p><em>lpSubKey</em> [in]</p>
<!-- raw HTML omitted -->
<p>A pointer to a Unicode string that contains the name of a subkey that this function opens or creates. The <em>lpSubKey</em> parameter must specify a subkey of the key identified by the <em>Handle</em> parameter; it can be up to 32 levels deep in the registry tree. For more information about key names, see <a href="../sysinfo/structure-of-the-registry.html">Structure of the Registry</a>.</p>
<p>This parameter cannot be <strong>NULL</strong>.</p>
<p>Key names are not case sensitive.</p>
<!-- raw HTML omitted -->
<p><em>lpClass</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The class (object type) of this key. This parameter may be ignored. This parameter can be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>dwOptions</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>This parameter can be 0 or one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>REG_OPTION_CREATE_LINK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000002L<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The key is a symbolic link. The target path is assigned to the L&quot;SymbolicLinkValue&quot; value of the key. The target path must be an absolute registry path. If this option is set, <strong>REG_OPTION_NON_VOLATILE</strong> must also be set. <!-- raw HTML omitted --> If the <em>lpSubKey</em> parameter specifies an existing key, it must have been created with <strong>REG_OPTION_CREATE_LINK</strong>.<!-- raw HTML omitted --> Registry symbolic links should be used only when absolutely necessary for application compatibility. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>REG_OPTION_NON_VOLATILE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000000L<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The key is not volatile; this is the default. The information is stored in a file and is preserved when the system is restarted. The <a href="orsavehive.html"><strong>ORSaveHive</strong></a> function saves keys that are not volatile.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>pSecurityDescriptor</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a <a href="/windows/win32/api/winnt/ns-winnt-security_descriptor">SECURITY_DESCRIPTOR</a> structure that contains a security descriptor for the new key. If <em>pSecurityDescriptor</em> is <strong>NULL</strong>, the key gets a default security descriptor. The ACLs in a default security descriptor for a key are inherited from its direct parent key.</p>
<!-- raw HTML omitted -->
<p><em>phkResult</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives a handle to the opened or created key. Use the <a href="orclosekey.html"><strong>ORCloseKey</strong></a> function to close the key after you have finished using the handle.</p>
<!-- raw HTML omitted -->
<p><em>pdwDisposition</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives one of the following disposition values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>REG_CREATED_NEW_KEY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000001L<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The key did not exist and was created.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>REG_OPENED_EXISTING_KEY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000002L<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The key existed and was simply opened without being changed.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>If <em>pdwDisposition</em> is <strong>NULL</strong>, no disposition information is returned.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, the return value is ERROR_SUCCESS.</p>
<p>If the function fails, the return value is a nonzero error code defined in Winerror.h. You can use the <a href="/windows/win32/api/winbase/nf-winbase-formatmessage">FormatMessage</a> function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</p>
<p>If the <em>dwOptions</em> parameter is set with <strong>REG_OPTION_CREATE_LINK</strong> but <strong>REG_OPTION_NON_VOLATILE</strong> is clear, or if the handle to be returned would be a handle to the root key of the hive, the function returns ERROR_INVALID_PARAMETER.</p>
<h2>Remarks</h2>
<p>The key that the <strong>ORCreateKey</strong> function creates has no values. An application can use the <a href="orsetvalue.html"><strong>ORSetValue</strong></a> function to set key values.</p>
<p>The <strong>ORCreateKey</strong> function cannot be used to create the root key in an offline registry hive. Use the <a href="orcreatehive.html"><strong>ORCreateHive</strong></a> function to create the root key and obtain a handle to the key.</p>
<p>The offline registry does not support saving individual keys. Use the <a href="orsavehive.html"><strong>ORSaveHive</strong></a> function to save a key and its subkeys in a hive.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>Windows Offline Registry library version 1.0 or later<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Offreg.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Offreg.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="orclosekey.html"><strong>ORCloseKey</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="orcreatehive.html"><strong>ORCreateHive</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="ordeletekey.html"><strong>ORDeleteKey</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="orsavehive.html"><strong>ORSaveHive</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/winnt/ns-winnt-security_descriptor">SECURITY_DESCRIPTOR</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
