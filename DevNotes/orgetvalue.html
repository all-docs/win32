<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ORGetValue function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Retrieves the type and data for the specified registry value in an offline registry hive.
ms.assetid: 83604743-cb59-42a1-9951-620ad5bd8de7
title: ORGetValue function (Offreg.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>ORGetValue
api_type:</li>
<li>DllExport
api_location:</li>
<li>Offreg.dll</li>
</ul>
<hr />
<h1>ORGetValue function</h1>
<p>Retrieves the type and data for the specified registry value in an offline registry hive.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>DWORD ORGetValue(
  _In_Â Â Â Â Â Â Â Â ORHKEY Handle,
  _In_opt_Â Â Â Â PCWSTR lpSubKey,
  _In_opt_Â Â Â Â PCWSTR lpValue,
  _Out_opt_Â Â Â PDWORD pdwType,
  _Out_opt_Â Â Â PVOID Â pvData,
  _Inout_opt_Â PDWORD pcbData
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Handle</em> [in]</p>
<!-- raw HTML omitted -->
<p>A handle to an open registry key in an offline registry hive.</p>
<!-- raw HTML omitted -->
<p><em>lpSubKey</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The name of the registry key. This key must be a subkey of the key specified by the <em>Handle</em> parameter. This parameter can be <strong>NULL</strong>.</p>
<p>Key names are not case sensitive.</p>
<!-- raw HTML omitted -->
<p><em>lpValue</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The name of the registry value. If this parameter is <strong>NULL</strong> or an empty string, &quot;&quot;, the function retrieves the type and data for the key's unnamed or default value, if any. For more information, see <a href="../sysinfo/registry-element-size-limits.html">Registry Element Size Limits</a>.</p>
<p>Keys do not automatically have an unnamed or default value. Unnamed values can be of any type.</p>
<p>Value names are not case sensitive.</p>
<!-- raw HTML omitted -->
<p><em>pdwType</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives a code indicating the type of data stored in the specified value. For a list of the possible type codes, see <a href="../sysinfo/registry-value-types.html">Registry Value Types</a>. This parameter can be <strong>NULL</strong> if the type is not required.</p>
<!-- raw HTML omitted -->
<p><em>pvData</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a buffer that receives the value's data. This parameter can be <strong>NULL</strong> if the data is not required.</p>
<p>If the data is a string, the function checks for a terminating null character. If one is not found, the string is stored with a null terminator if the buffer is large enough to accommodate the extra character. Otherwise, the function fails and returns ERROR_MORE_DATA.</p>
<!-- raw HTML omitted -->
<p><em>pcbData</em> [in, out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that specifies the size of the buffer pointed to by the <em>pvData</em> parameter, in bytes. When the function returns, this variable contains the size of the data copied to <em>pvData</em>.</p>
<p>The <em>pcbData</em> parameter can be <strong>NULL</strong> only if <em>pvData</em> is <strong>NULL</strong>.</p>
<p>If the data has the REG_SZ, REG_MULTI_SZ or REG_EXPAND_SZ type, this size includes any terminating null character or characters. For more information, see Remarks.</p>
<p>If the buffer specified by <em>pvData</em> parameter is not large enough to hold the data, the function returns ERROR_MORE_DATA and stores the required buffer size in the variable pointed to by <em>pcbData</em>. In this case, the contents of the <em>pvData</em> buffer are undefined.</p>
<p>If <em>pvData</em> is <strong>NULL</strong>, and <em>pcbData</em> is non-<strong>NULL</strong>, the function returns ERROR_SUCCESS and stores the size of the data, in bytes, in the variable pointed to by <em>pcbData</em>. This enables an application to determine the best way to allocate a buffer for the value's data.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, the return value is ERROR_SUCCESS.</p>
<p>If the function fails, the return value is a nonzero error code defined in Winerror.h. You can use the <a href="/windows/win32/api/winbase/nf-winbase-formatmessage">FormatMessage</a> function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</p>
<h2>Remarks</h2>
<p>An application typically calls the <a href="orenumvalue.html"><strong>OREnumValue</strong></a> function to determine the value names and then calls the <strong>ORGetValue</strong> function to retrieve the data for the names.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>Windows Offline Registry library version 1.0 or later<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Offreg.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Offreg.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="orcreatekey.html"><strong>ORCreateKey</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="orenumkey.html"><strong>OREnumKey</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="orenumvalue.html"><strong>OREnumValue</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="oropenkey.html"><strong>OROpenKey</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="orqueryinfokey.html"><strong>ORQueryInfoKey</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
