<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ORSetVirtualFlags function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Sets virtualization flags on the specified open registry key in an offline registry hive.
ms.assetid: c625af35-8e14-4379-8d0a-6f5b65a1aebb
title: ORSetVirtualFlags function (Offreg.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>ORSetVirtualFlags
api_type:</li>
<li>DllExport
api_location:</li>
<li>Offreg.dll</li>
</ul>
<hr />
<h1>ORSetVirtualFlags function</h1>
<p>Sets virtualization flags on the specified open registry key in an offline registry hive.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>DWORD ORSetVirtualFlags(
  _In_Â ORHKEY Handle,
  _In_Â DWORD Â dwFlags
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Handle</em> [in]</p>
<!-- raw HTML omitted -->
<p>A handle to an open registry key in an offline registry hive.</p>
<!-- raw HTML omitted -->
<p><em>dwFlags</em> [in]</p>
<!-- raw HTML omitted -->
<p>This parameter controls the behavior of the registry when a Create or Open operation fails on a key in a virtualized hive. This parameter can be one or more of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>REG_KEY_DONT_SILENT_FAIL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->4<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set and an Open operation fails on a key for which virtualization is enabled, the registry does not attempt to reopen the key. If this flag is clear, the registry attempts to reopen the key with the MAXIMUM_ALLOWED access.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>REG_KEY_DONT_VIRTUALIZE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set and a Create Key operation fails because the caller does not have the KEY_CREATE_SUB_KEY right on the parent key, the registry fails the Create operation. If this flag is clear, the registry attempts to create the key in the virtual store. The caller must have the KEY_READ right on the parent key.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>REG_KEY_RECURSE_FLAG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->8<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set, registry virtualization flags are propagated from the parent key. If this flag is clear, registry virtualization flags are not propagated.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, the return value is ERROR_SUCCESS.</p>
<p>If the function fails, the return value is a nonzero error code defined in Winerror.h. You can use the <a href="/windows/win32/api/winbase/nf-winbase-formatmessage">FormatMessage</a> function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</p>
<h2>Remarks</h2>
<p>Registry virtualization is an interim application compatibility technology that enables registry write operations that have global impact to be redirected to per-user locations. This redirection is transparent to applications reading from or writing to the registry.</p>
<p>Registry virtualization is supported starting with WindowsÂ Vista. However, Microsoft intends to remove it from future versions of the Windows operating system as more applications are made compatible with WindowsÂ Vista. Therefore, applications should not depend on the behavior of registry virtualization in the system.</p>
<p>Registry virtualization is enabled only for the following:</p>
<ul>
<li>32-bit interactive processes</li>
<li>Keys in <strong>HKEY_LOCAL_MACHINE\Software</strong></li>
<li>Keys that an administrator can write to</li>
</ul>
<p>For more information, see <a href="../sysinfo/registry-virtualization.html">Registry Virtualization</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>Windows Offline Registry library version 1.0 or later<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Offreg.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Offreg.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="orgetvirtualflags.html"><strong>ORGetVirtualFlags</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="../sysinfo/registry-virtualization.html">Registry Virtualization</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
