<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>NtOpenDirectoryObject function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Opens an existing directory object.
ms.assetid: 7313fb32-976b-4c73-b9ba-09fb8ad7faf1
title: NtOpenDirectoryObject function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>NtOpenDirectoryObject
api_type:</li>
<li>DllExport
api_location:</li>
<li>Ntdll.dll</li>
</ul>
<hr />
<h1>NtOpenDirectoryObject function</h1>
<p>[This function may be altered or unavailable in the future.]</p>
<p>Opens an existing directory object.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>NTSTATUS WINAPI NtOpenDirectoryObject(
  _Out_Â PHANDLE Â Â Â Â Â Â Â Â Â Â Â DirectoryHandle,
  _In_Â Â ACCESS_MASK Â Â Â Â Â Â Â DesiredAccess,
  _In_Â Â POBJECT_ATTRIBUTES ObjectAttributes
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>DirectoryHandle</em> [out]</p>
<!-- raw HTML omitted -->
<p>A handle to the newly opened directory object.</p>
<!-- raw HTML omitted -->
<p><em>DesiredAccess</em> [in]</p>
<!-- raw HTML omitted -->
<p>An <a href="../secauthz/access-mask.html"><strong>ACCESS_MASK</strong></a> that specifies the requested access to the directory object. This parameter can be one or more of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DIRECTORY_QUERY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0001<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Query access to the directory object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DIRECTORY_TRAVERSE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0002<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Name-lookup access to the directory object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DIRECTORY_CREATE_OBJECT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0004<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Name-creation access to the directory object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DIRECTORY_CREATE_SUBDIRECTORY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0008<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Subdirectory-creation access to the directory object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DIRECTORY_ALL_ACCESS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->STANDARD_RIGHTS_REQUIRED | 0xF<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>All of the preceding rights plus <strong>STANDARD_RIGHTS_REQUIRED</strong>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>ObjectAttributes</em> [in]</p>
<!-- raw HTML omitted -->
<p>The attributes for the directory object. To initialize the <strong>OBJECT_ATTRIBUTES</strong> structure, use the <strong>InitializeObjectAttributes</strong> macro. For more information, see the documentation for these items in the documentation for the WDK.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>The function returns STATUS_SUCCESS or an error status. The possible status codes include the following.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>STATUS_INSUFFICIENT_RESOURCES</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A temporary buffer required by this function could not be allocated.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>STATUS_INVALID_PARAMETER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The specified ObjectAttributes parameter was a <strong>NULL</strong> pointer, not a valid pointer to an <strong>OBJECT_ATTRIBUTES</strong> structure, or some of the members specified in the <strong>OBJECT_ATTRIBUTES</strong> structure were not valid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>STATUS_OBJECT_NAME_INVALID</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>ObjectAttributes</em> parameter contained an <strong>ObjectName</strong> member in the <strong>OBJECT_ATTRIBUTES</strong> structure that was not valid because an empty string was found after the <strong>OBJECT_NAME_PATH_SEPARATOR</strong> character.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>STATUS_OBJECT_NAME_NOT_FOUND</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>ObjectAttributes</em> parameter contained an <strong>ObjectName</strong> member in the <strong>OBJECT_ATTRIBUTES</strong> structure that could not be found.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>STATUS_OBJECT_PATH_NOT_FOUND</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>ObjectAttributes</em> parameter contained an <strong>ObjectName</strong> member in the <strong>OBJECT_ATTRIBUTES</strong> structure with an object path that could not be found. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>STATUS_OBJECT_PATH_SYNTAX_BAD</strong> <!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>ObjectAttributes</em> parameter did not contain a <strong>RootDirectory</strong> member, but the <strong>ObjectName</strong> member in the <strong>OBJECT_ATTRIBUTES</strong> structure was an empty string or did not contain an <strong>OBJECT_NAME_PATH_SEPARATOR</strong> character. This indicates incorrect syntax for the object path.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>This function has no associated import library or header file; you must call it using the <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya"><strong>LoadLibrary</strong></a> and <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress"><strong>GetProcAddress</strong></a> functions.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Ntdll.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="ntquerydirectoryobject.html"><strong>NtQueryDirectoryObject</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
