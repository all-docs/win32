<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>VBAGetExprSrv</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: VBAGetExprSrv
description: Loads Visual Basic for Applications and retrieves a pointer to the IExpressionService object.
ms:assetid: ed23be8f-f18e-4098-84b8-81babd85d9d7
ms:mtpsurl: <a href="https://msdn.microsoft.com/en-US/library/Aa833132(v=VS.80)">https://msdn.microsoft.com/en-US/library/Aa833132(v=VS.80)</a>
ms.topic: reference
ms.date: 09/04/2009
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>VBAGetExprSrv
api_type:</li>
<li>DllExport
api_location:</li>
<li>vbajet32.dll</li>
</ul>
<hr />
<h1>VBAGetExprSrv</h1>
<p>Loads Visual Basic for Applications and retrieves a pointer to the IExpressionService object.</p>
<pre lang="cpp"><code>void VBAGetExprSrv(HINSTANCE FAR* lphinstVBA,
                    IExpressionService FAR* FAR* lplpexprsrv,
                    LPBYTE lpStackMin,
                    USHORT usMajVersionExprSrv,
                    USHORT usMinVersionExprSrv,
                    DWORD dwUnused1,
                    DWORD dwUnused2);
</code></pre>
<h2>Parameters</h2>
<ul>
<li>
<p>lphinstVBA<br />
The location where the instance handle to Visual Basic for Applications is stored.</p>
</li>
<li>
<p>lplpexprsrv<br />
The location where the expression service object pointer is to be stored.</p>
</li>
<li>
<p>lpStackMin<br />
The minimum stack location that Visual Basic for Applications can go to.</p>
</li>
<li>
<p>usMajVersionExprSrv<br />
Major version associated with the expression service DLL.</p>
</li>
<li>
<p>usMinVersionExprSrv<br />
Minor version associated with the expression service DLL.</p>
</li>
<li>
<p>dwUnused1<br />
This argument is reserved for future use.</p>
</li>
<li>
<p>dwUnused2<br />
This argument is reserved for future use.</p>
</li>
</ul>
<h2>Property Value/Return Value</h2>
<p>None. Use lphinstVBA and lplpexprsrv to determine whether VBAGetExprSrv succeeded, as indicated in the Remarks section below.</p>
<h2>Remarks</h2>
<p>This function is exported from vbajet32.dll.</p>
<p>VBAGetExprSrv calls LoadLibrary() to load the Visual Basic for Applications DLL based on the version numbers that are passed in. The handle returned by LoadLibrary() is stored in the location pointed to by lphinstVBA. If the call is successful, the caller must eventually call FreeLibrary() on this hinstance.</p>
<p>The expression service object pointer is undefined when lphinstVBA points to an invalid hinstance. The expression service object pointer is null if creating the expression service fails.</p>
<p>The value of lpStackMin does not affect the expression service. lpStackMin is required by the Visual Basic for Applications initialization code, and this value must be supplied by the caller.</p>
<h2>See Also</h2>
<h4>Other Resources</h4>
<p><a href="https://go.microsoft.com/fwlink/?linkid=71507">VBA Language References</a></p>
</body>
