<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>RtlGetUnloadEventTraceEx function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Retrieves the size and location of the dynamically unloaded module list for the current process.
ms.assetid: 53ac9a7f-aa4a-412d-a6f7-a3a73bede5c2
title: RtlGetUnloadEventTraceEx function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>RtlGetUnloadEventTraceEx
api_type:</li>
<li>DllExport
api_location:</li>
<li>Ntdll.dll</li>
</ul>
<hr />
<h1>RtlGetUnloadEventTraceEx function</h1>
<p>Retrieves the size and location of the dynamically unloaded module list for the current process.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>VOID WINAPI RtlGetUnloadEventTraceEx(
  _Out_Â PULONG *ElementSize,
  _Out_Â PULONG *ElementCount,
  _Out_Â PVOID Â *EventTrace
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>ElementSize</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that contains the size of an element in the list.</p>
<!-- raw HTML omitted -->
<p><em>ElementCount</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that contains the number of elements in the list.</p>
<!-- raw HTML omitted -->
<p><em>EventTrace</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to an array of <strong>RTL_UNLOAD_EVENT_TRACE</strong> structures. For more information, see Remarks.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This function does not return a value.</p>
<h2>Remarks</h2>
<p>The loader stores unloaded event information in locations that can be read across processes by taking advantage of the fact that Ntdll.dll is loaded at the same base address in all processes. When a debugger needs to query unloaded module information, it calls this function to determine the address at which the variables reside, then queries the virtual memory in the target process at those addresses to read the actual values.</p>
<p>Each element in the list is defined as follows.</p>
<pre lang="syntax"><code>typedef struct _RTL_UNLOAD_EVENT_TRACE {
    PVOID BaseAddress;   // Base address of dll
    SIZE_T SizeOfImage;  // Size of image
    ULONG Sequence;      // Sequence number for this event
    ULONG TimeDateStamp; // Time and date of image
    ULONG CheckSum;      // Image checksum
    WCHAR ImageName[32]; // Image name
} RTL_UNLOAD_EVENT_TRACE, *PRTL_UNLOAD_EVENT_TRACE;
</code></pre>
<p>This function has no associated header file. The associated import library, Ntdll.lib, is available in the Windows Driver Kit (WDK). You can also call this function using the <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya"><strong>LoadLibrary</strong></a> and <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress"><strong>GetProcAddress</strong></a> functions.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Ntdll.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
