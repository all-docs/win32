<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ORQueryInfoKey function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Retrieves information about the specified registry key in an offline registry hive.
ms.assetid: b565c55c-acc2-4880-91eb-7bd9188e4749
title: ORQueryInfoKey function (Offreg.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>ORQueryInfoKey
api_type:</li>
<li>DllExport
api_location:</li>
<li>Offreg.dll</li>
</ul>
<hr />
<h1>ORQueryInfoKey function</h1>
<p>Retrieves information about the specified registry key in an offline registry hive.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>DWORD ORQueryInfoKey(
  _In_Â Â Â Â Â Â Â Â ORHKEY Â Â Â Handle,
  _Out_opt_Â Â Â PWSTR Â Â Â Â lpClass,
  _Inout_opt_Â PDWORD Â Â Â lpcClass,
  _Out_opt_Â Â Â PDWORD Â Â Â lpcSubKeys,
  _Out_opt_Â Â Â PDWORD Â Â Â lpcMaxSubKeyLen,
  _Out_opt_Â Â Â PDWORD Â Â Â lpcMaxClassLen,
  _Out_opt_Â Â Â PDWORD Â Â Â lpcValues,
  _Out_opt_Â Â Â PDWORD Â Â Â lpcMaxValueNameLen,
  _Out_opt_Â Â Â PDWORD Â Â Â lpcMaxValueLen,
  _Out_opt_Â Â Â PDWORD Â Â Â lpcbSecurityDescriptor,
  _Out_opt_Â Â Â PFILETIME lpftLastWriteTime
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Handle</em> [in]</p>
<!-- raw HTML omitted -->
<p>A handle to an open registry key in an offline registry hive.</p>
<!-- raw HTML omitted -->
<p><em>lpClass</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a buffer that receives the key class. This parameter can be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpcClass</em> [in, out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that specifies the size of the buffer pointed to by the <em>lpClass</em> parameter, in characters.</p>
<p>The size should include the terminating null character. When the function returns, this variable contains the size of the class string that is stored in the buffer. The count returned does not include the terminating null character. If the buffer is not big enough, the function returns ERROR_MORE_DATA, and the variable contains the size of the string, in characters, without counting the terminating null character.</p>
<p>If <em>lpClass</em> is <strong>NULL</strong>, <em>lpcClass</em> can be <strong>NULL</strong>.</p>
<p>If the <em>lpClass</em> parameter is a valid address, but the <em>lpcClass</em> parameter is not (for example, if the <em>lpcClass</em> parameter is <strong>NULL</strong>) then the function returns ERROR_INVALID_PARAMETER.</p>
<!-- raw HTML omitted -->
<p><em>lpcSubKeys</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives the number of subkeys that are contained by the specified key. This parameter can be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpcMaxSubKeyLen</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives the size of the key's subkey with the longest name, in Unicode characters, not including the terminating null character. This parameter can be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpcMaxClassLen</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives the size of the longest string that specifies a subkey class, in Unicode characters. The count returned does not include the terminating null character. This parameter can be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpcValues</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives the number of values that are associated with the key. This parameter can be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpcMaxValueNameLen</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives the size of the key's longest value name, in Unicode characters. The size does not include the terminating null character. This parameter can be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpcMaxValueLen</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives the size of the longest data component among the key's values, in bytes. This parameter can be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpcbSecurityDescriptor</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives the size of the key's security descriptor, in bytes. This parameter can be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpftLastWriteTime</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a <a href="/windows/win32/api/minwinbase/ns-minwinbase-filetime">FILETIME</a> structure that receives the last write time. This parameter can be <strong>NULL</strong>.</p>
<p>The function sets the members of the <a href="/windows/win32/api/minwinbase/ns-minwinbase-filetime">FILETIME</a> structure to indicate the last time that the key or any of its value entries is modified.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, the return value is ERROR_SUCCESS.</p>
<p>If the function fails, the return value is a nonzero error code defined in Winerror.h. You can use the <a href="/windows/win32/api/winbase/nf-winbase-formatmessage">FormatMessage</a> function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</p>
<p>If the <em>lpClass</em> buffer is too small to receive the name of the class, the function returns ERROR_MORE_DATA.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>Windows Offline Registry library version 1.0 or later<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Offreg.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Offreg.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/minwinbase/ns-minwinbase-filetime">FILETIME</a></p>
<!-- raw HTML omitted -->
<p><a href="orcreatekey.html"><strong>ORCreateKey</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="oropenkey.html"><strong>OROpenKey</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="ordeletekey.html"><strong>ORDeleteKey</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
