<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ORSetValue function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Sets the data for the value of a specified registry key in an offline registry hive.
ms.assetid: 62fd3a3a-6ce3-4313-b0e7-37ceea0ce302
title: ORSetValue function (Offreg.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>ORSetValue
api_type:</li>
<li>DllExport
api_location:</li>
<li>Offreg.dll</li>
</ul>
<hr />
<h1>ORSetValue function</h1>
<p>Sets the data for the value of a specified registry key in an offline registry hive.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>DWORD ORSetValue(
  _In_Â Â Â Â Â ORHKEY Handle,
  _In_opt_Â PCWSTR lpValueName,
  _In_Â Â Â Â Â DWORD Â dwType,
  _In_opt_Â const BYTEÂ *lpData,
  _In_Â Â Â Â Â DWORD Â cbData
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Handle</em> [in]</p>
<!-- raw HTML omitted -->
<p>A handle to an open registry key in an offline registry hive.</p>
<!-- raw HTML omitted -->
<p><em>lpValueName</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The name of the value to be set. If a value with this name is not already present in the key, the function adds it to the key.</p>
<p>If <em>lpValueName</em> is <strong>NULL</strong> or an empty string, &quot;&quot;, the function sets the type and data for the key's unnamed or default value.</p>
<p>For more information, see <a href="../sysinfo/registry-element-size-limits.html">Registry Element Size Limits</a>.</p>
<p>Registry keys do not have default values, but they can have one unnamed value, which can be of any type.</p>
<!-- raw HTML omitted -->
<p><em>dwType</em> [in]</p>
<!-- raw HTML omitted -->
<p>The type of data pointed to by the <em>lpData</em> parameter. For a list of the possible types, see <a href="../sysinfo/registry-value-types.html">Registry Value Types</a>.</p>
<!-- raw HTML omitted -->
<p><em>lpData</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The data to be stored.</p>
<p>For string-based types, such as REG_SZ, the string must be null-terminated. For the REG_MULTI_SZ data type, the string must be terminated with two null characters.</p>
<!-- raw HTML omitted -->
<p><em>cbData</em> [in]</p>
<!-- raw HTML omitted -->
<p>The size of the information pointed to by the <em>lpData</em> parameter, in bytes. If the data is of type REG_SZ, REG_EXPAND_SZ, or REG_MULTI_SZ, <em>cbData</em> must include the size of the terminating null character or characters.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, the return value is ERROR_SUCCESS.</p>
<p>If the function fails, the return value is a nonzero error code defined in Winerror.h. You can use the <a href="/windows/win32/api/winbase/nf-winbase-formatmessage">FormatMessage</a> function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</p>
<h2>Remarks</h2>
<p>Value sizes are limited by available memory. Long values (more than 2048 bytes) should be stored as files with the file names stored in the registry. This helps the registry perform efficiently. Application elements such as icons, bitmaps, and executable files should be stored as files and not be placed in the registry.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>Windows Offline Registry library version 1.0 or later<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Offreg.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Offreg.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="orcreatekey.html"><strong>ORCreateKey</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="oropenkey.html"><strong>OROpenKey</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
