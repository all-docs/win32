<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>RtlDisownModuleHeapAllocation function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: RtlDisownModuleHeapAllocation function
description: Removes an allocation from tracking by Application Verifier so that it isn't flagged as a leak when the module that allocated the memory is unloaded.
ms.topic: reference
ms.date: 03/13/2022
req.lib: Ntdll.lib
req.dll: Ntdll.dll
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_type:</li>
<li>DllExport
api_location:</li>
<li>Ntdll.dll
api_name:</li>
<li>RtlDisownModuleHeapAllocation
targetos: Windows</li>
</ul>
<hr />
<h1>RtlDisownModuleHeapAllocation function</h1>
<p>Removes an allocation from tracking by Application Verifier so that it isn't flagged as a leak when the module that allocated the memory is unloaded.</p>
<h2>Syntax</h2>
<pre lang="cpp"><code>NTSTATUS WINAPI RtlDisownModuleHeapAllocation(
  _In_ HANDLE HeapHandle,
  _In_ PVOID Allocation
);
</code></pre>
<h2>Parameters</h2>
<p><code>HeapHandle</code></p>
<p>Type: <strong><a href="../../winprog/windows-data-types.html">HANDLE</a></strong></p>
<p>The heap handle where the allocation is made.</p>
<p><code>Allocation</code></p>
<p>Type: <strong><a href="../../winprog/windows-data-types.html">PVOID</a></strong></p>
<p>A pointer to the memory allocation to be ignored by Application Verifier leak tracking.</p>
<h2>Return value</h2>
<p>Returns <strong>STATUS_SUCCESS</strong>.</p>
<h2>Remarks</h2>
<p><strong>RtlDisownModuleHeapAllocation</strong> is provided so that Application Verifier can expect that an allocation might outlive the module that allocated it. In that case, Application Verifier can remove the allocation from its internal tracking so that it isn't flagged as a leak when the module that made the allocation is unloaded. This function is a no-op when Application Verifier isn't enabled.</p>
<p><strong>RtlDisownModuleHeapAllocation</strong> isn't associated with a header file. But the associated import library, <code>Ntdll.lib</code>, is available in the Windows Driver Kit (WDK). You can also call <strong>RtlDisownModuleHeapAllocation</strong> by first using the <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibraryw"><strong>LoadLibrary</strong></a> function (to load <code>Ntdll.dll</code>), and then by calling the <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress"><strong>GetProcAddress</strong></a> function to retrieve the address of <strong>RtlDisownModuleHeapAllocation</strong>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th> </th>
<th align="left"> </th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Target Platform</strong></td>
<td align="left">Windows</td>
</tr>
<tr>
<td><strong>Header</strong></td>
<td align="left">N/A</td>
</tr>
<tr>
<td><strong>Library</strong></td>
<td align="left">Ntdll.lib in the Windows Driver Kit (WDK)</td>
</tr>
<tr>
<td><strong>DLL</strong></td>
<td align="left">Ntdll.dll</td>
</tr>
</tbody>
</table>
</body>
