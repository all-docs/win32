<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>InstallComponentW function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Installs an exception package.
ms.assetid: c4c3c01c-9aaf-42cd-a690-13e2113b15b3
title: InstallComponentW function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>InstallComponentW
api_type:</li>
<li>DllExport
api_location:</li>
<li>Msoobci.dll</li>
</ul>
<hr />
<h1>InstallComponentW function</h1>
<p>Installs an exception package.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>void InstallComponentW(
  _In_Â Â Â Â Â Â Â Â Â Â Â LPCWSTR InfPath,
  _In_opt_Â const GUID Â Â Â *CompGuid,
  _In_Â Â Â Â Â Â Â Â Â Â Â DWORD Â Â Flags,
  _In_opt_Â Â Â Â Â Â Â INT Â Â Â Â VerMajor,
  _In_opt_Â Â Â Â Â Â Â INT Â Â Â Â VerMinor,
  _In_opt_Â Â Â Â Â Â Â INT Â Â Â Â VerBuild,
  _In_opt_Â Â Â Â Â Â Â INT Â Â Â Â VerQFE,
  _In_opt_Â Â Â Â Â Â Â LPCWSTR Name
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>InfPath</em> [in]</p>
<!-- raw HTML omitted -->
<p>The path to the exception INF to process.</p>
<!-- raw HTML omitted -->
<p><em>CompGuid</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The GUID of the exception component being installed.</p>
<!-- raw HTML omitted -->
<p><em>Flags</em> [in]</p>
<!-- raw HTML omitted -->
<p>The flags used to control installation behaviors. This parameter can be a combination of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>COMP_FLAGS_FORCE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000020<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Skips the version check on file replacements.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>COMP_FLAGS_NEEDS_UNINSTALL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Back up files that are updated to be used by an uninstall of the component.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>COMP_FLAGS_NO_OVERWRITE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Skips backing up files if the Exception component version is the same as an installed component. This flag is used in a reinstallation scenario.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>COMP_FLAGS_NOUI</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000002<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Suppresses all UI.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>COMP_FLAGS_UPDATE_DLLCACHE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Forces the DLLCACHE directory to be updated when a system file is updated.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>COMP_FLAGS_USE_SVCPACK_CACHE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Uses files cached by a Windows service pack install to supersede files backed up.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>VerMajor</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The major version of the Exception component.</p>
<!-- raw HTML omitted -->
<p><em>VerMinor</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The minor version of the Exception component.</p>
<!-- raw HTML omitted -->
<p><em>VerBuild</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The build version of the Exception component.</p>
<!-- raw HTML omitted -->
<p><em>VerQFE</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The hotfix revision of the Exception component.</p>
<!-- raw HTML omitted -->
<p><em>Name</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The descriptive string of the component shown by the Windows File Protection dialog box if the operating system detects that a Windows File Protection protect file is damaged, tampered with, or corrupted.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This function returns an <strong>HRESULT</strong> value (S_OK or a failure code). A failure code can be checked against a value of 0x20000100 to determine whether the failure is because a reboot is required.</p>
<h2>Remarks</h2>
<p>Exception packages are Windows system files that are released outside of a full package Windows release and that update operating-system files. Exception packages are authored only by operating-system teams that have been granted authorization to update Windows system files.</p>
<p>To install and uninstall files that are not protected by Windows File Protection, use the functions documented in <a href="https://msdn.microsoft.com/library/ms794585.aspx">General Setup Functions</a>. To install device drivers, venders should use functions documented in <a href="https://msdn.microsoft.com/library/ms792954.aspx">Device Installation Functions</a> and <a href="https://msdn.microsoft.com/library/ms790838.aspx">PnP Configuration Manager Functions</a>.</p>
<p>This function has no associated import library or header file; you must call it by using the <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya"><strong>LoadLibrary</strong></a> and <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress"><strong>GetProcAddress</strong></a> functions.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msoobci.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
