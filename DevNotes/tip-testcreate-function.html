<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TestCreate function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Returns a new test handle.
title: TestCreate function
ms.topic: reference
ms.date: 04/27/2023
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>TestCreate
api_type:</li>
<li>DllExport
api_location:</li>
<li>kernelbase.dll</li>
</ul>
<hr />
<h1>TestCreate function</h1>
<p>Returns a new test handle.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HANDLE TestCreate(
    unsigned int testCaseId,
    unsigned int options,
    unsigned char storage,          
    unsigned int  properties,  
    PCSTR data,                      
    _Out_ GUID* testId);
</code></pre>
<h2>Parameters</h2>
<h3>testCaseId</h3>
<p>The test identifier.</p>
<h3>options</h3>
<p>The test retrieval options. This parameter can be set to the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Default option.</td>
</tr>
<tr>
<td>1</td>
<td>Optimize retrieval with locking, like subsequently calling <a href="tip-testquerydata-function.html">TestQueryData</a>.</td>
</tr>
<tr>
<td>2</td>
<td>Deprecated, this is the same as default option.</td>
</tr>
<tr>
<td>131072</td>
<td>Indicates that additional â€œpropertiesâ€ field will be included in the <a href="tip-testinfo-structure.html">TestInfo</a> structure returned from <a href="tip-testopen-function.html">TestOpen</a>.</td>
</tr>
</tbody>
</table>
<h3>storage</h3>
<p>The test storage options. This parameter can be set to the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Data will be stored in process.</td>
</tr>
<tr>
<td>2</td>
<td>Data will be stored out of process.</td>
</tr>
</tbody>
</table>
<h3>properties</h3>
<p>The test properties. This parameter can be set to a combination of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Default properties.</td>
</tr>
<tr>
<td>1</td>
<td>The test data will not be removed from storage when no test handles exist.</td>
</tr>
<tr>
<td>2</td>
<td>Adds keyword bit 45 to failure ETW event once per process.</td>
</tr>
<tr>
<td>4</td>
<td>Adds keyword bit 46 to each failure ETW event.</td>
</tr>
<tr>
<td>8</td>
<td>Adds keyword bit 45 to success ETW event.</td>
</tr>
<tr>
<td>16</td>
<td>Adds keyword bit 46 to each success ETW event.</td>
</tr>
<tr>
<td>32</td>
<td>Sets test expiration to 24 hours.</td>
</tr>
<tr>
<td>64</td>
<td>Sets test expiration to 7 days.</td>
</tr>
<tr>
<td>128</td>
<td>Adds keyword bit 45 to failure ETW event.</td>
</tr>
<tr>
<td>256</td>
<td>Adds keyword bit 45 to success ETW event once per process.</td>
</tr>
<tr>
<td>512</td>
<td>Restricts ETW event property metricsBucket to 8 bits.</td>
</tr>
<tr>
<td>2048</td>
<td>Includes keyword bit 3 in ETW event.</td>
</tr>
<tr>
<td>4096</td>
<td>Includes keyword bit 2 in ETW event.</td>
</tr>
<tr>
<td>8192</td>
<td>Includes keyword bit 4 in ETW event.</td>
</tr>
</tbody>
</table>
<h3>data</h3>
<p>An arbitrary JSON string.</p>
<h3>testId [out]</h3>
<p>The identifier of the test instance.</p>
<h2>Return value</h2>
<p>The test handle.</p>
<h2>Remarks</h2>
<p>This function has no associated import library or header file; it must be invoked using the <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya"><strong>LoadLibrary</strong></a> and <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress"><strong>GetProcAddress</strong></a> functions.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client</td>
<td>Windows Build 22000</td>
</tr>
<tr>
<td>Minimum supported server</td>
<td>Windows Server 2022</td>
</tr>
<tr>
<td>Header</td>
<td>None</td>
</tr>
<tr>
<td>DLL</td>
<td>kernelbase.dll</td>
</tr>
</tbody>
</table>
</body>
