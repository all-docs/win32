<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CreateDeltaW function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Creates a delta between the source and target (provided as buffers) and returns the output delta as an MSDelta-allocated buffer. (CreateDeltaW)
title: CreateDeltaW function
ms.topic: reference
ms.date: 12/03/2020
ms.keywords: CreateDeltaW
req.header: msdelta.h
req.dll: msdelta.dll
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>CreateDeltaW
api_type:</li>
<li>DllExport
api_location:</li>
<li>msdelta.dll</li>
</ul>
<hr />
<h1>CreateDeltaW function</h1>
<p>Creates a delta between the source and target (provided as buffers) and returns the output delta as an MSDelta-allocated buffer.</p>
<blockquote>
<p>[!NOTE]
You must call <a href="msdelta-deltafree.html">DeltaFree</a> to free the output buffer after this function has completed.</p>
</blockquote>
<h2>Syntax</h2>
<pre lang="cpp"><code>BOOL  WINAPI  CreateDeltaW(
           DELTA_FILE_TYPE  FileTypeSet,
           DELTA_FLAG_TYPE  SetFlags,
           DELTA_FLAG_TYPE  ResetFlags,
           DELTA_INPUT      Source,
           DELTA_INPUT      Target,
           DELTA_INPUT      SourceOptions,
           DELTA_INPUT      TargetOptions,
           DELTA_INPUT      GlobalOptions,
    const  FILETIME        *lpTargetFileTime,
           ALG_ID           HashAlgId,
           LPDELTA_OUTPUT   lpDelta
    );
</code></pre>
<h2>Parameters</h2>
<p><em>FileTypeSet</em></p>
<p>[in] The <a href="/previous-versions/bb417345(v=msdn.10)#file-type-sets">DELTA_FILE_TYPE</a> value that indicates the file type set to be used for the create process.</p>
<p><em>SetFlags</em></p>
<p>[in] One or more <a href="/previous-versions/bb417345(v=msdn.10)#delta_flag_type-flags">DELTA_FLAG_TYPE</a> values that specify the flags to be used during the create process, in addition to the default flags.</p>
<p><em>ResetFlags</em></p>
<p>[in] One or more <a href="/previous-versions/bb417345(v=msdn.10)#delta_flag_type-flags">DELTA_FLAG_TYPE</a> values that specify the default flags to be reset during the create process.</p>
<p><em>Source</em></p>
<p>[in] A <a href="/previous-versions/bb417345(v=msdn.10)#delta-input-structure">DELTA_INPUT</a> structure containing a pointer to the file path containing the source data.</p>
<p><em>Target</em></p>
<p>[in] A <a href="/previous-versions/bb417345(v=msdn.10)#delta-input-structure">DELTA_INPUT</a> structure containing a pointer to the file path containing the target data.</p>
<p><em>SourceOptions</em></p>
<p>[in] Reserved. Pass a <a href="/previous-versions/bb417345(v=msdn.10)#delta-input-structure">DELTA_INPUT</a> structure with <em>Editable</em> set to <strong>FALSE</strong>, <em>lpStart</em> set to <strong>NULL</strong> and <em>uSize</em> set to 0.</p>
<p><em>TargetOptions</em></p>
<p>[in] Reserved. Pass a <a href="/previous-versions/bb417345(v=msdn.10)#delta-input-structure">DELTA_INPUT</a> structure with <em>Editable</em> set to <strong>FALSE</strong>, <em>lpStart</em> set to <strong>NULL</strong> and <em>uSize</em> set to 0.</p>
<p><em>GlobalOptions</em></p>
<p>[in] Reserved. Pass a <a href="/previous-versions/bb417345(v=msdn.10)#delta-input-structure">DELTA_INPUT</a> structure with <em>lpStart</em> set to <strong>NULL</strong> and <em>uSize</em> set to 0.</p>
<p><em>lpTargetFileTime</em></p>
<p>[in] The time stamp set on the target file after delta apply. If <strong>NULL</strong>, the target timestamp will be the current time during the create process.</p>
<p><em>HashAlgId</em></p>
<p>[in] ALG_ID of the algorithm to be used to generate the target signature. Some special values are:</p>
<ul>
<li>0 = No signature</li>
<li>32 = 32-bit CRC defined in msdelta.dll</li>
</ul>
<p><em>lpDelta</em></p>
<p>[out] Pointer to the <a href="/previous-versions/bb417345(v=msdn.10)#delta-output-structure">DELTA_OUTPUT</a> structure where the delta is to be written.</p>
<h2>Return value</h2>
<p>This function returns <strong>TRUE</strong> if it succeeds; otherwise, it returns <strong>FALSE</strong>. When the function returns <strong>FALSE</strong>, you can call <a href="/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror">GetLastError</a> to get the corresponding Win32 system error code.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header</td>
<td>msdelta.h</td>
</tr>
<tr>
<td>DLL</td>
<td>msdelta.dll</td>
</tr>
<tr>
<td>Unicode</td>
<td>Not applicable</td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<p><a href="msdelta.html">MSDelta</a></p>
<p><a href="msdelta-deltafree.html">DeltaFree</a></p>
</body>
