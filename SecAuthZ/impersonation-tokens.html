<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Impersonation Tokens</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Explains the use of impersonation tokens in access control.
ms.assetid: 74fcb0e3-303a-4a5e-9eb6-2aad3a4944db
title: Impersonation Tokens
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Impersonation Tokens</h1>
<p>An impersonating thread has two <a href="/windows/desktop/SecGloss/a-gly"><em>access tokens</em></a>:</p>
<ul>
<li>A <a href="/windows/desktop/SecGloss/p-gly"><em>primary access token</em></a> that describes the <a href="/windows/desktop/SecGloss/s-gly"><em>security context</em></a> of the server. To get a handle to this token, call the <a href="/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocesstoken"><strong>OpenProcessToken</strong></a> function.</li>
<li>An impersonation access token that describes the security context of the client being impersonated. To get a handle to this token, call the <a href="/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken"><strong>OpenThreadToken</strong></a> function.</li>
</ul>
<p>A server can use the <a href="/windows/desktop/SecGloss/i-gly"><em>impersonation token</em></a> in the following functions:</p>
<ul>
<li>In the <a href="/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck"><strong>AccessCheck</strong></a>, <a href="/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytype"><strong>AccessCheckByType</strong></a>, and <a href="/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist"><strong>AccessCheckByTypeResultList</strong></a> functions to determine whether a <a href="/windows/desktop/SecGloss/s-gly"><em>security descriptor</em></a> allows the client a set of access rights.</li>
<li>In the <a href="/windows/win32/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges"><strong>AdjustTokenPrivileges</strong></a> function to enable or disable the client's privileges.</li>
<li>In the <a href="/windows/win32/api/securitybaseapi/nf-securitybaseapi-privilegecheck"><strong>PrivilegeCheck</strong></a> function to determine whether a set of privileges are enabled in the client's token.</li>
<li>In functions that generate entries in the security event log, such as <a href="/windows/desktop/api/Winbase/nf-winbase-objectopenauditalarma"><strong>ObjectOpenAuditAlarm</strong></a> or <a href="/windows/desktop/api/Winbase/nf-winbase-privilegedserviceauditalarma"><strong>PrivilegedServiceAuditAlarm</strong></a>. These functions use an impersonation token to get information about the client for the log entry.</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
