<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Access Rights for Access-Token Objects</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: An application cannot change the access control list of an object unless the application has the rights to do so.
ms.assetid: 5f710fd8-33de-47c0-a8b2-baf3008c4ed7
title: Access Rights for Access-Token Objects
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Access Rights for Access-Token Objects</h1>
<p>An application cannot change the access control list of an object unless the application has the rights to do so. These rights are controlled by a security descriptor in the access token for the object. For more information about security, see <a href="access-control-model.html">Access Control Model</a>.</p>
<p>To get or set the <a href="security-descriptors.html">security descriptor</a> for an <a href="/windows/desktop/SecGloss/a-gly"><em>access token</em></a>, call the <a href="/windows/win32/api/securitybaseapi/nf-securitybaseapi-getkernelobjectsecurity"><strong>GetKernelObjectSecurity</strong></a> and <a href="/windows/win32/api/securitybaseapi/nf-securitybaseapi-setkernelobjectsecurity"><strong>SetKernelObjectSecurity</strong></a> functions.</p>
<p>When you call the <a href="/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocesstoken"><strong>OpenProcessToken</strong></a> or <a href="/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken"><strong>OpenThreadToken</strong></a> function to get a handle to an access token, the system checks the requested <a href="access-rights-and-access-masks.html">access rights</a> against the DACL in the token's security descriptor.</p>
<p>The following are valid access rights for access-token objects:</p>
<ul>
<li>
<p>The DELETE, READ_CONTROL, WRITE_DAC, and WRITE_OWNER <a href="standard-access-rights.html">standard access rights</a>. Access tokens do not support the SYNCHRONIZE standard access right.</p>
</li>
<li>
<p>The <a href="sacl-access-right.html">ACCESS_SYSTEM_SECURITY right</a> to get or set the SACL in the object's security descriptor.</p>
</li>
<li>
<p>The specific access rights for access tokens, which are listed in the following table.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>TOKEN_ADJUST_DEFAULT</td>
<td>Required to change the default owner, primary group, or DACL of an access token.</td>
</tr>
<tr>
<td>TOKEN_ADJUST_GROUPS</td>
<td>Required to adjust the attributes of the groups in an access token.</td>
</tr>
<tr>
<td>TOKEN_ADJUST_PRIVILEGES</td>
<td>Required to enable or disable the privileges in an access token.</td>
</tr>
<tr>
<td>TOKEN_ADJUST_SESSIONID</td>
<td>Required to adjust the session ID of an access token. The SE_TCB_NAME privilege is required.</td>
</tr>
<tr>
<td>TOKEN_ASSIGN_PRIMARY</td>
<td>Required to attach a <a href="/windows/desktop/SecGloss/p-gly"><em>primary token</em></a> to a <a href="/windows/desktop/SecGloss/p-gly"><em>process</em></a>. The SE_ASSIGNPRIMARYTOKEN_NAME privilege is also required to accomplish this task.</td>
</tr>
<tr>
<td>TOKEN_DUPLICATE</td>
<td>Required to duplicate an access token.</td>
</tr>
<tr>
<td>TOKEN_EXECUTE</td>
<td>Same as STANDARD_RIGHTS_EXECUTE.</td>
</tr>
<tr>
<td>TOKEN_IMPERSONATE</td>
<td>Required to attach an impersonation access token to a process.</td>
</tr>
<tr>
<td>TOKEN_QUERY</td>
<td>Required to query an access token.</td>
</tr>
<tr>
<td>TOKEN_QUERY_SOURCE</td>
<td>Required to query the source of an access token.</td>
</tr>
<tr>
<td>TOKEN_READ</td>
<td>Combines STANDARD_RIGHTS_READ and TOKEN_QUERY.</td>
</tr>
<tr>
<td>TOKEN_WRITE</td>
<td>Combines STANDARD_RIGHTS_WRITE, TOKEN_ADJUST_PRIVILEGES, TOKEN_ADJUST_GROUPS, and TOKEN_ADJUST_DEFAULT.</td>
</tr>
<tr>
<td>TOKEN_ALL_ACCESS</td>
<td>Combines all possible access rights for a token.</td>
</tr>
</tbody>
</table>
<p>Â </p>
</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
