<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Consent for Win32 app isolation</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Consent for Win32 app isolation
description: Consent for Win32 app isolation can be granted or removed in several ways.
ms.topic: article
ms.date: 08/26/2024</h2>
<h1>Consent for Win32 app isolation</h1>
<p>Consent for Win32 app isolation can be granted or removed in several ways. This document describes how consent is granted and how it can be revoked.</p>
<blockquote>
<p>[!IMPORTANT]
<strong>This feature is in preview:</strong> Some information relates to a prerelease product which may be substantially modified before it's commercially released. Microsoft makes no warranties, express or implied, with respect to the information provided here.</p>
</blockquote>
<h2>How file access consent is granted</h2>
<p>Consent is granted for Win32 app isolation in three ways.</p>
<ol>
<li><strong>Implicit-Consent</strong>: Apps are implicitly granted access to files and folders through the flows listed below.
<ul>
<li>File Dialog: Files and folders that are selected or created through Window's file dialog created from Win32 app isolation.</li>
<li>File Type Association: Apps that register FTA in the manifest will show up under the open-with context menu and can be set as the default app.
<ul>
<li>Apps that do this through a COM extension will need the <code>isolatedWin32-shellExtensionContextMenu</code> capability.</li>
</ul>
</li>
<li>Drag and Drop: Apps that register drag and drop handlers will have access to any files and folders dragged onto them.
<ul>
<li>There is currently no support for dragging between different apps that use Win32 app isolation.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Publisher Directory</strong>: If the application has the <code>isolatedWin32-accessToPublisherDirectory</code> capability, then the app will have full access to:
<ul>
<li>Network shares whose share name ends with the publisher ID of the app.</li>
<li>Directories with names ending with the publisher ID of the app located in <code>\Device\BootDevice\ProgramData</code>.</li>
</ul>
</li>
<li><strong>Prompting</strong>: If the application has the <code>isolatedWin32-promptForAccess</code> capability, the first time the app attempts to access a file or directory, a prompt will be generated for the user to accept or decline. The choice will be saved until the consent is revoked</li>
</ol>
<h2>How consent is revoked</h2>
<p>Consent can currently be revoked in two ways:</p>
<ol>
<li><strong>Settings</strong>: Through the settings, navigate to &quot;Reset file permissions on isolated Win32 applications&quot;. On this page you can fully reset the consent granted to specific apps that use Win32 app isolation. This will reset both prompted and implicit consent, but won't affect the publisher directory.</li>
<li><strong>Uninstall</strong>: During uninstall, all consent will be revoked.</li>
</ol>
<h2>Related topics</h2>
<ul>
<li><a href="app-isolation-overview.html">Win32 app isolation overview</a></li>
</ul>
</body>
