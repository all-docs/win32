<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Opening and Closing a WinSNMP Session</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Opening and Closing a WinSNMP Session
description: To open a session, an application calls the SnmpCreateSession function.
ms.assetid: 76650231-509b-45be-b156-09752b817854
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Opening and Closing a WinSNMP Session</h1>
<p>To open a session, an application calls the <a href="/windows/desktop/api/Winsnmp/nf-winsnmp-snmpcreatesession"><strong>SnmpCreateSession</strong></a> function. If the function completes successfully, the Microsoft WinSNMP implementation opens a session, and the function returns a session identifier in the form of an <strong>HSNMP_SESSION</strong> handle. All WinSNMP functions that return handle variables include the session identifier as an input parameter. This enables the implementation to use the handle to efficiently manage resources at the session level.</p>
<p>An application can have multiple sessions open at one time. Multiple sessions within an application can share handle variables.</p>
<p>If the implementation cannot open a session because of resource limitations, it returns SNMPAPI_FAILURE when the application calls <a href="/windows/desktop/api/Winsnmp/nf-winsnmp-snmpcreatesession"><strong>SnmpCreateSession</strong></a>. If the application then calls the <a href="/windows/desktop/api/Winsnmp/nf-winsnmp-snmpgetlasterror"><strong>SnmpGetLastError</strong></a> function, it returns SNMPAPI_ALLOC_ERROR.</p>
<p>A call to the <a href="/windows/desktop/api/Winsnmp/nf-winsnmp-snmpclose"><strong>SnmpClose</strong></a> function enables the implementation to free any remaining resources and to close the session.</p>
<p>For more information, see <a href="resource-handle-objects.html">Resource Handle Objects</a> and <a href="winsnmp-sessions.html">WinSNMP Sessions</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
