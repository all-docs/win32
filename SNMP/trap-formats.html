<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Trap Formats</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Trap Formats
description: The format of trap PDUs is different than that of other PDUs. The format of SNMPv1 traps and SNMPv2C traps is also different.
ms.assetid: 2d2b4520-28b7-4a2e-8dee-456e17d9d6f6
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Trap Formats</h1>
<p>The format of trap PDUs is different than that of other PDUs. The format of SNMPv1 traps and SNMPv2C traps is also different.</p>
<p>Under the SNMPv2C framework, the PDU trap format is a variable binding list of <em>n</em> variable binding entries organized in the following manner:</p>
<ul>
<li>The first variable binding entry contains a time-stamp.</li>
<li>The second variable binding entry is an object identifier that identifies the trap.</li>
<li>The third through <em>n</em> variable binding entries, if present, contain additional information associated with the trap.</li>
</ul>
<p>Under the SNMPv1 framework, the PDU trap format is as follows.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>enterprise</td>
<td>Identifies the type of device that generated the trap.</td>
</tr>
<tr>
<td>agent-addr</td>
<td>Identifies the IP address of the device that generated the trap.</td>
</tr>
<tr>
<td>generic-trap/specific-trap</td>
<td>Identifies a predefined trap type.</td>
</tr>
<tr>
<td>time-stamp</td>
<td>Identifies when the trap was generated.</td>
</tr>
<tr>
<td>variable-bindings</td>
<td>Contains additional information associated with the trap.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The <a href="/windows/desktop/api/Winsnmp/nf-winsnmp-snmprecvmsg"><strong>SnmpRecvMsg</strong></a> function always returns a message in the SNMPv2C format. If the message contains the operation type <strong>SNMP_PDU_TRAP</strong>, the application can read the variable binding entries of the message and retrieve the information associated with the trap.</p>
<p>Â </p>
<p>Â </p>
</body>
