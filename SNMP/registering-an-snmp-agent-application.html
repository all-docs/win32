<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Registering an SNMP Agent Application</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Registering an SNMP Agent Application
description: In addition to SNMP manager operations, the WinSNMP API version 2.0 also supports SNMP agent operations.
ms.assetid: 473560b5-4611-410e-aeae-764c9c76e765
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Registering an SNMP Agent Application</h1>
<p>In addition to SNMP manager operations, the WinSNMP API version 2.0 also supports SNMP agent operations.</p>
<p>To register a WinSNMP application as an SNMP agent, the application can call the <a href="/windows/desktop/api/Winsnmp/nf-winsnmp-snmplisten"><strong>SnmpListen</strong></a> function. This function informs the Microsoft WinSNMP implementation that an SNMP entity will be acting in the role of an SNMP agent. The application can also call <strong>SnmpListen</strong> to inform the implementation when it will no longer be acting as an agent.</p>
<p>If an application calls the <a href="/windows/desktop/api/Winsnmp/nf-winsnmp-snmplisten"><strong>SnmpListen</strong></a> function and passes the value SNMPAPI_ON in the <em>lStatus</em> parameter, the following actions occur:</p>
<ol>
<li>The entity that will be functioning in an SNMP agent role binds to its assigned port, and &quot;listens&quot; for incoming SNMP message requests.</li>
<li>The agent uses application-specific logic to process each SNMP request.</li>
<li>The agent forms appropriate responses to each request.</li>
<li>The agent transmits the response to the requesting entity by calling the <a href="/windows/desktop/api/Winsnmp/nf-winsnmp-snmpsendmsg"><strong>SnmpSendMsg</strong></a> function. When the agent calls <strong>SnmpSendMsg</strong>, it specifies the address of the agent in the <em>srcEntity</em> parameter, and the address of the remote manager entity in the <em>dstEntity</em> parameter. (These values are the reverse of the values the agent entity received in these parameters when it called the <a href="/windows/desktop/api/Winsnmp/nf-winsnmp-snmprecvmsg"><strong>SnmpRecvMsg</strong></a> function to retrieve an SNMP request.)</li>
</ol>
<p>For more information about SNMP management applications and agent applications, see <a href="about-snmp.html">About SNMP</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
