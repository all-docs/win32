<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Auditing</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Auditing
description: Windows Filtering Platform (WFP) provides auditing of firewall and IPsec related events.
ms.assetid: 30ff9cf7-bf93-4979-bacd-d76e5dadbef6
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Auditing</h1>
<p>The Windows Filtering Platform (WFP) provides auditing of firewall and IPsec related events. These events are stored in the system security log.</p>
<p>The audited events are as follows.</p>
<table>
<thead>
<tr>
<th>Auditing category</th>
<th>Auditing subcategory</th>
<th>Audited events</th>
</tr>
</thead>
<tbody>
<tr>
<td>Policy Change<!-- raw HTML omitted --> {6997984D-797A-11D9-BED3-505054503030}<!-- raw HTML omitted --></td>
<td>Filtering Platform Policy Change<!-- raw HTML omitted --> {0CCE9233-69AE-11D9-BED3-505054503030}<!-- raw HTML omitted --></td>
<td><strong>Note:</strong> The numbers represent the Event IDs as displayed by Event Viewer (eventvwr.exe).<!-- raw HTML omitted --> WFP object addition and removal:<!-- raw HTML omitted -->- 5440 Persistent callout added<!-- raw HTML omitted -->- 5441 Boot-time or persistent filter added<!-- raw HTML omitted -->- 5442 Persistent provider added<!-- raw HTML omitted -->- 5443 Persistent provider context added<!-- raw HTML omitted -->- 5444 Persistent sub-layer added<!-- raw HTML omitted -->- 5446 Run-time callout added or removed<!-- raw HTML omitted -->- 5447 Run-time filter added or removed<!-- raw HTML omitted -->- 5448 Run-time provider added or removed<!-- raw HTML omitted -->- 5449 Run-time provider context added or removed<!-- raw HTML omitted -->- 5450 Run-time sub-layer added or removed<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Object Access<!-- raw HTML omitted --> {6997984A-797A-11D9-BED3-505054503030}<!-- raw HTML omitted --></td>
<td>Filtering Platform Packet Drop <!-- raw HTML omitted --> {0CCE9225-69AE-11D9-BED3-505054503030}<!-- raw HTML omitted --></td>
<td>Packets dropped by WFP:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->5152 Packet dropped<!-- raw HTML omitted --><!-- raw HTML omitted -->5153 Packet vetoed<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Object Access<!-- raw HTML omitted --></td>
<td>Filtering Platform Connection <!-- raw HTML omitted --> {0CCE9226-69AE-11D9-BED3-505054503030}<!-- raw HTML omitted --></td>
<td>Allowed and blocked connections:<!-- raw HTML omitted -->- 5154 Listen permitted<!-- raw HTML omitted -->- 5155 Listen blocked<!-- raw HTML omitted -->- 5156 Connection permitted<!-- raw HTML omitted -->- 5157 Connection blocked<!-- raw HTML omitted -->- 5158 Bind permitted<!-- raw HTML omitted -->- 5159 Bind blocked<!-- raw HTML omitted --> <strong>Note:</strong> Permitted connections do not always audit the ID of the associated filter. The FilterID for TCP will be 0 unless a subset of these filtering conditions are used: UserID, AppID, Protocol, Remote Port.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Object Access<!-- raw HTML omitted --></td>
<td>Other Object Access Events<!-- raw HTML omitted --> {0CCE9227-69AE-11D9-BED3-505054503030}<!-- raw HTML omitted --></td>
<td><strong>Note:</strong> This subcategory enables many audits. WFP specific audits are listed below.<!-- raw HTML omitted --> Denial of Service prevention status:<!-- raw HTML omitted -->- 5148 WFP DoS prevention mode started<!-- raw HTML omitted -->- 5149 WFP DoS prevention mode stopped<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Logon/Logoff<!-- raw HTML omitted --> {69979849-797A-11D9-BED3-505054503030}<!-- raw HTML omitted --></td>
<td>IPsec Main Mode<!-- raw HTML omitted --> {0CCE9218-69AE-11D9-BED3-505054503030}<!-- raw HTML omitted --></td>
<td>IKE and AuthIP Main Mode negotiation:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->4650, 4651 Security association established<!-- raw HTML omitted --><!-- raw HTML omitted -->4652, 4653 Negotiation failed<!-- raw HTML omitted --><!-- raw HTML omitted -->4655 Security association ended<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Logon/Logoff<!-- raw HTML omitted --></td>
<td>IPsec Quick Mode <!-- raw HTML omitted --> {0CCE9219-69AE-11D9-BED3-505054503030}<!-- raw HTML omitted --></td>
<td>IKE and AuthIP Quick Mode negotiation:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->5451 Security association established<!-- raw HTML omitted --><!-- raw HTML omitted -->5452 Security association ended<!-- raw HTML omitted --><!-- raw HTML omitted -->4654 Negotiation failed<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Logon/Logoff <!-- raw HTML omitted --></td>
<td>IPsec Extended Mode<!-- raw HTML omitted --> {0CCE921A-69AE-11D9-BED3-505054503030}<!-- raw HTML omitted --></td>
<td>AuthIP Extended Mode negotiation:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->4978 Invalid negotiation packet<!-- raw HTML omitted --><!-- raw HTML omitted -->4979, 4980, 4981, 4982 Security association established<!-- raw HTML omitted --><!-- raw HTML omitted -->4983, 4984 Negotiation failed<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>System<!-- raw HTML omitted --> {69979848-797A-11D9-BED3-505054503030}<!-- raw HTML omitted --></td>
<td>IPsec Driver<!-- raw HTML omitted --> {0CCE9213-69AE-11D9-BED3-505054503030}<!-- raw HTML omitted --></td>
<td>Packets dropped by the IPsec driver:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->4963 Inbound clear text packet dropped<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>By default, auditing for WFP is disabled.</p>
<p>Auditing can be enabled on a per-category basis through either the Group Policy Object Editor MMC snap-in, the Local Security Policy MMC snap-in, or the auditpol.exe command.</p>
<p>For example, to enable the auditing of Policy Change events you may:</p>
<ul>
<li>
<p>Use the Group Policy Object Editor</p>
<ol>
<li>Run <strong>gpedit.msc</strong>.</li>
<li>Expand Local Computer Policy.</li>
<li>Expand Computer Configuration.</li>
<li>Expand Windows Settings.</li>
<li>Expand Security Settings.</li>
<li>Expand Local Policies.</li>
<li>Click Audit Policy.</li>
<li>Double-click Audit policy change in order to launch the Properties dialog box.</li>
<li>Check the Success and Failure check-boxes.</li>
</ol>
</li>
<li>
<p>Use the Local Security Policy</p>
<ol>
<li>Run <strong>secpol.msc</strong>.</li>
<li>Expand Local Policies.</li>
<li>Click Audit Policy.</li>
<li>Double-click Audit policy change in order to launch the Properties dialog box.</li>
<li>Check the Success and Failure check-boxes.</li>
</ol>
</li>
<li>
<p>Use the auditpol.exe command</p>
<ul>
<li><strong>auditpol /set /category:&quot;Policy Change&quot; /success:enable /failure:enable</strong></li>
</ul>
</li>
</ul>
<p>Auditing can be enabled on a per-subcategory basis only through the auditpol.exe command.</p>
<p>The auditing category and subcategory names are localized. To avoid localization for auditing scripts, the corresponding GUIDs may be used in place of the names.</p>
<p>For example, to enable the auditing of Filtering Platform Policy Change events you may use either one of the following commands:</p>
<ul>
<li><strong>auditpol /set /subcategory:&quot;Filtering Platform Policy Change&quot; /success:enable /failure:enable</strong></li>
<li><strong>auditpol /set /subcategory:&quot;{0CCE9233-69AE-11D9-BED3-505054503030}&quot; /success:enable /failure:enable</strong></li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc731451(v=ws.11)">Auditpol</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/orphan-topics/ws.10/dd996684(v=ws.10)">Event Log</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/deployment/deploy-whats-new">Group Policy</a></p>
<!-- raw HTML omitted -->
</body>
