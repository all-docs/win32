<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Filter Weight Assignment</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Filter Weight Assignment
description: Every filter in the Windows Filtering Platform (WFP) has an associated weight, which is used during filter arbitration.
ms.assetid: c78854c2-9aa1-408f-82d6-4b9e52f38e84
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Filter Weight Assignment</h1>
<p>Every filter in the Windows Filtering Platform (WFP) has an associated weight, which is used during <a href="filter-arbitration.html">filter arbitration</a>.</p>
<p>The filter weight used by the Base Filtering Engine (BFE) is of type <a href="/windows/desktop/api/Fwptypes/ne-fwptypes-fwp_data_type"><strong>FWP_UINT64</strong></a>. Callers have three options when adding filters.</p>
<ul>
<li>
<p>Set the weight to an <a href="/windows/desktop/api/Fwptypes/ne-fwptypes-fwp_data_type"><strong>FWP_UINT64</strong></a>. BFE uses the supplied weight as is.</p>
</li>
<li>
<p>Set the weight to <a href="/windows/desktop/api/Fwptypes/ne-fwptypes-fwp_data_type"><strong>FWP_EMPTY</strong></a>. BFE automatically generates a weight in the range [0, 2â¶â°).</p>
</li>
<li>
<p>Set the weight to an <a href="/windows/desktop/api/Fwptypes/ne-fwptypes-fwp_data_type"><strong>FWP_UINT8</strong></a> in the range [0, 15]. BFE uses the supplied weight as a weight range identifier.</p>
<p>BFE automatically generates the low-order 60 bits (exactly as if the weight had been set to <a href="/windows/desktop/api/Fwptypes/ne-fwptypes-fwp_data_type"><strong>FWP_EMPTY</strong></a>), and then uses the supplied value to set the 4 high-order bits. This allows callers to manually divide the weight space into 16 ranges, while still using automatic weighting within a range.</p>
</li>
</ul>
<blockquote>
<p>[!Note]<br />
When two or more callouts are registered at the same sublayer, problems may occur when the same weight is assigned to the filters. This issue can be prevented by having callouts create their own sublayer by using <a href="/windows/desktop/api/Fwpmu/nf-fwpmu-fwpmsublayeradd0"><strong>FwpmSubLayerAdd0</strong></a>.</p>
</blockquote>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="filter-weight-identifiers.html"><strong>Filter Weight Identifiers</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
