<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>WFP API</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: WFP API
description: The Windows Filtering Platform (WFP) API is divided into the following components.
ms.assetid: ff3f0d74-7e0b-4a3e-b66d-eaa61b89038a
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>WFP API</h1>
<p>The Windows Filtering Platform (WFP) API is divided into the following components.</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Description</th>
<th>Header Files</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->Callout API<!-- raw HTML omitted --> (FWPS)${REMOVE}$<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Data types<!-- raw HTML omitted --> used by callouts.<!-- raw HTML omitted -->Note<!-- raw HTML omitted -->  These data types are documented in the Microsoft Windows Driver Development Kit (DDK).<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> fwpstypes.h<!-- raw HTML omitted -->fwpstypes.idl<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->Functions<!-- raw HTML omitted --> and <!-- raw HTML omitted -->enumerated types<!-- raw HTML omitted --> used to implement callouts.<!-- raw HTML omitted -->Note<!-- raw HTML omitted -->  These functions and enumerated types are documented in the DDK.<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> fwpsu.h<!-- raw HTML omitted -->fwpsk.h<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td>IKE/AuthIP API (IKEEXT)${REMOVE}$<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Enumerated types<!-- raw HTML omitted --> and <!-- raw HTML omitted -->structures<!-- raw HTML omitted --> used for managing IKE and AuthIP main mode (MM) policy and security associations.</td>
<td><!-- raw HTML omitted --> iketypes.h<!-- raw HTML omitted -->iketypes.idl<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->Functions<!-- raw HTML omitted --> used for managing IKE and AuthIP MM policy and security associations.</td>
<td><!-- raw HTML omitted --> fwpmu.h<!-- raw HTML omitted -->fwpmk.h<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td>IPsec API (IPSEC)${REMOVE}$<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Enumerated types<!-- raw HTML omitted --> and <!-- raw HTML omitted -->structures<!-- raw HTML omitted --> used for managing IPsec policies and security associations.</td>
<td><!-- raw HTML omitted --> ipsectypes.h<!-- raw HTML omitted -->ipsectypes.idl<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->Functions<!-- raw HTML omitted --> used for managing IPsec policies and security associations.</td>
<td><!-- raw HTML omitted --> fwpmu.h<!-- raw HTML omitted -->fwpmk.h<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td>Management API (FWPM)${REMOVE}$<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Enumerated types<!-- raw HTML omitted --> and <!-- raw HTML omitted -->structures<!-- raw HTML omitted --> used for managing the filter engine.</td>
<td><!-- raw HTML omitted --> fwpmtypes.h<!-- raw HTML omitted -->fwpmtypes.idl<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->Functions<!-- raw HTML omitted --> used for managing the filter engine. These functions are used to perform the following tasks:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Set and query filters, providers, and callouts.<!-- raw HTML omitted --><!-- raw HTML omitted -->Retrieve IPsec statistics.<!-- raw HTML omitted --><!-- raw HTML omitted -->Configure the Windows Filtering Platform.<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> fwpmu.h<!-- raw HTML omitted -->fwpmk.h<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td>Shared API (FWP)</td>
<td>Fundamental <!-- raw HTML omitted -->enumerated types<!-- raw HTML omitted --> and <!-- raw HTML omitted -->structures<!-- raw HTML omitted --> shared across the Windows Filtering Platform.</td>
<td><!-- raw HTML omitted --> fwptypes.h<!-- raw HTML omitted -->fwptypes.idl<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Data type names are all upper-case and underscore-delimited. The name always begins with a prefix that identifies its component group, such as <a href="/windows/desktop/api/Fwpmtypes/ns-fwpmtypes-fwpm_provider0"><strong>FWPM_PROVIDER0</strong></a>.</p>
<p>Function names are mixed-case and case-delimited. The name always begins with a prefix that identifies its component group, such as <a href="/windows/desktop/api/Fwpmu/nf-fwpmu-fwpmprovidercontextadd0"><strong>FwpmProviderContextAdd0</strong></a>.</p>
<p>Most data and function names end with a version number. The fwpvi.h header file maps version-independent data and function names to the version that is appropriate for use with a given operating system. For more information, see <a href="wfp-version-independent-names-and-targeting-specific-versions-of-windows.html">WFP Version-Independent Names and Targeting Specific Versions of Windows</a>.</p>
<p>Each component does not stand alone. For example, IKE main mode (MM) policies are defined in the IKEEXT component, but are stored in a provider context and are associated with a filter both of which are found in the FWPM API component.</p>
<h2>User-Mode and Kernel-Mode Public Header Files</h2>
<p>Most of the WFP functions can be called from either user mode or kernel mode. However, user-mode functions return a <strong>DWORD</strong> value that represents a Win32 error code, whereas kernel-mode functions return an <strong>NTSTATUS</strong> value that represents an NT status code. As a result, function names and semantics are identical between user mode and kernel mode, but function signatures are not. This requires separate user-mode and kernel-mode specific headers for the function prototypes. User-mode header file names end in &quot;u&quot; and kernel-mode header file names end in &quot;k&quot;.</p>
<p>The following table lists the Win32 header files that define the WFP functions.</p>
<table>
<thead>
<tr>
<th>Header Files</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>fwpmk.h</td>
<td>Kernel-mode function prototypes for FWPM, IPsec, and IKEEXT components. Available in the DDK only.</td>
</tr>
<tr>
<td>fwpmu.h</td>
<td>User-mode function prototypes for FWPM, IPsec, and IKEEXT components. Available in the Microsoft Windows Software Development Kit (SDK) only.</td>
</tr>
<tr>
<td>fwpsk.h</td>
<td>Kernel-mode function prototypes and enumerated types for FWPS component. Available in the DDK only.</td>
</tr>
<tr>
<td>fwpsu.h</td>
<td>User-mode function prototypes and enumerated types for FWPS component. Available in the Windows SDK only.<strong>Note</strong>  The user-mode FWPS enumerated types are identical to the kernel-mode FWPS enumerated types. In consequence, these types are documented in the DDK only.<!-- raw HTML omitted --> <strong>Note</strong>  The user-mode FWPS function prototypes are identical to the kernel-mode FWPS function prototypes with the exception of the return code. User-mode FWPS functions return a <strong>DWORD</strong>, whereas kernel-mode FWPS functions return an <strong>NTSTATUS</strong>. In consequence, these functions are documented in the DDK only.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>All user-mode functions are exported from fwpuclnt.dll. All kernel-mode functions are exported from fwpkclnt.sys.</p>
<h3>Management (FWPM) and Callout (FWPS) Data Types</h3>
<p>Most FWPM data types, which are used for management tasks such as adding filters or callouts from an application or driver, have FWPS counterparts. The FWPS data types are used during the actual filtering of network traffic, in the context of a callout routine for classification.</p>
<p>For example, in order to add a filter to a certain filtering engine layer, the programmer should use an FWPM type, like: <code>filter.layerKey = FWPM_LAYER_INBOUND_IPPACKET</code>. To check which layer a callout is being called from, the programmer should use the corresponding FWPS type: <code> if (inFixedValues-&gt;layerId == FWPS_LAYER_INBOUND_IPPACKET)</code>.</p>
<p>Some FWPS counterparts to FWPM data types are expanding the original FWPM data types. For example, to add a filter condition at many filtering engine layers, the programmer specifies the <code>filterCondition.fieldKey = FWPM_CONDITION_IP_PROTOCOL</code> regardless of the filtering engine layer. To find a filter condition value, the programmer specifies a layer specific FWPS type, like: <code>inFixedValues-&gt;incomingValue[FWPS_FIELD_ALE_FLOW_ESTABLISHED_V4_IP_PROTOCOL]</code>.</p>
<p>The FWPS data types are generally smaller than their FWPM counterparts. For example, the <a href="management-filtering-layer-identifiers-.html"><strong>FWPM filtering layer identifiers</strong></a> are <strong>GUID</strong>s (16-bytes) whereas the <a href="/windows-hardware/drivers/network/management-filtering-layer-identifiers">FWPS filtering layer identifiers</a> are <strong>UINT16</strong> (16-bits). The smaller size for FWPS data types improves system performance since integer comparisons outweigh <strong>GUID</strong> comparisons for real-time traffic. Also, the kernel memory is used efficiently since the FWPS types are all used in the kernel for managing the filters, whereas the FWPM types are stored in user-mode to manage the different layers.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="object-model.html">WFP API Object Model</a></p>
<!-- raw HTML omitted -->
<p><a href="object-management.html">WFP API Object Management</a></p>
<!-- raw HTML omitted -->
</body>
