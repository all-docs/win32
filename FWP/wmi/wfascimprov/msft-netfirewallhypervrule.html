<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MSFT_NetFirewallHyperVRule class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MSFT_NetFirewallHyperVRule class
description: Represents a Windows Defender firewall Hyper-V rule.
ms.topic: article
ms.date: 05/17/2024
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>MSFT_NetFirewallHyperVRule
api_type:</li>
<li>DllExport
api_location:</li>
<li>WFasCim.dll</li>
</ul>
<hr />
<h1>MSFT_NetFirewallHyperVRule class</h1>
<p>Represents a Windows Defender firewall Hyper-V rule.</p>
<p>For more info, see the Powershell documentation <a href="/powershell/module/netsecurity/new-netfirewallhypervrule">New-NetFirewallHyperVRule</a>.</p>
<p>The following syntax is simplified from Managed Object Format (MOF) code, and includes all of the inherited properties.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>class MSFT_NetFirewallHyperVRule : CIM_PolicyRule
{
  string DisplayName;
  uint16 RulePriority;
  uint16 Direction;
  string VMCreatorId;
  string Protocol;
  string LocalAddresses[];
  string LocalPorts[];
  string RemoteAddresses[];
  string RemotePorts[];
  uint16 Action;
  uint16 EnforcementStatus;
  uint16 PolicyStoreSourceType;
  string PortStatuses[];
  uint16 Profiles;
  uint32 Enable();
  uint32 Disable();
  uint32 Rename
  (
    string NewName
  );
  uint32 EnumerateFull
  (
    string Dependents[]
  );
  string SystemCreationClassName;
  string SystemName;
  string CreationClassName;
  string PolicyRuleName;
  uint16 ConditionListType;
  string RuleUsage;
  uint16 Priority;
  boolean Mandatory;
  uint16 SequencedActions;
  uint16 ExecutionStrategy;
  uint16 PolicyDecisionStrategy;
  string PolicyRoles[];
  uint16 Enabled = 1;
  string CommonName;
  string PolicyKeywords[];
  string InstanceID;
  string Caption;
  string Description;
  string ElementName;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>MSFT_NetFirewallHyperVRule</strong> class has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>MSFT_NetFirewallHyperVRule</strong> class has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="./disable-msft-netfirewallhypervrule.html"><strong>Disable</strong></a></td>
<td align="left">Disable this rule.</td>
</tr>
<tr>
<td align="left"><a href="./enable-msft-netfirewallhypervrule.html"><strong>Enable</strong></a></td>
<td align="left">Enable this rule.</td>
</tr>
<tr>
<td align="left"><a href="./enumeratefull-msft-netfirewallhypervrule.html"><strong>EnumerateFull</strong></a></td>
<td align="left">Enumerates all fields of all rules.</td>
</tr>
<tr>
<td align="left"><a href="./rename-msft-netfirewallhypervrule.html"><strong>Rename</strong></a></td>
<td align="left">Rename this rule.</td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<p>The <strong>MSFT_NetFirewallHyperVRule</strong> class has these properties.</p>
<p><code>DisplayName</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read-only</p>
<p>The localized name of this rule. This field's value is based on the value of <em>ElementName</em>. Changes to this field are ignored.</p>
<p><code>RulePriority</code></p>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: Read/write</p>
<p>Determines the order in which rules are evaluated. Lower priority rules are evaluated first. If this value is 0 (unset), then the system will assign a value of 1 to rules with action Block, and 2 to rules with action Allow.</p>
<p><code>Direction</code></p>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: Read/write</p>
<p>Specifies which direction of traffic to match with this rule.</p>
<p><strong>Inbound</strong> (1)</p>
<p><strong>Outbound</strong> (2)</p>
<p><code>VMCreatorId</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read/write</p>
<p>Specifies the unique identifier of the VM creator to which this rule is applicable. A NULL GUID value means that this rule is applicable to all Hyper-V ports on the system.</p>
<p><code>Protocol</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read/write</p>
<p>IANA Internet Protocol Number that this filter applies to. May be 0-255 or one of the following: TCP, UDP.</p>
<p><code>LocalAddresses</code></p>
<p>Data type: <strong>string</strong>[]</p>
<p>Access type: Read/write</p>
<p>An array of IP addresses, subnets, or ranges. Valid formats include: a valid IPv4 address in strict four-part dotted decimal notation (for example, 10.0.0.10), a valid IPv6 address in Internet standard format as described in section 2.2 of RFC 4291 (for example, 2620:1ec:c11::200), an IPv4 address range in the format of 'start address - end address' with no spaces included (for example, 10.0.0.0-10.0.0.255), an IPv6 address range in the format of 'start address - end address' with no spaces included (for example, 2001:db8:abcd:12::-2001:db8:abcd:12:ffff:ffff:ffff:ffff), a valid IPv4 subnet specified using the network prefix notation (for example, 10.0.0.0/24), a valid IPv6 subnet specified using the prefix length notation (for example, 2001:db8:abcd:0012::/64)&quot;.</p>
<p><code>LocalPorts</code></p>
<p>Data type: <strong>string</strong>[]</p>
<p>Access type: Read/write</p>
<p>Local ports that this filter applies to (applies only when Protocol is TCP or UDP). May be a number or range 0-65535, or one of the following: Any, RPC, RPC-EPMap, IPHTTPSIn, PlayToDiscovery.</p>
<p><code>RemoteAddresses</code></p>
<p>Data type: <strong>string</strong>[]</p>
<p>Access type: Read/write</p>
<p>An array of IP addresses, subnets, or ranges. Valid formats include: a valid IPv4 address in strict four-part dotted decimal notation (for example, 10.0.0.10), a valid IPv6 address in Internet standard format as described in section 2.2 of RFC 4291 (for example, 2620:1ec:c11::200), an IPv4 address range in the format of 'start address - end address' with no spaces included (for example, 10.0.0.0-10.0.0.255), an IPv6 address range in the format of 'start address - end address' with no spaces included (for example, 2001:db8:abcd:12::-2001:db8:abcd:12:ffff:ffff:ffff:ffff), a valid IPv4 subnet specified using the network prefix notation (for example, 10.0.0.0/24), a valid IPv6 subnet specified using the prefix length notation (for example, 2001:db8:abcd:0012::/64)&quot;.</p>
<p><code>RemotePorts</code></p>
<p>Data type: <strong>string</strong>[]</p>
<p>Access type: Read/write</p>
<p>Remote ports that this filter applies to (applies only when Protocol is TCP or UDP). May be a number or range 0-65535, or one of the following: Any, IPHTTPSOut.</p>
<p><code>Action</code></p>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: Read/write</p>
<p>Specifies the action to take on traffic that matches this rule.</p>
<p><strong>Allow</strong> (2)</p>
<p><strong>Block</strong> (4)</p>
<p><code>EnforcementStatus</code></p>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: Read/write</p>
<p>Describes the current enforcement status of this rule.</p>
<p><strong>Invalid</strong> (0)</p>
<p><strong>FullyEnforced</strong> (1)</p>
<p><strong>PartiallyEnforced</strong> (2)</p>
<p><strong>NoApplicablePorts</strong> (3)</p>
<p><strong>ParsingError</strong> (4)</p>
<p><strong>Error</strong> (5)</p>
<p><code>PolicyStoreSourceType</code></p>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: Read/write</p>
<p>Describes the type of PolicyStore where this rule originally came from.</p>
<p><strong>Unknown</strong> (0)</p>
<p><strong>Local</strong> (1)</p>
<p><strong>Dynamic</strong> (3)</p>
<p><strong>Generated</strong> (5)</p>
<p><strong>MDM</strong> (6)</p>
<p><strong>HostFirewallLocal</strong> (8)</p>
<p><strong>HostFirewallGroupPolicy</strong> (9)</p>
<p><strong>HostFirewallDynamic</strong> (10)</p>
<p><strong>HostFirewallMDM</strong> (11)</p>
<p><code>PortStatuses</code></p>
<p>Data type: <strong>string</strong>[]</p>
<p>Access type: Read/write</p>
<p>List of statuses for each port that this rule has been applied to.</p>
<p><code>Profiles</code></p>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: Read/write</p>
<p>Bitmask of profiles that this rule is active on.</p>
<p><strong>Any</strong> (0)</p>
<p><strong>Public</strong> (0x4)</p>
<p><strong>Private</strong> (0x2)</p>
<p><strong>Domain</strong> (0x1)</p>
<p><code>SystemCreationClassName</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>Reserved for internal use by the WMI provider only.</p>
<p><code>SystemName</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>Reserved for internal use by the WMI provider only.</p>
<p><code>CreationClassName</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>Reserved for internal use by the WMI provider only.</p>
<p><code>PolicyRuleName</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>Reserved for internal use by the WMI provider only.</p>
<p><code>ConditionListType</code></p>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>This field is ignored.</p>
<p><code>RuleUsage</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>This field is ignored.</p>
<p><code>Priority</code></p>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>This field is ignored.</p>
<p><code>Mandatory</code></p>
<p>Data type: <strong>boolean</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>This field is ignored.</p>
<p><code>SequencedActions</code></p>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>This field is ignored.</p>
<p><code>ExecutionStrategy</code></p>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>This field is ignored.</p>
<p><code>PolicyDecisionStrategy</code></p>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>This field is ignored.</p>
<p><code>PolicyRoles</code></p>
<p>Data type: <strong>string</strong>[]</p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>This field is ignored.</p>
<p><code>Profiles</code></p>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>Indicates whether this rule is administratively enabled or disabled. The default value is &quot;1&quot; (Enabled).</p>
<p><strong>Enabled</strong> (1)</p>
<p><strong>Disabled</strong> (2)</p>
<p><code>CommonName</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>This field is ignored.</p>
<p><code>PolicyKeywords</code></p>
<p>Data type: <strong>string</strong>[]</p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>This field is ignored.</p>
<p><code>InstanceID</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>A string that uniquely identifies this instance within the PolicyStore.</p>
<p><code>Caption</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read-only</p>
<p>Qualifiers: <strong>Override</strong>, <strong>MaxLen</strong> (64)</p>
<p>The Caption property is a short textual description (a one-line string) of the object.</p>
<p><code>Description</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read/write</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>A brief description of the rule. Might be an indirect string. If it is an indirect string, then it might not be overwritten.</p>
<p><code>ElementName</code></p>
<p>Data type: <strong>string</strong></p>
<p>Access type: Read/write</p>
<p>Qualifiers: <strong>Override</strong></p>
<p>The locale-independent name of the rule. Might be an indirect string.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client</td>
<td>Windows 8</td>
</tr>
<tr>
<td>Minimum supported server</td>
<td>Windows Server 2012</td>
</tr>
<tr>
<td>Namespace</td>
<td>Root\StandardCimv2</td>
</tr>
<tr>
<td>MOF</td>
<td>WFasCim.mof</td>
</tr>
<tr>
<td>DLL</td>
<td>WFasCim.dll</td>
</tr>
</tbody>
</table>
</body>
