<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Service Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The following functions are used or implemented by services.
ms.assetid: 63666848-cbac-4853-8b91-89303f9854c0
title: Service Functions
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Service Functions</h1>
<p>The following functions are used or implemented by services.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nc-winsvc-lphandler_function"><strong>Handler</strong></a></td>
<td>An application-defined callback function used with the <a href="/windows/desktop/api/Winsvc/nf-winsvc-registerservicectrlhandlera"><strong>RegisterServiceCtrlHandler</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/WinSvc/nc-winsvc-lphandler_function_ex"><strong>HandlerEx</strong></a></td>
<td>An application-defined callback function used with the <a href="/windows/desktop/api/Winsvc/nf-winsvc-registerservicectrlhandlerexa"><strong>RegisterServiceCtrlHandlerEx</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-registerservicectrlhandlera"><strong>RegisterServiceCtrlHandler</strong></a></td>
<td>Registers a function to handle service control requests.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-registerservicectrlhandlerexa"><strong>RegisterServiceCtrlHandlerEx</strong></a></td>
<td>Registers a function to handle extended service control requests.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/winsvc/nc-winsvc-lpservice_main_functiona"><strong>ServiceMain</strong></a></td>
<td>An application-defined function that serves as the starting point for a service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Lmserver/nf-lmserver-setservicebits"><strong>SetServiceBits</strong></a></td>
<td>Registers a service type with the service control manager and the Server service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-setservicestatus"><strong>SetServiceStatus</strong></a></td>
<td>Updates the service control manager's status information for the calling service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-startservicectrldispatchera"><strong>StartServiceCtrlDispatcher</strong></a></td>
<td>Connects the main thread of a service process to the service control manager.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The following functions are used by programs that control, configure, or interact with services.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfiga"><strong>ChangeServiceConfig</strong></a></td>
<td>Changes the configuration parameters of a service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a"><strong>ChangeServiceConfig2</strong></a></td>
<td>Changes the optional configuration parameters of a service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-closeservicehandle"><strong>CloseServiceHandle</strong></a></td>
<td>Closes the specified handle to a service control manager object or a service object.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-controlservice"><strong>ControlService</strong></a></td>
<td>Sends a control code to a service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-controlserviceexa"><strong>ControlServiceEx</strong></a></td>
<td>Sends a control code to a service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-createservicea"><strong>CreateService</strong></a></td>
<td>Creates a service object and adds it to the specified service control manager database.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-deleteservice"><strong>DeleteService</strong></a></td>
<td>Marks the specified service for deletion from the service control manager database.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-enumdependentservicesa"><strong>EnumDependentServices</strong></a></td>
<td>Retrieves the name and status of each service that depends on the specified service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-enumservicesstatusexa"><strong>EnumServicesStatusEx</strong></a></td>
<td>Enumerates services in the specified service control manager database based on the specified information level.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-getservicedisplaynamea"><strong>GetServiceDisplayName</strong></a></td>
<td>Retrieves the display name of the specified service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-getservicekeynamea"><strong>GetServiceKeyName</strong></a></td>
<td>Retrieves the service name of the specified service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-notifybootconfigstatus"><strong>NotifyBootConfigStatus</strong></a></td>
<td>Reports the boot status to the service control manager.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-notifyservicestatuschangea"><strong>NotifyServiceStatusChange</strong></a></td>
<td>Enables an application to receive notification when the specified service is created or deleted or when its status changes.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-openscmanagera"><strong>OpenSCManager</strong></a></td>
<td>Establishes a connection to the service control manager on the specified computer and opens the specified service control manager database.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-openservicea"><strong>OpenService</strong></a></td>
<td>Opens an existing service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-queryserviceconfiga"><strong>QueryServiceConfig</strong></a></td>
<td>Retrieves the configuration parameters of the specified service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-queryserviceconfig2a"><strong>QueryServiceConfig2</strong></a></td>
<td>Retrieves the optional configuration parameters of the specified service.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-queryservicedynamicinformation"><strong>QueryServiceDynamicInformation</strong></a></td>
<td>Retrieves dynamic information related to the current service start.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/winsvc/nf-winsvc-queryserviceobjectsecurity"><strong>QueryServiceObjectSecurity</strong></a></td>
<td>Retrieves a copy of the security descriptor associated with a service object.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-queryservicestatusex"><strong>QueryServiceStatusEx</strong></a></td>
<td>Retrieves the current status of the specified service based on the specified information level.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/winsvc/nf-winsvc-setserviceobjectsecurity"><strong>SetServiceObjectSecurity</strong></a></td>
<td>Sets the security descriptor of a service object.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winsvc/nf-winsvc-startservicea"><strong>StartService</strong></a></td>
<td>Starts a service.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Obsolete Functions</h2>
<p>The following functions are obsolete.<!-- raw HTML omitted --></p>
<p><a href="/windows/desktop/api/Winsvc/nf-winsvc-enumservicesstatusa"><strong>EnumServicesStatus</strong></a><br />
<a href="/windows/desktop/api/Winsvc/nf-winsvc-lockservicedatabase"><strong>LockServiceDatabase</strong></a><br />
<a href="/windows/desktop/api/Winsvc/nf-winsvc-queryservicelockstatusa"><strong>QueryServiceLockStatus</strong></a><br />
<a href="/windows/desktop/api/Winsvc/nf-winsvc-queryservicestatus"><strong>QueryServiceStatus</strong></a><br />
<a href="/windows/desktop/api/Winsvc/nf-winsvc-unlockservicedatabase"><strong>UnlockServiceDatabase</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
