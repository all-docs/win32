<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Service Changes for Windows Vista</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: There have been significant changes to the services model to improve performance, reliability, security, management, and administration of services.
ms.assetid: b1c09468-51e1-4ffd-bf07-6faa9f9336dd
title: Service Changes for Windows Vista
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Service Changes for Windows Vista</h1>
<p>There have been significant changes to the services model to improve performance, reliability, security, management, and administration of services.</p>
<p>The following table summarizes the enhancements to services for Windows Vista.</p>
<table>
<thead>
<tr>
<th>Enhancement</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Delayed Auto-Start<!-- raw HTML omitted --></td>
<td>Delayed auto-start services are started shortly after the system has started. This improves system startup performance while still providing automatic startup for these services. To set the delayed auto-start flag, call the <a href="/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a"><strong>ChangeServiceConfig2</strong></a> function with <strong>SERVICE_CONFIG_DELAYED_AUTO_START_INFO</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Failure Detection and Recovery<!-- raw HTML omitted --></td>
<td>If a service fails, the service control manager (SCM) can perform a failure action, such as restarting the service in an attempt to recover from that failure. To configure a failure action, call <a href="/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a"><strong>ChangeServiceConfig2</strong></a> with <strong>SERVICE_CONFIG_FAILURE_ACTIONS</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Preshutdown Notifications<!-- raw HTML omitted --></td>
<td>A service can register to receive a <strong>SERVICE_CONTROL_PRESHUTDOWN</strong> notification in its <a href="/windows/desktop/api/WinSvc/nc-winsvc-lphandler_function_ex"><em>HandlerEx</em></a> function before it receives the actual shutdown notification. This provides services with a lengthy shutdown procedure more time to shut down gracefully. To set the time-out value, call <a href="/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a"><strong>ChangeServiceConfig2</strong></a> with <strong>SERVICE_CONFIG_PRESHUTDOWN_INFO</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Restricted Network Access<!-- raw HTML omitted --></td>
<td>You can use service SIDs to restrict access to ports, protocols, or the direction of network traffic. To restrict a service's access to the network, use the <a href="/windows/desktop/api/netfw/nn-netfw-inetfwservicerestriction"><strong>INetFwServiceRestriction</strong></a> interface.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Running with Least Privilege<!-- raw HTML omitted --></td>
<td>Services can run under any account that contains the required privileges (LocalService, NetworkService, LocalSystem, a domain account, or a local account) and indicate the required privileges by calling <a href="/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a"><strong>ChangeServiceConfig2</strong></a> with <strong>SERVICE_CONFIG_REQUIRED_PRIVILEGES_INFO</strong>. The SCM removes any privileges that are not required.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Service Isolation<!-- raw HTML omitted --></td>
<td>A service can isolate objects, such as files or registry keys, for its exclusive use by securing them with an access control entry that contains a service SID. After this SID has been assigned to a service, the service owner can modify the objects' access control lists to grant access to the SID. This enables a service to access specific objects without running under a high-privilege account or lowering the security on the objects. To set the service SID, call <a href="/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a"><strong>ChangeServiceConfig2</strong></a> with <strong>SERVICE_CONFIG_SERVICE_SID_INFO</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Service State Change Notifications<!-- raw HTML omitted --></td>
<td>Services can register to be notified when a service is created, deleted, or has a change in status by using the <a href="/windows/desktop/api/Winsvc/nf-winsvc-notifyservicestatuschangea"><strong>NotifyServiceStatusChange</strong></a> function. This is more efficient than calling the <a href="/windows/desktop/api/Winsvc/nf-winsvc-queryservicestatusex"><strong>QueryServiceStatusEx</strong></a> function in a loop to poll for status.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Session 0 Isolation<!-- raw HTML omitted --></td>
<td>Services have always run in session 0. Before Windows Vista, the first user to log on was also assigned to session 0. Now, session 0 is reserved exclusively for services and other applications not associated with an interactive user session. (The first user to log on is connected to session 1, the second user to log on is connected to session 2, and so on.) Session 0 does not support processes that interact with the user.<!-- raw HTML omitted --> This change means that a service cannot post or send a message to an application and an application cannot send or post a message to a service. In addition, services cannot display a user interface item such as a dialog box directly. A service can use the <a href="/windows/desktop/api/wtsapi32/nf-wtsapi32-wtssendmessagea"><strong>WTSSendMessage</strong></a> function to display a dialog box in another session.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="services.html">Services</a></p>
<!-- raw HTML omitted -->
</body>
