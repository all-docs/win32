<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Service Control Requests</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: To send control requests to a running service, a service control program uses the ControlService function.
ms.assetid: d6cdc876-8b74-460e-ad43-6455ddf428dd
title: Service Control Requests
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Service Control Requests</h1>
<p>To send control requests to a running service, a service control program uses the <a href="/windows/desktop/api/Winsvc/nf-winsvc-controlservice"><strong>ControlService</strong></a> function. This function specifies a control value that is passed to the <a href="/windows/desktop/api/WinSvc/nc-winsvc-lphandler_function_ex"><strong>HandlerEx</strong></a> function of the specified service. This control value can be a user-defined code, or it can be one of the standard codes that enable the calling program to perform the following actions:</p>
<ul>
<li>Stop a service (SERVICE_CONTROL_STOP).</li>
<li>Pause a service (SERVICE_CONTROL_PAUSE).</li>
<li>Resume executing a paused service (SERVICE_CONTROL_CONTINUE).</li>
<li>Retrieve updated status information from a service (SERVICE_CONTROL_INTERROGATE).</li>
</ul>
<p>Each service specifies the control values that it will accept and process. To determine which of the standard control values are accepted by a service, use the <a href="/windows/desktop/api/Winsvc/nf-winsvc-queryservicestatusex"><strong>QueryServiceStatusEx</strong></a> function or specify the SERVICE_CONTROL_INTERROGATE control value in a call to the <a href="/windows/desktop/api/Winsvc/nf-winsvc-controlservice"><strong>ControlService</strong></a> function. The <strong>dwControlsAccepted</strong> member of the <a href="/windows/desktop/api/Winsvc/ns-winsvc-service_status"><strong>SERVICE_STATUS</strong></a> structure returned by these functions indicates whether the service can be stopped, paused, or resumed. All services accept the SERVICE_CONTROL_INTERROGATE control value.</p>
<p>The <a href="/windows/desktop/api/Winsvc/nf-winsvc-queryservicestatusex"><strong>QueryServiceStatusEx</strong></a> function reports the most recent status for a specified service, but does not get an updated status from the service itself. Using the SERVICE_CONTROL_INTERROGATE control value in a call to <a href="/windows/desktop/api/Winsvc/nf-winsvc-controlservice"><strong>ControlService</strong></a> ensures that the status information returned is current.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="controlling-a-service-using-sc.html">Controlling a Service Using SC</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
