<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Closing and Deleting Files</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: To use operating system resources efficiently, an application should close files when they are no longer needed by using the CloseHandle function. If a file is open when an application terminates, the system closes it automatically.
ms.assetid: 6cf9694a-00c4-4750-8822-c25a1a102fd4
title: Closing and Deleting Files
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Closing and Deleting Files</h1>
<p>To use operating system resources efficiently, an application should close files when they are no longer needed by using the <a href="/windows/desktop/api/handleapi/nf-handleapi-closehandle"><strong>CloseHandle</strong></a> function. If a file is open when an application terminates, the system closes it automatically.</p>
<p>The <a href="/windows/desktop/api/FileAPI/nf-fileapi-deletefilea"><strong>DeleteFile</strong></a> function can be used to delete a file on close. A file cannot be deleted until all handles to it are closed. If a file cannot be deleted, its name cannot be reused. To reuse a file name immediately, rename the existing file.</p>
<p>If you are deleting an open file or directory on a remote machine and it has already been opened on the remote machine without the read share permission set, do not call <a href="/windows/desktop/api/FileAPI/nf-fileapi-createfilea"><strong>CreateFile</strong></a> or <a href="/windows/desktop/api/WinBase/nf-winbase-openfile"><strong>OpenFile</strong></a> to open the file or directory for deletion first. Doing so will result in a sharing violation.</p>
<p>Â </p>
<p>Â </p>
</body>
