<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Registering an Instance Provider</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: To create a WMI instance provider you must register the __Win32Provider instance that represents your provider using an instance of __InstanceProviderRegistration.
ms.assetid: 5ac8e964-606f-4010-84a8-7c0ae6ca2133
ms.tgt_platform: multiple
title: Registering an Instance Provider
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Registering an Instance Provider</h1>
<p>To create a WMI <a href="gloss-i.html"><em>instance provider</em></a> you must register the <a href="--win32provider.html"><strong>__Win32Provider</strong></a> instance that represents your provider using an instance of <a href="--instanceproviderregistration.html"><strong>__InstanceProviderRegistration</strong></a>. As a COM object, your provider must register with the operating system and WMI. The following procedure assumes that you have already implemented the registration process as described in <a href="registering-a-provider.html">Registering a Provider</a>.</p>
<p>The following procedure describes how to register an instance provider.</p>
<p><strong>To register an instance provider</strong></p>
<ol>
<li>
<p>Create an instance of the <a href="--win32provider.html"><strong>__Win32Provider</strong></a> class that describes the provider.</p>
</li>
<li>
<p>Create an instance of the <a href="--instanceproviderregistration.html"><strong>__InstanceProviderRegistration</strong></a> class that describes the feature set of the provider.</p>
<p>The <a href="--instanceproviderregistration.html"><strong>__InstanceProviderRegistration</strong></a> class inherits many properties from the <a href="--objectproviderregistration.html"><strong>__ObjectProviderRegistration</strong></a> parent class, which provides Boolean values that indicate support for particular features and an array of strings to indicate query support.</p>
<p>Be sure to tag the class with both the <a href="standard-wmi-qualifiers.html"><strong>Dynamic</strong></a> and <a href="/windows/desktop/api/Provider/nl-provider-provider"><strong>Provider</strong></a> qualifiers. The qualifier signals that WMI should use a <strong>Dynamic</strong> provider to retrieve the class instances. The <strong>Provider</strong> qualifier specifies the name of the provider that WMI should use.</p>
</li>
</ol>
<p>The following code example describes how to register a <a href="--win32provider.html"><strong>__Win32Provider</strong></a> and <a href="--instanceproviderregistration.html"><strong>__InstanceProviderRegistration</strong></a> instance.</p>
<pre lang="syntax"><code>instance of __Win32Provider as $P
{
    Name=&quot;TestProv&quot;;
    CLSID=&quot;{A41602A4-C038-11d1-AEB6-00C04FB68820}&quot;;
};

instance of __InstanceProviderRegistration
{
    Provider = $P;
    SupportsGet = TRUE;
    SupportsEnumeration = TRUE;
    QuerySupportLevels = { &quot;WQL:UnarySelect&quot; };
};
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
