<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>LogFileEventConsumer class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The LogFileEventConsumer class writes customized strings to a text log file when events are delivered to it.
ms.assetid: 8934b60e-3763-4b85-89fd-58fe6136dff6
ms.tgt_platform: multiple
title: LogFileEventConsumer class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>LogFileEventConsumer</li>
<li>LogFileEventConsumer.CreatorSID</li>
<li>LogFileEventConsumer.MachineName</li>
<li>LogFileEventConsumer.MaximumQueueSize</li>
<li>LogFileEventConsumer.Filename</li>
<li>LogFileEventConsumer.IsUnicode</li>
<li>LogFileEventConsumer.MaximumFileSize</li>
<li>LogFileEventConsumer.Name</li>
<li>LogFileEventConsumer.Text
api_type:</li>
<li>DllExport
api_location:</li>
<li>Wbemcons.dll</li>
</ul>
<hr />
<h1>LogFileEventConsumer class</h1>
<p>The <strong>LogFileEventConsumer</strong> class writes customized strings to a text log file when events are delivered to it. The strings are separated by end-of-line sequences. This class is one of the standard event consumers that WMI provides. For more information, see <a href="monitoring-and-responding-to-events-with-standard-consumers.html">Monitoring and Responding to Events with Standard Consumers</a>.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[AMENDMENT]
class LogFileEventConsumer : __EventConsumer
{
  uint8   CreatorSID[];
  string  MachineName;
  uint32  MaximumQueueSize;
  string  Filename;
  boolean IsUnicode;
  uint64  MaximumFileSize = 65535;
  string  Name;
  string  Text;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>LogFileEventConsumer</strong> class has these types of members:</p>
<ul>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Properties</h3>
<p>The <strong>LogFileEventConsumer</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>CreatorSID</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint8</strong> array</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Security identifier (SID) that uniquely identifies the user who creates a filter. WMI stores the SID of the user who creates an instance of <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a> or the Administrator SID, depending on the operating system. For more information, see <a href="binding-an-event-filter-with-a-logical-consumer.html">Binding an Event Filter with a Logical Consumer</a> and <a href="monitoring-and-responding-to-events-with-standard-consumers.html">Monitoring and Responding to Events with Standard Consumers</a>.</p>
<p>This property is inherited from <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>Filename</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Name of a file that includes the path to which the log entries are appended. If the file does not exist, <strong>LogFileEventConsumer</strong> attempts to create it. The consumer fails when the path does not exist, or when the user who creates the consumer does not have write permissions for the file or path.</p>
<!-- raw HTML omitted -->
<p><strong>IsUnicode</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>If <strong>TRUE</strong>, the log file is a Unicode text file. If <strong>FALSE</strong>, the log file is a multibyte code text file. If the file exists, this property is ignored and the current file setting is used. For example, if <strong>IsUnicode</strong> is <strong>FALSE</strong>, but the existing file is a Unicode file, then Unicode is used. If <strong>IsUnicode</strong> is <strong>TRUE</strong>, but the file is multibyte code, then multibyte code is used.</p>
<!-- raw HTML omitted -->
<p><strong>MachineName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Name of the computer to which Windows Management Instrumentation (WMI) sends events.</p>
<p>This property is inherited from <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>MaximumFileSize</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint64</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Maximum size of a log file in bytes. If the primary file exceeds its maximum size, the contents are moved to a different file and the primary file is emptied. A value of 0 (zero) means there is no size limit. The default value is 65,535 bytes. The size of the file is checked before a write operation. Therefore, you can have a file that is slightly larger than the specified size limit. The next write operation catches it and starts a new file.</p>
<p>The following list identifies the naming structure for the backup file:</p>
<ul>
<li>If the original filename is 8.3, the extension is replaced by a string in the format of &quot;001&quot;, &quot;002&quot;, and so on with the smallest number larger than all the previously used and chosen numbers. If &quot;999&quot; is used, then the number chosen is the smallest unused number.</li>
<li>If the original filename is not 8.3, a string in the format of &quot;001&quot;, &quot;002&quot;, and so on is appended to the file name.</li>
</ul>
<p>For more information about using <strong>uint64</strong> values in scripts, see <a href="/windows/desktop/WmiSdk/creating-a-wmi-script">Scripting in WMI</a>.</p>
<!-- raw HTML omitted -->
<p><strong>MaximumQueueSize</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Maximum queue for a specific consumer, in bytes.</p>
<p>This property is inherited from <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>Name</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="key-qualifier.html"><strong>key</strong></a></p>
<!-- raw HTML omitted -->
<p>Unique name for this consumer.</p>
<!-- raw HTML omitted -->
<p><strong>Text</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Standard string <a href="using-standard-string-templates.html">template</a> for the text of a log entry.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<blockquote>
<p>[!Note]<br />
The <strong>LogFileEventConsumer</strong> does not secure the log file. Therefore, when you configure the <strong>LogFileEventConsumer</strong>, it is important to specify a directory that is secured to the level that you require.</p>
</blockquote>
<p>The <strong>LogFileEventConsumer</strong> class is derived from the <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a> abstract class.</p>
<h2>Examples</h2>
<p>For an example of using <strong>LogFileEventConsumer</strong> to create a consumer, see <a href="writing-to-a-log-file-based-on-an-event.html">Writing to a Log File Based on an Event</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\subscription<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemcons.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemcons.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="standard-consumer-classes.html">Standard Consumer Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="writing-to-a-log-file-based-on-an-event.html">Writing to a Log File Based on an Event</a></p>
<!-- raw HTML omitted -->
<p><a href="creating-a-logical-consumer.html">Creating a Logical Consumer</a></p>
<!-- raw HTML omitted -->
<p><a href="receiving-events-at-all-times.html">Receiving Events At All Times</a></p>
<!-- raw HTML omitted -->
<p><a href="--eventconsumer.html"><strong>__EventConsumer</strong></a></p>
<!-- raw HTML omitted -->
</body>
