<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SMTPEventConsumer class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The SMTPEventConsumer class sends an email message by using Simple Mail Transfer Protocol (SMTP) each time an event is delivered to it.
ms.assetid: 42178360-9e22-4cd1-9b72-5f6b0d7e6c9c
ms.tgt_platform: multiple
title: SMTPEventConsumer class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>SMTPEventConsumer</li>
<li>SMTPEventConsumer.CreatorSID</li>
<li>SMTPEventConsumer.MachineName</li>
<li>SMTPEventConsumer.MaximumQueueSize</li>
<li>SMTPEventConsumer.BccLine</li>
<li>SMTPEventConsumer.CcLine</li>
<li>SMTPEventConsumer.FromLine</li>
<li>SMTPEventConsumer.HeaderFields</li>
<li>SMTPEventConsumer.Message</li>
<li>SMTPEventConsumer.Name</li>
<li>SMTPEventConsumer.ReplyToLine</li>
<li>SMTPEventConsumer.SMTPServer</li>
<li>SMTPEventConsumer.Subject</li>
<li>SMTPEventConsumer.ToLine
api_type:</li>
<li>DllExport
api_location:</li>
<li>Smtpcons.dll</li>
</ul>
<hr />
<h1>SMTPEventConsumer class</h1>
<p>The <strong>SMTPEventConsumer</strong> class sends an email message by using Simple Mail Transfer Protocol (SMTP) each time an event is delivered to it. An SMTP server must exist on the network. The SMTPEventConsumer class does not support attachments. The encoding of the email message must be US-ASCII.</p>
<p>This class is one of the standard event consumers that WMI provides. For an example of using <strong>SMTPEventConsumer</strong> to create a consumer, see <a href="sending-e-mail-based-on-an-event.html">Sending Email Based on an Event</a>. For more information, see <a href="monitoring-and-responding-to-events-with-standard-consumers.html">Monitoring and Responding to Events with Standard Consumers</a>.</p>
<p>The following syntax is simplified from Managed Object Format (MOF) code and includes all of its inherited properties. Properties and methods are in alphabetic order, not MOF order.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[AMENDMENT]
class SMTPEventConsumer : __EventConsumer
{
  uint8  CreatorSID[];
  string MachineName;
  uint32 MaximumQueueSize;
  string BccLine;
  string CcLine;
  string FromLine;
  string HeaderFields[];
  string Message;
  string Name;
  string ReplyToLine;
  string SMTPServer;
  string Subject;
  string ToLine;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>SMTPEventConsumer</strong> class has these types of members:</p>
<ul>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Properties</h3>
<p>The <strong>SMTPEventConsumer</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>BccLine</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>A list of addresses, separated by a comma or semicolon, in the format of a standard string template to which the message is sent as a blind carbon copy. For more information, see the Remarks section of this topic.</p>
<!-- raw HTML omitted -->
<p><strong>CcLine</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>A list of addresses, separated by a comma or semicolon, in the format of a standard string template to which the message is sent as a carbon copy. For more information, see the Remarks section of this topic.</p>
<!-- raw HTML omitted -->
<p><strong>CreatorSID</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint8</strong> array</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Security identifier (SID) that uniquely identifies the user who creates a filter. WMI stores the SID of the user who creates an instance of <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a> or the Administrator SID, depending on the operating system. For more information, see <a href="binding-an-event-filter-with-a-logical-consumer.html">Binding an Event Filter with a Logical Consumer</a> and <a href="monitoring-and-responding-to-events-with-standard-consumers.html">Monitoring and Responding to Events with Standard Consumers</a>.</p>
<p>This property is inherited from <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>FromLine</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>From line of an email message in the format of a standard string template. If <strong>NULL</strong>, a From line is constructed in the form of &quot;WinMgmt@<em>MachineName</em>&quot;.</p>
<!-- raw HTML omitted -->
<p><strong>HeaderFields</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong> array</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Array of header fields that are inserted into an email message without interpretation.</p>
<!-- raw HTML omitted -->
<p><strong>MachineName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Name of the computer to which Windows Management Instrumentation (WMI) sends events.</p>
<p>This property is inherited from <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>MaximumQueueSize</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Maximum queue for a specific consumer, in bytes.</p>
<p>This property is inherited from <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>Message</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Standard string template that contains the body of an email message.</p>
<!-- raw HTML omitted -->
<p><strong>Name</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="key-qualifier.html"><strong>key</strong></a></p>
<!-- raw HTML omitted -->
<p>Unique identifier for the event consumer.</p>
<!-- raw HTML omitted -->
<p><strong>ReplyToLine</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Reply-to line of an email message in the format of a standard string template. If <strong>NULL</strong>, no Reply-to line is used.</p>
<!-- raw HTML omitted -->
<p><strong>SMTPServer</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Name of the SMTP server through which an email is sent. Permissible names are an IP address, or a DNS or NetBIOS name. This property cannot be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><strong>Subject</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Standard string template that contains the subject of an email message.</p>
<!-- raw HTML omitted -->
<p><strong>ToLine</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>A list of addresses, separated by a comma or semicolon, in the format of a standard string template that identifies where the message is to be sent. For more information, see the Remarks section of this topic.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The SMTPEventConsumer class is derived from the <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a> abstract class.</p>
<p>Some of the <strong>ToLine</strong>, <strong>CcLine</strong>, or <strong>BccLine</strong> properties can be <strong>NULL</strong>, but they cannot all be <strong>NULL</strong>.</p>
<p>Receiving an error return code from the SMTP service is considered a failure.</p>
<h2>Examples</h2>
<p>For an example of using <strong>SMTPEventConsumer</strong> to create a consumer, see <a href="sending-e-mail-based-on-an-event.html">Sending Email Based on an Event</a>. For more information, see <a href="monitoring-and-responding-to-events-with-standard-consumers.html">Monitoring and Responding to Events with Standard Consumers</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\subscription<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Smtpcons.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Smtpcons.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="--eventconsumer.html"><strong>__EventConsumer</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="standard-consumer-classes.html">Standard Consumer Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="sending-e-mail-based-on-an-event.html">Sending Email Based on an Event</a></p>
<!-- raw HTML omitted -->
<p><a href="creating-a-logical-consumer.html">Creating a Logical Consumer</a></p>
<!-- raw HTML omitted -->
<p><a href="receiving-events-at-all-times.html">Receiving Events At All Times</a></p>
<!-- raw HTML omitted -->
</body>
