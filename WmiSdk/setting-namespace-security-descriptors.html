<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Setting Namespace Security Descriptors</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Both C++ applications and scripts running under a full administrator account can change a namespace security descriptor.
ms.assetid: d3e56b30-d5a8-446a-89aa-645b44a75af6
ms.tgt_platform: multiple
title: Setting Namespace Security Descriptors
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Setting Namespace Security Descriptors</h1>
<p>Both C++ applications and scripts running under a full administrator account can change a namespace security descriptor.</p>
<h2>Namespace Security Descriptors</h2>
<p>Each WMI namespace has a <a href="/windows/desktop/SecGloss/s-gly"><em>security descriptor</em></a>, which allows each namespace to have unique security settings that determine who has access to the namespace data and methods. For more information about WMI access security, see <a href="access-to-wmi-securable-objects.html">Access to WMI Securable Objects</a>. <a href="access-to-wmi-namespaces.html">Access to WMI Namespaces</a> describes the default security settings for WMI namespaces and security auditing in WMI.</p>
<p>You can set account permissions for each WMI namespace in the WMI (CIM) repository in the following ways:</p>
<ul>
<li>When the namespace is created in the MOF file. For more information, see <a href="setting-namespace-security-when-the-namespace-is-created.html">Setting Namespace Security When the Namespace is Created</a>.</li>
<li>Manually, using the WMI Control. For more information, see <a href="setting-namespace-security-with-the-wmi-control.html">Setting Namespace Security with the WMI Control</a>.</li>
<li>Programmatically, by calling the methods of the <a href="--systemsecurity.html"><strong>__SystemSecurity</strong></a> class.</li>
</ul>
<p>The following methods of the <a href="--systemsecurity.html"><strong>__SystemSecurity</strong></a> object associated with each namespace allow you to read or change security on a namespace.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="--systemsecurity-getcalleraccessrights.html"><strong>GetCallerAccessRights</strong></a></p>
<!-- raw HTML omitted -->
<p>Sets the <em>rights</em> parameter as a bitmap with each bit corresponding to an access right.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="--systemsecurity-getsd.html"><strong>GetSD</strong></a></p>
<!-- raw HTML omitted -->
<p>Gets the security descriptor for the namespace to which the user is connected. This method returns a security descriptor in binary byte array format. If you are writing a script, use the <a href="getsecuritydescriptor-method-in-class---systemsecurity-.html"><strong>GetSecurityDescriptor</strong></a> method.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="--systemsecurity-setsd.html"><strong>SetSD</strong></a></p>
<!-- raw HTML omitted -->
<p>Sets the security descriptor (SD) for the namespace to which a user is connected. This method requires a security descriptor in binary byte array format. If you are writing a script, use the <a href="setsecuritydescriptor-method-in-class---systemsecurity.html"><strong>SetSecurityDescriptor</strong></a> method.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="getsecuritydescriptor-method-in-class---systemsecurity-.html"><strong>GetSecurityDescriptor</strong></a></p>
<!-- raw HTML omitted -->
<p>Gets the security descriptor that controls access to the WMI namespace associated with the instance of <a href="--systemsecurity.html"><strong>__SystemSecurity</strong></a>. The security descriptor is returned as an instance of<a href="--securitydescriptor.html"><strong>__SecurityDescriptor</strong></a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="setsecuritydescriptor-method-in-class---systemsecurity.html"><strong>SetSecurityDescriptor</strong></a></p>
<!-- raw HTML omitted -->
<p>Writes an updated version of the security descriptor that controls access to the printer. The security descriptor is represented by an instance of <a href="--securitydescriptor.html"><strong>__SecurityDescriptor</strong></a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="--systemsecurity-get9xuserlist.html"><strong>Get9XUserList</strong></a></p>
<!-- raw HTML omitted -->
<p>Gets the remote access rights for a list of individual users on computers running obsolete versions of Windows, where access control through Windows security descriptors is not available.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="--systemsecurity-set9xuserlist.html"><strong>Set9XUserList</strong></a></p>
<!-- raw HTML omitted -->
<p>Sets the remote access rights for a list of individual users on computers running obsolete versions of Windows, where access control through Windows security descriptors is not available.</p>
<!-- raw HTML omitted -->
<p>If you are writing scripts, use the <a href="getsecuritydescriptor-method-in-class---systemsecurity-.html"><strong>GetSecurityDescriptor</strong></a> and <a href="setsecuritydescriptor-method-in-class---systemsecurity.html"><strong>SetSecurityDescriptor</strong></a>. You can use the methods of the <a href="/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptorhelper"><strong>Win32_SecurityDescriptorHelper</strong></a> class to alter the security descriptors.</p>
<p>If you are programming in C++, you can manipulate the binary security descriptor using <a href="/windows/desktop/SecAuthZ/security-descriptor-definition-language">Security Descriptor Definition Language (SDDL)</a>, and the conversion methods <a href="/windows/desktop/api/sddl/nf-sddl-convertsecuritydescriptortostringsecuritydescriptora"><strong>ConvertSecurityDescriptorToStringSecurityDescriptor</strong></a> and <a href="/windows/desktop/api/sddl/nf-sddl-convertstringsecuritydescriptortosecuritydescriptora"><strong>ConvertStringSecurityDescriptorToSecurityDescriptor</strong></a>.</p>
<p>Be aware that, starting with WindowsÂ Vista, <a href="https://support.microsoft.com/topic/how-to-use-user-account-control-uac-in-windows-vista-33b5a65e-4238-397e-d1b4-c502ee0f473e">User Account Control</a> (UAC) affects access to WMI data and what can be configured with the <a href="gloss-w.html"><em>WMI Control</em></a>. For more information, see <a href="user-account-control-and-wmi.html">User Account Control and WMI</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="securing-wmi-namespaces.html">Securing WMI Namespaces</a></p>
<!-- raw HTML omitted -->
<p><a href="wmi-security-constants.html">WMI Security Constants</a></p>
<!-- raw HTML omitted -->
<p><a href="access-to-wmi-namespaces.html">Access to WMI Namespaces</a></p>
<!-- raw HTML omitted -->
<p><a href="wmi-security-descriptor-objects.html">WMI Security Descriptor Objects</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
