<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Writing a Method Provider</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: A method provider allows WMI access to the methods of a class. For example, a class that represents an application may have a method that terminates the application.
ms.assetid: bce87e65-5cba-4eef-91da-a3e13c80b8a6
ms.tgt_platform: multiple
title: Writing a Method Provider
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Writing a Method Provider</h1>
<p>A method provider allows WMI access to the methods of a class. For example, a class that represents an application may have a method that terminates the application.</p>
<p>Changing the order of method input and output parameters when updating an existing method provider can cause failure for applications that call the method. The order of the input or output parameters is established by the value of the <a href="standard-wmi-qualifiers.html"><strong>ID</strong></a> qualifier on each parameter. The first parameter has an <strong>ID</strong> value of zero. Add new input parameters at the end of the existing parameters rather than inserting them in the already established sequence.</p>
<p>The following procedure describes how to implement a method provider.</p>
<p><strong>To implement a method provider</strong></p>
<ol>
<li>
<p>Design and register your class provider with WMI.</p>
<p>Class providers register with WMI by creating a <a href="--win32provider.html"><strong>__Win32Provider</strong></a> instance and a <a href="--methodproviderregistration.html"><strong>__MethodProviderRegistration</strong></a> class. For more information, see <a href="registering-a-method-provider.html">Registering a Method Provider</a>.</p>
</li>
<li>
<p>Implement the <a href="/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit"><strong>IWbemProviderInit</strong></a> interface for your provider.</p>
<blockquote>
<p>[!Note]<br />
Method providers are strongly encouraged to use the multithreading model &quot;Both&quot;.</p>
</blockquote>
<p>Â </p>
</li>
<li>
<p>Implement the <a href="/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-execmethodasync"><strong>IWbemServices::ExecMethodAsync</strong></a> method for your provider.</p>
<p>The <a href="/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices"><strong>IWbemServices</strong></a> interface is the primary interface for a method provider. For more information, see <a href="implementing-the-primary-interface-for-a-method-provider.html">Implementing the Primary Interface for a Method Provider</a>.</p>
</li>
<li>
<p>Add any additional code necessary for your provider.</p>
<p>When designing your provider, you will most likely need to call WMI interfaces. For more information, see <a href="calling-a-method.html">Calling a Method</a> and <a href="impersonating-a-client.html">Maintaining Security Levels in a Provider</a>.</p>
<p>When retrieving information for a client, you may need to access the security levels for that client. For more information, see <a href="impersonating-a-client.html">Impersonating a Client</a>.</p>
</li>
<li>
<p>Replace the preexisting provider with your new code.</p>
<p>You do not need to perform this step if you do not have a preexisting provider to copy over. For more information, see <a href="updating-a-provider.html">Updating a Provider</a>.</p>
</li>
</ol>
<p>Â </p>
<p>Â </p>
</body>
