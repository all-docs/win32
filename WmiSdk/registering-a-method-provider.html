<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Registering a Method Provider</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: To create a WMI method provider you must register the __Win32Provider instance that represents your provider using an instance of __MethodProviderRegistration.
ms.assetid: 1cfb16ae-8dcf-437d-b779-db2f30bb0d34
ms.tgt_platform: multiple
title: Registering a Method Provider
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Registering a Method Provider</h1>
<p>To create a WMI <a href="gloss-m.html"><em>method provider</em></a> you must register the <a href="--win32provider.html"><strong>__Win32Provider</strong></a> instance that represents your provider using an instance of <a href="--methodproviderregistration.html"><strong>__MethodProviderRegistration</strong></a>. After creating an instance of <a href="--win32provider.html"><strong>__Win32Provider</strong></a>, you must register that provider with WMI. As a COM object, your provider must register with the operating system and WMI. The following procedure assumes that you have already implemented the registration process as described in <a href="registering-a-provider.html">Registering a Provider</a>.</p>
<p>The following procedure describes how to register a method provider.</p>
<p><strong>To register a method provider</strong></p>
<ol>
<li>
<p>Create an instance of the <a href="--win32provider.html"><strong>__Win32Provider</strong></a> class that describes the provider.</p>
<p>The <a href="--methodproviderregistration.html"><strong>__MethodProviderRegistration</strong></a> system class inherits many properties from the <a href="--objectproviderregistration.html"><strong>__ObjectProviderRegistration</strong></a> parent class, However, the only property relevant for a method provider is the object path to the <a href="--win32provider.html"><strong>__Win32Provider</strong></a> instance.</p>
</li>
<li>
<p>Create an instance of the <a href="--methodproviderregistration.html"><strong>__MethodProviderRegistration</strong></a> class that describes the feature set of the provider.</p>
<p>Be sure to tag the class with both the <a href="dynamic-qualifier.html"><strong>Dynamic</strong></a> and <a href="/windows/desktop/api/Provider/nl-provider-provider"><strong>Provider</strong></a> qualifiers. The <strong>Dynamic</strong> qualifier signals that WMI should use a provider to retrieve the class instances. The <strong>Provider</strong> qualifier specifies the name of the provider that WMI should use.</p>
</li>
</ol>
<p>The following code example describes how to register a method provider.</p>
<pre lang="syntax"><code>  instance of __Win32Provider as $P
  {
    Name    = &quot;MethProvider&quot; ;
    ClsId   = &quot;{E30EC6A0-23CF-11d1-8FDE-0000F804AA5C}&quot; ;
  };    

  instance of __MethodProviderRegistration
  {
    Provider = $P;
  };
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
