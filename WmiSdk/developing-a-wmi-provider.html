<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Developing a WMI Provider</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: A provider is a Component Object Model (COM) object that acts as an intermediary between WMI and a managed object.
ms.assetid: a4f537ba-9081-43b4-acff-4d206de3d9d7
ms.tgt_platform: multiple
title: Developing a WMI Provider
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Developing a WMI Provider</h1>
<p>A provider is a Component Object Model (COM) object that acts as an intermediary between WMI and a managed object. For example, when an application or script requests disk data using the WMI <a href="/windows/desktop/CIMWin32Prov/win32-logicaldisk"><strong>Win32_LogicalDisk</strong></a> class, the data is obtained dynamically through the preinstalled <a href="/windows/desktop/CIMWin32Prov/win32-provider">Win32 provider</a>.</p>
<p>If you want to supply data through WMI to other applications, you can create an unmanaged code provider by writing a COM server or through the <strong>WMI ATL wizards</strong> in Visual Studio. You can write a managed code provider by using WMI in the .NET Framework. The topics in this section describe the process of writing an unmanaged COM provider.</p>
<blockquote>
<p>[!Note]<br />
To ensure that all of your WMI class definitions for managed objects are restored to the <a href="gloss-w.html"><em>WMI repository</em></a> if WMI has a failure and restarts, use the <a href="pragma-autorecover.html"><strong>#pragma autorecover</strong></a> preprocessor instruction in your Managed Object Format (MOF) file.</p>
</blockquote>
<p>A provider consists of classes defined in the <a href="gloss-m.html"><em>Managed Object Format (MOF)</em></a> schema and a DLL file which carries out the functions of the provider. For example, the MOF that defines the classes of the Win32 provider is CIMWin32.mof and the DLL is CIMWin32.dll, both are found in %windir%\System32\Wbem.</p>
<p>The MOF schema for the provider may contain several provider types. For example, the <a href="/previous-versions/windows/desktop/eventlogprov/event-log-provider">Event Log Provider</a> has instance, method, and event provider types in one MOF file named Ntevt.mof. It is recommended that all of the classes and registration schema for related providers be assembled in one file, rather than creating one file per class.</p>
<p>In addition to using preinstalled providers, you can create your own provider to supply information about a hardware device or the operations of software.</p>
<p>The following table lists the basic tasks that create a provider.</p>
<table>
<thead>
<tr>
<th>Task</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="designing-managed-object-format--mof--classes.html">Designing Managed Object Format (MOF) Classes</a></td>
<td>Develop a model for the entities you want to manage through WMI and create a Managed Object Format (MOF) file to describe the schema.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="supplying-data-to-wmi-by-writing-a-provider.html">Supplying Data to WMI by Writing a Provider</a></td>
<td>Create the most basic provider that is coupled to WMI.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="incorporating-a-provider-in-an-application.html">Incorporating a Provider in an Application</a></td>
<td>Include the provider as a component within an application if it does not run all of the time.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="registering-a-provider.html">Registering a Provider</a></td>
<td>Register the provider with COM and WMI.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="initializing-a-provider.html">Initializing a Provider</a></td>
<td>Implement the <a href="/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit"><strong>IWbemProviderInit</strong></a> and <a href="/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinitsink"><strong>IWbemProviderInitSink</strong></a> interfaces.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="making-calls-to-wmi.html">Making Calls to WMI</a></td>
<td>Call WMI interfaces from a provider.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="impersonating-a-client.html">Impersonating a Client</a></td>
<td>Set security to access a client application.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="updating-a-provider.html">Updating a Provider</a></td>
<td>Improve the provider as needed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="unloading-a-provider.html">Unloading a Provider</a></td>
<td>Remove the provider from memory during shutdown or when the provider is idle.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="debugging-providers.html">Debugging Providers</a> and <a href="provider-configuration-and-troubleshooting-classes.html">Provider Configuration and Troubleshooting Classes</a></td>
<td>Debug your provider using facilities supplied by WMI.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="getting-and-providing-data-on-a-64-bit-computer.html">Getting and Providing Data on a 64-bit Computer</a></td>
<td>Evaluate whether you need a 32-bit application compatibility provider or if the 64-bit provider can supply data to both clients.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>The following topics discuss the steps needed to write different types of providers:</p>
<ul>
<li><a href="writing-an-instance-provider.html">Writing an Instance Provider</a></li>
<li><a href="writing-a-method-provider.html">Writing a Method Provider</a></li>
<li><a href="writing-an-event-provider.html">Writing an Event Provider</a></li>
<li><a href="writing-an-event-consumer-provider.html">Writing an Event Consumer Provider</a></li>
<li><a href="writing-a-class-provider.html">Writing a Class Provider</a></li>
<li><a href="writing-a-property-provider.html">Writing a Property Provider</a></li>
<li><a href="making-an-instance-provider-into-a-high-performance-provider.html">Making an Instance Provider into a High-Performance Provider</a></li>
</ul>
</body>
