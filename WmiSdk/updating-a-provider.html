<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Updating a Provider</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Sometimes you may need to install a newer version of a provider onto a running system.
ms.assetid: 44c4c16a-fd79-483a-81ef-a0f74a2cdf45
ms.tgt_platform: multiple
title: Updating a Provider
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Updating a Provider</h1>
<p>Sometimes you may need to install a newer version of a provider onto a running system. If your provider is installed as a DLL, you can install a new provider without having to restart the service, reboot the computer, or otherwise affect any applications using WMI at that time.</p>
<p>The following procedure describes how to update a provider.</p>
<p><strong>To update a provider</strong></p>
<ol>
<li>
<p>Build the new provider.</p>
<ol>
<li>
<p>Compile the new provider with a different DLL name and a different <strong>CLSID</strong>.</p>
<p>For example, change Myprov.dll to Myprov1.dll, and <strong>CLSID_MyProProv</strong> to <strong>CLSID_MyProv</strong>1.</p>
</li>
<li>
<p>Modify the provider registration MOF file to use the new CLSID (CLSID_MyProv1), but the same provider name (&quot;MyProv&quot;).</p>
</li>
</ol>
</li>
<li>
<p>Install the new provider.</p>
<ol>
<li>
<p>Copy the new provider DLL with the new name alongside the old one.</p>
</li>
<li>
<p>Self-register the new provider.</p>
<p>For example, use the <strong>regsvr32</strong> <strong>myprov1.dll</strong> command to register the new provider.</p>
</li>
<li>
<p>Compile the new provider registration MOF, thus overwriting the old provider registration. Until this point, the old provider was fully functional; now the new provider is fully operational.</p>
</li>
</ol>
</li>
<li>
<p>Remove the old version of the provider, if necessary.</p>
<ol>
<li>
<p>Unregister the old DLL.</p>
<p>For example, use the <strong>regsvr32</strong> <strong>/umyprov.dll</strong> command to unregister the old DLL.</p>
</li>
<li>
<p>Mark the old DLL to be deleted on reboot by calling <a href="/windows/desktop/api/winbase/nf-winbase-movefileexa"><strong>MoveFileEx</strong></a>.</p>
</li>
</ol>
</li>
</ol>
<p>You can take similar steps to upgrade a local server-implemented provider.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="developing-a-wmi-provider.html">Developing a WMI Provider</a></p>
<!-- raw HTML omitted -->
<p><a href="setting-namespace-security-descriptors.html">Setting Namepace Security Descriptors</a></p>
<!-- raw HTML omitted -->
<p><a href="securing-your-provider.html">Securing Your Provider</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
