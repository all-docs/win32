<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>NTEventLogEventConsumer class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The NTEventLogEventConsumer class logs a specific message to the operating system event log when an event is delivered to it.
ms.assetid: cf986812-f09a-4f32-ba76-db76a23e2e4c
ms.tgt_platform: multiple
title: NTEventLogEventConsumer class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>NTEventLogEventConsumer</li>
<li>NTEventLogEventConsumer.CreatorSID</li>
<li>NTEventLogEventConsumer.MachineName</li>
<li>NTEventLogEventConsumer.MaximumQueueSize</li>
<li>NTEventLogEventConsumer.Category</li>
<li>NTEventLogEventConsumer.NameOfRawDataProperty</li>
<li>NTEventLogEventConsumer.EventID</li>
<li>NTEventLogEventConsumer.EventType</li>
<li>NTEventLogEventConsumer.InsertionStringTemplates</li>
<li>NTEventLogEventConsumer.Name</li>
<li>NTEventLogEventConsumer.NumberOfInsertionStrings</li>
<li>NTEventLogEventConsumer.NameOfUserSidProperty</li>
<li>NTEventLogEventConsumer.SourceName</li>
<li>NTEventLogEventConsumer.UNCServerName
api_type:</li>
<li>DllExport
api_location:</li>
<li>Wbemcons.dll</li>
</ul>
<hr />
<h1>NTEventLogEventConsumer class</h1>
<p>The <strong>NTEventLogEventConsumer</strong> class logs a specific message to the operating system event log when an event is delivered to it. This class is one of the standard event consumers that WMI provides. For more information, see <a href="monitoring-and-responding-to-events-with-standard-consumers.html">Monitoring and Responding to Events with Standard Consumers</a>.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[AMENDMENT]
class NTEventLogEventConsumer : __EventConsumer
{
  uint8  CreatorSID[];
  string MachineName;
  uint32 MaximumQueueSize;
  uint16 Category;
  string NameOfRawDataProperty;
  uint32 EventID;
  uint32 EventType = 1;
  string InsertionStringTemplates[] = {&quot;&quot;};
  string Name;
  uint32 NumberOfInsertionStrings = 0;
  string NameOfUserSidProperty;
  string SourceName;
  string UNCServerName;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>NTEventLogEventConsumer</strong> class has these types of members:</p>
<ul>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Properties</h3>
<p>The <strong>NTEventLogEventConsumer</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>Category</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint16</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Event category. This is source-specific information and can have any value.</p>
<!-- raw HTML omitted -->
<p><strong>CreatorSID</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint8</strong> array</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Security identifier (SID) that uniquely identifies the user who creates a filter. WMI stores the SID of the user who creates an instance of <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a> or the Administrator SID, depending on the operating system. For more information, see <a href="binding-an-event-filter-with-a-logical-consumer.html">Binding an Event Filter with a Logical Consumer</a> and <a href="monitoring-and-responding-to-events-with-standard-consumers.html">Monitoring and Responding to Events with Standard Consumers</a>.</p>
<p>This property is inherited from <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>EventID</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Event message in the message DLL. This property cannot be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><strong>EventType</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Type of event. This parameter can have one of the values listed in the following list, which are defined in Winnt.h.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>EVENTLOG_SUCCESS</strong> (0 (0x0))</p>
<!-- raw HTML omitted -->
<p>Successful event</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>EVENTLOG_ERROR_TPYE</strong> (1 (0x1))</p>
<!-- raw HTML omitted -->
<p>Error event</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>EVENTLOG_WARNING_TYPE</strong> (2 (0x2))</p>
<!-- raw HTML omitted -->
<p>Warning event</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>EVENTLOG_INFORMATION_TYPE</strong> (4 (0x4))</p>
<!-- raw HTML omitted -->
<p>Information event</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>EVENTLOG_AUDIT_SUCCESS</strong> (8 (0x8))</p>
<!-- raw HTML omitted -->
<p>Success audit type</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>EVENTLOG_AUDIT_FAILURE</strong> (16 (0x10))</p>
<!-- raw HTML omitted -->
<p>Failure audit type</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>InsertionStringTemplates</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong> array</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Array of standard string templates that is used as the insertion string for an event log record.</p>
<!-- raw HTML omitted -->
<p><strong>MachineName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Name of the computer to which Windows Management Instrumentation (WMI) sends events.</p>
<p>This property is inherited from <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>MaximumQueueSize</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Maximum queue for a specific consumer, in bytes.</p>
<p>This property is inherited from <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>Name</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="key-qualifier.html"><strong>key</strong></a></p>
<!-- raw HTML omitted -->
<p>Unique name of a consumer.</p>
<!-- raw HTML omitted -->
<p><strong>NameOfRawDataProperty</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Name of the event property that contains data to be passed to the <a href="/windows/desktop/api/winbase/nf-winbase-reporteventa"><strong>ReportEvent</strong></a> function <em>lpRawData</em> parameter.</p>
<!-- raw HTML omitted -->
<p><strong>NameOfUserSidProperty</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Name of the event property that contains a security identifier (SID) to be passed to the <a href="/windows/desktop/api/winbase/nf-winbase-reporteventa"><strong>ReportEvent</strong></a> function <em>lpUserSid</em> parameter. The property must be either an array of bytes (<strong>uint8</strong>) or a string. If it is an array of bytes, it is assumed to be a SID. If it is a string, it is a string SID that is converted into a SID.</p>
<!-- raw HTML omitted -->
<p><strong>NumberOfInsertionStrings</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Number of elements in the <strong>InsertionStringTemplates</strong> array.</p>
<!-- raw HTML omitted -->
<p><strong>SourceName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Source name where a message is located. The customer is assumed to have registered a DLL with the necessary messages.</p>
<blockquote>
<p>[!Note]<br />
The value of this parameter must not include a colon (:) character.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><strong>UNCServerName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Name of the computer on which to log an event, or <strong>NULL</strong> if the event is to be logged on a local server.</p>
<p>Authenticated users cannot, by default, log events to the Application log on a remote computer. As a result, using this property to specify a remote computer will not work. To learn how to change event log security, consult this <a href="https://support.microsoft.com/kb/323076">KB article</a>.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The <strong>NTEventLogEventConsumer</strong> class is derived from the <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a> abstract class.</p>
<h2>Examples</h2>
<p>For an example of using <strong>NTEventLogEventConsumer</strong> to create a consumer, see <a href="logging-to-nt-event-log-based-on-an-event.html">Logging to NT Event Log Based on an Event</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\subscription<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemcons.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemcons.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="standard-consumer-classes.html">Standard Consumer Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="creating-a-logical-consumer.html">Creating a Logical Consumer</a></p>
<!-- raw HTML omitted -->
<p><a href="receiving-events-at-all-times.html">Receiving Events At All Times</a></p>
<!-- raw HTML omitted -->
<p><a href="--eventconsumer.html"><strong>__EventConsumer</strong></a></p>
<!-- raw HTML omitted -->
</body>
