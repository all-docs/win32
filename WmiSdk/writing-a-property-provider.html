<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Writing a Property Provider</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: A property provider retrieves and modifies individual property values for instances of a given class that is stored in the WMI repository.
ms.assetid: fe150157-cf9d-47da-8f94-b18eb0502bd8
ms.tgt_platform: multiple
title: Writing a Property Provider
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Writing a Property Provider</h1>
<p>A property provider retrieves and modifies individual property values for instances of a given class that is stored in the WMI repository.</p>
<p>The following procedure describes how to create a property provider.</p>
<p><strong>To create a property provider</strong></p>
<ol>
<li>
<p>Design and register your provider with WMI.</p>
<p>Instance providers register with WMI by creating a <a href="--win32provider.html"><strong>__Win32Provider</strong></a> instance and a <a href="--propertyproviderregistration.html"><strong>__PropertyProviderRegistration</strong></a> class. For more information, see <a href="registering-a-property-provider.html">Registering a Property Provider</a>.</p>
</li>
<li>
<p>Implement the <a href="/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit"><strong>IWbemProviderInit</strong></a> interface for your provider.</p>
<p>WMI uses <a href="/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit"><strong>IWbemProviderInit</strong></a> to load and initialize a provider. This is a task common to all providers. For more information, see <a href="initializing-a-provider.html">Initializing a Provider</a>.</p>
<blockquote>
<p>[!Note]<br />
Property providers are strongly encouraged to use the multithreading model &quot;Both&quot;.</p>
</blockquote>
<p>Â </p>
</li>
<li>
<p>Implement the <a href="/windows/desktop/api/Wbemprov/nn-wbemprov-iwbempropertyprovider"><strong>IWbemPropertyProvider</strong></a> interface for your provider.</p>
<p>The <a href="/windows/desktop/api/Wbemprov/nn-wbemprov-iwbempropertyprovider"><strong>IWbemPropertyProvider</strong></a> interface is the primary interface for a property provider. The two main methods are <a href="/windows/desktop/api/Wbemprov/nf-wbemprov-iwbempropertyprovider-getproperty"><strong>GetProperty</strong></a> and <a href="/windows/desktop/api/Wbemprov/nf-wbemprov-iwbempropertyprovider-putproperty"><strong>PutProperty</strong></a>. For more information, see <a href="implementing-the-primary-interface-for-a-property-provider.html">Implementing the Primary Interface for a Property Provider</a>.</p>
</li>
<li>
<p>Add any additional code necessary for your provider.</p>
<p>When designing your provider, you will most likely need to call WMI interfaces. For more information, see <a href="calling-a-method.html">Calling a Method</a> and <a href="impersonating-a-client.html">Maintaining Security Levels in a Provider</a>.</p>
<p>When retrieving information for a client, you may need to access the security levels for that client. For more information, see <a href="impersonating-a-client.html">Impersonating a Client</a>.</p>
</li>
<li>
<p>Replace the preexisting provider with your new code.</p>
<p>You do not need to perform this step if you do not have a preexisting provider to copy over. For more information, see <a href="updating-a-provider.html">Updating a Provider</a>.</p>
</li>
</ol>
<p>Â </p>
<p>Â </p>
</body>
