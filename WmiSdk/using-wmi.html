<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using WMI</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Roadmap to using WMI to obtain data for client scripts and applications or to provide data to WMI from an application.
ms.assetid: d9a3741c-313f-4b63-8588-696a10d370f5
ms.tgt_platform: multiple
title: Using WMI
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using WMI</h1>
<p>You can use WMI from client applications and scripts. It provides an infrastructure that makes it easy to both discover and perform management tasks. In addition, you can add to the set of possible management tasks by creating your own WMI providers.</p>
<blockquote>
<p>[!Note]<br />
The next-generation version of WMI for writing applications and scripts is available through the Windows Management Infrastructure (MI). For more information, see <a href="/previous-versions/windows/desktop/wmi_v2/mi-providers-and-clients-node-page">MI Providers and Clients</a>.</p>
</blockquote>
<p>The following topics are discussed in this section:</p>
<ul>
<li><a href="#obtaining-data-from-wmi">Obtaining Data from WMI</a></li>
<li><a href="#providing-data-to-wmi">Providing Data to WMI</a></li>
<li><a href="#important-tasks-for-wmi">Important Tasks for WMI</a></li>
</ul>
<h2>Obtaining Data from WMI</h2>
<p>The following procedure describes how to obtain data from WMI by writing a script or application.</p>
<p><strong>To obtain data from WMI by writing a script or application</strong></p>
<ol>
<li>
<p>Decide which language to use. For more information about scripting, see <a href="creating-a-wmi-script.html">Creating a WMI Script</a>. For more information about C++, see <a href="creating-a-wmi-application-using-c-.html">Creating a WMI Application Using C++</a>. For using more information about C# or WMI .NET, see <a href="/previous-versions/">WMI .NET Overview</a>.</p>
<p>You can view or manipulate WMI data in many languages. The following table lists the topics that describe how to use the scripting and application languages to obtain data.</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>Application language</th>
<th>Topic</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scripts written in Microsoft ActiveX script hosting, including Visual Basic Scripting Edition (VBScript) and Perl<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Scripting API for WMI<!-- raw HTML omitted -->.<!-- raw HTML omitted --> Start with <!-- raw HTML omitted -->Creating a WMI Script<!-- raw HTML omitted -->.<!-- raw HTML omitted --> For script code examples, see <!-- raw HTML omitted -->WMI Tasks for Scripts and Applications<!-- raw HTML omitted --> and the TechNet <!-- raw HTML omitted -->ScriptCenter<!-- raw HTML omitted --> Script Repository.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Windows PowerShell<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Getting Started with Windows PowerShell<!-- raw HTML omitted --><!-- raw HTML omitted --> WMI PowerShell Cmdlets, such as <!-- raw HTML omitted -->Get-WmiObject<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Visual Basic applications<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Scripting API for WMI<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Active Server Pages<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Scripting API for WMI<!-- raw HTML omitted -->.<!-- raw HTML omitted --> Start with <!-- raw HTML omitted -->Creating Active Server Pages for WMI<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>C++ applications<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->COM API for WMI<!-- raw HTML omitted -->.<!-- raw HTML omitted --> Start with <!-- raw HTML omitted -->Creating a WMI Application Using C++<!-- raw HTML omitted --> and <!-- raw HTML omitted -->WMI C++ Application Examples<!-- raw HTML omitted --> (contains examples).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>.NET Framework applications written in C#, Visual Basic .NET, or J#<!-- raw HTML omitted --></td>
<td>Classes in the <a href="/previous-versions//hh872326(v=vs.85)"><strong>Microsoft.Management.Infrastructure</strong></a> namespace.<!-- raw HTML omitted -->     <strong>Note:</strong> <strong>System.Management</strong> was the original namespace that covered managed code for WMI. However, the underlying technology for <strong>System.Management</strong> is generally slower than, and does not scale as well as, <a href="/previous-versions//hh872326(v=vs.85)"><strong>Microsoft.Management.Infrastructure</strong></a>. As such, it is not recommended that you use <strong>System.Management</strong> for new projects. (For more information on <strong>System.Management</strong>, see <a href="/previous-versions/bb404655(v=vs.90)">WMI .NET Overview</a>.)    <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<ol start="2">
<li>
<p>Ensure that your connections to remote computers work.</p>
<p>For more information, see <a href="connecting-to-wmi-on-a-remote-computer.html">Connecting to WMI on a Remote Computer</a>.</p>
</li>
<li>
<p>Connecting to WMI on remote computers requires the correct security settings, as explained in <a href="maintaining-wmi-security.html">Maintaining WMI Security</a>. The following table lists the topics that describe how to configure security settings with the scripting and application languages.</p>
<table>
<thead>
<tr>
<th>Language</th>
<th>Topic</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scripts in any language, Visual Basic applications<!-- raw HTML omitted --></td>
<td><a href="setting-the-default-process-security-level-using-vbscript.html">Setting the Default Process Security Level Using VBScript</a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Active Server Pages<!-- raw HTML omitted --></td>
<td><a href="configuring-iis-5-for-wmi-asp-scripting.html">Configuring IIS 5 and Later for WMI ASP Scripting</a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>C++<!-- raw HTML omitted --></td>
<td><a href="setting-the-default-process-security-level-using-c-.html">Setting the Default Process Security Level Using C++</a> and <a href="setting-the-security-on-iwbemservices-and-other-proxies.html">Setting the Security on IWbemServices and Other Proxies</a><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>After connecting to WMI, you can obtain data through queries and enumerations.</p>
<p>For more information, see <a href="manipulating-class-and-instance-information.html">Manipulating Class and Instance Information</a> and <a href="querying-with-wql.html">Querying with WQL</a>.</p>
</li>
<li>
<p>Registry data is available through WMI and you can create new keys and values or modify existing ones.</p>
<p>For more information, see <a href="modifying-the-system-registry.html">Modifying the System Registry</a>.</p>
</li>
<li>
<p>You can subscribe to event notifications through WMI, either temporarily between system reboots or permanently.</p>
<p>For more information, see <a href="monitoring-events.html">Monitoring Events</a> and <a href="receiving-a-wmi-event.html">Receiving a WMI Event</a>.</p>
</li>
<li>
<p>Performance counter data for a system is available through WMI.</p>
<p>The system performance library counters are converted to WMI classes. For more information, see <a href="monitoring-performance-data.html">Monitoring Performance Data</a>.</p>
</li>
<li>
<p><a href="wmi-tasks-for-scripts-and-applications.html">WMI Tasks for Scripts and Applications</a> describes how to do many administrative tasks with WMI.</p>
</li>
</ol>
<h2>Providing Data to WMI</h2>
<p>The following procedure describes how to supply data to WMI by writing a provider.</p>
<p><strong>To supply data to WMI by writing a provider</strong></p>
<ul>
<li>
<p>Decide on the type of provider to write.</p>
<p>You cannot write a WMI provider in VBScript. However, you can take several other approaches to writing a WMI COM provider:</p>
<ul>
<li>
<p>Using the WMI ATL Wizard in Visual Studio.</p>
<p>This approach creates an unmanaged COM provider. For more information, see <a href="./writing-an-instance-provider.html">Adding a WMI Instance Provider</a> and <a href="./writing-an-event-provider.html">Adding a WMI Event Provider</a>.</p>
</li>
<li>
<p>Using COM directly in any integrated development environment.</p>
<p>This approach creates an unmanaged COM provider.</p>
</li>
<li>
<p>Using WMI in the .NET Framework to create a managed code provider.</p>
<p>This approach creates a managed code provider. Managed code providers can be written in any .NET Framework language, are simpler to write than WMI COM providers, and can obtain data from the WMI <a href="gloss-c.html"><em>CIM</em></a>-based classes such as <a href="/windows/desktop/CIMWin32Prov/win32-provider">Win32 Classes</a>. However, the .NET Framework WMI provider has some limitations. For more information, see <a href="/previous-versions/dotnet/netframework-1.1/aa720264(v=vs.71)">Managing Applications Using WMI</a>.</p>
</li>
<li>
<p>Using the <a href="wmi-c-classes.html">provider framework classes</a> is not recommended.</p>
<p>The provider framework has been superseded by the WMI ATL wizards, using COM directly, or .NET Framework providers. Creating a WMI COM provider with the provider framework classes is no longer recommended. The following table lists the topics that describe how to use COM or .NET Framework providers.</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Provider</th>
<th>Topic</th>
</tr>
</thead>
<tbody>
<tr>
<td>COM provider in the same process as WMI<!-- raw HTML omitted --></td>
<td><a href="providing-data-to-wmi.html">Providing Data to WMI</a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>COM decoupled provider<!-- raw HTML omitted --></td>
<td><a href="incorporating-a-provider-in-an-application.html">Incorporating a Provider in an Application</a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>.NET Framework provider in C# or Visual Basic.NET<!-- raw HTML omitted --></td>
<td><a href="/previous-versions/dotnet/netframework-1.1/aa720264(v=vs.71)">Managing Applications Using WMI</a><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</li>
</ul>
<h2>Important Tasks for WMI</h2>
<p>The following topics provide information about using WMI to monitor and control enterprise components.</p>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="wmi-tasks-for-scripts-and-applications.html">WMI Tasks for Scripts and Applications</a><!-- raw HTML omitted --></td>
<td>Describes how to find the correct WMI class and procedures to use in scripts and applications that perform common computer and network administration tasks, such as adding a new printer connection for a remote computer or finding all the installed hotfixes on a computer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="creating-a-wmi-application-or-script.html">Creating a WMI Application or Script</a><!-- raw HTML omitted --></td>
<td>Any scripting language, such as VBScript or Perl, that works with ActiveX objects can access WMI data. Applications can access WMI in C++, using the <a href="com-api-for-wmi.html">COM API for WMI</a> or in Visual Basic, using the Wbemdisp.tlb<a href="using-the-wmi-scripting-type-library.html">type library</a> and the <a href="scripting-api-for-wmi.html">Scripting API for WMI</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="connecting-to-wmi-on-a-remote-computer.html">Connecting to WMI on a Remote Computer</a><!-- raw HTML omitted --></td>
<td>Describes how scripts, applications, and providers can establish connections to WMI on remote computers to obtain data or control hardware and software.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="connecting-to-wmi-on-a-remote-computer-by-using-powershell.html">Connecting to WMI on a Remote Computer by Using Windows PowerShell</a><!-- raw HTML omitted --></td>
<td>Describes how to use Windows PowerShell to establish connections to WMI on remote computers to obtain data or to control hardware and software.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="monitoring-events.html">Monitoring Events</a><!-- raw HTML omitted --></td>
<td>Describes how to get event notifications by creating temporary or permanent WMI event consumers.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="providing-data-to-wmi.html">Providing Data to WMI</a><!-- raw HTML omitted --></td>
<td>WMI supplies dynamic management data to client scripts and applications by obtaining it from providers.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="getting-and-providing-data-on-a-64-bit-computer.html">Getting and Providing Data on a 64-bit Computer</a><!-- raw HTML omitted --></td>
<td>Describes how to access nondefault providers and considerations for provider writers on 64-bit systems.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
