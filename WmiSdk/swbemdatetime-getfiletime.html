<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SWbemDateTime.GetFileTime method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Converts a date and time value in the CIM DATETIME format to the FILETIME format.
ms.assetid: 08e0761d-e735-454a-8429-2bd1eb331123
ms.tgt_platform: multiple
title: SWbemDateTime.GetFileTime method (Wbemdisp.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>SWbemDateTime.GetFileTime</li>
<li>ISWbemDateTime.GetFileTime</li>
<li>ISWbemDateTime.GetFileTime
api_type:</li>
<li>COM
api_location:</li>
<li>Wbemdisp.dll</li>
</ul>
<hr />
<h1>SWbemDateTime.GetFileTime method</h1>
<p>The <strong>GetFileTime</strong> method of the <a href="swbemdatetime.html"><strong>SWbemDateTime</strong></a> object converts a date and time value in the CIM <a href="datetime.html">DATETIME</a> format to the FILETIME format.</p>
<p>If the parameter is set to <strong>TRUE</strong>, then the return value represents a local time for the client. Otherwise, the return value is a Coordinated Universal Time (UTC) time. A <strong>FILETIME</strong> <a href="datetime.html">DATETIME</a> structure is a 64-bit value that represents the number of 100-nanosecond units since the beginning of January 1, 1601. Windows Management Instrumentation (WMI) treats <strong>FILETIME</strong> values as string representations of unsigned 64-bit numbers.</p>
<p>For an explanation of this syntax, see <a href="document-conventions-for-the-scripting-api.html">Document Conventions for the Scripting API</a>.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>vDate = .GetFileTime( _
  [ ByVal bIsLocaL ] _
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>bIsLocaL</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Indicates whether the returned value is interpreted as local time. The UTC property then contains the local time converted to the correct Coordinated Universal Times (UTC) offset. If the value is <strong>FALSE</strong>, then the value is interpreted as UTC with a zero (0) offset.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>The date and time in the <strong>FILETIME</strong> format.</p>
<h2>Error codes</h2>
<p>After completing the <strong>GetFileTime</strong> method, the <a href="/previous-versions//sbf5ze0e(v=vs.85)">Err</a> object may contain the error code in the following list.</p>
<!-- raw HTML omitted -->
<p><strong>wbemErrFailed</strong> - 2147749889 (0x80041001)</p>
<!-- raw HTML omitted -->
<p>The call failed.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p><strong>VT_DATE</strong> and <strong>FILETIME</strong> values cannot contain wildcard fields.</p>
<p>The <strong>GetFileTime</strong> method fails (wbemErrFailed) if any of the following properties are <strong>FALSE</strong>:</p>
<ul>
<li><a href="swbemdatetime-yearspecified.html"><strong>YearSpecified</strong></a></li>
<li><a href="swbemdatetime-monthspecified.html"><strong>MonthSpecified</strong></a></li>
<li><a href="swbemdatetime-dayspecified.html"><strong>DaySpecified</strong></a></li>
<li><a href="swbemdatetime-hoursspecified.html"><strong>HoursSpecified</strong></a></li>
<li><a href="swbemdatetime-minutesspecified.html"><strong>MinutesSpecified</strong></a></li>
<li><a href="swbemdatetime-secondsspecified.html"><strong>SecondsSpecified</strong></a></li>
<li><a href="swbemdatetime-microsecondsspecified.html"><strong>MicrosecondsSpecified</strong></a></li>
<li><a href="swbemdatetime-utcspecified.html"><strong>UTCSpecified</strong></a></li>
</ul>
<p>On a successful return from <a href="swbemdatetime-setfiletime.html"><strong>SetFileTime</strong></a>, all of these properties are set to <strong>TRUE</strong>.</p>
<h2>Examples</h2>
<p>For examples of using the <a href="swbemdatetime.html"><strong>SWbemDateTime</strong></a> object to convert CIM <a href="datetime.html"><strong>DATETIME</strong></a> values to and from either the <strong>FILETIME</strong> format or the <strong>VT_DATE</strong> format, see <a href="wmi-tasks--dates-and-times.html">WMI Tasks: Dates and Times</a>. For a description of the CIM <strong>DATETIME</strong> format, see <a href="date-and-time-format.html">Date and Time Format</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemdisp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Type library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemdisp.tlb<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemdisp.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>CLSID<!-- raw HTML omitted --></td>
<td>CLSID_SWbemDateTime<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_ISWbemDateTime<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="swbemdatetime-getvardate.html"><strong>SWbemDateTime.GetVarDate</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="swbemdatetime.html"><strong>SWbemDateTime</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="datetime.html"><strong>DATETIME</strong></a></p>
<!-- raw HTML omitted -->
</body>
