<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Cleaning up and Shutting Down a WMI Application</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: After you set the security levels for your IWbemServices pointer, you can access the various capabilities of WMI. After you finish using WMI, you must shut down your application.
ms.assetid: 32bc7dd8-cb05-4354-bf46-f4359ac1f0d8
ms.tgt_platform: multiple
title: Cleaning up and Shutting Down a WMI Application
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Cleaning up and Shutting Down a WMI Application</h1>
<p>After you set the security levels for your <a href="/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices"><strong>IWbemServices</strong></a> pointer, you can access the various capabilities of WMI. After you finish using WMI, you must shut down your application.</p>
<p>The following procedure describes how to clean up and shut down a WMI application.</p>
<p><strong>To clean up and shut down a WMI application</strong></p>
<ol>
<li>
<p>Release any open COM interfaces.</p>
<p>The two primary interfaces you must remember to release are <a href="/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices"><strong>IWbemServices</strong></a> and <a href="/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemlocator"><strong>IWbemLocator</strong></a>.</p>
</li>
<li>
<p>Call <a href="/windows/win32/api/combaseapi/nf-combaseapi-couninitialize"><strong>CoUninitialize</strong></a>.</p>
<p>As with all COM applications, you must call <a href="/windows/win32/api/combaseapi/nf-combaseapi-couninitialize"><strong>CoUninitialize</strong></a> at the end of your application.</p>
</li>
<li>
<p>Exit your application.</p>
<p>The following code example shows how to exit a WMI client application.</p>
<pre lang="C++"><code>    // The following #include and #define statements need
    // to be used with this code:
    // #define _WIN32_DCOM
    // #include &lt;wbemidl.h&gt;  
    // #pragma comment(lib, &quot;wbemuuid.lib&quot;)
    
    // pSvc was declared as IWbemServices *pSvc;
    // pLoc was declared as IWbemLocator *pLoc;

    pSvc-&gt;Release();
    pLoc-&gt;Release();     
    CoUninitialize();
    return 0;   // Program successfully completed.
</code></pre>
<blockquote>
<p>[!Note]<br />
The <code>pSvc</code> variable is of type <a href="/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices"><strong>IWbemServices</strong></a>*, and the pLoc variable is of type <a href="/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemlocator"><strong>IWbemLocator</strong></a>*.</p>
</blockquote>
<p>Â </p>
</li>
</ol>
<p>You have now successfully initialized COM, accessed WMI, and exited your application. For more information, see <a href="example-creating-a-wmi-application.html">Example: Creating a WMI Application</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="creating-a-wmi-application-using-c-.html">Creating a WMI Application Using C++</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
