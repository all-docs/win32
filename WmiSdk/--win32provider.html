<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>__Win32Provider class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Registers information about the physical implementation of a provider in WMI. Providers that do not set the HostingModel property are loaded, by default, to run in a Wmiprvse.exe process as NetworkServiceHostOrSelfHost.
ms.assetid: 41e0d938-00c6-4f4c-8027-8b8512398dee
ms.tgt_platform: multiple
title: '__Win32Provider class'
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>kbSyntax
api_name:
api_type:
api_location:</li>
</ul>
<hr />
<h1>__Win32Provider class</h1>
<p>The <strong>__Win32Provider</strong> system class registers information about the physical implementation of a provider in WMI. Providers that do not set the <strong>HostingModel</strong> property are loaded, by default, to run in a Wmiprvse.exe process as <strong>NetworkServiceHostOrSelfHost</strong>.</p>
<p>The following syntax is simplified from Managed Object Format (MOF) code and includes all inherited properties. Properties are listed in alphabetic order, not MOF order.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>class __Win32Provider : __Provider
{
  string   ClientLoadableCLSID;
  string   CLSID;
  sint32   Concurrency;
  string   DefaultMachineName;
  boolean  Enabled;
  string   HostingModel;
  sint32   ImpersonationLevel = 0;
  sint32   InitializationReentrancy;
  datetime InitializationTimeoutInterval;
  boolean  InitializeAsAdminFirst;
  string   Name;
  datetime OperationTimeoutInterval;
  boolean  PerLocaleInitialization = FALSE;
  boolean  PerUserInitialization = FALSE;
  boolean  Pure = TRUE;
  string   SecurityDescriptor;
  boolean  SupportsExplicitShutdown;
  boolean  SupportsExtendedStatus;
  boolean  SupportsQuotas;
  boolean  SupportsSendStatus;
  boolean  SupportsShutdown;
  boolean  SupportsThrottling;
  datetime UnloadTimeout;
  uint32   Version;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>__Win32Provider</strong> class has these types of members:</p>
<ul>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Properties</h3>
<p>The <strong>__Win32Provider</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>ClientLoadableCLSID</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Class identifier that WMI uses to determine whether or not to load a high performance provider into the client process or the WMI process. If both the provider and client are located on the same computer, WMI loads the provider in-process to the client by using <strong>ClientLoadableCLSID</strong> as the class identifier. When the provider and client are located on different computers, WMI loads the provider in-process to WMI. WMI also uses <strong>ClientLoadableCLSID</strong> to support refresh operations.</p>
<p>For more information, see <a href="registering-a-high-performance-provider.html">Registering a High-Performance Provider.</a></p>
<!-- raw HTML omitted -->
<p><strong>CLSID</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p><strong>GUID</strong> that represents the class identifier (<strong>CLSID</strong>) of the provider COM object. This COM object must contain an implementation of the <a href="/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit"><strong>IWbemProviderInit</strong></a> interface.</p>
<!-- raw HTML omitted -->
<p><strong>Concurrency</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>sint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><strong>DefaultMachineName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Identifies the computer on which to start the provider. If the provider runs on the local computer it is <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><strong>Enabled</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>If <strong>TRUE</strong>, this instance is enabled and can be used to complete client requests.</p>
<!-- raw HTML omitted -->
<p><strong>HostingModel</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>This property is composed of values from the <a href="/previous-versions/windows/desktop/wmisystemprov/msft-providers"><strong>MSFT_Providers</strong></a> <strong>HostingGroup</strong> and <strong>HostingSpecification</strong> properties. The value of this property specifies how WMI loads the provider and the security account it runs under. For more information about setting the <strong>HostingModel</strong> property, see <a href="provider-hosting-and-security.html">Provider Hosting and Security</a> and <a href="registering-a-provider.html">Registering a Provider</a>.</p>
<!-- raw HTML omitted -->
<p><strong>ImpersonationLevel</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>sint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Reserved. The default value is zero (0).</p>
<!-- raw HTML omitted -->
<p><strong>InitializationReentrancy</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>sint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Set of flags that provide information about serialization. The default value is zero (0).</p>
<!-- raw HTML omitted -->
<p>0</p>
<!-- raw HTML omitted -->
<p>All initialization of this provider must be serialized.</p>
<!-- raw HTML omitted -->
<p>1</p>
<!-- raw HTML omitted -->
<p>All initializations of this provider in the same namespace must be serialized.</p>
<!-- raw HTML omitted -->
<p>2</p>
<!-- raw HTML omitted -->
<p>No initialization serialization is necessary.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>InitializationTimeoutInterval</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>datetime</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><strong>InitializeAsAdminFirst</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>TBD</p>
<!-- raw HTML omitted -->
<p><strong>Name</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="standard-qualifiers.html"><strong>Key</strong></a></p>
<!-- raw HTML omitted -->
<p>The provider name.</p>
<!-- raw HTML omitted -->
<p><strong>OperationTimeoutInterval</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>datetime</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><strong>PerLocaleInitialization</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>If <strong>TRUE</strong>, the provider is initialized for each locale when a user connects to the same namespace more than one time using different locales. The default value is <strong>FALSE</strong>.</p>
<!-- raw HTML omitted -->
<p><strong>PerUserInitialization</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>If <strong>TRUE</strong>, the provider is initialized one time for each NT LAN Manager (NTLM) user that makes requests to the provider. If <strong>FALSE</strong> (default), the provider is initialized one time for all users.</p>
<!-- raw HTML omitted -->
<p><strong>Pure</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>If <strong>TRUE</strong>, the provider agrees to prepare to unload by calling <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-release"><strong>IUnknown::Release</strong></a> on all outstanding interface points when WMI calls the <strong>Release</strong> method of its primary interface. Providers that must remain clients of WMI after they do not function as providers should set <strong>Pure</strong> to <strong>FALSE</strong>. The default setting is <strong>TRUE</strong>. For more information, see the Remarks section of this topic.</p>
<!-- raw HTML omitted -->
<p><strong>SecurityDescriptor</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Security descriptor (SD) in the Security Descriptor Definition Language (SDDL) that determines the set of users that can successfully call <a href="/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemdecoupledregistrar-register"><strong>IWbemDecoupledRegistrar:Register</strong></a> for the decoupled provider. For more information, see the <a href="/windows/desktop/SecAuthZ/security-descriptor-definition-language">Security Descriptor Definition Language</a> topic in the Security section of the Windows SDK. This security descriptor is used only for decoupled providers, and does not affect other providers. For more information, see <a href="incorporating-a-provider-in-an-application.html">Incorporating a Provider in an Application</a>.</p>
<p>WMI performs access checks for decoupled providers that use the <a href="/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit"><strong>IWbemProviderInit</strong></a> and <a href="iwbemobjectsink.html"><strong>IWbemObjectSink</strong></a> interfaces. If the security descriptor is <strong>NULL</strong>, then only applications or services that run under the LocalSystem, NetworkService, LocalService accounts can run a decoupled provider.</p>
<p>The following string shows a decoupled provider to be run only by built-in Administrators.&quot;O:BAG:BAD:(A;;0x1;;;BA)&quot;</p>
<p>For more information about setting the <strong>SecurityDescriptor</strong> property, see <a href="maintaining-wmi-security.html">Maintaining WMI Security</a>.</p>
<!-- raw HTML omitted -->
<p><strong>SupportsExplicitShutdown</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><strong>SupportsExtendedStatus</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><strong>SupportsQuotas</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><strong>SupportsSendStatus</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><strong>SupportsShutdown</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><strong>SupportsThrottling</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><strong>UnloadTimeout</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>datetime</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p><a href="date-and-time-format.html">Date and Time Format</a> that specifies how long WMI allows the provider to remain idle before it is unloaded. Typically, providers request that WMI wait no longer than five minutes.</p>
<p>For the current version of WMI, the value of this property is ignored. WMI unloads the provider based on the time-out value in an internal class in the \root namespace. It is recommended that providers set <strong>UnloadTimeout</strong>. For more information, see <a href="unloading-a-provider.html">Unloading a Provider</a>.</p>
<!-- raw HTML omitted -->
<p><strong>Version</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Version of the provider. The supported versions are 1 and 2. Version 2 strengthens validity checks for all associated property registrations, specifically the <a href="swbemsecurity-impersonationlevel.html"><strong>ImpersonationLevel</strong></a> property.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The <strong>__Win32Provider</strong> class is derived from <a href="--provider.html"><strong>__Provider</strong></a>.</p>
<p>Most providers can accept the default values for the <strong>InitializationReentrancy</strong> property. However, if a provider can support simultaneous initialization for separate users, this property can be set to 1 (one). If serialized initialization is necessary, <strong>InitializationReentrancy</strong> remains 0 (zero). In both instances, <strong>PerUserInitialization</strong> is set to <strong>TRUE</strong>.</p>
<p>A pure provider or a provider that sets the <strong>Pure</strong> property to <strong>TRUE</strong>, exists only to service requests from applications and WMI. Most providers are pure providers. A nonpure provider is the exception. Nonpure providers transition to the role of client after they complete servicing requests.</p>
<p>An example of a nonpure provider is a push provider that starts to issue queries, and makes requests of WMI after it completes initialization. A push provider does not have responsibilities except to update the CIM repository with data at initialization time. After updating the repository, a push provider can wait to be unloaded, or transition to the role of client. The push provider that waits to be unloaded is a pure provider. The push provider that participates in client activities is nonpure.</p>
<p>WMI must be able to distinguish pure providers from non-pure providers so that it can determine when it is safe to shut down. WMI must wait for all operations that involve non-pure providers to complete before it can shut down safely.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>All WMI namespaces<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/WmiSdk/--provider"><strong>__Provider</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="wmi-system-classes.html">WMI System Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="registering-a-provider.html">Registering a Provider</a></p>
<!-- raw HTML omitted -->
</body>
