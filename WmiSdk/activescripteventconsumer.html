<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ActiveScriptEventConsumer class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Runs a predefined script in an arbitrary scripting language when an event is delivered to it.
ms.assetid: 2c0aa216-4255-49ff-9bbd-d6c62b5b9139
ms.tgt_platform: multiple
title: ActiveScriptEventConsumer class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>ActiveScriptEventConsumer</li>
<li>ActiveScriptEventConsumer.CreatorSID</li>
<li>ActiveScriptEventConsumer.KillTimeout</li>
<li>ActiveScriptEventConsumer.MachineName</li>
<li>ActiveScriptEventConsumer.MaximumQueueSize</li>
<li>ActiveScriptEventConsumer.Name</li>
<li>ActiveScriptEventConsumer.ScriptingEngine</li>
<li>ActiveScriptEventConsumer.ScriptFileName</li>
<li>ActiveScriptEventConsumer.ScriptText
api_type:</li>
<li>DllExport
api_location:</li>
<li>Scrcons.exe</li>
</ul>
<hr />
<h1>ActiveScriptEventConsumer class</h1>
<p>The <strong>ActiveScriptEventConsumer</strong> class runs a predefined script in an arbitrary scripting language when an event is delivered to it. This class is one of the standard event consumers that WMI provides. For more information, see <a href="monitoring-and-responding-to-events-with-standard-consumers.html">Monitoring and Responding to Events with Standard Consumers</a>.</p>
<pre lang="cmd"><code>Mofcomp -n:root\&lt;namespace&gt; scrcons.mof
</code></pre>
<p>You can configure the performance of all instances of <strong>ActiveScriptEventConsumer</strong> on a system by setting the values of either the <a href="scriptingstandardconsumersetting.html"><strong>Timeout</strong></a> or <strong>MaximumScripts</strong> property in the single instance of <strong>ScriptingStandardConsumerSetting</strong>.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[AMENDMENT]
class ActiveScriptEventConsumer : __EventConsumer
{
  uint8  CreatorSID[] = {1,1,0,0,0,0,0,5,18,0,0,0};
  uint32 KillTimeout = 0;
  string MachineName;
  uint32 MaximumQueueSize;
  string Name;
  string ScriptingEngine;
  string ScriptFileName;
  string ScriptText;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>ActiveScriptEventConsumer</strong> class has these types of members:</p>
<ul>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Properties</h3>
<p>The <strong>ActiveScriptEventConsumer</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>CreatorSID</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint8</strong> array</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Array that represents the security identifier (SID), which uniquely identifies the creator of the Active Script Event consumer. This property is inherited from <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>KillTimeout</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Number, in seconds, that the script is allowed to run. If 0 (zero), which is the default, the script is not terminated.</p>
<!-- raw HTML omitted -->
<p><strong>MachineName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Name of the computer to which WMI sends events. By convention of Microsoft standard consumers, the script consumer cannot be run remotely. Third-party consumers can also use this property. This property is inherited from <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>MaximumQueueSize</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Maximum queue, in bytes, for the Active Script Event consumer. This property is inherited from <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>Name</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="standard-qualifiers.html"><strong>Key</strong></a></p>
<!-- raw HTML omitted -->
<p>Unique identifier for the event consumer. If you rename the consumer, the result is two equal consumers that have different names.</p>
<!-- raw HTML omitted -->
<p><strong>ScriptFileName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Name of the file from which the script text is read, intended as an alternative to specifying the text of the script in the <strong>ScriptText</strong> property. This property must be <strong>NULL</strong> if the <strong>ScriptText</strong> property is not <strong>NULL</strong>.</p>
<blockquote>
<p>[!Note]<br />
When you specify the <strong>ScriptFileName</strong>, it is important to secure the executable that you are launching. If the executable is not in a secure location or secured with a strong access control list (ACL), anyone can replace the executable with a different one. For more information about ACLs, see <a href="/windows/desktop/SecAuthZ/creating-a-security-descriptor-for-a-new-object-in-c--">Creating a Security Descriptor (SD) for a New Object in C++</a>.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><strong>ScriptingEngine</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Name of the scripting engine to use, for example, &quot;VBScript&quot;. This property cannot be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><strong>ScriptText</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Text of the script that is expressed in a language known to the scripting engine. This property must be <strong>NULL</strong> if the <strong>ScriptFileName</strong> property is not <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>This class is derived from the <a href="--eventconsumer.html"><strong>__EventConsumer</strong></a> abstract class. It is located in the root\subscription namespace.</p>
<p>When the text of a script is specified in the event consumer instance, the script has access to the event instance in the script environment variable <strong>TargetEvent</strong>.</p>
<p>The scripts run in the LocalSystem security context. As a security measure, only a local system administrator or a domain administrator can configure the scripting consumer. Access rights are not checked until run time. After the consumer is configured, any user can trigger the event that causes the script to .</p>
<p>Failure to load the scripting engine or parse and validate the script is considered a failure. Error return codes from the script and terminating the script by using a time-out are also considered failures.</p>
<p>Either <strong>ScriptText</strong> or <strong>ScriptFileName</strong> must be not <strong>NULL</strong>. If both properties are <strong>NULL</strong> or not <strong>NULL</strong>, an error is generated.</p>
<p>When WMI is run as a service, scripts run by <strong>ActiveScriptEventConsumer</strong> do not generate screen output. Scripts that use <strong>MsgBox</strong> do run, but they do not display information on the screen. Running the WMI service as an executable file is not supported, but WMI allows scripts that use the <strong>MsgBox</strong> function to display output or accept user input. None of the methods provided by the <a href="/previous-versions//at5ydy31(v=vs.85)">WScript</a> object can be used because <strong>ActiveScriptEventConsumer</strong> does not use Windows Script Host (WSH).</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\subscription<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Scrcons.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Scrcons.exe<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="standard-consumer-classes.html">Standard Consumer Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="running-a-script-based-on-an-event.html">Running a Script Based on an Event</a></p>
<!-- raw HTML omitted -->
<p><a href="receiving-events-at-all-times.html">Receiving Events At All Times</a></p>
<!-- raw HTML omitted -->
<p><a href="creating-a-logical-consumer.html">Creating a Logical Consumer</a></p>
<!-- raw HTML omitted -->
<p><a href="--eventconsumer.html"><strong>__EventConsumer</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="scriptingstandardconsumersetting.html"><strong>ScriptingStandardConsumerSetting</strong></a></p>
<!-- raw HTML omitted -->
</body>
