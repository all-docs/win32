<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SWbemDateTime object</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The SWbemDateTime object is a helper object to parse and set Common Information Model (CIM) datetime values.
ms.assetid: 3dd34c73-3c2b-4d59-827b-169cf8020213
ms.tgt_platform: multiple
title: SWbemDateTime object (Wbemdisp.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>SWbemDateTime</li>
<li>ISWbemDateTime
api_type:</li>
<li>COM
api_location:</li>
<li>Wbemdisp.dll</li>
</ul>
<hr />
<h1>SWbemDateTime object</h1>
<p>The <strong>SWbemDateTime</strong> object is a helper object to parse and set Common Information Model (CIM) <a href="datetime.html">datetime</a> values. It plays a role similar to <a href="swbemobjectpath.html"><strong>SWbemObjectPath</strong></a>, which provides assistance to format and interpret object paths. You can use the VBScript <a href="/previous-versions//xzysf6hc(v=vs.85)">CreateObject</a> call to create the <strong>SWbemDateTime</strong> object.</p>
<p>An <strong>SWbemDateTime</strong> object can be initialized from and formatted in either <strong>VT_DATE</strong> or <strong>FILETIME</strong> values using methods on the object. Using properties of the object, the value can be parsed into component year, month, day, hour, minutes, seconds, or microseconds. The <strong>SWbemDateTime</strong> object can be formatted into either local or Coordinated Universal Time (UTC) values. For more information, see <a href="date-and-time-format.html">Date and Time Format</a>.</p>
<p><strong>SWbemDateTime</strong> is the only Windows Management Instrumentation (WMI) scripting object that is marked safe for initialization and scripts running on HTML pages in Internet Explorer.</p>
<h2>Members</h2>
<p>The <strong>SWbemDateTime</strong> object has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>SWbemDateTime</strong> object has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="swbemdatetime-getfiletime.html"><strong>GetFileTime</strong></a></td>
<td align="left">Converts a <strong>FILETIME</strong> date and time, expressed as a <strong>BSTR</strong>, to a WMI <a href="datetime.html">DATETIME</a> format.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-getvardate.html"><strong>GetVarDate</strong></a></td>
<td align="left">Converts a WMI <a href="datetime.html">DATETIME</a> formatted date and time value to a <strong>VT_DATE</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-setfiletime.html"><strong>SetFileTime</strong></a></td>
<td align="left">Converts a WMI <a href="datetime.html">DATETIME</a> format to a <strong>FILETIME</strong> date and time, expressed as a <strong>BSTR</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-setvardate.html"><strong>SetVarDate</strong></a></td>
<td align="left">Converts a <strong>VT_DATE</strong> formatted date and time to a WMI <a href="datetime.html">DATETIME</a>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<p>The <strong>SWbemDateTime</strong> object has these properties.</p>
<table>
<thead>
<tr>
<th align="left">Property</th>
<th align="left">Access type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="swbemdatetime-day.html"><strong>Day</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">The day component of a CIM <a href="datetime.html">datetime</a> value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-dayspecified.html"><strong>DaySpecified</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Indicates whether the day is specified or left as a wildcard.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-hours.html"><strong>Hours</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">The hours of the day component of a CIM <a href="datetime.html">datetime</a> value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-hoursspecified.html"><strong>HoursSpecified</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Indicates whether the hour is specified or left as a wildcard.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-isinterval.html"><strong>IsInterval</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Indicates that at least one component of the CIM <a href="datetime.html">datetime</a> represents an interval rather than a date.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-microseconds.html"><strong>Microseconds</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">The microseconds component of a CIM <a href="datetime.html">datetime</a> value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-microsecondsspecified.html"><strong>MicrosecondsSpecified</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Indicates whether the microseconds component is specified or left as a wildcard.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-minutes.html"><strong>Minutes</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">The minutes component of a CIM <a href="datetime.html">datetime</a> value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-minutesspecified.html"><strong>MinutesSpecified</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Indicates whether the minutes component is specified or left as a wildcard.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-month.html"><strong>Month</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">The month component of a CIM <a href="datetime.html">datetime</a> value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-monthspecified.html"><strong>MonthSpecified</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Indicates whether the month is specified or left as a wildcard.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-seconds.html"><strong>Seconds</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">The seconds component of a CIM <a href="datetime.html">datetime</a> value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-secondsspecified.html"><strong>SecondsSpecified</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Indicates whether the seconds component is specified or left as a wildcard.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-utc.html"><strong>UTC</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">The UTC component of a CIM <a href="datetime.html">datetime</a> value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-utcspecified.html"><strong>UTCSpecified</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Indicates whether the UTC component is specified or left as a wildcard.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-value.html"><strong>Value</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">The full CIM <a href="datetime.html">datetime</a> value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-year.html"><strong>Year</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">The year component of a CIM <a href="datetime.html">datetime</a> value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemdatetime-yearspecified.html"><strong>YearSpecified</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Indicates whether or not the year is specified or left as a wildcard.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>WMI records timestamps in universal time coordinate (UTC) format. UTC is not the format that most developers and IT administrators use. Therefore, a common issue is determining how to translate UTC into something more readable. For more information on how to work with UTC, see <a href="wmi-tasks--dates-and-times.html">WMI Tasks: Dates and Times</a> and <a href="/previous-versions/tn-archive/ee198928(v=technet.10)">Working with Dates and Times using WMI</a>. You can also read the <a href="/previous-versions/technet-magazine/cc160973(v=msdn.10)">It s About Time (Oh, and About Dates, Too)</a> blog post for additional information.</p>
<p>Any numeric field can have a wildcard value if the <a href="swbemdatetime-isinterval.html"><strong>IsInterval</strong></a> property is set to <strong>FALSE</strong>. Fields with wildcard values contain asterisks in the entire field.</p>
<p>Each property, for example <a href="swbemdatetime-day.html"><strong>Day</strong></a>, has a corresponding specified Boolean value, such as <a href="swbemdatetime-dayspecified.html"><strong>DaySpecified</strong></a>. When <strong>DaySpecified</strong> is <strong>FALSE</strong>, then the value is interpreted as an interval rather than a number between 01 and 31. If an interval is used anywhere in the CIM <a href="datetime.html">datetime</a> value, then <a href="swbemdatetime-isinterval.html"><strong>IsInterval</strong></a> is also set to <strong>TRUE</strong>. The default is for a CIM datetime value to contain a date rather than one or more intervals.</p>
<p>For example, if <a href="swbemdatetime-dayspecified.html"><strong>SWbemDateTime.DaySpecified</strong></a> is <strong>TRUE</strong>, then <a href="swbemdatetime-value.html"><strong>SWbemDateTime.Value</strong></a> includes the current value of <a href="swbemdatetime-day.html"><strong>SWbemDateTime.Day</strong></a>, otherwise it is a wildcard value. The <a href="swbemdatetime-isinterval.html"><strong>IsInterval</strong></a> property is <strong>FALSE</strong> in either case.</p>
<h2>Examples</h2>
<p>The following script code example shows how to use an <strong>SWbemDateTime</strong> object to parse a datetime property value read from the WMI repository, the <strong>InstallDate</strong> property in <a href="/windows/desktop/CIMWin32Prov/win32-operatingsystem"><strong>Win32_OperatingSystem</strong></a>.</p>
<pre lang="VB"><code>' Create a new datetime object.
Set dateTime = CreateObject(&quot;WbemScripting.SWbemDateTime&quot;)

' Retrieve a WMI object that contains a datetime value.
for each os in GetObject( _
    &quot;winmgmts:&quot;).InstancesOf (&quot;Win32_OperatingSystem&quot;)

    ' The InstallDate property is a CIM_DATETIME. 
    MsgBox os.InstallDate
    dateTime.Value = os.InstallDate

    ' Display the year of installation.
    MsgBox &quot;This OS was installed in the year &quot; &amp; dateTime.Year

    ' Display the installation date using the VT_DATE format.
    MsgBox &quot;Full installation date (VT_DATE format) is &quot; _
    &amp; dateTime.GetVarDate

    ' Display the installation date using the FILETIME format.
    MsgBox &quot;Full installation date (FILETIME format) is &quot; _
    &amp; dateTime.GetFileTime 
next
Set datetime = Nothing
</code></pre>
<p>The following example shows how to create an <strong>SWbemDateTime</strong> object, store a date value in the object, display the date as local and Coordinated Universal Time (UTC), and store the value in a newly created class and property. For more information about the constant <strong>wbemCimtypeDatetime</strong>, see <a href="/windows/desktop/api/Wbemdisp/ne-wbemdisp-wbemcimtypeenum">WbemCimtypeEnum</a>.</p>
<pre lang="VB"><code>' Create an SWbemDateTime object.
Set dateTime = CreateObject(&quot;WbemScripting.SWbemDateTime&quot;)
' Set the value 
Const wbemCimTypeDatetime = 101

' Construct a datetime value using the intrinsic VBScript CDate
' function interpreting this as a local date/time in
' the Pacific time zone (-8 hrs GMT). Convert to CIM datetime
' using SetVarDate method. The year defaults to current year.
dateTime.SetVarDate (CDate (&quot;January 20 11:56:32&quot;))

' The value in dateTime displays as 
' 20000120195632.000000-480. This is the equivalent time
' in GMT with the specified offset for PST of -8 hrs.
MsgBox &quot;CIM datetime &quot; &amp; dateTime

' The value now displays as B=0/2000 11:56:32 AM because the
' parameter contains the default TRUE value causing the value to be
' interpreted as a local time.
MsgBox &quot;Local datetime &quot; &amp; dateTime.GetVarDate ()

' The value now displays as B=0/2000 7:56:32 PM because the
' parameter value is FALSE, which indicates a GMT time.
' non-local time.
MsgBox &quot;Datetime in GMT &quot; &amp; dateTime.GetVarDate (false)

' Create a new class and add a DateTime property value.
' SWbemServices.Get returns an empty SWbemObject
' which can become a new class. SWbemObject.Path_ returns an
' SWbemObjectPath object. 
set NewObject = GetObject(&quot;winmgmts:root\default&quot;).Get
NewObject.Path_.Class = &quot;NewClass&quot;

' Add a new property named &quot;InterestingDate&quot; to the NewObject class
' and define its datatype as a CIM datetime value.
NewObject.Properties_.Add &quot;InterestingDate&quot;, wbemCimtypeDatetime

' Set the new value of the SWbemDateTime object in the InterestingDate
' property.
NewObject.InterestingDate = dateTime.Value
MsgBox &quot;Datetime in new object &quot; &amp; NewObject.InterestingDate

' Write the new class (named &quot;NewClass&quot;) containing
' the SWbemDateTime object to the repository.
NewObject.Put_
WScript.Echo &quot;NewClass is now in WMI repository&quot;

' Clean up the example by deleting the new class from the repository
NewObject.Delete_
</code></pre>
<p>The following script code example shows how to use an <strong>SWbemDateTime</strong> object to modify an interval value on a property that is read from the WMI repository.</p>
<pre lang="VB"><code>' Construct an interval value of 100 days, 1 hour, and 3 seconds.
dateTime.IsInterval = true 
dateTime.Day = 100
dateTime.Hours = 1
dateTime.Seconds = 3

' The datetime displays as 00000100010003.000000:000.
MsgBox &quot;Constructed interval value &quot; &amp; datetime

' Retrieve an empty WMI object and add a datetime property. 
Const wbemCimTypeDatetime = 101
Set NewObject = GetObject(&quot;winmgmts:root\default&quot;).Get
NewObject.Path_.Class = &quot;Empty&quot;
NewObject.Properties_.Add &quot;InterestingDate&quot;, wbemCimtypeDatetime

' Set the new value in the property and update. 
NewObject.InterestingDate = dateTime.Value
MsgBox &quot;NewObject.InterestingDate = &quot; &amp; NewObject.InterestingDate

' Write the new SWbemDateTime object to the repository.
NewObject.Put_

' Delete the object.
NewObject.Delete_
</code></pre>
<p>The following script code example shows how to use an <strong>SWbemDate</strong> object to read a <strong>FILETIME</strong> value.</p>
<pre lang="VB"><code>' Create a new datetime object.
Set datetime = CreateObject(&quot;WbemScripting.SWbemDateTime&quot;)

' Set from a FILETIME value (non-local).
' Assume a timezone -7 hrs. GMT.
MsgBox &quot;FILETIME value &quot; &amp; &quot;126036951652030000&quot;
datetime.SetFileTime &quot;126036951652030000&quot;, false

' Displays as 5/24/2000 7:26:05 PM.
MsgBox &quot;GMT time &quot; &amp; dateTime.GetVarDate   

' Set from a FILETIME value (local).
datetime.SetFileTime &quot;126036951652030000&quot;

' Displays as 5/25/2000 2:26:05 AM.
MsgBox &quot;Same value in local time &quot; &amp; dateTime.GetVarDate
Set datetime = Nothing
</code></pre>
<p>The following PowerShell code creates an instance of a SWbemDateTime object, retrieves the OS install date, and converts the date to a different format</p>
<pre lang="PowerShell"><code># Create swbemdatetime object
$datetime = New-Object -ComObject WbemScripting.SWbemDateTime

#  Get OS installation time and assign to datetime object
$os = Get-WmiObject -Class Win32_OperatingSystem
$dateTime.Value = $os.InstallDate

# Now display the time
&quot;This OS was installed in the year {0}&quot;           -f $dateTime.Year
&quot;Full installation date (VT_DATE format) is {0}&quot;  -f $dateTime.GetVarDate()
&quot;Full installation date (FILETIME format) is {0}&quot; -f $dateTime.GetFileTime() 
</code></pre>
<p>The following Powershell code translates the code into a format ready to be consumed by a CIM provider.</p>
<pre lang="PowerShell"><code> $time = (Get-Date)
 $objScriptTime = New-Object -ComObject WbemScripting.SWbemDateTime
 $objScriptTime.SetVarDate($time)
 $cimTime = $objScriptTime.Value
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemdisp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Type library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemdisp.tlb<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemdisp.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>CLSID<!-- raw HTML omitted --></td>
<td>CLSID_SWbemDateTime<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_ISWbemDateTime<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wbemdisp/ne-wbemdisp-wbemcimtypeenum">WbemCimtypeEnum</a></p>
<!-- raw HTML omitted -->
<p><a href="datetime.html">DATETIME</a></p>
<!-- raw HTML omitted -->
<p><a href="scripting-api-objects.html">Scripting API Objects</a></p>
<!-- raw HTML omitted -->
</body>
