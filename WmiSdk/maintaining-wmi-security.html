<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Maintaining WMI Security</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: WMI security focuses on protecting access to namespace data. WMI first grants access to groups of users as specified by the WMI Control and DCOM settings and then providers determine if the user should have access to namespace data.
ms.assetid: 88a2538a-ae30-4a1a-9d16-f0cd9419b2ed
ms.tgt_platform: multiple
title: Maintaining WMI Security
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Maintaining WMI Security</h1>
<p>WMI security focuses on protecting access to namespace data. WMI first grants access to groups of users as specified by the <a href="gloss-w.html"><em>WMI Control</em></a> and DCOM settings and then providers determine if the user should have access to namespace data.</p>
<p>The following sections are discussed in this topic:</p>
<ul>
<li><a href="#namespace-security">Namespace Security</a></li>
<li><a href="#distributed-component-object-model-dcom-security-settings">Distributed Component Object Model (DCOM) Security Settings.</a></li>
<li><a href="#wmi-shared-service-hosts-and-authentication">WMI, Shared Service Hosts, and Authentication</a></li>
<li><a href="#security-for-wmi-client-scripts-and-applications">Security for WMI Client Scripts and Applications</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Namespace Security</h2>
<p>Namespace security depends on standard Windows user <a href="gloss-s.html"><em>security identifiers (SID)</em></a> and the <a href="gloss-s.html"><em>security descriptor</em></a> for the WMI namespace.</p>
<p>You can set namespace security by performing the following actions:</p>
<ul>
<li>Grant or deny access rights to namespaces for users using the WMI Control or when the namespace is created. For more information, see <a href="setting-namespace-security-with-the-wmi-control.html">Setting Namespace Security with the WMI Control</a> and <a href="setting-namespace-security-when-the-namespace-is-created.html">Setting Namespace Security When the Namespace is Created</a>.</li>
<li>Use the WMI Control Security tab to establish security auditing. Security auditing results in event log entries when a user fails or succeeds in an audited action, such as writing data to a WMI object or reading the security descriptor. For more information, see <a href="access-to-wmi-namespaces.html">Access to WMI Namespaces</a>.</li>
<li>Use the MOF file that defines the namespace to require a user to make an encrypted connection. For more information, see <a href="requiring-an-encrypted-connection-to-a-namespace.html">Requiring an Encrypted Connection to a Namespace</a>.</li>
</ul>
<h2>Distributed Component Object Model (DCOM) Security Settings.</h2>
<p>DCOM security requires an authentication setting and an impersonation setting. Authentication means that one process identifies itself to another. Impersonation identifies the authority that a client grants a server to call different processes. During a security check, the server impersonates the client. For more information, see <a href="securing-c---clients-and-providers.html">Securing C++ Clients and Providers</a> or <a href="securing-scripting-clients.html">Securing Scripting Clients</a>.</p>
<p>Scripts and C/C++/C# applications either establish an authentication and impersonation levels when they connect to a WMI namespace or they use the default settings. Connections to remote computers require different settings than to the WMI namespaces on the local computer. For more information, see <a href="connecting-to-wmi-on-a-remote-computer.html">Connecting to WMI on a Remote Computer</a>.</p>
<h2>WMI, Shared Service Hosts, and Authentication</h2>
<p>WMI resides in a shared service host with several other services running under the NetworkService account. In a Svchost process, WMI shares the same authentication as the other processes in the host.</p>
<p>Provider DLLs are loaded into separate service host processes from WMI. The <strong>HostingModel</strong> property in the <a href="--win32provider.html"><strong>__Win32Provider</strong></a> system class that represents a provider specifies the system account under which the provider runs. Setting this property causes the provider to be loaded into a shared host process that has a specified level of privilege. For more information, see <a href="provider-hosting-and-security.html">Provider Hosting and Security</a>.</p>
<h2>Security for WMI Client Scripts and Applications</h2>
<p>Scripts and applications must establish the correct security to connect to WMI namespaces on local and remote computers. For more information, see <a href="securing-c---clients-and-providers.html">Securing C++ Clients and Providers</a>, <a href="securing-scripting-clients.html">Securing Scripting Clients</a>, and <a href="securing-wmi-events.html">Securing WMI Events</a>.</p>
<p>The following table lists the topics on maintaining WMI security.</p>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="securing-wmi-namespaces.html">Securing WMI Namespaces</a></td>
<td>You can limit namespace data access to authorized users through the WMI Control.</td>
</tr>
<tr>
<td><a href="securing-your-provider.html">Securing Your Provider</a></td>
<td>Information about writing secure providers.</td>
</tr>
<tr>
<td><a href="securing-c---clients-and-providers.html">Securing C++ Clients and Providers</a></td>
<td>Both C++ providers and client applications must perform many of the same operations to maintain WMI security.</td>
</tr>
<tr>
<td><a href="securing-scripting-clients.html">Securing Scripting Clients</a></td>
<td>Scripts and Visual Basic applications (automation clients) must set appropriate security to get access to WMI data and events.</td>
</tr>
<tr>
<td><a href="securing-wmi-events.html">Securing WMI Events</a></td>
<td>WMI events are delivered by the event provider to a temporary or permanent consumer. Events are delivered in the form of an instance of an event class.</td>
</tr>
<tr>
<td><a href="changing-access-security-on-securable-objects.html">Changing Access Security on Securable Objects</a></td>
<td>With appropriate permissions, you can call methods on the WMI objects that represent securable objects that read or change security descriptors on securable objects.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="using-wmi.html">Using WMI</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
