<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Configuring IIS 5.0 and Later for WMI ASP Scripting</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: All authentication settings are made through the Internet Services Manager.
ms.assetid: 9b118120-f0cb-4973-b537-dd3d12a7a6d5
ms.tgt_platform: multiple
title: Configuring IIS 5.0 and Later for WMI ASP Scripting
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Configuring IIS 5.0 and Later for WMI ASP Scripting</h1>
<p>All authentication settings are made through the Internet Services Manager.</p>
<p>When configuring Internet Information Server (IIS) 5.0 and IIS 6.0 security for WMI ASP scripts, consider the following issues:</p>
<ul>
<li>
<p><a href="#authentication-level">Authentication level</a></p>
<p>You can configure at the server, directory, or file level.</p>
</li>
<li>
<p><a href="#authentication-setting">Authentication setting</a></p>
<p>You can set authentication to Anonymous, Integrated Windows, or both.</p>
</li>
<li>
<p><a href="#protection">Protection</a></p>
<p>You can set the ASP to run in-process (low protection), or out-of-process by using Dllhost.exe (medium or high protection).</p>
</li>
</ul>
<h2>Authentication Level</h2>
<p>For added security, you can configure the authentication at the directory or file level.</p>
<p>If authentication is set at the server level, all subsequent directories and files adhere to the server authentication unless explicitly altered at the directory or file level. You can create a directory structure to contain all WMI ASP scripts where HTML pages and ASPs specific to WMI can be configured independently from the rest of the server. Perform the following procedure to change the authentication level of a server, directory, or file.</p>
<p><strong>To set the authentication at any level</strong></p>
<ol>
<li>
<p>In Control Panel, double-click <strong>Administrative Tools</strong>, and then double-click the IIS snap-in.</p>
</li>
<li>
<p>Locate the ASP page icon, and then open the properties for the level to set, which can be server, directory, or file.</p>
<blockquote>
<p>[!Note]<br />
Authentication settings are located on either the <strong>Directory Security</strong> or <strong>File Security</strong> tab of the <strong>Properties</strong>sheet.</p>
</blockquote>
<p>Â </p>
</li>
</ol>
<h2>Authentication Setting</h2>
<p>For WMI ASP scripts, the combination of Anonymous authentication turned off (unchecked), and Integrated Windows authentication turned on (checked) provides greater opportunity to set security. To use NT LAN Manager (NTLM), Passport, or Digest IIS authentication settings, you must turn on the remote enable privileges, because the user is treated as a network identity and logged remotely. The remote enable setting is not required for Anonymous and Basic authentication. However, the system is much less secure when you are using Anonymous and Basic authentication.</p>
<p>If Anonymous authentication is used with or without Integrated Windows authentication, the most secure approach is to use a logon that requires a user to enter a username and password. The default logon is the IIS identity, but a logon can be created by using specific permissions suited for the WMI ASP Scripts that can be used as the account for the anonymous or guest connections.</p>
<p>If you choose a logon identifier that is not an IIS identity, then clear the <strong>Allow IIS to control password</strong> check box, and enter the correct password. This forces all anonymous or guest connections to use the logon identifier. By creating a logon separate from the IIS identity, the privileges of an account accessing WMI can be controlled without affecting the other directories or files on the IIS serverâ€”unless the authentication is set at the server level.</p>
<p>Perform the following procedure to set the authentication requirements for the ASP page using the IIS snap-in in the Control Panel.</p>
<p><strong>To get to the account setting</strong></p>
<ol>
<li>
<p>In Control Panel, double-click the <strong>Administrative Tools</strong> icon, open the IIS snap-in, locate your ASP page, and open the properties of the level to set, which can be server, directory, or file.</p>
<p>Authentication settings can be found on either the <strong>Directory Security</strong> or <strong>File Security</strong> tab of the <strong>Properties</strong> sheet.</p>
</li>
<li>
<p>In the Anonymous authentication area, click <strong>Edit</strong>.</p>
</li>
<li>
<p>If a logon identifier other than the IIS identity is selected, then clear the <strong>Allow IIS to control password</strong>check box, and enter the correct password. This forces all anonymous or guest connections to use the logon identifier.</p>
</li>
</ol>
<p>By using a logon different from the IIS identity, the privileges of the account accessing WMI can be controlled without affecting the other directories or files on the IIS serverâ€”unless the authentication is set at the server level.</p>
<p>The previous configuration allows the IIS server to use Anonymous authentication in some areas, and Integrated Windows or mixed authentication in others.</p>
<h2>Protection</h2>
<p>The last consideration when configuring the IIS server is which protection to use when executing an ASP.</p>
<p>You can set an ASP to run the following:</p>
<ul>
<li>
<p>In-process to IIS (low protection).</p>
</li>
<li>
<p>External to IIS with Dllhost.exe as pooled or out-of-process (pooled medium protection).</p>
</li>
<li>
<p>Out-of-process self-host (high protection).</p>
</li>
</ul>
<blockquote>
<p>[!Note]<br />
For the best balance of security and performance, use pooled host.</p>
</blockquote>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
