<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Executing Privileged Operations Using VBScript</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: If you use the scripting API for WMI, you can set specific security privileges.
ms.assetid: 65b923d5-5244-498d-9644-d4978fb84f85
ms.tgt_platform: multiple
title: Executing Privileged Operations Using VBScript
ms.topic: article
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>kbArticle
api_name:
api_type:
api_location:</li>
</ul>
<hr />
<h1>Executing Privileged Operations Using VBScript</h1>
<p>If you use the scripting API for WMI, you can set specific security privileges. For example, you can set the security privileges to request an operating system shutdown, or to examine the security event log. For more information, see <a href="/windows/desktop/SecBP/running-with-special-privileges">Running with Special Privileges</a>.</p>
<p>You only need to set privileges when you are accessing WMI on your computer. When you are accessing a remote host, COM RPC automatically sets the privileges. To determine all the required privileges, consult the documentation for the specific WMI classes that you want to access, such as <a href="/windows/desktop/CIMWin32Prov/win32-operatingsystem"><strong>Win32_OperatingSystem</strong></a>. For more information, see <a href="/windows/desktop/api/Wbemdisp/ne-wbemdisp-wbemprivilegeenum">WbemPrivilegeEnum</a></p>
<p>The following sections are discussed in this topic:</p>
<ul>
<li><a href="/windows">Setting a Privilege from the Security_ Object</a></li>
<li><a href="#setting-a-privilege-as-part-of-a-moniker">Setting a Privilege as Part of a Moniker</a></li>
<li><a href="#revoking-and-resetting-privileges">Revoking and Resetting Privileges</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Setting a Privilege from the Security_ Object</h2>
<p>Use the following procedure to set security privileges in Visual Basic.</p>
<p><strong>To set privileges in Visual Basic</strong></p>
<ol>
<li>
<p>Create an object of type <a href="swbemlocator.html"><strong>SWbemLocator</strong></a>.</p>
</li>
<li>
<p>Add the new privilege to the <a href="swbemlocator-security-.html"><strong>SWbemLocator.Security_</strong></a> object.</p>
<p>The <a href="swbemlocator-security-.html"><strong>Security_</strong></a> object contains an <a href="swbemobjectset.html"><strong>SWbemObjectSet</strong></a> collection. The objects in the set are <a href="swbemsecurity.html"><strong>SWbemSecurity</strong></a> objects. For more information, see <a href="accessing-a-collection.html">Accessing a Collection</a>.</p>
</li>
<li>
<p>Log on to WMI and retrieve an <a href="swbemservices.html"><strong>SWbemServices</strong></a> object.</p>
<p>The <a href="swbemservices.html"><strong>SWbemServices</strong></a> object inherits the privilege that is set in the previous step.</p>
</li>
</ol>
<p>You can also set a privilege using the <a href="swbemprivilegeset-addasstring.html"><strong>SWbemPrivilegeSet.AddAsString</strong></a> method.</p>
<h2>Setting a Privilege as Part of a Moniker</h2>
<p>You can set a privilege as part of a moniker.</p>
<p>The following example shows you how to add a debug privilege to a moniker.</p>
<pre lang="VB"><code>Set Service = GetObject(&quot;winmgmts:{impersonationLevel=impersonate, (Debug)}&quot;)
</code></pre>
<h2>Revoking and Resetting Privileges</h2>
<p>The following example shows you how to set the <strong>SeDebugPrivilege</strong> privilege, and revoke the <strong>SeRemoteShutdownPrivilege</strong> privilege.</p>
<pre lang="VB"><code>Set Service = GetObject(&quot;winmgmts:{impersonate,(Debug,!RemoteShutdown)}&quot;)
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="privilege-constants.html"><strong>Privilege Constants</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="executing-privileged-operations.html">Executing Privileged Operations</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
