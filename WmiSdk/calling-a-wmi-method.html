<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to call a WMI method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to call a WMI method
description: The main purpose of WMI is to provide access to classes and instances that represent objects on your network.
ms.assetid: 8d559eee-3dbf-4132-b1c0-a6925b8feb56
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to call a WMI method</h1>
<p>The main purpose of WMI is to provide access to classes and instances that represent objects on your network. These classes and instances are supported by providers. For example, all of the instances that represent standard hardware devices on your enterprise, such as <a href="/windows/desktop/CIMWin32Prov/win32-physicalmemory"><strong>Win32_PhysicalMemory</strong></a> or <a href="/windows/desktop/CIMWin32Prov/win32-printer"><strong>Win32_Printer</strong></a>, are supported by the Win32 provider. Similarly, you can access the event log through the Event Log provider, and the registry through the Registry provider.</p>
<p>The methods that WMI implements in interfaces such as <a href="/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices"><strong>IWbemServices</strong></a> or scripting objects such as <a href="swbemservices.html"><strong>SWbemServices</strong></a>, are primarily for generically obtaining and manipulating data supplied by any provider. For example, use <a href="swbemservices-instancesof.html"><strong>SWbemServices.InstancesOf</strong></a> to obtain all the instances of <a href="/windows/desktop/CIMWin32Prov/win32-process"><strong>Win32_Process</strong></a> in a subset of enterprise computers. You can then call the Win32 provider method <a href="/windows/desktop/CIMWin32Prov/getownersid-method-in-class-win32-process"><strong>GetOwnerSid</strong></a> on each <strong>Win32_Process</strong> object.</p>
<p>In the following example, the <a href="/windows/desktop/CIMWin32Prov/getownersid-method-in-class-win32-process"><strong>GetOwnerSid</strong></a> method is called as an automation method on the Process object. A WMI method, such as the <a href="swbemobject-path-.html"><strong>Path_</strong></a> method defined for <a href="swbemobject.html"><strong>SWbemObject</strong></a> could also be called on the <strong>Process</strong> object.</p>
<pre lang="VB"><code>Set ProcessCollection = _
    GetObject(&quot;WinMgmts:&quot;).InstancesOf(&quot;Win32_Process&quot;)

For Each Process In ProcessCollection
    SID = Process.GetOwnerSid
Next
</code></pre>
<p>The actual process of using the WMI methods is identical to using any other Windows COM or automation interface. For more information, see <a href="../cossdk/component-services-portal.html">COM</a> and <a href="creating-a-wmi-application-or-script.html">Creating a WMI Application or Script</a>. For more information about the interfaces that WMI supports, see <a href="com-api-for-wmi.html">COM API for WMI</a> and <a href="scripting-api-for-wmi.html">Scripting API for WMI</a>.</p>
<p>For more information, see <a href="manipulating-class-and-instance-information.html">Manipulating Class and Instance Information</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="calling-a-method.html">Calling a Method</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
