<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Access to WMI Securable Objects</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: WMI relies on standard Windows security descriptors to control and protect access to securable objects like WMI namespaces, printers, services, and DCOM applications.
ms.assetid: 5893457d-3fc2-4d64-a6c2-0f410052ce52
ms.tgt_platform: multiple
title: Access to WMI Securable Objects
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Access to WMI Securable Objects</h1>
<p>WMI relies on standard Windows <a href="/windows/desktop/SecGloss/s-gly"><em>security descriptors</em></a> to control and protect access to securable objects like WMI namespaces, printers, services, and DCOM applications. For more information, see <a href="access-to-wmi-namespaces.html">Access to WMI Namespaces</a>.</p>
<p>The following topics are discussed in this section:</p>
<ul>
<li><a href="#security-descriptors-and-sids">Security Descriptors and SIDs</a></li>
<li><a href="#access-control">Access Control</a></li>
<li><a href="#changing-access-security">Changing Access Security</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Security Descriptors and SIDs</h2>
<p>WMI maintains access security by comparing the <a href="/windows/desktop/SecGloss/a-gly"><em>access token</em></a> of the user that attempts to access a securable object with the security descriptor of the object.</p>
<p>When a user or group is created on a system, the account is given a <a href="/windows/desktop/SecGloss/s-gly"><em>security identifier (SID)</em></a> The SID ensures that an account created with the same name as a previously deleted account does not inherit the previous security settings. An access token is created by combining the SID, the list of groups of which the user is a member, and the list of enabled or disabled privileges. These tokens are assigned to all processes and threads owned by the user.</p>
<h2>Access Control</h2>
<p>When the user wants to use a secured object, the access token is compared with the <a href="/windows/desktop/SecGloss/d-gly"><em>discretionary access control list (DACL)</em></a> in the security descriptor on the object. The DACL contains permissions called <a href="/windows/desktop/SecGloss/a-gly"><em>access control entries (ACE)</em></a>. <a href="/windows/desktop/SecGloss/s-gly"><em>System access control lists (SACL)</em></a> do the same thing as DACLs, but can generate security audit events. Starting with WindowsÂ Vista, WMI can make auditing entries in the Windows Security Log. For more information about auditing in WMI, see <a href="access-to-wmi-namespaces.html">Access to WMI Namespaces</a>.</p>
<p>Both the DACL and the SACL consist of a list of ACEs that describe which users have specific access rights, including writing to the WMI repository, remote access and execution, and logon permissions. WMI stores these ACLs in the WMI repository.</p>
<p>ACEs hold three types of access levels or grant/deny rights: allow, deny for DACL, and system audit (for SACLs). Deny ACEs precede allow ACEs in the DACL or SACL. When checking the user access rights, WMI runs consecutively through the access control list until it finds an allow ACE that applies to the requesting access token. The remaining ACEs are not checked after this point. If no appropriate allow ACE is found, then access is denied. For more information, see <a href="/windows/desktop/SecAuthZ/order-of-aces-in-a-dacl">Order of ACEs in a DACL</a> and <a href="/windows/desktop/SecBP/creating-a-dacl">Creating a DACL</a>.</p>
<h2>Changing Access Security</h2>
<p>With appropriate permissions, you can change the security on a securable object with a script or application. You can also change the security settings on WMI namespaces using the <a href="gloss-w.html"><em>WMI Control</em></a> or by adding a <a href="/windows/desktop/SecAuthZ/security-descriptor-definition-language">Security Descriptor Definition Language (SDDL)</a> string in the <a href="gloss-m.html"><em>Managed Object Format (MOF)</em></a> file that defines classes for the namespace. For more information, see <a href="access-to-wmi-namespaces.html">Access to WMI Namespaces</a>, <a href="securing-wmi-namespaces.html">Securing WMI Namespaces</a>, and <a href="changing-access-security-on-securable-objects.html">Changing Access Security on Securable Objects</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="wmi-security-descriptor-objects.html">WMI Security Descriptor Objects</a></p>
<!-- raw HTML omitted -->
<p><a href="wmi-security-constants.html">WMI Security Constants</a></p>
<!-- raw HTML omitted -->
<p><a href="user-account-control-and-wmi.html">User Account Control and WMI</a></p>
<!-- raw HTML omitted -->
<p><a href="wmi-security-descriptor-objects.html">WMI Security Descriptor Objects</a></p>
<!-- raw HTML omitted -->
<p><a href="access-to-wmi-namespaces.html">Access to WMI Namespaces</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
