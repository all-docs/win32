<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GetSD method of the __SystemSecurity class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Gets the security descriptor for the namespace to which the user is connected. This method returns a security descriptor in binary byte array format. If you are writing a script, use the GetSecurityDescriptor method.
ms.assetid: aeac1e7b-fcb8-4880-afd1-4950da37602b
ms.tgt_platform: multiple
title: GetSD method of the __SystemSecurity class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>__SystemSecurity.GetSD
api_type:</li>
<li>COM
api_location:</li>
<li>All</li>
</ul>
<hr />
<h1>GetSD method of the __SystemSecurity class</h1>
<p>The <strong>GetSD</strong> method gets the security descriptor for the namespace to which the user is connected. This method returns a security descriptor in binary byte array format. If you are writing a script, use the <a href="getsecuritydescriptor-method-in-class---systemsecurity-.html"><strong>GetSecurityDescriptor</strong></a> method. For more information, see <a href="securing-wmi-namespaces.html">Securing WMI Namespaces</a> and <a href="changing-access-security-on-securable-objects.html">Changing Access Security on Securable Objects</a>.</p>
<p>The user must have the <strong>READ_CONTROL</strong> permission. By default, administrators have that permission. The only part of the security descriptor that is actually used is the discretionary access control list (DACL). The DACL can contain both inherited and non-inherited ACEs. Both deny and allow ACEs are permitted.</p>
<p>If you are programming in C++, you can manipulate the binary security descriptor using <a href="/windows/desktop/SecAuthZ/security-descriptor-definition-language">SDDL</a>, and the conversion methods <a href="/windows/desktop/api/sddl/nf-sddl-convertsecuritydescriptortostringsecuritydescriptora"><strong>ConvertSecurityDescriptorToStringSecurityDescriptor</strong></a> and <a href="/windows/desktop/api/sddl/nf-sddl-convertstringsecuritydescriptortosecuritydescriptora"><strong>ConvertStringSecurityDescriptorToSecurityDescriptor</strong></a>.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>HRESULT GetSD(
  [out] uint8 SD[]
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>SD</em> [out]</p>
<!-- raw HTML omitted -->
<p>Security descriptor in binary byte array format.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method returns an <strong>HRESULT</strong> indicating the status of the method call. The following list lists the return values that are of significance to <strong>GetSD</strong>. For scripting and Visual Basic applications, the result can be obtained from <a href="parsing-outparameters-objects.html">OutParameters.ReturnValue</a>. For more information, see <a href="constructing-inparameters-objects-and-parsing-outparameters-objects.html">Constructing InParameters Objects and Parsing OutParameters Objects</a>.</p>
<!-- raw HTML omitted -->
<p><strong>S_OK</strong></p>
<!-- raw HTML omitted -->
<p>Method executed successfully.</p>
<!-- raw HTML omitted -->
<p><strong>WBEM_E_ACCESS_DENIED</strong></p>
<!-- raw HTML omitted -->
<p>Caller does not have sufficient rights to call this method.</p>
<!-- raw HTML omitted -->
<p><strong>WBEM_E_METHOD_DISABLED</strong></p>
<!-- raw HTML omitted -->
<p>Attempted to run this method on an unsupported system.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>For more information about modifying namespace security programmatically or manually, see <a href="securing-wmi-namespaces.html">Securing WMI Namespaces</a>.</p>
<h2>Examples</h2>
<p>The following script shows you how to use <strong>GetSD</strong> to obtain the current security descriptor for the Root\Cimv2 namespace and change it to the byte array shown in <strong>DisplaySD</strong>.</p>
<pre lang="VB"><code>Set objServices = GetObject(&quot;winmgmts:root\cimv2&quot;)
Set CimV2 = objServices.Get(&quot;__SystemSecurity=@&quot;)
ReturnValue = Cimv2.GetSD(arrSD)

If Err &lt;&gt; 0 Then
   WScript.Echo &quot;Method returned error &quot; &amp; ReturnValue
End If

DisplaySD = &quot;SD = {&quot;
For I = Lbound(arrSD) To Ubound(arrSD)

   DisplaySD = DisplaySD &amp; arrSD(I)

   If I &lt;&gt; Ubound(arrSD) Then
      DisplaySD = DisplaySD &amp; &quot;,&quot;
   End If

Next

DisplaySD = DisplaySD &amp; &quot;}&quot;

WScript.Echo DisplaySD
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>All WMI namespaces<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="wmi-system-classes.html">WMI System Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="--systemsecurity.html"><strong>__SystemSecurity</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="wmi-security-constants.html">WMI Security Constants</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/secrcw32prov/win32-ace"><strong>Win32_ACE</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="--systemsecurity-setsd.html"><strong>__SystemSecurity::SetSD</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/winnt/ns-winnt-security_descriptor"><strong>Security_Descriptor</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor"><strong>Win32_SecurityDescriptor</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="securing-wmi-namespaces.html">Securing WMI Namespaces</a></p>
<!-- raw HTML omitted -->
</body>
