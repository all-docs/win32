<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>winmgmt</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Winmgmt is the WMI service within the SVCHOST process running under the &amp;#0034;LocalSystem&amp;#0034; account.
ms.assetid: 3923322a-3acb-407e-8a07-09c59d252e8b
ms.tgt_platform: multiple
title: winmgmt
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>winmgmt
api_type:</li>
<li>NA
api_location:</li>
</ul>
<hr />
<h1>winmgmt</h1>
<p>Winmgmt is the WMI service within the SVCHOST process running under the &quot;LocalSystem&quot; account.</p>
<p>In all cases, the WMI service automatically starts when the first management application or script requests connection to a WMI namespace. For more information, see <a href="starting-and-stopping-the-wmi-service.html">Starting and Stopping the WMI Service</a>.</p>
<blockquote>
<p>[!Note]<br />
WMI is a core component of the Windows operating system that allows developers and IT administrators to write scripts and applications to automate certain tasks. Winmgmt.exe is the service that allows WMI to run on your local computer. For more information on using WMI, see <a href="using-wmi.html">Using WMI</a>. If you have received an error message regarding winmgmt.exe, see <a href="wmi-troubleshooting.html">WMI Troubleshooting</a>. For more information on Winmgmt.exe, see <a href="/previous-versions/system-center/configuration-manager-2003/cc180468(v=technet.10)">Using WMI Management Tools</a>.</p>
</blockquote>
<p>When run from the command prompt, the WMI service has the following switches.</p>
<pre lang="syntax"><code>winmgmt 
  [/backup &lt;filename&gt;] 
  [/restore &lt;filename&gt; &lt;mode&gt;] 
  [/resyncperf &lt;winmgmt service process id&gt;] 
  [/standalonehost &lt;level&gt;]
  [/sharedhost]
  [/verifyrepository &lt;path&gt;]
  [/salvagerepository] 
  [/resetrepository]
</code></pre>
<h2>Switches</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <strong>/backup</strong> <em>&lt;filename&gt;</em></p>
<!-- raw HTML omitted -->
<p>Causes WMI to back up the repository to the specified file name. The <em>filename</em> argument should contain the full path to the file location. This process requires a write lock on the repository so that write operations to the repository are suspended until the backup process is completed.</p>
<p>If you do not specify a path for the file, it is put in the %Windir%\System32 directory.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <strong>/restore</strong> <em>&lt;filename&gt;</em> <em>&lt;flag&gt;</em></p>
<!-- raw HTML omitted -->
<p>Manually restores the WMI repository from the specified backup file. The <em>filename</em> argument should contain the full path to the backup file location. To perform the restore operation, WMI saves the existing repository to write back if the operation fails. Then the repository is restored from the backup file that is specified in the <em>filename</em> argument. If exclusive access to the repository cannot be achieved, existing clients are disconnected from WMI.</p>
<p>The <em>flag</em> argument must be a 1 (force   disconnect users and restore) or 0 (default   restore if no users connected) and specifies the restore mode.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <strong>/resyncperf</strong> <em>&lt;winmgmt-service-process-id&gt;</em></p>
<!-- raw HTML omitted -->
<p>Registers the computer's performance libraries with WMI. WMI PID is the process ID for the WMI service.</p>
<p>Only needed if the performance monitor classes are not returning reliable results.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/standalonehost</strong> [<em>&lt;level&gt;</em>]</p>
<!-- raw HTML omitted -->
<p>Moves the Winmgmt service to a standalone Svchost process that has a fixed DCOM endpoint. The default endpoint is &quot;ncacn_ip_tcp.0.24158&quot;. However, the endpoint may be changed by running Dcomcnfg.exe. For more information about setting up a fixed port for WMI, see <a href="setting-up-a-fixed-port-for-wmi.html">Setting Up a Fixed Port for WMI</a>.</p>
<p>The <em>level</em> argument is the authentication level for the Svchost process. WMI normally runs as part of a shared service host and you cannot increase the authentication level for WMI alone. If <em>level</em> is not specified, the default is 4 (<strong>RPC_C_AUTHN_LEVEL_PKT</strong> or <strong>WbemAuthenticationLevelPkt</strong>).</p>
<p>You can run WMI more securely by increasing the authentication level to Packet Privacy (<strong>RPC_C_AUTHN_LEVEL_PKT_PRIVACY</strong> or <strong>WbemAuthenticationLevelPktPrivacy</strong>). The authentication levels for Visual Basic and scripting are described in <a href="/windows/desktop/api/Wbemdisp/ne-wbemdisp-wbemauthenticationlevelenum"><strong>WbemAuthenticationLevelEnum</strong></a>. For C++, see <a href="setting-the-default-process-security-level-using-c-.html">Setting the Default Process Security Level Using C++</a>. For more information, see <a href="maintaining-wmi-security.html">Maintaining WMI Security</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/sharedhost</strong></p>
<!-- raw HTML omitted -->
<p>Moves the Winmgmt service into the shared Svchost process.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <strong>/verifyrepository</strong> <em>&lt;path&gt;</em></p>
<!-- raw HTML omitted -->
<p>Performs a consistency check on the WMI repository. When you add the <strong>/verifyrepository</strong> switch without the <em>&lt;path&gt;</em> argument, then the live repository currently used by WMI is verified. When you specify the <em>path</em> argument, you can verify any saved copy of the repository. In this case, the path argument should contain the full path to the saved repository copy. The saved repository should be a copy of the entire repository folder. For more information about errors returned by this command, see the Remarks section.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/salvagerepository</strong></p>
<!-- raw HTML omitted -->
<p>Performs a consistency check on the WMI repository, and if an inconsistency is detected, rebuilds the repository. The content of the inconsistent repository is merged into the rebuilt repository, if it can be read. The salvage operation always works with the repository that the WMI service is currently using. For more information about errors returned by this command, see the Remarks section.</p>
<p>% MOF files that contain the <a href="pragma-autorecover.html"><strong>#pragma autorecover</strong></a> preprocessor statement are restored to the repository.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>/resetrepository</strong></p>
<!-- raw HTML omitted -->
<p>The repository is reset to the initial state when the operating system is first installed. MOF files that contain the <a href="pragma-autorecover.html"><strong>#pragma autorecover</strong></a> preprocessor statement are restored to the repository.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>This tool is located in the %Windir%\System32\wbem directory. For a list of the available switches, type <code>WinMgmt /?</code> at the command prompt.</p>
<p>The WMI repository, also known as the CIM repository, is not just a single file, but a collection of files within the Repository folder that work together as a database. When you use the <strong>/backup</strong> switch to backup the repository, the resulting backup is a single compressed file.</p>
<p>WMI returns the error <strong>ERROR_INTERNAL_DB_CORRUPTION</strong> (net helpmsg 1358) if a verification operation indicates that the repository is not in a consistent state. This error can be returned from any command which performs repository verification, such as <strong>/verifyrepository</strong> or <strong>/salvagerepository</strong>.</p>
<blockquote>
<p>[!Note]</p>
<p>If WMI returns error messages, be aware that they may not indicate problems in the WMI service or in WMI providers. Failures can originate in other parts of the operating system and emerge as errors through WMI. Under any circumstances, do not delete the WMI repository as a first action because deleting the repository can cause damage to the system or to installed applications.</p>
<p>For more info, see <a href="/windows/win32/wmisdk/wmi-troubleshooting">WMI Troubleshooting</a>.</p>
</blockquote>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="wmi-troubleshooting.html">WMI Troubleshooting</a></p>
<!-- raw HTML omitted -->
<p><a href="connecting-to-wmi-remotely-starting-with-vista.html">Connecting to WMI Remotely Starting with Vista</a></p>
<!-- raw HTML omitted -->
</body>
