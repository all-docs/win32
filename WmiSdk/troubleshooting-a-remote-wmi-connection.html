<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Troubleshooting a Remote WMI Connection</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The following sections describe common issues developers may have with creating a remote WMI connection.
ms.assetid: 328e420b-a859-4ce9-8a31-67150eb0a78f
ms.tgt_platform: multiple
title: Troubleshooting a Remote WMI Connection
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Troubleshooting a Remote WMI Connection</h1>
<p>The following sections describe common issues developers may have with creating a remote WMI connection.</p>
<p>The following sections are discussed in this topic:</p>
<ul>
<li><a href="#dcom-access-denied">DCOM Access Denied</a></li>
<li><a href="#failure-to-connect">Failure to Connect</a></li>
<li><a href="#wmi-connection-timed-out">WMI Connection Timed Out</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>DCOM Access Denied</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Symptom</p>
<!-- raw HTML omitted -->
<p>your connection failed with the error &quot;DCOM Access Denied&quot;, along with the decimal value -2147024891 or hex value0x80070005.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Issue</p>
<!-- raw HTML omitted -->
<p>DCOM may not be configured to allow a WMI connection.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Resolution</p>
<!-- raw HTML omitted -->
<p>You can configure DCOM settings for WMI using the DCOM Config utility (<strong>DCOMCnfg.exe</strong>) found in <strong>Administrative Tools</strong> in <strong>Control Panel</strong>. This utility exposes the settings that enable certain users to connect to the computer remotely through DCOM. Members of the Administrators group are allowed to remotely connect to the computer by default. With this utility you can set the security to start, access, and configure the WMI service.</p>
<p>For more information, see <a href="securing-a-remote-wmi-connection.html">Securing a Remote WMI Connection</a>.</p>
<!-- raw HTML omitted -->
<h2>Failure to Connect</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Symptom</p>
<!-- raw HTML omitted -->
<p>You cannot connect to WMI on a remote system.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Issue</p>
<!-- raw HTML omitted -->
<p>You may be trying to connect to a system that does not support WMI. The following connections between operating system versions are not supported:</p>
<ul>
<li>You cannot connect to a computer that is running a Starter, Basic, or Home edition.</li>
</ul>
<p>Alternately, you may be trying to connect to a namespace which requires an encrypted connection, one that requires an authentication level of <code>pktPrivacy</code>, <strong>WbemAuthenticationLevelPktPrivacy</strong>, or <strong>RPC_C_AUTHN_LEVEL_PKT_PRIVACY</strong>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Resolution</p>
<!-- raw HTML omitted -->
<p>For more information, see <a href="securing-wmi-namespaces.html">Securing WMI Namespaces</a>, <a href="securing-c---clients-and-providers.html">Securing C++ Clients and Providers</a>, or <a href="setting-the-default-process-security-level-using-vbscript.html">Setting the Default Process Security Level Using VBScript</a>.</p>
<!-- raw HTML omitted -->
<h2>WMI Connection Timed Out</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Symptom</p>
<!-- raw HTML omitted -->
<p>Your WMI connection times out.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Issue</p>
<!-- raw HTML omitted -->
<p>Due to network lag issues, the computer is simply not able to respond in time.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Resolution</p>
<!-- raw HTML omitted -->
<p>When connecting to WMI through a call to <a href="swbemlocator-connectserver.html"><strong>SWbemLocator.ConnectServer</strong></a> or <a href="/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemlocator-connectserver"><strong>IWbemLocator::ConnectServer</strong></a>, you can set the <strong>wbemConnectFlagUseMaxWait</strong> flag (scripting) or the <strong>WBEM_FLAG_CONNECT_USE_MAX_WAIT</strong>in C++ value to 128 (0x80) to impose a two (2) minute time-out on the call.</p>
<!-- raw HTML omitted -->
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="connecting-to-wmi-on-a-remote-computer.html">Connecting to WMI on a Remote Computer</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
