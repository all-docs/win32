<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Setting Up a Fixed Port for WMI</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: WMI runs as part of a shared service host with ports assigned through DCOM by default. However, you can set up the WMI service to run as the only process in a separate host and specify a fixed port.
ms.assetid: 62908445-2a43-4a20-a998-e497c6ecf48e
ms.tgt_platform: multiple
title: Setting Up a Fixed Port for WMI
ms.topic: article
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>kbArticle
api_name:
api_type:
api_location:</li>
</ul>
<hr />
<h1>Setting Up a Fixed Port for WMI</h1>
<p>WMI runs as part of a shared service host with ports assigned through DCOM by default. However, you can set up the WMI service to run as the only process in a separate host and specify a fixed port.</p>
<p>The following procedure is an automated setup to allow WMI to have a fixed port. The procedure uses the <a href="winmgmt.html"><strong>winmgmt</strong></a> command-line tool.</p>
<p><strong>To set up a fixed port for WMI</strong></p>
<ol>
<li>At the command prompt, type <strong>winmgmt -standalonehost</strong></li>
<li>Stop the WMI service by typing the command <strong>net stop &quot;Windows Management Instrumentation&quot;</strong>, or use the short name of <strong>net stop winmgmt</strong></li>
<li>Restart the WMI service again in a new service host by typing <strong>net start &quot;Windows Management Instrumentation&quot;</strong> or <strong>net start winmgmt</strong></li>
<li>Establish a new port number for the WMI service by typing <strong>netsh firewall add portopening TCP 24158 WMIFixedPort</strong></li>
</ol>
<p>To undo any changes you make to WMI, type <strong>winmgmt /sharedhost</strong>, then stop and start the winmgmt service again.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="connecting-to-wmi-on-a-remote-computer.html">Connecting to WMI on a Remote Computer</a></p>
<!-- raw HTML omitted -->
<p><a href="connecting-to-wmi-remotely-starting-with-vista.html">Troubleshooting a Remote WMI Connections</a></p>
<!-- raw HTML omitted -->
<p><a href="provider-hosting-and-security.html">Provider Hosting and Security</a></p>
<!-- raw HTML omitted -->
</body>
