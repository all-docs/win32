<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SWbemLastError object</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The methods and properties of the SWbemLastError object contain and manipulate error objects.
ms.assetid: 11a652fa-29e8-437b-8e62-e28e56a8a38d
ms.tgt_platform: multiple
title: SWbemLastError object (Wbemdisp.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>SWbemLastError</li>
<li>Associators_</li>
<li>AssociatorsAsync_</li>
<li>Delete_</li>
<li>DeleteAsync_</li>
<li>ExecMethod_</li>
<li>ExecMethodAsync_</li>
<li>Instances_</li>
<li>InstancesAsync_</li>
<li>Put_</li>
<li>PutAsync_</li>
<li>References_</li>
<li>ReferencesAsync_</li>
<li>SpawnDerivedClass_</li>
<li>SpawnInstance_</li>
<li>Subclasses_</li>
<li>SubclassesAsync_</li>
<li>Derivation_</li>
<li>get_Derivation_</li>
<li>Methods_</li>
<li>get_Methods_</li>
<li>Qualifiers_</li>
<li>get_Qualifiers_</li>
<li>Security_</li>
<li>get_Security_</li>
<li>ISWbemLastError
api_type:</li>
<li>COM
api_location:</li>
<li>Wbemdisp.dll</li>
</ul>
<hr />
<h1>SWbemLastError object</h1>
<p>The methods and properties of the <strong>SWbemLastError</strong> object contain and manipulate error objects. The methods and properties of this object are exactly the same as those of the <a href="swbemobject.html"><strong>SWbemObject</strong></a> object, but are used to contain error information instead of WMI class information. This object can be created by the VBScript <strong>CreateObject</strong> call.</p>
<p>You can create an <strong>SWbemLastError</strong> error object to inspect the extended error information that is associated with a previous method call. If error information is not available, an attempt to create an error object will fail. If the call succeeds and an error object returns, the status of the object is reset. Further attempts to retrieve an error object will fail until a new error occurs. If you make an asynchronous call that fails, an <strong>SWbemLastError</strong> object may be returned to you by the <a href="swbemsink-oncompleted.html"><strong>SWbemSink.OnCompleted</strong></a> event in the <em>objWbemErrorObject</em> parameter.</p>
<h2>Members</h2>
<p>The <strong>SWbemLastError</strong> object has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>SWbemLastError</strong> object has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>Associators_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>AssociatorsAsync_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemlasterror-clone-.html"><strong>Clone_</strong></a></td>
<td align="left">Makes a copy of the current object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemlasterror-compareto-.html"><strong>CompareTo_</strong></a></td>
<td align="left">Tests two objects for equality.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>Delete_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>DeleteAsync_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>ExecMethod_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>ExecMethodAsync_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemlasterror-getobjecttext-.html"><strong>GetObjectText_</strong></a></td>
<td align="left">Retrieves the textual representation of the object written with MOF syntax.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>Instances_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>InstancesAsync_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>Put_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>PutAsync_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>References_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>ReferencesAsync_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>SpawnDerivedClass_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>SpawnInstance_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>Subclasses_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>SubclassesAsync_</strong></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<p>The <strong>SWbemLastError</strong> object has these properties.</p>
<table>
<thead>
<tr>
<th align="left">Property</th>
<th align="left">Access type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>Derivation_</strong><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>Methods_</strong> <!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemlasterror-path-.html"><strong>Path_</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Contains an <a href="swbemobjectpath.html"><strong>SWbemObjectPath</strong></a> object that represents the object path of the current class or instance.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="swbemlasterror-properties-.html"><strong>Properties_</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Represents the collection of properties of the <strong>SWbemLastError</strong> object. This property is an <a href="swbempropertyset.html"><strong>SWbemPropertySet</strong></a> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>Qualifiers_</strong><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><strong>Security_</strong><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Not used. The <a href="swbemobject.html"><strong>SWbemObject</strong></a> object provides the same method.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Examples</h2>
<p>The following VBScript sample demonstrates how to inspect error and error object information.</p>
<pre lang="VB"><code>On Error Resume Next

'Ask for non-existent class to force error

Set t_Service = GetObject(&quot;winmgmts://./root/default&quot;)
Set t_Object = t_Service.Get(&quot;Nosuchclass000&quot;)

if Err = 0 Then
 WScript.Echo &quot;Got a class&quot;
Else
 WScript.Echo &quot;&quot;
 WScript.Echo &quot;Err Information:&quot;
 WScript.Echo &quot;&quot;
 WScript.Echo &quot;  Source:&quot;, Err.Source
 WScript.Echo &quot;  Description:&quot;, Err.Description
 WScript.Echo &quot;  Number&quot;, &quot;0x&quot; &amp; Hex(Err.Number)

 'Create the last error object
 set t_Object = CreateObject(&quot;WbemScripting.SWbemLastError&quot;)
 WScript.Echo &quot;&quot;
 WScript.Echo &quot;WMI Last Error Information:&quot;
 WScript.Echo &quot;&quot;
 WScript.Echo &quot; Operation:&quot;, t_Object.Operation
 WScript.Echo &quot; Provider:&quot;, t_Object.ProviderName

 strDescr = t_Object.Description
 strPInfo = t_Object.ParameterInfo
 strCode = t_Object.StatusCode

 if (strDescr &lt;&gt; nothing) Then
  WScript.Echo &quot; Description:&quot;, strDescr  
 end if

 if (strPInfo &lt;&gt; nothing) Then
  WScript.Echo &quot; Parameter Info:&quot;, strPInfo  
 end if

 if (strCode &lt;&gt; nothing) Then
  WScript.Echo &quot; Status:&quot;, strCode  
 end if

 WScript.Echo &quot;&quot;
 Err.Clear
 set t_Object2 = CreateObject(&quot;WbemScripting.SWbemLastError&quot;)
 if Err = 0 Then
    WScript.Echo &quot;Got the error object again - this shouldn't have happened!&quot; 
 Else
    Err.Clear
    WScript.Echo &quot;Couldn't get last error again - as expected&quot;
 End if
End If

</code></pre>
<p>The following Perl sample demonstrates how to inspect error and error object information.</p>
<pre><code>use strict;
use Win32::OLE;

my ( $t_Service, $t_Object, $t_Object2, $strDescr, $strPInfo, $strCode );

# Close STDERR file handle to eliminate redundant error message
close(STDERR);

# Ask for non-existent class to force error 
$t_Service = Win32::OLE-&gt;GetObject(&quot;winmgmts:{impersonationLevel=impersonate}!\\\\.\\root\\default&quot;); 
$t_Object = $t_Service-&gt;Get(&quot;Nosuchclass000&quot;);

if (defined $t_Object)
{
 print &quot;Got a class\n&quot;; 
}
else
{
 print &quot;\nErr Information:\n\n&quot;;
 print Win32::OLE-&gt;LastError, &quot;\n&quot;;

 # Create the last error object
 $t_Object = new Win32::OLE 'WbemScripting.SWbemLastError';
 print &quot;\nWMI Last Error Information:\n\n&quot;;
 print &quot; Operation: &quot;, $t_Object-&gt;{Operation}, &quot;\n&quot;;
 print &quot; Provider: &quot;, $t_Object-&gt;{ProviderName}, &quot;\n&quot;;
 
 $strDescr = $t_Object-&gt;{Description};
 $strPInfo = $t_Object-&gt;{ParameterInfo};
 $strCode = $t_Object-&gt;{StatusCode};

 if (defined $strDescr)
 {
  print &quot; Description: &quot;, $strDescr, &quot;\n&quot;;  
 }

 if (defined $strPInfo)
 {
  print &quot; Parameter Info: &quot;, $strPInfo, &quot;\n&quot;;  
 }

 if (defined $strCode)
 {
  print &quot; Status: &quot;, $strCode, &quot;\n&quot;;  
 }

 print &quot;\n&quot;;

 $t_Object2 = new Win32::OLE 'WbemScripting.SWbemLastError';
 if (defined $t_Object2)
 {
  print &quot;Got the error object again - this shouldn't have happened!\n&quot;;
 }
 else
 {
  print &quot;Couldn't get last error again - as expected\n&quot;;
 }
}
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemdisp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Type library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemdisp.tlb<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wbemdisp.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>CLSID<!-- raw HTML omitted --></td>
<td>CLSID_SWbemLastError<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_ISWbemLastError<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="scripting-api-objects.html">Scripting API Objects</a></p>
<!-- raw HTML omitted -->
</body>
