<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>WMI Tasks: Accounts and Domains</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Account and domain administrative tasks obtain information such as the computer domain or the currently logged-on user.
ms.assetid: 1a9cc44b-c366-465d-a0d0-536d5dc818b5
ms.tgt_platform: multiple
title: 'WMI Tasks: Accounts and Domains'
ms.topic: article
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>kbArticle
api_name:
api_type:
api_location:</li>
</ul>
<hr />
<h1>WMI Tasks: Accounts and Domains</h1>
<p>Account and domain administrative tasks obtain information such as the computer domain or the currently logged-on user. Many of these tasks are best performed with <a href="/windows/desktop/ADSI/active-directory-service-interfaces-adsi">ADSI</a> scripts. For more information and other examples, see the TechNet <a href="https://www.microsoft.com/technet/scriptcenter">ScriptCenter</a> Script Repository.</p>
<p>The script examples shown in this topic obtain data only from the local computer. For more information about how to use the script to obtain data from remote computers, see <a href="connecting-to-wmi-on-a-remote-computer.html">Connecting to WMI on a Remote Computer</a>.</p>
<p>The following procedure describes how to run a script.</p>
<p><strong>To run a script</strong></p>
<ol>
<li>Copy the code and save it in a file with a .vbs extension, such as <em>filename.vbs</em>. Ensure that your text editor does not add a .txt extension to the file.</li>
<li>Open a command prompt window and navigate to the directory where you saved the file.</li>
<li>Type <strong>cscript filename.vbs</strong> at the command prompt.</li>
<li>If you cannot access an event log, check to see if you are running from an Elevated command prompt. Some Event Log, such as the Security Event Log, may be protected by User Access Controls (UAC).</li>
</ol>
<blockquote>
<p>[!Note]<br />
By default, cscript displays the output of a script in the command prompt window. Because WMI scripts can produce large amounts of output, you might want to redirect the output to a file. Type <strong>cscript filename.vbs &gt; outfile.txt</strong> at the command prompt to redirect the output of the <em>filename.vbs</em> script to <em>outfile.txt</em>.</p>
</blockquote>
<p>The following table lists script examples that can be used to obtain various types of data from the local computer.</p>
<!-- raw HTML omitted -->
<p>For Each objComputer in colSettings
Wscript.Echo &quot;System Name: &quot; &amp; objComputer.Name
Wscript.Echo &quot;Domain: &quot; &amp; objComputer.Domain
Next<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>foreach (CimInstance cimObj in queryInstance)
{
Console.WriteLine(cimObj.CimInstanceProperties[&quot;Name&quot;].ToString());
Console.WriteLine(cimObj.CimInstanceProperties[&quot;Domain&quot;].ToString());
}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>&quot;Computer <code>&amp;quot;{0}.{1}</code>&quot; is a: &quot;-f $Computer.Name,$computer.domain</p>
<p>switch  ($computer.DomainRole) {
0 {&quot;Standalone Workstation&quot;}
1 {&quot;Member Workstation&quot;}
2 {&quot;Standalone Server&quot;}
3 {&quot;Member Server&quot;}
4 {&quot;Backup Domain Controller&quot;}
5 {&quot;Primary Domain Controller&quot;}
}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>foreach (CimInstance cimObj in queryInstance)
{
Console.WriteLine(cimObj.CimInstanceProperties[&quot;Name&quot;].ToString());
}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>For Each objComputer in colComputer
Wscript.Echo &quot;User Name = &quot; &amp; objComputer.UserName &amp; VBNewLine &amp; &quot;Computer Name = &quot; &amp; objComputer.Name
WScript.Echo objComputer.UserName
Next<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>foreach (CimInstance cimObj in queryInstance)
{
Console.WriteLine(&quot;User Name: &quot; + cimObj.CimInstanceProperties[&quot;UserName&quot;].ToString());
}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted -->
$Computer = Get-WmiObject -Class Win32_ComputerSystem -ComputerName $comp</p>
<p><!-- raw HTML omitted -->
$Return  = $Computer.Rename($NewName)</p>
<p>if ($return.ReturnValue -eq 0) {
&quot;Computer name is now: $NewName&quot;
&quot; but you need to reboot first&quot;
} else {
&quot;  RenameFailed, return code: {0}&quot; -f $return.ReturnValue
}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="wmi-tasks-for-scripts-and-applications.html">WMI Tasks for Scripts and Applications</a></p>
<!-- raw HTML omitted -->
<p><a href="wmi-c---application-examples.html">WMI C++ Application Examples</a></p>
<!-- raw HTML omitted -->
<p><a href="https://www.microsoft.com/technet/scriptcenter">TechNet ScriptCenter</a></p>
<!-- raw HTML omitted -->
</body>
