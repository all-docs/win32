<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SslGenerateMasterKey function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Computes the Secure Sockets Layer protocol (SSL) master secret key.
ms.assetid: c9408eb3-711d-42c3-a4ba-e388689da34e
title: SslGenerateMasterKey function (Sslprovider.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>SslGenerateMasterKey
api_type:</li>
<li>DllExport
api_location:</li>
<li>Ncrypt.dll</li>
</ul>
<hr />
<h1>SslGenerateMasterKey function</h1>
<p>The <strong>SslGenerateMasterKey</strong> function computes the <a href="/windows/desktop/SecGloss/s-gly"><em>Secure Sockets Layer protocol</em></a> (SSL) master secret key.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>SECURITY_STATUS WINAPI SslGenerateMasterKey(
  _In_  NCRYPT_PROV_HANDLE hSslProvider,
  _In_  NCRYPT_KEY_HANDLE  hPrivateKey,
  _In_  NCRYPT_KEY_HANDLE  hPublicKey,
  _Out_ NCRYPT_KEY_HANDLE  *phMasterKey,
  _In_  DWORD              dwProtocol,
  _In_  DWORD              dwCipherSuite,
  _In_  PNCryptBufferDesc  pParameterList,
  _Out_ PBYTE              pbOutput,
  _In_  DWORD              cbOutput,
  _Out_ DWORD              *pcbResult,
  _In_  DWORD              dwFlags
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hSslProvider</em> [in]</p>
<!-- raw HTML omitted -->
<p>The handle to the SSL protocol provider instance.</p>
<!-- raw HTML omitted -->
<p><em>hPrivateKey</em> [in]</p>
<!-- raw HTML omitted -->
<p>The handle to the <a href="/windows/desktop/SecGloss/p-gly"><em>private key</em></a> used in the exchange.</p>
<!-- raw HTML omitted -->
<p><em>hPublicKey</em> [in]</p>
<!-- raw HTML omitted -->
<p>The handle to the <a href="/windows/desktop/SecGloss/p-gly"><em>public key</em></a> used in the exchange.</p>
<!-- raw HTML omitted -->
<p><em>phMasterKey</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to the handle to the generated <a href="/windows/desktop/SecGloss/m-gly"><em>master key</em></a>.</p>
<!-- raw HTML omitted -->
<p><em>dwProtocol</em> [in]</p>
<!-- raw HTML omitted -->
<p>One of the <a href="https://msdn.microsoft.com/library/Hh971257(v=VS.85).aspx"><strong>CNG SSL Provider Protocol Identifier</strong></a> values.</p>
<!-- raw HTML omitted -->
<p><em>dwCipherSuite</em> [in]</p>
<!-- raw HTML omitted -->
<p>One of the <a href="https://msdn.microsoft.com/library/Hh971253(v=VS.85).aspx"><strong>CNG SSL Provider Cipher Suite Identifier</strong></a> values.</p>
<!-- raw HTML omitted -->
<p><em>pParameterList</em> [in]</p>
<!-- raw HTML omitted -->
<p>A pointer to an array of <strong>NCryptBuffer</strong> buffers that contain information used as part of the key exchange operation. The precise set of buffers is dependent on the protocol and cipher suite that is used. At the minimum, the list will contain buffers that contain the client and server supplied random values.</p>
<!-- raw HTML omitted -->
<p><em>pbOutput</em> [out]</p>
<!-- raw HTML omitted -->
<p>The address of a buffer that receives the premaster secret encrypted with the public key of the server. The <em>cbOutput</em> parameter contains the size of this buffer. If this parameter is <strong>NULL</strong>, this function returns the required size, in bytes, in the <strong>DWORD</strong> pointed to by the <em>pcbResult</em> parameter.</p>
<blockquote>
<p>[!Note]<br />
This buffer is used when performing a RSA key exchange.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><em>cbOutput</em> [in]</p>
<!-- raw HTML omitted -->
<p>The size, in bytes, of the <em>pbOutput</em> buffer.</p>
<!-- raw HTML omitted -->
<p><em>pcbResult</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to a <strong>DWORD</strong> value in which to place number of bytes written to the <em>pbOutput</em> buffer.</p>
<!-- raw HTML omitted -->
<p><em>dwFlags</em> [in]</p>
<!-- raw HTML omitted -->
<p>Specifies whether this function is being used for client-side or server-side key exchange.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>NCRYPT_SSL_CLIENT_FLAG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000001<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Specifies a client-side key exchange.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>NCRYPT_SSL_SERVER_FLAG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000002<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Specifies a server-side key exchange.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, it returns zero.</p>
<p>If the function fails, it returns a nonzero error value.</p>
<p>Possible return codes include, but are not limited to, the following.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>NTE_NO_MEMORY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x8009000EL<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Not enough memory is available to allocate necessary buffers.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>NTE_INVALID_HANDLE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x80090026L<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>One of the provided handles is not valid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>NTE_INVALID_PARAMETER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x80090027L<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>phMasterKey</em> or <em>hPublicKey</em> parameter is not valid.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Sslprovider.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Ncrypt.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
