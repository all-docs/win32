<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CNG DPAPI</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Microsoft introduced the data protection application programming interface (DPAPI) in Windows.
ms.assetid: 048DEA72-39E1-4129-A554-F7D08442C2D9
title: CNG DPAPI
ms.topic: article
ms.date: 06/06/2023</h2>
<h1>CNG DPAPI</h1>
<p>Microsoft introduced the data protection application programming interface (DPAPI) in Windows. The API consists of two functions, <a href="/windows/win32/api/dpapi/nf-dpapi-cryptprotectdata"><strong>CryptProtectData</strong></a> and <a href="/windows/win32/api/dpapi/nf-dpapi-cryptunprotectdata"><strong>CryptUnprotectData</strong></a>. DPAPI is part of CryptoAPI and was intended for developers who knew very little about using cryptography. The two functions could be used to encrypt and decrypt static data on a single computer.</p>
<p>Cloud computing, however, often requires that content encrypted on one computer be decrypted on another. Therefore, beginning with WindowsÂ 8, Microsoft extended the idea of using a relatively straightforward API to encompass cloud scenarios. This new API, called DPAPI-NG, enables you to securely share secrets (keys, passwords, key material) and messages by protecting them to a set of principals that can be used to remove protection from them on different computers after proper authentication and authorization. The following principals are currently supported:</p>
<ul>
<li>A group in an Active Directory forest.</li>
<li>Web credentials.</li>
</ul>
<p>For more information, see the following topics:</p>
<ul>
<li><a href="protection-providers.html">Protection Providers</a></li>
<li><a href="protection-descriptors.html">Protection Descriptors</a></li>
<li><a href="protected-data-format.html">Protected Data Format</a></li>
<li><a href="cng-dpapi-backup-keys-on-ad-domain-controllers.html">DPAPI backup keys on Active Directory domain controllers</a></li>
</ul>
<p>DPAPI-NG is built on top of Cryptography Next Generation (CNG) and includes the following functions:</p>
<ul>
<li><a href="/windows/win32/api/NCryptprotect/nf-ncryptprotect-ncryptcreateprotectiondescriptor"><strong>NCryptCreateProtectionDescriptor</strong></a></li>
<li><a href="/windows/win32/api/NCryptprotect/nf-ncryptprotect-ncryptcloseprotectiondescriptor"><strong>NCryptCloseProtectionDescriptor</strong></a></li>
<li><a href="/windows/win32/api/NCryptprotect/nf-ncryptprotect-ncryptprotectsecret"><strong>NCryptProtectSecret</strong></a></li>
<li><a href="/windows/win32/api/NCryptprotect/nf-ncryptprotect-ncryptqueryprotectiondescriptorname"><strong>NCryptQueryProtectionDescriptorName</strong></a></li>
<li><a href="/windows/win32/api/NCryptprotect/nf-ncryptprotect-ncryptregisterprotectiondescriptorname"><strong>NCryptRegisterProtectionDescriptorName</strong></a></li>
<li><a href="/windows/win32/api/NCryptprotect/nf-ncryptprotect-ncryptstreamclose"><strong>NCryptStreamClose</strong></a></li>
<li><a href="/windows/win32/api/NCryptprotect/nf-ncryptprotect-ncryptstreamopentoprotect"><strong>NCryptStreamOpenToProtect</strong></a></li>
<li><a href="/windows/win32/api/NCryptprotect/nf-ncryptprotect-ncryptstreamopentounprotect"><strong>NCryptStreamOpenToUnprotect</strong></a></li>
<li><a href="/windows/win32/api/NCryptprotect/nf-ncryptprotect-ncryptstreamupdate"><strong>NCryptStreamUpdate</strong></a></li>
<li><a href="/windows/win32/api/NCryptprotect/nf-ncryptprotect-ncryptunprotectsecret"><strong>NCryptUnprotectSecret</strong></a></li>
</ul>
</body>
