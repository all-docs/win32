<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Special Effects (Direct3D 9)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This topic contains examples of special effects accomplished with texture coordinate processing.
ms.assetid: 8a120ff4-1252-4c4f-93fc-ea59bb7a1168
title: Special Effects (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Special Effects (Direct3D 9)</h1>
<p>This topic contains examples of special effects accomplished with texture coordinate processing.</p>
<ul>
<li><a href="#animating-textures-by-translation-or-rotation-on-a-model">Animating textures (by translation or rotation) on a model</a></li>
<li><a href="#creating-texture-coordinates-as-a-linear-function-of-a-models-camera-space-position">Creating texture coordinates as a linear function of a model's camera-space position</a></li>
<li><a href="#performing-environment-mapping-with-a-cubic-environment-map">Performing environment mapping with a cubic environment map</a></li>
<li><a href="#performing-projective-texturing">Performing projective texturing</a></li>
</ul>
<h2>Animating textures (by translation or rotation) on a model</h2>
<ul>
<li>
<p>Define 2D texture coordinates in your vertex format.</p>
<pre><code>// Use a single texture, with 2D texture coordinates. This
// bit-pattern should be expanded to include position, normal, 
// and color information as needed.
DWORD dwFVFTex = D3FVF_TEX1 | D3DFVF_TEXCOORDSIZE2(0);
</code></pre>
</li>
<li>
<p>Configure the rasterizer to use 2D texture coordinates.</p>
<pre><code>SetTextureStageState(0, D3DTSS_TEXTURETRANSFORMFLAGS, D3DTTFF_COUNT2);
</code></pre>
</li>
<li>
<p>Define and set an appropriate texture coordinate transformation matrix.</p>
<pre><code>// M is a D3DMATRIX being set to translate texture
// coordinates in the U and V directions.
//      1   0  0  0
//      0   1  0  0
//      du dv  1  0 (du and dv change each frame)
//      0   0  0  1

D3DMATRIX M = D3DXMatrixIdentity(); // declared in d3dutil.h
M._31 = du; 
M._32 = dv; 
</code></pre>
</li>
</ul>
<h2>Creating texture coordinates as a linear function of a model's camera-space position</h2>
<ul>
<li>
<p>Use the D3DTSS_TCI_CAMERASPACEPOSITION flag to instruct the system to pass the vertex position, in camera space, as input to a texture transformation.</p>
<pre><code>// The input vertices have no texture coordinates, saving 
// bandwidth. Three texture coordinates are generated by 
// using vertex position in camera space (x, y, z).
SetTextureStageState(0, D3DTSS_TEXCOORDINDEX, D3DTSS_TCI_CAMERASPACEPOSITION);
</code></pre>
</li>
<li>
<p>Instruct the rasterizer to expect 2D texture coordinates.</p>
<pre><code>// Two output coordinates are used.
SetTextureStageState(0, D3DTSS_TEXTURETRANSFORMFLAGS, D3DTTFF_COUNT2);
</code></pre>
</li>
<li>
<p>Define and set a matrix that applies a linear function.</p>
<pre><code>// Generate texture coordinates as linear functions 
// so that:
//      u = Ux*x + Uy*y + Uz*z + Uw 
//      v = Vx*x + Vy*y + Vz*z + Vw
// The matrix M for this case is:
//      Ux  Vx  0  0 
//      Uy  Vy  0  0 
//      Uz  Vz  0  0 
//      Uw  Vw  0  0 

SetTransform(D3DTS_TEXTURE0, &amp;M);
</code></pre>
</li>
</ul>
<h2>Performing environment mapping with a cubic environment map</h2>
<ul>
<li>
<p>Use the D3DTSS_TCI_CAMERASPACEREFLECTIONVECTOR flag to instruct the system to automatically generate texture coordinates as reflection vectors for cubic mapping.</p>
<pre><code>SetTextureStageState(0, D3DTSS_TEXCOORDINDEX, D3DTSS_TCI_CAMERASPACEREFLECTIONVECTOR);
</code></pre>
</li>
<li>
<p>Instruct the rasterizer to expect texture coordinates with three elements.</p>
<pre><code>SetTextureStageState(0, D3DTSS_TEXTURETRANSFORMFLAGS, D3DTTFF_COUNT3);
</code></pre>
</li>
</ul>
<h2>Performing projective texturing</h2>
<ul>
<li>
<p>Use the D3DTSS_TCI_CAMERASPACEPOSITION flag to instruct the system to pass the vertex position as input to a texture transformation matrix.</p>
<pre><code>SetTextureStageState(0, D3DTSS_TEXCOORDINDEX, D3DTSS_TCI_CAMERASPACEPOSITION);
</code></pre>
</li>
<li>
<p>Create and apply the texture projection matrix. This is beyond the scope of this documentation, and is the topic of several industry articles.</p>
</li>
<li>
<p>Instruct the rasterizer to expect three-element projected texture coordinates.</p>
<pre><code>// Two output coordinates are used.

SetTextureStageState(0, D3DTSS_TEXTURETRANSFORMFLAGS, D3DTTF_PROJECTED | D3DTTFF_COUNT3);
</code></pre>
</li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="texture-coordinate-processing.html">Texture Coordinate Processing</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
