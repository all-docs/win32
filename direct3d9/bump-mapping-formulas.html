<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Bump Mapping Formulas (Direct3D 9)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Direct3D applies the following formulas to the DU and DV components in each bump map pixel.
ms.assetid: ae1de432-d1cc-45a5-b25f-b669cd30af3b
title: Bump Mapping Formulas (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Bump Mapping Formulas (Direct3D 9)</h1>
<p>Direct3D applies the following formulas to the D<!-- raw HTML omitted -->U<!-- raw HTML omitted --> and D<!-- raw HTML omitted -->V<!-- raw HTML omitted --> components in each bump map pixel.</p>
<p><img src="images/dudv-transform.png" alt="formulas of bump mapping matrix transformations" /></p>
<p>In these formulas, the D<!-- raw HTML omitted -->U<!-- raw HTML omitted --> and D<!-- raw HTML omitted -->V<!-- raw HTML omitted --> variables are taken directly from a bump map pixel and transformed by a 2x2 matrix to produce the output delta values D<!-- raw HTML omitted -->U<!-- raw HTML omitted -->' and D<!-- raw HTML omitted -->V<!-- raw HTML omitted -->'. The system uses the output values to modify the texture coordinates that address the environment map in the next texture stage. The coefficients of the transformation matrix are set though the D3DTSS_BUMPENVMAT00, D3DTSS_BUMPENVMAT10, D3DTSS_BUMPENVMAT01, and D3DTSS_BUMPENVMAT11 texture stage states.</p>
<p>In addition to the u and v delta values, the system can compute a luminance value that it uses to modulate the color of the environment map in the next blending stage, as shown in the following formula.</p>
<p><img src="images/l-transform.png" alt="formula for output luminance, computed from scale factor and offset" /></p>
<p>In this formula, L' is the output luminance being computed. The L variable is the luminance value taken from a bump map pixel, which is multiplied by the scaling factor, S, and offset by the value in the variable O. The D3DTSS_BUMPENVLSCALE and D3DTSS_BUMPENVLOFFSET texture stage states control the values for the S and O variables in the formula. This formula is only applied when the texture blending operation for the stage that contains the bump map is set to D3DTOP_BUMPENVMAPLUMINANCE. When using D3DTOP_BUMPENVMAP, the system uses a value of 1.0 for L'.</p>
<p>After computing the output delta values D<!-- raw HTML omitted -->U<!-- raw HTML omitted -->' and D<!-- raw HTML omitted -->V<!-- raw HTML omitted -->', the system adds them to the texture coordinates in the next texture stage, and modulates the chosen color by the luminance to produce the color applied to the polygon.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="bump-mapping.html">Bump Mapping</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
