<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Writing Related Events in a Classic Provider</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Classic providers use the TraceEventInstance function to trace events that are part of a single transaction. You can also use this function to trace parent/child events.
ms.assetid: 246e9443-3120-49bf-a6e3-64dddba348fa
title: Writing Related Events in a Classic Provider
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Writing Related Events in a Classic Provider</h1>
<p><a href="about-event-tracing.html">Classic</a> providers use the <a href="/windows/win32/api/evntrace/nf-evntrace-traceeventinstance"><strong>TraceEventInstance</strong></a> function to trace events that are part of a single transaction. You can also use this function to trace parent/child events.</p>
<p>Before calling the <a href="/windows/win32/api/evntrace/nf-evntrace-traceeventinstance"><strong>TraceEventInstance</strong></a> function, you must first call the <a href="/windows/win32/api/evntrace/nf-evntrace-createtraceinstanceid"><strong>CreateTraceInstanceId</strong></a> function to obtain a transaction identifier. This function generates a unique transaction identifier, and maps it to a registered class GUID handle. The handles for registered class GUIDs are available in the <strong>RegHandle</strong> members of <a href="/windows/win32/api/evntrace/ns-evntrace-trace_guid_registration"><strong>TRACE_GUID_REGISTRATION</strong></a> structures, after calling the <a href="/windows/win32/api/evntrace/nf-evntrace-registertraceguidsa"><strong>RegisterTraceGuids</strong></a> function. The transaction identifier is placed in the <strong>InstanceId</strong> member of an <a href="/windows/win32/api/evntrace/ns-evntrace-event_instance_info"><strong>EVENT_INSTANCE_INFO</strong></a> structure that you pass to the <strong>CreateTraceInstanceId</strong> function.</p>
<p>The <a href="/windows/win32/api/evntrace/ns-evntrace-event_instance_header"><strong>EVENT_INSTANCE_HEADER</strong></a> structure that is passed to the <a href="/windows/win32/api/evntrace/nf-evntrace-traceeventinstance"><strong>TraceEventInstance</strong></a> function is similar to the <a href="/windows/win32/api/evntrace/ns-evntrace-event_trace_header"><strong>EVENT_TRACE_HEADER</strong></a> structure (see <a href="tracing-events.html">Tracing Events</a>), except that it contains additional information relating to instances, and does not contain a <strong>Guid</strong> member.</p>
<p>Event instances can be used to establish a hierarchical relationship between events. The <a href="/windows/win32/api/evntrace/nf-evntrace-traceeventinstance"><strong>TraceEventInstance</strong></a> function accepts instance-specific information from two event instances. The <em>pInstInfo</em> parameter points to the <a href="/windows/win32/api/evntrace/ns-evntrace-event_instance_info"><strong>EVENT_INSTANCE_INFO</strong></a> structure of the event instance, and the <em>pParentInstInfo</em> parameter points to the <strong>EVENT_INSTANCE_INFO</strong> structure of a parent event instance. The definition of a &quot;parent&quot; event instance is application-defined; the parent can be any instance that has already been generated.</p>
<p>Â </p>
<p>Â </p>
</body>
