<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Configuring and Starting the Global Logger Session</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The Global Logger event tracing session records events that occur early in the operating system boot process.
ms.assetid: 1462bbef-ef32-4053-9930-5b4a0ab46b47
title: Configuring and Starting the Global Logger Session
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Configuring and Starting the Global Logger Session</h1>
<p>The Global Logger event tracing session records events that occur early in the operating system boot process. Applications and device drivers can use the Global Logger session to capture traces before the user logs in. Note that some device drivers, such as disk device drivers, are not loaded at the time the Global Logger session begins.</p>
<blockquote>
<p>[!Note]<br />
If you are creating a Global Logger session on Windows Vista, you should consider creating an <a href="configuring-and-starting-an-autologger-session.html">AutoLogger session</a> instead.</p>
</blockquote>
<p>You use the registry to configure the Global Logger session. Add the <strong>GlobalLogger</strong> key to the following registry key, if it is not already present:</p>
<pre><code>HKEY_LOCAL_MACHINE
   \SYSTEM
      \CurrentControlSet
         \Control
            \WMI
</code></pre>
<p>The following table describes the values that you can define for the <strong>GlobalLogger</strong> key. You must have administrator privileges to specify these registry values. The registry values affect all providers that log events to the Global Logger session. The <strong>Start</strong> value is the only value required to start the Global Logger session; all other values have default settings that are used if the value is not present in the registry. Typically, you should use the default values. If you specify a value that ETW cannot support, ETW will override the value.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->Start<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_DWORD<!-- raw HTML omitted --></td>
<td>Set this value to 1 (on) to start the Global Logger session the next time the system starts. To stop the session from starting, set this value to 0 (off). <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->BufferSize<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_DWORD<!-- raw HTML omitted --></td>
<td>The size of each buffer, in kilobytes. This value should be less than one megabyte. ETW uses the size of physical memory to calculate this value. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->ClockType<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_DWORD<!-- raw HTML omitted --></td>
<td>The timer to use when logging the time stamp for each event.<!-- raw HTML omitted --><!-- raw HTML omitted -->1 = Performance counter value (high resolution)<!-- raw HTML omitted --><!-- raw HTML omitted -->2 = System timer<!-- raw HTML omitted --><!-- raw HTML omitted -->3 = CPU cycle counter<!-- raw HTML omitted --><!-- raw HTML omitted -->For a description of each clock type, see the <!-- raw HTML omitted -->ClientContext<!-- raw HTML omitted --> member of <!-- raw HTML omitted --><!-- raw HTML omitted -->WNODE_HEADER<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --> The default value is 1 (performance counter value) on Windows Vista and later. Prior to Windows Vista, the default value is 2 (system timer).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->EnableKernelFlags<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_BINARY<!-- raw HTML omitted --></td>
<td>Use this value to enable one or more kernel providers. If you enable kernel providers, the Global Logger session will rename itself to NT Kernel Logger when it starts. For possible values, see the <!-- raw HTML omitted -->EnableFlags<!-- raw HTML omitted --> member of <!-- raw HTML omitted --><!-- raw HTML omitted -->EVENT_TRACE_PROPERTIES<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->FileCounter<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_DWORD<!-- raw HTML omitted --></td>
<td>The number of event trace log files generated by Global Logger sessions. The system increments this value until it reaches the value of <!-- raw HTML omitted -->FileMax<!-- raw HTML omitted -->. Then, it resets the value to 0. This counter prevents the system from overwriting a Global Logger trace log file. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->FileMax<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_DWORD<!-- raw HTML omitted --></td>
<td>The maximum number of event trace log files permitted on the system. When the number of trace logs reaches the specified maximum, the system begins to overwrite the logs, beginning with the oldest. <!-- raw HTML omitted --> If the log file specified in <!-- raw HTML omitted -->FileName<!-- raw HTML omitted --> exists, ETW appends the <!-- raw HTML omitted -->FileCounter<!-- raw HTML omitted --> value to the file name. For example, if the default log file name is used, the form is %SystemRoot%\System32\LogFiles\WMI\GlobalLogger.etl.NNNN. <!-- raw HTML omitted --> The default value is 0, meaning that there is no maximum. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->FileName<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_SZ<!-- raw HTML omitted --></td>
<td>Fully qualified path of the log file. The path to this file must exist. The log file is a sequential log file. Note that all providers writing events to the Global Logger session write events to this log file. The path is limited to 1024 characters.If <!-- raw HTML omitted -->FileName<!-- raw HTML omitted --> is not specified, events are written to %SystemRoot%\System32\LogFiles\WMI\GlobalLogger.etl. <!-- raw HTML omitted -->Prior to Windows Vista:<!-- raw HTML omitted --> The default file is %SystemRoot%\System32\LogFiles\WMI\Trace.log.<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->FlushTimer<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_DWORD<!-- raw HTML omitted --></td>
<td>How often, in seconds, the trace buffers are forcibly flushed. The minimum flush time is 1 second. This forced flush is in addition to the automatic flush that occurs when a buffer is full and when the trace session stops. <!-- raw HTML omitted --> For the case of a real-time logger, a value of zero (the default value) means that the flush time will be set to 1 second. A real-time logger is when <!-- raw HTML omitted -->LogFileMode<!-- raw HTML omitted --> is set to <!-- raw HTML omitted -->EVENT_TRACE_REAL_TIME_MODE<!-- raw HTML omitted -->.<!-- raw HTML omitted --> The default value is 0. By default, buffers are flushed only when they are full. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->LogFileMode<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_DWORD<!-- raw HTML omitted --></td>
<td>Specifies log session options. For values, see <!-- raw HTML omitted -->Logging Mode Constants<!-- raw HTML omitted -->. This values is supported on Windows Vista and later. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->MaximumBuffers<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_DWORD<!-- raw HTML omitted --></td>
<td>The maximum number of buffers to allocate. Typically, this value is the minimum number of buffers plus twenty. ETW uses the buffer size and the size of physical memory to calculate this value. This value must be greater than or equal to the value for <!-- raw HTML omitted -->MinimumBuffers<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->MaxFileSize<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_DWORD<!-- raw HTML omitted --></td>
<td>The maximum size, in megabytes, of the event trace log file. By default, there is no maximum file size.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->MinimumBuffers<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_DWORD<!-- raw HTML omitted --></td>
<td>The minimum number of buffers to allocate when the Global Logger session starts. The minimum number of buffers that you can specify is two buffers per processor. For example, on a single processor computer, the minimum number of buffers is two. <!-- raw HTML omitted --> The default value on a single-processor system is 0x3.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->Status<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->REG_DWORD<!-- raw HTML omitted --></td>
<td>The startup status of the Global Logger. If the Global Logger failed to start, the value of this key is the appropriate Win32 error code. If the Global Logger successfully started, the value of this key is ERROR_SUCCESS (0).<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>After the registry has been modified and the computer restarted, the Global Logger session starts automatically and is used like any other session with one exception: You use the WMI_GLOBAL_LOGGER_ID constant handle (defined in Wmistr.h) to reference the Global Logger session. This constant may be used as an argument to any event tracing function that accepts a session handle. In functions that accept a session name, use GLOBAL_LOGGER_NAME.</p>
<p>The Global Logger controller does not call the <a href="/windows/win32/api/evntrace/nf-evntrace-enabletrace"><strong>EnableTrace</strong></a> function to enable providers. The provider is responsible for determining if the Global Logger session is started and then enabling itself.</p>
<p>To determine if the Global Logger session is started, you can call the <a href="/windows/win32/api/evntrace/nf-evntrace-controltracea"><strong>ControlTrace</strong></a> function, setting <em>SessionHandle</em> to WMI_GLOBAL_LOGGER_ID and <em>ControlCode</em> to <strong>EVENT_TRACE_CONTROL_QUERY</strong>. If the <strong>ControlTrace</strong> call is successful, the Global Logger session exists and the provider can enable itself and log events to the Global Logger session (the <strong>ControlTrace</strong> function returns ERROR_WMI_INSTANCE_NOT_FOUND if the Global Logger is not active).</p>
<p>Typically, the controller is responsible for passing the enable flags and level to the provider when it enables the provider, but because the Global Logger controller does not enable the provider, it is the provider's responsibility to pass this information to itself, if needed.</p>
<p>The Global Logger session is a limited resource and should be used sparingly. Services that want to capture information during the boot process should consider adding controller logic to itself instead of using the Global Logger session.</p>
<p>For details on starting an event tracing session, see <a href="configuring-and-starting-an-event-tracing-session.html">Configuring and Starting an Event Tracing Session</a>.</p>
<p>For details on starting a private logger session, see <a href="configuring-and-starting-a-private-logger-session.html">Configuring and Starting a Private Logger Session</a>.</p>
<p>For details on starting an NT Kernel Logger session, see <a href="configuring-and-starting-the-nt-kernel-logger-session.html">Configuring and Starting the NT Kernel Logger Session</a>.</p>
</body>
