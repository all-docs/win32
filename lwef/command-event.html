<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Command Event</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Command Event
description: Command Event
ms.assetid: 3e180286-dfa0-4b34-90ee-3267ed6f48af
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Command Event</h1>
<p>[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.]</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Description</strong></p>
<!-- raw HTML omitted -->
<p>Occurs when the user chooses a (client's) command.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Syntax</strong></p>
<!-- raw HTML omitted -->
<p><strong>Sub</strong> <em>agent</em>_<strong>Command</strong> <strong>(ByVal</strong> <em>UserInput</em>**)**</p>
<table>
<thead>
<tr>
<th>Part</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>UserInput</em></td>
<td>Identifies the <a href="/windows/desktop/lwef/the-command-object"><strong>Command</strong></a> object returned by the server. <!-- raw HTML omitted --> The following properties can be accessed from the <a href="/windows/desktop/lwef/the-command-object"><strong>Command</strong></a> object:<!-- raw HTML omitted --> CharacterID <!-- raw HTML omitted --> A string value identifying the name (ID) of the character that received the command. <!-- raw HTML omitted --> <a href="name-property.html"><strong>Name</strong></a><!-- raw HTML omitted --> A string value identifying the name (ID) of the command.<!-- raw HTML omitted --> <a href="confidence-property.html"><strong>Confidence</strong></a><!-- raw HTML omitted --> A Long integer value indicating the confidence scoring for the command. <!-- raw HTML omitted --> <a href="voice-property.html"><strong>Voice</strong></a> <!-- raw HTML omitted --> A string value identifying the voice text for the command.<!-- raw HTML omitted --> Alt1Name <!-- raw HTML omitted --> A string value identifying the name of the next (second) best command.<!-- raw HTML omitted --> Alt1Confidence <!-- raw HTML omitted --> A Long integer value indicating the confidence scoring for the next (second) best command.<!-- raw HTML omitted --> Alt1Voice <!-- raw HTML omitted --> A string value identifying the voice text for the next best alternative command match.<!-- raw HTML omitted --> Alt2Name <!-- raw HTML omitted --> A string value identifying the name of third best command match.<!-- raw HTML omitted --> Alt2Confidence <!-- raw HTML omitted --> A Long integer identifying the confidence scoring for the third best command match.<!-- raw HTML omitted --> Alt2Voice <!-- raw HTML omitted --> A string value identifying the voice text for the third best command match.<!-- raw HTML omitted --> <a href="count-property.html"><strong>Count</strong></a> <!-- raw HTML omitted --> Long integer value indicating the number of alternatives returned.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<h3>Remarks</h3>
<p>The server notifies you with this event when your application is input-active and the user chooses a command by spoken input or character's pop-up menu. The event passes back the number of possible matching commands in <a href="count-property.html"><strong>Count</strong></a> as well as the name, confidence scoring, and voice text for those matches.</p>
<p>If voice input triggers this event, the server returns a string that identifies the best match in the <a href="name-property.html"><strong>Name</strong></a> parameter, and the second- and third-best match in Alt1Name and Alt2Name . An empty string indicates that the input did not match any command your application defined; for example, it could be one of the server's defined commands. If the command was matched to the Agent's command; for example, Hide, an empty string would be returned in the <strong>Name</strong> parameter, but you would still receive the text heard in the <a href="voice-property.html"><strong>Voice</strong></a> parameter.</p>
<p>You may get the same command name returned in more than one entry. <a href="confidence-property.html"><strong>Confidence</strong></a>, Alt1Confidence , and Alt2Confidence parameters return the relative scores, in the range of -100 to 100, that are returned by the speech recognition engine for each respective match. <a href="voice-property.html"><strong>Voice</strong></a>, Alt1Voice , and Alt2Voice parameters return the voice text that the speech recognition engine matched for each alternative. If <a href="count-property.html"><strong>Count</strong></a> returns zero (0), the server detected spoken input, but determined that there was no matching command.</p>
<p>If voice input was not the source for the command, for example, if the user selected the command from the character's pop-up menu, the server returns the name (ID) of the command selected in the <a href="name-property.html"><strong>Name</strong></a>property. It also returns the value of the <a href="confidence-property.html"><strong>Confidence</strong></a> parameter as 100, and the value of the <a href="voice-property.html"><strong>Voice</strong></a> parameters as the empty string (&quot;&quot;). Alt1Name and Alt2Name also return empty strings. Alt1Confidence and Alt2Confidence return zero (0), and Alt1Voice and Alt2Voice return empty strings. <a href="count-property.html"><strong>Count</strong></a> returns 1.</p>
<blockquote>
<p>[!Note]<br />
Not all speech recognition engines may return all the values for all the parameters of this event. Check with your engine vendor to determine whether the engine supports the Microsoft Speech API interface for returning alternatives and confidence scores.</p>
</blockquote>
</body>
