<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Replacing the Windows Picture and Fax Viewer Application Using the Preview Verb</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Replacing the Windows Picture and Fax Viewer Application Using the Preview Verb
description: As of WindowsÂ XP, users can view, rotate, print, and zoom images.
ms.assetid: cb08756b-6a5d-424d-ab6d-2e34d180ec4e
keywords:</p>
<ul>
<li>Windows Picture and Fax Viewer</li>
<li>Preview verb</li>
<li>best practices,Windows Picture and Fax Viewer</li>
<li>best practices,Preview verb</li>
<li>performance,Windows Picture and Fax Viewer</li>
<li>performance,Preview verb</li>
<li>register,Preview verb</li>
<li>register,Slideshow verb</li>
<li>Slideshow verb
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Replacing the Windows Picture and Fax Viewer Application Using the Preview Verb</h1>
<p>[The Picture and Fax Viewer feature is supported only under WindowsÂ XP. ]</p>
<p>As of WindowsÂ XP, users can view, rotate, print, and zoom images. Some of these features are provided through the Windows Shell, and others through the Windows Picture and Fax Viewer application. While Windows Picture and Fax Viewer provides an excellent baseline of features and is a key part of the imaging experience, if you choose to, you can easily replace it with a different application. This document is designed to help you effectively replace the Windows Picture and Fax Viewer application without losing important features or degrading the user experience.</p>
<ul>
<li><a href="#best-practices">Best Practices</a>
<ul>
<li><a href="#performance">Performance</a></li>
<li><a href="#features">Features</a></li>
<li><a href="#format-support">Format Support</a></li>
</ul>
</li>
<li><a href="#registering-for-the-preview-verb">Registering for the Preview Verb</a></li>
<li><a href="#registering-for-the-edit-verb">Registering for the Edit Verb</a></li>
<li><a href="#registering-for-the-slideshow-verb">Registering for the Slideshow Verb</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Best Practices</h2>
<p>In WindowsÂ XP and later, the Shell includes a verb that you can use to enable users to preview images. It is called <em>Preview</em>. This verb highlights the main user task for images, which is viewing. To make this experience work well, the Windows Picture and Fax Viewer application owns the preview association by default.</p>
<p>The Windows Picture and Fax Viewer, or any application that owns a file association, includes an item that launches the user's editing application. Because the Preview verb is only used to preview images rather than edit them, your application must be careful to follow the recommendations in this document when claiming that association.</p>
<p>You want to ensure that an application that edits images can still take over the Edit verb. For example, if a user has Microsoft Picture It! installed, when they double-click a .jpg file the computer should launch the Windows Picture and Fax Viewer application. But, when they click <strong>Edit</strong> in the toolbar, then the computer should launch Picture It! with that .jpg file.</p>
<p>There are three considerations you should take into account when you replace the Windows Picture and Fax Viewer. These are:</p>
<ul>
<li><a href="#performance">Performance</a></li>
<li><a href="#features">Features</a></li>
<li><a href="#format-support">Format Support</a></li>
</ul>
<h3>Performance</h3>
<p>The main consideration with performance is the speed at which images load. While no performance metric is provided here, you should attempt to replace Windows Picture and Fax Viewer with an application that matches or increases the performance.</p>
<p>The application itself should load quickly. One of the major issues users experience with applications that take over image associations is the wait time while the application loads. This often stems from having a powerful editing application load when they double-click an image file, even when the user simply wants to view the file. It is best for the user if you provide options that quickly take them to an application where they can edit the image only when that is their wish.</p>
<h3>Features</h3>
<p>There is a minimal set of features your application should provide when you replace the Windows Picture and Fax Viewer application. They are as follows:</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Show image at best fit</td>
<td>This gives the user the option to see the entire image scaled to the size where i best fits into the viewable space of the application window. In this way, they can see the entire image, even if it is slightly degraded by zooming out. This should be the default setting whenever an image loads that is larger than the viewable space. Otherwise, the image should appear in its actual size. For example, a 64 x 64 pixel image should not be scaled to a 600 x 600 size simply because that is the application's window size.</td>
</tr>
<tr>
<td>Show image at actual size</td>
<td>This gives the user the option to see the entire image at its actual resolution. This allows them to view it at its appropriate size and pan about the image. This should not be the default view unless the image is smaller than the viewable space in the application.</td>
</tr>
<tr>
<td>Zoom into image</td>
<td>This enables the user to zoom into a portion of the image to investigate finer details, or simply enlarge a small image. This is similar to showing the image actual size, but enables the user to control how closely they view the image.</td>
</tr>
<tr>
<td>Zoom out of image</td>
<td>This enables the user to zoom out and get a broader view. This is similar to showing the image at best fit, but enables the user to control how far back they view the image.</td>
</tr>
<tr>
<td>Next image</td>
<td>This enables the user to see the next image in the list. This list can be all the images in the current folder or all the images the user selects as part of a multiselect operation; that is, when he or she clicks and drags to highlight images or holds down the control button and clicks individual files.</td>
</tr>
<tr>
<td>Previous image</td>
<td>This enables the user to view the previous image in the list.</td>
</tr>
<tr>
<td>Rotate clockwise 90 degrees</td>
<td>This enables the user to rotate the image clockwise by quarters. WindowsÂ XP automatically saves the image when it rotates it to reduce the loss of image quality. The application can also rotate smaller increments, but 90 degrees is the standard as the most common rotation for digital pictures.</td>
</tr>
<tr>
<td>Rotate counterclockwise 90 degrees</td>
<td>This enables the user to rotate the image counterclockwise by quarters.</td>
</tr>
<tr>
<td>Print</td>
<td>This enables the user to print the image that currently appears.</td>
</tr>
<tr>
<td>Save As</td>
<td>This enables the user to save the image to a specified folder.</td>
</tr>
<tr>
<td>Delete image</td>
<td>This enables the user to delete the image.</td>
</tr>
<tr>
<td>Help</td>
<td>This provides the user with help documentation concerned with the use of the viewing application.</td>
</tr>
<tr>
<td>Properties</td>
<td>This enables the user to view or edit the properties of the image, typically the Exchangeable Image File (EXIF) information stored in each image.</td>
</tr>
<tr>
<td>Edit</td>
<td>This enables the user to launch their preferred editing program registered for the Edit verb on the image.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Format Support</h3>
<p>Because it is difficult for an application to support all different images, it is recommended that the application use Windows GDI+ to support image formats. However, if you choose not to use GDI+, your application should take over only those file associations for which it has been tested and is known to work. Then, if the user needs to view a format that you do not handle, Windows Picture and Fax Viewer can still provide access.</p>
<p>For example, Windows Picture and Fax Viewer provides a number of tools for editing annotations in .tiff images. Unless this functionality is duplicated in your application, you should not register your application to handle .tiff images. The driving principle should be to ensure that the user loses no functionality whatsoever.</p>
<h2>Registering for the Preview Verb</h2>
<p>Registering an application to handle the Preview verb is fairly simple. Locate the application's following value in the registry, where Application.Jpeg represents the name of the application's file association key (see <a href="/windows/desktop/shell/default-programs">Default Programs</a> for more details):</p>
<pre><code>HKEY_CLASSES_ROOT
Â Â Â Application.Jpeg
Â Â Â Â Â Â shell
Â Â Â Â Â Â Â Â Â open
Â Â Â Â Â Â Â Â Â Â Â Â command
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (Default) = app.exe %1
</code></pre>
<p>Change the name of the <strong>open</strong> subkey to &quot;preview&quot; as shown here.</p>
<pre><code>HKEY_CLASSES_ROOT
Â Â Â Application.Jpeg
Â Â Â Â Â Â shell
Â Â Â Â Â Â Â Â Â preview
Â Â Â Â Â Â Â Â Â Â Â Â command
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (Default) = app.exe %1
</code></pre>
<p>This registers the application and makes it the default application for the Preview verb for a .jpg file. The following is also required.</p>
<p><strong>HKEY_CLASSES_ROOT</strong>\<strong>.jpg</strong>(Default) = Application.Jpeg</p>
<h2>Registering for the Edit Verb</h2>
<p>This registers an application for the Edit Verb and makes it the new default application for editing an image. The registered application should take over the editing capability of the existing default application at the install time and install it back as the handler at the time of uninstall. This can be achieved by registering the new application lower in the association list than the default application. The default application is registered here:</p>
<pre><code>HKEY_CLASSES_ROOT
Â Â Â SystemFileAssociations
Â Â Â Â Â Â image
Â Â Â Â Â Â Â Â Â shell
Â Â Â Â Â Â Â Â Â Â Â Â edit
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â command
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (Default) = app.exe %1
</code></pre>
<p>New application should register here:</p>
<pre><code>HKEY_CLASSES_ROOT
Â Â Â Application.Jpeg
Â Â Â Â Â Â shell
Â Â Â Â Â Â Â Â Â edit
Â Â Â Â Â Â Â Â Â Â Â Â command
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (Default) = app.exe %1
</code></pre>
<h2>Registering for the Slideshow Verb</h2>
<p>As of WindowsÂ Vista, an application can also register the <strong>slideshow</strong> verb. Applications that implement a slide show can register to be invoked when the Slideshow verb is chosen. This registration is accomplished in exactly the same fashion as explained for the preview verb above. It is strongly recommended that applications implement the DropTarget form of the verb. In that way, they can be passed a complete set of items. The DropTarget implementation is registered as shown here:</p>
<pre><code>HKEY_CLASSES_ROOT
Â Â Â Application.Jpeg
Â Â Â Â Â Â shell
Â Â Â Â Â Â Â Â Â slideshow
Â Â Â Â Â Â Â Â Â Â Â Â DropTarget
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CLSID = {CLSID of the implementation}
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/shell/fa-intro">Introduction to File Associations</a></p>
<!-- raw HTML omitted -->
<p><a href="../gdiplus/-gdiplus-about-gdi--about.html">About GDI+</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
