<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Pop-up Menu Support</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Pop-up Menu Support
description: Pop-up Menu Support
ms.assetid: a8a1cf91-c18a-497f-89a7-b47536eaca0a
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Pop-up Menu Support</h1>
<p>[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.]</p>
<p>Microsoft Agent includes a pop-up menu (also known as a contextual menu) for each character. The server displays this pop-up menu automatically when a user right-clicks the character. You can add commands for your client application to the menu by defining a <a href="/windows/desktop/lwef/the-commands-collection-object"><strong>Commands</strong></a> collection. For each command in the collection that you define, you can specify <a href="caption-property.html"><strong>Caption</strong></a> and <a href="visible-property.html"><strong>Visible</strong></a> properties. The <strong>Caption</strong> is the text that appears in the menu when the <strong>Visible</strong> property is set to <strong>True</strong>. You can also use the <a href="enabled-property.html"><strong>Enabled</strong></a> property to display the command in the menu as disabled and the <a href="helpcontextid-property.html"><strong>HelpContextID</strong></a> to support Help support for the property. Define the access key for the menu text by including an ampersand (&amp;) before the text character of the <strong>Caption</strong> text setting.</p>
<p>The server automatically adds to the menu commands for opening the Voice Commands Window and hiding the character as well as the <a href="/windows/desktop/lwef/the-commands-collection-object"><strong>Commands</strong></a> captions of other clients of the character to enable users to switch between clients. The server automatically adds a separator to the menu between its menu entries and those defined by the client. Separators appear only when there are items in the menu to separate.</p>
<p>To remove commands from a menu, use the <a href="remove-method.html"><strong>Remove</strong></a> method. Note that menu entries do not change while the menu displays. If you add or remove commands or change their properties, the menu displays the changes when the user redisplays the menu.</p>
<p>If you prefer to provide your own pop-up menu services for a character, you can use the <a href="autopopupmenu-property.html"><strong>AutoPopupMenu</strong></a> property to turn off server handling of the right-click action. You can then use the <a href="click-event.html"><strong>Click</strong></a> event notification to create your own menu handling behavior.</p>
<p>When the user selects a command from a character's pop-up menu or the Voice Commands Window, the server triggers the <a href="command-event.html"><strong>Command</strong></a> event of the associated client and passes back the parameters of the input using the <a href="/windows/desktop/lwef/iagentuserinput"><strong>UserInput</strong></a> object.</p>
<p>The server also provides a pop-up menu for the character's taskbar icon. When the character is visible, right-clicking this menu displays the same commands as those displayed by right-clicking the character. However, when the character is hidden, only the server-supplied commands are included.</p>
<p>Â </p>
<p>Â </p>
</body>
