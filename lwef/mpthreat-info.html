<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MPTHREAT_INFO structure</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MPTHREAT_INFO structure (MpClient.h)
description: Contains information about a threat.
ms.assetid: ED2A0BDB-0E7C-479D-ADA1-95B9A259F57E
keywords:</p>
<ul>
<li>MPTHREAT_INFO structure Legacy Windows Environment Features</li>
<li>PMPTHREAT_INFO structure pointer Legacy Windows Environment Features
topic_type:</li>
<li>apiref
api_name:</li>
<li>MPTHREAT_INFO
api_location:</li>
<li>MpClient.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MPTHREAT_INFO structure</h1>
<p>Contains information about a threat.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>typedef struct tagMPTHREAT_INFO {
  MPTHREAT_ID           ThreatID;
  GUID                  DetectionID;
  MP_MIDL_STRING LPWSTR Name;
  MPTHREAT_TYPE         ThreatType;
  MPTHREAT_SEVERITY     ThreatCriticality;
  MPTHREAT_CATEGORY     ThreatCategory;
  DWORD                 ThreatShortDescriptionID;
  DWORD                 ThreatAdviseDescriptionID;
  MPTHREAT_STATUS       ThreatStatus;
  DWORD                 SuggestedActionCount;
  MPTHREAT_ACTION       SuggestedActionArray[MP_MAX_SUGGESTIONS];
  DWORD                 ResourceCount;
  PMPRESOURCE_INFO      *ResourceList[ResourceCount];
  ULARGE_INTEGER        ThreatStatusTime;
  HRESULT               ThreatStatusCode;
  MPTHREAT_DETECTION    ThreatDetection;
  GUID                  QuarantineGuid;
  MPEXECUTION_STATUS    ExecutionStatus;
  union {
    PMPTHREAT_INFOEX_UNUSED   pKnownBad;
    PMPTHREAT_INFOEX_BEHAVIOR pBehavior;
    PMPTHREAT_INFOEX_UNUSED   pUnknown;
    PMPTHREAT_INFOEX_UNUSED   pKnownGood;
    PMPTHREAT_INFOEX_NIS      pNis;
  } Data;
  MPDETECTION_STATE     State;
  MP_MIDL_STRING LPWSTR DetectionUser;
  MPSOURCE              DetectionSource;
  MP_MIDL_STRING LPWSTR ProcessName;
  MPDETECTION_ORIGIN    DetectionOrigin;
  DWORD                 reserved1;
  ULARGE_INTEGER        DetectionTime;
  MPEXECUTION_STATUS    PreExecutionStatus;
  ULARGE_INTEGER        RemediationTime;
  MPEXECUTION_STATUS    PostExecutionStatus;
  BOOL                  CriticalFailure;
  DWORD                 NonCriticalReason;
  MP_MIDL_STRING LPWSTR RemediationUser;
  DWORD                 RemediationResourceCount;
  PMPRESOURCE_INFO      RemediationResourceList[RemediationResourceCount];
  BOOL                  FailureResolved;
  MPRESOLVED_REASON     ResolvedReason;
  DWORD                 AdditionalActions;
  DWORD                 ResolvedActions;
  DWORD                 dwThreatStatusFlag;
} MPTHREAT_INFO, *PMPTHREAT_INFO;
</code></pre>
<h2>Members</h2>
<!-- raw HTML omitted -->
<p><strong>ThreatID</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>MPTHREAT_ID</strong></p>
<!-- raw HTML omitted -->
<p>Threat identifier. Upper bit is set to identify antivirus-related threats.</p>
<!-- raw HTML omitted -->
<p><strong>DetectionID</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>GUID</strong></p>
<!-- raw HTML omitted -->
<p>Detection ID.</p>
<!-- raw HTML omitted -->
<p><strong>Name</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>MP_MIDL_STRING LPWSTR</strong></p>
<!-- raw HTML omitted -->
<p>Threat name.</p>
<!-- raw HTML omitted -->
<p><strong>ThreatType</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpthreat-type.html"><strong>MPTHREAT_TYPE</strong></a></strong></p>
<!-- raw HTML omitted -->
<p>Threat type. Used to differentiate among different threat types such as known bad, unknown, or known good. See <a href="mpthreat-type.html"><strong>MPTHREAT_TYPE</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>ThreatCriticality</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpthreat-severity.html"><strong>MPTHREAT_SEVERITY</strong></a></strong></p>
<!-- raw HTML omitted -->
<p>Threat criticality. See <a href="mpthreat-severity.html"><strong>MPTHREAT_SEVERITY</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>ThreatCategory</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpthreat-category.html"><strong>MPTHREAT_CATEGORY</strong></a></strong></p>
<!-- raw HTML omitted -->
<p>Threat category, such as a trojan or a keylogger. See <a href="mpthreat-category.html"><strong>MPTHREAT_CATEGORY</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>ThreatShortDescriptionID</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<!-- raw HTML omitted -->
<p>Threat short description ID.</p>
<!-- raw HTML omitted -->
<p><strong>ThreatAdviseDescriptionID</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<!-- raw HTML omitted -->
<p>Threat advise description ID.</p>
<!-- raw HTML omitted -->
<p><strong>ThreatStatus</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpthreat-status.html"><strong>MPTHREAT_STATUS</strong></a></strong></p>
<!-- raw HTML omitted -->
<p>Threat status such as detected, cleaned, or quarantined. See <a href="mpthreat-status.html"><strong>MPTHREAT_STATUS</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>SuggestedActionCount</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<!-- raw HTML omitted -->
<p>Count of suggested actions in <strong>SuggestedActionArray</strong>.</p>
<!-- raw HTML omitted -->
<p><strong>SuggestedActionArray</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpthreat-action.html"><strong>MPTHREAT_ACTION</strong></a>[MP_MAX_SUGGESTIONS]</strong></p>
<!-- raw HTML omitted -->
<p>Array of suggested actions. See <a href="mpthreat-action.html"><strong>MPTHREAT_ACTION</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>ResourceCount</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<!-- raw HTML omitted -->
<p>Count of resources in <strong>ResourceList</strong>.</p>
<!-- raw HTML omitted -->
<p><strong>ResourceList</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>PMPRESOURCE_INFO*</strong></p>
<!-- raw HTML omitted -->
<p>List of resources identified with the threat. See <a href="mpresource-info.html"><strong>MPRESOURCE_INFO</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>ThreatStatusTime</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>ULARGE_INTEGER</strong></p>
<!-- raw HTML omitted -->
<p>Time when threat status last changed.</p>
<!-- raw HTML omitted -->
<p><strong>ThreatStatusCode</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>HRESULT</strong></p>
<!-- raw HTML omitted -->
<p>Status code associated with the threat status.</p>
<!-- raw HTML omitted -->
<p><strong>ThreatDetection</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpthreat-detection.html"><strong>MPTHREAT_DETECTION</strong></a></strong></p>
<!-- raw HTML omitted -->
<p>Threat detection type, such as concrete, suspicious, or generic. See <a href="mpthreat-detection.html"><strong>MPTHREAT_DETECTION</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>QuarantineGuid</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>GUID</strong></p>
<!-- raw HTML omitted -->
<p>Quarantine guid.</p>
<!-- raw HTML omitted -->
<p><strong>ExecutionStatus</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpexecution-status.html"><strong>MPEXECUTION_STATUS</strong></a></strong></p>
<!-- raw HTML omitted -->
<p>Execution status of the threat, such as not known, blocked, or active. See <a href="mpexecution-status.html"><strong>MPEXECUTION_STATUS</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>Data</strong></p>
<!-- raw HTML omitted -->
<p>Extra information. The pointer to the appropriate structure depends on the value of <strong>ThreatType</strong>.</p>
<!-- raw HTML omitted -->
<p><strong>pKnownBad</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>PMPTHREAT_INFOEX_UNUSED</strong></p>
<!-- raw HTML omitted -->
<p>When <strong>ThreatType</strong> == <strong>MPTHREAT_TYPE_KNOWNBAD</strong>. See <a href="mpthreat-infoex-unused.html"><strong>MPTHREAT_INFOEX_UNUSED</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>pBehavior</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>PMPTHREAT_INFOEX_BEHAVIOR</strong></p>
<!-- raw HTML omitted -->
<p>When <strong>ThreatType</strong> == <strong>MPTHREAT_TYPE_BEHAVIOR</strong>. See <a href="mpthreat-infoex-behavior.html"><strong>MPTHREAT_INFOEX_BEHAVIOR</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>pUnknown</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>PMPTHREAT_INFOEX_UNUSED</strong></p>
<!-- raw HTML omitted -->
<p>When <strong>ThreatType</strong> == <strong>MPTHREAT_TYPE_UNKNOWN</strong>. See <a href="mpthreat-infoex-unused.html"><strong>MPTHREAT_INFOEX_UNUSED</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>pKnownGood</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>PMPTHREAT_INFOEX_UNUSED</strong></p>
<!-- raw HTML omitted -->
<p>When <strong>ThreatType</strong> == MPTHREAT_TYPE_KNOWNGOOD. See <a href="mpthreat-infoex-unused.html"><strong>MPTHREAT_INFOEX_UNUSED</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>pNis</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>PMPTHREAT_INFOEX_NIS</strong></p>
<!-- raw HTML omitted -->
<p>When <strong>ThreatType</strong> == <strong>MPTHREAT_TYPE_NIS</strong>. See <a href="mpthreat-infoex-nis.html"><strong>MPTHREAT_INFOEX_NIS</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>State</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpdetection-state.html"><strong>MPDETECTION_STATE</strong></a></strong></p>
<!-- raw HTML omitted -->
<p>The current state of the detection. See <a href="mpdetection-state.html"><strong>MPDETECTION_STATE</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>DetectionUser</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>MP_MIDL_STRING LPWSTR</strong></p>
<!-- raw HTML omitted -->
<p>The user associated with the detection, in the format &quot;domain/user&quot;.</p>
<!-- raw HTML omitted -->
<p><strong>DetectionSource</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpsource.html"><strong>MPSOURCE</strong></a></strong></p>
<!-- raw HTML omitted -->
<p>The source of the detection. See <a href="mpsource.html"><strong>MPSOURCE</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>ProcessName</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>MP_MIDL_STRING LPWSTR</strong></p>
<!-- raw HTML omitted -->
<p>Process name associated with the detection.</p>
<!-- raw HTML omitted -->
<p><strong>DetectionOrigin</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpdetection-origin.html"><strong>MPDETECTION_ORIGIN</strong></a></strong></p>
<!-- raw HTML omitted -->
<p>The origin of the detection, such as local or network. See <a href="mpdetection-origin.html"><strong>MPDETECTION_ORIGIN</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>reserved1</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<!-- raw HTML omitted -->
<p>Reserved metadata about the detection.</p>
<!-- raw HTML omitted -->
<p><strong>DetectionTime</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>ULARGE_INTEGER</strong></p>
<!-- raw HTML omitted -->
<p>The time of the initial detection.</p>
<!-- raw HTML omitted -->
<p><strong>PreExecutionStatus</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpexecution-status.html"><strong>MPEXECUTION_STATUS</strong></a></strong></p>
<!-- raw HTML omitted -->
<p>Execution status right before remediation. See <a href="mpexecution-status.html"><strong>MPEXECUTION_STATUS</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>RemediationTime</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>ULARGE_INTEGER</strong></p>
<!-- raw HTML omitted -->
<p>The time remediation occured.</p>
<!-- raw HTML omitted -->
<p><strong>PostExecutionStatus</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpexecution-status.html"><strong>MPEXECUTION_STATUS</strong></a></strong></p>
<!-- raw HTML omitted -->
<p>Execution status after remediation. See <a href="mpexecution-status.html"><strong>MPEXECUTION_STATUS</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>CriticalFailure</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>BOOL</strong></p>
<!-- raw HTML omitted -->
<p>True if the remediation failure was critical.</p>
<!-- raw HTML omitted -->
<p><strong>NonCriticalReason</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<!-- raw HTML omitted -->
<p>The reason the remediation failure is not critical. This is not guaranteed to be supported in the future.</p>
<!-- raw HTML omitted -->
<p><strong>RemediationUser</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>MP_MIDL_STRING LPWSTR</strong></p>
<!-- raw HTML omitted -->
<p>User that requested the remediation, in the format &quot;domain/user&quot;.</p>
<!-- raw HTML omitted -->
<p><strong>RemediationResourceCount</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<!-- raw HTML omitted -->
<p>Count of resources in <strong>RemediationResourceList</strong>.</p>
<!-- raw HTML omitted -->
<p><strong>RemediationResourceList</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>PMPRESOURCE_INFO[RemediationResourceCount]</strong></p>
<!-- raw HTML omitted -->
<p>List of resources that failed during remediation. See <a href="mpresource-info.html"><strong>MPRESOURCE_INFO</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>FailureResolved</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>BOOL</strong></p>
<!-- raw HTML omitted -->
<p>True if remediation failure been resolved. This will move the bucket to either complete or an additional action.</p>
<!-- raw HTML omitted -->
<p><strong>ResolvedReason</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpresolved-reason.html"><strong>MPRESOLVED_REASON</strong></a></strong></p>
<!-- raw HTML omitted -->
<p>Reason for remediation failure being resolved. This is the reason the detection moved from failed to additional action or finished. See <a href="mpresolved-reason.html"><strong>MPRESOLVED_REASON</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>AdditionalActions</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<!-- raw HTML omitted -->
<p>Are additional actions required.</p>
<!-- raw HTML omitted -->
<p><strong>ResolvedActions</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<!-- raw HTML omitted -->
<p>Any additional actions that have been performed.</p>
<!-- raw HTML omitted -->
<p><strong>dwThreatStatusFlag</strong></p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<!-- raw HTML omitted -->
<p>Additonal information about the threat detection.</p>
<!-- raw HTML omitted -->
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 8 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->MpClient.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="mpfreememory.html"><strong>MpFreeMemory</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpthreatenumerate.html"><strong>MpThreatEnumerate</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpthreatquery.html"><strong>MpThreatQuery</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpdetection-origin.html"><strong>MPDETECTION_ORIGIN</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpdetection-state.html"><strong>MPDETECTION_STATE</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpexecution-status.html"><strong>MPEXECUTION_STATUS</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpresolved-reason.html"><strong>MPRESOLVED_REASON</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpresource-info.html"><strong>MPRESOURCE_INFO</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpsource.html"><strong>MPSOURCE</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpthreat-action.html"><strong>MPTHREAT_ACTION</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpthreat-category.html"><strong>MPTHREAT_CATEGORY</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpthreat-detection.html"><strong>MPTHREAT_DETECTION</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpthreat-infoex-behavior.html"><strong>MPTHREAT_INFOEX_BEHAVIOR</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpthreat-infoex-nis.html"><strong>MPTHREAT_INFOEX_NIS</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpthreat-infoex-unused.html"><strong>MPTHREAT_INFOEX_UNUSED</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpthreat-severity.html"><strong>MPTHREAT_SEVERITY</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpthreat-status.html"><strong>MPTHREAT_STATUS</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpthreat-type.html"><strong>MPTHREAT_TYPE</strong></a></p>
<!-- raw HTML omitted -->
</body>
