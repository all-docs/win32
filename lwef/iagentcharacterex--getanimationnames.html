<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IAgentCharacterEx::GetAnimationNames</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: IAgentCharacterEx GetAnimationNames
description: IAgentCharacterEx GetAnimationNames
ms.assetid: d565b258-dc12-422b-a13d-aeec56057f64
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>IAgentCharacterEx::GetAnimationNames</h1>
<p>[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.]</p>
<pre lang="syntax"><code>HRESULT GetAnimationNames(
   IUnknown ** punkEnum // address of IUnknown interface
);
</code></pre>
<p>Retrieves the animation names for a character.</p>
<ul>
<li>Returns <strong>S_OK</strong> to indicate the operation was successful.</li>
</ul>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>IUnknown</em></p>
<!-- raw HTML omitted -->
<p>The address of the <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> interface for the character's animation collection.</p>
<!-- raw HTML omitted -->
<p>This function enables you to enumerate the names of the animations for a character. Items in the collection have no properties, so individual items cannot be accessed directly. To access the collection, query punkEnum for the IEnumVARIANT interface:</p>
<pre lang="c++"><code>IEnumVARIANT pEnum;
VARIANT vAnimName;
DWORD dwRetrieved;

hRes = punkEnum-&gt;QueryInterface(IID_IEnumVARIANT, (LPVOID *)&amp;pEnum);

if (SUCCEEDED(hRes)) {

    while (TRUE) {

         hRes = pEnum-&gt;Next(1, &amp;vAnimName, &amp;dwRetrieved);

         if (hRes != NOERROR)
            break;

         // vAnimName.bstrVal is the animation name

         VariantClear(&amp;vAnimName);
    } 

    pEnum-&gt;Release();
}

punkEnum-&gt;Release();
</code></pre>
<blockquote>
<p>[!Note]<br />
For ACF characters, the collection returns all the animations that have been defined for the character, adding to the ones that have been retrieved with the <a href="https://www.bing.com/search?q=**Get**"><strong>Get</strong></a> method.</p>
</blockquote>
</body>
