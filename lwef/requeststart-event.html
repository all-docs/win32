<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>RequestStart Event</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: RequestStart Event
description: RequestStart Event
ms.assetid: ecfb9691-cbc4-48f5-8e26-a99389e85eed
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>RequestStart Event</h1>
<p>[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.]</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Description</strong></p>
<!-- raw HTML omitted -->
<p>Occurs when the server begins a queued request.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Syntax</strong></p>
<!-- raw HTML omitted -->
<p><strong>Sub</strong> <em>agent</em>**_RequestStart** <strong>(ByVal</strong> <em>Request</em>**)**</p>
<table>
<thead>
<tr>
<th>Part</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Request</em></td>
<td>Returns the <a href="/windows/desktop/lwef/the-request-object"><strong>Request</strong></a> object.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h3>Remarks</h3>
<p>The event returns a <a href="/windows/desktop/lwef/the-request-object"><strong>Request</strong></a> object. Because requests are processed asynchronously, you can use this event to determine when the server begins processing a request (such as a <a href="get-method.html"><strong>Get</strong></a>, <a href="play-method.html"><strong>Play</strong></a>, or <a href="speak-method.html"><strong>Speak</strong></a> method) and thereby synchronize this with other actions generated by your application. The event is sent only to the client that created the reference to the <strong>Request</strong> object and only if you defined a global variable for the request reference:</p>
<pre><code>   Dim MyRequest 
   Dim Genie 

   Sub window_Onload
   
   Agent1.Characters.Load &quot;Genie&quot;, _
      &quot;https://agent.microsoft.com/characters/v2/genie/genie.acf&quot;   

   Set Genie = Agent1.Characters(&quot;Genie&quot;)

   ' This syntax will generate RequestStart and RequestComplete events.
   Set MyRequest = Genie.Get(&quot;state&quot;, &quot;Showing&quot;)

   ' This syntax will not generate RequestStart and RequestComplete events.
   Genie.Get (&quot;state&quot;, &quot;Hiding&quot;)

   End Sub

   Sub Agent1_RequestStart(ByVal Request)

   If Request = MyRequest Then
      Status = &quot;Loading the Showing animation&quot;

   End Sub
</code></pre>
<p>The <a href="status-property.html"><strong>Status</strong></a> returns 4 (request in progress) for the <a href="/windows/desktop/lwef/the-request-object"><strong>Request</strong></a> object returned.</p>
<p>Because animation <a href="/windows/desktop/lwef/the-request-object"><strong>Request</strong></a> objects don't get assigned until the server processes the request, make sure that the <strong>Request</strong> object exists before you attempt to evaluate it. For example, in Visual Basic, if you use a conditional to test whether a specific request was completed, you can use the <strong>Nothing</strong> keyword:</p>
<pre><code>   Sub Agent1_RequestStart (ByVal Request)

   If Not (MyRequest Is Nothing) Then
      If Request = MyRequest Then
      '-- Do whatever
      End If
   End If

   End Sub
</code></pre>
<blockquote>
<p>[!Note]<br />
In VBScript 1.0, this event fires even if you don't define references to a <a href="/windows/desktop/lwef/the-request-object"><strong>Request</strong></a> object. This has been fixed in VBScript 2.0.</p>
</blockquote>
<p>Â </p>
<h3>See Also</h3>
<p><a href="requestcomplete-event.html"><strong>RequestComplete event</strong></a></p>
<p>Â </p>
<p>Â </p>
</body>
