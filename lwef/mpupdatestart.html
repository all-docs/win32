<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MpUpdateStart function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MpUpdateStart function (MpClient.h)
description: Starts a signature update operation.
ms.assetid: BB056356-17E5-42F0-9636-9E1C254361E4
keywords:</p>
<ul>
<li>MpUpdateStart function Legacy Windows Environment Features
topic_type:</li>
<li>apiref
api_name:</li>
<li>MpUpdateStart
api_location:</li>
<li>MpClient.dll
api_type:</li>
<li>DllExport
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MpUpdateStart function</h1>
<p>Starts a signature update operation.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT WINAPI MpUpdateStart(
  _In_     MPHANDLE         hMpHandle,
  _In_     DWORD            dwUpdateOptions,
  _In_opt_ PMPCALLBACK_INFO pCallbackInfo,
  _Out_    PMPHANDLE        phUpdateHandle
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hMpHandle</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>MPHANDLE</strong></p>
<p>Handle to the malware protection manager interface. This handle is returned by the <a href="mpmanageropen.html"><strong>MpManagerOpen</strong></a> function.</p>
<!-- raw HTML omitted -->
<p><em>dwUpdateOptions</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<p>Specifies the option for the signature update operation. It can be one of the following values:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPUPDATE_OPTION_NONE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>No specific option is requested.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPUPDATE_OPTION_ASYNC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The update operation is to be asynchronous, where <strong>MpUpdateStart</strong> returns immediately after the successful initiation of the signature update. (By default the update operation is synchronous, meaning <strong>MpUpdateStart</strong> will return only after the signature update is finished.)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPUPDATE_OPTION_PROGRESS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The caller is interested in receiving signature update progress information via a callback.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPUPDATE_OPTION_HTTP</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The signature update is performed by downloading the full signature package from the Microsoft security portal site. This can be used as a fallback option if the client is experiencing a signature download problem via Microsoft Update.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPUPDATE_OPTION_UNC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Performs signature update using direct download from UNC shares.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPUPDATE_OPTION_MANAGED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Performs signature update using the Managed Service WSUS.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPUPDATE_OPTION_UNMANAGED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Performs signature update using the Unmanaged Service MU/WU.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>pCallbackInfo</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>PMPCALLBACK_INFO</strong></p>
<p>A pointer to the callback information used to feed the client with signature update state changes (such as start and complete) and progress information. The <a href="mpcallback-data.html"><strong>MPCALLBACK_DATA</strong></a> passed back in the callback function reports actual update state and progress-related information. The following is a list of possible callbacks:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SIGUPDATE_START</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Update operation started.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SIGUPDATE_COMPLETE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Update operation completed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SIGUPDATE_SEARCH_START</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Search for updates started.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SIGUPDATE_SEARCH_COMPLETE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Search for updates completed. Additional information is available via <a href="mpsigupdate-data.html"><strong>MPSIGUPDATE_DATA</strong></a> structure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SIGUPDATE_DOWNLOAD_START</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Download for update started.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SIGUPDATE_DOWNLOAD_PROGRESS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Download progress information. Additional information is available via <a href="mpsigupdate-data.html"><strong>MPSIGUPDATE_DATA</strong></a> structure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SIGUPDATE_DOWNLOAD_COMPLETE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Download for update complete. Additional information is available via <a href="mpsigupdate-data.html"><strong>MPSIGUPDATE_DATA</strong></a> structure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SIGUPDATE_INSTALL_START</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Installation of update started.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SIGUPDATE_INSTALL_PROGRESS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Installation progress information. Additional information is available via <a href="mpsigupdate-data.html"><strong>MPSIGUPDATE_DATA</strong></a> structure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SIGUPDATE_INSTALL_COMPLETE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Installation of update completed. Additional information is available via <a href="mpsigupdate-data.html"><strong>MPSIGUPDATE_DATA</strong></a> structure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SIGUPDATE_REQUEST_PROCESSED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The antimalware service processed a signature update request. Failure or success is indicated by <em>hResult</em> in <a href="mpcallback-data.html"><strong>MPCALLBACK_DATA</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SIGUPDATE_REBOOT_REQUIRED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Requires reboot to complete the update operation. Failure or success is indicated by <em>hResult</em> in <a href="mpcallback-data.html"><strong>MPCALLBACK_DATA</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_INTERNAL_FAILURE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Signature update operation has encountered a generic failure. The <em>hResult</em> in <a href="mpcallback-data.html"><strong>MPCALLBACK_DATA</strong></a> has the specific error code.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>phUpdateHandle</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>PMPHANDLE</strong></p>
<p>Returned update handle which identifies the currently initiated signature update operation. This handle can be used in subsequent function calls, such as to control the signature update operation. The handle must be closed with the <a href="mphandleclose.html"><strong>MpHandleClose</strong></a> function.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>HRESULT</strong></p>
<p>If the function succeeds the return value is <strong>S_OK</strong>.</p>
<p>If the function fails then the return value is a failed <strong>HRESULT</strong> code. The caller can use the <a href="mperrormessageformat.html"><strong>MpErrorMessageFormat</strong></a> function to get a generic description of the error message.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 8 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->MpClient.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->MpClient.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="mperrormessageformat.html"><strong>MpErrorMessageFormat</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mphandleclose.html"><strong>MpHandleClose</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpmanageropen.html"><strong>MpManagerOpen</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpcallback-data.html"><strong>MPCALLBACK_DATA</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpsigupdate-data.html"><strong>MPSIGUPDATE_DATA</strong></a></p>
<!-- raw HTML omitted -->
</body>
