<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Calling WDS from Web Pages</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Calling WDS from Web Pages
description: You can call MicrosoftÂ Windows Desktop Search (WDS) from any webpage you create or maintain using the Browser Helper Object (BHO) and Windows Internet Explorer.
ms.assetid: 8d9fa541-530e-4917-a6d9-4e04549ce32e
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Calling WDS from Web Pages</h1>
<blockquote>
<p>[!NOTE]
Windows Desktop Search 2.x is an obsolete technology that was originally available as an add-in for WindowsÂ XP and Windows Server 2003. On later releases, use <a href="../search/-search-3x-wds-overview.html">Windows Search</a> instead.</p>
</blockquote>
<p>You can call MicrosoftÂ Windows Desktop Search (WDS) from any webpage you create or maintain using the Browser Helper Object (BHO) and Windows Internet Explorer. You can see how this works on the MSN webpage. Above the search box on <a href="https://www.msn.com">https://www.msn.com</a> are several search types: Web, News, Images, Desktop, Encarta, and Local. If you click Desktop, the search parameters are passed to Windows Desktop Search, which searches the catalog and displays results in the WDS user interface. For users to start a desktop search from your webpage(s), the WDSBHO must be installed and enabled on their systems, your webpage(s) must be registered with WDS as an allowed URL, and you must create a link to pass the user-enetered query to WDS.</p>
<h2>Enabling the WDS Browser Help Object</h2>
<p>The BHO is installed and enabled within Internet Explorer by default when you install WDS, but you can easily verify that it hasn't been disabled or uninstalled. On a user's system, open Internet ExplorerÂ , select <strong>Internet Options</strong> from the <strong>Tools</strong> menu, click the <strong>Programs</strong> tab, and then click <strong>Manage Add-Ons</strong>. In your list of add-ons, look for the dsWebAllowBHO Class and make sure it is enabled. When the BHO is disabled, WDS will continue to work normally; however, you will not be able to search the desktop from a webpage.</p>
<p>Both of the following options for allowing a desktop search will execute the search locally with the registered search application.</p>
<h2>Registering Web Page URLs</h2>
<p>The Registry includes a list of &quot;allowed&quot; domain URLs from which WDS can be called. To include your webpage(s), you need to list your domain URL(s) as REG_SZ in the Registry as follows:</p>
<p><strong>HKEY_LOCAL_MACHINE</strong>\<strong>Software</strong>\<strong>Microsoft</strong>\<strong>Windows Desktop Search</strong>\<strong>DSW</strong>\<strong>Allowed</strong>\<em>&lt;number&gt;</em> = &lt;domainURL&gt;</p>
<p>Where <strong>&lt;number&gt;</strong> is sequentially numbered, and <strong>&lt;domainURL&gt;</strong> is the URL of the Web Page you want to allow WDS searches from. This URL string can include the wildcard asterisk * at the beginning or end of the URL. For example, if the string is &quot;*.mydomain.com&quot;, then you can start a WDS search from both <a href="https://www.mydomain.com">https://www.mydomain.com</a> and <a href="https://mydomain.com">https://mydomain.com</a>.</p>
<h2>Enabling Desktop Search by URL</h2>
<p>Another option that does not require access to the Registry is to use the following URL on your webpage(s):</p>
<p><code>https://toolbar.msn.com/desktop/results.aspx?q=QUERY</code></p>
<p>where <strong>QUERY</strong> is the URL-encoded string the user is searching on, including any <a href="-search-2x-wds-aqsreference.html">Advanced Query Syntax</a> terms.</p>
<p>Â </p>
<p>Â </p>
</body>
