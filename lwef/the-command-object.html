<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>The Command Object</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: The Command Object
description: The Command Object
ms.assetid: a757846a-c2d0-4239-9533-babf5dc8399f
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>The Command Object</h1>
<p>[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.]</p>
<p>A <a href="/windows/desktop/lwef/the-command-object"><strong>Command</strong></a> object is an item in a <a href="/windows/desktop/lwef/the-commands-collection-object"><strong>Commands</strong></a> collection. The server provides the user access to your <strong>Command</strong> objects when your client application becomes input-active.</p>
<ul>
<li><a href="command-object-properties.html">Command Object Properties</a></li>
</ul>
<p>To access the property of a <a href="/windows/desktop/lwef/the-command-object"><strong>Command</strong></a> object, you reference it in its collection using its <a href="name-property.html"><strong>Name</strong></a> property. In VBScript and Visual Basic you can use the <strong>Name</strong> property directly:</p>
<pre><code>   &lt;i&gt;agent&lt;/i&gt;.Characters(&quot;&lt;i&gt;CharacterID&lt;/i&gt;&quot;).Commands(&quot;&lt;i&gt;Name&lt;/i&gt;&quot;).&lt;i&gt;property&lt;/i&gt; [= &lt;i&gt;value&lt;/i&gt;]
</code></pre>
<p>For programming languages that don't support collections, use the <a href="command-method.html"><strong>Command</strong></a> method:</p>
<pre><code>   &lt;i&gt;agent&lt;/i&gt;.Characters(&quot;&lt;i&gt;CharacterID&lt;/i&gt;&quot;).Commands.Command(&quot;&lt;i&gt;Name&lt;/i&gt;&quot;).&lt;i&gt;property&lt;/i&gt; [= &lt;i&gt;value&lt;/i&gt;]
</code></pre>
<p>You can also reference a Command object by creating a reference to it. In Visual Basic, declare an object variable and use the Set statement to create the reference:</p>
<pre><code>   Dim Cmd1 as Object
   ...
   Set Cmd1 = Agent.Characters(&quot;MyCharacterID&quot;).Commands(&quot;SampleCommand&quot;)
   ...
   Cmd1.Enabled = True
</code></pre>
<p>In Visual Basic 5.0, you can also declare the object as type <a href="https://www.bing.com/search?q=**IAgentCtlCommandEx**"><strong>IAgentCtlCommandEx</strong></a> and create the reference. This convention enables early binding, which results in better performance:</p>
<pre><code>   Dim Cmd1 as IAgentCtlCommandEx
   ...
   Set Cmd1 = Agent.Characters(&quot;MyCharacterID&quot;).Commands(&quot;SampleCommand&quot;)
   ...
   Cmd1.Enabled = True
</code></pre>
<p>In VBScript, you can declare a reference as a particular type, but you can still declare the variable and set it to the <a href="/windows/desktop/lwef/the-command-object"><strong>Command</strong></a> in the collection:</p>
<pre><code>   Dim Cmd1
   ...
   Set Cmd1 = Agent.Characters(&quot;MyCharacterID&quot;).Commands(&quot;SampleCommand&quot;)
   ...
   Cmd1.Enabled = True
</code></pre>
<p>A command may appear in either the character's pop-up menu and the Commands Window, or in both. To appear in the pop-up menu it must have a caption and have the <a href="visible-property.html"><strong>Visible</strong></a> property set to <strong>True</strong>. In addition, its Commands collection object <strong>Visible</strong> property must also be set to <strong>True</strong>. To appear in the Commands Window, a <a href="/windows/desktop/lwef/the-command-object"><strong>Command</strong></a> must have its <a href="caption-property.html"><strong>Caption</strong></a> and <a href="voice-property.html"><strong>Voice</strong></a> properties set. Note that a character's pop-up menu entries do not change while the menu displays. If you add or remove commands or change their properties while the character's pop-up menu is displayed, the menu displays those changes whenever the user next displays it. However, the Commands Window dynamically reflects any changes you make.</p>
<p>The following table summarizes how the properties of a <a href="/windows/desktop/lwef/the-command-object"><strong>Command</strong></a> affect its presentation:</p>
<p>Caption Property</p>
<p>Voice-Caption Property</p>
<p>Voice Property</p>
<p>Visible Property</p>
<p>Enabled Property</p>
<p>Appears in Character's Pop-up Menu</p>
<p>Appears in Commands Window</p>
<p>Yes</p>
<p>Yes</p>
<p>Yes</p>
<p>True</p>
<p>True</p>
<p>Normal, using <a href="caption-property.html"><strong>Caption</strong></a></p>
<p>Yes, using <a href="voicecaption-property.html"><strong>VoiceCaption</strong></a></p>
<p>Yes</p>
<p>Yes</p>
<p>Yes</p>
<p>True</p>
<p>False</p>
<p>Disabled, using <a href="caption-property.html"><strong>Caption</strong></a></p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>Yes</p>
<p>False</p>
<p>True</p>
<p>Does not appear</p>
<p>Yes, using <a href="voicecaption-property.html"><strong>VoiceCaption</strong></a></p>
<p>Yes</p>
<p>Yes</p>
<p>Yes</p>
<p>False</p>
<p>False</p>
<p>Does not appear</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>No</p>
<p>True</p>
<p>True</p>
<p>Normal, using <a href="caption-property.html"><strong>Caption</strong></a></p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>No</p>
<p>True</p>
<p>False</p>
<p>Disabled, using <a href="caption-property.html"><strong>Caption</strong></a></p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>No</p>
<p>False</p>
<p>True</p>
<p>Does not appear</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>No</p>
<p>False</p>
<p>False</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>True</p>
<p>True</p>
<p>Does not appear</p>
<p>Yes, using <a href="voicecaption-property.html"><strong>VoiceCaption</strong></a></p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>True</p>
<p>False</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>False</p>
<p>True</p>
<p>Does not appear</p>
<p>Yes, using <a href="voicecaption-property.html"><strong>VoiceCaption</strong></a></p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>False</p>
<p>False</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>No</p>
<p>True</p>
<p>True</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>No</p>
<p>True</p>
<p>False</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>No</p>
<p>False</p>
<p>True</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>No</p>
<p>False</p>
<p>False</p>
<p>Does not appear</p>
<p>No</p>
<p>Yes</p>
<p>No</p>
<p>Yes</p>
<p>True</p>
<p>True</p>
<p>Normal, using <a href="caption-property.html"><strong>Caption</strong></a></p>
<p>Yes, using <a href="caption-property.html"><strong>Caption</strong></a></p>
<p>Yes</p>
<p>No</p>
<p>Yes</p>
<p>True</p>
<p>False</p>
<p>Disabled, using <a href="caption-property.html"><strong>Caption</strong></a></p>
<p>No</p>
<p>Yes</p>
<p>No</p>
<p>Yes</p>
<p>False</p>
<p>True</p>
<p>Does not appear</p>
<p>Yes, using <a href="caption-property.html"><strong>Caption</strong></a></p>
<p>Yes</p>
<p>No</p>
<p>Yes</p>
<p>False</p>
<p>False</p>
<p>Does not appear</p>
<p>No</p>
<p>Yes</p>
<p>No</p>
<p>No</p>
<p>True</p>
<p>True</p>
<p>Normal, using <a href="caption-property.html"><strong>Caption</strong></a></p>
<p>No</p>
<p>Yes</p>
<p>No</p>
<p>No</p>
<p>True</p>
<p>False</p>
<p>Disabled, using <a href="caption-property.html"><strong>Caption</strong></a></p>
<p>No</p>
<p>Yes</p>
<p>No</p>
<p>No</p>
<p>False</p>
<p>True</p>
<p>Does not appear</p>
<p>No</p>
<p>Yes</p>
<p>No</p>
<p>No</p>
<p>False</p>
<p>False</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>True</p>
<p>True</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>True</p>
<p>False</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>False</p>
<p>True</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>False</p>
<p>False</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>No</p>
<p>No</p>
<p>True</p>
<p>True</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>No</p>
<p>No</p>
<p>True</p>
<p>False</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>No</p>
<p>No</p>
<p>False</p>
<p>True</p>
<p>Does not appear</p>
<p>No</p>
<p>No</p>
<p>No</p>
<p>No</p>
<p>False</p>
<p>False</p>
<p>Does not appear</p>
<p>No</p>
<p>If the property setting is null. In some programming languages, an empty string may not be interpreted the same as a null string.  The command is still voice-accessible.<!-- raw HTML omitted --></p>
<p>When the server receives input for one of your commands, it sends a <a href="/windows/desktop/lwef/the-command-object"><strong>Command</strong></a> event, and passes back the name of the <strong>Command</strong> as an attribute of the <a href="/windows/desktop/lwef/iagentuserinput"><strong>UserInput</strong></a> object. You can then use conditional statements to match and process the <strong>Command</strong>.</p>
</body>
