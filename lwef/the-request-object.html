<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>The Request Object</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: The Request Object
description: The Request Object
ms.assetid: d8b37164-6855-48c0-bcf8-a86c0f8b3a59
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>The Request Object</h1>
<p>[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.]</p>
<p>The server processes some methods asynchronously. This enables your application code to continue while the method is completing. When a client application calls one of these methods, the control creates and returns a <a href="/windows/desktop/lwef/the-request-object"><strong>Request</strong></a> object for the request. You can use the <strong>Request</strong> object to track the status of the method by assigning an object variable to the method. In Visual Basic, first declare an object variable:</p>
<pre><code>   Dim MyRequest as Object
</code></pre>
<p>In VBScript, you don't include the variable type in your declaration:</p>
<pre><code>   Dim MyRequest
</code></pre>
<p>And use Visual Basic's Set statement to assign the variable to the method call:</p>
<pre><code>   Set MyRequest = &lt;i&gt;agent&lt;/i&gt;.Characters(&quot;&lt;i&gt;CharacterID&lt;/i&gt;&quot;).&lt;i&gt;method&lt;/i&gt; (&lt;i&gt;parameter&lt;/i&gt;[s])
</code></pre>
<p>This adds a reference to the <a href="/windows/desktop/lwef/the-request-object"><strong>Request</strong></a> object. The <strong>Request</strong> object will be destroyed when there are no more references to it. Where you declare the <strong>Request</strong> object and how you use it determines its lifetime. If the object is declared local to a subroutine or function, it will be destroyed when it goes out of scope; that is, when the subroutine or function ends. If the object is declared globally, it will not be destroyed until either the program terminates or a new value (or a value set to &quot;empty&quot;) is assigned to the object.</p>
<p>The <a href="/windows/desktop/lwef/the-request-object"><strong>Request</strong></a> object provides several properties you can query. For example, the <a href="status-property.html"><strong>Status</strong></a> property returns the current status of the request. You can use this property to check the status of your request:</p>
<pre><code>   Dim MyRequest
   
   Set MyRequest = Agent1.Characters.Load (&quot;Genie&quot;, &quot;https://agent.microsoft.com/characters/v2/genie/genie.acf&quot;)

   If (MyRequest.Status = 2) then
      'do something

   Else If (MyRequest.Status = 0) then
      'do something right away

   End If
</code></pre>
<p>The <a href="status-property.html"><strong>Status</strong></a> property returns the status of a <a href="/windows/desktop/lwef/the-request-object"><strong>Request</strong></a> object as a Long integer value.</p>
<table>
<thead>
<tr>
<th>Status</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Request successfully completed.</td>
</tr>
<tr>
<td>1</td>
<td>Request failed.</td>
</tr>
<tr>
<td>2</td>
<td>Request pending (in the queue, but not complete).</td>
</tr>
<tr>
<td>3</td>
<td>Request interrupted.</td>
</tr>
<tr>
<td>4</td>
<td>Request in progress.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The <a href="/windows/desktop/lwef/the-request-object"><strong>Request</strong></a> object also includes a Long integer value in the <a href="https://www.bing.com/search?q=**Number**"><strong>Number</strong></a> property that returns the error or cause of the <a href="status-property.html"><strong>Status</strong></a> code. If none, this value is zero (0). The <a href="description-property.html"><strong>Description</strong></a> property contains a string value that corresponds to the error number. If the string doesn't exist, <strong>Description</strong> contains &quot;Application-defined or object-defined error&quot;.</p>
<p>For the values and meaning returned by the <a href="https://www.bing.com/search?q=**Number**"><strong>Number</strong></a> property, see <a href="microsoft-agent-error-codes.html">Error Codes</a>.</p>
<p>The server places animation requests in the specified character's queue. This enables the server to play the animation on a separate thread, and your application's code can continue while animations play. If you create a <a href="/windows/desktop/lwef/the-request-object"><strong>Request</strong></a> object reference, the server automatically notifies you when an animation request has started or completed through the <a href="https://www.bing.com/search?q=**RequestStart**"><strong>RequestStart</strong></a> and <a href="https://www.bing.com/search?q=**RequestComplete**"><strong>RequestComplete</strong></a> events. Because methods that return <strong>Request</strong> objects are asynchronous and may not complete during the scope of the calling function, declare your reference to the <strong>Request</strong> object globally.</p>
<p>The following methods can be used to return a <a href="/windows/desktop/lwef/the-request-object"><strong>Request</strong></a> object: <a href="gestureat-method.html"><strong>GestureAt</strong></a>, <a href="get-method.html"><strong>Get</strong></a>, <a href="hide-method.html"><strong>Hide</strong></a>, <a href="interrupt-method.html"><strong>Interrupt</strong></a>, <a href="load-method.html"><strong>Load</strong></a>, <a href="moveto-method.html"><strong>MoveTo</strong></a>, <a href="play-method.html"><strong>Play</strong></a>, <a href="show-method.html"><strong>Show</strong></a>, <a href="speak-method.html"><strong>Speak</strong></a>, and <a href="https://www.bing.com/search?q=**Wait**"><strong>Wait</strong></a>.</p>
<p>Â </p>
<p>Â </p>
</body>
