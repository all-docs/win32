<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MpScanStart function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MpScanStart function (MpClient.h)
description: Starts a scanning operation.
ms.assetid: 3AF147C8-A41F-4193-AE28-72C1FBD18BA2
keywords:</p>
<ul>
<li>MpScanStart function Legacy Windows Environment Features
topic_type:</li>
<li>apiref
api_name:</li>
<li>MpScanStart
api_location:</li>
<li>MpClient.dll
api_type:</li>
<li>DllExport
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MpScanStart function</h1>
<p>Starts a scanning operation.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT WINAPI MpScanStart(
  _In_     MPHANDLE          hMpHandle,
  _In_     MPSCAN_TYPE       ScanType,
  _In_     DWORD             dwScanOptions,
  _In_opt_ PMPSCAN_RESOURCES pScanResources,
  _In_opt_ PMPCALLBACK_INFO  pCallbackInfo,
  _Out_    PMPHANDLE         phScanHandle
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hMpHandle</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>MPHANDLE</strong></p>
<p>Handle to the malware protection manager interface. This handle is returned by the <a href="mpmanageropen.html"><strong>MpManagerOpen</strong></a> function.</p>
<!-- raw HTML omitted -->
<p><em>ScanType</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="mpscan-type.html"><strong>MPSCAN_TYPE</strong></a></strong></p>
<p>Specifies the type of scan. This parameter must be one of the members of the <a href="mpscan-type.html"><strong>MPSCAN_TYPE</strong></a> enueration.</p>
<!-- raw HTML omitted -->
<p><em>dwScanOptions</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<p>Specifies various options for scanning operation.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPSCAN_OPTION_NONE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>No specific option is requested.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPSCAN_OPTION_ASYNC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The scan operation is to be asynchronous, where <strong>MpScanStart</strong> returns immediately after the successful initiation of scanning. (By default the scan operation is synchronous, meaning <strong>MpScanStart</strong> will return only after the scan is finished.)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPSCAN_OPTION_PROGRESS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The caller is interested in receiving scan progress information via a callback.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPSCAN_OPTION_LOWPRIORITY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Perform the scan with low priority. (By default the scan operation is performed with normal priority.)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPSCAN_OPTION_PACKEDEXES</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Scan packed executables for possible threats.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPSCAN_OPTION_ARCHIVES</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Scan archive contents for possible threats. Archives are files with extensions such as .zip, .cab, or .tar.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPSCAN_OPTION_HEURISTICS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Enable heuristics-based scanning. This will scan for threats with detection type set to heuristics.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPSCAN_OPTION_REPORTFRIENDLY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Report friendly items in a resource scan. This is intended for internal use only.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPSCAN_OPTION_REPORTUNKNOWN</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Report unknown items in a resource scan. This is intended for internal use only.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPSCAN_OPTION_NOCONSOLIDATE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Do not consolidate scan results with global threat view. This is useful for a client (such as an email client) which wants to control cleaning UX by itself rather than allowing default anti-malware cleaning UX. This is intended for internal use only.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>pScanResources</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>PMPSCAN_RESOURCES</strong></p>
<p>A pointer to the scan resource information. This parameter must be <strong>NULL</strong> for a quick scan. This is an optional parameter for a full scan. For a resource scan this parameter must be specified with at least one resource information structure. To scan specific resources the caller must have <strong>GENERIC_READ</strong> permission for the resource. See <a href="mpscan-resources.html"><strong>MPSCAN_RESOURCES</strong></a>.</p>
<!-- raw HTML omitted -->
<p><em>pCallbackInfo</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>PMPCALLBACK_INFO</strong></p>
<p>A pointer to the callback information used to feed the client with scan state changes (such as start and complete) and progress information. The <a href="mpcallback-data.html"><strong>MPCALLBACK_DATA</strong></a> passed back in the callback function reports actual scan state and progress-related information. The following is a list of possible callbacks:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SCAN_START</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Scan operation started.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SCAN_COMPLETE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Scan operation completed. Additional information is available via <a href="mpscan-data.html"><strong>MPSCAN_DATA</strong></a> structure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SCAN_PAUSED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Scan operation is paused.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SCAN_RESUMED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Scan operation resumed from pause.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SCAN_CANCEL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Scan operation was cancelled.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SCAN_PROGRESS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Scan progress information. Additional information (such as resource statistics) is available via <a href="mpscan-data.html"><strong>MPSCAN_DATA</strong></a> structure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SCAN_ERROR</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Scan error information for a specific resource. The specific resource information is available via <a href="mpscan-data.html"><strong>MPSCAN_DATA</strong></a> structure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SCAN_INFECTED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Scan found an infected resource. Note that in most of the cases this will result in some threat reported at the end of the scan. Sometimes it may not materialize as a threat because of exclusions. Additional infected resource information is available via <a href="mpscan-data.html"><strong>MPSCAN_DATA</strong></a> structure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SCAN_MEMORYSTART</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Quick scan portion of the full scan has started.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_SCAN_MEMORYCOMPLETE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Quick scan portion of the full scan has completed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MPNOTIFY_INTERNAL_FAILURE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Scan operation has encountered a generic failure. The <em>hResult</em> in <a href="mpcallback-data.html"><strong>MPCALLBACK_DATA</strong></a> has the specific error code.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>phScanHandle</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>PMPHANDLE</strong></p>
<p>Returned scan handle which identifies the currently initiated scan. This handle can be used in subsequent function calls, such as to retrieve a scan result. The handle must be closed with the <a href="mphandleclose.html"><strong>MpHandleClose</strong></a> function.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>HRESULT</strong></p>
<p>If the function succeeds the return value is <strong>S_OK</strong>.</p>
<p>If the function fails then the return value is a failed <strong>HRESULT</strong> code. The caller can use the <a href="mperrormessageformat.html"><strong>MpErrorMessageFormat</strong></a> function to get a generic description of the error message.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 8 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->MpClient.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->MpClient.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="mperrormessageformat.html"><strong>MpErrorMessageFormat</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mphandleclose.html"><strong>MpHandleClose</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpmanageropen.html"><strong>MpManagerOpen</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpcallback-data.html"><strong>MPCALLBACK_DATA</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpscan-data.html"><strong>MPSCAN_DATA</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpscan-resources.html"><strong>MPSCAN_RESOURCES</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpscan-type.html"><strong>MPSCAN_TYPE</strong></a></p>
<!-- raw HTML omitted -->
</body>
