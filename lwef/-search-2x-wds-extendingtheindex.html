<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Extending the Index (Legacy Windows Environment Features)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Extending the Index (Legacy Windows Environment Features)
description: Learn how to extend the index in Windows Desktop Search 2.x. For Windows releases later than Windows XP and Windows Server 2003, use Windows Search instead.
ms.assetid: 'vs|search|~\search\wds2x\extending_index_ovr.htm'
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Extending the Index (Legacy Windows Environment Features)</h1>
<blockquote>
<p>[!NOTE]
Windows Desktop Search 2.x is an obsolete technology that was originally available as an add-in for WindowsÂ XP and Windows Server 2003. On later releases, use <a href="../search/-search-3x-wds-overview.html">Windows Search</a> instead.</p>
</blockquote>
<p>The use of and development for the 2.x versions of MicrosoftÂ Windows Desktop Search (WDS) is strongly discouraged in favor of <a href="../search/-search-3x-wds-overview.html">Windows Search</a>.</p>
<p>WDS can be extended to index the contents of new file types and data stores. Currently, WDS 2.x contains filters for over 200 types of items (including plaintext items such as HTML, XML, and source code files) and uses the same <a href="/windows/desktop/api/filter/nn-filter-ifilter"><strong>IFilter</strong></a>and protocol handler technology as SharePoint Services. If you already have filter implementations installed for your new file types, WDS can use the existing filter interfaces to index this data.</p>
<p>WDS 2.x add-ins enable the index to traverse and parse new data and data structures for information to add to the searchable catalog. These add-ins can also extend the Windows Shell to associate icons and context-menu handlers with the new file types and data stores. To include new file types in the WDS catalog, an add-in must implement the <a href="/windows/desktop/api/filter/nn-filter-ifilter"><strong>IFilter</strong></a>interface. To include new data stores, an add-in must be a protocol handler. If the new data store includes embedded files or new file types itself, you will also need to write an appropriate filter as well.</p>
<blockquote>
<p>[!Note]</p>
<p>Filters and protocol handlers must be written in native code due to potential CLR versioning issues with the process all add-ins run in.</p>
</blockquote>
<p>Â </p>
<h2>Adding File Types to the Index</h2>
<p>Add-ins can extend WDS to index new or proprietary file types and to associate each new file type with a file-specific icon or context menu. To do this, you can build and register an add-in that:</p>
<ol>
<li>Implements an <a href="/windows/desktop/api/filter/nn-filter-ifilter"><strong>IFilter</strong></a>interface for each file type so WDS can access and index the file type's text and metadata.</li>
<li>Implements the <strong>IExtractIcon</strong> and <strong>IContextMenu</strong> interfaces to add icons and context menus for greater integration and usability.</li>
</ol>
<p>For a discussion on implementing filters, see <a href="-search-2x-wds-ifilteraddins.html">Developing IFilter Add-ins</a>.</p>
<h2>Adding Data Stores to the Index</h2>
<p>Add-ins can extend WDS to index new data stores and to associate files with a file-specific icon or context menu. To do this, you can build and register a protocol handler that:</p>
<ol>
<li>Implements the <strong>ISearchProtocol</strong> and <strong>IUrlAccessor</strong> interfaces to process and bind individual items in the content source. WDS uses URLs to uniquely identify items, whether those items are in the file system, inside a database-like store, or on the Web.</li>
<li>Implements the <strong>IPersistFolder</strong> interface and portions of the <strong>IShellFolder</strong> interface to add icons and context menus for greater integration and usability.</li>
</ol>
<p>For a discussion on implementing protocol handlers, see <a href="-search-2x-wds-phaddins.html">Developing Protocol Handlers</a>.</p>
<h2>Add-in Installer Guidelines</h2>
<p>Installation of an add-in should follow the following guidelines:</p>
<ul>
<li>The installer must use either EXE or MSI installer.</li>
<li>Release notes must be provided.</li>
<li>An <strong>Add/Remove Programs</strong> entry must be created for each add-in installed.</li>
<li>The installer must take over all registry settings for the particular file type or store that the current add-in understands.</li>
<li>If a previous add-in is being overwritten, the installer should notify the user.</li>
<li>If a newer add-in has overwritten the previous add-in, there should be the ability to restore the previous add-in's functionality and make it the default add-in for that file type or store again.</li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="-search-2x-wds-ifilteraddins.html">Developing IFilter Add-ins</a></p>
<!-- raw HTML omitted -->
<p><a href="-search-2x-wds-phaddins.html">Developing Protocol Handlers</a></p>
<!-- raw HTML omitted -->
<p><strong>Other Resources</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/filter/nn-filter-ifilter"><strong>IFilter</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
