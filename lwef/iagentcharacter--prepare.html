<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IAgentCharacter::Prepare</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: IAgentCharacter Prepare
description: IAgentCharacter Prepare
ms.assetid: e016039f-a0b1-4ae9-bff6-7212b02c1ad8
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>IAgentCharacter::Prepare</h1>
<p>[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.]</p>
<pre lang="syntax"><code>HRESULT Prepare(
   long dwType,     // type of animation data to load
   BSTR bszName,    // name of the animation 
   long bQueue,     // queue the request
   long * pdwReqID  // address of request ID
);
</code></pre>
<p>Retrieves animation data for a character.</p>
<ul>
<li>Returns S_OK to indicate the operation was successful. When the function returns, <em>pdwReqID</em> contains the ID of the request.</li>
</ul>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>dwType</em></p>
<!-- raw HTML omitted -->
<p>A value that indicates the animation data type to load that must be one of the following:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>const unsigned short</strong> <strong>PREPARE_ANIMATION = 0;</strong><!-- raw HTML omitted --></td>
<td>A character's animation data.</td>
</tr>
<tr>
<td><strong>const unsigned short</strong> <strong>PREPARE_STATE = 1;</strong><!-- raw HTML omitted --></td>
<td>A character's state data.</td>
</tr>
<tr>
<td><strong>const unsigned short</strong> <strong>PREPARE_WAVE = 2</strong><!-- raw HTML omitted --></td>
<td>A character's sound file (.WAV or .LWV) for spoken output.</td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>bszName</em></p>
<!-- raw HTML omitted -->
<p>The name of the animation or state.</p>
<p>The animation name is based on that defined for the character when it was saved using the Microsoft Agent Character Editor.</p>
<p>For states, the value can be one of the following:</p>
<table>
<thead>
<tr>
<th></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>&quot;Gesturing&quot;</strong></td>
<td>To retrieve all <strong>Gesturing</strong> state animations.</td>
</tr>
<tr>
<td><strong>&quot;GesturingDown&quot;</strong></td>
<td>To retrieve <strong>GesturingDown</strong> animations.</td>
</tr>
<tr>
<td><strong>&quot;GesturingLeft&quot;</strong></td>
<td>To retrieve <strong>GesturingLeft</strong> animations.</td>
</tr>
<tr>
<td><strong>&quot;GesturingRight&quot;</strong></td>
<td>To retrieve <strong>GesturingRight</strong> animations.</td>
</tr>
<tr>
<td><strong>&quot;GesturingUp&quot;</strong></td>
<td>To retrieve <strong>GesturingUp</strong> animations.</td>
</tr>
<tr>
<td><strong>&quot;Hiding&quot;</strong></td>
<td>To retrieve the <strong>Hiding</strong> state animations.</td>
</tr>
<tr>
<td><strong>&quot;Hearing&quot;</strong></td>
<td>To retrieve the <strong>Hearing</strong> state animations.</td>
</tr>
<tr>
<td><strong>&quot;Idling&quot;</strong></td>
<td>To retrieve all <strong>Idling</strong> state animations.</td>
</tr>
<tr>
<td><strong>&quot;IdlingLevel1&quot;</strong></td>
<td>To retrieve all <strong>IdlingLevel1</strong> animations.</td>
</tr>
<tr>
<td><strong>&quot;IdlingLevel2&quot;</strong></td>
<td>To retrieve all <strong>IdlingLevel2</strong> animations.</td>
</tr>
<tr>
<td><strong>&quot;IdlingLevel3&quot;</strong></td>
<td>To retrieve all <strong>IdlingLevel3</strong> animations.</td>
</tr>
<tr>
<td><strong>&quot;Listening&quot;</strong></td>
<td>To retrieve the <strong>Listening</strong> state animations.</td>
</tr>
<tr>
<td><strong>&quot;Moving&quot;</strong></td>
<td>To retrieve all <strong>Moving</strong> state animations.</td>
</tr>
<tr>
<td><strong>&quot;MovingDown&quot;</strong></td>
<td>To retrieve all <strong>Moving</strong> animations.</td>
</tr>
<tr>
<td><strong>&quot;MovingLeft&quot;</strong></td>
<td>To retrieve all <strong>MovingLeft</strong> animations.</td>
</tr>
<tr>
<td><strong>&quot;MovingRight&quot;</strong></td>
<td>To retrieve all <strong>MovingRight</strong> animations.</td>
</tr>
<tr>
<td><strong>&quot;MovingUp&quot;</strong></td>
<td>To retrieve all <strong>MovingUp</strong> animations.</td>
</tr>
<tr>
<td><strong>&quot;Showing&quot;</strong></td>
<td>To retrieve the <strong>Showing</strong> state animations.</td>
</tr>
<tr>
<td><strong>&quot;Speaking&quot;</strong></td>
<td>To retrieve the <strong>Speaking</strong> state animations.</td>
</tr>
</tbody>
</table>
<p>For .WAV files, set <em>bszName</em> to the URL or file specification for the .WAV file. If the specification is not complete, it is interpreted as being relative to the specification used in the <a href="https://www.bing.com/search?q=**Load**"><strong>Load</strong></a> method.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>bQueue</em></p>
<!-- raw HTML omitted -->
<p>A Boolean specifying whether the server queues the <a href="/windows/desktop/lwef/iagentcharacter--prepare"><strong>Prepare</strong></a> request. <strong>True</strong> queues the request and causes any animation request that follows it to wait until the animation data it specifies is loaded. <strong>False</strong> retrieves the animation data asynchronously.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>pdwReqID</em></p>
<!-- raw HTML omitted -->
<p>Address of a variable that receives the <a href="/windows/desktop/lwef/iagentcharacter--prepare"><strong>Prepare</strong></a> request ID.</p>
<!-- raw HTML omitted -->
<p>If you load a character using the HTTP protocol (an .ACF file), you must use the <a href="/windows/desktop/lwef/iagentcharacter--prepare"><strong>Prepare</strong></a> method to retrieve animation data before you can play the animation. You cannot use this method if you loaded the character using the UNC protocol (an .ACS file). You also cannot retrieve HTTP data for a character using <strong>Prepare</strong> if you loaded that character using the UNC protocol (.ACS character file).</p>
<p>Animation or sound data retrieved with the <a href="/windows/desktop/lwef/iagentcharacter--prepare"><strong>Prepare</strong></a> method is stored in the browser's cache. Subsequent calls will check the cache, and if the animation data is already there, the control loads the data directly from the cache. Once loaded, the animation or sound data can be played with the <a href="/windows/desktop/lwef/iagentcharacter--play"><strong>Play</strong></a> or <a href="/windows/desktop/lwef/iagentcharacter--speak"><strong>Speak</strong></a> methods.</p>
<p>You can specify multiple animations and states by separating them with commas. However, you cannot mix types in the same <a href="/windows/desktop/lwef/iagentcharacter--prepare"><strong>Prepare</strong></a> statement.</p>
</body>
