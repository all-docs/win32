<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IAgent::Load</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: IAgent Load
description: IAgent Load
ms.assetid: 8f25e6b6-a117-4b37-969a-d8f80c7be224
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>IAgent::Load</h1>
<p>[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.]</p>
<pre lang="syntax"><code>HRESULT Load(
   VARIANT vLoadKey,  // data provider
   long * pdwCharID,  // address of a variable for character ID
   long * pdwReqID    // address of a variable for request ID
);
</code></pre>
<p>Loads a character into the <a href="./iagent.html"><strong>Characters</strong></a> collection.</p>
<ul>
<li>Returns S_OK to indicate the operation was successful.</li>
</ul>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>vLoadKey</em></p>
<!-- raw HTML omitted -->
<p>A variant datatype that must be one of the following:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>filespec</em></td>
<td>The local file location of the specified character's definition file.</td>
</tr>
<tr>
<td><em>URL</em></td>
<td>The HTTP address for the character's definition file.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>pdwCharID</em></p>
<!-- raw HTML omitted -->
<p>Address of a variable that receives the character's ID.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>pdwReqID</em></p>
<!-- raw HTML omitted -->
<p>Address of a variable that receives the <a href="load-method.html"><strong>Load</strong></a> request ID.</p>
<!-- raw HTML omitted -->
<p>You can load characters from the Microsoft Agent subdirectory by specifying a relative path (one that does not include a colon or leading slash character). This prefixes the path with Agent's characters directory (located in the localized %windows%\msagent directory). You can also use a relative address to specify your own directory in Agent's Chars directory.</p>
<p>You cannot load the same character (a character having the same GUID) more than once from a single connection. Similarly, you cannot load the default character and other characters at the same time from a single connection, because the default character could be the same as the other character. However, you can create another connection (using CoCreateInstance) and load the same character.</p>
<p>Microsoft Agent's data provider supports loading character data stored as a single structured file (.ACS) with character data and animation data together, or as separate character data (.ACF) and animation (.ACA) files. Generally, use the single structured .ACS file to load a character that is stored on a local disk drive or network and accessed using conventional file protocol (such as UNC pathnames). Use the separate .ACF and .ACA files when you want to load the animation files individually from a remote site where they are accessed using HTTP protocol.</p>
<p>For .ACS files, using the <a href="load-method.html"><strong>Load</strong></a> method provides access a character's animations; once loaded, you can use the <a href="play-method.html"><strong>Play</strong></a> method to animate the character. For .ACF files, you also use the <a href="/windows/desktop/lwef/iagentcharacter--prepare"><strong>Prepare</strong></a> method to load animation data. The <strong>Load</strong> method does not support downloading .ACS files from an HTTP site.</p>
<p>Loading a character does not automatically display the character. Use the <a href="show-method.html"><strong>Show</strong></a> method first to make the character visible.</p>
<p>Â </p>
<p>Â </p>
</body>
