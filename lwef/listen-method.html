<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Listen Method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Listen Method
description: Listen Method
ms.assetid: ceb3b62f-2a33-4a13-b608-4cfa800be38a
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Listen Method</h1>
<p>[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.]</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Description</strong></p>
<!-- raw HTML omitted -->
<p>Turns on Listening mode (speech recognition) for a timed period.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Syntax</strong></p>
<!-- raw HTML omitted -->
<p><em>agent.<em><strong>Characters</strong></em></em>(&quot;<em><strong>CharacterID</strong></em>&quot;).Listen** <em>State</em></p>
<table>
<thead>
<tr>
<th>Part</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>State</em></td>
<td>Required. A Boolean value that determines whether to turn Listening mode on or off. <strong>True</strong> Turns Listening mode on. <!-- raw HTML omitted --> <strong>False</strong> Turns Listening mode off.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>Setting this method to <strong>True</strong> enables Listening mode (turns on speech recognition) for a fixed period of time (10 seconds). While you cannot set the value of the time-out, you can turn off Listening mode before the time-out expires. If you (or another client) successfully set Listening mode on and you attempt to set this property to <strong>True</strong> before the time-out expires, the method succeeds and resets the time-out. However, if the Listening mode is on because the user is pressing the Listening key, the method succeeds, but the time-out is ignored and the Listening mode ends based on the user's interaction with the Listening key.</p>
<p>This method succeeds only when called by the input-active client and if speech services have been started. To ensure that speech services have been started, query or set the <a href="srmodeid-property.html"><strong>SRModeID</strong></a> or set the <a href="voice-property.html"><strong>Voice</strong></a> setting for a <a href="/windows/desktop/lwef/the-command-object"><strong>Command</strong></a> before you call <strong>Listen</strong> otherwise the method will fail. To detect the success of this method, call it as a function and it will return a Boolean value indicating whether the method succeeded.</p>
<pre><code>   If Genie.Listen(True) Then
      'The method succeeded

   Else
      ' The method failed

   End If
</code></pre>
<p>The method also fails if the user is pressing the Listening key and you attempt to set <strong>Listen</strong> to <strong>False</strong>. However, if the user has released the Listening key and Listening mode has not timed out, it will succeed.</p>
<p><strong>Listen</strong> also fails if there is no compatible speech engine available that matches the character's <a href="languageid-property.html"><strong>LanguageID</strong></a> setting, the user has disabled speech input using the Microsoft Agent property sheet, or the audio device is busy.</p>
<p>When you successfully set this method to <strong>True</strong>, the server triggers the <a href="listenstart-event.html"><strong>ListenStart</strong></a> event. The server sends <a href="listencomplete-event.html"><strong>ListenComplete</strong></a> when the Listening mode time-out completes or when you set <strong>Listen</strong> to <strong>False</strong>.</p>
<p>This method does not automatically call <a href="stop-method.html"><strong>Stop</strong></a> and play a Listening state animation as the server does when the Listening key is pressed. This enables you to determine whether to interrupt the current animation using the <a href="listenstart-event.html"><strong>ListenStart</strong></a> animation by calling <strong>Stop</strong> and playing your own appropriate animation. However, the server does call <strong>Stop</strong> and plays a Hearing state animation when a user utterance is detected.</p>
<h2>See Also</h2>
<p><a href="languageid-property.html"><strong>LanguageID property</strong></a>, <a href="listencomplete-event.html"><strong>ListenComplete event</strong></a>, <a href="listenstart-event.html"><strong>ListenStart event</strong></a></p>
</body>
