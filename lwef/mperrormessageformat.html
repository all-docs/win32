<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MpErrorMessageFormat function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MpErrorMessageFormat function (MpClient.h)
description: Returns a formatted error message based on an error code.
ms.assetid: C125FCE4-3BB0-4608-BBF3-E7FEF17D0807
keywords:</p>
<ul>
<li>MpErrorMessageFormat function Legacy Windows Environment Features
topic_type:</li>
<li>apiref
api_name:</li>
<li>MpErrorMessageFormat
api_location:</li>
<li>MpClient.dll
api_type:</li>
<li>DllExport
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MpErrorMessageFormat function</h1>
<p>Returns a formatted error message based on an error code.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT WINAPI MpErrorMessageFormat(
  _In_  MPHANDLE hMpHandle,
  _In_  HRESULT  hrError,
  _Out_ LPWSTR   *pwszErrorDesc
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hMpHandle</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>MPHANDLE</strong></p>
<p>Handle to the malware protection manager interface. This handle is returned by the <a href="mpmanageropen.html"><strong>MpManagerOpen</strong></a> function.</p>
<!-- raw HTML omitted -->
<p><em>hrError</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>HRESULT</strong></p>
<p>An <strong>HRESULT</strong>-based error code.</p>
<!-- raw HTML omitted -->
<p><em>pwszErrorDesc</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPWSTR*</strong></p>
<p>Returns a formatted error message based on <em>hrError</em>. This string must be freed using <a href="mpfreememory.html"><strong>MpFreeMemory</strong></a>.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>HRESULT</strong></p>
<p>If the function succeeds the return value is <strong>S_OK</strong>.</p>
<p>If the function fails then the return value is a failed <strong>HRESULT</strong> code.</p>
<h2>Remarks</h2>
<p>This function is capable of formatting system error codes in addition to specific error codes returned by malware protection functions. The <strong>HRESULT</strong> error codes specific to malware protection functions have a facility of 0x50. Below is a list of a subset of the malware protection-specific error codes that can be returned by various malware protection functions. Using the macro <strong>HRESULT_FROM_MP_STATUS</strong>, the following error codes can be converted to <strong>HRESULT</strong>. See also <a href="https://support.microsoft.com/kb/939359">Forefront Client Security anti-malware engine error codes</a> for a list of other possible error codes.</p>
<table>
<thead>
<tr>
<th>Error Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ERROR_MP_NOENGINE</td>
<td>No engine is loaded in antimalware service to perform the requested operation.</td>
</tr>
<tr>
<td>ERROR_MP_NO_MEMORY</td>
<td>The antimalware engine has encountered a no memory situation.</td>
</tr>
<tr>
<td>ERROR_MP_REMOVE_FAILED</td>
<td>Remove operation failed for a specific threat.</td>
</tr>
<tr>
<td>ERROR_MP_QUARANTINE_FAILED</td>
<td>Quarantine operation failed for a specific threat.</td>
</tr>
<tr>
<td>ERROR_MP_THREAT_NOT_FOUND</td>
<td>The specific threat no longer exists in the system.</td>
</tr>
<tr>
<td>ERROR_MP_REMOVE_NOT_SUPPORTED</td>
<td>Remove operation for a specific threat inside the container type is not supported.</td>
</tr>
<tr>
<td>ERROR_MP_REMOVE_IMMUTABLE_CONTAINER</td>
<td>Due to engine policy, a remove operation of a specific threat inside a blocked container is not supported. (Mail archives.)</td>
</tr>
<tr>
<td>ERROR_MP_BADDB_OLDENGINE</td>
<td>Signature update request provided an older engine or signature files(s).</td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 8 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->MpClient.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->MpClient.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="mpfreememory.html"><strong>MpFreeMemory</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="mpmanageropen.html"><strong>MpManagerOpen</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="https://support.microsoft.com/kb/939359">Forefront Client Security anti-malware engine error codes</a></p>
<!-- raw HTML omitted -->
</body>
