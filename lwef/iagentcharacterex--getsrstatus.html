<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IAgentCharacterEx::GetSRStatus</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: IAgentCharacterEx GetSRStatus
description: IAgentCharacterEx GetSRStatus
ms.assetid: ccb34108-8078-421a-a883-731b51fae179
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>IAgentCharacterEx::GetSRStatus</h1>
<p>[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.]</p>
<pre lang="syntax"><code>HRESULT GetSRStatus(
   long * plStatus  // address of the speech input status
);
</code></pre>
<p>Retrieves the status of the condition necessary to support speech input.</p>
<ul>
<li>Returns S_OK to indicate the operation was successful.</li>
</ul>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>plStatus</em></p>
<!-- raw HTML omitted -->
<p>Address of a variable that receives one of the following values for the state setting:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>const unsigned long</strong> <strong>LISTEN_STATUS_CANLISTEN = 0;</strong><!-- raw HTML omitted --></td>
<td>Conditions support speech input.</td>
</tr>
<tr>
<td><strong>const unsigned long</strong> <strong>LISTEN_STATUS_NOAUDIO = 1;</strong><!-- raw HTML omitted --></td>
<td>There is no audio input device available on this system. (Note that this does not detect whether a microphone is installed; it can only detect whether the user has a properly installed input-enabled sound card with a working driver.)</td>
</tr>
<tr>
<td><strong>const unsigned long</strong> <strong>LISTEN_STATUS_NOTTOPMOST = 2;</strong><!-- raw HTML omitted --></td>
<td>Another client is the active client of this character, or the current character is not topmost.</td>
</tr>
<tr>
<td><strong>const unsigned long</strong> <strong>LISTEN_STATUS_CANTOPENAUDIO = 3;</strong><!-- raw HTML omitted --></td>
<td>The audio input or output channel is currently busy, some other application is using audio.</td>
</tr>
<tr>
<td><strong>const unsigned long</strong> <strong>LISTEN_STATUS_COULDNTINITIALIZESPEECH = 4;</strong><!-- raw HTML omitted --></td>
<td>An unspecified error occurred in the process of initializing the speech recognition subsystem. This includes the possibility that there is no speech engine available matching the character's language setting.</td>
</tr>
<tr>
<td><strong>const unsigned long</strong> <strong>LISTEN_STATUS_SPEECHDISABLED = 5;</strong><!-- raw HTML omitted --></td>
<td>The user has disabled speech input in the Advanced Character Options window.</td>
</tr>
<tr>
<td><strong>const unsigned long</strong> <strong>LISTEN_STATUS_ERROR = 6;</strong><!-- raw HTML omitted --></td>
<td>An error occurred in checking the audio status, but the cause of the error was not returned by the system.</td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p>This function enables you to query whether current conditions support speech recognition input, including the status of the audio device. If your application uses the <a href="iagentcharacterex--listen.html"><strong>IAgentCharacterEx::Listen</strong></a> method, you can use this function to better ensure that the call will succeed. Calling this method also loads the speech engine if it is not already loaded. However, it does not turn on Listening mode.</p>
<p>When speech input is enabled in the Agent property sheet (Advanced Character Options), querying the status will load the associated engine (if it is not already loaded), and start speech services. That is, the Listening key is available, and the Listening Tip is displayable. (The Listening key and Listening Tip are enabled only if they are also enabled in Advanced Character Options.) However, if you query the property when speech is disabled, the server does not start speech services.</p>
<p>This function returns only the setting for your client application's use of the character; the setting does not reflect other clients of the character or other characters of your client application.</p>
</body>
