<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IAgentCharacter::Speak</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: IAgentCharacter Speak
description: IAgentCharacter Speak
ms.assetid: 3c4baf83-9e69-4048-bdaf-4ead8ea8e7cd
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>IAgentCharacter::Speak</h1>
<p>[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.]</p>
<pre lang="syntax"><code>HRESULT Speak(
   BSTR bszText,    // text to speak
   BSTR bszURL,     // URL of a file to speak
   long * pdwReqID  // address of a request ID
);
</code></pre>
<p>Speaks the text or sound file.</p>
<ul>
<li>Returns S_OK to indicate the operation was successful.</li>
</ul>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>bszText</em></p>
<!-- raw HTML omitted -->
<p>The text the character is to speak.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>bszURL</em></p>
<!-- raw HTML omitted -->
<p>The URL (or file specification) of a sound file to use for spoken output. This can be a standard sound file (.WAV) or linguistically enhanced sound file (.LWV).</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>pdwReqID</em></p>
<!-- raw HTML omitted -->
<p>Address of a variable that receives the <a href="/windows/desktop/lwef/iagentcharacter--speak"><strong>Speak</strong></a> request ID.</p>
<!-- raw HTML omitted -->
<p>To use this method with a character configured to speak using a text-to-speech (TTS) engine; simply provide the <em>bszText</em> parameter. You can include vertical bar characters (|) in the <em>bszText</em> parameter to designate alternative strings, so that each time the server processes the method, it randomly choose a different string. Support of TTS output is defined when the character is compiled using the Microsoft Agent Character Editor.</p>
<p>If you want to use sound file output for the character, specify the location for the file in the <em>bszURL</em> parameter. When using the HTTP protocol to download a sound file, use the <a href="/windows/desktop/lwef/iagentcharacter--prepare"><strong>Prepare</strong></a> method to ensure the availability of the file before using this method. You can use the <em>bszText</em> parameter to specify the words that appear in the character's word balloon. If you specify a linguistically enhanced sound file (.LWV) for the <em>bszURL</em> parameter and do not specify text, the <em>bszText</em> parameter uses the text stored in the file.</p>
<p>The <a href="/windows/desktop/lwef/iagentcharacter--speak"><strong>Speak</strong></a> method uses the last animation played to determine which speaking animation to play. For example, if you precede the <strong>Speak</strong> command with an <a href="iagentcharacter--play.html"><strong>IAgentCharacter::Play</strong></a> &quot;<strong>GestureRight</strong>&quot;, the server will play <strong>GestureRight</strong> and then the <strong>GestureRight</strong> speaking animation. If the last animation played has no speaking animation, then Microsoft Agent plays the animation assigned to the character's <strong>Speaking</strong> state.</p>
<p>If you call <a href="/windows/desktop/lwef/iagentcharacter--speak"><strong>Speak</strong></a> and the audio channel is busy, the character's audio output will not be heard, but the text will display in the word balloon. The word balloon's <a href="enabled-property.html">Enabled</a> property must also be <strong>True</strong> for the text to display.</p>
<p>Microsoft Agent's automatic word breaking in the word balloon, breaks words using white-space characters (for example, space and tab). However, it may break a word to fit the balloon as well. In languages like Japanese, Chinese, and Thai, where spaces are not used to break words, insert a Unicode zero width space character (0x200B) between characters to define logical word breaks.</p>
<blockquote>
<p>[!Note]<br />
Set the character's language ID (using <a href="iagentcharacterex--setlanguageid.html"><strong>IAgentCharacterEx::SetLanguageID</strong></a> before using the <a href="/windows/desktop/lwef/iagentcharacter--speak"><strong>Speak</strong></a> method to ensure appropriate text display within the word balloon.</p>
</blockquote>
<p>Â </p>
<h2>See Also</h2>
<p><a href="iagentcharacter--play.html"><strong>IAgentCharacter::Play</strong></a>, <a href="iagentballoon--getenabled.html"><strong>IAgentBalloon::GetEnabled</strong></a>, <a href="iagentcharacter--prepare.html"><strong>IAgentCharacter::Prepare</strong></a></p>
<p>Â </p>
<p>Â </p>
</body>
