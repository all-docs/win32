<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IVMGuestOS::IsHeartbeating property</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IVMGuestOS IsHeartbeating property (VPCCOMInterfaces.h)
description: Determines whether the virtual machine has a heartbeat.
ms.assetid: b1697a7b-6119-47aa-b261-6009f5287993
keywords:</p>
<ul>
<li>IsHeartbeating property Virtual PC</li>
<li>IsHeartbeating property Virtual PC , IVMGuestOS interface</li>
<li>IVMGuestOS interface Virtual PC , IsHeartbeating property
topic_type:</li>
<li>apiref
api_name:</li>
<li>IVMGuestOS.IsHeartbeating</li>
<li>IVMGuestOS.get_IsHeartbeating
api_location:</li>
<li>VPCCOMInterfaces.h
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>IVMGuestOS::IsHeartbeating property</h1>
<p>[Windows Virtual PC is no longer available for use as of Windows 8. Instead, use the <a href="/windows/desktop/HyperV_v2/windows-virtualization-portal">Hyper-V WMI provider (V2)</a>.]</p>
<p>Determines whether the virtual machine has a heartbeat.</p>
<p>This property is read-only.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT get_IsHeartbeating(
  [out, retval] VARIANT_BOOL *heartBeating
);
</code></pre>
<h2>Property value</h2>
<p><strong>VARIANT_TRUE</strong> if a heartbeat is detected, <strong>VARIANT_FALSE</strong> otherwise.</p>
<h2>Error codes</h2>
<table>
<thead>
<tr>
<th>Name/value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->S_OK<!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The operation was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->E_POINTER<!-- raw HTML omitted --> <!-- raw HTML omitted -->0x80004003<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The parameter is <strong>NULL</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->VM_E_VM_UNKNOWN<!-- raw HTML omitted --> <!-- raw HTML omitted -->0xA0040207<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The configuration is unknown.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->VM_E_VM_NOT_RUNNING<!-- raw HTML omitted --> <!-- raw HTML omitted -->0xA0040206<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The virtual machine must be running for this operation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->VM_E_ADDITIONS_NOT_AVAIL<!-- raw HTML omitted --> <!-- raw HTML omitted -->0xA0040504<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The virtual machine is not fully booted, the integration components feature is not installed, or the installed version does not support this feature.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->DISP_E_EXCEPTION<!-- raw HTML omitted --> <!-- raw HTML omitted -->0x80020009<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An unexpected error has occurred.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>When integration components is installed in the guest operating system, a regular 'tick' or heartbeat is sent from the virtual machine session to Windows Virtual PC. If the guest operating system is heavily loaded, it's possible that Virtual PC will receive fewer heartbeats than expected. If no heartbeat is detected, it is possible that the guest operating system is not responding or is crashed.</p>
<p>By default, a virtual machine produces ten heartbeat ticks per minute. If no heartbeat ticks are detected for an entire minute, Windows Virtual PC will attempt to restart the virtual machine session once every ten seconds for up to two minutes. This behavior is controlled by the following key values in the virtual machine session's configuration file.</p>
<table>
<thead>
<tr>
<th>Configuration key</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>integration/microsoft/heartbeat/time<!-- raw HTML omitted --></td>
<td>60<!-- raw HTML omitted --></td>
<td>The length of the block of time used to generate heartbeat ticks, in seconds.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>integration/microsoft/heartbeat/rate<!-- raw HTML omitted --></td>
<td>10<!-- raw HTML omitted --></td>
<td>The number of ticks generated in each heartbeat time block.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>integration/microsoft/heartbeat/failure_interval<!-- raw HTML omitted --></td>
<td>10<!-- raw HTML omitted --></td>
<td>The number of seconds between restart attempts, once no heartbeat ticks are received within a specific heartbeat time block.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>integration/microsoft/heartbeat/failure_attempts<!-- raw HTML omitted --></td>
<td>12<!-- raw HTML omitted --></td>
<td>The number of restart attempts made.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 7 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>Windows 7<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Product<!-- raw HTML omitted --></td>
<td>Windows Virtual PC<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->VPCCOMInterfaces.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IVMGuestOS is defined as 99fea0db-4880-499a-b6d8-73dff9bc91be<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="ivmguestos.html"><strong>IVMGuestOS</strong></a></p>
<!-- raw HTML omitted -->
</body>
