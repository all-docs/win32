<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IVMVirtualMachine::SetConfigurationValue method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IVMVirtualMachine SetConfigurationValue method (VPCCOMInterfaces.h)
description: Sets the value of the specified configuration setting for this virtual machine (VM).
ms.assetid: 43c3ac88-2e25-4c9e-a2ac-fcae5add62c5
keywords:</p>
<ul>
<li>SetConfigurationValue method Virtual PC</li>
<li>SetConfigurationValue method Virtual PC , IVMVirtualMachine interface</li>
<li>IVMVirtualMachine interface Virtual PC , SetConfigurationValue method
topic_type:</li>
<li>apiref
api_name:</li>
<li>IVMVirtualMachine.SetConfigurationValue
api_location:</li>
<li>VPCCOMInterfaces.h
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>IVMVirtualMachine::SetConfigurationValue method</h1>
<p>[Windows Virtual PC is no longer available for use as of Windows 8. Instead, use the <a href="/windows/desktop/HyperV_v2/windows-virtualization-portal">Hyper-V WMI provider (V2)</a>.]</p>
<p>Sets the value of the specified configuration setting for this virtual machine (VM).</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT SetConfigurationValue(
  [in] BSTR    configurationKey,
  [in] VARIANT configurationValue
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>configurationKey</em> [in]</p>
<!-- raw HTML omitted -->
<p>The key used to identify the configuration value as stored in the &quot;*.vmc&quot; file.</p>
<blockquote>
<p>[!IMPORTANT]
Changes should be made to &quot;*.vmc&quot; only using the <strong>SetConfigurationValue</strong> method. Changing &quot;*.vmc&quot; using any other method is not supported.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><em>configurationValue</em> [in]</p>
<!-- raw HTML omitted -->
<p>The configuration value. This value cay be one of the following <strong>VARIANT</strong> types: <strong>VT_ARRAY</strong>|<strong>VT_UI1</strong> (raw bytes), <strong>VT_BSTR</strong> (string), <strong>VT_UI4</strong> (integer), or <strong>VT_BOOL</strong> (Boolean).</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method can return one of these values.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The operation was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_INVALIDARG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x80000003<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>configurationKey</em> parameter is <strong>NULL</strong> or empty or the <em>configurationValue</em> parameter is not a valid variant type.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>VM_E_VM_UNKNOWN</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0xA0040207<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The configuration is unknown.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DISP_E_EXCEPTION</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x80020009<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An unexpected error has occurred.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>The following values are supported for the <em>configurationKey</em> parameter.</p>
<table>
<thead>
<tr>
<th><em>configurationKey</em> value</th>
<th>Description</th>
<th>Data type</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>&quot;hardware/bios/time_sync_at_boot&quot;<!-- raw HTML omitted --></td>
<td>&quot;true&quot; if the VM CMOS clock is to be synchronized with the host clock at boot; &quot;false&quot; otherwise.<!-- raw HTML omitted --></td>
<td>&quot;boolean&quot;<!-- raw HTML omitted --></td>
<td>&quot;true&quot;<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>&quot;integration/microsoft/host_time_sync/enabled&quot;&quot;<!-- raw HTML omitted --></td>
<td>&quot;true&quot; if host time synchronization is enabled in the integration components; &quot;false&quot; otherwise.<!-- raw HTML omitted --></td>
<td>&quot;boolean&quot;<!-- raw HTML omitted --></td>
<td>&quot;true&quot;<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>&quot;ui_options/auto_app_publish&quot;<!-- raw HTML omitted --></td>
<td>&quot;true&quot; if automatic publishing of applications is enabled in the integration components; &quot;false&quot; otherwise. This is also called virtual applications.<!-- raw HTML omitted --></td>
<td>&quot;boolean&quot;<!-- raw HTML omitted --></td>
<td>&quot;true&quot;<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>&quot;ui_options/seconds_to_save&quot;<!-- raw HTML omitted --></td>
<td>Number of seconds to wait before saving the VM after all applications are closed. However, values below 20 and more than 4,294,968 have special meanings. For details, see the following list<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --> Never save the VM.<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->1 20<!-- raw HTML omitted --> <!-- raw HTML omitted --> Wait 20 seconds before saving the VM.<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->21 4,294,967<!-- raw HTML omitted --> <!-- raw HTML omitted --> Wait the specified number of seconds before saving the VM.<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->4,294,968 4,294,967,295<!-- raw HTML omitted --> <!-- raw HTML omitted --> Wait 4,294,968 seconds before saving the VM.<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>&quot;integer&quot;<!-- raw HTML omitted --></td>
<td>300<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>This method provides low-level access to any configuration value. It can be used to set configuration values for customer-defined keys. Be careful if you use this method to set system configuration values, because no error checking is performed on the configuration value. Also, some configuration values cannot be changed while the virtual machine is running.</p>
<p>Configuration keys are located in the virtual machine's &quot;*.vmc&quot; file in XML format. The keys are stored in a hierarchical manner similar to the registry keys in Windows. To specify a specific subkey, a &quot;key path&quot; is constructed which specifies the various keys in a slash mark delimited format.</p>
<p>For example, to set the value of the &quot;ram_size&quot; key located in the following key tree:</p>
<pre lang="syntax"><code>&lt;preferences&gt;
  &lt;hardware&gt;
    &lt;bios&gt;
      &lt;time_sync_at_boot type=&quot;boolean&quot;&gt;true&lt;/time_sync_at_boot&gt;
</code></pre>
<p>The <em>configurationKey</em> path string would be specified as follows:</p>
<pre lang="syntax"><code>&quot;hardware/memory/ram_size&quot;
</code></pre>
<p>If any of the keys in the desired tree have an &quot;id&quot; attribute value, the attribute and its value is embedded in the <em>configurationKey</em> path string immediately after its associated configuration key using the following bracketed format: &quot;[@id=&quot;<em>id_value</em>&quot;]&quot;.</p>
<p>For example, to set the value of the &quot;golf&quot; key located in the following key tree:</p>
<pre lang="syntax"><code>&lt;preferences&gt;
  &lt;alpha&gt;
    &lt;bravo&gt;
      &lt;charlie&gt;
        &lt;delta id=&quot;1&quot;&gt;
          &lt;echo id=&quot;0&quot;&gt;
            &lt;foxtrot&gt;
              &lt;golf type=&quot;string&quot;&gt;D&lt;/golf&gt;
</code></pre>
<p>The <em>configurationKey</em> path string would be specified as follows:</p>
<pre lang="syntax"><code>&quot;alpha/bravo/charlie/delta[@id=1]/echo[@id=0]/foxtrot/golf&quot;
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 7 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>Windows 7<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Product<!-- raw HTML omitted --></td>
<td>Windows Virtual PC<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->VPCCOMInterfaces.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IVMVirtualMachine is defined as f7092aa1-33ed-4f78-a59f-c00adfc2edd7<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="ivmvirtualmachine.html"><strong>IVMVirtualMachine</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="ivmvirtualpc-setconfigurationvalue.html"><strong>IVMVirtualPC::SetConfigurationValue</strong></a></p>
<!-- raw HTML omitted -->
</body>
