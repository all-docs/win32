<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IVMVirtualMachine::GetActivationValue method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IVMVirtualMachine GetActivationValue method (VPCCOMInterfaces.h)
description: Retrieves the value of the specified activation setting for this virtual machine.
ms.assetid: 9a6f138f-6a8a-4cdf-8fb3-83d541d88fba
keywords:</p>
<ul>
<li>GetActivationValue method Virtual PC</li>
<li>GetActivationValue method Virtual PC , IVMVirtualMachine interface</li>
<li>IVMVirtualMachine interface Virtual PC , GetActivationValue method
topic_type:</li>
<li>apiref
api_name:</li>
<li>IVMVirtualMachine.GetActivationValue
api_location:</li>
<li>VPCCOMInterfaces.h
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>IVMVirtualMachine::GetActivationValue method</h1>
<p>[Windows Virtual PC is no longer available for use as of Windows 8. Instead, use the <a href="/windows/desktop/HyperV_v2/windows-virtualization-portal">Hyper-V WMI provider (V2)</a>.]</p>
<p>Retrieves the value of the specified activation setting for this virtual machine.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT GetActivationValue(
  [in]          BSTR    activationKey,
  [out, retval] VARIANT *activationValue
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>activationKey</em> [in]</p>
<!-- raw HTML omitted -->
<p>The key used to identify the activation value as stored in the &quot;*.vmc&quot; file.</p>
<!-- raw HTML omitted -->
<p><em>activationValue</em> [out, retval]</p>
<!-- raw HTML omitted -->
<p>The activation value. This value can be one of the following <strong>VARIANT</strong> types: <strong>VT_ARRAY</strong> | <strong>VT_UI1</strong> (raw bytes), <strong>VT_BSTR</strong> (string), <strong>VT_I4</strong> (integer), or <strong>VT_BOOL</strong> (Boolean).</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method can return one of these values.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The operation was successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_INVALIDARG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x80000003<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>activationKey</em> parameter is <strong>NULL</strong> or empty.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_POINTER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x80004003<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>activationValue</em> parameter is <strong>NULL</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>VM_E_VM_UNKNOWN</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0xA0040207<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The configuration is unknown.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>VM_E_PREF_NOT_FOUND</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0xA0040300<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The preference was not found, or this configuration has no valid activation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DISP_E_EXCEPTION</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x80020009<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An unexpected error has occurred.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>This method provides low-level access to any activation value. It can be used to set activation values for customer-defined keys. When a virtual machine is started, a copy is made of its configuration values, which becomes its set of activation values. Activation values are maintained until the virtual machine is shut down or restarted. Note that Windows Virtual PC may only use the configuration to store values for certain keys, that is, the activation value may never be used.</p>
<p>Activation keys are stored internally in a hierarchical manner similar to the registry keys in Windows. To specify a specific subkey, a &quot;key path&quot; is constructed which specifies the various keys in a slash mark delimited format.</p>
<p>For example, to read the value of the &quot;default_action&quot; key located in the following key tree:</p>
<pre lang="syntax"><code>&lt;settings&gt;
    &lt;undo_drives&gt;
        &lt;default_action type=&quot;integer&quot;&gt;1&lt;/default_action&gt;
</code></pre>
<p>The <em>activationKey</em> path string would be specified as follows:</p>
<pre lang="syntax"><code>&quot;settings/undo_drives/default_action&quot;
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 7 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>Windows 7<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Product<!-- raw HTML omitted --></td>
<td>Windows Virtual PC<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->VPCCOMInterfaces.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IVMVirtualMachine is defined as f7092aa1-33ed-4f78-a59f-c00adfc2edd7<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="ivmvirtualmachine.html"><strong>IVMVirtualMachine</strong></a></p>
<!-- raw HTML omitted -->
</body>
