<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ImageAttributes Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Windows GDI+ exposes a flat API that consists of about 600 functions. These flat API functions are wrapped by the ImageAttributes C++ class.
ms.assetid: 2564ecc6-4050-4f45-9ff6-4ee3f7b04707
title: ImageAttributes Functions
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>ImageAttributes Functions</h1>
<p>Windows GDI+ exposes a flat API that consists of about 600 functions, which are implemented in Gdiplus.dll and declared in Gdiplusflat.h. The functions in the GDI+ flat API are wrapped by a collection of about 40 C++ classes. It is recommended that you do not directly call the functions in the flat API. Whenever you make calls to GDI+, you should do so by calling the methods and functions provided by the C++ wrappers. Microsoft Product Support Services will not provide support for code that calls the flat API directly. For more information on using these wrapper methods, see <a href="-gdiplus-flatapi-flat.html">GDI+ Flat API</a>.</p>
<p>The following flat API functions are wrapped by the <a href="/windows/desktop/api/gdiplusimageattributes/nl-gdiplusimageattributes-imageattributes"><strong>ImageAttributes</strong></a> C++ class.</p>
<h2>ImageAttributes Functions and Corresponding Wrapper Methods</h2>
<table>
<thead>
<tr>
<th>Flat function</th>
<th>Wrapper method</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td>GpStatus WINGDIPAPI GdipCreateImageAttributes(GpImageAttributes **imageattr)<!-- raw HTML omitted --></td>
<td><a href="/windows/win32/api/gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-imageattributes(constimageattributes_)"><strong>ImageAttributes::ImageAttributes()</strong></a></td>
<td>Creates an <a href="/windows/desktop/api/gdiplusimageattributes/nl-gdiplusimageattributes-imageattributes"><strong>ImageAttributes</strong></a> object.</td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipCloneImageAttributes(GDIPCONST GpImageAttributes *imageattr, GpImageAttributes **cloneImageattr)<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clone"><strong>ImageAttributes* ImageAttributes::Clone() const</strong></a></td>
<td>Makes a copy of this <a href="/windows/desktop/api/gdiplusimageattributes/nl-gdiplusimageattributes-imageattributes"><strong>ImageAttributes</strong></a> object.</td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipDisposeImageAttributes(GpImageAttributes *imageattr)<!-- raw HTML omitted --></td>
<td>ImageAttributes::~ImageAttributes()</td>
<td>Releases resources used by the <a href="/windows/desktop/api/gdiplusimageattributes/nl-gdiplusimageattributes-imageattributes"><strong>ImageAttributes</strong></a> object.</td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipSetImageAttributesToIdentity(GpImageAttributes *imageattr, ColorAdjustType type)<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-settoidentity"><strong>Status ImageAttributes::SetToIdentity( IN ColorAdjustType type = ColorAdjustTypeDefault )</strong></a></td>
<td>Sets the color-adjustment matrix of a specified category to identity matrix.</td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipResetImageAttributes(GpImageAttributes *imageattr, ColorAdjustType type)<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-reset"><strong>Status ImageAttributes::Reset( IN ColorAdjustType type = ColorAdjustTypeDefault )</strong></a></td>
<td>Sets the color-adjustment matrix of a specified category to identity matrix.</td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipSetImageAttributesColorMatrix(GpImageAttributes *imageattr, ColorAdjustType type, BOOL enableFlag, GDIPCONST ColorMatrix* colorMatrix, GDIPCONST ColorMatrix* grayMatrix, ColorMatrixFlags flags)<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setcolormatrix"><strong>Status ImageAttributes::SetColorMatrix( IN const ColorMatrix *colorMatrix, IN ColorMatrixFlags mode = ColorMatrixFlagsDefault, IN ColorAdjustType type = ColorAdjustTypeDefault )</strong></a><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearcolormatrix"><strong>Status ImageAttributes::ClearColorMatrix(IN ColorAdjustType type = ColorAdjustTypeDefault)</strong></a></td>
<td>Sets the color-adjustment matrix for a specified category. The <em>enableFlag</em> parameter in the flat function is a Boolean value that specifies whether a separate color adjustment is enabled for the category specified by the <em>type</em> parameter. <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setcolormatrix"><strong>ImageAttributes::SetColorMatrix</strong></a> sets <em>enableFlag</em> to <strong>TRUE</strong>, and <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearcolormatrix"><strong>ImageAttributes::ClearColorMatrix</strong></a> sets <em>enableFlag</em> to <strong>FALSE</strong>.<!-- raw HTML omitted --> Clears the color-adjustment matrix for a specified category. The <em>grayMatrix</em> parameter specifies a matrix to be used for adjusting gray shades when the value of the <em>flags</em> parameter is <a href="/windows/desktop/api/Gdipluscolormatrix/ne-gdipluscolormatrix-colormatrixflags"><strong>ColorMatrixFlagsAltGray</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipSetImageAttributesThreshold(GpImageAttributes *imageattr, ColorAdjustType type, BOOL enableFlag, REAL threshold)<!-- raw HTML omitted --></td>
<td>Status <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setthreshold"><strong>ImageAttributes::SetThreshold( IN REAL threshold, IN ColorAdjustType type = ColorAdjustTypeDefault )</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearthreshold"><strong>Status ImageAttributes::ClearThreshold(IN ColorAdjustType type = ColorAdjustTypeDefault)</strong></a><!-- raw HTML omitted --></td>
<td>Sets the threshold (transparency range) for a specified category. <!-- raw HTML omitted -->The <em>enableFlag</em> parameter in the flat function is a Boolean value that specifies whether a separate threshold is enabled for the category specified by the <em>type</em> parameter. <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setthreshold"><strong>ImageAttributes::SetThreshold</strong></a> sets <em>enableFlag</em> to <strong>TRUE</strong>, and <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearthreshold"><strong>ImageAttributes::ClearThreshold</strong></a> sets <em>enableFlag</em> to <strong>FALSE</strong>.Clears the threshold value for a specified category. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipSetImageAttributesGamma(GpImageAttributes *imageattr, ColorAdjustType type, BOOL enableFlag, REAL gamma)<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setgamma"><strong>Status ImageAttributes::SetGamma(IN REAL gamma, IN ColorAdjustType type = ColorAdjustTypeDefault)</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-cleargamma"><strong>Status ImageAttributes::ClearGamma(IN ColorAdjustType type = ColorAdjustTypeDefault)</strong></a><!-- raw HTML omitted --></td>
<td>Sets the gamma value for a specified category. The <em>enableFlag</em> parameter in the flat function is a Boolean value that specifies whether a separate gamma is enabled for the category specified by the <em>type</em> parameter. <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setgamma"><strong>ImageAttributes::SetGamma</strong></a> sets <em>enableFlag</em> to <strong>TRUE</strong>, and <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-cleargamma"><strong>ImageAttributes::ClearGamma</strong></a> sets <em>enableFlag</em> to <strong>FALSE</strong>.<!-- raw HTML omitted --> Disables gamma correction for a specified category. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipSetImageAttributesNoOp(GpImageAttributes *imageattr, ColorAdjustType type, BOOL enableFlag)<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setnoop"><strong>Status ImageAttributes::SetNoOp( IN ColorAdjustType type = ColorAdjustTypeDefault )</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearnoop"><strong>Status ImageAttributes::ClearNoOp(IN ColorAdjustType type = ColorAdjustTypeDefault)</strong></a><!-- raw HTML omitted --></td>
<td>Turns off color adjustment for a specified category. You can call the <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearnoop"><strong>ImageAttributes::ClearNoOp</strong></a> method to reinstate the color-adjustment settings that were in place before the call to <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setnoop"><strong>ImageAttributes::SetNoOp</strong></a> method . The <em>enableFlag</em> parameter in the flat function is a Boolean value that specifies whether a color adjustment is enabled for the category specified by the <em>type</em> parameter. <strong>ImageAttributes::SetNoOp</strong> sets <em>enableFlag</em> to <strong>TRUE</strong>, and <strong>ImageAttributes::ClearNoOp</strong> sets <em>enableFlag</em> to <strong>FALSE</strong>.<!-- raw HTML omitted --> Clears the NoOp setting for a specified category. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipSetImageAttributesColorKeys(GpImageAttributes *imageattr, ColorAdjustType type, BOOL enableFlag, ARGB colorLow, ARGB colorHigh)<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setcolorkey"><strong>Status ImageAttributes::SetColorKey( IN const Color&amp; colorLow, IN const Color&amp; colorHigh, IN ColorAdjustType type = ColorAdjustTypeDefault )</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearcolorkey"><strong>Status ImageAttributes::ClearColorKey(IN ColorAdjustType type = ColorAdjustTypeDefault)</strong></a><!-- raw HTML omitted --></td>
<td>Sets the color key (transparency range) for a specified category. The <em>enableFlag</em> parameter in the flat function is a Boolean value that specifies whether a separate transparency range is enabled for the category specified by the <em>type</em> parameter. <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setcolorkey"><strong>ImageAttributes::SetColorKey</strong></a> sets <em>enableFlag</em> to <strong>TRUE</strong>, and <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearcolorkey"><strong>ImageAttributes::ClearColorKey</strong></a> sets <em>enableFlag</em> to <strong>FALSE</strong>.<!-- raw HTML omitted --> Clears the color key (transparency range) for a specified category. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipSetImageAttributesOutputChannel(GpImageAttributes *imageattr, ColorAdjustType type, BOOL enableFlag, ColorChannelFlags channelFlags)<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setoutputchannel"><strong>Status ImageAttributes::SetOutputChannel( IN ColorChannelFlags channelFlags, IN ColorAdjustType type = ColorAdjustTypeDefault )</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearoutputchannel"><strong>Status ImageAttributes::ClearOutputChannel(IN ColorAdjustType type = ColorAdjustTypeDefault)</strong></a><!-- raw HTML omitted --></td>
<td>Sets the cyan-magenta-yellow-black (CMYK) output channel for a specified category. The <em>enableFlag</em> parameter in the flat function is a Boolean value that specifies whether a separate output channel is enabled for the category specified by the <em>type</em> parameter. <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setoutputchannel"><strong>ImageAttributes::SetOutputChannel</strong></a> sets <em>enableFlag</em> to <strong>TRUE</strong>, and <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearoutputchannel"><strong>ImageAttributes::ClearOutputChannel</strong></a> sets <em>enableFlag</em> to <strong>FALSE</strong>.<!-- raw HTML omitted --> Clears the cyan-magenta-yellow-black (CMYK) output channel setting for a specified category. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipSetImageAttributesOutputChannelColorProfile(GpImageAttributes *imageattr, ColorAdjustType type, BOOL enableFlag, GDIPCONST WCHAR *colorProfileFilename)<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setoutputchannelcolorprofile"><strong>Status ImageAttributes::SetOutputChannelColorProfile( IN const WCHAR *colorProfileFilename, IN ColorAdjustType type = ColorAdjustTypeDefault )</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearoutputchannelcolorprofile"><strong>Status ImageAttributes::ClearOutputChannelColorProfile(IN ColorAdjustType type = ColorAdjustTypeDefault)</strong></a><!-- raw HTML omitted --></td>
<td>Sets the output channel color-profile file for a specified category. The <em>enableFlag</em> parameter in the flat function is a Boolean value that specifies whether a separate output channel color profile is enabled for the category specified by the <em>type</em> parameter. <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setoutputchannelcolorprofile"><strong>ImageAttributes::SetOutputChannelColorProfile</strong></a> sets <em>enableFlag</em> to <strong>TRUE</strong>, and <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearoutputchannelcolorprofile"><strong>ImageAttributes::ClearOutputChannelColorProfile</strong></a> sets <em>enableFlag</em> to <strong>FALSE</strong>.<!-- raw HTML omitted --> Clears the output channel color profile setting for a specified category. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipSetImageAttributesRemapTable(GpImageAttributes *imageattr, ColorAdjustType type, BOOL enableFlag, UINT mapSize, GDIPCONST ColorMap *map)<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setremaptable"><strong>Status ImageAttributes::SetRemapTable( IN UINT mapSize, IN const ColorMap *map, IN ColorAdjustType type = ColorAdjustTypeDefault )</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearremaptable"><strong>Status ImageAttributes::ClearRemapTable(IN ColorAdjustType type = ColorAdjustTypeDefault)</strong></a><!-- raw HTML omitted --></td>
<td>Sets the color-remap table for a specified category. The <em>enableFlag</em> parameter in the flat function is a Boolean value that specifies whether a separate color remap table is enabled for the category specified by the <em>type</em> parameter. <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setremaptable"><strong>ImageAttributes::SetRemapTable</strong></a> sets <em>enableFlag</em> to <strong>TRUE</strong>, and <a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearremaptable"><strong>ImageAttributes::ClearRemapTable</strong></a> sets <em>enableFlag</em> to <strong>FALSE</strong>.<!-- raw HTML omitted --> Clears the color-remap table for a specified category. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipSetImageAttributesWrapMode(GpImageAttributes *imageAttr, WrapMode wrap, ARGB argb, BOOL clamp )<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setwrapmode"><strong>Status ImageAttributes::SetWrapMode(IN WrapMode wrap, IN const Color&amp; color = Color(), IN BOOL clamp = FALSE)</strong></a><!-- raw HTML omitted --></td>
<td>Sets the wrap mode of this <a href="/windows/desktop/api/gdiplusimageattributes/nl-gdiplusimageattributes-imageattributes"><strong>ImageAttributes</strong></a> object</td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipSetImageAttributesICMMode(GpImageAttributes *imageAttr, BOOL on )<!-- raw HTML omitted --></td>
<td>Not called by wrapper methods.<!-- raw HTML omitted --></td>
<td>This function sets an internal state variable to the value specified by the <em>on</em> parameter. If this value is <strong>TRUE</strong>, Image Color Management (ICM) is used for all color adjustment. If the value is <strong>FALSE</strong>, ICM is not used.</td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipGetImageAttributesAdjustedPalette(GpImageAttributes *imageAttr, ColorPalette * colorPalette, ColorAdjustType colorAdjustType )<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-getadjustedpalette"><strong>Status ImageAttributes::GetAdjustedPalette(IN OUT ColorPalette* colorPalette, IN ColorAdjustType colorAdjustType) const</strong></a><!-- raw HTML omitted --></td>
<td>Adjusts the colors in a palette according to the adjustment settings of a specified category.</td>
</tr>
<tr>
<td>GpStatus WINGDIPAPI GdipSetImageAttributesCachedBackground(GpImageAttributes *imageattr, BOOL enableFlag)<!-- raw HTML omitted --></td>
<td>Not called by wrapper methods.<!-- raw HTML omitted --></td>
<td>Sets or clears the CachedBackground member of a specified GpImageAttributes object. GDI+ does not use the CachedBackground member, so calling this function has no effect. The <em>imageattr</em> parameter specifies the GpImageAttributes object. The enableFlag parameter specifies whether the CachedBackground member is set (<strong>TRUE</strong>) or cleared (<strong>FALSE</strong>).</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
