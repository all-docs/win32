<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using a Pen to Draw Lines and Rectangles</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: To draw lines and rectangles, you need a Graphics object and a Pen object. The Graphics object provides the DrawLine method, and the Pen object stores features of the line, such as color and width.
ms.assetid: f2e4144f-f2f1-49db-bfdf-ffce3023b4cb
title: Using a Pen to Draw Lines and Rectangles
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using a Pen to Draw Lines and Rectangles</h1>
<p>To draw lines and rectangles, you need a <a href="/windows/win32/api/gdiplusgraphics/nl-gdiplusgraphics-graphics"><strong>Graphics</strong></a> object and a <a href="/windows/win32/api/gdipluspen/nl-gdipluspen-pen"><strong>Pen</strong></a> object. The <strong>Graphics</strong> object provides the <a href="/windows/win32/api/gdiplusgraphics/nf-gdiplusgraphics-graphics-drawline(inconstpen_inint_inint_inint_inint)">DrawLine</a> method, and the <strong>Pen</strong> object stores features of the line, such as color and width.</p>
<p>The following example draws a line from (20, 10) to (300, 100). Assume <strong>graphics</strong> is an existing <a href="/windows/win32/api/gdiplusgraphics/nl-gdiplusgraphics-graphics"><strong>Graphics</strong></a> object.</p>
<pre><code>Pen pen(Color(255, 0, 0, 0));
graphics.DrawLine(&amp;pen, 20, 10, 300, 100);
</code></pre>
<p>The first statement of code uses the <a href="/windows/win32/api/gdipluspen/nl-gdipluspen-pen"><strong>Pen</strong></a> class constructor to create a black pen. The one argument passed to the <strong>Pen</strong> constructor is a <a href="/windows/win32/api/gdipluscolor/nl-gdipluscolor-color"><strong>Color</strong></a> object. The values used to construct the <strong>Color</strong> object â€” (255, 0, 0, 0) â€” correspond to the alpha, red, green, and blue components of the color. These values define an opaque black pen.</p>
<p>The following example draws a rectangle with its upper-left corner at (10, 10). The rectangle has a width of 100 and a height of 50. The second argument passed to the <a href="/windows/win32/api/gdipluspen/nl-gdipluspen-pen"><strong>Pen</strong></a> constructor indicates that the pen width is 5 pixels.</p>
<pre><code>Pen blackPen(Color(255, 0, 0, 0), 5);
stat = graphics.DrawRectangle(&amp;blackPen, 10, 10, 100, 50);
</code></pre>
<p>When the rectangle is drawn, the pen is centered on the rectangle's boundary. Because the pen width is 5, the sides of the rectangle are drawn 5 pixels wide, such that 1 pixel is drawn on the boundary itself, 2 pixels are drawn on the inside, and 2 pixels are drawn on the outside. For more details on pen alignment, see <a href="-gdiplus-setting-pen-width-and-alignment-use.html">Setting Pen Width and Alignment</a>.</p>
<p>The following illustration shows the resulting rectangle. The dotted lines show where the rectangle would have been drawn if the pen width had been one pixel. The enlarged view of the upper-left corner of the rectangle shows that the thick black lines are centered on those dotted lines.</p>
<p><img src="images/pens1.png" alt="illustration of a rectangle drawn with a thick black line that surrounds a thin, grey, dashed line" /></p>
<p>Â </p>
<p>Â </p>
</body>
