<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IDeliveryOptimizationJob2::AddFileWithRanges method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IDeliveryOptimizationJob2 AddFile method
description: The AddFile method adds a single file to an existing Delivery Optimization job.
keywords:</p>
<ul>
<li>AddFile method</li>
<li>AddFile method, IDeliveryOptimizationJob2 interface</li>
<li>IDeliveryOptimizationJob2 interface, AddFile method
topic_type:</li>
<li>apiref
api_name:</li>
<li>IDeliveryOptimizationJob2.AddFile
api_location:</li>
<li>dosvc.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 01/18/2018
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>IDeliveryOptimizationJob2::AddFileWithRanges method</h1>
<p>The AddFile method adds a single file to an existing Delivery Optimization job.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT AddFile(
  [in]                              LPCWSTR       fileId,
  [in, unique]                      LPCWSTR       remoteUrl,
  [in]                              DWORD         rangeCount,
  [in, size_is(rangeCount), unique] BG_FILE_RANGE ranges[],
  [in]                              REFIID        riid,
  [out]                             void          **object
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>fileId</em> [in]</p>
<!-- raw HTML omitted -->
<p>The file ID string, which uniquely identifies the file to be downloaded.</p>
<!-- raw HTML omitted -->
<p><em>remoteUrl</em> [in]</p>
<!-- raw HTML omitted -->
<p>The file URL that Delivery Optimization will attempt to connect to download the file.</p>
<!-- raw HTML omitted -->
<p><em>rangeCount</em> [in]</p>
<!-- raw HTML omitted -->
<p>The number of items contained in <em>ranges</em>. A zero value means that no ranges are used for the file.</p>
<!-- raw HTML omitted -->
<p><em>ranges</em> [in]</p>
<!-- raw HTML omitted -->
<p>The optional range list. Each range in the list is a <a href="bg-file-range.html"><strong>BG_FILE_RANGE</strong></a> structure.</p>
<!-- raw HTML omitted -->
<p><em>riid</em> [in]</p>
<!-- raw HTML omitted -->
<p>The type of object contained in object. This must by of type IID_IDeliveryOptimizationFile.</p>
<!-- raw HTML omitted -->
<p><em>object</em> [out]</p>
<!-- raw HTML omitted -->
<p>The IDeliveryOptimizationFile object, which represents the download file.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method returns S_OK on success or one of the standard HRESULT values on error.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client</td>
<td>Windows 10, version 1803 [desktop apps only]</td>
</tr>
<tr>
<td>Minimum supported server</td>
<td>Windows Server, version 1709 [desktop apps only]</td>
</tr>
<tr>
<td>Header</td>
<td>Deliveryoptimization.h</td>
</tr>
<tr>
<td>IDL</td>
<td>DeliveryOptimization.idl</td>
</tr>
<tr>
<td>Library</td>
<td>Dosvc.lib</td>
</tr>
<tr>
<td>DLL</td>
<td>Dosvc.dll</td>
</tr>
<tr>
<td>IID</td>
<td>IID_IDeliveryOptimizationJob is defined as EE2584CF-A69C-4848-B633-2649962B3EF7</td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<p><a href="ideliveryoptimizationjob2.html"><strong>IDeliveryOptimizationJob2</strong></a></p>
</body>
