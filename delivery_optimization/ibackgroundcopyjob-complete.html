<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IBackgroundCopyJob::Complete method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IBackgroundCopyJob Complete method (Deliveryoptimization.h)
description: Ends the job and saves the transferred files on the client.
ms.assetid: A3706DBA-C44E-4F7A-A787-62FB436706FC
keywords:</p>
<ul>
<li>Complete method</li>
<li>Complete method, IBackgroundCopyJob interface</li>
<li>IBackgroundCopyJob interface, Complete method
topic_type:</li>
<li>apiref
api_name:</li>
<li>IBackgroundCopyJob.Complete
api_location:</li>
<li>dosvc.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>IBackgroundCopyJob::Complete method</h1>
<p>Ends the job and saves the transferred files on the client.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT Complete();
</code></pre>
<h2>Parameters</h2>
<p>This method has no parameters.</p>
<h2>Return value</h2>
<p>This method returns the following <strong>HRESULT</strong> values. The method can also return errors related to renaming the temporary copies of the transferred files to their given names.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>All files transferred successfully.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DO_E_INVALID_STATE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>For downloads, the state of the job cannot be BG_JOB_STATE_CANCELLED or BG_JOB_STATE_ACKNOWLEDGED. <!-- raw HTML omitted --> For uploads, the state of the job must be BG_JOB_STATE_TRANSFERRED.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>All of the files have been successfully transferred if the job's state is <strong>BG_JOB_STATE_TRANSFERRED</strong>. To check the state of the job, call the <a href="ibackgroundcopyjob-getstate.html"><strong>IBackgroundCopyJob::GetState</strong></a> method. You can also implement the <a href="ibackgroundcopycallback.html"><strong>IBackgroundCopyCallback</strong></a> interface to receive notification when all of the files have been transferred to the client.</p>
<p>Delivery Optimization retains jobs that are less than 30 days only. All older jobs will be removed. Delivery Optimization does not support the <a href="https://www.bing.com/search?q=JobInactivityTimeout">JobInactivityTimeout</a> Group Policy.</p>
<p>For download jobs, you can call the <strong>Complete</strong> method at anytime during the transfer process; however, only files that were successfully transferred to the client before calling this method are saved. For example, if you call the <strong>Complete</strong> method while Delivery Optimization is processing the third of five files, only the first two files are saved. To determine which files have been transferred, call the <a href="ibackgroundcopyfile-getprogress-method.html"><strong>IBackgroundCopyFile::GetProgress</strong></a> method and compare the <strong>BytesTransferred</strong> member to the <strong>BytesTotal</strong> member of the <a href="bg-file-progress.html"><strong>BG_FILE_PROGRESS</strong></a> structure.</p>
<p>For upload jobs, you can call the <strong>Complete</strong> method only when the job's state is <strong>BG_JOB_STATE_TRANSFERRED</strong>.</p>
<p>The owner of the file is the user who made the call. For example, if an administrator completes someone else's job, the administrator not the owner of the job owns the file.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 10, version 1709 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server, version 1709 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Deliveryoptimization.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IDL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->DeliveryOptimization.idl<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Dosvc.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Dosvc.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IBackgroundCopyJob is defined as 37668D37-507E-4160-9316-26306D150B12<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="ibackgroundcopyjob-.html"><strong>IBackgroundCopyJob</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="ibackgroundcopyjob-cancel.html"><strong>IBackgroundCopyJob::Cancel</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="ibackgroundcopyjob-getstate.html"><strong>IBackgroundCopyJob::GetState</strong></a></p>
<!-- raw HTML omitted -->
</body>
