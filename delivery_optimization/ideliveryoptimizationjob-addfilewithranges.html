<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IDeliveryOptimizationJob::AddFileWithRanges method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IDeliveryOptimizationJob AddFileWithRanges method (Deliveryoptimization.h)
description: Adds a file to a download job and specifies the ranges of the file you want to download.
ms.assetid: 23F0A39F-670F-4030-A3B3-4F9277FFA8AB
keywords:</p>
<ul>
<li>AddFileWithRanges method</li>
<li>AddFileWithRanges method, IDeliveryOptimizationJob interface</li>
<li>IDeliveryOptimizationJob interface, AddFileWithRanges method
topic_type:</li>
<li>apiref
api_name:</li>
<li>IDeliveryOptimizationJob.AddFileWithRanges
api_location:</li>
<li>dosvc.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>IDeliveryOptimizationJob::AddFileWithRanges method</h1>
<p>Adds a file to a download job and specifies the ranges of the file you want to download.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT AddFileWithRanges(
  [in]           LPCWSTR       fileId,
  [in]           LPCWSTR       remoteUrl,
  [in]           LPCWSTR       localName,
  [in, optional] DWORD         rangeCount,
  [in, optional] BG_FILE_RANGE ranges[],
  [in, optional] ULONG64       fileSize
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>fileId</em> [in]</p>
<!-- raw HTML omitted -->
<p>Null terminated string that s an unique identifier of the published content. For non-published content, this can be any unique string that caller can use to identify files within a job.</p>
<!-- raw HTML omitted -->
<p><em>remoteUrl</em> [in]</p>
<!-- raw HTML omitted -->
<p>Null-terminated string that contains the name of the file on the server.</p>
<!-- raw HTML omitted -->
<p><em>localName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Null-terminated string that contains the name of the file on the client.</p>
<!-- raw HTML omitted -->
<p><em>rangeCount</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Number of elements in <em>Ranges</em>.</p>
<!-- raw HTML omitted -->
<p><em>ranges</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Array of one or more <a href="/windows/desktop/api/bits2_0/ns-bits2_0-bg_file_range"><strong>BG_FILE_RANGE</strong></a> structures that specify the ranges to download. Do not specify duplicate or overlapping ranges.</p>
<!-- raw HTML omitted -->
<p><em>fileSize</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Size of the file in bytes. Pass in <strong>DO_UNKNOWN_FILE_SIZE</strong> if size is not known to the caller application.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method returns the following return values, as well as others.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->S_OK<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Success.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->E_INVALIDARG<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>The local file name is NULL or empty string. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->E_ACCESSDENIED<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>User does not have permission to write to the specified directory on the client.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->DO_E_INVALID_RANGE<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>One of the ranges is invalid. For example, InitialOffset is set to <!-- raw HTML omitted -->BG_LENGTH_TO_EOF<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>DO_E_OVERLAPPING_RANGES</strong><!-- raw HTML omitted --></td>
<td>You cannot specify duplicate or overlapping ranges. <!-- raw HTML omitted --> <strong>Note:</strong> The ranges are sorted by the offset of the value, not the length. If ranges are entered that have the same offset, but are in reverse order, then this error will be returned. For example, if 100.5 and 100.0 are entered in that order, then you will not be able to add the file to the job.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->DO_E_INVALID_STATE<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>The state of the job cannot be <!-- raw HTML omitted -->BG_JOB_STATE_CANCELLED<!-- raw HTML omitted --> or <!-- raw HTML omitted -->BG_JOB_STATE_ACKNOWLEDGED<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 10, version 1709 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server, version 1709 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Deliveryoptimization.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IDL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->DeliveryOptimization.idl<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Dosvc.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Dosvc.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IDeliveryOptimizationJob is defined as EE2584CF-A69C-4848-B633-2649962B3EF7<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="ideliveryoptimizationjob.html"><strong>IDeliveryOptimizationJob</strong></a></p>
<!-- raw HTML omitted -->
</body>
