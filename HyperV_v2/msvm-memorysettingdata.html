<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Msvm_MemorySettingData class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Represents the configured state of the memory for a virtual machine.
ms.assetid: 4B6FEE50-1C5F-4F41-B14A-E10B40400A1B
title: Msvm_MemorySettingData class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Msvm_MemorySettingData</li>
<li>Msvm_MemorySettingData.InstanceID</li>
<li>Msvm_MemorySettingData.Caption</li>
<li>Msvm_MemorySettingData.Description</li>
<li>Msvm_MemorySettingData.ElementName</li>
<li>Msvm_MemorySettingData.ResourceType</li>
<li>Msvm_MemorySettingData.OtherResourceType</li>
<li>Msvm_MemorySettingData.ResourceSubType</li>
<li>Msvm_MemorySettingData.PoolID</li>
<li>Msvm_MemorySettingData.ConsumerVisibility</li>
<li>Msvm_MemorySettingData.HostResource</li>
<li>Msvm_MemorySettingData.HugePagesEnabled</li>
<li>Msvm_MemorySettingData.AllocationUnits</li>
<li>Msvm_MemorySettingData.VirtualQuantity</li>
<li>Msvm_MemorySettingData.Reservation</li>
<li>Msvm_MemorySettingData.Limit</li>
<li>Msvm_MemorySettingData.Weight</li>
<li>Msvm_MemorySettingData.AutomaticAllocation</li>
<li>Msvm_MemorySettingData.AutomaticDeallocation</li>
<li>Msvm_MemorySettingData.Parent</li>
<li>Msvm_MemorySettingData.Connection</li>
<li>Msvm_MemorySettingData.Address</li>
<li>Msvm_MemorySettingData.MappingBehavior</li>
<li>Msvm_MemorySettingData.AddressOnParent</li>
<li>Msvm_MemorySettingData.VirtualQuantityUnits</li>
<li>Msvm_MemorySettingData.DynamicMemoryEnabled</li>
<li>Msvm_MemorySettingData.TargetMemoryBuffer</li>
<li>Msvm_MemorySettingData.IsVirtualized</li>
<li>Msvm_MemorySettingData.SwapFilesInUse</li>
<li>Msvm_MemorySettingData.MaxMemoryBlocksPerNumaNode</li>
<li>Msvm_MemorySettingData.SgxSize</li>
<li>Msvm_MemorySettingData.SgxEnabled
api_type:</li>
<li>DllExport
api_location:</li>
<li>vmms.exe</li>
</ul>
<hr />
<h1>Msvm_MemorySettingData class</h1>
<p>Represents the configured state of the memory for a virtual machine.</p>
<p>The following syntax is simplified Managed Object Format (MOF) code, and it includes all of the inherited properties.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[Dynamic, Provider(&quot;VmmsWmiInstanceAndMethodProvider&quot;), AMENDMENT]
class Msvm_MemorySettingData : CIM_ResourceAllocationSettingData
{
  string  InstanceID;
  string  Caption = &quot;Memory Default Settings&quot;;
  string  Description = &quot;Describes the default settings for the memory resources.&quot;;
  string  ElementName;
  uint16  ResourceType = 4;
  string  OtherResourceType;
  string  ResourceSubType = &quot;Microsoft:Hyper-V:Memory&quot;;
  string  PoolID;
  uint16  ConsumerVisibility;
  string  HostResource[];
  boolean HugePagesEnabled;
  string  AllocationUnits = &quot;byte * 2^20&quot;;
  uint64  VirtualQuantity;
  uint64  Reservation;
  uint64  Limit;
  uint32  Weight;
  boolean AutomaticAllocation = True;
  boolean AutomaticDeallocation = True;
  string  Parent;
  string  Connection[];
  string  Address;
  uint16  MappingBehavior;
  string  AddressOnParent;
  string  VirtualQuantityUnits = &quot;byte * 2^20&quot;;
  boolean DynamicMemoryEnabled;
  uint32  TargetMemoryBuffer;
  boolean IsVirtualized = True;
  boolean SwapFilesInUse;
  uint64  MaxMemoryBlocksPerNumaNode;
  uint64  SgxSize;
  boolean SgxEnabled;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>Msvm_MemorySettingData</strong> class has these types of members:</p>
<ul>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Properties</h3>
<p>The <strong>Msvm_MemorySettingData</strong> class has these properties.</p>
<h4>Address</h4>
<p>Data type: <strong>string</strong></p>
<p>Access type: read-only</p>
<p>The address of the resource. For example, the MAC address of an Ethernet port. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>AddressOnParent</h4>
<p>Data type: <strong>string</strong></p>
<p>Access type: read-only</p>
<p>Describes the address of this resource in the context of the parent. The <strong>Parent</strong> and <strong>AddressOnParent</strong> properties are used to describe the controller relationship as well as the ordering of devices on a controller. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>AllocationUnits</h4>
<p>Data type: <strong>string</strong></p>
<p>Access type: read-only</p>
<p>The units of allocation used by the <strong>Reservation</strong> and <strong>Limit</strong> properties. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>AutomaticAllocation</h4>
<p>Data type: <strong>boolean</strong></p>
<p>Access type: read-only</p>
<p>Indicates whether the resource will be automatically allocated. For example, when this property is set to <strong>True</strong> and the consuming virtual machine is powered on, this resource would be allocated. A value of <strong>False</strong> indicates the resource must be explicitly allocated. For example, the setting may represent removable media (such as a CD-ROM or a floppy disk) where at startup, the media is not present. An explicit operation is required to allocate the resource. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>AutomaticDeallocation</h4>
<p>Data type: <strong>boolean</strong></p>
<p>Access type: read-only</p>
<p>Indicates whether the resource will be automatically allocated. For example when this property is set to <strong>True</strong> and the consuming virtual machine is powered on, this resource would be allocated. When this property is <strong>False</strong>, the resource must be explicitly allocated. For example, the setting may represent removable media (such as a CD-ROM or a floppy disk) where at startup, the media is not present. An explicit operation is required to allocate the resource. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>Caption</h4>
<p>Data type: <strong>string</strong></p>
<p>Access type: read-only</p>
<p>Qualifiers: <strong>MaxLen</strong> (64)</p>
<p>A short description of the object. This property is inherited from <a href="/previous-versions/windows/desktop/iscsitarg/cim-managedelement"><strong>CIM_ManagedElement</strong></a>.</p>
<h4>Connection</h4>
<p>Data type: <strong>string</strong> array</p>
<p>Access type: read-only</p>
<p>The device to which this resource is connected. For example, a named network or switch port. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>ConsumerVisibility</h4>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: read-only</p>
<p>Describes the consumers visibility to the allocated resource. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>Description</h4>
<p>Data type: <strong>string</strong></p>
<p>Access type: read-only</p>
<p>A description of the object. This property is inherited from <a href="/previous-versions/windows/desktop/iscsitarg/cim-managedelement"><strong>CIM_ManagedElement</strong></a>.</p>
<h4>DynamicMemoryEnabled</h4>
<p>Data type: <strong>boolean</strong></p>
<p>Access type: read-only</p>
<p>Indicates whether dynamic memory is enabled for the virtual machine.</p>
<h4>ElementName</h4>
<p>Data type: <strong>string</strong></p>
<p>Access type: read-only</p>
<p>A display name for the object. This property is inherited from <a href="/previous-versions//cc136911(v=vs.85)"><strong>CIM_SettingData</strong></a>.</p>
<h4>HostResource</h4>
<p>Data type: <strong>string</strong> array</p>
<p>Access type: read-only</p>
<p>The first element of this array contains a reference to the underlying host resource to be assigned. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>, but it is not used.</p>
<h4>HugePagesEnabled</h4>
<p>Data type: <strong>boolean</strong></p>
<p>Access type: read-only</p>
<p>Whether the memory is backed by 1GB pages or not.</p>
<h4>InstanceID</h4>
<p>Data type: <strong>string</strong></p>
<p>Access type: read-only</p>
<p>Qualifiers: <strong>Key</strong></p>
<p>Uniquely identifies an instance of this class. This property is inherited from <a href="/previous-versions/windows/desktop/iscsitarg/cim-managedelement"><strong>CIM_ManagedElement</strong></a>.</p>
<h4>IsVirtualized</h4>
<p>Data type: <strong>boolean</strong></p>
<p>Access type: read-only</p>
<p>Indicates whether this device is virtualized or passed through. When set to <strong>False</strong>, the underlying or host resource is used. At least one item should be present in the <strong>DeviceID</strong> property. When set to <strong>True</strong>, the resource is virtualized and may not map directly to an underlying/host resource. Some implementations may support specific assignment for virtualized resources, in which case the host resources are exposed by using the <strong>DeviceID</strong> property. This property is always set to <strong>True</strong>.</p>
<h4>Limit</h4>
<p>Data type: <strong>uint64</strong></p>
<p>Access type: read-only</p>
<p>The maximum amount of memory that may be consumed by the virtual machine. For a virtual machine with dynamic memory enabled, this represents the maximum memory setting. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>MappingBehavior</h4>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: read-only</p>
<p>Specifies how this resource maps to underlying resources. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>MaxMemoryBlocksPerNumaNode</h4>
<p>Data type: <strong>uint64</strong></p>
<p>Access type: read-only</p>
<p>The maximum amount of memory that can be observed within the virtual machine as belonging to a single NUMA node.</p>
<h4>OtherResourceType</h4>
<p>Data type: <strong>string</strong></p>
<p>Access type: read-only</p>
<p>A string that describes the resource type when a well-defined value is not available and <strong>ResourceType</strong> has the value &quot;Other&quot;. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>Parent</h4>
<p>Data type: <strong>string</strong></p>
<p>Access type: read-only</p>
<p>The parent of the resource. For example, a controller for the current allocation. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>PoolID</h4>
<p>Data type: <strong>string</strong></p>
<p>Access type: read-only</p>
<p>The identifier of the resource pool from which this resource was allocated. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>Reservation</h4>
<p>Data type: <strong>uint64</strong></p>
<p>Access type: read-only</p>
<p>Specifies the amount of memory guaranteed to be available for this virtual machine. For a virtual machine with dynamic memory enabled, this represents the minimum memory setting. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>ResourceSubType</h4>
<p>Data type: <strong>string</strong></p>
<p>Access type: read-only</p>
<p>A string that describes an implementation specific subtype for this resource. For example, this may be used to distinguish different models of the same resource type. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>ResourceType</h4>
<p>Data type: <strong>uint16</strong></p>
<p>Access type: read-only</p>
<p>The type of resource that this allocation setting represents. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>, and it is always set to 4 (Memory).</p>
<h4>SgxEnabled</h4>
<p>Data type: <strong>boolean</strong></p>
<p>Access type: read-only</p>
<p>Indicates if SGX is enabled.</p>
<blockquote>
<p>[!NOTE]
This property was added in Windows 10, version 1703.</p>
</blockquote>
<h4>SgxSize</h4>
<p>Data type: <strong>uint64</strong></p>
<p>Access type: read-only</p>
<p>The amount of SGX memory to allocate for the VM, in MB.</p>
<blockquote>
<p>[!NOTE]<br />
This property was added in Windows 10, version 1703.</p>
</blockquote>
<h4>SwapFilesInUse</h4>
<p>Data type: <strong>boolean</strong></p>
<p>Access type: read-only</p>
<p><strong>true</strong> if second level paging is active; otherwise, <strong>false</strong>.</p>
<h4>TargetMemoryBuffer</h4>
<p>Data type: <strong>uint32</strong></p>
<p>Access type: read-only</p>
<p>Defines the amount of extra memory that should be reserved for a virtual machine at runtime, as a percentage of the total memory that the virtual machine is thought to need. This only applies to virtual machines with dynamic memory enabled.</p>
<p>This property can be in the range of 5 to 2000.</p>
<h4>VirtualQuantity</h4>
<p>Data type: <strong>uint64</strong></p>
<p>Access type: read-only</p>
<p>The total amount of RAM in the virtual machine, as seen by the guest operating system. For a virtual machine with dynamic memory enabled, this represents the initial memory available at startup. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>VirtualQuantityUnits</h4>
<p>Data type: <strong>string</strong></p>
<p>Access type: read-only</p>
<p>Specifies the unit of measurement for this resource allocation. The value of this property must be a legal value of the Programmatic Units qualifier as defined in Annex C.1 of DSP0004 V2.5 or later. This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h4>Weight</h4>
<p>Data type: <strong>uint32</strong></p>
<p>Access type: read-only</p>
<p>Defines the memory allocation weighting value for each virtual machine. After all reserves have been met, the remaining memory of the hosting platform will be allocated to virtual machines based on their relative weights (not to exceed the value specified by the <strong>Limit</strong> property). This property is inherited from <a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a>.</p>
<h2>Remarks</h2>
<p>Access to the <strong>Msvm_MemorySettingData</strong> class might be restricted by UAC Filtering. For more information, see <a href="/windows/desktop/WmiSdk/user-account-control-and-wmi">User Account Control and WMI</a>.</p>
<h2>Examples</h2>
<pre lang="powershell"><code>function WaitForResult
{
  param($result)
  if ($result.ReturnValue -eq 4096)
  {
    while($true)
    {
      $result.Job
      if ($result.Job -ne $null)
      {
        if ($result.Job.JobState -gt 4)
        {
          return $result.Job.ErrorCode
        }
      }
      start-sleep 1
    }
  }
  else
  {
    return $result.ReturnValue
  }
}

if ($($args.count) -ne 2)
{
  Write-Host &quot;EnableHugePages.ps1 VMName SizeInMB&quot;
  return
}

$vmName = $args[0]
$sizeInMB = $args[1]
 
$namespace = &quot;root\virtualization\v2&quot;
$vm = Get-WmiObject -class MSVM_ComputerSystem -filter &quot;ElementName='$vmName'&quot; -namespace $namespace
$settings = Get-WmiObject -query &quot;Associators of {$vm} where ResultClass = Msvm_VirtualSystemSettingData&quot; -namespace $namespace
$vmSettings = $settings | ? VirtualSystemType -eq &quot;Microsoft:Hyper-V:System:Realized&quot;
$memorySettings = Get-WmiObject -query &quot;Associators of {$vmSettings} where ResultClass = Msvm_MemorySettingData&quot; -namespace $namespace

$memorySettings.MaxMemoryBlocksPerNumaNode = $sizeInMB
$memorySettings.Reservation = $sizeInMB
$memorySettings.Limit = $sizeInMB
$memorySettings.VirtualQuantity = $sizeInMB
$memorySettings.HugePagesEnabled = $True

$vmSvc = Get-WmiObject -class Msvm_VirtualSystemManagementService -namespace $namespace
$res = $vmSvc.ModifyResourceSettings($memorySettings.GetText(2))
if (WaitForResult($res) -ne 0)
{
  Write-Host &quot;Failed.&quot;
}
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 8 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\Virtualization\V2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td>WindowsVirtualization.V2.mof</td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td>Vmms.exe</td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<ul>
<li><a href="cim-resourceallocationsettingdata.html"><strong>CIM_ResourceAllocationSettingData</strong></a></li>
<li><a href="/previous-versions/windows/desktop/clushyperv/cim-resourceallocationsettingdata"><strong>CIM_ResourceAllocationSettingData</strong></a></li>
<li><a href="memory-classes.html">Memory classes</a></li>
</ul>
</body>
