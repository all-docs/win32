<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CreateReplicationRelationship method of the Msvm_ReplicationService class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Creates a new replication relationship for a virtual machine. When a client calls this method for a replica virtual machine, it extends the replication relationship to the specified provider.
ms.assetid: 44d3b5aa-46c2-4fe9-9a1d-6ee699d3640d
title: CreateReplicationRelationship method of the Msvm_ReplicationService class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Msvm_ReplicationService.CreateReplicationRelationship
api_type:</li>
<li>COM
api_location:</li>
<li>vmms.exe</li>
</ul>
<hr />
<h1>CreateReplicationRelationship method of the Msvm_ReplicationService class</h1>
<p>Creates a new replication relationship for a virtual machine. When a client calls this method for a replica virtual machine, it extends the replication relationship to the specified provider.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 CreateReplicationRelationship(
  [in]  CIM_ComputerSystem REF ComputerSystem,
  [in]  string                 ReplicationSettingData,
  [out] CIM_ConcreteJob    REF Job
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>ComputerSystem</em> [in]</p>
<!-- raw HTML omitted -->
<p>A reference to a <a href="/windows/desktop/CIMWin32Prov/cim-computersystem"><strong>CIM_ComputerSystem</strong></a> instance that represents the virtual machine for which the replication should be enabled.</p>
<!-- raw HTML omitted -->
<p><em>ReplicationSettingData</em> [in]</p>
<!-- raw HTML omitted -->
<p>A string representation of an instance of the <a href="msvm-replicationsettingdata.html"><strong>Msvm_ReplicationSettingData</strong></a> class that defines the replication settings for the new replication relationship to be created for the virtual machine.</p>
<!-- raw HTML omitted -->
<p><em>Job</em> [out]</p>
<!-- raw HTML omitted -->
<p>If the operation is performed asynchronously, this method will return 4096, and this parameter will contain a reference to an object derived from <a href="/previous-versions//cc136808(v=vs.85)"><strong>CIM_ConcreteJob</strong></a>.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method returns one of the following values.</p>
<!-- raw HTML omitted -->
<p><strong>Completed with No Error</strong> (0)</p>
<!-- raw HTML omitted -->
<p><strong>Method Parameters Checked - Job Started</strong> (4096)</p>
<!-- raw HTML omitted -->
<p><strong>Failed</strong> (32768)</p>
<!-- raw HTML omitted -->
<p><strong>Access Denied</strong> (32769)</p>
<!-- raw HTML omitted -->
<p><strong>Not Supported</strong> (32770)</p>
<!-- raw HTML omitted -->
<p><strong>Status is unknown</strong> (32771)</p>
<!-- raw HTML omitted -->
<p><strong>Timeout</strong> (32772)</p>
<!-- raw HTML omitted -->
<p><strong>Invalid parameter</strong> (32773)</p>
<!-- raw HTML omitted -->
<p><strong>System is in use</strong> (32774)</p>
<!-- raw HTML omitted -->
<p><strong>Invalid state for this operation</strong> (32775)</p>
<!-- raw HTML omitted -->
<p><strong>Incorrect data type</strong> (32776)</p>
<!-- raw HTML omitted -->
<p><strong>System is not available</strong> (32777)</p>
<!-- raw HTML omitted -->
<p><strong>Out of memory</strong> (32778)</p>
<!-- raw HTML omitted -->
<p><strong>File not found</strong> (32779)</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p><strong>CreateReplicationRelationship</strong> takes an <a href="msvm-replicationsettingdata.html"><strong>Msvm_ReplicationSettingData</strong></a> instance (FRSD) as input. The associated FRSD for the virtual machine as host-to-host provider is the default choice. Input FRSD is validated for valid settings for each property for the default provider. This table summarizes the validation differences with respect to the external provider.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>External providers</th>
</tr>
</thead>
<tbody>
<tr>
<td>ReplicationProvider</td>
<td>Same as default provider</td>
</tr>
<tr>
<td>AuthenticationType</td>
<td>Ignored</td>
</tr>
<tr>
<td>CertificateThumbPrint</td>
<td>Ignored</td>
</tr>
<tr>
<td>RootCertificateThumbPrint (RO)</td>
<td>Ignored</td>
</tr>
<tr>
<td>CompressionEnabled</td>
<td>Same as default provider</td>
</tr>
<tr>
<td>BypassProxyServer</td>
<td>Same as default provider</td>
</tr>
<tr>
<td>RecoveryConnectionPoint</td>
<td>Ignored* (may change if provider has requirement)</td>
</tr>
<tr>
<td>RecoveryHostSystem (RO)</td>
<td>Ignored</td>
</tr>
<tr>
<td>PrimaryConnectionPoint (RO)</td>
<td>Same as default provider</td>
</tr>
<tr>
<td>PrimaryHostSystem (RO)</td>
<td>Same as default provider</td>
</tr>
<tr>
<td>RecoveryServerPortNumber</td>
<td>Ignored* (may change if provider has requirement)</td>
</tr>
<tr>
<td>ReplicateHostKvpItems</td>
<td>Ignored</td>
</tr>
<tr>
<td>ApplicationConsistentSnapshotInterval</td>
<td>Same as default provider</td>
</tr>
<tr>
<td>RecoveryHistory</td>
<td>Same as default provider</td>
</tr>
<tr>
<td>IncludedDisks[]</td>
<td>Same as default provider</td>
</tr>
<tr>
<td>AutoResynchronizeEnabled</td>
<td>Same as default provider</td>
</tr>
<tr>
<td>AutoResynchronizeIntervalStart</td>
<td>Same as default provider</td>
</tr>
<tr>
<td>AutoResynchronizeIntervalEnd</td>
<td>Same as default provider</td>
</tr>
<tr>
<td>EnableWriteOrderPreservationAcrossDisks (Deprecated)</td>
<td>Same as default provider</td>
</tr>
<tr>
<td>ReplicationInterval</td>
<td>Same as default provider</td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 8 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\Virtualization\V2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WindowsVirtualization.V2.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Vmms.exe<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="msvm-replicationservice.html"><strong>Msvm_ReplicationService</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="removereplicationrelationshipex-msvm-replicationservice.html"><strong>RemoveReplicationRelationshipEx</strong></a></p>
<!-- raw HTML omitted -->
</body>
