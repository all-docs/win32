<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CalculateVideoMemoryRequirements method of the Msvm_Synth3dVideoPool class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Calculates the amount of video memory required for a RemoteFX virtual machine.
ms.assetid: F8C30601-EDA3-47F1-A717-9FE7E9DB8F62
title: CalculateVideoMemoryRequirements method of the Msvm_Synth3dVideoPool class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Msvm_Synth3dVideoPool.CalculateVideoMemoryRequirements
api_type:</li>
<li>COM
api_location:</li>
<li>vmms.exe</li>
</ul>
<hr />
<h1>CalculateVideoMemoryRequirements method of the Msvm_Synth3dVideoPool class</h1>
<p>Calculates the amount of video memory required for a RemoteFX virtual machine.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 CalculateVideoMemoryRequirements(
  [in]  uint32 monitorResolution,
  [in]  uint32 numberOfMonitors,
  [out] uint64 requiredVideoMemory
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>monitorResolution</em> [in]</p>
<!-- raw HTML omitted -->
<p>The maximum monitor resolution for the virtual machine. This must be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The maximum resolution is 1024   768.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The maximum resolution is 1280   1024.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The maximum resolution is 1600   1200.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->3<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The maximum resolution is 1920   1200.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>numberOfMonitors</em> [in]</p>
<!-- raw HTML omitted -->
<p>The maximum number of monitors for the virtual machine. The minimum number of monitors is one and the maximum is dependent upon the maximum screen resolution. The following table defines the maximum number of monitors allowed for different resolutions.</p>
<table>
<thead>
<tr>
<th>Resolution</th>
<th>Maximum monitors</th>
</tr>
</thead>
<tbody>
<tr>
<td>1024   768<!-- raw HTML omitted --></td>
<td>4<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>1280   1024<!-- raw HTML omitted --></td>
<td>4<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>1600   1200<!-- raw HTML omitted --></td>
<td>3<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>1920   1200<!-- raw HTML omitted --></td>
<td>2<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>requiredVideoMemory</em> [out]</p>
<!-- raw HTML omitted -->
<p>Receives the required amount of video memory, in bytes.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns a status code, which can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Completed with No Error</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Method Parameters Checked - Job Started</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->4096<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Job started.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Failed</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32768<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Failed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Access Denied</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32769<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Access denied.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Not Supported</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32770<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Status is unknown</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32771<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Status is unknown.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Timeout</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32772<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Timeout.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Invalid parameter</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32773<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A parameter is not valid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>System is in used</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32774<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>System is in use.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Invalid state for this operation</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32775<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The state is not valid for this operation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Incorrect data type</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32776<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Incorrect data type.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>System is not available</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32777<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>System is not available.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Out of memory</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32778<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Out of memory.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>This method is typically called on the host system to determine if the host has enough available video memory to host a RemoteFX virtual machine. To do this, you compare the amount of video memory calculated by this method with the <a href="msvm-physicalgpuinfo.html"><strong>Msvm_PhysicalGPUInfo.AvailableVideoMemory</strong></a> property to determine if the host machine has enough available video memory. You can use this information to determine if a virtual machine can be moved to the host system.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 8 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\Virtualization\V2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WindowsVirtualization.V2.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Vmms.exe<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="msvm-physicalgpuinfo.html"><strong>Msvm_PhysicalGPUInfo</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="msvm-synth3dvideopool.html"><strong>Msvm_Synth3dVideoPool</strong></a></p>
<!-- raw HTML omitted -->
</body>
