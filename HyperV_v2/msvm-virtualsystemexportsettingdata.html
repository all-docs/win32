<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Msvm_VirtualSystemExportSettingData class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Provides additional information to be used with the ExportSystemDefinition method of the Msvm_VirtualSystemManagementService class.
ms.assetid: 86396A76-83EC-476E-86A9-83861A002152
title: Msvm_VirtualSystemExportSettingData class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Msvm_VirtualSystemExportSettingData</li>
<li>Msvm_VirtualSystemExportSettingData.CaptureLiveState</li>
<li>Msvm_VirtualSystemExportSettingData.InstanceID</li>
<li>Msvm_VirtualSystemExportSettingData.Caption</li>
<li>Msvm_VirtualSystemExportSettingData.Description</li>
<li>Msvm_VirtualSystemExportSettingData.ElementName</li>
<li>Msvm_VirtualSystemExportSettingData.CopySnapshotConfiguration</li>
<li>Msvm_VirtualSystemExportSettingData.CopyVmRuntimeInformation</li>
<li>Msvm_VirtualSystemExportSettingData.CopyVmStorage</li>
<li>Msvm_VirtualSystemExportSettingData.CreateVmExportSubdirectory</li>
<li>Msvm_VirtualSystemExportSettingData.SnapshotVirtualSystem</li>
<li>Msvm_VirtualSystemExportSettingData.BackupIntent</li>
<li>Msvm_VirtualSystemExportSettingData.ExportForLiveMigration</li>
<li>Msvm_VirtualSystemExportSettingData.DisableDifferentialOfIgnoredStorage</li>
<li>Msvm_VirtualSystemExportSettingData.ExcludedVirtualHardDisks</li>
<li>Msvm_VirtualSystemExportSettingData.DifferentialBackupBase
api_type:</li>
<li>DllExport
api_location:</li>
<li>vmms.exe</li>
</ul>
<hr />
<h1>Msvm_VirtualSystemExportSettingData class</h1>
<p>Provides additional information to be used with the <a href="exportsystemdefinition-msvm-virtualsystemmanagementservice.html"><strong>ExportSystemDefinition</strong></a> method of the <a href="msvm-virtualsystemmanagementservice.html"><strong>Msvm_VirtualSystemManagementService</strong></a> class.</p>
<p>The following syntax is simplified Managed Object Format (MOF) code, and it includes all of the inherited properties.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[Dynamic, Provider(&quot;VmmsWmiInstanceAndMethodProvider&quot;), AMENDMENT]
class Msvm_VirtualSystemExportSettingData : CIM_SettingData
{
  uint8   CaptureLiveState;
  string  InstanceID;
  string  Caption;
  string  Description;
  string  ElementName;
  uint8   CopySnapshotConfiguration;
  boolean CopyVmRuntimeInformation;
  boolean CopyVmStorage;
  boolean CreateVmExportSubdirectory;
  string  SnapshotVirtualSystem;
  uint8   BackupIntent;
  boolean ExportForLiveMigration;
  boolean DisableDifferentialOfIgnoredStorage;
  string  ExcludedVirtualHardDisks[];
  string  DifferentialBackupBase;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>Msvm_VirtualSystemExportSettingData</strong> class has these types of members:</p>
<ul>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Properties</h3>
<p>The <strong>Msvm_VirtualSystemExportSettingData</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>BackupIntent</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint8</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Indicates the intent on how the exported backup sets would be used.</p>
<blockquote>
<p>[!Note]<br />
This property was added in Windows 10 and Windows Server 2016.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>BackupIntentPreserveChain</strong> (0)</p>
<!-- raw HTML omitted -->
<p>All exported full and differential backup sets would be preserved as they are.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>BackupIntentMerge</strong> (1)</p>
<!-- raw HTML omitted -->
<p>The exported full and differential backup sets would be merged to synthesize full backup sets.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>Caption</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <strong>MaxLen</strong> (64)</p>
<!-- raw HTML omitted -->
<p>A short description of the object. This property is inherited from <a href="/previous-versions/windows/desktop/iscsitarg/cim-managedelement"><strong>CIM_ManagedElement</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>CaptureLiveState</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint8</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Indicates what state to capture if the target of the export is a running VM.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>CaptureCrashConsistentState</strong> (0)</p>
<!-- raw HTML omitted -->
<p>No saved state files will be exported for the running VM, placing it in a crash consistent state.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>CaptureSavedState</strong> (1)</p>
<!-- raw HTML omitted -->
<p>Saved state files for the running VM will be exported along with the VM configuration.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>CaptureAppConsistentState</strong> (2)</p>
<!-- raw HTML omitted -->
<p>Application-consistent state of the running VM will be exported.</p>
<blockquote>
<p>[!Note]<br />
Added in Windows 10 and Windows Server 2016.</p>
</blockquote>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>CopySnapshotConfiguration</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint8</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Indicates what snapshots are to be exported with the virtual machine.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ExportAllSnapshots</strong> (0)</p>
<!-- raw HTML omitted -->
<p>All snapshots will be exported with the virtual machine.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ExportNoSnapshots</strong> (1)</p>
<!-- raw HTML omitted -->
<p>No snapshots will be exported with the virtual machine.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ExportOneSnapshot</strong> (2)</p>
<!-- raw HTML omitted -->
<p>The snapshots identified by the <strong>SnapshotVirtualSystem</strong> property will be exported with the virtual machine. The <strong>CopyVmStorage</strong> and <strong>CopyVmRuntimeInformation</strong> properties are ignored, storage and run-time information is exported with the virtual machine, and any VHD differencing disks will be merged into a new VHD.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ExportOneSnapshotForBackup</strong> (3)</p>
<!-- raw HTML omitted -->
<p>The snapshot identified by the <strong>SnapshotVirtualSystem</strong> property will be exported for the purpose of backing up the VM. The exported configuration will use ID of the VM.</p>
<blockquote>
<p>[!Note]<br />
Added in Windows 10 and Windows Server 2016.</p>
</blockquote>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>CopyVmRuntimeInformation</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Indicates whether the virtual machine run-time information will be copied when the virtual machine is exported.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>True</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The virtual machine run-time information will be copied.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>False</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The virtual machine run-time information will not be copied.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><strong>CopyVmStorage</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Indicates whether the virtual machine storage will be copied when the virtual machine is exported.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>True</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The virtual machine storage will be copied.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>False</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The virtual machine storage will not be copied.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><strong>CreateVmExportSubdirectory</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Indicates whether a subdirectory with the name of the virtual machine will be created when the virtual machine is exported.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>True</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A subdirectory will be created.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>False</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A subdirectory will not be created.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><strong>Description</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>A description of the object. This property is inherited from <a href="/previous-versions/windows/desktop/iscsitarg/cim-managedelement"><strong>CIM_ManagedElement</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>DifferentialBackupBase</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Base for differential export. This is either path to a <a href="msvm-virtualsystemreferencepoint.html"><strong>Msvm_VirtualSystemReferencePoint</strong></a> instance that represents the reference point or path to a <a href="msvm-virtualsystemsettingdata.html"><strong>Msvm_VirtualSystemSettingData</strong></a> instance that represents the snapshot to be used as a base for differential export. If the <strong>CopySnapshotConfiguration</strong> property is not set to 3(<strong>ExportOneSnapshotForBackup</strong>), this property is ignored.</p>
<blockquote>
<p>[!Note]<br />
Added in Windows 10 and Windows Server 2016.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><strong>DisableDifferentialOfIgnoredStorage</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Indicates whether differencing disks will be created or not for storage ignored during export. By default this is set to false, which means that differencing disks are created for the storage that is not going to be copied over to the export destination.</p>
<blockquote>
<p>[!Note]<br />
Added in Windows 10, version 1709.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><strong>ElementName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>The display name for this instance. In addition, the display name can be used as an index property for a search or query. This property is inherited from <a href="/previous-versions//cc136911(v=vs.85)"><strong>CIM_SettingData</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>ExcludedVirtualHardDisks</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong> array</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Array of <a href="msvm-storageallocationsettingdata.html"><strong>Msvm_StorageAllocationSettingData</strong></a> (RASD) instance IDs that represent the virtual hard disks that are requested to be excluded from the export operation. If at least one of the supplied IDs is not a valid attached virtual hard disk, the operation will fail.</p>
<p>The virtual hard disks referenced by this property may be from the VM and/or from any of its snapshots. Exclusion of virtual hard disks is not supported when property <strong>CopySnapshotConfiguration</strong> is set to 0(ExportAllSnapshots).</p>
<p>Note that the RASD instance ID for virtual hard disks represents the location they are attached to, and excluding through this ID excludes all virtual hard disks attached in that location throughout the virtual machine's snapshot tree, regardless of them really being a valid virtual hard disk chain.</p>
<blockquote>
<p>[!Note]<br />
Added in Windows 10, version 1709.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><strong>ExportForLiveMigration</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>boolean</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Indicates whether the exported VM is intended to be used in live migration.</p>
<blockquote>
<p>[!Note]<br />
Added in Windows 10, version 1703 and Windows Server 2016.</p>
</blockquote>
<!-- raw HTML omitted -->
<p><strong>InstanceID</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <strong>Key</strong></p>
<!-- raw HTML omitted -->
<p>Within the scope of the instantiating Namespace, opaquely and uniquely identifies an instance of this class. This property is inherited from <a href="/previous-versions//cc136911(v=vs.85)"><strong>CIM_SettingData</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>SnapshotVirtualSystem</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Path to a <a href="msvm-virtualsystemsettingdata.html"><strong>Msvm_VirtualSystemSettingData</strong></a> instance that represents the snapshot to be exported with the virtual machine. If the <strong>CopySnapshotConfiguration</strong> property is not set to 2 (ExportOneSnapshot), this property is ignored.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>Access to the <strong>Msvm_VirtualSystemExportSettingData</strong> class might be restricted by UAC Filtering. For more information, see <a href="/windows/desktop/WmiSdk/user-account-control-and-wmi">User Account Control and WMI</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 8 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\Virtualization\V2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WindowsVirtualization.V2.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Vmms.exe<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cim-settingdata.html"><strong>CIM_SettingData</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="virtual-system-management-classes.html">Virtual System Management Classes</a></p>
<!-- raw HTML omitted -->
<p><a href="exportsystemdefinition-msvm-virtualsystemmanagementservice.html"><strong>ExportSystemDefinition</strong></a></p>
<!-- raw HTML omitted -->
</body>
