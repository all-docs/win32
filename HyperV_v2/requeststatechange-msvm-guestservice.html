<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Msvm_GuestService::RequestStateChange method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Requests that the state of the guest service be changed to the specified value.
ms.assetid: F2853BB3-4074-431C-9E10-26AA0757FE99
title: Msvm_GuestService::RequestStateChange method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Msvm_GuestService.RequestStateChange
api_type:</li>
<li>COM
api_location:</li>
<li>vmms.exe</li>
</ul>
<hr />
<h1>Msvm_GuestService::RequestStateChange method</h1>
<p>Requests that the state of the guest service be changed to the specified value.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>uint32 RequestStateChange(
  [in]  uint16              RequestedState,
  [out] CIM_ConcreteJob Job,
  [in]  datetime            TimeoutPeriod
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>RequestedState</em> [in]</p>
<!-- raw HTML omitted -->
<p>The new state. The info is placed in the <strong>RequestedState</strong> property of the instance if the return code of the <strong>RequestStateChange</strong> method is 0 or 4096. For more info, see the description of the <strong>EnabledState</strong> and <strong>RequestedState</strong> properties for the element. This must be one of the following values.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Enabled</strong> (2)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Disabled</strong> (3)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Shut Down</strong> (4)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Offline</strong> (6)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Test</strong> (7)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Defer</strong> (8)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Quiesce</strong> (9)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Reboot</strong> (10)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Reset</strong> (11)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>DMTF Reserved</strong> (..)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Vendor Reserved</strong> (32768..65535)</p>
<!-- raw HTML omitted -->
<p><em>Job</em> [out]</p>
<!-- raw HTML omitted -->
<p>An optional reference to a <a href="cim-concretejob.html"><strong>CIM_ConcreteJob</strong></a> object that is returned if the operation is executed asynchronously. If present, the returned reference can be used to monitor progress and obtain the result of the method.</p>
<!-- raw HTML omitted -->
<p><em>TimeoutPeriod</em> [in]</p>
<!-- raw HTML omitted -->
<p>A timeout period that specifies the maximum amount of time that the client expects the transition to the new state to take. The interval format must be used to specify the timeout period. A value of 0 or <strong>Null</strong> indicates that the client has no time requirements for the transition. If this property does not contain 0 or <strong>Null</strong> and the implementation does not support this parameter, a return code of 4098 (<strong>Use Of Timeout Parameter Not Supported</strong>) must be returned.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method returns one of the following values.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Completed with No Error</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Success.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Not supported</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Method Parameters Checked - Transition Started</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->4096<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The transition is asynchronous.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Use of Timeout Parameter Not Supported</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->4098<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Access Denied</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32769<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Access denied.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Invalid state for this operation</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32775<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The value specified in the <em>RequestedState</em> parameter is not supported.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 8.1 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 R2 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>\\Root\Virtualization\V2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WindowsVirtualization.V2.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Vmms.exe<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="msvm-guestservice.html"><strong>Msvm_GuestService</strong></a></p>
<!-- raw HTML omitted -->
</body>
