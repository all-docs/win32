<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>InitiateShutdown method of the Msvm_ShutdownComponent class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Initiates an operating system shutdown operation on the associated child virtual machine. If zero (0) is returned, then the shutdown was initiated successfully. Any other return code indicates an error condition.
ms.assetid: 946BBC62-5479-4AE0-8870-D0A07827B902
title: InitiateShutdown method of the Msvm_ShutdownComponent class (Winreg.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Msvm_ShutdownComponent.InitiateShutdown
api_type:</li>
<li>COM
api_location:</li>
<li>vmms.exe</li>
</ul>
<hr />
<h1>InitiateShutdown method of the Msvm_ShutdownComponent class</h1>
<p>Initiates an operating system shutdown operation on the associated child virtual machine. If zero (0) is returned, then the shutdown was initiated successfully. Any other return code indicates an error condition.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 InitiateShutdown(
  [in] boolean Force,
  [in] string  Reason
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Force</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>boolean</strong></p>
<p>A flag which, if <strong>True</strong>, forces applications to be closed despite having unsaved data.</p>
<!-- raw HTML omitted -->
<p><em>Reason</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>string</strong></p>
<p>The reason for the shutdown operation. This is a user-defined string.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p><strong>Completed with No Error</strong> (0)</p>
<!-- raw HTML omitted -->
<p><strong>Method Parameters Checked - Job Started</strong> (4096)</p>
<!-- raw HTML omitted -->
<p><strong>Failed</strong> (32768)</p>
<!-- raw HTML omitted -->
<p><strong>Access Denied</strong> (32769)</p>
<!-- raw HTML omitted -->
<p><strong>Not Supported</strong> (32770)</p>
<!-- raw HTML omitted -->
<p><strong>Status is unknown</strong> (32771)</p>
<!-- raw HTML omitted -->
<p><strong>Timeout</strong> (32772)</p>
<!-- raw HTML omitted -->
<p><strong>Invalid parameter</strong> (32773)</p>
<!-- raw HTML omitted -->
<p><strong>System is in used</strong> (32774)</p>
<!-- raw HTML omitted -->
<p><strong>Invalid state for this operation</strong> (32775)</p>
<!-- raw HTML omitted -->
<p><strong>Incorrect data type</strong> (32776)</p>
<!-- raw HTML omitted -->
<p><strong>System is not available</strong> (32777)</p>
<!-- raw HTML omitted -->
<p><strong>Out of memory</strong> (32778)</p>
<!-- raw HTML omitted -->
<p><strong>File not found</strong> (32779)</p>
<!-- raw HTML omitted -->
<p><strong>The system is not ready</strong> (32780)</p>
<!-- raw HTML omitted -->
<p><strong>The machine is locked and cannot be shut down without the force option</strong> (32781)</p>
<!-- raw HTML omitted -->
<p><strong>A system shutdown is in progress</strong> (32782)</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>Access to the <a href="msvm-shutdowncomponent.html"><strong>Msvm_ShutdownComponent</strong></a> class might be restricted by UAC Filtering. For more information, see <a href="/windows/desktop/WmiSdk/user-account-control-and-wmi">User Account Control and WMI</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 8 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\Virtualization\V2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winreg.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WindowsVirtualization.V2.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Vmms.exe<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="msvm-shutdowncomponent.html"><strong>Msvm_ShutdownComponent</strong></a></p>
<!-- raw HTML omitted -->
</body>
