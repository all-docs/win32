<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>RequestTPMStateChange method of the CIM_TPM class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Requests that the state of the TPM be changed to the value specified in the RequestedTPMState parameter.
ms.assetid: 7ad8bf4e-6263-45d5-8f33-fb842bbf1f1a
title: RequestTPMStateChange method of the CIM_TPM class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>CIM_TPM.RequestTPMStateChange
api_type:</li>
<li>COM
api_location:</li>
<li>vmms.exe</li>
</ul>
<hr />
<h1>RequestTPMStateChange method of the CIM_TPM class</h1>
<p>Requests that the state of the TPM be changed to the value specified in the <em>RequestedTPMState</em> parameter. If the method invocation completes successfully, the <strong>TPMState</strong> property shall be equal to the <strong>RequestedTPMState</strong> parameter. Invoking the <strong>RequestTPMStateChange</strong> method multiple times could result in earlier requests being overwritten or lost.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 RequestTPMStateChange(
  [in]  uint16              RequestedTPMState,
  [in]  string              AuthorizationToken,
  [out] CIM_ConcreteJob REF Job,
  [in]  datetime            TimeoutPeriod
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>RequestedTPMState</em> [in]</p>
<!-- raw HTML omitted -->
<p>The requested TPM states.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>S1 Enabled-Active-Owned</strong> (2)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>S2 Disabled-Active-Owned</strong> (3)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>S3 Enabled-Inactive-Owned</strong> (4)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>S4 Disabled-Inactive-Owned</strong> (5)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>S5 Enabled-Active-Unowned</strong> (6)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>S6 Disabled-Active-Unowned</strong> (7)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>S7 Enabled-Inactive-Unowned</strong> (8)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>S8 Disabled-Inactive-Unowned</strong> (9)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>DMTF Reserved</strong> (..)</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><strong>Vendor Reserved</strong> (32768..65535)</p>
<!-- raw HTML omitted -->
<p><em>AuthorizationToken</em> [in]</p>
<!-- raw HTML omitted -->
<p>Authorization token that may be required for the action to take effect. The <em>AuthorizationToken</em> parameter may be required to establish Physical Presence, or to pass the OwnerAuth, the TCG defined owner authorization password. In the case of OwnerAuth, the CIM_SharedCredential with non-null value of the CIM_SharedCredential.Secret may be required. The CIM_SharedCredential.Algorithm property may also be specified based on the property CIM_TPMCapabilities.SupportedPasswordAlgorithms.</p>
<!-- raw HTML omitted -->
<p><em>Job</em> [out]</p>
<!-- raw HTML omitted -->
<p>May contain a reference to the <a href="cim-concretejob.html"><strong>CIM_ConcreteJob</strong></a> created to track the state transition initiated by the method invocation.</p>
<!-- raw HTML omitted -->
<p><em>TimeoutPeriod</em> [in]</p>
<!-- raw HTML omitted -->
<p>A timeout period that specifies the maximum amount of time that the client expects the transition to the new state to take. The interval format must be used to specify the <em>TimeoutPeriod</em>. A value of 0 or a null parameter indicates that the client has no time requirements for the transition.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>On success, returns a 0 or 4096; otherwise, returns an error.</p>
<!-- raw HTML omitted -->
<p><strong>Completed with No Error</strong> (0)</p>
<!-- raw HTML omitted -->
<p><strong>Not Supported</strong> (1)</p>
<!-- raw HTML omitted -->
<p><strong>Unknown or Unspecified Error</strong> (2)</p>
<!-- raw HTML omitted -->
<p><strong>Cannot complete within Timeout Period</strong> (3)</p>
<!-- raw HTML omitted -->
<p><strong>Failed</strong> (4)</p>
<!-- raw HTML omitted -->
<p><strong>Invalid Parameter</strong> (5)</p>
<!-- raw HTML omitted -->
<p><strong>In Use</strong> (6)</p>
<!-- raw HTML omitted -->
<p><strong>DMTF Reserved</strong> (..)</p>
<!-- raw HTML omitted -->
<p><strong>Method Parameters Checked - Job Started</strong> (4096)</p>
<!-- raw HTML omitted -->
<p><strong>Invalid State Transition</strong> (4097)</p>
<!-- raw HTML omitted -->
<p><strong>Use of Timeout Parameter Not Supported</strong> (4098)</p>
<!-- raw HTML omitted -->
<p><strong>Busy</strong> (4099)</p>
<!-- raw HTML omitted -->
<p><strong>Method Reserved</strong> (4100..32767)</p>
<!-- raw HTML omitted -->
<p><strong>Vendor Specific</strong> (32768..65535)</p>
<!-- raw HTML omitted -->
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 10 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2016<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\virtualization\v2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WindowsVirtualization.V2.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Vmms.exe<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cim-tpm.html"><strong>CIM_TPM</strong></a></p>
<!-- raw HTML omitted -->
</body>
