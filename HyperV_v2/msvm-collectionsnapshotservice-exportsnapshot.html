<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ExportSnapshot method of the Msvm_CollectionSnapshotService class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Exports a snapshot collection of virtual computer systems to a file. The snapshot collection, its associated configuration settings, and its associated resource settings will be preserved in the resulting file.
ms.assetid: 61fbc81c-c3e8-4058-b11a-4ed69481207c
title: ExportSnapshot method of the Msvm_CollectionSnapshotService class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Msvm_CollectionSnapshotService.ExportSnapshot
api_type:</li>
<li>COM
api_location:</li>
<li>vmms.exe</li>
</ul>
<hr />
<h1>ExportSnapshot method of the Msvm_CollectionSnapshotService class</h1>
<p>Exports a snapshot collection of virtual computer systems to a file. The snapshot collection, its associated configuration settings, and its associated resource settings will be preserved in the resulting file.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 ExportSnapshot(
  [in]  CIM_Collection  REF SnapshotCollection,
  [in]  string              ExportDirectory,
  [in]  string              ExportSettingData,
  [out] CIM_ConcreteJob REF Job
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>SnapshotCollection</em> [in]</p>
<!-- raw HTML omitted -->
<p>A reference to a <a href="cim-collection.html"><strong>CIM_Collection</strong></a> that represents the snapshot collection to be exported.</p>
<!-- raw HTML omitted -->
<p><em>ExportDirectory</em> [in]</p>
<!-- raw HTML omitted -->
<p>The fully-qualified path of the directory to which the virtual system collection is to be exported. If the <strong>CreateVmExportSubdirectory</strong> property in the <em>ExportSettingData</em> parameter is set to <strong>True</strong> then this directory can be reused for exporting multiple virtual system collections and this method places each virtual system collection definition in a separate subdirectory under this path.</p>
<!-- raw HTML omitted -->
<p><em>ExportSettingData</em> [in]</p>
<!-- raw HTML omitted -->
<p>An instance of <a href="msvm-collectionsnapshotexportsettingdata.html"><strong>Msvm_CollectionSnapshotExportSettingData</strong></a> that represents the settings for the export operation.</p>
<!-- raw HTML omitted -->
<p><em>Job</em> [out]</p>
<!-- raw HTML omitted -->
<p>An optional reference that is returned if the operation is executed asynchronously. If present, the returned reference to an instance of <a href="cim-concretejob.html"><strong>CIM_ConcreteJob</strong></a> can be used to monitor progress and to obtain the result of the method.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If this method is executed synchronously, it returns 0 if it succeeds. If this method is executed asynchronously, it returns 4096 and the Job output parameter can be used to track the progress of the asynchronous operation. Any other return value indicates an error.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 10 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2016<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\virtualization\v2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WindowsVirtualization.V2.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Vmms.exe<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="msvm-collectionsnapshotservice.html"><strong>Msvm_CollectionSnapshotService</strong></a></p>
<!-- raw HTML omitted -->
</body>
