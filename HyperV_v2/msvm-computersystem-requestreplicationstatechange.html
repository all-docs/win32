<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>RequestReplicationStateChange method of the Msvm_ComputerSystem class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Requests that the replication state of the virtual machine be changed to the specified value and acts on the primary replication relationship of the virtual machine.
ms.assetid: 65FCDADD-1C50-4816-B10B-A951D1FC9C3B
title: RequestReplicationStateChange method of the Msvm_ComputerSystem class
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Msvm_ComputerSystem.RequestReplicationStateChange
api_type:</li>
<li>COM
api_location:</li>
<li>vmms.exe</li>
</ul>
<hr />
<h1>RequestReplicationStateChange method of the Msvm_ComputerSystem class</h1>
<p>Requests that the replication state of the virtual machine be changed to the specified value and acts on the primary replication relationship of the virtual machine. While the state change is in progress, the <strong>ReplicationState</strong> property is changed to the value of the <em>RequestedState</em> parameter. This method is only supported for instances of the <a href="msvm-computersystem.html"><strong>Msvm_ComputerSystem</strong></a> class that represent a virtual machine.</p>
<blockquote>
<p>[!Note]<br />
Starting with Windows 8.1, we recommend not to use <strong>RequestReplicationStateChange</strong> anymore to request changing of replication state. Instead, use <a href="msvm-requestreplicationstatechangeex-computersystem.html"><strong>RequestReplicationStateChangeEx</strong></a>.</p>
</blockquote>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 RequestReplicationStateChange(
  [in]  uint16              RequestedState,
  [out] CIM_ConcreteJob REF Job,
  [in]  datetime            TimeoutPeriod
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>RequestedState</em> [in]</p>
<!-- raw HTML omitted -->
<p>The new replication state. The must be one of the following values.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Ready to start initial replication</strong> (1)</p>
<!-- raw HTML omitted -->
<p>Ready to start initial replication.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Waiting to complete initial replication</strong> (2)</p>
<!-- raw HTML omitted -->
<p>Waiting to complete initial replication.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Replicating</strong> (3)</p>
<!-- raw HTML omitted -->
<p>Replicating.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Synced replication complete</strong> (4)</p>
<!-- raw HTML omitted -->
<p>Synced replication complete.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Suspend</strong> (7)</p>
<!-- raw HTML omitted -->
<p>Suspend replication.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Cancel Resynchronize</strong> (9)</p>
<!-- raw HTML omitted -->
<p>Cancel resynchronization.</p>
<!-- raw HTML omitted -->
<p><em>Job</em> [out]</p>
<!-- raw HTML omitted -->
<p>An optional reference to a <a href="msvm-concretejob.html"><strong>Msvm_ConcreteJob</strong></a> object that is returned if the operation is executed asynchronously. If present, the returned reference can be used to monitor progress and obtain the result of the method.</p>
<!-- raw HTML omitted -->
<p><em>TimeoutPeriod</em> [in]</p>
<!-- raw HTML omitted -->
<p>This parameter is not used.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method returns one of the following values.</p>
<table>
<thead>
<tr>
<th>Return code/value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Completed with No Error</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Success<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Method Parameters Checked - Job Started</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->4096<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The transition is asynchronous.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Failed</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32768<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Access Denied</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32769<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Not Supported</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32770<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Status is unknown</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32771<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Timeout</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32772<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Invalid parameter</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32773<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The value specified in one of the parameters is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>System is in use</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32774<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Invalid state for this operation</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32775<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The value specified in the <em>RequestedState</em> parameter is not supported in the current replication mode or state.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Incorrect data type</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32776<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>System is not available</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32777<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>Out of memory</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32778<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>File not found</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32779<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 8 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\Virtualization\V2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WindowsVirtualization.V2.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Vmms.exe<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="msvm-computersystem.html"><strong>Msvm_ComputerSystem</strong></a></p>
<!-- raw HTML omitted -->
</body>
