<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Dynamic-Link Library Updates</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: It is sometimes necessary to replace a DLL with a newer version.
ms.assetid: 82349a33-dc2c-4309-b0fc-890f230e3f2c
title: Dynamic-Link Library Updates
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Dynamic-Link Library Updates</h1>
<p>It is sometimes necessary to replace a DLL with a newer version. Before replacing a DLL, perform a version check to ensure that you are replacing an older version with a newer version. It is possible to replace a DLL that is in use. The method you use to replace DLLs that are in use depends on the operating system you are using. On Windows XP and later, applications should use <a href="/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal">Isolated Applications and Side-by-side Assemblies</a>.</p>
<p>It is not necessary to restart the computer if you perform the following steps:</p>
<ol>
<li>Use the <a href="/windows/desktop/api/winbase/nf-winbase-movefileexa"><strong>MoveFileEx</strong></a> function to rename the DLL being replaced. Do not specify MOVEFILE_COPY_ALLOWED, and make sure the renamed file is on the same volume that contains the original file. You could also simply rename the file in the same directory by giving it a different extension.</li>
<li>Copy the new DLL to the directory that contains the renamed DLL. All applications will now use the new DLL.</li>
<li>Use <a href="/windows/desktop/api/winbase/nf-winbase-movefileexa"><strong>MoveFileEx</strong></a> with MOVEFILE_DELAY_UNTIL_REBOOT to delete the renamed DLL.</li>
</ol>
<p>Before you make this replacement, applications will use the original DLL until it is unloaded. After you make the replacement, applications will use the new DLL. When you write a DLL, you must be careful to ensure that it is prepared for this situation, especially if the DLL maintains global state information or communicates with other services. If the DLL is not prepared for a change in global state information or communication protocols, updating the DLL will require you to restart the computer to ensure that all applications are using the same version of the DLL.</p>
<p>Â </p>
<p>Â </p>
</body>
