<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using MSMQ as an RPC Transport</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Using MSMQ as an RPC Transport
description: The RPC subsystem supports using MSMQ as a transport in synchronous and asynchronous modes.
ms.assetid: c3f96a91-b7bb-4c2a-8699-2100324af165
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using MSMQ as an RPC Transport</h1>
<p>The RPC subsystem supports using MSMQ as a transport in synchronous and asynchronous modes.</p>
<p>Synchronous mode uses conventional remote procedure calls. These calls use well-known endpoints and the message queue transport, <a href="/windows/desktop/Midl/ncadg-mq">ncadg_mq</a>, as the transport protocol. In synchronous mode, your remote procedures can have [ <a href="/windows/desktop/Midl/in">in</a>] and [ <a href="/windows/desktop/Midl/out-idl">out</a>] parameters and can use the standard RPC security services. The RPC subsystem creates a reply queue for remote calls containing <strong>[out]</strong> parameters. The synchronous mode is useful for applications where the client needs to receive data from the server. The main limitation of this mode is that, as with conventional remote procedure calls, both the client and server must be running and remain running for the duration of the call.</p>
<p>Asynchronous mode lets client applications make calls to the server and return immediately, regardless of the state of the server application or the server computer. It also makes a subset of MSMQ features available for managing message queues and information flow. The <a href="/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetoption"><strong>RpcBindingSetOption</strong></a> function lets you control quality of service, call priority, journaling, security, and the lifetime of the server process queue. The <a href="/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex"><strong>RpcServerUseProtseqEpEx</strong></a> function lets you specify attributes of the server process queue, such as queue persistence, authentication, and encryption.</p>
<p>You implement asynchronous MSMQ as you would synchronous MSMQ. You must use well-known endpoints, and define the transport protocol to be <a href="/windows/desktop/Midl/ncadg-mq">ncadg_mq</a>. In your IDL file, apply the <a href="/windows/desktop/Midl/message">message</a> attribute to the functions that use asynchronous message queuing. Note that message functions can have [in] parameters only.</p>
<p>Â </p>
<p>Â </p>
</body>
