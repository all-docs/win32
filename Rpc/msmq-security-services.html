<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MSMQ Security Services</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: MSMQ Security Services
description: Synchronous RPC messages can use any of the security features available from the RPC run time. See Security for more details.
ms.assetid: 0f4d45c4-7457-4449-8736-e141a95f6930
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>MSMQ Security Services</h1>
<p>Synchronous RPC messages can use any of the security features available from the RPC run time. See <a href="security.html">Security</a> for more details.</p>
<p>Asynchronous [ <a href="/windows/desktop/Midl/message">message</a>] calls cannot use RPC security because there is no handshake between client and server. In fact, the server may not even be running at the time of the call. To access the security services provided by Message Queuing Services (MSMQ), the client application should call <a href="/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfo"><strong>RpcBindingSetAuthInfo</strong></a> to control the level of authentication and privacy for its calls to the server.</p>
<p>The server application can call <a href="/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindinginqauthclient"><strong>RpcBindingInqAuthClient</strong></a> from within a remote procedure call to determine the security level for that call. The mapping between RPC security constants and MSMQ security is shown in the following table.</p>
<table>
<thead>
<tr>
<th>RPC security level</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>RPC_AUTHN_LEVEL_NONE</td>
<td>The call is not authenticated or encrypted.</td>
</tr>
<tr>
<td>RPC_AUTHN_LEVEL_PKT_INTEGRITY</td>
<td>The call is authenticated using MSMQ security.</td>
</tr>
<tr>
<td>RPC_AUTHN_LEVEL_PKT_PRIVACY</td>
<td>The call is authenticated and encrypted as it travels between the client and server queue.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The server can also force call authentication and encryption by calling <a href="/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex"><strong>RpcServerUseProtseqEpEx</strong></a> and setting the RPC_C_MQ_AUTHN_LEVEL_NONE, RPC_C_MQ_AUTHN_LEVEL_PKT_INTEGRITY and RPC_C_MQ_AUTHN_LEVEL_PKT_PRIVACY flags in the <a href="/windows/desktop/api/Rpcdce/ns-rpcdce-rpc_policy"><strong>RPC_POLICY</strong></a> structure.</p>
<p>Â </p>
<p>Â </p>
</body>
