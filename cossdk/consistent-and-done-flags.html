<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Consistent and Done Flags</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Consistent and Done Flags
ms.assetid: a641fa95-5587-4362-9869-e5c27c6dd2ce
title: Consistent and Done Flags
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Consistent and Done Flags</h1>
<p>COM+ always creates a context object before activating a transactional object. The context object holds object-related information, such as its creator and its transaction identifier. Each context object also contains a <em>consistent flag</em> and a <em>doneÂ flag</em>. Together these flags determine the status of the transactional object.</p>
<p>The consistent flag indicates that the transactional object is either consistent or inconsistent. The specific details of what makes an object's state consistent is up to the programmer. When a method call sets this flag to True, the object is consistent. False indicates that the object is inconsistent. COM+ sets the flag to True when it creates an object instance. A consistent object is ready to proceed with the transaction. While an object remains active, subsequent method calls can repeatedly switch the consistent flag from True to False and vice versa.</p>
<p>The done flag determines the duration of a transaction. When a method call returns, COM+ inspects the done flag. If the method sets this flag to True, COM+ deactivates the object and notes the consistent flag. When the done flag is False, COM+ neither deactivates the object nor notes the consistent flag. COM+ sets the done flag to False when it creates an object instance.</p>
<p>The consistent flag casts a vote to commit or abort the transaction in which it executes, and the done flag finalizes the vote. COM+ inspects the consistent flag when the done flag is set to True on a method call return or when the object deactivates. Although an object's consistent flag can change repeatedly within each method call, only the last change counts.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="managing-automatic-transactions-in-com-.html">Managing Automatic Transactions in COM+</a></p>
<!-- raw HTML omitted -->
<p><a href="setting-the-consistent-and-done-flags.html">Setting the Consistent and Done Flags</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
