<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>What's New in COM+ 1.5</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: COM+ version 1.5 adds new features that are designed to increase the overall scalability, availability, and manageability of COM+ applications both for developers and for system administrators.
ms.assetid: e7073ba5-6b19-4d94-8cc0-b4e16bb44afd
title: Whats New in COM+ 1.5
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>What's New in COM+ 1.5</h1>
<p>COM+ version 1.5 adds new features that are designed to increase the overall scalability, availability, and manageability of COM+ applications both for developers and for system administrators.</p>
<p>COM+ 1.5 is available starting with WindowsÂ XP and Windows ServerÂ 2003. The new COM+ 1.5 features are not available in WindowsÂ 2000.</p>
<h2>Application-Level Access Checks Enabled by Default</h2>
<p>As part of the enhanced security of the system, access checks are enabled by default when creating a COM+ application. In previous versions, access checks were disabled by default at the application level and enabled by default at the component level. Starting with Windows ServerÂ 2003, access checks are enabled by default at the application level and disabled by default at the component level. See <a href="creating-a-new-com--application.html">Creating a New COM+ Application</a>, <a href="enabling-access-checks-for-an-application.html">Enabling Access Checks for an Application</a>, and <a href="enabling-access-checks-at-the-component-level.html">Enabling Access Checks at the Component Level</a> for more information and procedures on how to change the default settings.</p>
<h2>Application Pooling</h2>
<p>With the new ConcurrentApps property of the <a href="comadmincatalogobject.html"><strong>COMAdminCatalogObject</strong></a> object in the <a href="applications.html"><strong>Applications</strong></a> collection, COM+ Application Pooling adds scalability for single-threaded processes and integrates with the new COM+ Application Recycling service. See <a href="com--application-pooling.html">COM+ Application Pooling</a> for detailed information.</p>
<h2>Application Recycling</h2>
<p>Application recycling significantly increases the overall stability of your applications. Because the performance of most applications can degrade over time due to factors such as memory leaks, reliance on third-party code, and nonscalable resource usage, COM+ application recycling provides a simple solution to gracefully shut down a process associated with an application and restart it. See <a href="com--application-recycling.html">COM+ Application Recycling</a> for detailed information. Also see &quot;Configuring Process Recycling&quot; in the Component Services Administration Help for a step-by-step procedure for configuring process recycling.</p>
<h2>COM+ Partitions</h2>
<p>In this release, COM+ introduces support for COM+ partitions, a feature that allows multiple versions of COM+ applications to be installed and configured on the same machine. This feature can save you the cost and time-consuming effort of using multiple servers to manage different versions of an application. On a single machine, each partition acts, in effect, as a virtual server. After installing the application into each partition, you create partition sets that map users to the logical servers. See <a href="com--partitions.html">COM+ Partitions</a> for detailed information about how to set up and manage COM+ partitions. Also see &quot;Administering Application Partitions&quot; in the Component Services Administration Help for step-by-step procedures.</p>
<h2>COM+ Services Without Components</h2>
<p>With COM+Â 1.5, you can use the services provided by COM+ without needing to build a component to contain the methods that call those services. This greatly benefits developers who do not normally use components but want to use COM+ services such as transactions or the COM+ Tracker. By using COM+ services without components, developers can avoid the overhead of creating a component that is used to access only the COM+ services they need. See <a href="com--services-without-components.html">COM+ Services Without Components</a> for detailed information.</p>
<h2>COM+ SOAP Service</h2>
<p>With COM+ 1.5, you can now expose a COM+ application as an XML web service. You can also transparently use an XML web service, whether deployed using COM+ or not, as a COM component. This means that you can easily create new XML web services out of existing COM+ applications and easily incorporate XML web services into new COM+ applications. See <a href="com--soap-service.html">COM+ SOAP Service</a> for detailed information.</p>
<h2>Configurable Isolation Levels</h2>
<p>COM+ developers can use the new TxIsolationLevel property or the Component Services administrative tool to configure an application's isolation level according to need, helping to increase concurrency, performance, and scalability. This flexibility enables those with the right amount of expertise to get every last ounce of throughput out of their applications. See <a href="configuring-transaction-isolation-levels.html">Configuring Transaction Isolation Levels</a> for detailed information.</p>
<h2>Creating Private Components</h2>
<p>In scenarios where you have several helper components in an application that are meant to be called only from other components within that application, this release of COM+ enables you to use a new property, IsPrivateComponent, to mark these components as private. (In the previous release of COM+, all components had to be public to have access to COM+ services, which means that these components could be activated from other applications.) A private component can be seen and activated only by other components in the same application, giving you more control over what functionality to expose. You need only document and maintain the public components, while making use of private components that cannot be accessed from outside the application but that can still take advantage of all COM+ services.</p>
<h2>DTC Security Settings</h2>
<p>Several new security settings have been added for the Microsoft Distributed Transaction Coordinator (DTC), enabling you to customize your security levels for managing distributed transactions. See DTC Security Considerations about these settings and how to implement them.</p>
<p>To facilitate mutual authentication, the DTC is restricted to running under the NetworkService account. See Managing Accounts and Privileges for detailed information.</p>
<p>For recovery with XA databases, it is recommended that the NetworkService account be provided the permissions and roles needed to perform this recovery. The exact method of doing this is specific to each database. See Disabling Native Distributed Transactions and Disabling TIP and XA Transactions for more information.</p>
<p>To help provide a more secure system when using XA transactions, Windows Server 2003 platforms include a new registry entry for specifying XA DLL files. When upgrading to Windows Server 2003, you can work with XA transactions as before by creating a registry entry under <strong>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSDTC\XADLL</strong>, where the value name is the name of the DLL (in the format <em>dllname</em>.dll) and the value is the full path of the DLL file. You need to create an entry for each XA DLL file in use. If the computer running DTC is part of a cluster, the registry entry needs to be made for each node in the cluster. See Managing XA Transactions for more information.</p>
<h2>Low-Memory Activation Gates</h2>
<p>With this release, COM+ automatically checks memory before creating a COM+ server or object. If the percentage of virtual memory available to the application falls below a fixed threshold, the activation fails before the object is created. By failing these activations that would normally run, the <a href="com--low-memory-activation-gates.html">COM+ Low-Memory Activation Gates</a> service greatly enhances system reliability.</p>
<h2>Moving and Copying COM Components</h2>
<p>With this release, COM+ allows you to move and copy your components. This means you can configure a single physical implementation of a component many different times. You get component reuse at a binary level rather than at the source code level, which results in less code, lower development costs, and faster time to market. See <a href="moving-components.html">Moving Components</a> and <a href="copying-components.html">Copying Components</a> for detailed information.</p>
<h2>Network Access</h2>
<p>COM+ network access is disabled by default on Windows ServerÂ 2003, meaning that COM+ can be used only locally by default. Use the following procedure to enable network COM+ access.</p>
<p><strong>To enable network COM+ access</strong></p>
<ol>
<li>
<p>On the <strong>Start</strong> menu, point to <strong>Control Panel</strong>, then select <strong>Add or Remove Programs</strong>.</p>
</li>
<li>
<p>Click <strong>Add/Remove Windows Components</strong>.</p>
</li>
<li>
<p>Select <strong>Application Server</strong> and click <strong>Details</strong>.</p>
</li>
<li>
<p>Check the box next to <strong>Enable network COM+ access</strong>, and then click <strong>OK</strong>.</p>
</li>
<li>
<p>Click <strong>Next</strong> to complete the Windows Components wizard.</p>
</li>
<li>
<p>Click <strong>Finish</strong> to close the wizard.</p>
</li>
</ol>
<p>DTC network transactions access is disabled by default on Windows ServerÂ 2003. On these platforms, the DTC can perform only local transactions by default. Use the following procedure to enable network DTC access.</p>
<blockquote>
<p>[!NOTE]
You can also enable network DTC access by using the Component Services administrative tool or programmatically through the COM+ Administration Library. For procedural information, see &quot;Configuring DTC Security&quot; in the Component Services Administration Help.</p>
</blockquote>
<p><strong>To enable network DTC access</strong></p>
<ol>
<li>
<p>On the <strong>Start</strong> menu, point to <strong>Control Panel</strong>, then select <strong>Add or Remove Programs</strong>.</p>
</li>
<li>
<p>Click <strong>Add/Remove Windows Components</strong>.</p>
</li>
<li>
<p>Select <strong>Application Server</strong> and click <strong>Details</strong>.</p>
</li>
<li>
<p>Check the box next to <strong>Enable network DTC access</strong>, and then click <strong>OK</strong>.</p>
</li>
<li>
<p>Click <strong>Next</strong> to complete the Windows Components wizard.</p>
</li>
<li>
<p>Click <strong>Finish</strong> to close the wizard.</p>
</li>
</ol>
<h2>Pausing and Disabling Applications</h2>
<p>COM+ applications are now more manageable. An administrator can pause and resume COM+ server applications or disable and enable COM+ library or server applications, or even individual configured components. Both the pausing and disabling features prevent future activations without affecting existing component instances. See &quot;Administering COM+ Applications&quot; in the Component Services Administration Help for more information.</p>
<h2>Process Dumping</h2>
<p>It's not easy troubleshooting applications in a production environment. How do you gather information on a problem without disturbing the running processes? COM+ now provides a solution through its new process dump feature. This feature allows the system administrator to dump the entire state of a process without terminating it. See &quot;Administering the Process Dump Tool for Debugging COM+ Applications&quot; in the Component Services Administration Help for more information.</p>
<h2>Process Initialization</h2>
<p>Many server applications need to do specific initialization and cleanup when they are started and shut down. When running on Windows ServerÂ 2003, you can create a class that implements the <a href="/windows/desktop/api/ComSvcs/nn-comsvcs-iprocessinitializer"><strong>IProcessInitializer</strong></a> interface. When the process starts up, it calls <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iprocessinitializer-startup"><strong>IProcessInitializer::Startup</strong></a> and when shutting down, it calls <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iprocessinitializer-shutdown"><strong>IProcessInitializer::Shutdown</strong></a>. This gives your component the opportunity to do needed tasks, such as initializing connections, files, and caches.</p>
<h2>Running COM+ Applications as NT Services</h2>
<p>COM+ developers can now use the Component Services administrative tool to configure and implement a COM+ server application as an NT service. This means that the server can be automatically started or restarted if your application always needs to be running; that your COM+ application can run as the local system account if it needs to perform privileged operations; and that your application's dependent services can now be started automatically. See <a href="com--applications-running-as-service-applications.html">COM+ Applications Running as Service Applications</a> for detailed information.</p>
<h2>Side-by-Side Assemblies</h2>
<p>Side-by-side (SxS) assemblies allow applications to specify which version of a system DLL or classic COM component to use, such as MDAC, MFS, MSVCRT, or MSXML. For example, if an ASP application relies on MSXML version 2.0, you can ensure that this application still uses MSXML version 2.0 even after service packs are applied to the server. That is, even when a new version of MSXML is installed on the computer, version 2.0 remains and is used by your application.</p>
<p>To configure SxS assemblies, you need to know the path to the DLL and that the COM+ manifest file exists in every virtual directory that needs to use the DLL. The COM+ manifest is an XML file that has information about where a DLL is installed. The manifest is used to create an activation context for the application. Activation contexts allow an application to load a particular DLL version, COM object instance, or custom window version. You can use the Component Services administrative tool or ApplicationDirectory property to enter the full path of the application root directory that contains a valid SxS assembly manifest file. For more information, see <a href="/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal">Isolated Applications and Side-by-side Assemblies</a>.</p>
<h2>Windows Error Reporting</h2>
<p>COM+Â 1.5 includes support for the Windows Error Reporting (WER) component, available starting in WindowsÂ XP. WER enables users to notify Microsoft of application faults, kernel faults, and unresponsive applications. These notifications allow the Microsoft customer support teams to solve technical problems more effectively. In addition, the Windows Error Reporting component enables COM+ developers to receive information that can be used to improve their applications. For more information, see <a href="/windows/desktop/wer/windows-error-reporting">Windows Error Reporting</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
