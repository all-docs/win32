<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Enlisting a Resource in a Transaction</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Enlisting a Resource in a Transaction
ms.assetid: b41fe0aa-a4cf-4d4a-9543-8eb0b38f07a2
title: Enlisting a Resource in a Transaction
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Enlisting a Resource in a Transaction</h1>
<p>After a resource is allocated, but just before returning the resource to the resource dispenser, the dispenser manager checks with COM+ to see whether the calling object is running within a transaction. If the calling object is running within a transaction, the dispenser manager calls back to the resource dispenser and asks it to enlist the resource in the transaction. Then the resource is returned to the resource dispenser, which then returns it to the calling instance.</p>
<p>The resource dispenser must be able to enlist in an OLE transaction with the Distributed Transaction Coordinator (DTC).</p>
<blockquote>
<p>[!Note]<br />
Transaction enlistment is optional when a resource dispenser dispenses non-transactional resources, such as memory or threads.</p>
</blockquote>
<p>Â </p>
<p>When a transaction is complete, COM+ notifies the dispenser manager about whether it committed or aborted. Then the dispenser manager notifies each resource dispenser's holder that any resources enlisted in this transaction can now be moved to general inventory.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="com--resource-dispenser-concepts.html">COM+ Resource Dispenser Concepts</a></p>
<!-- raw HTML omitted -->
<p><a href="pooled-resource-states-available-to-com--resource-dispenser.html">Pooled Resource States Available to COM+ Resource Dispenser</a></p>
<!-- raw HTML omitted -->
<p><a href="resource-dispenser-resource-allocation-process.html">Resource Dispenser Resource Allocation Process</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
