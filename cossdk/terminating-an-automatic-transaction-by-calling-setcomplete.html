<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Terminating an Automatic Transaction by Calling SetComplete</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Terminating an Automatic Transaction by Calling SetComplete
ms.assetid: 5bd06cfd-1ee0-48ac-84ab-3737d76bccc0
title: Terminating an Automatic Transaction by Calling SetComplete
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Terminating an Automatic Transaction by Calling SetComplete</h1>
<p>To use automatic transactions effectively, each transactional component should indicate that it has completed its work. When an object instance completes its task successfully, it should set its consistent and done flags to True by calling the <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete"><strong>IObjectContext::SetComplete</strong></a> method, which is exposed through both the <a href="/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext"><strong>IObjectContext</strong></a> interface and the <a href="/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext"><strong>ObjectContext</strong></a> object.</p>
<p>The most efficient way to complete an automatic transaction is to explicitly deactivate the root object by using the <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete"><strong>SetComplete</strong></a> method. By explicitly indicating that a root object has completed its work, you can reduce the length of the transaction.</p>
<p>The following Visual Basic example shows how to indicate that a transactional object has completed its work successfully:</p>
<pre lang="VB"><code>Sub MyObjMethod1()
  Dim ObjCtx As ObjectContext
  Dim InteriorObj1 As Cinterior  ' Cinterior is a user-defined object.

  Set ObjCtx = GetObjectContext()
  Set InteriorObj1 = CreateObject (&quot;MyDll.Cinterior&quot;)
  InteriorObj1.Method1
  ' If the call completed successfully, then...
  objCtx.SetComplete
End Sub
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="consistent-and-done-flags.html">Consistent and Done Flags</a></p>
<!-- raw HTML omitted -->
<p><a href="managing-automatic-transactions-in-com-.html">Managing Automatic Transactions in COM+</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
