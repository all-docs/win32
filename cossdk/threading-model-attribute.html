<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Threading Model Attribute</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: COM+ manages threads for you. Every COM component has a ThreadingModel property that you can specify when you develop the component. This property determines how the components objects are assigned to threads for method execution.
ms.assetid: 5fae8475-3d2e-4939-80a7-bc9a677a50b3
title: Threading Model Attribute
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Threading Model Attribute</h1>
<p>COM+ manages threads for you. Every COM component has a <strong>ThreadingModel</strong> property that you can specify when you develop the component. This property determines how the component's objects are assigned to threads for method execution.</p>
<p>You can use the Component Services administrative tool to view the threading-model property by right-clicking a component in the <strong>Components</strong> folder, clicking <strong>Properties</strong>, and then clicking the <strong>Concurrency</strong> tab. Under <strong>Threading Model</strong>, the possible values are as follows:</p>
<ul>
<li><strong>Main Thread Apartment</strong></li>
<li><strong>Single Thread Apartment</strong></li>
<li><strong>Free Thread Apartment</strong></li>
<li><strong>Neutral Apartment</strong></li>
<li><strong>Any Apartment</strong></li>
</ul>
<p>The preferred threading model for COM+ is the <a href="neutral-apartments.html">neutral apartment</a>. However, if you do not specify a threading model for your component, COM+ uses the main thread apartment, which is the default.</p>
<blockquote>
<p>[!Note]<br />
For more detailed information, see <a href="/windows/desktop/com/choosing-the-threading-model">Choosing the Threading Model</a>.</p>
</blockquote>
<p>Â </p>
<p>The following table shows the programming model for apartments in COM+.</p>
<table>
<thead>
<tr>
<th>Model</th>
<th>Apartment</th>
<th>Free</th>
<th>Both</th>
<th>Neutral</th>
<th>Not Specified</th>
</tr>
</thead>
<tbody>
<tr>
<td>Single-threaded, not main</td>
<td>Created in current apartment</td>
<td>Created in multithreaded apartment</td>
<td>Created in current apartment</td>
<td>Created in neutral apartment</td>
<td>Created in main threaded apartment</td>
</tr>
<tr>
<td>Single-threaded, main</td>
<td>Created in current apartment</td>
<td>Created in multithreaded apartment</td>
<td>Created in current apartment</td>
<td>Created in neutral apartment</td>
<td>Created in current apartment</td>
</tr>
<tr>
<td>Multithreaded</td>
<td>Created in host single-threaded apartment</td>
<td>Created in multithreaded apartment</td>
<td>Created in multithreaded apartment</td>
<td>Created in neutral apartment</td>
<td>Created in main threaded apartment</td>
</tr>
<tr>
<td>Neutral (on STA thread)</td>
<td>Created in host single-threaded apartment for this thread</td>
<td>Created in multithreaded apartment</td>
<td>Created in neutral apartment</td>
<td>Created in neutral apartment</td>
<td>Created in main threaded apartment</td>
</tr>
<tr>
<td>Neutral (on MTA thread)</td>
<td>Created in host single-threaded apartment</td>
<td>Created in multithreaded apartment</td>
<td>Created in neutral apartment</td>
<td>Created in neutral apartment</td>
<td>Created in main threaded apartment</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="components.html"><strong>ThreadingModel</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
