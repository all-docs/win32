<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Setting the Done Bit</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Setting the Done Bit
ms.assetid: badd3b5a-ce6f-4be7-9dd8-a3b17344b185
title: Setting the Done Bit
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Setting the Done Bit</h1>
<p>COM+ will deactivate a JIT-activated object based on the status of a context property, the done bit, as follows:</p>
<ul>
<li>When the done bit is set to True, COM+ deactivates the object when the current method call returns.</li>
<li>When the done bit is set to False, the object remains active when the current method call returns.</li>
</ul>
<p>By default, the done bit is set to False when an object is created and its context initialized. (Any JIT-activated object is created in its own context so that it has its own done bit to set.) However, you can change this default setting on a per-method basis by using the auto-done property. You can set the done bit in the following ways:</p>
<ul>
<li>Using <a href="/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate"><strong>IContextState</strong></a></li>
<li>Using <a href="/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext"><strong>IObjectContext</strong></a></li>
<li>Using the auto-done property</li>
</ul>
<h2>Using IContextState</h2>
<p>You can use <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn"><strong>IContextState::SetDeactivateOnReturn</strong></a> to set the done bit to True or False.</p>
<p>You can use <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-getdeactivateonreturn"><strong>IContextState::GetDeactivateOnReturn</strong></a> to get the current status of the done bit from the object context.</p>
<h2>Using IObjectContext</h2>
<p>You can use the following methods on <a href="/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext"><strong>IObjectContext</strong></a> to set the done bit while simultaneously setting the consistent bit used for voting in transactions:</p>
<ul>
<li><a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete"><strong>SetComplete</strong></a> signals both that you are done and that you vote to commit the current transaction. It sets both the done bit and the consistent bit to True.</li>
<li><a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort"><strong>SetAbort</strong></a> signals that you are done and dooms the current transaction. It sets the done bit to True and the consistent bit to False.</li>
<li><a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-enablecommit"><strong>EnableCommit</strong></a> signals that you are not done but that you vote to commit the transaction. It sets the done bit to False and the consistent bit to True.</li>
<li><a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-disablecommit"><strong>DisableCommit</strong></a> signals that you are not done and that you vote not to commit the transaction at this time, usually because the state is inconsistent. It sets both the done bit and the consistent bit to False.</li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="com--just-in-time-activation-concepts.html">COM+ Just-in-Time Activation Concepts</a></p>
<!-- raw HTML omitted -->
<p><a href="enabling-jit-activation-for-a-component.html">Enabling JIT Activation for a Component</a></p>
<!-- raw HTML omitted -->
<p><a href="object-pooling-and-com--jit-activation.html">Object Pooling and COM+ JIT Activation</a></p>
<!-- raw HTML omitted -->
<p><a href="transactions-and-com--jit-activation.html">Transactions and COM+ JIT Activation</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
