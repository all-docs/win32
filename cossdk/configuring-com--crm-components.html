<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Configuring COM+ CRM Components</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: CRM components can be installed into either a COM+ server application or a COM+ library application.
ms.assetid: d1ce3a0c-1278-498c-b5dc-4e14b26b4fc2
title: Configuring COM+ CRM Components
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Configuring COM+ CRM Components</h1>
<p>CRM components can be installed into either a COM+ server application or a COM+ library application. However, they must always run in a COM+ server application. If they are installed in a COM+ library application, they are not available for use in client processes.</p>
<p>If the CRM components they are installed in a library application, they are available to more than one server application. If installed in a specific server application, they are available only to that specific server application.</p>
<p>To enable use of a CRM in a server application, use the following steps:</p>
<ol>
<li>
<p>From Component Services, under the server application properties page, click the <strong>Advanced</strong> tab.</p>
</li>
<li>
<p>Select the <strong>Enable compensating Resource Managers</strong> option for that server application. If this option is not selected, attempts to use a CRM within this server application will fail.</p>
<blockquote>
<p>[!Note]<br />
If installed in a library application, it is not necessary to select the <strong>Enable compensating Resource Managers</strong> option for that library application, but this option must be selected for the server application in which the CRM is intended to run.</p>
</blockquote>
<p>Â </p>
</li>
</ol>
<p>It is recommended that the CRM Worker and CRM Compensator components for a specific CRM be installed in the same application.</p>
<p>The recommended settings for CRM components are as follows.</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Settings</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>CRM Worker</strong></td>
<td>transaction = requiredsync = yesJIT = yesthreading model = Both (or threading model = Apartment)</td>
</tr>
<tr>
<td><strong>CRM Compensator</strong></td>
<td>transaction = disabledsync = disabledJIT = nothreading model = Both (or threading model = Apartment)</td>
</tr>
</tbody>
</table>
<p>Â </p>
<blockquote>
<p>[!Note]<br />
Components that use the CRM must explicitly specify a threading model when they are registered. The default, 'Main Thread Apartment,' is not supported. The only two threading models supported are Apartment and Both.</p>
</blockquote>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="com--compensating-resource-manager-concepts.html">COM+ Compensating Resource Manager Concepts</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
