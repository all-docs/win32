<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Handling COM+ Administration Errors</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Handling COM+ Administration Errors
ms.assetid: 03f00c19-ff81-478b-b545-048f3dbe5eda
title: Handling COM+ Administration Errors
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Handling COM+ Administration Errors</h1>
<p>Errors that are generated when using the COMAdmin objects are reported in two ways, as follows:</p>
<ul>
<li>Using error codes specific to the COMAdmin library.</li>
<li>Using extended error information available in a special <a href="errorinfo.html"><strong>ErrorInfo</strong></a> collection.</li>
</ul>
<h2>Error Codes</h2>
<p>You handle administration error codes as you would any COM error message. In Microsoft Visual C++, these codes are returned as <strong>HRESULT</strong> values. In Microsoft Visual Basic, they are thrown as exceptions that you can catch. For C++ programmers, the COM+ administration error codes are defined in Winerror.h. For Visual Basic programmers, they are available through the Visual Basic IDE.</p>
<h2>ErrorInfo Collection</h2>
<p>When an error occurs, signaled by some kind of failure code, more detailed information may be available, depending on the nature of the error. The COMAdmin objects provide extended information in circumstances where the precise cause of the failure is difficult to determine without a detailed report, such as with multiple read and write operations.</p>
<p>For example, when you use methods such as <a href="/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-populate"><strong>Populate</strong></a> and <a href="/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-savechanges"><strong>SaveChanges</strong></a> on a <a href="comadmincatalogcollection.html"><strong>COMAdminCatalogCollection</strong></a> object, you can be reading or writing data for every item in the collection. Complicated errors can occur, and they can be difficult to diagnose based on a single numeric error code. Therefore, the COMAdmin Library makes extended error information through a special collection.</p>
<p>When extended error information is available, it is placed in the <a href="errorinfo.html"><strong>ErrorInfo</strong></a> collection that is related to the original collection that had the error. To retrieve the error report, get the <strong>ErrorInfo</strong> collection that is related to the original collection and examine the items it contains. You can retrieve the <strong>ErrorInfo</strong> collection by using <a href="/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-getcollection"><strong>GetCollection</strong></a> on <a href="comadmincatalogcollection.html"><strong>COMAdminCatalogCollection</strong></a>, leaving the second parameter blank where you would normally specify a parent item's Key property.</p>
<p>When you get an error, you must immediately get and populate the <a href="errorinfo.html"><strong>ErrorInfo</strong></a> collection for the collection that failed, without performing any other operations on that collection. Otherwise, the <strong>ErrorInfo</strong> collection is reset and does not detail that failure.</p>
<p>The items in the <a href="errorinfo.html"><strong>ErrorInfo</strong></a> collection expose the special error-reporting properties MajorRef and MinorRef, which detail the particular cause of the error. For more information, see <strong>ErrorInfo</strong>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="com--administration-operations-within-transactions.html">COM+ Administration Operations Within Transactions</a></p>
<!-- raw HTML omitted -->
<p><a href="introductory-example-using-the-com--administration-catalog.html">Introductory Example Using the COM+ Administration Catalog</a></p>
<!-- raw HTML omitted -->
<p><a href="overview-of-the-comadmin-objects.html">Overview of the COMAdmin Objects</a></p>
<!-- raw HTML omitted -->
<p><a href="retrieving-collections-on-the-com--catalog.html">Retrieving Collections on the COM+ Catalog</a></p>
<!-- raw HTML omitted -->
<p><a href="setting-properties-and-saving-changes-to-the-com--catalog.html">Setting Properties and Saving Changes to the COM+ Catalog</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
