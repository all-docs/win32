<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Configuring a Component to Be Pooled</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: You can configure a component to be pooled only when it is correctly written to support being pooled. For details of these requirements, see Requirements for Poolable Objects.
ms.assetid: ffd812cc-811e-4f2a-8736-d1cb22d5abb7
title: Configuring a Component to Be Pooled
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Configuring a Component to Be Pooled</h1>
<p>You can configure a component to be pooled only when it is correctly written to support being pooled. For details of these requirements, see <a href="requirements-for-poolable-objects.html">Requirements for Poolable Objects</a>.</p>
<blockquote>
<p>[!Note]<br />
By default, a component is not configured to be pooled.</p>
</blockquote>
<p>Â </p>
<p>When you configure a component to be pooled, you can specify the following properties to determine how COM+ maintains the pool:</p>
<ul>
<li><strong>Minimum pool size.</strong> Represents the number of objects that are created when the application starts and the minimum number of objects that are maintained in the pool while the application is running. If the number of available objects in the pool drops below the specified minimum, new objects are created to meet any outstanding object requests and refill the pool. If the number of available objects in the pool is greater than the minimum number, those surplus objects are destroyed during a clean-up cycle.</li>
<li><strong>Maximum pool size.</strong> Represents the maximum number of pooled objects that the pooling manager will create, both actively used by clients and inactive in the pool. When creating objects, the pooling manager checks to verify that the maximum pool size has not been reached and, if it hasn't, the pool manager creates a new instance of the object to dispense to the client. If the maximum pool size has been reached, client requests will be queued and will receive the first available object from the pool on a first-come first-served basis. Object creation requests will time-out after a specified period.</li>
<li><strong>Creation timeout (ms).</strong> Specifies how long a client will wait, in milliseconds, for an object to be returned from the pool after a call to <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a>. If the client call is unsuccessful, the error E_TIMEOUT is returned.</li>
</ul>
<p><strong>To set pooling-related properties</strong></p>
<ol>
<li>
<p>In the details pane of the Component Services administrative tool, right-click the component that you want to configure, and then click <strong>Properties</strong>.</p>
</li>
<li>
<p>In the component properties dialog box, click the <strong>Activation</strong> tab.</p>
</li>
<li>
<p>To enable object pooling for the component, select the <strong>Enable object pooling</strong> check box.</p>
</li>
<li>
<p>In the <strong>Minimum pool size</strong> box, enter the minimum number of objects of this type in the pool. The pool will be maintained to have at least this many objects.</p>
</li>
<li>
<p>In the u box, enter the maximum number of objects of this type in the pool. The number of objects, both activated and deactivated, will never exceed this value.</p>
</li>
<li>
<p>In the <strong>Creation timeout (ms)</strong> box, enter the amount of time, in milliseconds, a client will wait for a pooled object if one is not immediately available.</p>
</li>
</ol>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="monitoring-object-statistics.html">Monitoring Object Statistics</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
