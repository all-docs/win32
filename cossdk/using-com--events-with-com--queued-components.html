<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using COM+ Events with COM+ Queued Components</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The COM+ events service is used to manage the delivery of events from publishers to subscribers.
ms.assetid: 0945163b-1276-47f6-ae7f-9d932a1b586d
title: Using COM+ Events with COM+ Queued Components
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using COM+ Events with COM+ Queued Components</h1>
<p>The COM+ events service is used to manage the delivery of events from publishers to subscribers. The COM+ queued components service can be used to make the publisher and subscriber processing time independent by queuing the publisher's message and later replaying it to the subscriber. Whether or not you need to use the queued components service depends on the underlying business logic of your application. If you need to have events that are time independent, you can create them by using the COM+ events service with COM+ queued components service.</p>
<blockquote>
<p>[!Note]<br />
For additional information about using the COM+ queued components service, see <a href="com--queued-components.html">COM+ Queued Components</a>.</p>
</blockquote>
<p>Â </p>
<p>The queued components service maintains order-of-method invocation within a single message. The recorder batches all method invocations into a message, and then the player invokes those methods in order when the message is processed.</p>
<p>A queued components recorder and player can be positioned in either of the following two places:</p>
<ul>
<li>Between the publisher and event object</li>
<li>Between the event object and subscriber</li>
</ul>
<p>If you position the recorder and player between the publisher and event object, you are making the <a href="the-com--event-class-object.html">event class</a> component queuable. The event class component must be marked for queuing and be activated by the player in a process that is separate from the publisher.</p>
<p>To deliver events asynchronously, compose the recorder and player between the event object and subscriber and set the Queued attribute of the subscription object. This sets SubscriberMoniker as follows: &quot;queue:/new:/{12345678-1234-1234-1234-123456789012}&quot;.</p>
<p>There is an order of delivery implication to consider when using queued components in an event situation. Because the queued components service records and plays back all calls within the lifetime of a single object in one message, all calls are replayed in the order in which they were made. However, if there is more than one session with more than one object, order cannot be guaranteed. If order is important, make sure that calls that need to be played back in order reside on the same object instance.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="filtering-events-in-com-.html">Filtering Events in COM+</a></p>
<!-- raw HTML omitted -->
<p><a href="publishing-and-delivering-events-in-com-.html">Publishing and Delivering Events in COM+</a></p>
<!-- raw HTML omitted -->
<p><a href="subscriptions.html">Subscriptions</a></p>
<!-- raw HTML omitted -->
<p><a href="the-com--event-class-object.html">The COM+ Event Class Object</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
