<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using COM+ Services Through CoEnterServiceDomain and CoLeaveServiceDomain</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Using COM+ Services Through CoEnterServiceDomain and CoLeaveServiceDomain
ms.assetid: 763fb01e-5daf-4e9b-8ef1-9ae79c0a84cc
title: Using COM+ Services Through CoEnterServiceDomain and CoLeaveServiceDomain
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using COM+ Services Through CoEnterServiceDomain and CoLeaveServiceDomain</h1>
<p><a href="/windows/desktop/api/ComSvcs/nf-comsvcs-coenterservicedomain"><strong>CoEnterServiceDomain</strong></a> and <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-coleaveservicedomain"><strong>CoLeaveServiceDomain</strong></a> are used together to surround an area of code that runs in its own context and can use COM+ services without the need for COM+ components. The COM+ services that are used in this context are configured through the <a href="cserviceconfig.html"><strong>CServiceConfig</strong></a> object that is passed in to <strong>CoEnterServiceDomain</strong>. The code that is surrounded by <strong>CoEnterServiceDomain</strong> and <strong>CoLeaveServiceDomain</strong> behaves as though it were a method that is called on an object created within this context.</p>
<p>A scripting application can use this pair of functions to provide run-time support of COM+ services without components. For example, a scripting application can be developed to provide tags that allow the script writers to enter and leave a service domain within the script. When the scripting engine processes the script and encounters the tags, it can call <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-coenterservicedomain"><strong>CoEnterServiceDomain</strong></a> with a preconfigured <a href="cserviceconfig.html"><strong>CServiceConfig</strong></a> object, run the necessary code, and then call <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-coleaveservicedomain"><strong>CoLeaveServiceDomain</strong></a>.</p>
<h2>Component Services Administrative Tool</h2>
<p>Does not apply.</p>
<h2>Visual Basic</h2>
<p>Does not apply.</p>
<h2>C/C++</h2>
<p>The following code fragment illustrates how to use COM+ services between calls to <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-coenterservicedomain"><strong>CoEnterServiceDomain</strong></a> and <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-coleaveservicedomain"><strong>CoLeaveServiceDomain</strong></a>. Error handling is omitted for brevity. This code fragment uses the <a href="cserviceconfig.html"><strong>CServiceConfig</strong></a> object that was created and configured in <a href="configuring-com--services-with-cserviceconfig.html">Configuring COM+ Services with CServiceConfig</a>.</p>
<pre lang="C++"><code>// A CServiceConfig object was created as follows:
// hr = CoCreateInstance(CLSID_CServiceConfig, NULL, CLSCTX_INPROC_SERVER, 
//   IID_IUnknown, (void**)&amp;pUnknownCSC);

// Enter the Service Domain.
HRESULT hr = CoEnterServiceDomain(pUnknownCSC);
if (FAILED(hr)) throw(hr);

// Do the work that uses COM+ services here.
//DoMyWork();

// Leave the Service Domain.
CoLeaveServiceDomain(NULL);
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/ComSvcs/nf-comsvcs-coenterservicedomain"><strong>CoEnterServiceDomain</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/ComSvcs/nf-comsvcs-coleaveservicedomain"><strong>CoLeaveServiceDomain</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="configuring-com--services-with-cserviceconfig.html">Configuring COM+ Services with CServiceConfig</a></p>
<!-- raw HTML omitted -->
<p><a href="cserviceconfig.html"><strong>CServiceConfig</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="using-com--services-through-cocreateactivity.html">Using COM+ Services Through CoCreateActivity</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
