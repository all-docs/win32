<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>The COM+ Event Class Object</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The COM+ Events service uses an event class object to manage the connection between publisher and subscriber.
ms.assetid: 877c5890-588d-4978-8fb2-b4ecf4134068
title: The COM+ Event Class Object
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>The COM+ Event Class Object</h1>
<p>The COM+ Events service uses an <em>event class object</em> to manage the connection between publisher and subscriber. The event class object is a COM+ component that is managed and stored by the COM+ Events system and contains the interfaces and methods used by a publisher to fire events. It is a persistent object that indicates the events that can occur and, optionally, identifies the publisher. You specify the interfaces and methods you want an event class to contain by providing a type library.</p>
<p>To fire an event, the publisher instantiates the event class object by calling <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> or the Microsoft Visual Basic <strong>CreateObject</strong> method and requesting the event interface be returned. The instantiated event class object contains the event system's implementation of the requested interface. An interested subscriber must also implement the event class interface to receive events from a given publisher. When the event class object is instantiated, the event system associates it with the appropriate subscribers. The list of subscribers is maintained for the lifetime of the event class object. An event can be delivered to multiple subscribers either serially or in parallel.</p>
<p>When you implement an event class object, you should provide a self-registering DLL that exports the <a href="/windows/desktop/api/olectl/nf-olectl-dllregisterserver"><strong>DllRegisterServer</strong></a> and <a href="/windows/desktop/api/olectl/nf-olectl-dllunregisterserver"><strong>DllUnregisterServer</strong></a> functions. The <strong>DllRegisterServer</strong> function registers a COM class, and the <strong>DllUnregisterServer</strong> function unregisters the component. Event class objects are stored in the COM+ catalog, either by using the Component Services administration tool or programmatically by using the methods of the <a href="/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installeventclass"><strong>ICOMAdminCatalog::InstallEventClass</strong></a> or <a href="/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installmultipleeventclasses"><strong>ICOMAdminCatalog::InstallMultipleEventClasses</strong></a> interfaces. For detailed information about registering event class objects, see <a href="registering-an-event-class.html">Registering an Event Class</a>.</p>
<p>Because event class objects are configured components, other attributes, such as queuing, transactions, security, and so on, can be configured for them by using either the Component Services administration tool or the COM+ Administrative SDK functions.</p>
<blockquote>
<p>[!Note]<br />
The COM+ Events service uses type library marshaling. This places some restrictions on event class interfaces. For example, the type library marshaler does not support the MIDL attributes <a href="/windows/desktop/Midl/size-is"><strong>size_is</strong></a> and <a href="/windows/desktop/Midl/length-is"><strong>length_is</strong></a>.</p>
</blockquote>
<p>Â </p>
<p>An event class object possesses publication attributes that determine the way events are published, as well as the following properties:</p>
<ul>
<li><strong>EventCLSID</strong>. A unique identifier that specifies the CLSID of the component.</li>
<li><strong>EventClassName</strong>. A unique identifier that specifies the PROGID of the component.</li>
<li><strong>TypeLibrary</strong>. Provides a list of interfaces offered by the event class object. There is no need to implement the firing interfaces specified in the type library.</li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="com--events-security-considerations.html">COM+ Events Security Considerations</a></p>
<!-- raw HTML omitted -->
<p><a href="filtering-events-in-com-.html">Filtering Events in COM+</a></p>
<!-- raw HTML omitted -->
<p><a href="publishing-and-delivering-events-in-com-.html">Publishing and Delivering Events in COM+</a></p>
<!-- raw HTML omitted -->
<p><a href="subscriptions.html">Subscriptions</a></p>
<!-- raw HTML omitted -->
<p><a href="using-com--events-with-com--queued-components.html">Using COM+ Events with COM+ Queued Components</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
