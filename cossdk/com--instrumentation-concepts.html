<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>COM+ Instrumentation Concepts</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The COM+ instrumentation service enables you to build your own COM+ event management and logging programs when you want to display various performance metrics for your COM+ components.
ms.assetid: 07f68734-a382-4fe5-86af-90805f61c68d
title: COM+ Instrumentation Concepts
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>COM+ Instrumentation Concepts</h1>
<p>The COM+ instrumentation service enables you to build your own COM+ event management and logging programs when you want to display various performance metrics for your COM+ components. COM+ instrumentation can also be used to configure user-defined events and to convert COM+ events to Visual Studio Analyzer (VSA) format when you are upgrading MTS packages that are receiving MTS events.</p>
<blockquote>
<p>[!Note]<br />
As of Windows ServerÂ 2003, only administrators have read access privileges to the trace logs for system events.</p>
</blockquote>
<p>Â </p>
<p>By subscribing to the events published by the system events publisher, clients can implement the <a href="com--instrumentation-interfaces.html">COM+ instrumentation interfaces</a> to receive notifications for a variety of COM+ performance metrics, such as information about specific COM+ objects, COM+ applications, and COM+ services. The metrics are published to the client by using the <a href="com--events.html">COM+ events service</a>, a loosely coupled events (LCE) system that stores event information from different publishers in an event store in the COM+ catalog.</p>
<blockquote>
<p>[!Note]<br />
COM+ instrumentation does not guarantee the delivery of an event.</p>
</blockquote>
<p>Â </p>
<p>Every metric has a timestamp that indicates the time when the metric was generated, not the time that it was dispatched or received. The client can correlate the timestamp and find out the cost of running a COM+ application, the cost of a transaction executed inside a COM+ application, or the cost of a method call inside of a COM+ application.</p>
<p>You can also use the COM+ Instrumentation service to filter for the specific performance metrics information that you want to see. For example, when you subscribe to a COM+ instrumentation interface or method, you can specify properties for the subscription in the <a href="/windows/win32/api/comsvcs/ns-comsvcs-comsvcseventinfo"><strong>COMSVCSEVENTINFO</strong></a> structure, such as the application ID (<strong>guidApp</strong> member) or the process ID (<strong>dwPid</strong> member).</p>
<p>When the application ID is specified, you receive only the metrics from the specified application. When the process ID is specified, you receive metrics from the specified server application and library applications that are loaded in that process. The user can specify both the application ID and the process ID, but the application ID has to be that of the server application running in the process with the specified process ID. If neither is specified, the user receives metrics from all the server and library applications.</p>
<p>The COM+ instrumentation metrics provide enough information for the monitoring application to correlate them with the operating system metrics for performance analysis, capacity planning, and for modeling and prediction.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="com--instrumentation-interfaces.html">COM+ Instrumentation Interfaces</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
