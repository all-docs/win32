<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>COM+ Dispenser Manager</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The dispenser manager provides resource pooling for the resource dispensers and ensures that a resource supplied by a resource dispenser is correctly enlisted in the application objects transaction.
ms.assetid: c8986943-56a1-4668-9e80-7ab2a42333a8
title: COM+ Dispenser Manager
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>COM+ Dispenser Manager</h1>
<p>The dispenser manager provides resource pooling for the resource dispensers and ensures that a resource supplied by a resource dispenser is correctly enlisted in the application object's transaction. The dispenser manager automatically reclaims resources that are still reserved at the end of an object's lifetime, eliminating the possibility of resource &quot;leaks.&quot; The dispenser manager can ask a resource dispenser to create a new resource or to destroy idle resources when necessary to adjust inventory levels, rather than using static settings.</p>
<blockquote>
<p>[!Note]<br />
Because resource dispenser interfaces exposed to the application are not required to be COM interfaces, the dispenser manager can be used in a process without initializing COM, for example, to support the ODBC resource dispenser.</p>
</blockquote>
<p>Â </p>
<p>Upon resource creation, the resource dispenser may specify how long an idle resource is allowed to remain in the pool before it's destroyed. A thread that runs in the dispenser manager is always looking for these idle resources.</p>
<h2>The Inventory Statistics Manager</h2>
<p>The dispenser manager uses the <em>inventory statistics manager</em> to manage pool resource inventory levels. The inventory statistics manager maintains a record of when each resource was used and removes resources from inventory when they have not been used for <em>x</em> seconds, where the value of <em>x</em> is set per resource when the resource is created.</p>
<h2>The Holder Component</h2>
<p>The dispenser manager polls each <em>holder</em>, a component created by the dispenser manager that lists the resource inventory for each resource dispenser, every 10 seconds to allow it to readjust its resource inventory. Each holder calls the inventory statistics manager to suggest inventory levels for each type of resource. As a result, the holder may ask the resource dispenser to either create or destroy some inventory.</p>
<p>The holder and resource dispenser communicate to request resources of a particular type. The following relationships exist between the holder and resource dispenser:</p>
<ul>
<li>The holder can request a resource from the resource dispenser. The resource dispenser either returns an available resource or creates a new one.</li>
<li>The holder can notify the resource dispenser that an application no longer needs a resource and then return it to the resource pool.</li>
<li>The holder and the resource dispenser work together to maintain the size of the resource pool.</li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="com--resource-dispenser-concepts.html">COM+ Resource Dispenser Concepts</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
