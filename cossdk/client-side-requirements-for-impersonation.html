<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Client-Side Requirements for Impersonation</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Client-Side Requirements for Impersonation
ms.assetid: c2d20233-93c6-4d2d-946d-8abccbeb3c5e
title: Client-Side Requirements for Impersonation
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Client-Side Requirements for Impersonation</h1>
<p>The following two settings can be specified relative to impersonation on the client side:</p>
<ul>
<li>Impersonation level, which indicates the client's willingness to have the server use its identity.</li>
<li>A setting in the Active Directory Service through which the client account can be marked &quot;Account is sensitive and cannot be delegated,&quot; which will disable delegation.</li>
</ul>
<p>The impersonation level can be set in a variety of ways. If the client does not indicate an impersonation level, the machine-wide default will be used by COM. The machine-wide default can be set using either the Component Services administrative tool or Dcomcnfg.exe. The client can also indicate a preferred impersonation level administratively with Dcomcnfg.exe.</p>
<p>The client can indicate the impersonation level programmatically, using either <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cosetproxyblanket"><strong>CoSetProxyBlanket</strong></a>â€”equivalent to <a href="/windows/desktop/api/objidl/nf-objidl-iclientsecurity-setblanket"><strong>IClientSecurity::SetBlanket</strong></a>, which can be called as often as necessaryâ€”or <a href="/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity"><strong>CoInitializeSecurity</strong></a>, which can be called once per process.</p>
<p>If the client indicates delegate-level impersonationâ€”the broadest authority it can grant to the serverâ€”the client should be running under an identity that is properly configured in the Active Directory Service to enable its identity to be delegated.</p>
<p>For more detail regarding impersonation levels and the requirements for delegation to work, see <a href="/windows/desktop/com/delegation-and-impersonation">Delegation and Impersonation</a>.</p>
<p>COM+ applications can always act as clients, of course. When the COM+ application makes a call to another application or resource, it expresses an impersonation level. For COM+ server applications, you can set an impersonation level administratively. COM+ library applications cannot set their own impersonation level; they use that of the host process instead. To learn how to set impersonation for a COM+ application, see <a href="setting-an-impersonation-level.html">Setting an Impersonation Level</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="client-impersonation-and-delegation.html">Client Impersonation and Delegation</a></p>
<!-- raw HTML omitted -->
<p><a href="cloaking.html">Cloaking</a></p>
<!-- raw HTML omitted -->
<p><a href="server-side-requirements-for-impersonation.html">Server-Side Requirements for Impersonation</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
