<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>COM+ Synchronization Concepts</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Generally, synchronization is not required when you have a single-threaded apartment (STA) because the apartment provides the synchronization for you.
ms.assetid: a05de040-0115-44aa-80e2-55eff2ec894d
title: COM+ Synchronization Concepts
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>COM+ Synchronization Concepts</h1>
<p>Generally, synchronization is not required when you have a single-threaded apartment (STA) because the apartment provides the synchronization for you. Synchronization becomes important when you have a multithreaded apartment (MTA) and a free-threaded object. In the past, free-threaded objects have had to handle locking. You can eliminate the need to use locking by setting the synchronization attribute for a component.</p>
<p>Synchronization has the following properties:</p>
<ul>
<li>Allows one caller to enter the component at a time.</li>
<li>Prohibits flow across process or across computer.</li>
<li>Flows from component to component within a process.</li>
<li>Allows reentrancy from the same caller.</li>
</ul>
<p>Unlike apartments, activities span contexts from multiple processes and hosts. Synchronization determines which activity will contain an object. Objects can reside in any of the following activities:</p>
<ul>
<li>Creator's activity</li>
<li>New activity</li>
<li>No activity</li>
</ul>
<p>COM+ ensures concurrency by a series of locks for each activity. If a caller tries to enter a COM+ synchronized component that is already being used by another caller, the call is blocked until the lock is released. This blocking behavior will not time out and cannot be configured to time out. If the lock is not in use, the lock is acquired and the call is processed. After completing, the lock is released for the next caller. To prevent deadlock, COM+ manages access to all objects across activities by a nested series of calls chained throughout the network.</p>
<p>COM+ provides the following synchronization settings:</p>
<ul>
<li>Disabled</li>
<li>Not Supported</li>
<li>Supported</li>
<li>Required</li>
<li>Requires New</li>
</ul>
<blockquote>
<p>[!Note]<br />
Some synchronization settings work in conjunction with other COM+ component settings. For example, synchronization is required if the <a href="com--just-in-time-activation.html">COM+ just-in-time (JIT) activation</a> service is enabled. JIT is required if you enable transactions; therefore, COM+ <a href="com--transactions.html">transaction processing</a> requires synchronization as well. So, classes with the setting of JIT=True must also have the setting of either Synchronization=Required or Synchronization=RequiresNew.</p>
</blockquote>
<p>Â </p>
<p>For instructions about setting synchronization options by using the Component Services administrative tool, see <a href="setting-the-synchronization-attribute.html">Setting the Synchronization Attribute</a>.</p>
<p>To obtain more information on using the COM+ Administration Library to set synchronization options, see <a href="automating-com--administration.html">Automating COM+ Administration</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="com--synchronization-tasks.html">COM+ Synchronization Tasks</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
