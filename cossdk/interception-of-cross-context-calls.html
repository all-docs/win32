<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Interception of Cross-Context Calls</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: When an object is activated in a given context, subsequent calls to or from it, within the context, are handled differently than calls across the context boundary.
ms.assetid: 9e234b41-f269-4674-adc4-12018277a14b
title: Interception of Cross-Context Calls
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Interception of Cross-Context Calls</h1>
<p>When an object is activated in a given context, subsequent calls to or from it, within the context, are handled differently than calls across the context boundary. Calls across the context boundary are handled with lightweight proxies. These proxies handle whatever mediation is required to adjust the run-time environment from one that accommodates the caller to one that accommodates the callee. This process is known as <em>interception</em>.</p>
<p>Cross-context call interception is necessary because objects in different contexts have different run-time requirementsâ€”this is precisely the reason for contexts. COM+ intercepts any object references that you pass as method parameters and automatically converts them to proxies so that they are usable in the new context.</p>
<p>If you share object references across context boundaries by other meansâ€”for example, in global variablesâ€”you should always use <a href="/windows/desktop/api/combaseapi/nf-combaseapi-comarshalinterface"><strong>CoMarshalInterface</strong></a> and <a href="/windows/desktop/api/combaseapi/nf-combaseapi-counmarshalinterface"><strong>CoUnmarshalInterface</strong></a>. These functions can translate an object reference into a proxy usable in a different context. Never share a raw object reference across context boundaries.</p>
<p>The behavior of calls across context can have unwanted consequences in the case of objects exposing interfaces that cannot be marshaled. In this circumstance, you are likely to want to insist that the object that cannot be marshaled be activated only in the context of its caller and never in its own context. You can do this by selecting the <strong>Must be activated in caller's context</strong> option on the <strong>Activation</strong> tab of the component <strong>Properties</strong> page. (See <a href="enforcing-activation-in-the-caller-s-context.html">Enforcing Activation in the Caller's Context</a> for step-by-step instructions.)</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="context-activation.html">Context activation</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
