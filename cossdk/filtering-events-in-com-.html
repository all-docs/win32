<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Filtering Events in COM+</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: 'COM+ Events provides two ways to control which events reach which subscribers: publisher filtering and parameter filtering.'
ms.assetid: dfc82a57-5587-462d-a43d-516b7d70e25e
title: Filtering Events in COM+
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Filtering Events in COM+</h1>
<p>COM+ Events provides two ways to control which events reach which subscribers: <em>publisher filtering</em> and <em>parameter filtering</em>.</p>
<h2>Publisher Filtering</h2>
<p>Publisher filtering controls the order and firing of an event method by an <a href="the-com--event-class-object.html">event class</a> object. Publisher filtering allows the publisher to determine which subscribers receive a particular event.</p>
<p>An example of effective use of publisher filtering is that of a stock exchange. Most subscribers want to know when a new stock is added. However, many of these same subscribers may not want to know whenever each stock price changes. Publisher filtering provides the granularity required to effectively deliver events to only the subscribers who want this information.</p>
<p>When a method is invoked on the instantiated event class object, it collects any publisher filters on that method. The filter forces the event object to fire the event method to a specific subscriber. The filter determines which subscriptions to fire and in which order to fire them. For example, the filter could read the subscription list and create the order based on some application criteria and then call the subscribers in that order.</p>
<p>For detailed instructions on creating a publisher filter, see <a href="creating-a-publisher-filter.html">Creating a Publisher Filter</a>.</p>
<h2>Parameter Filtering</h2>
<p>In contrast to publisher filtering, the COM+ Events service provides an optional subscriber parameter filtering for each subscription and each event method invocation. Parameter filtering evaluates the subscription FilterCriteria property against the parameters of the event method. This type of filtering is used on a per-method, per-subscription basis and provides a level of subscriber filtering at the event source. The filter criteria string recognizes relational operators for checking equality (=, ==, !, !=, ~, ~=, &lt;&gt;), nested parentheses, and logical keywords <strong>AND</strong>, <strong>OR</strong>, or <strong>NOT</strong>.</p>
<p>Parameter filtering occurs after any publisher filtering and when the standard event object is fired for a given subscription. If publisher filtering is used, parameter filtering occurs only when the publisher filter invokes <a href="/windows/desktop/api/EventSys/nf-eventsys-ifiringcontrol-firesubscription"><strong>IFiringControl::FireSubscription</strong></a>. Because of this, publisher filtering and parameter filtering can compose together but publisher filtering takes precedence.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="publishing-and-delivering-events-in-com-.html">Publishing and Delivering Events in COM+</a></p>
<!-- raw HTML omitted -->
<p><a href="subscriptions.html">Subscriptions</a></p>
<!-- raw HTML omitted -->
<p><a href="the-com--event-class-object.html">The COM+ Event Class Object</a></p>
<!-- raw HTML omitted -->
<p><a href="using-com--events-with-com--queued-components.html">Using COM+ Events with COM+ Queued Components</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
