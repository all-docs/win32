<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Debugging Compiled Visual Basic Components</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Given that in many cases you will be able to debug only a portion of your components functionality within the Microsoft Visual Basic environment, there will be situations in which you will need to debug components built with Visual Basic after they have been compiled. Since the Visual Basic environment doesnt enable this, you must instead use the Microsoft Visual C++ environment.
ms.assetid: a58c5884-3c2d-4699-8b19-277003912dfd
title: Debugging Compiled Visual Basic Components
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Debugging Compiled Visual Basic Components</h1>
<p>Given that in many cases you will be able to debug only a portion of your component's functionality within the Microsoft Visual Basic environment, there will be situations in which you will need to debug components built with Visual Basic after they have been compiled. Since the Visual Basic environment doesn't enable this, you must instead use the Microsoft Visual C++ environment.</p>
<p><strong>To debug a Visual Basic component in the Visual C++ environment</strong></p>
<ol>
<li>
<p>In Visual Basic 6.0, open the Visual Basic project that you want to debug.</p>
</li>
<li>
<p>On the <strong>File</strong> menu, click <strong>Make YourProject.dll</strong>.</p>
</li>
<li>
<p>In the <strong>Make Project</strong> dialog box, click <strong>Options</strong>.</p>
</li>
<li>
<p>In the <strong>Project Properties</strong> dialog box, on the <strong>Compile</strong> tab, click <strong>Compile to Native Code</strong> and <strong>No Optimization</strong> and select the <strong>Create Symbolic Debug Info</strong> check box.</p>
</li>
<li>
<p>Click <strong>OK</strong>, and then click <strong>OK</strong> again to compile your project.</p>
</li>
<li>
<p>Move the compiled DLL to the location where COM+ applications are normally installed.</p>
<blockquote>
<p>[!Note]<br />
If you don't move the DLL, you may get an error message informing you that symbolic debugging information for the DLL could not be located. If you have trouble getting the debugger to stop at breakpoints in your component, confirm that the DLL is in the standard packages directory, delete the component from its package, and re-add the component.</p>
</blockquote>
<p>Â </p>
</li>
<li>
<p>Start Visual C++.</p>
</li>
<li>
<p>On the <strong>File</strong> menu, click <strong>Open Workspace</strong>.</p>
</li>
<li>
<p>In the <strong>Open Workspace</strong> dialog box, set <strong>Files of Type</strong> to <strong>All files(*.*)</strong>, select your compiled component, and click <strong>Open</strong>.</p>
</li>
<li>
<p>From the <strong>File</strong> menu, click <strong>Open</strong> (not <strong>Open Workspace</strong>) and open the Visual Basic module (.bas), form (.frm), or class (.cls) that you want to debug.</p>
</li>
<li>
<p>On the <strong>Project</strong> menu, click <strong>Settings</strong>.</p>
</li>
<li>
<p>In the <strong>Project Settings</strong> dialog box, on the <strong>Debug</strong> tab, select <strong>General</strong> in the <strong>Category</strong> box.</p>
</li>
<li>
<p>In the <strong>Executable for debug session</strong> box, enter the fully qualified path for Dllhost.exe, followed by an argument specifying the process ID of the COM+ application containing the component. You will find the process ID on the <strong>General</strong> tab of the COM+ application's <strong>Properties</strong> dialog box. Following is an example: C:\Winnt\System32\Dllhost.exe /ProcessID:{&lt;processID&gt;}.</p>
</li>
<li>
<p>Click <strong>OK</strong>.</p>
</li>
</ol>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="com--visual-basic-debugging-support-contrasted-with-mts.html">COM+ Visual Basic Debugging Support Contrasted with MTS</a></p>
<!-- raw HTML omitted -->
<p><a href="debugging-in-the-visual-basic-ide.html">Debugging in the Visual Basic IDE</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
