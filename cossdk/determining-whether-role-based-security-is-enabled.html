<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Determining Whether Role-Based Security Is Enabled</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Determining Whether Role-Based Security Is Enabled
ms.assetid: b5e6ab7e-5a77-4c6f-9bec-02942bba389d
title: Determining Whether Role-Based Security Is Enabled
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Determining Whether Role-Based Security Is Enabled</h1>
<p>By using the <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-isecuritycallcontext-issecurityenabled"><strong>ISecurityCallContext::IsSecurityEnabled</strong></a> method available from the security call context object, you can determine whether security is enabled for the current object. You should call <strong>IsSecurityEnabled</strong> before you use ISecurityCallContext::<a href="/windows/desktop/api/ComSvcs/nf-comsvcs-isecuritycallcontext-iscallerinrole"><strong>IsCallerInRole</strong></a> to check role membership because <strong>IsCallerInRole</strong> returns True if security is not enabled.</p>
<p>Microsoft Visual Basic developers call <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-igetsecuritycallcontext-getsecuritycallcontext"><strong>GetSecurityCallContext</strong></a> to obtain a reference to a <a href="securitycallcontext.html"><strong>SecurityCallContext</strong></a> object and then call <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-isecuritycallcontext-issecurityenabled"><strong>IsSecurityEnabled</strong></a>, as shown in the following example:</p>
<pre lang="VB"><code>Dim objSecCallCtx As SecurityCallContext
Dim boolSecEn As Boolean
Set objSecCallCtx = GetSecurityCallContext()
boolSecEn = objSecCallCtx.IsSecurityEnabled()
 
</code></pre>
<p>Microsoft Visual C++ developers can call <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-isecuritycallcontext-issecurityenabled"><strong>ISecurityCallContext::IsSecurityEnabled</strong></a> by calling <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cogetcallcontext"><strong>CoGetCallContext</strong></a> to obtain a pointer to <a href="/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext"><strong>ISecurityCallContext</strong></a> and then calling <strong>IsSecurityEnabled</strong>. A brief example follows:</p>
<pre lang="C++"><code>ISecurityCallContext* pSecCtx;
VARIANT_BOOL bIsEnabled;

HRESULT hr1 = CoGetCallContext(IID_ISecurityCallContext, (void**)&amp;pSecCtx);
if (FAILED(hr1)) throw(hr1);
if (NULL == pSecCtx) {
    // Display error message.
    return E_FAIL;
}

HRESULT hr2 = pSecCtx-&gt;IsSecurityEnabled(&amp;bIsEnabled);
return hr2;
</code></pre>
<p>Although the preferred way to call <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-isecuritycallcontext-issecurityenabled"><strong>IsSecurityEnabled</strong></a> is by using the security call context object, you can also call <strong>IsSecurityEnabled</strong> through the object context. (See <a href="/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext"><strong>ObjectContext</strong></a> or <a href="/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext"><strong>IObjectContext</strong></a> for more information.)</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="accessing-security-call-context-information.html">Accessing Security Call Context Information</a></p>
<!-- raw HTML omitted -->
<p><a href="checking-role-membership.html">Checking Role Membership</a></p>
<!-- raw HTML omitted -->
<p><a href="programmatic-component-security.html">Programmatic Component Security</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
