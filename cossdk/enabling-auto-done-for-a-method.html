<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Enabling Auto-Done for a Method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Enabling Auto-Done for a Method
description: You can enable the auto-done feature for any method exposed by a component for which COM+ JIT activation is enabled. If JIT activation is disabled, auto-done is unavailable.
ms.assetid: d699b85c-441f-4ea6-8d03-d1fa9a8a357f
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Enabling Auto-Done for a Method</h1>
<p>You can enable the auto-done feature for any method exposed by a component for which COM+ JIT activation is enabled. If JIT activation is disabled, auto-done is unavailable.</p>
<p>You should enable auto-done only for a method that has intentionally been written to take advantage of it because this feature can potentially change the expected behavior of the method.</p>
<p>When you enable auto-done, you are changing the default behavior of both JIT activation and automatic transactions for that method. You may want to use this feature because it can remove the necessity to explicitly declare consistency and doneness. This can instead be done by simply returning an HRESULT when auto-done is enabled. Essentially, when you enable auto-done, you are instructing COM+ to do the following:</p>
<ul>
<li>Set the done bit to True by default on the context in which the object runs whenever this method is called.</li>
<li>Inspect the HRESULT returned by the method; if it indicates SUCCESS or FAILURE, set the consistency bit accordingly. This can result in an automatic call to <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete"><strong>IObjectContext::SetComplete</strong></a> or <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort"><strong>IObjectContext::SetAbort</strong></a>, depending also on what the method does internally.</li>
</ul>
<p><strong>To enable auto-done for a method</strong></p>
<ol>
<li>
<p>In the details pane of the Component Services administrative tool, right-click the method that you want to configure and then click <strong>Properties</strong>.</p>
</li>
<li>
<p>In the method properties dialog box, click the <strong>General</strong> tab.</p>
</li>
<li>
<p>To enable auto-done, select the <strong>Automatically deactivate this object when this method returns</strong> check box. If the check box is unavailable, you must first enable JIT Activation for the component. (See <a href="enabling-jit-activation-for-a-component.html">Enabling JIT Activation for a Component</a> for detailed instructions.)</p>
</li>
<li>
<p>Click <strong>OK</strong>.</p>
</li>
</ol>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="com--just-in-time-activation-concepts.html">COM+ Just-in-Time Activation Concepts</a></p>
<!-- raw HTML omitted -->
<p><a href="enabling-jit-activation-for-a-component.html">Enabling JIT Activation for a Component</a></p>
<!-- raw HTML omitted -->
<p><a href="setting-the-done-bit.html">Setting the Done Bit</a></p>
<!-- raw HTML omitted -->
</body>
