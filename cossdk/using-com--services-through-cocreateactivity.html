<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using COM+ Services Through CoCreateActivity</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The CoCreateActivity function is used to submit batch work to the COM+ system. It allows script-based applications to support an application-wide COM+ service configuration.
ms.assetid: af734507-516c-43f1-9c5e-c77cde1b8008
title: Using COM+ Services Through CoCreateActivity
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using COM+ Services Through CoCreateActivity</h1>
<p>The <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-cocreateactivity"><strong>CoCreateActivity</strong></a> function is used to submit batch work to the COM+ system. It allows script-based applications to support an application-wide COM+ service configuration.</p>
<p>The desired COM+ services are configured through a <a href="cserviceconfig.html"><strong>CServiceConfig</strong></a> object that is passed in to the function. The function creates an activity object and returns the <a href="/windows/desktop/api/ComSvcs/nn-comsvcs-iserviceactivity"><strong>IServiceActivity</strong></a> interface of that object. The batch work can be submitted either synchronously or asynchronously, by using the <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iserviceactivity-synchronouscall"><strong>SynchronousCall</strong></a> or <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iserviceactivity-asynchronouscall"><strong>AsynchronousCall</strong></a> methods of <strong>IServiceActivity</strong>, respectively. A pointer to an <a href="/windows/desktop/api/ComSvcs/nn-comsvcs-iservicecall"><strong>IServiceCall</strong></a> interface is passed in to each of these methods, and the batch work is implemented by the developer in the <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-iservicecall-oncall"><strong>OnCall</strong></a> method of the <strong>IServiceCall</strong> interface.</p>
<h2>Component Services Administrative Tool</h2>
<p>Does not apply.</p>
<h2>Visual Basic</h2>
<p>Does not apply.</p>
<h2>C/C++</h2>
<p>The following code fragment illustrates how to use COM+ services through <a href="/windows/desktop/api/ComSvcs/nf-comsvcs-cocreateactivity"><strong>CoCreateActivity</strong></a>. Error handling is omitted for brevity. This code fragment uses the <a href="cserviceconfig.html"><strong>CServiceConfig</strong></a> object that was created and configured in <a href="configuring-com--services-with-cserviceconfig.html">Configuring COM+ Services with CServiceConfig</a>.</p>
<pre lang="C++"><code>// A CServiceConfig object was created as follows:
// hr = CoCreateInstance(CLSID_CServiceConfig, NULL, CLSCTX_INPROC_SERVER,
//   IID_IUnknown, (void**)&amp;pUnknownCSC);

// Create the activity for our services.
HRESULT hr = CoCreateActivity(pUnknownCSC, IID_IServiceActivity, (void**)&amp;pActivity);
if (FAILED(hr)) throw(hr);

// Do the batch work synchronously.
// The batch work is implemented in pServiceCall-&gt;OnCall().
hr = pActivity-&gt;SynchronousCall(pServiceCall);
if (FAILED(hr)) throw(hr);

</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/ComSvcs/nf-comsvcs-cocreateactivity"><strong>CoCreateActivity</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="configuring-com--services-with-cserviceconfig.html">Configuring COM+ Services with CServiceConfig</a></p>
<!-- raw HTML omitted -->
<p><a href="cserviceconfig.html"><strong>CServiceConfig</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="using-com--services-through-coenterservicedomain-and-coleaveservicedomain.html">Using COM+ Services Through CoEnterServiceDomain and CoLeaveServiceDomain</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
