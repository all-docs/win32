<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Neutral Apartments</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: COM+ introduces neutral apartments to simplify programming in multithreaded environments. The neutral apartment is the preferred model for COM+ for components with no user interface.
ms.assetid: 679742af-7c04-4b0e-822a-a43e1aafa936
title: Neutral Apartments
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Neutral Apartments</h1>
<p>COM+ introduces neutral apartments to simplify programming in multithreaded environments. The neutral apartment is the preferred model for COM+ for components with no user interface.</p>
<p>In the past, to prevent bottlenecks, COM+ developers requiring server scalability had to implement free-threaded components; however, free-threading models are complicated to implement because they must deal with interlocking access. In neutral apartments, objects follow the guidelines for multithreaded apartments but can execute on any kind of thread. When a thread is running in a neutral apartment, the object's context is received without causing a thread switch.</p>
<p>Each process can have only one neutral apartment. To select a neutral apartment, use the following registry setting:</p>
<pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID
Â Â Â {CLSID}
Â Â Â Â Â Â InprocServer32
Â Â Â Â Â Â Â Â Â ThreadingModel = Neutral
</code></pre>
<p>Components that have user interfaces should continue to use single-threaded apartments as the preferred model. To select a single-threaded apartment, use the following registry setting:</p>
<p><strong>ThreadingModel</strong> = Apartment</p>
<p>Â </p>
<p>Â </p>
</body>
