<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>COM+ CRM Interfaces</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The CRM interfaces are required to provide support for CRM Workers and CRM Compensators developed using Visual Basic and Visual C++.
ms.assetid: 68a75da7-1f35-41a4-8872-e3f4ad1fc30d
title: COM+ CRM Interfaces
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>COM+ CRM Interfaces</h1>
<p>The CRM interfaces are required to provide support for CRM Workers and CRM Compensators developed using Visual Basic and Visual C++.</p>
<p>You can use the COM+ Compensating Resource Manager (CRM) to quickly and easily integrate application resources with Microsoft Distributed Transaction Coordinator (DTC) transactions.</p>
<p>It is easier for components written with Visual Basic to build up a log record as a collection of Variants. Also, Visual Basic components are apartment threaded, which implies that it must be possible to marshal the interfaces from the multithreaded apartment to a single-threaded apartment. CRM components developed with Visual C++ could also use the Apartment threading model, although it is recommended that these use the Both threading model instead.</p>
<p>The interfaces described in the following table provide detailed reference information for developers of COM+ CRMs.</p>
<table>
<thead>
<tr>
<th>CRM interfaces</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/ComSvcs/nn-comsvcs-icrmcompensator"><strong>ICrmCompensator</strong></a></td>
<td>This interface delivers unstructured log records in Visual C++.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/ComSvcs/nn-comsvcs-icrmcompensatorvariants"><strong>ICrmCompensatorVariants</strong></a></td>
<td>This interface delivers structured log records to the CRM Compensator when using Visual Basic.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/ComSvcs/nn-comsvcs-icrmformatlogrecords"><strong>ICrmFormatLogRecords</strong></a></td>
<td>This interface converts the log records to viewable format so that they can be presented using a generic monitoring tool.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol"><strong>ICrmLogControl</strong></a></td>
<td>This interface is used by the CRM Worker and CRM Compensator to write records to the log and make them durable.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitor"><strong>ICrmMonitor</strong></a></td>
<td>This interface captures a snapshot of the current state of a CRM and holds a specific CRM clerk.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorclerks"><strong>ICrmMonitorClerks</strong></a></td>
<td>This interface obtains information about the state of clerks.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords"><strong>ICrmMonitorLogRecords</strong></a></td>
<td>This interface monitors the individual log records maintained by a specific CRM clerk for a given transaction.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="com--compensating-resource-manager-concepts.html">COM+ Compensating Resource Manager Concepts</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
