<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Database.CreateTransformSummaryInfo method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The CreateTransformSummaryInfo method of the Database object creates and populates the summary information stream of an existing transform file. This method fills in the properties with the base and reference ProductCode and ProductVersion.
ms.assetid: 67df9b9c-0e7c-49a6-a35e-5196327d6aff
title: Database.CreateTransformSummaryInfo method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Database.CreateTransformSummaryInfo
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Database.CreateTransformSummaryInfo method</h1>
<p>The <strong>CreateTransformSummaryInfo</strong> method of the <a href="database-object.html"><strong>Database</strong></a> object creates and populates the summary information stream of an existing transform file. This method fills in the properties with the base and reference <a href="productcode.html"><strong>ProductCode</strong></a> and <a href="productversion.html"><strong>ProductVersion</strong></a>.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>Database.CreateTransformSummaryInfo(
  reference,
  storage,
  errorConditions,
  validation
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>reference</em></p>
<!-- raw HTML omitted -->
<p>Required database that does not include the changes.</p>
<!-- raw HTML omitted -->
<p><em>storage</em></p>
<!-- raw HTML omitted -->
<p>The name of the generated transform file. This is optional.</p>
<!-- raw HTML omitted -->
<p><em>errorConditions</em></p>
<!-- raw HTML omitted -->
<p>Required error conditions that should be suppressed when the transform is applied. Combine one or more of the following error condition values.</p>
<table>
<thead>
<tr>
<th>Error condition name</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformErrorNone</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>None of the following conditions.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformErrorAddExistingRow</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Adds a row that already exists.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformErrorDeleteNonExistingRow</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Deletes a row that does not exist.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformErrorAddExistingTable</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->4<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Adds a table that already exists.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformErrorDeleteNonExistingTable</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->8<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Deletes a table that does not exist.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformErrorUpdateNonExistingRow</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->16<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Updates a row that does not exist.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformErrorChangeCodepage</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Transform and database code pages do not match and neither code page is neutral.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>validation</em></p>
<!-- raw HTML omitted -->
<p>Required when the transform is applied to a database; shows which properties should be validated to verify that this transform can be applied to the database. The properties are all contained in the <a href="summary-information-stream-property-set.html">Summary Information Stream Property Set</a>.</p>
<p>Combine one or more of the following values.</p>
<table>
<thead>
<tr>
<th>Validation flag</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformValidationNone</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>No validation done.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformValidationLanguage</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Default language must match base database.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformValidationProduct</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Product must match base database.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>To validate product version, first choose one or more of these three flags to indicate how much of the version is to be verified.</p>
<table>
<thead>
<tr>
<th>Validation flag</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformValidationMajorVer</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->8<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Checks major version only.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformValidationMinorVer</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->16<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Checks major and minor version only.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformValidationUpdateVer</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Checks major, minor, and update versions.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Then choose one of the following to indicate the required relationship between the product version of the database the transform is being applied to and that of the base database.</p>
<table>
<thead>
<tr>
<th>Validation flag</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformValidationLess</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->64<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Applied version <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformValidationLessOrEqual</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->128<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Applied version <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformValidationEqual</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->256<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Applied version = base version<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformValidationGreaterOrEqual</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->512<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Applied version &gt;= base version<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformValidationGreater</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1024<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Applied version &gt; base version<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>To validate that the transform is being applied to a package having the appropriate <a href="upgradecode.html"><strong>UpgradeCode</strong></a>, set the following flag.</p>
<table>
<thead>
<tr>
<th>Validation flag</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiTransformValidationUpgradeCode</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2048<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Validates that the transform is the appropriate <a href="upgradecode.html"><strong>UpgradeCode</strong></a>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>To create a summary information stream for a transform, the <a href="productcode.html"><strong>ProductCode</strong></a> and <a href="productversion.html"><strong>ProductVersion</strong></a> properties must be defined in the <a href="property-table.html">Property</a> tables of both the base and reference databases. If msiTransformValidationUpgradeCode is used, the <a href="upgradecode.html"><strong>UpgradeCode</strong></a> property must be defined in both databases.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows Server 2012, Windows 8, Windows Server 2008 R2 or Windows 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows Server 2008 or Windows Vista. Windows Installer on Windows Server 2003 or Windows XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IDatabase is defined as 000C109D-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="database-transforms.html">Database Transforms</a></p>
<!-- raw HTML omitted -->
</body>
