<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Upgrade Table</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The Upgrade table contains information required during major upgrades.
ms.assetid: f5fda405-8a09-495e-aa8c-b808a2f02b0f
title: Upgrade Table
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Upgrade Table</h1>
<p>The Upgrade table contains information required during <a href="major-upgrades.html">major upgrades</a>. To fully enable the installer's upgrade capabilities, every package should have an <a href="upgradecode.html"><strong>UpgradeCode</strong></a> property and an Upgrade table. Each record in the Upgrade table gives a characteristic combination of upgrade code, product version, and language information used to identify a set of products affected by the upgrade. When the <a href="findrelatedproducts-action.html">FindRelatedProducts</a> action detects an affected product installed on the system, it appends the product code to a property specified in the ActionProperty column. The <a href="removeexistingproducts-action.html">RemoveExistingProducts</a> action and the <a href="migratefeaturestates-action.html">MigrateFeatureStates</a> action only remove or migrate products listed in the ActionProperty column.</p>
<p>The Upgrade table contains the columns shown in the following table.</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Key</th>
<th>Nullable</th>
</tr>
</thead>
<tbody>
<tr>
<td>UpgradeCode</td>
<td><a href="guid.html">GUID</a></td>
<td>Y</td>
<td>N</td>
</tr>
<tr>
<td>VersionMin</td>
<td><a href="text.html">Text</a></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td>VersionMax</td>
<td><a href="text.html">Text</a></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td>Language</td>
<td><a href="text.html">Text</a></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td>Attributes</td>
<td><a href="integer.html">Integer</a></td>
<td>Y</td>
<td>N</td>
</tr>
<tr>
<td>Remove</td>
<td><a href="formatted.html">Formatted</a></td>
<td>N</td>
<td>Y</td>
</tr>
<tr>
<td>ActionProperty</td>
<td><a href="identifier.html">Identifier</a></td>
<td>N</td>
<td>N</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Columns</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->UpgradeCode</p>
<!-- raw HTML omitted -->
<p>The <a href="upgradecode.html">UpgradeCode</a> property in this column specifies the upgrade code of all products that are to be detected by the <a href="findrelatedproducts-action.html">FindRelatedProducts</a> action.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->VersionMin</p>
<!-- raw HTML omitted -->
<p>Lower boundary of the range of product versions detected by <a href="findrelatedproducts-action.html">FindRelatedProducts</a>. Enter <strong>msidbUpgradeAttributesVersionMinInclusive</strong> in Attributes to include VersionMin in the range. If VersionMin equals an empty string (&quot;&quot;) it is evaluated the same as 0. If VersionMin is null, FindRelatedProducts ignores <strong>msidbUpgradeAttributesVersionMinInclusive</strong> and detects all previous versions. VersionMin and VersionMax must not both be null.</p>
<p>VersionMin must be a valid product version as described for the <a href="productversion.html"><strong>ProductVersion</strong></a> property. Note that Windows Installer uses only the first three fields of the product version. If you include a fourth field in your product version, the installer ignores the fourth field.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->VersionMax</p>
<!-- raw HTML omitted -->
<p>Upper boundary of the range of product versions detected by the <a href="findrelatedproducts-action.html">FindRelatedProducts</a> action. Enter <strong>msidbUpgradeAttributesVersionMaxInclusive</strong> in Attributes to include VersionMax in the range. If VersionMax is an empty string (&quot;&quot;), it is evaluated the same as 0. If VersionMax is null, FindRelatedProducts ignores <strong>msidbUpgradeAttributesVersionMaxInclusive</strong> and detects all product versions greater than (or greater than or equal to) the lower boundary specified by VersionMin and <strong>msidbUpgradeAttributesVersionMinInclusive</strong>. VersionMin and VersionMax must not both be null.</p>
<p>VersionMax must be a valid product version as described for the <a href="productversion.html"><strong>ProductVersion</strong></a> property. Note that Windows Installer uses only the first three fields of the product version. If you include a fourth field in your product version, the installer ignores the fourth field.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Language</p>
<!-- raw HTML omitted -->
<p>The set of languages detected by <a href="findrelatedproducts-action.html">FindRelatedProducts</a>. Enter a list of numeric language identifiers (LANGID) separated by commas. Enter <strong>msidbUpgradeAttributesLanguagesExclusive</strong> in Attributes to detect all languages exclusive of those listed in Language. If Language is null or an empty string (&quot;&quot;), FindRelatedProducts ignores <strong>msidbUpgradeAttributesLanguagesExclusive</strong> and detects all languages.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Attributes</p>
<!-- raw HTML omitted -->
<p>This column contains bit flags specifying attributes of the Upgrade table.</p>
<table>
<thead>
<tr>
<th>Bit flag name</th>
<th>Decimal</th>
<th>Hexadecimal</th>
<th>Attribute</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>msidbUpgradeAttributesMigrateFeatures</strong></td>
<td>1</td>
<td>0x001</td>
<td>Migrates feature states by enabling the logic in the <a href="migratefeaturestates-action.html">MigrateFeatureStates</a> action.</td>
</tr>
<tr>
<td><strong>msidbUpgradeAttributesOnlyDetect</strong></td>
<td>2</td>
<td>0x002</td>
<td>Detects products and applications but does not remove.</td>
</tr>
<tr>
<td><strong>msidbUpgradeAttributesIgnoreRemoveFailure</strong></td>
<td>4</td>
<td>0x004</td>
<td>Continues installation upon failure to remove a product or application.</td>
</tr>
<tr>
<td><strong>msidbUpgradeAttributesVersionMinInclusive</strong></td>
<td>256</td>
<td>0x100</td>
<td>Detects the range of versions including the value in VersionMin.</td>
</tr>
<tr>
<td><strong>msidbUpgradeAttributesVersionMaxInclusive</strong></td>
<td>512</td>
<td>0x200</td>
<td>Detects the range of versions including the value in VersionMax.</td>
</tr>
<tr>
<td><strong>msidbUpgradeAttributesLanguagesExclusive</strong></td>
<td>1024</td>
<td>0x400</td>
<td>Detects all languages, excluding the languages listed in the Language column.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Remove</p>
<!-- raw HTML omitted -->
<p>The installer sets the <a href="remove.html"><strong>REMOVE</strong></a> property to features specified in this column. The features to be removed can be determined at run time. The <a href="formatted.html">Formatted</a> string entered in this field must evaluate to a comma-delimited list of feature names. For example: [Feature1],[Feature2],[Feature3]. No features are removed if the field contains formatted text that evaluates to an empty string (&quot;&quot;). The installer sets REMOVE=ALL only if the Remove field is empty. Note the difference between an empty string and empty field. If the field is empty, it is null.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ActionProperty</p>
<!-- raw HTML omitted -->
<p>When the <a href="findrelatedproducts-action.html">FindRelatedProducts</a> action detects a related product installed on the system, it appends the product code to the property specified in this field. The property specified in this column must be a public property and the package author must add the property to the <a href="securecustomproperties.html"><strong>SecureCustomProperties</strong></a> property. Each row in the Upgrade table must have a unique ActionProperty value. After FindRelatedProducts, the value of this property is a list product codes, separated by semicolons (;), detected on the system.</p>
<!-- raw HTML omitted -->
<h2>Validation</h2>
<!-- raw HTML omitted -->
<p><a href="ice03.html">ICE03</a><br />
<a href="ice06.html">ICE06</a><br />
<a href="ice46.html">ICE46</a><br />
<a href="ice61.html">ICE61</a><br />
<a href="ice66.html">ICE66</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
