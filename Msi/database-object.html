<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Database object</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The Database object accesses an installer database.
ms.assetid: 97765884-3e1c-486a-932c-6430b113fac8
title: Database object
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Database
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Database object</h1>
<p>The <strong>Database</strong> object accesses an installer database.</p>
<p>The <strong>Database</strong> object is released when it is either taken out of scope or when the object variable associated with it is set to null. The <a href="database-commit.html"><strong>Commit</strong></a> method must be called before the <strong>Database</strong> object is released to write out all persistent changes. If the <strong>Commit</strong> method is not called, the installer performs an implicit rollback upon object destruction.</p>
<p>The client can use the following procedure for data access.</p>
<p><strong>To Query API Sequencing</strong></p>
<ol>
<li>Obtain a <strong>Database</strong> object by calling the <a href="installer-opendatabase.html"><strong>OpenDatabase</strong></a> or the <a href="installer-object.html"><strong>Installer</strong></a> object.</li>
<li>Initiate a query using a SQL string by calling the <a href="database-openview.html"><strong>OpenView</strong></a> method of the <strong>Database</strong> object.</li>
<li>Set query parameters in a <a href="record-object.html"><strong>Record</strong></a> object and execute the database query by calling the <a href="view-execute.html"><strong>Execute</strong></a> method of the <a href="view-object.html"><strong>View</strong></a> object. This produces a result that can be fetched or updated.</li>
<li>Call the <a href="view-fetch.html"><strong>Fetch</strong></a> method of the <a href="view-object.html"><strong>View</strong></a> object repeatedly to return <a href="record-object.html"><strong>Record</strong></a> objects.</li>
<li>Update database rows of a <a href="record-object.html"><strong>Record</strong></a> object obtained by the <a href="view-fetch.html"><strong>Fetch</strong></a> method using the <a href="view-modify.html"><strong>Modify</strong></a> method of the <a href="view-object.html"><strong>View</strong></a> object.</li>
<li>Release the query and any unfetched records by calling the <a href="view-close.html"><strong>Close</strong></a> method of the <a href="view-object.html"><strong>View</strong></a> object.</li>
<li>Persist any database updates by calling the <a href="database-commit.html"><strong>Commit</strong></a> method of the <strong>Database</strong> object.</li>
</ol>
<h2>Members</h2>
<p>The <strong>Database</strong> object has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>Database</strong> object has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="database-applytransform.html"><strong>ApplyTransform</strong></a></td>
<td align="left">Applies the transform to this database.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="database-commit.html"><strong>Commit</strong></a></td>
<td align="left">Finalizes the persistent form of the database.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="database-createtransformsummaryinfo.html"><strong>CreateTransformSummaryInfo</strong></a></td>
<td align="left">Creates and populates the summary information stream of an existing transform file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="database-enableuipreview.html"><strong>EnableUIPreview</strong></a></td>
<td align="left">Facilitates the authoring of dialog boxes and billboards by providing the support needed to view user interface dialog boxes stored in the installer database.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="database-export.html"><strong>Export</strong></a></td>
<td align="left">Copies the structure and data from a specified table to a text archive file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="database-generatetransform.html"><strong>GenerateTransform</strong></a></td>
<td align="left">Creates a transform.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="database-import.html"><strong>Import</strong></a></td>
<td align="left">Imports a database table from a text archive file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="database-merge.html"><strong>Merge</strong></a></td>
<td align="left">Merges the reference database with the base database.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="database-openview.html"><strong>OpenView</strong></a></td>
<td align="left">Returns a <a href="view-object.html"><strong>View</strong></a> object representing the query specified by a SQL string.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<p>The <strong>Database</strong> object has these properties.</p>
<table>
<thead>
<tr>
<th align="left">Property</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="database-databasestate.html"><strong>DatabaseState</strong></a><!-- raw HTML omitted --></td>
<td align="left">Returns the persistence state of the database.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="database-primarykeys.html"><strong>PrimaryKeys</strong></a><!-- raw HTML omitted --></td>
<td align="left">Returns a <a href="record-object.html"><strong>Record</strong></a> object containing the table name and the column names (comprising the primary keys).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="database-summaryinformation.html"><strong>SummaryInformation (Database Object)</strong></a><!-- raw HTML omitted --></td>
<td align="left">Returns a <a href="summaryinfo-object.html"><strong>SummaryInfo</strong></a> object that can be used to examine, update, and add properties to the summary information stream.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="database-tablepersistent.html"><strong>TablePersistent</strong></a><!-- raw HTML omitted --></td>
<td align="left">Returns the persistence state of the table.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows Server 2012, Windows 8, Windows Server 2008 R2 or Windows 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows Server 2008 or Windows Vista. Windows Installer on Windows Server 2003 or Windows XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IDatabase is defined as 000C109D-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="windows-installer-scripting-examples.html">Windows Installer Scripting Examples</a></p>
<!-- raw HTML omitted -->
</body>
