<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Session.FormatRecord method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The FormatRecord method of the Session object returns a formatted string from a template and record data.
ms.assetid: 2018ac75-ea18-4256-8d56-0527069ce24b
title: Session.FormatRecord method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Session.FormatRecord
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Session.FormatRecord method</h1>
<p>The <strong>FormatRecord</strong> method of the <a href="session-object.html"><strong>Session</strong></a> object returns a formatted string from a template and record data.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>Session.FormatRecord(
  record
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>record</em></p>
<!-- raw HTML omitted -->
<p>Required <strong>Record</strong> object containing a template and data to be formatted. The template string must be set in field 0 followed by any referenced data parameters.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>The <strong>FormatRecord</strong> method uses the following format process.</p>
<p>Parameters to be <a href="formatted.html">formatted</a> are enclosed in square brackets [..]. The square brackets can be iterated because the substitutions are resolved from inside out.</p>
<p>If a part of the string is enclosed in curly braces { } and contains no square brackets, the part is left unchanged, including the curly braces.</p>
<p>If a part of the string is enclosed in curly braces and contains one or more property names, and if all the properties are found, the text (with the resolved substitutions) is displayed without the curly braces. If any of the properties are not found, all the text in the curly braces and the braces themselves are removed.</p>
<p><strong>To format strings using the FormatRecord method</strong></p>
<ol>
<li>The numeric parameters are substituted by replacing the marker with the value of the corresponding record field, with missing or Null values producing no text.</li>
<li>The string that results is processed by replacing the non-record parameters with the corresponding values, as noted in the following descriptions.
<ul>
<li>If a substring of the form &quot;[propertyname]&quot; is encountered, it is replaced by the value of the property.</li>
<li>If a substring of the form &quot;[%environmentvariable]&quot; is found, the value of the environment variable is substituted.</li>
<li>If a substring of the form [#<em>filekey</em>] is found, it is replaced by the full path of the file, with the value <em>filekey</em> used as a key into the <a href="file-table.html">File table</a>. The value of [#<em>filekey</em>] remains blank and is not replaced by a path until the installer runs the <a href="costinitialize-action.html">CostInitialize action</a>, <a href="filecost-action.html">FileCost action</a>, and <a href="costfinalize-action.html">CostFinalize action</a>. The value of [#<em>filekey</em>] depends upon the installation state of the component to which the file belongs. If the component is being run from source, the value is the path to the source location of the file. If the component is being run locally, the value is the path to the target location of the file after installation. If the component is absent, the path is blank. For more information about checking the installation state of components, see <a href="checking-the-installation-of-features-components-files.html">Checking the Installation of Features, Components, Files</a>.</li>
<li>If a substring of the form [<em>$componentkey</em>] is found, it is replaced by the install directory of the component, with the value <em>componentkey</em> used as a key into the <a href="component-table.html">Component table</a>. The value of [$<em>componentkey</em>] remains blank and is not replaced by a directory until the installer runs the <a href="costinitialize-action.html">CostInitialize action</a>, <a href="filecost-action.html">FileCost action</a>, and <a href="costfinalize-action.html">CostFinalize action</a>. The value of [$<em>componentkey</em>] depends upon the installation state of the component. If the component is being run from source, the value is the source directory of the file. If the component is being run locally, the value is the target directory after installation. If the component is absent, the value is left blank. For more information about checking the installation state of components, see <a href="checking-the-installation-of-features-components-files.html">Checking the Installation of Features, Components, Files</a>.</li>
<li>If a substring of the form &quot;[\c]&quot; is found, it is replaced by the character without any further processing. Only the first character after the backslash is kept; everything else is removed.</li>
</ul>
</li>
</ol>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer on Windows ServerÂ 2003 or WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_ISession is defined as 000C109E-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="formatted.html">Formatted</a></p>
<!-- raw HTML omitted -->
<p><a href="column-data-types.html">Column Data Types</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
