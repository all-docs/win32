<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MSIINSTALLPERUSER property</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The MSIINSTALLPERUSER and the ALLUSERS properties can be set by the user at installation time, through the user interface or on a command line, to request that the Windows Installer install a dual-purpose package for the current user or all users of the computer.
ms.assetid: 17eb24e4-8464-4724-9768-4b58446ee4bc
title: MSIINSTALLPERUSER property
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>MSIINSTALLPERUSER property</h1>
<p>The <strong>MSIINSTALLPERUSER</strong> and the <a href="allusers.html"><strong>ALLUSERS</strong></a> properties can be set by the user at installation time, through the user interface or on a command line, to request that the Windows Installer install a dual-purpose package for the current user or all users of the computer. To use the <strong>MSIINSTALLPERUSER</strong> property, the value of the <a href="allusers.html"><strong>ALLUSERS</strong></a> property must be 2 and the package has to have been authored to be capable of installation into either the per-user or a per-machine context. For information about authoring a dual-purpose package, see <a href="single-package-authoring.html">Single Package Authoring</a>. If the value of the <strong>ALLUSERS</strong> property does not equal 2, the value of the <strong>MSIINSTALLPERUSER</strong> property is ignored and has no effect on the installation. The value of <strong>MSIINSTALLPERUSER</strong> property is ignored when installing the package using Windows Installer 4.5 or earlier.</p>
<p>To request that the Windows Installer install the dual-purpose package in the per-machine <a href="installation-context.html">installation context</a>, the user can set the value of the <strong>MSIINSTALLPERUSER</strong> property to an empty string (&quot;&quot;) and the value of the <a href="allusers.html"><strong>ALLUSERS</strong></a> property to 2 using an authored user interface or a command line.</p>
<p>To request that the Windows Installer install the dual-purpose package in the per-user <a href="installation-context.html">installation context</a>, the user can set the value of the <strong>MSIINSTALLPERUSER</strong> property to 1 and the value of the <a href="allusers.html"><strong>ALLUSERS</strong></a> property to 2 using an authored user interface or a command line.</p>
<p>If the value of the <a href="allusers.html"><strong>ALLUSERS</strong></a> property does not equal 2, the Windows Installer ignores the value of the <strong>MSIINSTALLPERUSER</strong> property. If Windows Installer installs the application in the per-machine context, it resets the value of the <strong>ALLUSERS</strong> property to 1. If Windows Installer installs the application in the per-user context, it resets the value of the <strong>ALLUSERS</strong> property to an empty string (&quot;&quot;). Applications that have been installed per-user therefore receive all updates or repairs on a per-user basis and applications installed per-machine receive updates or repairs on a per-machine basis.</p>
<p><strong><a href="not-supported-in-windows-installer-4-5.html">Windows Installer 4.5 or earlier</a>:</strong> The <strong>MSIINSTALLPERUSER</strong> property is ignored by versions earlier than Windows Installer 5.0.</p>
<h2>Default Value</h2>
<p>The recommended default installation context is per-user for a dual-purpose package. Author MSIINSTALLPERUSER=1 and ALLUSERS=2 in the <a href="property-table.html">Property table</a> of the dual-purpose package to specify per-user as the default installation context.</p>
<h2>Remarks</h2>
<p>You can ensure the <strong>MSIINSTALLPERUSER</strong> property has not been set by setting its value to an empty string (&quot;&quot;), MSIINSTALLPERUSER=&quot;&quot;.</p>
<p>The installation context determines the values of the <a href="desktopfolder.html"><strong>DesktopFolder</strong></a>, <a href="programmenufolder.html"><strong>ProgramMenuFolder</strong></a>, <a href="startmenufolder.html"><strong>StartMenuFolder</strong></a>, <a href="startupfolder.html"><strong>StartupFolder</strong></a>, <a href="templatefolder.html"><strong>TemplateFolder</strong></a>, <a href="admintoolsfolder.html"><strong>AdminToolsFolder</strong></a>, <a href="programfilesfolder.html"><strong>ProgramFilesFolder</strong></a>, <a href="commonfilesfolder.html"><strong>CommonFilesFolder</strong></a>, <a href="programfiles64folder.html"><strong>ProgramFiles64Folder</strong></a>, and <a href="commonfiles64folder.html"><strong>CommonFiles64Folder</strong></a> properties. The installation context determines the parts of the registry where entries in the <a href="registry-table.html">Registry table</a> and <a href="removeregistry-table.html">RemoveRegistry table</a>, with -1 in the Root column, are written or removed. For information about the installation context, see <a href="installation-context.html">Installation Context</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. See the <a href="windows-installer-portal.html">Windows Installer Run-Time Requirements</a> for information about the minimum Windows service pack that is required by a Windows Installer version.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="properties.html">Properties</a></p>
<!-- raw HTML omitted -->
<p><a href="allusers.html"><strong>ALLUSERS</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="installation-context.html">Installation Context</a></p>
<!-- raw HTML omitted -->
<p><a href="single-package-authoring.html">Single Package Authoring</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
