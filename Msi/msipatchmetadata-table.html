<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MsiPatchMetadata Table</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The MsiPatchMetadata Table contains information about a Windows Installer patch that is required to remove the patch and that is used by Add/Remove Programs.
ms.assetid: b1c30e16-6c91-451a-8b75-7ddbcefcc092
title: MsiPatchMetadata Table
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>MsiPatchMetadata Table</h1>
<p>The MsiPatchMetadata Table contains information about a Windows Installer patch that is required to remove the patch and that is used by <strong>Add/Remove Programs</strong>.</p>
<p>Patches installed without this table present in the patch database (.msp file) cannot be removed, and are missing some information from <strong>Add/Remove Programs</strong>. The table must be in the database of the patch file and not in a transform in the patch.</p>
<p>The MsiPatchMetadata Table has the following columns.</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Key</th>
<th>Nullable</th>
</tr>
</thead>
<tbody>
<tr>
<td>Company</td>
<td><a href="identifier.html">Identifier</a></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td>Property</td>
<td><a href="identifier.html">Identifier</a></td>
<td>Y</td>
<td>N</td>
</tr>
<tr>
<td>Value</td>
<td><a href="text.html">Text</a></td>
<td>N</td>
<td>N</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Columns</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Company</p>
<!-- raw HTML omitted -->
<p>The name of the company. An empty field (a Null value) indicates that the row contains one of the standard metadata properties of the Windows Installer. For more information, see the Remarks section of this topic.</p>
<p>By adding a row to the table and entering a company name in this field, you can add any company to extend the property set.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Property</p>
<!-- raw HTML omitted -->
<p>The name of a metadata property.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Value</p>
<!-- raw HTML omitted -->
<p>The value of the metadata property. This can never be Null or an empty string.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>Available in Windows InstallerÂ 3.0 and later.</p>
<p>Rows in the MsiPatchMetadata Table that contain a Null value in the CompanyName field refer to one of the following standard Windows Installer metadata properties.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AllowRemoval</td>
<td>Indicates whether or not the patch is an <!-- raw HTML omitted -->Uninstallable Patch<!-- raw HTML omitted -->. If the value field contains 0 (zero), the patch cannot be removed. If the value field contains one (1), the patch is an Uninstallable Patch.This property is registered and its value can be obtain by using the <!-- raw HTML omitted --><!-- raw HTML omitted -->MsiGetPatchInfoEx<!-- raw HTML omitted --><!-- raw HTML omitted --> function. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>ManufacturerName</td>
<td>Name of the manufacturer of the application.</td>
</tr>
<tr>
<td>MinorUpdateTargetRTM</td>
<td>Indicates that the patch targets the RTM version of the product or the most recent major upgrade patch. Author this optional property in minor upgrade patches that contain sequencing information to indicate that the patch removes of all patches up to the RTM version of the product, or up to the most recent major upgrade patch. This property is available in Windows InstallerÂ 3.1 and later. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TargetProductName</td>
<td>Name of the application or target application suite.</td>
</tr>
<tr>
<td>MoreInfoURL</td>
<td>A URL that provides information specific to this patch. This property is registered and its value can be obtained by using the <!-- raw HTML omitted --><!-- raw HTML omitted -->MsiGetPatchInfoEx<!-- raw HTML omitted --><!-- raw HTML omitted --> function. Beginning with WindowsÂ XP with Service PackÂ 2 (SP2), this value can be the support link for the patch displayed in <!-- raw HTML omitted -->Add/Remove Programs<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>CreationTimeUTC</td>
<td>Creation time of the .msp file in the form of mm-dd-yy HH:MM (month-day-year hour:minute).</td>
</tr>
<tr>
<td>DisplayName</td>
<td>A title for the patch that is okay for public display. This property is registered, and its value can be obtained by using the <!-- raw HTML omitted --><!-- raw HTML omitted -->MsiGetPatchInfoEx<!-- raw HTML omitted --><!-- raw HTML omitted --> function. Beginning with WindowsÂ XP with SP2, this value is the name of the patch that is displayed in <!-- raw HTML omitted -->Add/Remove Programs<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Description</td>
<td>Brief description of the patch.</td>
</tr>
<tr>
<td>Classification</td>
<td>A string value that contains the arbitrary category of updates as defined by the author of the patch. For example, patch authors can specify that each patch be classified as a Hotfix, Security Rollup, Critical Update, Update, Service Pack, or Update Rollup. This property is required.</td>
</tr>
<tr>
<td>OptimizeCA</td>
<td>Indicates whether the Windows Installer should skip custom actions when applying the patch. This can reduce the time required to apply the patch. The OptimizeCA property can have one of the following values:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->0 - Do not skip any custom actions.<!-- raw HTML omitted --><!-- raw HTML omitted -->1 - Skip property and directory assignment custom actions. <!-- raw HTML omitted -->Custom Action Type 35<!-- raw HTML omitted --> and <!-- raw HTML omitted -->Custom Action Type 51<!-- raw HTML omitted --> can be property and directory assignment custom actions.<!-- raw HTML omitted --><!-- raw HTML omitted -->2 - Skip immediate custom actions that do not fall into the property or directory assignments. The immediate custom actions do not include msidbCustomActionTypeInScript option in the Type column of the <!-- raw HTML omitted -->CustomAction Table<!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted -->4 - Skip custom actions that run within the script.<!-- raw HTML omitted --><!-- raw HTML omitted -->The value of OptimizeCA must be the same for all patches that are being installed or no custom actions are skipped. For example, if two patches are being installed, and OptimizeCA is set to the values 1 and 2 respectively, no custom actions are skipped. <!-- raw HTML omitted --> The values of OptimizeCA can be combined when processing multiple new patches. If all patches have a 1 (one) included in the values, then all property and directory assignment custom actions are skipped. If one patch has the value 3 (three)for the property, and one patch has the value 1 (one) for the property, the property and directory assignment custom actions are skipped. However, the other immediate custom actions run, because not all of the patches requested are skipped. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>OptimizedInstallMode</td>
<td>If this property is set to 1 (one) in all the patches to be applied in a transaction, an application of the patch is optimized if possible. For more information, see <!-- raw HTML omitted -->Patch Optimization<!-- raw HTML omitted -->. Available beginning with Windows InstallerÂ 3.1.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Validation</h2>
<!-- raw HTML omitted -->
<p><a href="ice03.html">ICE03</a><br />
<a href="ice06.html">ICE06</a></p>
<!-- raw HTML omitted -->
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="not-supported-in-windows-installer-version-2-0.html">Not Supported in Windows Installer 2.0 and earlier</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
