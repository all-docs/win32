<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Installer::AdvertiseScript method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The AdvertiseScript method of the Installer object advertises an installation package.
ms.assetid: 45e5268f-7a5f-412f-b9f6-0abb75b79361
title: Installer::AdvertiseScript method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Installer.AdvertiseScript
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Installer::AdvertiseScript method</h1>
<p>The <strong>AdvertiseScript</strong> method of the <a href="installer-object.html"><strong>Installer</strong></a> object advertises an installation package.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>.AdvertiseScript(
  scriptPath,
  scriptFlags,
  removeItems
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>scriptPath</em></p>
<!-- raw HTML omitted -->
<p>The full path to the script file generated by the <a href="installer-createadvertisescript.html"><strong>CreateAdvertiseScript</strong></a> method.</p>
<!-- raw HTML omitted -->
<p><em>scriptFlags</em></p>
<!-- raw HTML omitted -->
<p>The flags that control the advertisement. This parameter can be a combination of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseScriptCacheInfo</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x001<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Include this flag if the icons need to be created or removed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseScriptShortcuts</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x004<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Include this flag if the shortcuts need to be created or removed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseScriptMachineAssign</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x008<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Include this flag if the product is to be assigned to a computer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseScriptConfigurationRegistration</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x020<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Include this flag if the configuration and management information in the registry data needs to be written or removed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseScriptValidateTransformList</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x040<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Include this flag to force the validation of the transforms listed in the script against previously registered transforms for this product. Note that transform conflicts are detected using a string comparison that is case insensitive and are evaluated between per-user and per-machine installations across all <a href="installation-context.html">installation contexts</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseScriptClassInfoRegistration</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x080<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Include this flag if advertisement information in the registry related to COM classes needs to be written or removed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseScriptExtensionInfoRegistration</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x100<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Include this flag if advertisement information in the registry related to an extension needs to be written or removed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseScriptAppInfo</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x180<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Include this flag if the advertisement information in the registry needs to be written or removed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseScriptRegData</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x1A0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Include this flag if the advertisement information in the registry needs to be written or removed.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>removeItems</em></p>
<!-- raw HTML omitted -->
<p>TRUE if the specified items are to be removed instead of being created.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>The <strong>AdvertiseScript</strong> method uses the <a href="/windows/desktop/api/Msi/nf-msi-msiadvertisescripta"><strong>MsiAdvertiseScript</strong></a> function. The use of the <strong>AdvertiseScript</strong> method requires that the script be running within a local system process.</p>
<h2>Examples</h2>
<p>The following example demonstrates the use of the <strong>AdvertiseScript</strong> method.</p>
<pre lang="VB"><code>Dim installer
Set installer = CreateObject(&quot;WindowsInstaller.Installer&quot;)

' Advertise Simple package using an advertise script
'   created by CreateAdvertiseScript Method
'
'  Flags 424 indicate msiAdvertiseScriptMachineAssign, msiAdvertiseScriptRegData

Installer.AdvertiseScript &quot;c:\scratch\simpletst\rtm\simple.aas&quot;, 424, false

' Verify Simple is installed
MsgBox Installer.ProductState(&quot;{BAE98781-CF88-4309-8E2D-3D8B347F5B53}&quot;)

'
' Remove Simple using advertise script
'
Installer.AdvertiseScript &quot;c:\scratch\simpletst\rtm\simple.aas&quot;, 424, true

' Verify simple is removed
MsgBox Installer.ProductState(&quot;{BAE98781-CF88-4309-8E2D-3D8B347F5B53}&quot;)
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer 4.5 on Windows ServerÂ 2003 and WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IInstaller is defined as 000C1090-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="installer-object.html"><strong>Installer</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="not-supported-in-windows-installer-version-3-1.html">Not Supported in Windows Installer 3.1 and earlier versions</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
