<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Neither File Has a Version with File Hash Check</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: File hashing is available with Windows Installer. For more information, see MsiGetFileHash and the MsiFileHash table. The MsiFileHash table can only be used with unversioned files.
ms.assetid: 608859ac-6640-4c28-b4f0-34ab36d804d7
title: Neither File Has a Version with File Hash Check
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Neither File Has a Version with File Hash Check</h1>
<p>File hashing is available with Windows Installer. For more information, see <a href="/windows/desktop/api/Msi/nf-msi-msigetfilehasha"><strong>MsiGetFileHash</strong></a> and the <a href="msifilehash-table.html">MsiFileHash table</a>. The MsiFileHash table can only be used with unversioned files.</p>
<p>If the key file of a component being installed (copy-A) has the same name as a file already installed in the target location (copy-B), the installer compares the version number, date, and language of the two files.</p>
<p>If neither file has a version number, the installer uses the logic illustrated by the following flow diagram to determine whether to replace all of the installed files belonging to the component. Because the installer only installs entire components, if the installed key file is replaced then, all of the component's files are replaced.</p>
<p>Note that this diagram illustrates the default <a href="file-versioning-rules.html">File Versioning Rules</a>, which can be overridden by setting the <a href="reinstallmode.html"><strong>REINSTALLMODE</strong></a> property. The default value of the <strong>REINSTALLMODE</strong> property is &quot;omus&quot;.</p>
<p><img src="images/waiflow2b.png" alt="default file versioning rules when overridden by the reinstallmode property setting" /></p>
<p>See the examples of default file versioning in <a href="replacing-existing-files.html">Replacing Existing Files</a>.</p>
<ul>
<li><a href="both-files-have-a-version.html">Both Files Have a Version</a></li>
<li><a href="neither-file-has-a-version.html">Neither File Has a Version</a></li>
<li><a href="one-file-has-a-version.html">One File Has a Version</a></li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
