<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Advertising a Per-User Application To Be Installed with Elevated Privileges</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: 'To advertise an application on a per-user installation basis when the application requires elevated (that is, system) privileges for installation, use the guidelines in the following list:'
ms.assetid: 0d2bd2d9-0eac-4519-862c-15f0ee5cbc40
title: Advertising a Per-User Application To Be Installed with Elevated Privileges
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Advertising a Per-User Application To Be Installed with Elevated Privileges</h1>
<p>To advertise an application on a per-user installation basis when the application requires elevated (that is, system) privileges for installation, use the guidelines in the following list:</p>
<ul>
<li>Your process must be a service that runs under the LocalSystem system account on WindowsÂ XP or later.</li>
<li>Generate an advertise script by calling <a href="/windows/desktop/api/Msi/nf-msi-msiadvertiseproducta"><strong>MsiAdvertiseProduct</strong></a> or <a href="/windows/desktop/api/Msi/nf-msi-msiadvertiseproductexa"><strong>MsiAdvertiseProductEx</strong></a>.</li>
<li>Your process must impersonate the user that is the target for the advertisement.</li>
<li>Call <a href="/windows/desktop/api/Msi/nf-msi-msiadvertisescripta"><strong>MsiAdvertiseScript</strong></a>, and use the flags SCRIPTFLAGS_CACHEINFO | SCRIPTFLAGS_REGDATA_APPINFO | SCRIPTFLAGS_REGDATA_CNFGINFO | SCRIPTFLAGS_SHORTCUTS.</li>
</ul>
<p>When you follow the guidelines, you advertise an application to a specified user, and when the user chooses to install, the application is installed with elevated privileges.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="patching-per-user-managed-applications.html">Patching Per-User Managed Applications</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
