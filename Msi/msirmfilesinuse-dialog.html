<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MsiRMFilesInUse Dialog</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The MsiRMFilesInUse Dialog box can be authored to display a list of processes that are currently running files that need to be overwritten or deleted by the installation.
ms.assetid: e8d93310-388e-4a08-9bce-04c31c33a665
title: MsiRMFilesInUse Dialog
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>MsiRMFilesInUse Dialog</h1>
<p>The MsiRMFilesInUse Dialog box can be authored to display a list of processes that are currently running files that need to be overwritten or deleted by the installation. The user can select between options to &quot;Automatically close applications and restart them&quot; or &quot;Do not close applications. (A reboot will be required.)&quot; If the user selects the &quot;Automatically close applications and restart them&quot; option, a push button control on this dialog box can be authored to publish the RMShutdownAndRestart control event and the <a href="../rstmgr/restart-manager-portal.html">Restart Manager</a> can close the applications and restart them at the end of the installation. This can eliminate or reduce the need to restart the computer. For more information, see <a href="system-reboots.html">System Reboots</a>.</p>
<p>The <strong>MsiRMFilesInUse</strong> dialog box is displayed during an installation only if all the following are true. When any of these are false, the Windows Installer ignores the <strong>MsiRMFilesInUse</strong> dialog box.</p>
<ul>
<li>A Windows Installer version that is not earlier than version 4.0 and an operating system that is not earlier than WindowsÂ Vista or Windows ServerÂ 2008 is running the installation.</li>
<li>The Full UI <a href="user-interface-levels.html">user interface level</a> is used.</li>
<li>Interactions with the <a href="../rstmgr/restart-manager-portal.html">Restart Manager</a> have not been disabled by the <a href="msirestartmanagercontrol.html"><strong>MSIRESTARTMANAGERCONTROL</strong></a> property or the <a href="disableautomaticapplicationshutdown.html">DisableAutomaticApplicationShutdown</a> policy.</li>
<li>The <strong>MsiRMFilesInUse</strong> dialog box is present in the installation package.</li>
<li>All calls from the Windows Installer to the <a href="../rstmgr/restart-manager-portal.html">Restart Manager</a> are successful.</li>
</ul>
<p>This dialog box will be created as required by the <a href="installvalidate-action.html">InstallValidate action</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
