<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>UiCreatePatchPackageEx (Patchwiz.dll)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The UiCreatePatchPackageEx function takes a package creation file (.pcp file) and generates a Windows Installer patch package (.msp package). Calling Msimsp.exe is the recommended method for using Patchwiz.dll.
ms.assetid: 76d9a21d-73bc-41fc-8ed0-7d7d7deff815
title: UiCreatePatchPackageEx (Patchwiz.dll)
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>UiCreatePatchPackageEx (Patchwiz.dll)</h1>
<p>The UiCreatePatchPackageEx function takes a package creation file (.pcp file) and generates a Windows Installer patch package (.msp package). Calling <a href="msimsp-exe.html">Msimsp.exe</a> is the recommended method for using <a href="patchwiz-dll.html">Patchwiz.dll</a>.</p>
<p>The UiCreatePatchPackageEx function is available beginning with Patchwiz.dll version 4.0 and extends the functionality of the <a href="uicreatepatchpackage-patchwiz-dll-.html">UiCreatePatchPackage</a> function.</p>
<pre lang="syntax"><code>UINT UiCreatePatchPackageEx(
  LPCTSTR szPcpPath,              
  LPCTSTR szPatchPath,            
  LPCTSTR szLogPath,             
  HWND hwndStatus,                
  LPCTSTR szTempFolder,           
  BOOL fRemoveTempFolderContents,
  DWORD dwFlags,
  DWORD dwReserved    
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>szPcpPath</em></p>
<!-- raw HTML omitted -->
<p>Full path to the patch creation properties file (.pcp file) for this patch.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>szPatchPath</em></p>
<!-- raw HTML omitted -->
<p>Full path to the Windows Installer patch package (.msp file) that is to be created. This parameter may be <strong>NULL</strong> or an empty string but may not be omitted. If it is <strong>NULL</strong> or an empty string, the function uses the value of PatchOutputPath in the <a href="properties-table-patchwiz-dll-.html">Properties Table (Patchwiz.dll)</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>szLogPath</em></p>
<!-- raw HTML omitted -->
<p>Full path to a text log file that will be appended. This parameter may be <strong>NULL</strong> or an empty string but may not be omitted.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>hwndStatus</em></p>
<!-- raw HTML omitted -->
<p>Handle to a window that displays the status text. This parameter may be <strong>NULL</strong> or an empty string but may not be omitted.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>szTempFolder</em></p>
<!-- raw HTML omitted -->
<p>Location for temporary files. This parameter may be <strong>NULL</strong> or an empty string but may not be omitted. The user must have sufficient privileges to read and write to this folder. The default location is %TMP%\~pcw_tmp.tmp\.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>fRemoveTempFolderContents</em></p>
<!-- raw HTML omitted -->
<p>If <strong>TRUE</strong>, remove the temporary folder and all of its contents if present. If <strong>FALSE</strong>, and folder is present, the function fails.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>dwFlags</em></p>
<!-- raw HTML omitted -->
<p>This parameter can be set to one or a combination of the following values to specify logging or user interface options.</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>LOGNONE</td>
<td>0x00000000</td>
<td>Write no messages to the log.</td>
</tr>
<tr>
<td>LOGINFO</td>
<td>0x00000001</td>
<td>Write informational messages to the log.</td>
</tr>
<tr>
<td>LOGWARN</td>
<td>0x00000002</td>
<td>Write warnings to the log.</td>
</tr>
<tr>
<td>LOGERR</td>
<td>0x00000004</td>
<td>Write error messages to the log.</td>
</tr>
<tr>
<td>LOGPERFMESSAGES</td>
<td>0x00000008</td>
<td>Write performance messages to the log.</td>
</tr>
<tr>
<td>UINONE</td>
<td>0x00000000f</td>
<td>Do not display the user interface.</td>
</tr>
<tr>
<td>UIALL</td>
<td>0x00000010</td>
<td>Display the user interface.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>dwReserved</em></p>
<!-- raw HTML omitted -->
<p>Reserved. This parameter must be set to zero.</p>
<!-- raw HTML omitted -->
<h2>Return Values</h2>
<p>See the table in <a href="return-values-for-uicreatepatchpackage.html">Return Values for UiCreatePatchPackage</a>.</p>
<h2>Remarks</h2>
<p>For an example of authoring a .pcp file and using <a href="uicreatepatchpackage-patchwiz-dll-.html">UiCreatePatchPackage</a> to generate a Windows Installer patch package, see the section <a href="a-small-update-patching-example.html">A Small Update Patching Example</a>.</p>
<p>Creating a patch requires an uncompressed setup image, such as an administrative image or an uncompressed setup image from a CD-ROM. <a href="uicreatepatchpackage-patchwiz-dll-.html">UiCreatePatchPackage</a> does not generate binary patches for files in cabinets.</p>
<p>Â </p>
<p>Â </p>
</body>
