<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Commit Custom Actions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Commit Custom actions are executed upon successful completion of the installation script.
ms.assetid: ad766585-e8ac-44b6-9717-7979f803886c
title: Commit Custom Actions
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Commit Custom Actions</h1>
<p>Commit Custom actions are executed upon successful completion of the installation script. If the <a href="installfinalize-action.html">InstallFinalize action</a> is successful, the installer will then run any existing Commit Custom actions. The only mode parameter the installer sets in this case is MSIRUNMODE_COMMIT. See <a href="/windows/desktop/api/Msiquery/nf-msiquery-msigetmode"><strong>MsiGetMode</strong></a> for a description of the run mode parameters.</p>
<p>A commit custom action can be specified by adding an option flag to the Type field of the <a href="customaction-table.html">CustomAction table</a>. See <a href="custom-action-in-script-execution-options.html">Custom Action In-Script Execution Options</a> for the option flag designating a commit custom action.</p>
<p>A commit custom action is the complement to a <a href="rollback-custom-actions.html">rollback custom action</a> and can be used with rollback custom actions to reverse custom actions that make changes directly to the system.</p>
<p>Note that a rollback custom action may not be able to remove all of the changes made by commit custom actions. Although the installer writes both rollback and commit custom actions into the rollback script, commit custom actions only run after the installer has successfully processed the installation script. Commit custom actions are the first actions to run in the rollback script. If a commit custom action fails, the installer initiates rollback but can only rollback those operations already written to the rollback script. This means that depending on the commit custom action, a rollback may not be able to undo the changes made by the action. You can ignore failures in commit custom actions by authoring the custom action to ignore return codes.</p>
<p>Rollback and commit custom actions do not run when rollback is disabled. If a package author requires these types of custom actions for proper installation, they should use the <a href="rollbackdisabled.html"><strong>RollbackDisabled</strong></a> Property in a condition that prevents the installation from continuing when rollback is disabled.</p>
<p>Â </p>
<p>Â </p>
</body>
