<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SelfUnregModules Action</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The SelfUnregModules action unregisters all modules listed in the SelfReg table that are scheduled to be uninstalled. The installer does not self-register .EXE files.
ms.assetid: fa5a5abb-ecd4-434c-b176-83cdca280a13
title: SelfUnregModules Action
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>SelfUnregModules Action</h1>
<p>The SelfUnregModules action unregisters all modules listed in the <a href="selfreg-table.html">SelfReg table</a> that are scheduled to be uninstalled. The installer does not self-register .EXE files.</p>
<h2>Sequence Restrictions</h2>
<p>The <a href="installvalidate-action.html">InstallValidate</a> action must appear before the SelfUnregModules action in the sequence. If a <a href="selfregmodules-action.html">SelfRegModules</a> action is used it must appear after the SelfUnregModules action in the sequence. If a <a href="removefiles-action.html">RemoveFiles action</a> is used it must appear after the SelfUnregModules action in the sequence.</p>
<h2>ActionData Messages</h2>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description of action data</th>
</tr>
</thead>
<tbody>
<tr>
<td>[1]</td>
<td>Identifier of unregistered module file.</td>
</tr>
<tr>
<td>[2]</td>
<td>Identifier of folder holding unregistered module file.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>The SelfUnregModules action attempts to call the <a href="/windows/win32/api/olectl/nf-olectl-dllunregisterserver"><strong>DllUnregisterServer</strong></a> function of the module that is to be unregistered. This action runs with elevated privileges when the installation is being run with elevated privileges, such as during a per-machine installation. During a per-user installation, the installer runs this action with user privileges.</p>
<p>Note that you cannot specify the order in which the installer unregisters self-registering DLLs by using the SelfUnRegModules action.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="specifying-the-order-of-self-registration.html">Specifying the Order of Self Registration</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
