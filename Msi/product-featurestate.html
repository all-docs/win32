<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Product.FeatureState method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The FeatureState property is the installation state of the feature for the instance of this product.This property calls MsiQueryFeatureStateEx, with the ProductCode, UserSid and Context of the object. The feature Id is provided as a parameter.
ms.assetid: 6821be80-4065-465e-b4c9-4cf17856bc5f
title: Product.FeatureState method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Product.FeatureState
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Product.FeatureState method</h1>
<p>The <strong>FeatureState</strong> property is the installation state of the feature for the instance of this product.</p>
<p>This property calls <a href="/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestateexa"><strong>MsiQueryFeatureStateEx</strong></a>, with the <em>ProductCode</em>, <em>UserSid</em> and <em>Context</em> of the object. The feature Id is provided as a parameter.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>Product.FeatureState(
  FeatureId
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>FeatureId</em></p>
<!-- raw HTML omitted -->
<p>Feature Id appearing in the Feature column of the <a href="feature-table.html">Feature Table</a>.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>If the call succeeds, the property contains the value as a <strong>DWORD</strong>.</p>
<table>
<thead>
<tr>
<th>State</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>INSTALLSTATE_ADVERTISED</td>
<td>This feature is advertised.</td>
</tr>
<tr>
<td>INSTALLSTATE_LOCAL</td>
<td>The feature is installed locally.</td>
</tr>
<tr>
<td>INSTALLSTATE_SOURCE</td>
<td>The feature is installed to run from source.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>If the call fails, the property contains an error code from <a href="/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestateexa"><strong>MsiQueryFeatureStateEx</strong></a>.</p>
<table>
<thead>
<tr>
<th>Error</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>ERROR_ACCESS_DENIED</td>
<td>The calling process must have administrative privileges to get information for a product installed for a user other than the current user.</td>
</tr>
<tr>
<td>ERROR_BAD_CONFIGURATION</td>
<td>The configuration data is corrupt.</td>
</tr>
<tr>
<td>ERROR_INVALID_PARAMETER</td>
<td>An invalid parameter was passed to the function.</td>
</tr>
<tr>
<td>ERROR_SUCCESS</td>
<td>The function completed successfully.</td>
</tr>
<tr>
<td>ERROR_UNKNOWN_FEATURE</td>
<td>The feature ID does not identify a known feature.</td>
</tr>
<tr>
<td>ERROR_UNKNOWN_PRODUCT</td>
<td>The product code does not identify a known product.</td>
</tr>
<tr>
<td>ERROR_FUNCTION_FAILED</td>
<td>An unexpected internal failure.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer 3.0 or later on Windows ServerÂ 2003, WindowsÂ XP, and WindowsÂ 2000<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IProduct is defined as 000C10A0-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="product-object.html"><strong>Product</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestateexa"><strong>MsiQueryFeatureStateEx</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="not-supported-in-windows-installer-version-2-0.html">Not Supported in Windows Installer 2.0 and earlier</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
