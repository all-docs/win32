<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Generate File Cabinet</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The VBScript file WiMakCab.vbs is provided in the Windows SDK Components for Windows Installer Developers. This sample shows how script is used to generate file cabinets from a Windows Installer database.
ms.assetid: 26671cb9-a200-4520-8b52-4cff3f71a2f2
title: Generate File Cabinet
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Generate File Cabinet</h1>
<p>The VBScript file WiMakCab.vbs is provided in the <a href="platform-sdk-components-for-windows-installer-developers.html">Windows SDK Components for Windows Installer Developers</a>. This sample shows how script is used to generate file cabinets from a Windows Installer database.</p>
<p>This sample demonstrates:</p>
<ul>
<li><a href="installer-opendatabase.html"><strong>OpenDatabase method (Installer Object)</strong></a> and the <a href="installer-lasterrorrecord.html"><strong>LastErrorRecord method</strong></a> of the <a href="installer-object.html"><strong>Installer Object</strong></a></li>
<li><a href="database-commit.html"><strong>Commit method</strong></a>, the <a href="database-openview.html"><strong>OpenView method</strong></a> and <a href="database-summaryinformation.html"><strong>SummaryInformation property (Database Object)</strong></a> of the <a href="database-object.html"><strong>Database Object</strong></a></li>
<li><a href="view-fetch.html"><strong>Fetch method</strong></a>, <a href="view-execute.html"><strong>Execute method</strong></a> and <a href="view-modify.html"><strong>Modify method</strong></a> of the <a href="view-object.html"><strong>View Object</strong></a></li>
<li><a href="record-stringdata.html"><strong>StringData property</strong></a> and <a href="record-integerdata.html"><strong>IntegerData property</strong></a> of the <a href="record-object.html"><strong>Record Object</strong></a></li>
<li><a href="session-doaction.html"><strong>DoAction method</strong></a>, the <a href="session-session.html"><strong>Property property (Session Object)</strong></a>, and the <a href="session-mode.html"><strong>Mode property</strong></a> of the <a href="session-object.html"><strong>Session Object</strong></a></li>
</ul>
<p>You'll require the CScript.exe or WScript.exe version of Windows Script Host to use this sample. To use CScript.exe to run this sample, type a command at the command prompt using the following syntax. Help is displayed if the first argument is /? or if too few arguments are specified. To redirect the output to a file, end the command line with VBS &gt; [<em>path to file</em>]. The sample returns a value of 0 for success, 1 if help is invoked, and 2 if the script fails.</p>
<p><strong>cscript WiMakCab.vbs [path to database][base name][optional source locations]</strong></p>
<p>In order to generate a cabinet, Makecab.exe must be on the PATH. The Makecab.exe utility is included in the <a href="platform-sdk-components-for-windows-installer-developers.html">Windows SDK Components for Windows Installer Developers</a>. Note that the sample does not update the <a href="media-table.html">Media table</a> to handle multiple cabinets. To replace an embedded cabinet, include the options: /R /C /U /E.</p>
<p>Specify the path to the installer database. This must be located at the root of the source tree. Specify the case-sensitive base name for the generated cabinet files. If the source type is compressed, all files are opened at the root. The following options may be specified at any point on the command line.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>no option specified</td>
<td>Â </td>
</tr>
<tr>
<td>/C</td>
<td>Run compression. If /C is not specified, WiMakCab.vbs only generates the DDF file.</td>
</tr>
<tr>
<td>/L</td>
<td>Use LZX compression instead of MSZIP</td>
</tr>
<tr>
<td>/F</td>
<td>Limit cabinet size to 1.44 MB floppy size rather than CD-ROM</td>
</tr>
<tr>
<td>/U</td>
<td>Update the database to reference the generated cabinet</td>
</tr>
<tr>
<td>/E</td>
<td>Embed the cabinet file in the installer package as a stream</td>
</tr>
<tr>
<td>/S</td>
<td>Use sequence numbers in the File table ordered by directories</td>
</tr>
<tr>
<td>/R</td>
<td>Revert to non-cabinet install, remove cabinet if /E is specified (The /R option removes the compressed bit - SummaryInfo property 15 &amp; 2)</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>For additional scripting examples, see <a href="windows-installer-scripting-examples.html">Windows Installer Scripting Examples</a>. For sample utilities that do not require Windows Script Host, see <a href="windows-installer-development-tools.html">Windows Installer Development Tools</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
