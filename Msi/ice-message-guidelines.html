<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ICE Message Guidelines</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: ICE custom actions communicate by calling MsiProcessMessage and posting an INSTALLMESSAGE_USER type message.
ms.assetid: 36307589-de0e-4eaf-b439-e7ba3cd96fb3
title: ICE Message Guidelines
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>ICE Message Guidelines</h1>
<p>ICE custom actions communicate by calling <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage"><strong>MsiProcessMessage</strong></a> and posting an INSTALLMESSAGE_USER type message.</p>
<p>When authoring a message string for an ICE custom action, format the string as follows.</p>
<p><em>Name of ICE</em> &lt;tab&gt; <em>Message Type</em> &lt;tab&gt; <em>Description</em> &lt;tab&gt; <em>Help URL or location</em> &lt;tab&gt; <em>Table Name</em> &lt;tab&gt; <em>Column Name</em> &lt;tab&gt; <em>Primary Key</em> &lt;tab&gt; <em>Primary Key</em> &lt;tab&gt; <em>Primary Key</em> . . . (repeat for as many primary keys as needed)</p>
<p>The first three fields of the string are required in every message.</p>
<p>The Message Type field specifies whether the ICE reports a Failure, Error, Warning, or Informational message.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Message type</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Failure message reporting the failure of the ICE custom action.</td>
</tr>
<tr>
<td>1</td>
<td>Error message reporting database authoring that cause incorrect behavior.</td>
</tr>
<tr>
<td>2</td>
<td>Warning message reporting database authoring that causes incorrect behavior in certain cases. Warnings can also report unexpected side-effects of database authoring.</td>
</tr>
<tr>
<td>3</td>
<td>Informational message.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>If help is not available, the Help URL field may be the empty string.</p>
<p>Error and Warning messages should provide the Table Name, Column Name, and Primary Key fields. If any of these fields are omitted, all of the fields following the first blank field must be left out of the message. For example, a table name is provided without a column name and primary keys or a table name and a column name is provided with no primary keys. However a column name and primary keys cannot be used without a table name. Multiple primary keys may be listed until all the primary keys in that table have been given values.</p>
<h2>Examples</h2>
<p>The first message illustrated by the <a href="sample-ice-in-c-.html">Sample ICE in C++</a>:</p>
<p>&quot;ICE01\t3\tCreated 04/29/1998 by <!-- raw HTML omitted -->.&quot;</p>
<p>The second message posted by the sample ICE:</p>
<p>&quot;ICE01\t3\tLast modified 05/06/1999 by <!-- raw HTML omitted -->.&quot;</p>
<p>The third message posted by the sample ICE.</p>
<p>&quot;ICE01\t3\tSimple ICE to illustrating the ICE concept&quot;.</p>
<p>Â </p>
<p>Â </p>
</body>
