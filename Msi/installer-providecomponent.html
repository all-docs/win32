<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Installer.ProvideComponent method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The ProvideComponent method of the Installer object returns the full component path and performs any necessary installation.
ms.assetid: 2bf09515-6f65-4712-89c1-01c43c1ce27c
title: Installer.ProvideComponent method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Installer.ProvideComponent
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Installer.ProvideComponent method</h1>
<p>The <strong>ProvideComponent</strong> method of the <a href="installer-object.html"><strong>Installer</strong></a> object returns the full component path and performs any necessary installation. If necessary, the <strong>ProvideComponent</strong> method of the <a href="installer-object.html"><strong>Installer</strong></a> object prompts for the source and increments the usage count for the feature.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>Installer.ProvideComponent(
  Product,
  Feature,
  Component,
  InstallMode
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Product</em></p>
<!-- raw HTML omitted -->
<p>Specifies the product code of the product.</p>
<!-- raw HTML omitted -->
<p><em>Feature</em></p>
<!-- raw HTML omitted -->
<p>Specifies the feature ID of the feature containing the component.</p>
<!-- raw HTML omitted -->
<p><em>Component</em></p>
<!-- raw HTML omitted -->
<p>Specifies the component code.</p>
<!-- raw HTML omitted -->
<p><em>InstallMode</em></p>
<!-- raw HTML omitted -->
<p>Defines the installation mode. This parameter can be one of the values shown in the following table.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiInstallModeDefault</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Provides the component path, performing any installation, if necessary.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiInstallModeExisting</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->â€“1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Provides the component path only if the feature exists; otherwise, returns an empty string. This mode verifies the existence of the component's key file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiInstallModeNoDetection</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->â€“2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Provides the component path only if the feature exists. Otherwise, returns an empty string. This mode checks the component's registration but does not verify the existence of the component's key file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiInstallModeNoSourceResolution</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->â€“3<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Provides the component path only if the feature exists with an InstallState parameter of <em>msiInstallStateLocal</em>. This checks the component's registration but does not verify the existence of the component's key file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>combination of the msiReinstallMode flags</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Calls <a href="installer-reinstallfeature.html"><strong>ReinstallFeature</strong></a> to reinstall the feature using this parameter for the <em>ReinstallMode</em> parameter, and then provides the component.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>The <strong>ProvideComponent</strong> method combines the functionality of <a href="installer-usefeature.html"><strong>UseFeature</strong></a>, <a href="installer-configurefeature.html"><strong>ConfigureFeature</strong></a>, and <a href="installer-componentpath.html"><strong>ComponentPath</strong></a>. The <strong>ProvideComponent</strong> method simplifies the calling sequence, but it also increments the usage count and should be used with caution to prevent inaccurate usage counts. The <strong>ProvideComponent</strong> method also provides less flexibility than a series of individual calls to the methods and properties previously mentioned.</p>
<p>If the application is recovering from an unexpected situation, the application has probably already called <a href="installer-usefeature.html"><strong>UseFeature</strong></a> and incremented the usage count. In this case, the application should avoid incrementing the usage count by calling the <a href="installer-configurefeature.html"><strong>ConfigureFeature</strong></a> method instead of the <strong>ProvideComponent</strong> method.</p>
<p>The msiInstallModeExisting option cannot be used in combination with msiReinstallMode flags.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer on Windows ServerÂ 2003 or WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IInstaller is defined as 000C1090-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Msi/nf-msi-msiprovidecomponenta"><strong>MsiProvideComponent</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
