<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>UiCreatePatchPackage (Patchwiz.dll)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The UiCreatePatchPackage function takes a package creation file (.pcp file) and generates a Windows Installer patch package (.msp package).
ms.assetid: 77fedb80-b664-417d-879b-846e74cc4c23
title: UiCreatePatchPackage (Patchwiz.dll)
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>UiCreatePatchPackage (Patchwiz.dll)</h1>
<p>The UiCreatePatchPackage function takes a package creation file (.pcp file) and generates a Windows Installer patch package (.msp package). Calling <a href="msimsp-exe.html">Msimsp.exe</a> is the recommended method for using <a href="patchwiz-dll.html">Patchwiz.dll</a>. The <a href="uicreatepatchpackageex--patchwiz-dll-.html">UiCreatePatchPackageEx</a> function is available in version 4.0 of Patchwiz.dll and extends the functionality of the UiCreatePatchPackage function.</p>
<pre lang="syntax"><code>UINT UiCreatePatchPackage(
  LPCTSTR szPcpPath,              
  LPCTSTR szPatchPath,            
  LPCTSTR szLogPath,             
  HWND hwndStatus,                
  LPCTSTR szTempFolder,           
  Bool fRemoveTempFolderContents  
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>szPcpPath</em></p>
<!-- raw HTML omitted -->
<p>Full path to the patch creation properties file (.pcp file) for this patch.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>szPatchPath</em></p>
<!-- raw HTML omitted -->
<p>Full path to the Windows Installer patch package (.msp file) that is to be created. This parameter may be <strong>NULL</strong> or an empty string but may not be omitted. If it is <strong>NULL</strong> or an empty string, the function uses the value of PatchOutputPath in the <a href="properties-table-patchwiz-dll-.html">Properties Table (Patchwiz.dll)</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>szLogPath</em></p>
<!-- raw HTML omitted -->
<p>Full path to a text log file that will be appended. This parameter may be <strong>NULL</strong> or an empty string but may not be omitted.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>hwndStatus</em></p>
<!-- raw HTML omitted -->
<p>Handle to a window that displays the status text. This parameter may be <strong>NULL</strong> or an empty string but may not be omitted.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>szTempFolder</em></p>
<!-- raw HTML omitted -->
<p>Location for temporary files. This parameter may be <strong>NULL</strong> or an empty string but may not be omitted. The default location is %TMP%\~pcw_tmp.tmp\.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>fRemoveTempFolderContents</em></p>
<!-- raw HTML omitted -->
<p>If <strong>TRUE</strong>, remove the temporary folder and all of its contents if present. If <strong>FALSE</strong>, and folder is present, the function fails.</p>
<!-- raw HTML omitted -->
<h2>Return Values</h2>
<p>See the table in <a href="return-values-for-uicreatepatchpackage.html">Return Values for UiCreatePatchPackage</a>.</p>
<h2>Remarks</h2>
<p>For an example of authoring a .pcp file and using UiCreatePatchPackage to generate a Windows Installer patch package, see the section <a href="a-small-update-patching-example.html">A Small Update Patching Example</a>.</p>
<p>Creating a patch requires an uncompressed setup image, such as an administrative image or an uncompressed setup image from a CD-ROM. UiCreatePatchPackage does not generate binary patches for files in cabinets.</p>
<p>Â </p>
<p>Â </p>
</body>
