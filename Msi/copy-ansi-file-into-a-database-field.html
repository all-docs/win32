<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Copy ANSI File Into a Database Field</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The VBScript code sample file WiTextIn.vbs is provided in the Windows SDK Components for Windows Installer Developers.
ms.assetid: ba6c6367-ebb1-4981-ae3a-bcff68aacdbf
title: Copy ANSI File Into a Database Field
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Copy ANSI File Into a Database Field</h1>
<p>The VBScript code sample file WiTextIn.vbs is provided in the <a href="platform-sdk-components-for-windows-installer-developers.html">Windows SDK Components for Windows Installer Developers</a>. The sample shows how a script can be used to copy a file into a text field of a Windows Installer database, and demonstrates the processing of primary key data.</p>
<p>The code sample also shows you the following:</p>
<ul>
<li><a href="installer-opendatabase.html"><strong>OpenDatabase method (Installer Object)</strong></a> and the <a href="installer-lasterrorrecord.html"><strong>LastErrorRecord method</strong></a> of the <a href="installer-object.html"><strong>Installer Object</strong></a></li>
<li><a href="database-openview.html"><strong>OpenView method</strong></a>, the <a href="database-commit.html"><strong>Commit method</strong></a>, and the <a href="database-primarykeys.html"><strong>PrimaryKeys property</strong></a> of the <a href="database-object.html"><strong>Database Object</strong></a></li>
<li><a href="view-fetch.html"><strong>Fetch method</strong></a> and the <a href="view-modify.html"><strong>Modify method</strong></a> of the <a href="view-object.html"><strong>View Object</strong></a></li>
<li><a href="record-stringdata.html"><strong>StringData property</strong></a> and <a href="record-readstream.html"><strong>ReadStream method</strong></a> of the <a href="record-object.html"><strong>Record Object</strong></a></li>
</ul>
<p>To use the code sample you need the CScript.exe or WScript.exe version of Windows Script Host.</p>
<p><strong>To use CScript.exe to run this sample</strong></p>
<ul>
<li>
<p>At the command prompt, type the following syntax:</p>
<p><strong>cscript WiTextIn.vbs [path to database][table name][primary key values][column name][path to file]</strong></p>
</li>
</ul>
<blockquote>
<p>[!Note]<br />
Help is displayed if the first argument is /? or if too few arguments are specified.</p>
</blockquote>
<p>Â </p>
<p><strong>To redirect the output to a file</strong></p>
<ul>
<li>End the command line with the following: <strong>VBS &gt; [path to file]. T</strong></li>
</ul>
<blockquote>
<p>[!Note]<br />
The sample returns a value of 0 (zero) for success, 1 (one) if Help is invoked, and 2 (two) if the script fails.</p>
</blockquote>
<p>Â </p>
<p>The following list identifies the items that you must specify:</p>
<ul>
<li>Specify the path to the Windows Installer database.</li>
<li>Specify the name of the database table.</li>
<li>Specify all the primary key values for the row, in order, and concatenated with colons.</li>
<li>Specify a column name that is not a key column. This is the column that you want to receive the data.</li>
<li>Specify the path to the text file that is being copied.</li>
</ul>
<blockquote>
<p>[!Note]<br />
If the last argument is omitted, the current value in the field is displayed.</p>
</blockquote>
<p>Â </p>
<p>For more scripting examples, see <a href="windows-installer-scripting-examples.html">Windows Installer Scripting Examples</a>. For sample utilities that do not require the Windows Script Host, see <a href="windows-installer-development-tools.html">Windows Installer Development Tools</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
