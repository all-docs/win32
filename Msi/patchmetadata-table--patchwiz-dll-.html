<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PatchMetadata Table (PATCHWIZ.DLL)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The PatchMetadata Table contains information about a Windows Installer patch that is required to remove a patch and that is used by Add/Remove Programs.
ms.assetid: 09a06de4-0713-4e92-ab29-f34f6c94b677
title: PatchMetadata Table (PATCHWIZ.DLL)
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>PatchMetadata Table (PATCHWIZ.DLL)</h1>
<p>The PatchMetadata Table contains information about a Windows Installer patch that is required to remove a patch and that is used by Add/Remove Programs. All the properties in the PatchMetadata Table are added to the <a href="msipatchmetadata-table.html">MsiPatchMetadata Table</a> of the .msp file for a patch.</p>
<p>The PatchMetadata Table is required in patch creation properties files (.pcp files) that have a MinimumRequiredMsiVersion equal to 300 in the <a href="properties-table-patchwiz-dll-.html">Properties Table</a>. The table is optional if MinimumRequiredMsiVersion is not equal to 300.</p>
<p>The PatchMetadata Table has the following columns.</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Key</th>
<th>Nullable</th>
</tr>
</thead>
<tbody>
<tr>
<td>Company</td>
<td>text</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td>Property</td>
<td>text</td>
<td>Y</td>
<td>N</td>
</tr>
<tr>
<td>Value</td>
<td>text</td>
<td></td>
<td>Y</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Columns</h3>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Company</p>
<!-- raw HTML omitted -->
<p>The name of the company. An empty field (a Null value) indicates that this row contains one of the standard metadata properties. A company can extend the property set by adding a row to the table, and entering a company name in this field.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Property</p>
<!-- raw HTML omitted -->
<p>The name of a metadata property. The AllowRemoval, ManufacturerName, TargetProductName, MoreInfoURL, DisplayName, Description, and Classification properties are required in the PatchMetadata Table . This field must contain one of the following standard metadata properties if the Company field is empty (a Null value).</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AllowRemoval</td>
<td>An integer value that indicates whether or not the patch is an <!-- raw HTML omitted -->Uninstallable Patch<!-- raw HTML omitted -->. If the Value field contains a 0 (zero), the patch cannot be removed. If the Value field contains 1 (one), the patch is an Uninstallable Patch. This property is required.This property is registered and its value can be obtain by using the <!-- raw HTML omitted --><!-- raw HTML omitted -->MsiGetPatchInfoEx<!-- raw HTML omitted --><!-- raw HTML omitted --> function.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>ManufacturerName</td>
<td>A string value that contains the name of the manufacturer of the application. This property is required.</td>
</tr>
<tr>
<td>MinorUpdateTargetRTM</td>
<td>Indicates that the patch targets the RTM version of the product or the most recent major upgrade patch. Author this optional property in minor upgrade patches that contain sequencing information to indicate that the patch removes of all patches up to the RTM version of the product, or up to the most recent major upgrade patch. This property is available beginning with Windows InstallerÂ 3.1. <strong>Note:</strong> To require that Windows InstallerÂ 3.1 be installed to apply the patch, set the MinimumRequiredMsiVersion property to 310 in the <a href="properties-table-patchwiz-dll-.html">Properties Table</a> of the .pcp file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TargetProductName</td>
<td>A string value that contains the name of the application or target application suite. This property is required.</td>
</tr>
<tr>
<td>MoreInfoURL</td>
<td>A string value that contains a URL pointing to information for this patch. This required property is registered and its value can be obtained by using the <!-- raw HTML omitted --><!-- raw HTML omitted -->MsiGetPatchInfoEx<!-- raw HTML omitted --><!-- raw HTML omitted --> function. Beginning with WindowsÂ XP with Service PackÂ 2 (SP2), this value can be the support link for the patch displayed in Add/Remove Programs.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>CreationTimeUTC</td>
<td>A string value that contains the creation time of the .msp file in the form mm-dd-yy HH:MM (month-day-year hour:minute). This property is optional.</td>
</tr>
<tr>
<td>DisplayName</td>
<td>A string value that contains the title for the patch that is suitable for public display. This property is required. This property is registered and its value can be obtain by using the <!-- raw HTML omitted --><!-- raw HTML omitted -->MsiGetPatchInfoEx<!-- raw HTML omitted --><!-- raw HTML omitted --> function. Beginning with WindowsÂ XP with SP2, this value is the name of the patch displayed in Add/Remove Programs beginning with WindowsÂ XP with SP2.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Description</td>
<td>A string value that contains a brief description of the patch. This property is required.</td>
</tr>
<tr>
<td>Classification</td>
<td>A string value that contains the arbitrary category of updates as defined by the author of the patch. For example, patch authors can specify that each patch be classified as a Hotfix, Security Rollup, Critical Update, Update, Service Pack, or Update Rollup. This property is required.</td>
</tr>
<tr>
<td>OptimizedInstallMode</td>
<td>If this property is set to 1 (one) in all the patches to be applied in a transaction, the application of the patch is optimized if possible. For information, see <!-- raw HTML omitted -->Patch Optimization<!-- raw HTML omitted -->. Available beginning with Windows InstallerÂ 3.1.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Value</p>
<!-- raw HTML omitted -->
<p>Value of the metadata property. This can never be Null or an empty string. This value can be localized.</p>
<!-- raw HTML omitted -->
<h3>Remarks</h3>
<p>Available beginning in Windows InstallerÂ 3.0.</p>
<p>All properties authored into the PatchMetadata Table are added to the MsiPatchMetadata table of the msp file. AllowRemoval, MoreInfoURL and DisplayName properties are registered and are accessible through the <a href="/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa"><strong>MsiGetPatchInfoEx</strong></a>.</p>
<p>Â </p>
<p>Â </p>
</body>
