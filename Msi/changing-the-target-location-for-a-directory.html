<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Changing the Target Location for a Directory</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: If possible, the best way to specify the target location for a directory is to author the Directory Table in your installation package to provide the correct location. For more information, see Using the Directory Table.
ms.assetid: 2d16e036-2d7f-431d-b646-1addf2f65f3f
title: Changing the Target Location for a Directory
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Changing the Target Location for a Directory</h1>
<p>If possible, the best way to specify the target location for a directory is to author the <a href="directory-table.html">Directory Table</a> in your installation package to provide the correct location. For more information, see <a href="using-the-directory-table.html">Using the Directory Table</a>.</p>
<p>If you need to change the directory location at the time of the installation, you have the following options:</p>
<ul>
<li>Specify the location of a directory by setting the value of a <a href="public-properties.html">Public Property</a> on the command line. During the <a href="costfinalize-action.html">CostFinalize Action</a>, the internal directory paths used by the installer are updated to the value of properties listed as keys in the <a href="directory-table.html">Directory Table</a>. For more information, see <a href="using-properties.html">Using Properties</a> and <a href="setting-public-property-values-on-the-command-line.html">Setting Public Property Values on the Command Line</a>.</li>
<li>Specify the location of a directory by using a custom action. If the custom action is to run before the <a href="costfinalize-action.html">CostFinalize Action</a>, you can use a <a href="custom-action-type-51.html">Custom Action Type 51</a> to set the value of a property from a formatted text string. If the custom action runs after the <a href="costfinalize-action.html">CostFinalize Action</a>, you can use a <a href="custom-action-type-35.html">Custom Action Type 35</a> to set the value of the directory path from a formatted text string. Custom actions that change one of the <a href="property-reference.html">System Folder Properties</a> should be included in both the execution sequence tables (<a href="installexecutesequence-table.html">InstallExecuteSequence Table</a> or <a href="adminexecutesequence-table.html">AdminExecuteSequence Table</a>), and the user interface sequence tables (<a href="installuisequence-table.html">InstallUISequence Table</a> and <a href="adminuisequence-table.html">AdminUISequence Table</a>) so that the folder is changed during both <a href="f-gly.html"><em>full UI</em></a> and <a href="b-gly.html"><em>basic UI</em></a> installations.</li>
<li>If the installation is running a <a href="f-gly.html"><em>full UI</em></a>, you can use <a href="/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha"><strong>MsiSetTargetPath</strong></a> or the <a href="settargetpath-controlevent.html">SetTargetPath ControlEvent</a> to set the directory path. Check the <a href="productstate.html"><strong>ProductState</strong></a> Property to determine whether the product that contains this component is already installed before calling <strong>MsiSetTargetPath</strong> or the SetTargetPath ControlEvent. Do not attempt to change the target directory path if some components that use that path are already installed for the current user or a different user.</li>
</ul>
<p>The following restrictions apply to all of the above options:</p>
<ul>
<li>Do not attempt to change the target directory path if some components that use the path are already installed for the current user or for a different user.</li>
<li>Do not attempt to change the target directory path during a <a href="maintenance-installation.html">Maintenance Installation</a>.</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
