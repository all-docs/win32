<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Msimsp.exe</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The recommended method for generating a patch package is to use patch creation tools such as Msimsp.exe and Patchwiz.dll. The Msimsp.exe tool is only available in the Windows SDK Components for Windows Installer Developers.
ms.assetid: fa8e9d68-3db1-4d17-aa99-2ca0ed421c7a
title: Msimsp.exe
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Msimsp.exe</h1>
<p>The recommended method for generating a patch package is to use patch creation tools such as Msimsp.exe and <a href="patchwiz-dll.html">Patchwiz.dll</a>. The Msimsp.exe tool is only available in the <a href="platform-sdk-components-for-windows-installer-developers.html">Windows SDK Components for Windows Installer Developers</a>.</p>
<p>Msimsp.exe is a executable file that calls <a href="patchwiz-dll.html">Patchwiz.dll</a>. The tool can be used to create a patch package by passing in the path to a patch creation properties file (.pcp file) and the path to the patch package that is being created. Msimsp.ex can also be used to create a log file and to specify a temporary folder in which the transforms, cabinets, and files that are used to create the patch package are saved.</p>
<p>The command-line syntax for Msimsp.exe is:</p>
<p><strong>Msimsp.exe -s</strong> <em>[path to .pcp file]</em> <strong>-p</strong> <em>[path to .msp file]</em> <strong>{options}</strong></p>
<p>The command-line options are not case-sensitive, and slash delimiters can be used instead of a dash. If no options are specified, Msimsp.exe displays the current values of the summary Information properties.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>-s</strong>*[path to .pcp file]*</p>
<!-- raw HTML omitted -->
<p>This is required and must be followed by the path to the patch creation properties file (.pcp extension). For more information, see <a href="patchwiz-dll.html">PatchWiz.dll</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>-p</strong><em>path to .msp file</em></p>
<!-- raw HTML omitted -->
<p>This is required and followed by the path to patch package that is being created (.msp extension).</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>-f</strong><em>path to temporary folder</em></p>
<!-- raw HTML omitted -->
<p>Optional. Followed by path to temporary folder. The default location is %TMP%\~pcw_tmp.tmp\.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>-k</strong></p>
<!-- raw HTML omitted -->
<p>Optional. Fail if the temporary folder already exists.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>-l</strong><em>path to log file</em></p>
<!-- raw HTML omitted -->
<p>Optional. Followed by the path to the log file that describes the patch creation process and errors. For more information, see <a href="return-values-for-uicreatepatchpackage.html">Return Values for UiCreatePatchPackage</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>-lp</strong><em>path to log file with performance data</em></p>
<!-- raw HTML omitted -->
<p>Optional. Followed by the path to the log file that describes the patch creation process and errors. This option writes performance data to log file. This option requires version 4.0 of Patchwiz.dll.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>-d</strong></p>
<!-- raw HTML omitted -->
<p>Optional. Displays a dialog if the patch creation completes successfully.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>-?</strong></p>
<!-- raw HTML omitted -->
<p>Displays command-line help.</p>
<!-- raw HTML omitted -->
<blockquote>
<p>[!Note]
Msimsp.exe can fail when it calls Makecab.exe if there are values in the File column of the <a href="file-table.html">File table</a> of the installation package that differ only by case. Windows Installer is case-sensitive and allows an installation package such as in the table below only when Comp1 and Comp2 are installed into different directories. However, in this scenario you cannot use Msimsp.exe or <a href="patchwiz-dll.html">Patchwiz.dll</a> to generate a patch for the package, because Msimsp.exe and Patchwiz.dll call Makecab.exe, which is case-insensitive.</p>
<p>Avoid authoring an installation package such as the following partial <a href="file-table.html">File table</a>.</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Component_</th>
<th>FileName</th>
</tr>
</thead>
<tbody>
<tr>
<td>readme.txt</td>
<td>Comp1</td>
<td>readme.txt</td>
</tr>
<tr>
<td>ReadMe.txt</td>
<td>Comp2</td>
<td>readme.txt</td>
</tr>
</tbody>
</table>
</blockquote>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="creating-a-patch-package.html">Creating a Patch Package</a></p>
<!-- raw HTML omitted -->
<p><a href="a-small-update-patching-example.html">A Small Update Patching Example</a></p>
<!-- raw HTML omitted -->
<p><a href="windows-installer-development-tools.html">Windows Installer Development Tools</a></p>
<!-- raw HTML omitted -->
<p><a href="released-versions-tools-and-redistributables.html">Released Versions, Tools, and Redistributables</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
