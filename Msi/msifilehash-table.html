<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MsiFileHash Table</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The MsiFileHash table is used to store a 128-bit hash of a source file provided by the Windows Installer package. The hash is split into four 32-bit values and stored in separate columns of the table.
ms.assetid: 972a2784-418d-4cb3-b13c-df89b079e94c
title: MsiFileHash Table
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>MsiFileHash Table</h1>
<p>The <strong>MsiFileHash</strong> table is used to store a 128-bit hash of a source file provided by the Windows Installer package. The hash is split into four 32-bit values and stored in separate columns of the table.</p>
<p>Windows Installer can use file hashing as a means to detect and eliminate unnecessary file copying. A file hash stored in the <strong>MsiFileHash</strong> table may be compared to a hash of an existing file on the user's computer obtained by calling <a href="/windows/desktop/api/Msi/nf-msi-msigetfilehasha"><strong>MsiGetFileHash</strong></a>. The <strong>MsiFileHash</strong> table can only be used with unversioned files.</p>
<p>The <strong>MsiFileHash</strong> table has the following columns.</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Key</th>
<th>Nullable</th>
</tr>
</thead>
<tbody>
<tr>
<td>File_</td>
<td><a href="identifier.html">Identifier</a></td>
<td>Y</td>
<td>N</td>
</tr>
<tr>
<td>Options</td>
<td><a href="integer.html">Integer</a></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>HashPart1</td>
<td><a href="doubleinteger.html">DoubleInteger</a></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>HashPart2</td>
<td><a href="doubleinteger.html">DoubleInteger</a></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>HashPart3</td>
<td><a href="doubleinteger.html">DoubleInteger</a></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>Hashpart4</td>
<td><a href="doubleinteger.html">DoubleInteger</a></td>
<td>N</td>
<td>N</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Columns</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->File_</p>
<!-- raw HTML omitted -->
<p>Foreign key to <a href="file-table.html">File table</a>. 72 char string.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Options</p>
<!-- raw HTML omitted -->
<p>This column must be 0 and is reserved for future use.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->HashPart1</p>
<!-- raw HTML omitted -->
<p>First 32 bits of hash. The file hash entered in this field must be obtained by calling <a href="/windows/desktop/api/Msi/nf-msi-msigetfilehasha"><strong>MsiGetFileHash</strong></a> or the <a href="installer-filehash.html"><strong>FileHash method</strong></a>. Do not use other methods.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->HashPart2</p>
<!-- raw HTML omitted -->
<p>Second 32 bits of hash. The file hash entered in this field must be obtained by calling <a href="/windows/desktop/api/Msi/nf-msi-msigetfilehasha"><strong>MsiGetFileHash</strong></a> or the <a href="installer-filehash.html"><strong>FileHash method</strong></a>. Do not use other hashing methods.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->HashPart3</p>
<!-- raw HTML omitted -->
<p>Third 32 bits of hash. The file hash entered in this field must be obtained by calling <a href="/windows/desktop/api/Msi/nf-msi-msigetfilehasha"><strong>MsiGetFileHash</strong></a> or the <a href="installer-filehash.html"><strong>FileHash method</strong></a>. Do not use other methods.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->HashPart4</p>
<!-- raw HTML omitted -->
<p>Fourth 32 bits of hash. The file hash entered in this field must be obtained by calling <a href="/windows/desktop/api/Msi/nf-msi-msigetfilehasha"><strong>MsiGetFileHash</strong></a> or the <a href="installer-filehash.html"><strong>FileHash method</strong></a>. Do not use other methods.</p>
<!-- raw HTML omitted -->
<h2>Validation</h2>
<!-- raw HTML omitted -->
<p><a href="ice03.html">ICE03</a><br />
<a href="ice06.html">ICE06</a><br />
<a href="ice32.html">ICE32</a><br />
<a href="ice60.html">ICE60</a><br />
<a href="ice66.html">ICE66</a></p>
<!-- raw HTML omitted -->
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Msi/nf-msi-msigetfilehasha"><strong>MsiGetFileHash</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="default-file-versioning.html">Default File Versioning</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
