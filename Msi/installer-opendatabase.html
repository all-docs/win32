<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Installer.OpenDatabase method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The OpenDatabase method of the Installer object opens an existing database or creates a new one, returning a Database object. It generates an error if the Database object cannot be successfully created and opened.
ms.assetid: a77b3954-db27-41a0-8f8b-2654766bde6a
title: Installer.OpenDatabase method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Installer.OpenDatabase
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Installer.OpenDatabase method</h1>
<p>The <strong>OpenDatabase</strong> method of the <a href="installer-object.html"><strong>Installer</strong></a> object opens an existing database or creates a new one, returning a <a href="database-object.html"><strong>Database</strong></a> object. It generates an error if the <strong>Database</strong> object cannot be successfully created and opened.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>Installer.OpenDatabase(
  name,
  openMode
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>name</em></p>
<!-- raw HTML omitted -->
<p>Required string that contains the path name of the database. If an empty string is supplied, a temporary database is created that is not persisted.</p>
<!-- raw HTML omitted -->
<p><em>openMode</em></p>
<!-- raw HTML omitted -->
<p>A parameter from the following list or a string that contains the path name of the new output database file that is to be written to upon commit.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiOpenDatabaseModeReadOnly</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Opens a database read-only, no persistent changes.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiOpenDatabaseModeTransact</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Opens a database read/write in transaction mode.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiOpenDatabaseModeDirect</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Opens a database direct read/write without transaction.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiOpenDatabaseModeCreate</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->3<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Creates a new database, transact mode read/write.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiOpenDatabaseModeCreateDirect</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->4<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Creates a new database, direct mode read/write.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiOpenDatabaseModeListScript</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->5<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Opens a database to view advertise script files, such as the files generated by the <a href="installer-createadvertisescript.html"><strong>CreateAdvertiseScript</strong></a> method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiOpenDatabaseModePatchFile</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->32<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Adds this flag to indicate a patch file.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>A <a href="database-object.html"><strong>Database</strong></a> object that represents the existing or new installer database that was opened.</p>
<h2>Remarks</h2>
<p>When a database is opened as the output of another database, the summary information stream of the output database is actually a read-only mirror of the original database and thus cannot be changed. Additionally, it is not persisted with the database. To create or modify the summary information for the output database it must be closed and reopened.</p>
<p>To make and save changes to a database first open the database in transaction (msiOpenDatabaseModeTransact), create (msiOpenDatabaseModeCreate or msiOpenDatabaseModeCreateDirect), or direct (msiOpenDatabaseModeDirect) mode. After making the changes, always call the <a href="database-commit.html"><strong>Commit</strong></a> method before closing the database handle. The <strong>Commit</strong> method flushes all buffers.</p>
<p>Always call the <a href="database-commit.html"><strong>Commit</strong></a> method on a database that has been opened in direct mode (msiOpenDatabaseModeDirect or msiOpenDatabaseModeCreateDirect) before closing the database. Failure to do this may corrupt the database.</p>
<p>Because the <strong>OpenDatabase</strong> method initiates database access, it cannot be used with a running installation.</p>
<p>If the method fails, you can obtain extended error information by using the <a href="installer-lasterrorrecord.html"><strong>LastErrorRecord</strong></a> method.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer on Windows ServerÂ 2003 or WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IInstaller is defined as 000C1090-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
