<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Patchwiz.dll</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: To generate a patch package, it is recommended that you use a patch creation tool such as Msimsp.exe and Patchwiz.dll.
ms.assetid: aca3bbd2-440a-405f-bddc-5f9cc831b811
title: Patchwiz.dll
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Patchwiz.dll</h1>
<p>To generate a patch package, it is recommended that you use a patch creation tool such as <a href="msimsp-exe.html">Msimsp.exe</a> and Patchwiz.dll. Patchwiz.dll version 4.0 is compatible with packages and patches that were authored using earlier versions of the Patchwiz.dll. The Patchwiz.dll tool is only available in the <a href="platform-sdk-components-for-windows-installer-developers.html">Windows SDK Components for Windows Installer Developers</a>.</p>
<p>Patchwiz.dll version 4.0 has one new function, <a href="uicreatepatchpackageex--patchwiz-dll-.html">UiCreatePatchPackageEx (Patchwiz.dll)</a>, that extends the functionality of <a href="uicreatepatchpackage-patchwiz-dll-.html">UiCreatePatchPackage (Patchwiz.dll)</a>. These functions take a patch creation properties file (.pcp file) and generate an installer <a href="patch-packages.html">Patch Package</a>.</p>
<p>The .pcp file is a binary database file with the same format as a Windows Installer database (.msi file), but with a different database schema. Therefore a .pcp file can be authored by using the same tools used for an installer database.</p>
<p>You can create a .pcp file by using a table editor such as <a href="orca-exe.html">Orca.exe</a> to enter information into the blank .pcp database provided with the Windows Installer SDK, Template.pcp. For more information, see <a href="a-small-update-patching-example.html">A Small Update Patching Example</a>.</p>
<p>The following database tables are required in every .pcp file:</p>
<ul>
<li><a href="properties-table-patchwiz-dll-.html">Properties Table (Patchwiz.dll)</a></li>
<li><a href="imagefamilies-table-patchwiz-dll-.html">ImageFamilies Table (Patchwiz.dll)</a></li>
<li><a href="upgradedimages-table-patchwiz-dll-.html">UpgradedImages Table (Patchwiz.dll)</a></li>
<li><a href="targetimages-table-patchwiz-dll-.html">TargetImages Table (Patchwiz.dll)</a></li>
</ul>
<p>The following database tables are optional:</p>
<ul>
<li><a href="upgradedfiles-optionaldata-table-patchwiz-dll-.html">UpgradedFiles_OptionalData Table (Patchwiz.dll)</a></li>
<li><a href="familyfileranges-table-patchwiz-dll-.html">FamilyFileRanges Table (Patchwiz.dll)</a></li>
<li><a href="targetfiles-optionaldata-table-patchwiz-dll-.html">TargetFiles_OptionalData Table (Patchwiz.dll)</a></li>
<li><a href="externalfiles-table-patchwiz-dll-.html">ExternalFiles Table (Patchwiz.dll)</a></li>
<li><a href="upgradedfilestoignore-table-patchwiz-dll-.html">UpgradedFilesToIgnore Table (Patchwiz.dll)</a></li>
</ul>
<p>The following table is required in .pcp files that have a MinimumRequiredMsiVersion equal to 300 in the <a href="properties-table-patchwiz-dll-.html">Properties</a> table.</p>
<ul>
<li><a href="patchmetadata-table--patchwiz-dll-.html">PatchMetadata Table (Patchwiz.dll)</a></li>
</ul>
<blockquote>
<p>[!Note]<br />
The table is optional if MinimumRequiredMsiVersion is not equal to 300.</p>
</blockquote>
<p>Â </p>
<p>The version of Patchwiz.dll released with Windows InstallerÂ 3.0 can automatically generate patch sequencing information and add it to the <a href="msipatchsequence-table.html">MsiPatchSequence Table</a> of a new patch. The <a href="patchsequence-table--patchwiz-dll-.html">PatchSequence Table</a> can be used to manually add patch sequencing information the MsiPatchSequence Table. For more information, see <a href="generating-patch-sequence-information---patchwiz-dll-.html">Generating Patch Sequence Information</a>.</p>
<p>Beginning with Patchwiz.dll version 2.0, you can increase the speed of subsequent patch creation by using <a href="patch-information-caching-patchwiz-dll-.html">Patch Information Caching (Patchwiz.dll)</a>.</p>
<p>Using public symbols for your target and upgrade image binaries can reduce binary patch sizes by approximately one half. For more information, see <a href="using-symbols-to-reduce-binary-patch-size.html">Using Symbols to Reduce Binary Patch Size</a>.</p>
<p>You can specify that certain regions of the target file be preserved from being overwritten during patching and that the information in those regions be retained. For more information, see <a href="patching-selected-regions-of-a-file.html">Patching Selected Regions of a File</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="released-versions-tools-and-redistributables.html">Released Versions, Tools, and Redistributables</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
