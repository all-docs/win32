<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Authoring Multiple Instances with Instance Transforms</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: To install multiple instances of a product from one Windows Installer package, you need to author a base installation package for the product and an instance transform for each instance to be installed in addition to the base instance.
ms.assetid: fef49dda-503f-4b13-8763-70cb2ee0df5d
title: Authoring Multiple Instances with Instance Transforms
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Authoring Multiple Instances with Instance Transforms</h1>
<p>To install multiple instances of a product from one Windows Installer package, you need to author a base installation package for the product and an instance transform for each instance to be installed in addition to the base instance. Use the following guidelines when authoring your base package and transforms:</p>
<ul>
<li>Your setup application can check for the presence of the installer running on a version of WindowsÂ Vista, Windows ServerÂ 2003, WindowsÂ XP with Service PackÂ 1 (SP1), and the Windows InstallerÂ 3.0 redistributable. Any of these installer versions (or later) are required to install multiple instances from a single package using a product codeâ€“changing transform.</li>
<li>Each instance must have a unique product code and instance identifier. You may define a property in the base package, the value of which can be set to the instance identifier.</li>
<li>To keep the files of each instance isolated, the base package should install files into a directory location that depends on the instance identifier.</li>
<li>To keep the nonfile data of each instance isolated, the base package should collect nonfile data into sets of components for each instance. The appropriate components should then be installed based on conditional statements that depend on the instance identifier.</li>
<li>Author an instance transform for each instance being installed in addition to the base instance. The base package may install its own instance.</li>
<li>The instance transform must change the product code and identifier for each instance.</li>
<li>It is recommended that the product transform also change the product name so that the instance is readily distinguished in Add/Remove Programs through Control Panel.</li>
<li>If the instance transform installs files, they should be installed in a directory that depends on the instance identifier.</li>
<li>All nonfile data, such as registry keys, should include the instance name in their path to prevent collisions. This can be accomplished by using the property whose value is the instance identifier in the path as shown by the following example of a <a href="registry-table.html">Registry Table</a>.</li>
</ul>
<table>
<thead>
<tr>
<th>Registry</th>
<th>Root</th>
<th>Key</th>
<th>Name</th>
<th>Value</th>
<th>Component_</th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg1</td>
<td>1</td>
<td>Software\Microsoft\MyProduct\[InstanceId]</td>
<td>InstanceGuid</td>
<td>[ProductCode]</td>
<td>NonFileDataComp1</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>For more information, see <a href="installing-multiple-instances-of-products-and-patches.html">Installing Multiple Instances of Products and Patches</a> and <a href="installing-multiple-instances-with-instance-transforms.html">Installing Multiple Instances with Instance Transforms</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
