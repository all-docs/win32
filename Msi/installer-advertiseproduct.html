<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Installer::AdvertiseProduct method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The AdvertiseProduct method of the Installer object advertises an installation package.
ms.assetid: a060ccb5-353f-439b-8d48-709c81da5f2c
title: Installer::AdvertiseProduct method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Installer.AdvertiseProduct
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Installer::AdvertiseProduct method</h1>
<p>The <strong>AdvertiseProduct</strong> method of the <a href="installer-object.html"><strong>Installer</strong></a> object advertises an installation package.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>.AdvertiseProduct(
  packagePath,
  context,
  transforms,
  language,
  options
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>packagePath</em></p>
<!-- raw HTML omitted -->
<p>The full path to the Windows Installer package (.msi) to be advertised.</p>
<!-- raw HTML omitted -->
<p><em>context</em></p>
<!-- raw HTML omitted -->
<p>The context of the advertisement. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseProductMachine</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Advertises the application for an instalation in the per-machine <a href="installation-context.html">installation context</a>. This makes the package available for installation by all users of the computer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseProductUser</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Advertises the application for an installation in the per-user <a href="installation-context.html">installation context</a>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>transforms</em></p>
<!-- raw HTML omitted -->
<p>The list of transforms to apply to the product. Transforms in the list are delimited by semicolons. This parameter is optional.</p>
<!-- raw HTML omitted -->
<p><em>language</em></p>
<!-- raw HTML omitted -->
<p>The language of the installation package to use. This parameter is optional.</p>
<!-- raw HTML omitted -->
<p><em>options</em></p>
<!-- raw HTML omitted -->
<p>The advertisement options. This parameter is optional. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseDefault</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Standard advertisement<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiAdvertiseSingleInstance</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Advertises a new instance of the product. Requires that the first transform in the transform list of the <em>transforms</em> parameter be the instance transform that changes the product code. For more information, see <a href="installing-multiple-instances-of-products-and-patches.html">Installing Multiple Instances of Products and Patches</a>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>The <strong>AdvertiseProduct</strong> method uses the <a href="/windows/desktop/api/Msi/nf-msi-msiadvertiseproductexa"><strong>MsiAdvertiseProductEx</strong></a> function.</p>
<h2>Examples</h2>
<p>The following example demonstrates the use of the <strong>AdvertiseProduct</strong> method.</p>
<pre lang="VB"><code>Dim installer
Set installer = CreateObject(&quot;WindowsInstaller.Installer&quot;)

'
' Perform machine advertisement of package, use transform
'

Installer.AdvertiseProduct &quot;c:\scratch\simpletst\rtm\simple.msi&quot;, 0, &quot;c:\scratch\simpletst\rtm\transform.mst&quot;

'
' Verify advertised product state and registration
'
 
MsgBox Installer.ProductState(&quot;{BAE98781-CF88-4309-8E2D-3D8B347F5B53}&quot;)
MsgBox Installer.ProductInfo(&quot;{BAE98781-CF88-4309-8E2D-3D8B347F5B53}&quot;, &quot;Transforms&quot;)

'
' Remove Product
'
Installer.InstallProduct &quot;c:\scratch\simpletst\rtm\simple.msi&quot;, &quot;REMOVE=ALL&quot;
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer 4.5 on Windows ServerÂ 2003 and WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IInstaller is defined as 000C1090-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="installer-object.html"><strong>Installer</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="not-supported-in-windows-installer-version-3-1.html">Not Supported in Windows Installer 3.1 and earlier versions</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
