<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Returning Values from an External User Interface Handler</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: An external user interface (UI) handler can return any number of values to Windows Installer depending on the button type provided in the message type parameter the installer passes to the handler.
ms.assetid: a918082d-709d-4b4f-ae3b-5f16ed0ca910
title: Returning Values from an External User Interface Handler
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Returning Values from an External User Interface Handler</h1>
<p>An external user interface (UI) handler can return any number of values to Windows Installer depending on the button type provided in the message type parameter the installer passes to the handler.</p>
<p>The external UI handler can return the values â€“1 and 0 at any time because these are not related to the button types. A return value of â€“1 indicates that an internal error occurred in the external UI handler. A return value of 0 indicates that the external UI handler has not handled the installer message and the installer must handle the message instead.</p>
<p>For messages that do not include a button type, such as INSTALLMESSAGE_ACTIONDATA and INSTALLMESSAGE_PROGRESS, returning IDCANCEL cancels the installation. Returning IDOK notifies the installer that the message was handled by the external UI handler.</p>
<p>The remaining return values, as described below, are directly related to the button types that are included with the message type.</p>
<table>
<thead>
<tr>
<th>External UI return value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>IDOK</td>
<td>The <strong>OK</strong> button was pressed by the user. The message information was understood.</td>
</tr>
<tr>
<td>IDCANCEL</td>
<td>The <strong>CANCEL</strong> button was pressed. Cancel the installation.</td>
</tr>
<tr>
<td>IDABORT</td>
<td>The <strong>ABORT</strong> button was pressed. Abort the installation.</td>
</tr>
<tr>
<td>IDRETRY</td>
<td>The <strong>RETRY</strong> button was pressed. Try the action again.</td>
</tr>
<tr>
<td>IDIGNORE</td>
<td>The <strong>IGNORE</strong> button was pressed. Ignore the error and continue.</td>
</tr>
<tr>
<td>IDYES</td>
<td>The <strong>YES</strong> button was pressed. The affirmative response, continue with current sequence of events..</td>
</tr>
<tr>
<td>IDNO</td>
<td>The <strong>NO</strong> button was pressed. The negative response, do not continue with current sequence of events.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>For example, if the external UI handler is sent a message with the MB_ABORTRETRYIGNORE message box styles flag, the external UI handler can return one of the following values:</p>
<ul>
<li>â€“1 (error in external UI handler)</li>
<li>0 (no action taken in external UI handler, let Windows Installer handle it)</li>
<li>IDABORT (<strong>ABORT</strong> button pressed)</li>
<li>IDRETRY (<strong>RETRY</strong> button pressed)</li>
<li>IDIGNORE (<strong>IGNORE</strong> button pressed)</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
