<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MSIENFORCEUPGRADECOMPONENTRULES property</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Set the MSIENFORCEUPGRADECOMPONENTRULES property to 1 on the command line or in the Property table to apply the upgrade component rules during small updates and minor upgrades of a particular product.
ms.assetid: 0c8424c7-ab9b-4a09-aaa8-6a3f44c2789f
title: MSIENFORCEUPGRADECOMPONENTRULES property
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>MSIENFORCEUPGRADECOMPONENTRULES property</h1>
<p>Set the <strong>MSIENFORCEUPGRADECOMPONENTRULES</strong> property to 1 on the command line or in the <a href="property-table.html">Property table</a> to apply the upgrade component rules during <a href="small-updates.html">small updates</a> and <a href="minor-upgrades.html">minor upgrades</a> of a particular product. To apply the rules during small updates and minor upgrades of all products on the computer, set the <a href="enforceupgradecomponentrules.html">EnforceUpgradeComponentRules</a> policy to 1.</p>
<p>When the property or policy is set to 1, <a href="small-updates.html">small updates</a> and <a href="minor-upgrades.html">minor upgrades</a> can fail because the update tries to do the following that violates the upgrade component rules:</p>
<ul>
<li>
<p>Add a new feature to the top or middle of an existing feature tree.</p>
<p>The new feature must be added as a new leaf feature to an existing feature tree.</p>
<p>In this case, the <a href="productcode.html"><strong>ProductCode</strong></a> of the product can be changed and the update can be treated as a <a href="major-upgrades.html">major upgrade</a>.</p>
</li>
<li>
<p>Remove a component from a feature.</p>
<p>This can also occur if you change the GUID of a component. The component identified by the original GUID appears to be removed and the component as identified by the new GUID appears as a new component.</p>
<p><strong>Windows Installer 4.5 and later:</strong> The component can be removed correctly using Windows Installer 4.5 and later by setting the <strong>msidbComponentAttributesUninstallOnSupersedence</strong> attribute in the <a href="component-table.html">Component Table</a> or by setting the <a href="msiuninstallsupersededcomponents.html"><strong>MSIUNINSTALLSUPERSEDEDCOMPONENTS</strong></a> property.</p>
<p>Alternatively, the <a href="productcode.html"><strong>ProductCode</strong></a> of the product can be changed and the update can be treated as a <a href="major-upgrades.html">major upgrade</a>.</p>
</li>
</ul>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer 3.0 or later on Windows ServerÂ 2003 or WindowsÂ XP. See the <a href="windows-installer-portal.html">Windows Installer Run-Time Requirements</a> for information about the minimum Windows service pack that is required by a Windows Installer version.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="properties.html">Properties</a></p>
<!-- raw HTML omitted -->
<p><a href="not-supported-in-windows-installer-version-2-0.html">Not Supported in Windows Installer 2.0 and earlier</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
