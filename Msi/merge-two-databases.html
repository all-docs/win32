<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Merge Two Databases</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The VBScript file WiMerge.vbs is provided in the Windows SDK Components for Windows Installer Developers. This sample script merges one Windows Installer database into another database. For more information, see Merges and Transforms.
ms.assetid: 31867082-7c1d-4530-a066-236d8ee5f023
title: Merge Two Databases
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Merge Two Databases</h1>
<p>The VBScript file WiMerge.vbs is provided in the <a href="platform-sdk-components-for-windows-installer-developers.html">Windows SDK Components for Windows Installer Developers</a>. This sample script merges one Windows Installer database into another database. For more information, see <a href="merges-and-transforms.html">Merges and Transforms</a>.</p>
<p>The <a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea"><strong>MsiDatabaseMerge</strong></a> function and the <a href="database-merge.html"><strong>Merge</strong></a> method of the <a href="database-object.html"><strong>Database</strong></a> object cannot be used to merge a module included in the installation package. They should not be used to merge <a href="merge-modules.html">Merge Modules</a> into a Windows Installer package. To include a merge module in an installation package, authors of installation packages should follow the guidelines that are described in <a href="applying-merge-modules.html">Applying Merge Modules</a> topic.</p>
<p>The sample demonstrates the use of the following:</p>
<ul>
<li><a href="installer-opendatabase.html"><strong>OpenDatabase method (Installer Object)</strong></a></li>
<li><a href="installer-lasterrorrecord.html"><strong>LastErrorRecord method</strong></a> of the <a href="installer-object.html"><strong>Installer object</strong></a></li>
<li><a href="database-openview.html"><strong>OpenView method</strong></a></li>
<li><a href="database-merge.html"><strong>Merge method</strong></a></li>
<li><a href="database-commit.html"><strong>Commit method</strong></a> of the <a href="database-object.html"><strong>Database object</strong></a></li>
<li><a href="view-fetch.html"><strong>Fetch method</strong></a></li>
<li><a href="view-object.html"><strong>View object</strong></a></li>
<li><a href="record-stringdata.html"><strong>StringData property</strong></a> of the <a href="record-object.html"><strong>Record object</strong></a></li>
</ul>
<p>You must have the CScript.exe or WScript.exe version of Windows Script Host to use this sample. To use CScript.exe to run this sample, type a command line at the command prompt using the following syntax. Help is displayed if the first argument is /? or if too few arguments are specified. To redirect the output to a file, end the command line with VBS &gt; [path to file]. The sample returns a value of 0 for success, 1 if help is invoked, and 2 if the script fails.</p>
<p><strong>cscript WiMerge.vbs [path to database][path to imported database][table name]</strong></p>
<p>Specify the path to the Windows Installer database that is receiving the merge. Specify the path to the database being imported into the first. You may specify an optional name for a table to hold the merge errors. If no table name is specified, the installer uses the name _MergeErrors and drops the table after displaying the contents.</p>
<p>For additional scripting examples, see <a href="windows-installer-scripting-examples.html">Windows Installer Scripting Examples</a>. For sample utilities that do not require Windows Script Host, see <a href="windows-installer-development-tools.html">Windows Installer Development Tools</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
