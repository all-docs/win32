<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>FindRelatedProducts Action</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The FindRelatedProducts action runs through each record of the Upgrade table in sequence and compares the upgrade code, product version, and language in each row to products installed on the system.
ms.assetid: 7efcb767-9bdf-43a4-83b8-61b6fc84adf6
title: FindRelatedProducts Action
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>FindRelatedProducts Action</h1>
<p>The FindRelatedProducts action runs through each record of the <a href="upgrade-table.html">Upgrade table</a> in sequence and compares the upgrade code, product version, and language in each row to products installed on the system. When FindRelatedProducts detects a correspondence between the upgrade information and an installed product, it appends the product code to the property specified in the ActionProperty column of the UpgradeTable.</p>
<p>The FindRelatedProducts action only runs the first time the product is installed. The FindRelatedProducts action does not run during maintenance mode or uninstallation.</p>
<h2>Database Tables Queried</h2>
<p>This action queries the following table:</p>
<p><a href="upgrade-table.html">Upgrade Table</a></p>
<h2>Properties Used</h2>
<p>The FindRelatedProducts action uses the <a href="upgradecode.html"><strong>UpgradeCode</strong></a> property and the version and language information authored into the Upgrade table to detect installed products affected by the pending upgrade. It appends the product code of detected products to the property in the ActionProperty column of the UpgradeTable.</p>
<p>FindRelatedProducts only recognizes existing products that have been installed using the Windows Installer with an .msi that defines an <a href="upgradecode.html"><strong>UpgradeCode</strong></a> property, a <a href="productversion.html"><strong>ProductVersion</strong></a> property, and a value for the <a href="productlanguage.html"><strong>ProductLanguage</strong></a> property that is one of the languages listed in the <a href="template-summary.html"><strong>Template Summary</strong></a> Property.</p>
<p>Note that FindRelatedProducts uses the language returned by <a href="/windows/desktop/api/Msi/nf-msi-msigetproductinfoa"><strong>MsiGetProductInfo</strong></a>. For FindRelatedProducts to work correctly, the package author must be sure that the <a href="productlanguage.html"><strong>ProductLanguage</strong></a> property in the <a href="property-table.html">Property table</a> is set to a language that is also listed in the <a href="template-summary.html"><strong>Template Summary</strong></a> Property. See <a href="preparing-an-application-for-future-major-upgrades.html">Preparing an Application for Future Major Upgrades</a>.</p>
<h2>Sequence Restrictions</h2>
<p>FindRelatedProducts should be authored into the <a href="installuisequence-table.html">InstallUISequence table</a> and <a href="installexecutesequence-table.html">InstallExecuteSequence</a> tables. The installer prevents FindRelated Products from running in InstallExecuteSequence if the action has already run in InstallUISequence. The FindRelatedProducts action must come before the <a href="migratefeaturestates-action.html">MigrateFeatureStates action</a> and the <a href="removeexistingproducts-action.html">RemoveExistingProducts action</a>.</p>
<h2>ActionData Messages</h2>
<p>FindRelatedProducts sends an action data message for each related product it detects on the system.</p>
<p>Â </p>
<p>Â </p>
</body>
