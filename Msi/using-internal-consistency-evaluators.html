<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Internal Consistency Evaluators</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: To validate a database, use a special validation tool to merge a .cub file containing the Internal Consistency Evaluators (ICEs) into your database, execute the ICEs, and report the results.
ms.assetid: bdf38673-ee3d-47d8-ad6e-562cd5626918
title: Using Internal Consistency Evaluators
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using Internal Consistency Evaluators</h1>
<p>To validate a database, use a special validation tool to merge a .cub file containing the <a href="internal-consistency-evaluators-ices.html">Internal Consistency Evaluators</a> (ICEs) into your database, execute the ICEs, and report the results. Several such tools are provided in the Microsoft Windows Software Development Kit (SDK). Authoring environments from third-party vendors also may incorporate the ICE validation system into their authoring environment. It is also possible to write your own tool to perform ICE validation. Most ICE validation tools merge the .cub file and your database into a third, temporary database. Windows Installer displays warnings, errors, debugging information, and API errors as it executes each ICE in the .cub file. When the installer finishes executing the ICEs it closes the .msi file, .cub file, and temporary database without saving any changes. The .msi file and .cub file remain unchanged by the validation test.</p>
<p>ICE custom actions communicate to the user by calling <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage"><strong>MsiProcessMessage</strong></a> and posting an INSTALLMESSAGE_USER message. An ICE message commonly returns information such as the following:</p>
<ul>
<li>Name of the ICE that has found an error</li>
<li>Date the ICE was created</li>
<li>Author of the ICE</li>
<li>Date the ICE was last modified.</li>
<li>Description of the API error causing the ICE to fail</li>
<li>Description of the error</li>
<li>A warning to the user</li>
<li>Name of the database table containing the error or warning</li>
<li>Name of the table column containing the error or warning</li>
<li>Primary keys of the table containing the error or warning</li>
<li>A URL to a HTML file giving debugging suggestions</li>
<li>A string that can contain other information</li>
</ul>
<p>Authors of installation packages can write ICE custom actions or use the standard set of ICEs included in the .cub files provided with the SDK. For more information on how to write an ICE, see <a href="building-an-ice.html">Building an ICE</a>.</p>
<p>After writing the appropriate ICEs for validation, a developer must collect the custom actions together into an .msi database, called a .cub file, that contains only the ICEs and their required tables. A .cub file cannot be installed and is used only to store and provide access to ICE custom actions. For more information on making .cub files, see <a href="building-an-ice-database.html">Building an ICE Database</a>. Alternatively, developers can validate their installation package using the existing ICEs described in <a href="ice-reference.html">ICE Reference</a>. These ICEs can be obtained from standard .cub files provided with the SDK.</p>
<p>The installation of the database table editor Orca or the validation tool msival2 provides the Logo.cub, Darice.cub, and Mergemod.cub files. The set of ICEs in the Logo.cub file is a subset of those in the Darice.cub file. If your package passes validation using Darice.cub, it will pass with Logo.cub. Mergemod.cub contains a set of ICEs used to validate merge modules. For more information, see <a href="merge-module-ice-reference.html">Merge Module ICE Reference</a>.</p>
<p><strong>To validate an installation package</strong></p>
<ol>
<li>Obtain or author the appropriate ICE custom actions. You may be able to use one or more of the existing ICEs described in the <a href="ice-reference.html">ICE Reference</a>. If your validation requires an ICE not yet in this list, you can create a new ICE as described in <a href="building-an-ice.html">Building an ICE</a>.</li>
<li>Prepare an ICE Database containing all the ICE custom actions. See the section <a href="building-an-ice-database.html">Building An ICE Database</a> for information about preparing a .cub file.</li>
<li>Provide the .cub file and the .msi file to a package validation tool such as <a href="orca-exe.html">Orca.exe</a> or <a href="msival2-exe.html">Msival2.exe</a>.</li>
</ol>
<p>Note that merge modules should be validated as described in <a href="validating-merge-modules.html">Validating Merge Modules</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
