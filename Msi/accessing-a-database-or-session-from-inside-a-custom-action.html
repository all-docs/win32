<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Accessing a Database or Session from Inside a Custom Action</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: You cannot access an installer session from a custom action that is not the current installation session.
ms.assetid: 8aa0ac17-1341-4399-987e-d26175150874
title: Accessing a Database or Session from Inside a Custom Action
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Accessing a Database or Session from Inside a Custom Action</h1>
<p>You cannot access an installer session from a custom action that is not the current installation session. Custom actions are limited to working with only the active database of the session and no other databases. The following Windows Installer <a href="database-functions.html">Database Functions</a> must not be called from a custom action, because they require a handle to a database that is not the database of the current installation session:</p>
<p><a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea"><strong>MsiDatabaseMerge</strong></a></p>
<p>Â </p>
<p><a href="/windows/desktop/api/Msiquery/nf-msiquery-msicreatetransformsummaryinfoa"><strong>MsiCreateTransformSummaryInfo</strong></a></p>
<p>Â </p>
<p><a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseapplytransforma"><strong>MsiDatabaseApplyTransform</strong></a></p>
<p>Â </p>
<p><a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit"><strong>MsiDatabaseCommit</strong></a></p>
<p>Â </p>
<p><a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta"><strong>MsiDatabaseExport</strong></a></p>
<p>Â </p>
<p><a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabasegeneratetransforma"><strong>MsiDatabaseGenerateTransform</strong></a></p>
<p>Â </p>
<p><a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta"><strong>MsiDatabaseImport</strong></a></p>
<p>Â </p>
<p><a href="/windows/desktop/api/Msiquery/nf-msiquery-msienableuipreview"><strong>MsiEnableUIPreview</strong></a></p>
<p>Â </p>
<p><a href="/windows/desktop/api/Msiquery/nf-msiquery-msigetdatabasestate"><strong>MsiGetDatabaseState</strong></a></p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="accessing-the-current-installer-session-from-inside-a-custom-action.html">Accessing the Current Installer Session from Inside a Custom Action</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
