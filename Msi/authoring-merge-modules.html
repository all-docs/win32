<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Authoring Merge Modules</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The following procedure describes the general steps to authoring merge modules.
ms.assetid: 4b3871c0-f452-4935-9ee3-78b0ac847e67
title: Authoring Merge Modules
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Authoring Merge Modules</h1>
<p>The following procedure describes the general steps to authoring merge modules.</p>
<p><strong>To create a new merge module</strong></p>
<ol>
<li>Obtain a software tool you can use to edit the merge module database.</li>
<li>Obtain a blank merge module database.</li>
<li>Generate a <a href="guid.html">GUID</a> for the merge module. You need to use this GUID when authoring the primary keys of database tables in the merge module.</li>
<li>Add a record to the <a href="component-table.html">Component table</a> for each component delivered by the merge. A Component table is required in every merge module. Note that merge modules operate with components and not with features. In certain cases, however, a database table entry may need to reference a feature. For details, see <a href="referencing-features-in-merge-modules.html">Referencing Features in Merge Modules</a>.</li>
<li>Add a <a href="directory-table.html">Directory table</a> to the merge module that specifies the layout of directories the merge module adds to the target database. A Directory table is required in every merge module.</li>
<li>Import a blank <a href="featurecomponents-table.html">FeatureComponents table</a> into the merge module database. This empty table provides a guideline for the merge tool in cases where the .msi file does not contain its own FeatureComponents table.</li>
<li>Collect all the files delivered by this merge module and create the <a href="mergemodule-cabinet.html">MergeModule.CABinet</a> cabinet file. Add the cabinet to the merge module as a stream inside the .msm file.</li>
<li>Add a record to the File table for every file stored in MergeModule.CABinet.</li>
<li>Add the information necessary to identify the merge module in the <a href="modulesignature-table.html">ModuleSignature table</a>. Every merge module requires a ModuleSignature table.</li>
<li>List the components in the merge module in the <a href="modulecomponents-table.html">ModuleComponents table</a>. Every merge module requires a ModuleComponents table.</li>
<li>Add merge module sequence tables to the .msm file only if the merge module needs to modify the <a href="s-gly.html"><em>sequence tables</em></a> of the target installation database.</li>
<li>Add a _Validation table to the merge module. A merge module requires a _Validation table to pass validation.</li>
<li>Merge modules require a user interface in only rare cases. Including a UI with a merge module is not recommended. In cases where a user interface is required, the UI tables can be merged into the .msi file the same as other tables.</li>
<li>Add registry information to the appropriate registry tables in the merge module database. Add registry information for type libraries, classes, extensions, and verbs into the <a href="typelib-table.html">TypeLib</a>, <a href="class-table.html">Class</a>, <a href="appid-table.html">AppId</a>, <a href="progid-table.html">ProgId</a>, <a href="extension-table.html">Extension</a>, <a href="verb-table.html">Verb</a>, or <a href="mime-table.html">MIME</a> tables. All other registry information can go into the <a href="registry-table.html">Registry table</a>. The use of the SelfReg table is not recommended.</li>
<li>Add the summary information to the <a href="merge-module-summary-information-stream-reference.html">Merge Module Summary Information Stream</a>.</li>
<li>Run validation on all merge modules before attempting to install.</li>
</ol>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="obtaining-blank-merge-module-databases.html">Obtaining Blank Merge Module Databases</a></p>
<!-- raw HTML omitted -->
<p><a href="obtaining-merge-module-authoring-tools.html">Obtaining Merge Module Authoring Tools</a></p>
<!-- raw HTML omitted -->
<p><a href="naming-primary-keys-in-merge-module-databases.html">Naming Primary Keys in Merge Module Databases</a></p>
<!-- raw HTML omitted -->
<p><a href="authoring-merge-module-component-tables.html">Authoring Merge Module Component Tables</a></p>
<!-- raw HTML omitted -->
<p><a href="authoring-merge-module-directory-tables.html">Authoring Merge Module Directory Tables</a></p>
<!-- raw HTML omitted -->
<p><a href="authoring-merge-module-featurecomponents-tables.html">Authoring Merge Module FeatureComponents Tables</a></p>
<!-- raw HTML omitted -->
<p><a href="generating-mergemodule-cabinet-cabinet-files.html">Generating MergeModule.CABinet Cabinet Files</a></p>
<!-- raw HTML omitted -->
<p><a href="authoring-merge-module-file-tables.html">Authoring Merge Module File Tables</a></p>
<!-- raw HTML omitted -->
<p><a href="authoring-modulesignature-tables.html">Authoring ModuleSignature Tables</a></p>
<!-- raw HTML omitted -->
<p><a href="authoring-modulecomponents-tables.html">Authoring ModuleComponents Tables</a></p>
<!-- raw HTML omitted -->
<p><a href="authoring-merge-module-sequence-tables.html">Authoring Merge Module Sequence Tables</a></p>
<!-- raw HTML omitted -->
<p><a href="validating-merge-modules.html">Validating Merge Modules</a></p>
<!-- raw HTML omitted -->
<p><a href="authoring-user-interfaces-in-merge-modules.html">Authoring User Interfaces in Merge Modules</a></p>
<!-- raw HTML omitted -->
<p><a href="authoring-merge-module-registry-tables.html">Authoring Merge Module Registry Tables</a></p>
<!-- raw HTML omitted -->
<p><a href="authoring-merge-module-summary-information-streams.html">Authoring Merge Module Summary Information Streams</a></p>
<!-- raw HTML omitted -->
<p><a href="merge-module-summary-information-stream-reference.html">Merge Module Summary Information Stream Reference</a></p>
<!-- raw HTML omitted -->
<p>Validating Merge Modules</p>
<!-- raw HTML omitted -->
<p><a href="using-64-bit-merge-modules.html">Using 64-bit Merge Modules</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
