<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>_Storages Table</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The _Storages table lists embedded OLE data storages. This is a temporary table, created only when referenced by a SQL statement.
ms.assetid: b2f2907d-6966-4b63-9589-c1580f8db574
title: '_Storages Table'
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>_Storages Table</h1>
<p>The _Storages table lists embedded OLE data storages. This is a temporary table, created only when referenced by a SQL statement.</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Key</th>
<th>Nullable</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td><a href="text.html">Text</a></td>
<td>Y</td>
<td>N</td>
</tr>
<tr>
<td>Data</td>
<td><a href="binary.html">Binary</a></td>
<td>N</td>
<td>Y</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Columns</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Name</p>
<!-- raw HTML omitted -->
<p>A unique key that identifies the storage. The maximum length of Name is 31 characters.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Data</p>
<!-- raw HTML omitted -->
<p>The unformatted binary data.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>To add an OLE storage to a database, create a new record in the _Storages table and enter the name of the storage into the Name column. Use <a href="/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama"><strong>MsiRecordSetStream</strong></a> to copy data into the Data column of this record. Finally, use <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify"><strong>MsiViewModify</strong></a> to insert the record into the _Storages table.</p>
<p>Data cannot be read from the _Storages table. However, the _Storages table can be queried to check for the existence of a specific storage. This means that it is not possible to move an OLE storage from one database to another. You must instead import the original storage file into the new database.To delete an OLE storage, fetch the record containing the binary data, set the Data column in the _Storages table to null, and then update the record. An alternative method is to simply delete the record using either <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify"><strong>MsiViewModify</strong></a> or a plain SQL query.</p>
<p>To rename an OLE storage, update the Name column of the record.</p>
<p>If a hold is placed on this table using SQL (ALTER TABLE <!-- raw HTML omitted --> HOLD) or a column is added with HOLD, the table must be released using FREE. Storages are not written until the table has been released or committed.</p>
<p>Â </p>
<p>Â </p>
</body>
