<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Session.FeatureValidStates property</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The FeatureValidStates property of the Session object returns an integer representing bit flags with each relevant bit representing a valid installation state for the specified feature.
ms.assetid: 8a1f6911-b0a6-4fac-ba77-df4f1b7d15e2
title: Session.FeatureValidStates property
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Session.FeatureValidStates
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Session.FeatureValidStates property</h1>
<p>The <strong>FeatureValidStates</strong> property of the <a href="session-object.html"><strong>Session</strong></a> object returns an integer representing bit flags with each relevant bit representing a valid installation state for the specified feature.</p>
<p>This property is read-only.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>propVal = Session.FeatureValidStates
</code></pre>
<h2>Property value</h2>
<p>Required string name of the feature item whose valid installation states are to be retrieved.</p>
<h2>Remarks</h2>
<p>The return value is composed of bit flags as follows. Bit 0: if set, Local is a valid state. Bit 1: if set, Source is a valid state.</p>
<p>The <strong>FeatureValidStates</strong> property only succeeds after the installer has called the <a href="costinitialize-action.html">CostInitialize</a> and <a href="costfinalize-action.html">CostFinalize</a> actions.</p>
<p><strong>FeatureValidStates</strong> determines state validity by querying all components that are linked to the specified feature without taking into account the current installed state of any component.</p>
<p>The possible valid states for a feature are determined as follows:</p>
<ul>
<li>If the feature does not contain components, both INSTALLSTATE_LOCAL and INSTALLSTATE_SOURCE are valid states for the feature.</li>
<li>If at least one component of the feature has an attribute of msidbComponentAttributesLocalOnly or msidbComponentAttributesOptional, INSTALLSTATE_LOCAL is a valid state for the feature.</li>
<li>If at least one component of the feature has an attribute of msidbComponentAttributesSourceOnly or msidbComponentAttributesOptional, INSTALLSTATE_SOURCE is a valid state for the feature.</li>
<li>If a file of a component belonging to the feature is patched or from a compressed source, then INSTALLSTATE_SOURCE is not included as a valid state for the feature.</li>
<li>INSTALLSTATE_ADVERTISE is not a valid state if the feature disallows advertisement (msidbFeatureAttributesDisallowAdvertise) or the feature requires platform support for advertisement (msidbFeatureAttributesNoUnsupportedAdvertise) and the platform does not support it.</li>
<li>INSTALLSTATE_ABSENT is a valid state for the feature if its attributes do not include msidbFeatureAttributesUIDisallowAbsent.</li>
<li>Valid states for child features marked to follow the parent feature (msidbFeatureAttributesFollowParent) are based upon the parent feature's action or installed state.</li>
</ul>
<p>If the property fails, you can obtain extended error information by using the <a href="installer-lasterrorrecord.html"><strong>LastErrorRecord</strong></a> method.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer on Windows ServerÂ 2003 or WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_ISession is defined as 000C109E-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
