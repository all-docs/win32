<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MsiConfigureServices Action</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The MsiConfigureServices action configures a service for the system. This action queries the MsiServiceConfig and the MsiServiceConfigFailureActions tables.
ms.assetid: 63bd4690-0649-4e23-a8cd-527b3c517dae
title: MsiConfigureServices Action
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>MsiConfigureServices Action</h1>
<p>The MsiConfigureServices action configures a service for the system. This action queries the <a href="msiserviceconfig-table.html">MsiServiceConfig</a> and the <a href="msiserviceconfigfailureactions-table.html">MsiServiceConfigFailureActions</a> tables.</p>
<p><strong><a href="not-supported-in-windows-installer-4-5.html">Windows Installer 4.5 or earlier</a>:</strong> Not supported. This action is available beginning with Windows Installer 5.0.</p>
<blockquote>
<p>[!IMPORTANT]</p>
<p>Windows Services provides the ability to automatically perform predefined actions in response to a failure in a service. To support programmatically setting up these <strong>Recovery Actions</strong> when a service fails, <a href="msiserviceconfigfailureactions-table.html">MsiServiceConfigFailureActions</a> was added to MSI in version MSI 5.0. However, this functionality is not working as expected.</p>
<p>To workaround this issue, an application developer should use the <strong>Custom Action</strong> functionality in MSI to run <strong>sc.exe</strong> and set the <strong>Recovery Options</strong> appropriately.</p>
</blockquote>
<p>Â </p>
<h2>Sequence Restrictions</h2>
<p>This standard action must be used in the following sequence.</p>
<p><a href="stopservices-action.html">StopServices</a></p>
<p><a href="deleteservices-action.html">DeleteServices</a></p>
<p>Any of the following actions: <a href="installfiles-action.html">InstallFiles</a>, <a href="removefiles-action.html">RemoveFiles</a>, <a href="duplicatefiles-action.html">DuplicateFiles</a>, <a href="movefiles-action.html">MoveFiles</a>, <a href="patchfiles-action.html">PatchFiles</a>, and <a href="removeduplicatefiles-action.html">RemoveDuplicateFiles</a> actions.</p>
<p><a href="installservices-action.html">InstallServices</a></p>
<p>MsiConfigureServices</p>
<p><a href="startservices-action.html">StartServices</a></p>
<h2>ActionData Messages</h2>
<p>There are no ActionData messages.</p>
<h2>Remarks</h2>
<p>This action requires that the user be an administrator or have elevated privileges with permission to install services or that the application be part of a managed installation.</p>
<p>Â </p>
<p>Â </p>
</body>
