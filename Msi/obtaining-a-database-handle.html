<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Obtaining a Database Handle</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Before working with a database you must first obtain a handle to it.
ms.assetid: 53cf73bc-4d52-471c-8384-46d106a36e38
title: Obtaining a Database Handle
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Obtaining a Database Handle</h1>
<p>Before working with a database you must first obtain a handle to it.</p>
<p><strong>To access information about an installer database</strong></p>
<ol>
<li>Obtain a handle to the database in one of two ways:
<ul>
<li>If an installation is in progress, get a handle to the active database by calling the <a href="/windows/desktop/api/Msiquery/nf-msiquery-msigetactivedatabase"><strong>MsiGetActiveDatabase</strong></a> function.</li>
<li>If an installation is not in progress, open any specified database by calling the <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiopendatabasea"><strong>MsiOpenDatabase</strong></a> function.</li>
</ul>
</li>
<li>After the database has been opened, you can call functions to obtain information about the database or to manipulate the database.
<ul>
<li>Create a <strong>View</strong> object and specify a SQL query of the open database by calling the <a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa"><strong>MsiDatabaseOpenView</strong></a> function.</li>
<li>Obtain a record that contains all primary keys of a specified table in the open database by calling the <a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabasegetprimarykeysa"><strong>MsiDatabaseGetPrimaryKeys</strong></a> function.</li>
<li>Check the current state of an open database by calling the <a href="/windows/desktop/api/Msiquery/nf-msiquery-msigetdatabasestate"><strong>MsiGetDatabaseState</strong></a> function. With the <strong>MsiGetDatabaseState</strong> function, you can determine the read/write status for a database or if the handle is valid.</li>
</ul>
</li>
</ol>
<p>Â </p>
<p>Â </p>
</body>
