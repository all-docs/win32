<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Session.EvaluateCondition method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The EvaluateCondition method of the Session object evaluates a logical expression that contains symbols and values. This method uses the MsiEvaluateCondition function.
ms.assetid: 629f7efd-80fe-4a0e-95cc-b62d6258ae0a
title: Session.EvaluateCondition method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Session.EvaluateCondition
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Session.EvaluateCondition method</h1>
<p>The <strong>EvaluateCondition</strong> method of the <a href="session-object.html"><strong>Session</strong></a> object evaluates a logical expression that contains symbols and values. This method uses the <a href="/windows/desktop/api/Msiquery/nf-msiquery-msievaluateconditiona"><strong>MsiEvaluateCondition</strong></a> function.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>Session.EvaluateCondition(
  condition
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>condition</em></p>
<!-- raw HTML omitted -->
<p>Required string that contains the logical expression. For more information, see <a href="conditional-statement-syntax.html">Conditional Statement Syntax</a>.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method returns an integer that indicates the evaluation of the condition.</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>msiEvaluateConditionFalse</td>
<td>0</td>
<td>The condition evaluates to false.</td>
</tr>
<tr>
<td>msiEvaluateConditionTrue</td>
<td>1</td>
<td>The condition evaluates to true.</td>
</tr>
<tr>
<td>msiEvaluateConditionNone</td>
<td>2</td>
<td>A conditional expression is not provided.</td>
</tr>
<tr>
<td>msiEvaluateConditionError</td>
<td>3</td>
<td>The condition contains a syntax error.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>Conditional expressions can be used to compare feature and component states. The following table shows the feature and component states that the EvaluateCondition method uses.</p>
<table>
<thead>
<tr>
<th>State</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Null</td>
<td>Null</td>
<td>No action taken on feature or component.</td>
</tr>
<tr>
<td>msiInstallStateAbsent</td>
<td>2</td>
<td>Feature or component is not present.</td>
</tr>
<tr>
<td>msiInstallStateLocal</td>
<td>3</td>
<td>Feature or component is installed on the local computer.</td>
</tr>
<tr>
<td>msiInstallStateSource</td>
<td>4</td>
<td>Feature or component is installed to run from source.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<blockquote>
<p>[!Note]<br />
The states are not set until the <a href="session-setinstalllevel.html"><strong>SetInstallLevel</strong></a> method is called, either directly or by the <a href="costfinalize-action.html">CostFinalize Action</a>. Therefore, state checking is only useful in conditional expression in an action sequence table.</p>
</blockquote>
<p>Â </p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer on Windows ServerÂ 2003 or WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_ISession is defined as 000C109E-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="conditional-statement-syntax.html">Conditional Statement Syntax</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
