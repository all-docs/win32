<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Manage Substorages</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The VBScript file WiSubStg.vbs is provided in the Windows SDK Components for Windows Installer Developers.
ms.assetid: a0248dfb-e406-4ce6-ab11-1e428aa67af4
title: Manage Substorages
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Manage Substorages</h1>
<p>The VBScript file WiSubStg.vbs is provided in the <a href="platform-sdk-components-for-windows-installer-developers.html">Windows SDK Components for Windows Installer Developers</a>. This sample shows how script can be used to manage substorages in a Windows Installer database. A transform can be added to an existing Windows Installer database as a substorage.</p>
<p>The sample demonstrates the use of:</p>
<ul>
<li><a href="-storages-table.html">_Storages table</a></li>
<li><a href="installer-opendatabase.html"><strong>OpenDatabase method (Installer Object)</strong></a></li>
<li><a href="installer-createrecord.html"><strong>CreateRecord method</strong></a></li>
<li><a href="installer-lasterrorrecord.html"><strong>LastErrorRecord method</strong></a> of the <a href="installer-object.html"><strong>Installer object</strong></a></li>
<li><a href="database-openview.html"><strong>OpenView method</strong></a></li>
<li><a href="database-commit.html"><strong>Commit method</strong></a> of the <a href="database-object.html"><strong>Database object</strong></a></li>
<li><a href="view-fetch.html"><strong>Fetch method</strong></a></li>
<li><a href="view-modify.html"><strong>Modify method</strong></a></li>
<li><a href="view-execute.html"><strong>Execute method</strong></a> of the <a href="view-object.html"><strong>View object</strong></a></li>
<li><a href="record-stringdata.html"><strong>StringData property</strong></a></li>
<li><a href="record-setstream.html"><strong>SetStream method</strong></a> of the <a href="record-object.html"><strong>Record object</strong></a></li>
</ul>
<p>You'll require the CScript.exe or WScript.exe version of Windows Script Host to use this sample. To use CScript.exe to run this sample, type a command line at the command prompt using the following syntax. Help is displayed if the first argument is /? or if too few arguments are specified. To redirect the output to a file, end the command line with VBS &gt; [<em>path to file</em>]. The sample returns a value of 0 for success, 1 if help is invoked, and 2 if the script fails.</p>
<p><strong>cscript WiSubStg.vbs [path to database][path to file][options][substorage name]</strong></p>
<p>Specify the path to the Windows Installer database to add or remove substorage. Specify a path to the transform or database file that is being added as substorage. To list the substorages in the Windows Installer database, omit the path to this file. You may specify an optional substorage name, if this is omitted the substorage name defaults to the file name.</p>
<p>The following option may be specified.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>no option specified</td>
<td>Add a substorage to the Windows Installer database.</td>
</tr>
<tr>
<td>/d</td>
<td>Remove a substorage. This option flag must be followed by the name of the substorage to be removed.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>For additional scripting examples, see <a href="windows-installer-scripting-examples.html">Windows Installer Scripting Examples</a>. For sample utilities that do not require Windows Script Host, see <a href="windows-installer-development-tools.html">Windows Installer Development Tools</a>.</p>
<p>Note that <a href="a-localization-example.html">A Localization Example</a> demonstrates <a href="embedding-customization-transforms-as-substorage.html">Embedding Customization Transforms as Substorage</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
