<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using an UpgradeCode</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The UpgradeCode is primarily used for supporting major upgrades, although small and minor upgrade patches may use the UpgradeCode for product validation.
ms.assetid: de62bb80-56a0-4652-9509-5d36ed171c69
title: Using an UpgradeCode
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using an UpgradeCode</h1>
<p>The <a href="upgradecode.html"><strong>UpgradeCode</strong></a> is primarily used for supporting major upgrades, although small and minor upgrade patches may use the <strong>UpgradeCode</strong> for product validation. During major upgrades, the <a href="findrelatedproducts-action.html">FindRelatedProducts</a>, <a href="migratefeaturestates-action.html">MigrateFeatureStates</a>, and <a href="removeexistingproducts-action.html">RemoveExistingProducts</a> actions detect, migrate, and remove previous versions of the product. The FindRelatedProducts action searches for products using criteria based upon the <strong>UpgradeCode</strong>, <a href="productlanguage.html"><strong>ProductLanguage</strong></a>, and <a href="productversion.html"><strong>ProductVersion</strong></a>. These criteria are specified in the <a href="upgrade-table.html">Upgrade</a> table.</p>
<p>Given the criteria used by the <a href="findrelatedproducts-action.html">FindRelatedProducts</a> action, the <a href="upgradecode.html"><strong>UpgradeCode</strong></a> can be the same for different languages and versions of a single product. This is because the <a href="upgrade-table.html">Upgrade</a> table allows for differentiating between products along version and language lines.</p>
<p>Across different versions of the same product, you may never need to change the <a href="upgradecode.html"><strong>UpgradeCode</strong></a>. Each stand-alone product should have its own <strong>UpgradeCode</strong>. A product suite should also have its own <strong>UpgradeCode</strong>. Doing so will allow the suite to upgrade previous versions of the suite or stand-alone products by using multiple rows in the <a href="upgrade-table.html">Upgrade table</a>.</p>
<p>The following two scenarios illustrate the use of the <a href="upgradecode.html"><strong>UpgradeCode</strong></a>.</p>
<ul>
<li>Product A and Product B were shipped with the same <a href="productlanguage.html"><strong>ProductLanguage</strong></a>, <a href="productversion.html"><strong>ProductVersion</strong></a>, and <a href="upgradecode.html"><strong>UpgradeCode</strong></a>. Product A and Product B have different <a href="productcode.html"><strong>ProductCodes</strong></a>. Because the products were assigned the same <strong>UpgradeCode</strong>, the <a href="upgrade-table.html">Upgrade</a> table cannot be authored to differentiate the older version of Product A from the older version of Product B. In this case, you will be unable to have an upgrade installation of Product A that ignores Product B. Because these were different products, they should have each been assigned a different <strong>UpgradeCode</strong>.</li>
<li>The English and French versions of Product A were shipped with the same <a href="productversion.html"><strong>ProductVersion</strong></a> and <a href="upgradecode.html"><strong>UpgradeCode</strong></a>. Both the English and French versions of Product A have different <a href="productlanguage.html"><strong>ProductLanguages</strong></a> and <a href="productcode.html"><strong>ProductCodes</strong></a>. Even though both the English and French language versions share the same <strong>UpgradeCode</strong>, it is possible to author the <a href="upgrade-table.html">Upgrade</a> table such that only the older English language version will be detected and upgraded and the older French version ignored. Different language versions of a product can use the same <strong>UpgradeCode</strong>.</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
