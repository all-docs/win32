<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ICE68</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: ICE68 checks that all custom action types needed for an installation are valid.
ms.assetid: a37d6d6c-3005-425b-883a-6fe074b9d708
title: ICE68
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>ICE68</h1>
<p>ICE68 checks that all custom action types needed for an installation are valid. Failure to fix the error reported by ICE68 causes an installation that attempts to execute the action to fail. ICE68 issues a warning if the <strong>msidbCustomActionTypeNoImpersonate</strong> attribute is set without also setting the <strong>msidbCustomActionTypeInScript</strong> attribute.</p>
<h2>Result</h2>
<p>ICE68 returns an error if an action type needed for an installation is invalid.</p>
<h2>Example</h2>
<p>ICE68 posts the following warning if a custom action has the <strong>msidbCustomActionTypeNoImpersonate</strong> bit set in the Type field of the CustomAction table without the <strong>msidbCustomActionTypeInScript</strong> also set.</p>
<pre lang="syntax"><code>Even though custom action '[2]' is marked to be elevated (with 
attribute msidbCustomActionTypeNoImpersonate), it will not be run with elevated 
privileges because it's not deferred (with attribute msidbCustomActionTypeInScript).
</code></pre>
<p>To fix this warning, include <strong>msidbCustomActionTypeInScript</strong> (0x400) if the custom action includes <strong>msidbCustomActionTypeNoImpersonate</strong> (0x800). Otherwise the installer ignores the <strong>msidbCustomActionTypeNoImpersonate</strong> attribute. For more information, see <a href="custom-action-in-script-execution-options.html">Custom Action In-Script Execution Options</a>.</p>
<p>ICE68 reports the following error for the example shown:</p>
<pre lang="syntax"><code>Invalid custom action type for action 'Action1'.
</code></pre>
<p>1027 is not a valid action type.</p>
<p>To fix this error, choose a valid custom action type.</p>
<p><a href="customaction-table.html">CustomAction Table</a> (partial)</p>
<table>
<thead>
<tr>
<th>Action</th>
<th>Type</th>
<th>Source</th>
<th>Target</th>
</tr>
</thead>
<tbody>
<tr>
<td>Action1</td>
<td>1027</td>
<td>Argument</td>
<td>Component1</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="ice-reference.html">ICE Reference</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
