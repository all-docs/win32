<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Session.Message method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The Message method of the Session object performs any enabled logging operations and defers execution to the UI handler object associated with the engine. Logging may be selectively enabled for the various message types. See the EnableLog method.
ms.assetid: 09053700-a641-4970-bf55-d7c81f345257
title: Session.Message method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Session.Message
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Session.Message method</h1>
<p>The <strong>Message</strong> method of the <a href="session-object.html"><strong>Session</strong></a> object performs any enabled logging operations and defers execution to the UI handler object associated with the engine. Logging may be selectively enabled for the various message types. See the <a href="installer-enablelog.html"><strong>EnableLog</strong></a> method.</p>
<p>If record field 0 contains a formatting string, it is used to format the data in the other fields. Else if the message is an error, warning, or user message, an attempt is made to find a message template in the Error table for the current database using the error number found in field 1 of the record for message types and return values.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>Session.Message(
  kind,
  record
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>kind</em></p>
<!-- raw HTML omitted -->
<p>The <em>kind</em> parameter is required to be one of the following values. To display a message box with push buttons and icons, calculate the value of <em>kind</em> by adding the standard message box styles used by <a href="/windows/win32/api/winuser/nf-winuser-messagebox"><strong>MessageBox</strong></a> and <a href="/windows/win32/api/winuser/nf-winuser-messageboxexa"><strong>MessageBoxEx</strong></a> to <strong>msiMessageTypeError</strong>, <strong>msiMessageTypeWarning</strong>, or <strong>msiMessageTypeUser</strong>. For more information see the Remarks section below.</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageTypeFatalExit</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&amp;H00000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Premature termination, possibly fatal out of memory.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageTypeError</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&amp;H01000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Formatted error message, [1] is message number in <a href="error-table.html">Error table</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageTypeWarning</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&amp;H02000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Formatted warning message, [1] is message number in <a href="error-table.html">Error table</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageTypeUser</strong> <!-- raw HTML omitted --> <!-- raw HTML omitted -->&amp;H03000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>User request message, [1] is message number in <a href="error-table.html">Error table</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageTypeInfo</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&amp;H04000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Informative message for log, not to be displayed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageTypeFilesInUse</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&amp;H05000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>List of files in use that need to be replaced.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageTypeResolveSource</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&amp;H06000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Request to determine a valid source location.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageTypeOutOfDiskSpace</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&amp;H07000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Insufficient disk space message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageTypeActionStart</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&amp;H08000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Start of action, [1] action name, [2] description, [3] template for ACTIONDATA messages.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageTypeActionData</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&amp;H09000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Action data. Record fields correspond to the template of ACTIONSTART message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageTypeProgress</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&amp;H0A000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Progress bar information. See the description of record fields below.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageTypeCommonData</strong> <!-- raw HTML omitted --> <!-- raw HTML omitted -->&amp;H0B000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>To enable the Cancel button set [1] to 2 and [2] to 1. <!-- raw HTML omitted --> To disable the Cancel button set [1] to 2 and [2] to 0<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>record</em></p>
<!-- raw HTML omitted -->
<p>Required <a href="record-object.html"><strong>Record</strong></a> object containing a message-specific field.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageStatusError</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>-1<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageStatusNone</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>0<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageStatusOk</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>1<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageStatusCancel</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageStatusAbort</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>3<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageStatusRetry</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>4<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageStatusIgnore</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>5<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageStatusYes</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>6<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiMessageStatusNo</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>7<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p><strong>Message Record Fields</strong></p>
<p>The following describes the record field definitions when msiMessageTypeProgress is passed as the message type.</p>
<p>Field 1 specifies the type of the progress message. The meaning of the other fields depend upon the value in this field. The possible values that can be set into Field 1 are as follows.</p>
<table>
<thead>
<tr>
<th>Message name</th>
<th>Value</th>
<th>Field 1 description</th>
</tr>
</thead>
<tbody>
<tr>
<td>MasterReset</td>
<td>0</td>
<td>Resets progress bar and sets the expected total number of ticks in the bar.</td>
</tr>
<tr>
<td>ActionInfo</td>
<td>1</td>
<td>Provides information related to progress messages to be sent by the current action.</td>
</tr>
<tr>
<td>ProgressReport</td>
<td>2</td>
<td>Increments the progress bar.</td>
</tr>
<tr>
<td>ProgressAddition</td>
<td>3</td>
<td>Enables an action (such as CustomAction) to add ticks to the expected total number of progress of the progress bar.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The meaning of Field 2 depends upon the value in Field 1 as follows.</p>
<table>
<thead>
<tr>
<th>Field 1 value</th>
<th>Field 2 description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Expected total number of ticks in the progress bar.</td>
</tr>
<tr>
<td>1</td>
<td>Number of ticks the progress bar moves for each ActionData message. This field is ignored if Field 3 is 0.</td>
</tr>
<tr>
<td>2</td>
<td>Number of ticks the progress bar has moved.</td>
</tr>
<tr>
<td>3</td>
<td>Number of ticks to add to total expected progress.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The meaning of Field 3 depends upon the value in Field 1 as follows.</p>
<table>
<thead>
<tr>
<th>Field 1 value</th>
<th>Field 3 value</th>
<th>Field 3 description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>Forward progress bar (left to right)</td>
</tr>
<tr>
<td>Â </td>
<td>1</td>
<td>Backward progress bar (right to left)</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>The current action will send explicit ProgressReport messages.</td>
</tr>
<tr>
<td>Â </td>
<td>1</td>
<td>Increment the progress bar by the number of ticks specified in Field 2 each time an ActionData message is sent.</td>
</tr>
<tr>
<td>2</td>
<td>Unused</td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>Unused</td>
<td></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The meaning of Field 4 depends upon the value in Field 1 as follows.</p>
<table>
<thead>
<tr>
<th>Field 1 value</th>
<th>Field 4 value</th>
<th>Field 4 description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>Execution is in progress. In this case, the UI could calculate and display the time remaining.</td>
</tr>
<tr>
<td>Â </td>
<td>1</td>
<td>Creating the execution script. In this case, the UI could display a message to please wait while the installer finishes preparing the installation.</td>
</tr>
<tr>
<td>1</td>
<td>Unused</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>Unused</td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>Unused</td>
<td></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p><strong>Displaying Message Boxes</strong></p>
<p>To display a message box with push buttons and icons, calculate the value of <em>kind</em> by adding the standard message box styles used by <strong>MessageBox</strong> and <strong>MessageBoxEx</strong> to <strong>msiMessageTypeError</strong>, <strong>msiMessageTypeWarning</strong>, or <strong>msiTypeUser</strong>. The available push button options for VBScript are vbOKOnly (MB_OK), vbOKCancel (MB_OKCANCEL), vbAbortRetryIgnore (MB_ABORTRETRYIGNORE), vbYesNoCancel (MB_YESNOCANCEL), vbYesNo (MB_YESNO), and vbRetryCancel (MB_RETRYCANCEL). The available icon options for VBScript are vbCritical (MB_ICONERROR), vbQuestion (MB_ICONQUESTION), vbExclamation (MB_ICONWARNING), and vbInformation (MB_ICONINFORMATION).</p>
<p>For example, the following call sends a <strong>msiMessageTypeError</strong> message with the vbExclamation icon and vbYesNo buttons.</p>
<pre lang="VB"><code>Session.Message &amp;H01000034, record
</code></pre>
<p>If a custom action calls the <strong>Message</strong> method, the custom action should be capable of handling a cancellation by the user and should return <strong>msiDoActionStatusUserExit</strong>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer on Windows ServerÂ 2003 or WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_ISession is defined as 000C109E-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
