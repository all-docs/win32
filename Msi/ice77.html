<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ICE77</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: ICE77 verifies that custom actions with the msidbCustomActionTypeInScript bit set are sequenced after the InstallInitialize action and before the InstallFinalize action.
ms.assetid: 291cf731-b7e6-44c2-a8ec-78e0e037d1f5
title: ICE77
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>ICE77</h1>
<p>ICE77 verifies that custom actions with the <strong>msidbCustomActionTypeInScript</strong> bit set are sequenced after the <a href="installinitialize-action.html">InstallInitialize action</a> and before the <a href="installfinalize-action.html">InstallFinalize action</a>. ICE77 checks the sequence in the <a href="installexecutesequence-table.html">InstallExecuteSequence table</a> and <a href="adminexecutesequence-table.html">AdminExecuteSequence table</a>.</p>
<h2>Result</h2>
<p>ICE77 posts an error if an in-script custom action is sequenced before the InstallInitialize action or after the InstallFinalize action.</p>
<p>ICE77 posts an error if the InstallInitialize action or the InstallFinalize action is missing.</p>
<h2>Example</h2>
<p>ICE77 reports the following errors for the example:</p>
<pre lang="syntax"><code>InstallFinalize is missing from 'InstallExecuteSequence'. 
CA_InScriptInstall is a in-script custom action. It must be sequenced 
before the InstallFinalize action.
 
CA_InScriptAdmin is a in-script custom action.  It must be sequenced 
in between the InstallInitialize action and the InstallFinalize action 
in the AdminExecuteSequence Sequence table.
</code></pre>
<p><a href="customaction-table.html">CustomAction Table</a> (partial)</p>
<table>
<thead>
<tr>
<th>Action</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>CA_InScriptInstall</td>
<td>1025</td>
</tr>
<tr>
<td>CA_InScriptAdmin</td>
<td>1026</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p><a href="installexecutesequence-table.html">InstallExecuteSequence Table</a> (partial)</p>
<table>
<thead>
<tr>
<th>Action</th>
<th>Sequence</th>
</tr>
</thead>
<tbody>
<tr>
<td>CA_InScriptInstall</td>
<td>2000</td>
</tr>
<tr>
<td>InstallInitialize</td>
<td>1500</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p><a href="adminexecutesequence-table.html">AdminExecuteSequence Table</a> (partial)</p>
<table>
<thead>
<tr>
<th>Action</th>
<th>Sequence</th>
</tr>
</thead>
<tbody>
<tr>
<td>CA_InScriptAdmin</td>
<td>1400</td>
</tr>
<tr>
<td>InstallInitialize</td>
<td>1500</td>
</tr>
<tr>
<td>InstallFinalize</td>
<td>6600</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>To fix the errors, sequence the in-script custom actions after the InstallInitialize action and before the InstallFinalize action. The InstallInitialize and InstallFinalize actions must be present in the InstallExecuteSequence table and the AdminExecuteSequence table.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="ice-reference.html">ICE Reference</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
