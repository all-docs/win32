<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>REINSTALLMODE property</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The REINSTALLMODE property is a string that contains letters specifying the type of reinstall to perform.
ms.assetid: 756d2899-2cfe-473a-bebf-a7f7bbe7d229
title: REINSTALLMODE property
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>REINSTALLMODE property</h1>
<p>The <strong>REINSTALLMODE</strong> property is a string that contains letters specifying the type of reinstall to perform. Options are case-insensitive and order-independent. This property should normally always be used in conjunction with the <a href="reinstall.html"><strong>REINSTALL</strong></a> property. However, this property can also be used during installation, not just reinstall.</p>
<blockquote>
<p>[!Note]<br />
The Windows Installer ignores the <strong>REINSTALLMODE</strong> property during an <a href="administrative-installation.html">administrative installation</a>.</p>
</blockquote>
<p>Â </p>
<h2>Reinstall Option Codes</h2>
<p>By default the <strong>REINSTALLMODE</strong> is &quot;omus&quot;.</p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Option</th>
</tr>
</thead>
<tbody>
<tr>
<td>p</td>
<td>Reinstall only if the file is missing.</td>
</tr>
<tr>
<td>o</td>
<td>Reinstall if the file is missing or is an older version.</td>
</tr>
<tr>
<td>e</td>
<td>Reinstall if the file is missing, or is an equal or older version.</td>
</tr>
<tr>
<td>d</td>
<td>Reinstall if the file is missing or a different version is present.</td>
</tr>
<tr>
<td>c</td>
<td>Verify the checksum values, and reinstall the file if they are missing or corrupt. This flag only repairs files that have msidbFileAttributesChecksum in the Attributes column of the <a href="file-table.html">File Table</a>.</td>
</tr>
<tr>
<td>a</td>
<td>Force all files to be reinstalled, regardless of checksum or version.</td>
</tr>
<tr>
<td>u</td>
<td>Rewrite all required registry entries from the <a href="registry-table.html">Registry Table</a> that go to the<strong>HKEY_CURRENT_USER</strong><!-- raw HTML omitted --> or <strong>HKEY_USERS</strong><!-- raw HTML omitted --> registry hive.</td>
</tr>
<tr>
<td>m</td>
<td>Rewrite all required registry entries from the <a href="registry-table.html">Registry Table</a> that go to the <strong>HKEY_LOCAL_MACHINE</strong><!-- raw HTML omitted --> or <strong>HKEY_CLASSES_ROOT</strong><!-- raw HTML omitted --> registry hive. Rewrite all information from the <a href="class-table.html">Class Table</a>, <a href="verb-table.html">Verb Table</a>, <a href="publishcomponent-table.html">PublishComponent Table</a>, <a href="progid-table.html">ProgID Table</a>, <a href="mime-table.html">MIME Table</a>, <a href="icon-table.html">Icon Table</a>, <a href="extension-table.html">Extension Table</a>, and <a href="appid-table.html">AppID Table</a> regardless of machine or user assignment. Reinstall all <a href="/windows/desktop/api/Msi/nf-msi-msiprovidequalifiedcomponenta"><strong>qualified components.</strong></a>When reinstalling an application, this option runs the <a href="registertypelibraries-action.html">RegisterTypeLibraries</a> and <a href="installodbc-action.html">InstallODBC</a> actions.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>s</td>
<td>Reinstall all shortcuts and re-cache all icons overwriting any existing shortcuts and icons.</td>
</tr>
<tr>
<td>v</td>
<td>Use to run from the source package and re-cache the local package. Do not use the v reinstall option code for the first installation of an application or feature.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>If the <strong>REINSTALLMODE</strong> property is defined without also defining the <a href="reinstall.html"><strong>REINSTALL</strong></a> property, then the specified &quot;detection&quot; modes still apply and specify the &quot;overwrite&quot; mode for a normal installation. The <strong>REINSTALLMODE</strong> property only affects those features that are selected normally for installation. The presence of the <strong>REINSTALLMODE</strong> property does not reinstall features. The reinstallation of features requires the presence of the <strong>REINSTALL</strong> property.</p>
<p>The option codes for this property correspond to the <a href="command-line-options.html">command-line option</a> '/f'. The command-line option has a default value of 'pecms'.</p>
<blockquote>
<p>[!Note]<br />
Only those files containing checksum information are ever verified and repaired. The REINSTALLMODE_FILEVERIFY flag (the ccode above) only repairs files that have msidbFileAttributesChecksum in the Attributes column of the <a href="file-table.html">File Table</a>.</p>
</blockquote>
<p>Starting with Windows 11 version 24H2, on ARM64 devices, for files that are recognized by the OS as known redistributable files, if the install destination is anything under C:\Windows, then the behavior specified in the flags will be altered to only overwrite older files, the same behavior as if option â€œoâ€ was specified. All other files in the package remain as they were and honor the flags. The current list of known redistributable files to which this new behavior applies includes MS Visual C/C++ runtimes, MFC, C++ AMP, and C++ OpenMP. The behavior for devices other than ARM64 remains unchanged.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer on Windows ServerÂ 2003 or WindowsÂ XP. See the <a href="windows-installer-portal.html">Windows Installer Run-Time Requirements</a> for information about the minimum Windows service pack that is required by a Windows Installer version.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="properties.html">Properties</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
