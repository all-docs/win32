<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Removing Stranded Files</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: A list of possible reasons why a Windows Installer uninstallation was unable to remove all the files of an application.
ms.assetid: 0a856f0f-a829-478e-a83b-dade7b05b4f2
title: Removing Stranded Files
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Removing Stranded Files</h1>
<p>If a file that should have been removed from the user's computer remains installed after running an uninstall, the installer may not be removing the component containing the file for one or more of the following reasons:</p>
<ul>
<li>
<p>The msidbComponentAttributesPermanent bit was set for the component in the Attributes column of the <a href="component-table.html">Component table</a>.</p>
</li>
<li>
<p>No value was entered for the component in the ComponentId column of the Component table.</p>
</li>
<li>
<p>The component is used by another application or feature that is still installed.</p>
</li>
<li>
<p>There is a condition specified in the <a href="condition-table.html">Condition</a> table that enables a feature during installation and disables the feature during uninstallation.</p>
</li>
<li>
<p>The key file for the component has a previous reference count under <strong>HKLM</strong>\<strong>Software</strong>\<strong>Microsoft</strong>\<strong>Windows</strong>\<strong>CurrentVersion</strong>\<strong>SharedDLLs</strong>.</p>
</li>
<li>
<p>The component is installed in the System folder and any file in the component has a previous reference count under <strong>HKLM</strong>\<strong>Software</strong>\<strong>Microsoft</strong>\<strong>Windows</strong>\<strong>CurrentVersion</strong>\<strong>SharedDLLs</strong>.</p>
</li>
<li>
<p>The Windows Installer does not remove any files or registry keys that are protected by <a href="../wfp/windows-resource-protection-portal.html">Windows Resource Protection</a> (WRP). For more information, see <a href="windows-resource-protection-on-windows-vista.html">Using Windows Installer and Windows Resource Protection</a>. On Windows ServerÂ 2003, WindowsÂ XP, and WindowsÂ 2000, the installer does not remove any files that are protected by Windows File Protection (WFP). If a component's key path file or registry key is protected by WFP or WRP, the installer does not remove the component.</p>
<blockquote>
<p>[!Note]<br />
Because Windows Installer does not install, update, or remove any resource that is protected by WRP, you should not include protected resources in an installation package. Instead, use only the <a href="../wfp/supported-file-replacement-mechanisms.html">supported resource replacement mechanisms</a> described in the <a href="../wfp/windows-resource-protection-portal.html">Windows Resource Protection</a> section.</p>
</blockquote>
<p>Â </p>
</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
