<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ICE57</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: ICE57 validates that individual components do not mix per-machine and per-user data. This ICE custom action checks registry entries, files, directory key paths, and non-advertised shortcuts.
ms.assetid: 3c82efa7-9cf3-4bcd-8ec4-b81d1d7aa0a6
title: ICE57
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>ICE57</h1>
<p>ICE57 validates that individual components do not mix per-machine and per-user data. This ICE custom action checks registry entries, files, directory key paths, and non-advertised shortcuts.</p>
<p>Mixing per-user and per-machine data in the same component could result in only partial installation of the component for some users in a multi-user environment.</p>
<p>See the <a href="allusers.html"><strong>ALLUSERS</strong></a> property.</p>
<h2>Result</h2>
<p>ICE57 posts an error if it finds any component that contains both a per-machine and per-user registry entries, files, directory key paths, or non-advertised shortcuts.</p>
<h2>Example</h2>
<p>ICE57reports the following errors for the example shown.</p>
<pre lang="syntax"><code>Component 'Component1' has both per-user and per-machine 
    data with a per-machine KeyPath. 
 
WARNING: Component 'Component2' has both per-user and 
    per-machine data with an HKCU Registry KeyPath. 
 
Component 'Component3' has a registry entry that 
    can be either per-user or per-machine and a per-machine KeyPath. 
 
Component 'Component4' has both per-user data and 
    a keypath that can be either per-user or per-machine.
</code></pre>
<p><a href="component-table.html">Component Table</a> (partial)</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Directory</th>
<th>Attributes</th>
<th>KeyPath</th>
</tr>
</thead>
<tbody>
<tr>
<td>Component1</td>
<td>DirectoryA</td>
<td>0</td>
<td>FileA</td>
</tr>
<tr>
<td>Component2</td>
<td>DirectoryA</td>
<td>4</td>
<td>RegKeyB</td>
</tr>
<tr>
<td>Component3</td>
<td>DirectoryA</td>
<td>0</td>
<td>FileC</td>
</tr>
<tr>
<td>Component4</td>
<td>DirectoryA</td>
<td>4</td>
<td>RegKeyD</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p><a href="registry-table.html">Registry Table</a> (partial)</p>
<table>
<thead>
<tr>
<th>Registry</th>
<th>Root</th>
<th>Component_</th>
</tr>
</thead>
<tbody>
<tr>
<td>RegKeyA</td>
<td>1</td>
<td>Component1</td>
</tr>
<tr>
<td>RegKeyB</td>
<td>1</td>
<td>Component2</td>
</tr>
<tr>
<td>RegKeyC</td>
<td>-1</td>
<td>Component3</td>
</tr>
<tr>
<td>RegKeyD</td>
<td>-1</td>
<td>Component4</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p><a href="file-table.html">File Table</a> (partial)</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Component_</th>
</tr>
</thead>
<tbody>
<tr>
<td>FileA</td>
<td>Component1</td>
</tr>
<tr>
<td>FileB</td>
<td>Component2</td>
</tr>
<tr>
<td>FileC</td>
<td>Component3</td>
</tr>
<tr>
<td>FileD</td>
<td>Component4</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p><a href="directory-table.html">Directory Table</a></p>
<table>
<thead>
<tr>
<th>Directory</th>
<th>Directory_Parent</th>
<th>DefaultDir</th>
</tr>
</thead>
<tbody>
<tr>
<td>TARGETDIR</td>
<td></td>
<td>SourceDir</td>
</tr>
<tr>
<td>DirectoryA</td>
<td>TARGETDIR</td>
<td>DirectoryA</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>To fix the errors, reorganize the application such that each component contains only per-user or per-machine resources, and not both.</p>
<p>The first error message is posted because Component1 contains FileA (per-machine) and the HKCU registry key RegKeyA (per user).</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="ice-reference.html">ICE Reference</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
