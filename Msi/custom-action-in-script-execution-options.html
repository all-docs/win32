<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Custom Action In-Script Execution Options</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: You can use the following option flags to specify the in-script execution of custom actions.
ms.assetid: 6c608151-cdbe-4424-9b16-6dbff28190ab
title: Custom Action In-Script Execution Options
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Custom Action In-Script Execution Options</h1>
<p>You can use the following option flags to specify the in-script execution of custom actions. These options copy the action code into the execution, rollback, or commit script. To set an option add the value in this table to the value in the Type field of the <a href="customaction-table.html">CustomAction table</a>.</p>
<p>Note that the <strong>msidbCustomActionTypeInScript</strong> must be included with each of these options.</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->(none)<!-- raw HTML omitted --></td>
<td>Hexadecimal: 0x00000000<!-- raw HTML omitted --> Decimal: 0<!-- raw HTML omitted --> Immediate execution.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>msidbCustomActionTypeInScript</strong><!-- raw HTML omitted --></td>
<td>Hexadecimal: 0x00000400<!-- raw HTML omitted --> Decimal: 1024<!-- raw HTML omitted --> Queues for execution at scheduled point within script. This flag designates that this is a <a href="deferred-execution-custom-actions.html">deferred execution custom action</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>msidbCustomActionTypeInScript</strong> + <strong>msidbCustomActionTypeRollback</strong><!-- raw HTML omitted --></td>
<td>Hexadecimal: 0x00000400 + 0x00000100<!-- raw HTML omitted --> Decimal: 1280<!-- raw HTML omitted --> Queues for execution at scheduled point within script. Executes only upon an installation rollback. This flag designates that this is a <a href="rollback-custom-actions.html">rollback custom action</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>msidbCustomActionTypeInScript</strong> + <strong>msidbCustomActionTypeCommit</strong><!-- raw HTML omitted --></td>
<td>Hexadecimal: 0x00000400 + 0x00000200<!-- raw HTML omitted --> Decimal: 1536<!-- raw HTML omitted --> Queues for execution at scheduled point within script. Executes only upon install commit. This flag designates that this is a <a href="commit-custom-actions.html">commit custom action</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>msidbCustomActionTypeInScript</strong> + <strong>msidbCustomActionTypeNoImpersonate</strong><!-- raw HTML omitted --></td>
<td>Hexadecimal: 0x00000400 + 0x00000800<!-- raw HTML omitted --> Decimal: 3072<!-- raw HTML omitted --> Queues for execution at scheduled point within script. Executes with no user impersonation. Runs in system context.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>msidbCustomActionTypeInScript</strong> + <strong>msidbCustomActionTypeNoImpersonate</strong> + <strong>msidbCustomActionTypeRollback</strong><!-- raw HTML omitted --></td>
<td>Hexadecimal: 0x00000400 + 0x00000800 + 0x00000100<!-- raw HTML omitted --> Decimal: 3328<!-- raw HTML omitted --> Queues for execution at scheduled point within script. Executes with no user impersonation. Runs in system context. This flag combination designates that this is a <a href="rollback-custom-actions.html">rollback custom action</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>msidbCustomActionTypeInScript</strong> + <strong>msidbCustomActionTypeNoImpersonate</strong> + <strong>msidbCustomActionTypeCommit</strong><!-- raw HTML omitted --></td>
<td>Hexadecimal: 0x00000400 + 0x00000800 + 0x00000200<!-- raw HTML omitted --> Decimal: 3584<!-- raw HTML omitted --> Queues for execution at scheduled point within script. Executes with no user impersonation. Runs in system context. This flag combination designates that this is a <a href="commit-custom-actions.html">commit custom action</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>msidbCustomActionTypeTSAware</strong> + <strong>msidbCustomActionTypeInScript</strong><!-- raw HTML omitted --></td>
<td>Hexadecimal: 0x00000400 + 0x00004000<!-- raw HTML omitted --> Decimal: 17408<!-- raw HTML omitted --> Queues for execution at the scheduled point within script. Executes with user impersonation. Runs with user impersonation during per-machine installs on a server running the Terminal Server role service. Normal deferred execution custom actions, without this attribute, run with no user impersonation on a terminal server during per-machine installations. This attribute has no effect if the action also has the msidbCustomActionTypeNoImpersonate attribute.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>msidbCustomActionTypeTSAware</strong> + <strong>msidbCustomActionTypeInScript</strong> + <strong>msidbCustomActionTypeRollback</strong><!-- raw HTML omitted --></td>
<td>Hexadecimal: 0x00000400 + 0x00004000 + 0x00000100<!-- raw HTML omitted --> Decimal: 17664<!-- raw HTML omitted --> Queues for execution at the scheduled point within script. Run only upon an installation rollback. Execute with user impersonation. Runs with user impersonation during per-machine installs on a terminal server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>msidbCustomActionTypeTSAware</strong> + <strong>msidbCustomActionTypeInScript</strong> + <strong>msidbCustomActionTypeCommit</strong><!-- raw HTML omitted --></td>
<td>Hexadecimal: 0x00000400 + 0x00004000 + 0x00000200<!-- raw HTML omitted --> Decimal: 17920<!-- raw HTML omitted --> Queues for execution at the scheduled point within script. Runs only upon an install commit. Executes with user impersonation. Runs with user impersonation during per-machine installs on a terminal server.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>For information about custom actions that run only when a patch is being uninstalled, see the <a href="custom-action-patch-uninstall-option.html">Custom Action Patch Uninstall Option</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="custom-action-reference.html">Custom Action Reference</a></p>
<!-- raw HTML omitted -->
<p><a href="about-custom-actions.html">About Custom Actions</a></p>
<!-- raw HTML omitted -->
<p><a href="using-custom-actions.html">Using Custom Actions</a></p>
<!-- raw HTML omitted -->
</body>
