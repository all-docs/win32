<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Working with Queries</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Because the installer uses a relational database, there are functions for making Structured Query Language (SQL) queries to the database. The following procedure describes how to use SQL to query a database.
ms.assetid: 1b8fd935-4964-4875-801b-cc6765b16924
title: Working with Queries
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Working with Queries</h1>
<p>Because the installer uses a relational database, there are functions for making Structured Query Language (SQL) queries to the database. The following procedure describes how to use SQL to query a database.</p>
<p><strong>To query a database with SQL</strong></p>
<ol>
<li>
<p>Open the <a href="view-object.html"><strong>View</strong></a> object, with the appropriate SQL statement, by calling the <a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa"><strong>MsiDatabaseOpenView</strong></a> function.</p>
<p>A <a href="view-object.html"><strong>View</strong></a> object is the logical table created by applying a query to a set of tables. SQL queries must adhere to the <a href="sql-syntax.html">SQL syntax</a> provided by the installer. This SQL statement can contain parameter markers that are not specified until the <strong>View</strong> object runs.</p>
</li>
<li>
<p>Run the <a href="view-object.html"><strong>View</strong></a> object by calling the <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiviewexecute"><strong>MsiViewExecute</strong></a> function.</p>
</li>
<li>
<p>Retrieve the next record from a <a href="view-object.html"><strong>View</strong></a> object by calling the <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiviewfetch"><strong>MsiViewFetch</strong></a> function.</p>
</li>
<li>
<p>Modify the <a href="view-object.html"><strong>View</strong></a> object by calling the <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify"><strong>MsiViewModify</strong></a> function.</p>
<p>You can also validate data with <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify"><strong>MsiViewModify</strong></a> by passing the appropriate flags. If <strong>MsiViewModify</strong> returns ERROR_INVALID_DATA from a validation request, the underlying data is corrupt.</p>
</li>
<li>
<p>Obtain detailed error information on the <a href="view-object.html"><strong>View</strong></a> object by calling the <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora"><strong>MsiViewGetError</strong></a> function.</p>
</li>
<li>
<p>Close the <a href="view-object.html"><strong>View</strong></a> object by calling the <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiviewclose"><strong>MsiViewClose</strong></a> function.</p>
</li>
</ol>
<p>For more information, see <a href="examples-of-database-queries-using-sql-and-script.html">Examples of Database Queries Using SQL and Script</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
