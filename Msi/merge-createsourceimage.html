<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Merge.CreateSourceImage method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The CreateSourceImage method of the Merge object allows the client to extract the files from a module to a source image on disk after a merge, taking into account changes to the module that might have been made during module configuration.
ms.assetid: c3e3465a-d5a7-4fcc-b26a-5a8c763c23d9
title: Merge.CreateSourceImage method (Mergemod.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Merge.CreateSourceImage</li>
<li>IMsmMerge.CreateSourceImage
api_type:</li>
<li>COM
api_location:</li>
<li>Mergemod.dll</li>
</ul>
<hr />
<h1>Merge.CreateSourceImage method</h1>
<p>The <strong>CreateSourceImage</strong> method of the <a href="merge-object.html"><strong>Merge</strong></a> object allows the client to extract the files from a module to a source image on disk after a merge, taking into account changes to the module that might have been made during module configuration. The list of files to be extracted is taken from the file table of the module during the merge process. The list of files consists of every file successfully copied from the file table of the module to the target database. File table entries that were not copied due to primary key conflicts with existing rows in the database are not a part of this list. At image creation time, the directory for each of these files comes from the open (post-merge) database. The path specified in the <em>Path</em> parameter is the root of the source image for the install. <em>fLongFileNames</em> determines whether or not long file names are used for both path segments and final file names. The function fails if no database is open, no module is open, or no merge has been performed.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>Merge.CreateSourceImage(
  Path,
  fLongFileNames,
  pFilePaths
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Path</em></p>
<!-- raw HTML omitted -->
<p>The path of the root of the source image for the install.</p>
<!-- raw HTML omitted -->
<p><em>fLongFileNames</em></p>
<!-- raw HTML omitted -->
<p><em>fLongFileNames</em> determines whether or not long file names are used for both path segments and final file names.</p>
<!-- raw HTML omitted -->
<p><em>pFilePaths</em></p>
<!-- raw HTML omitted -->
<p>This is a list of fully qualified paths for the files that were successfully extracted.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>Any files in the destination directory with the same name are overwritten. The path is created if it does not already exist.</p>
<h3>C++</h3>
<p>See <a href="/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-createsourceimage"><strong>CreateSourceImage</strong></a> function.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Mergemod.dll 2.0 or later<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mergemod.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mergemod.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
