<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>RemoveFiles Action</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The RemoveFiles action removes files previously installed by the InstallFiles action.
ms.assetid: 1079be89-515c-443e-8927-46ddf7891a59
title: RemoveFiles Action
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>RemoveFiles Action</h1>
<p>The RemoveFiles action removes files previously installed by the <a href="installfiles-action.html">InstallFiles</a> action. Each of these files is gated by a link to an entry in the <a href="component-table.html">Component</a> table. Only those files with components resolved to either the <em>msiInstallStateAbsent</em> state or the <em>msiInstallStateLocal</em> state if the component is installed locally, are removed.</p>
<h2>Sequence Restrictions</h2>
<p>The <a href="installvalidate-action.html">InstallValidate</a> action must be called before calling RemoveFiles. If an <a href="installfiles-action.html">InstallFiles</a> action is used, it must appear after RemoveFiles.</p>
<h2>ActionData Messages</h2>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description of action data</th>
</tr>
</thead>
<tbody>
<tr>
<td>[1]</td>
<td>Identifier of removed file.</td>
</tr>
<tr>
<td>[9]</td>
<td>Identifier of directory holding removed file.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>The <a href="removefile-table.html">RemoveFile</a> table can be omitted from the installer database if there are no miscellaneous files to remove.</p>
<p>The RemoveFiles action can also remove author-specified files that are not installed by the InstallFiles action. These files are specified in the <a href="removefile-table.html">RemoveFile</a> table. Each of these files is gated by a link to an entry in the <a href="component-table.html">Component</a> table. Those files whose components are resolved to any active Action state (that is, not in the Off or Null state) are removed if the file exists in the specified directory. The removal of files specified in the RemoveFile table is attempted when the linked component is first installed, during a reinstall, and again when the linked component is removed.</p>
<p>The RemoveFiles action can also remove folders. An empty folder is removed if the value in the FileName column of the RemoveFile table is null.</p>
<p>When removing previously installed files, the RemoveFiles action queries the same fields in the same tables as those queried by the <a href="installfiles-action.html">InstallFiles</a> action with the exception that the <a href="media-table.html">Media table</a> is not used by the RemoveFiles action.</p>
<p>The target file name can be specified in localized text in the FileName column of the RemoveFile table.</p>
<p>Â </p>
<p>Â </p>
</body>
