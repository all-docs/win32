<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>RemoveFile Table</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The RemoveFile table contains a list of files to be removed by the RemoveFiles action. Setting the FileName column of this table to Null supports the removal of empty folders.
ms.assetid: 8b3cb0e3-ccc0-4030-8f57-aa124c3b5588
title: RemoveFile Table
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>RemoveFile Table</h1>
<p>The RemoveFile table contains a list of files to be removed by the <a href="removefiles-action.html">RemoveFiles action</a>. Setting the FileName column of this table to Null supports the removal of empty folders.</p>
<p>The RemoveFile table has the following columns.</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Key</th>
<th>Nullable</th>
</tr>
</thead>
<tbody>
<tr>
<td>FileKey</td>
<td><a href="identifier.html">Identifier</a></td>
<td>Y</td>
<td>N</td>
</tr>
<tr>
<td>Component_</td>
<td><a href="identifier.html">Identifier</a></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>FileName</td>
<td><a href="wildcardfilename.html">WildCardFilename</a></td>
<td>N</td>
<td>Y</td>
</tr>
<tr>
<td>DirProperty</td>
<td><a href="identifier.html">Identifier</a></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>InstallMode</td>
<td><a href="integer.html">Integer</a></td>
<td>N</td>
<td>N</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Columns</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->FileKey</p>
<!-- raw HTML omitted -->
<p>Primary key used to identify this particular table entry.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Component_</p>
<!-- raw HTML omitted -->
<p>External key the first column of the <a href="component-table.html">Component table</a>. This field references the component that controls the file to be removed.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->FileName</p>
<!-- raw HTML omitted -->
<p>This column contains the localizable name of the file to be removed. If this column is null, then the specified folder will be removed if it is empty. All of the files that match the wildcard will be removed from the specified directory.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->DirProperty</p>
<!-- raw HTML omitted -->
<p>Name of a property whose value is assumed to resolve to the full path to the folder of the file to be removed. The property can be the name of a directory in the <a href="directory-table.html">Directory table</a>, a property set by the <a href="appsearch-table.html">AppSearch table</a>, or any other property that represents a full path.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->InstallMode</p>
<!-- raw HTML omitted -->
<p>Must be one of the following values.</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Hexadecimal</th>
<th>Decimal</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>msidbRemoveFileInstallModeOnInstall</strong></td>
<td>0x001</td>
<td>1</td>
<td>Remove only when the associated component is being installed (msiInstallStateLocal or msiInstallStateSource).</td>
</tr>
<tr>
<td><strong>msidbRemoveFileInstallModeOnRemove</strong></td>
<td>0x002</td>
<td>2</td>
<td>Remove only when the associated component is being removed (msiInstallStateAbsent).</td>
</tr>
<tr>
<td><strong>msidbRemoveFileInstallModeOnBoth</strong></td>
<td>0x003</td>
<td>3</td>
<td>Remove in either of the above cases.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The file references in this table are processed by the <a href="removefiles-action.html">RemoveFiles action</a>.</p>
<h2>Validation</h2>
<!-- raw HTML omitted -->
<p><a href="ice03.html">ICE03</a><br />
<a href="ice06.html">ICE06</a><br />
<a href="ice18.html">ICE18</a><br />
<a href="ice32.html">ICE32</a><br />
<a href="ice45.html">ICE45</a><br />
<a href="ice64.html">ICE64</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
