<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>View.Modify method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The Modify method of the View object modifies a database row with a modified Record object obtained by the Fetch method.
ms.assetid: c3c500aa-070f-41d7-90f7-db979452d24f
title: View.Modify method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>View.Modify
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>View.Modify method</h1>
<p>The <strong>Modify</strong> method of the <a href="view-object.html"><strong>View</strong></a> object modifies a database row with a modified <a href="record-object.html"><strong>Record</strong></a> object obtained by the <a href="view-fetch.html"><strong>Fetch</strong></a> method.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>View.Modify(
  action,
  record
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>action</em></p>
<!-- raw HTML omitted -->
<p>Required action to be performed on the database row. This action is one of those shown in the following table.</p>
<table>
<thead>
<tr>
<th>Action name</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifySeek</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->â€“1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Refreshes the information in the supplied record without changing the position in the result set and without affecting subsequent fetch operations. The record may then be used for subsequent Update, Delete, and Refresh. All primary key columns of the table must be in the query and the record must have at least as many fields as the query.Seek cannot be used with multitable queries. See the remarks. This mode cannot be used with a view containing joins.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifyRefresh</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Refreshes the information in the record. Must first call the <a href="view-fetch.html"><strong>Fetch</strong></a> method with the same record. Fails for a deleted row. Works with both read-write and read-only records.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifyInsert</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Inserts a record. Fails if a row with the same primary keys exists. Fails with a read-only database. This mode cannot be used with a view containing joins.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifyUpdate</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Updates an existing record. Non-primary keys only. Must first call the <a href="view-fetch.html"><strong>Fetch</strong></a> method with the same record. Fails with a deleted record. Works only with read-write records.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifyAssign</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->3<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Writes current data in the cursor to a table row. Updates record if the primary keys match an existing row and inserts if they do not match. Fails with a read-only database. This mode cannot be used with a view containing joins.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifyReplace</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->4<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Updates or deletes and inserts a record into a table. Must first call the <a href="view-fetch.html"><strong>Fetch</strong></a> method with the same record. Updates record if the primary keys are unchanged. Deletes old row and inserts new if primary keys have changed. Fails with a read-only database. This mode cannot be used with a view containing joins.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifyMerge</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->5<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Inserts or validates a record in a table. Inserts if primary keys do not match any row and validates if there is a match. Fails if the record does not match the data in the table. Fails if there is a record with a duplicate key that is not identical. Works only with read-write records. This mode cannot be used with a view containing joins.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifyDelete</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->6<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Removes a row from the table. Must first call the <a href="view-fetch.html"><strong>Fetch</strong></a> method with the same record. Fails if the row has been deleted. Works only with read-write records. This mode cannot be used with a view containing joins.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifyInsertTemporary</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->7<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Inserts a temporary record. The information is not persistent. Fails if a row with the same primary key exists. Works only with read-write records. This mode cannot be used with a view containing joins.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifyValidate</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->8<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Validates a record. Does not validate across joins. Must first call the <a href="view-fetch.html"><strong>Fetch</strong></a> method with the same record. Obtain validation errors with <a href="view-geterror.html"><strong>GetError</strong></a> method. Works with read-write and read-only records. This mode cannot be used with a view containing joins.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifyValidateNew</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->9<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Validates a new record. Does not validate across joins. Checks for duplicate keys. Obtains validation errors by calling <a href="view-geterror.html"><strong>GetError</strong></a> method. Requires calling <a href="database-openview.html"><strong>MsiDatabase.OpenView</strong></a> method with a modify value. Works with read-write and read-only records. This mode cannot be used with a view containing joins.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifyValidateField</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->10<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Validates fields of a fetched or new record. Can validate one or more fields of an incomplete record. Obtains validation errors by calling <a href="view-geterror.html"><strong>GetError</strong></a> method. Works with read-write and read-only records. This mode cannot be used with a view containing joins.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiViewModifyValidateDelete</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->11<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Validates a record that will be deleted later. Must first call the <a href="view-fetch.html"><strong>Fetch</strong></a> method with the same record. Fails if another row refers to the primary keys of this row. Validation does not check for the existence of the primary keys of this row in properties or strings. Does not check if a column is a foreign key to multiple tables. Obtain validation errors by calling the <a href="view-geterror.html"><strong>GetError</strong></a> method. Works with read-write and read-only records. This mode cannot be used with a view containing joins.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>record</em></p>
<!-- raw HTML omitted -->
<p>Required. <a href="record-object.html"><strong>Record</strong></a> object obtained by the <a href="view-fetch.html"><strong>Fetch</strong></a> method with modified field data.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>This method must be called after the <a href="view-execute.html"><strong>Execute</strong></a> method.</p>
<p>To execute any SQL statement, a view must be created. However, a view that does not create a result set, such as CREATE TABLE or INSERT INTO, cannot be used with the <strong>Modify</strong> method to update tables though the view.</p>
<p>The msiViewModifyValidate, msiViewModifyValidateNew, msiViewModifyValidateField, and msiViewModifyValidateDelete values of the <strong>Modify</strong> method do not perform actual updates; they ensure that the data in the record is valid. Use of these actions requires that the database contain a <a href="-validation-table.html">_Validation table</a> .</p>
<p>You cannot fetch a record containing binary data from one database and then use that record to insert the data into a completely different database. To move binary data from one database to another, you should export the data to a file and then import it into the new database using the <a href="record-setstream.html"><strong>SetStream</strong></a> method of the <a href="record-object.html"><strong>Record</strong></a> object. This ensures that each database has its own copy of the binary data.</p>
<blockquote>
<p>[!Note]<br />
Custom actions can only add, modify, or remove temporary rows, columns, or tables from a database. Custom actions cannot modify persistent data in a database, such as data that is a part of the database stored on disk. For more information, see <a href="accessing-the-current-installer-session-from-inside-a-custom-action.html">Accessing the Current Installer Session from Inside a Custom Action</a>.</p>
</blockquote>
<p>Â </p>
<p>If the method fails, you can obtain extended error information by using the <a href="installer-lasterrorrecord.html"><strong>LastErrorRecord</strong></a> method.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer on Windows ServerÂ 2003 or WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IView is defined as 000C109C-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
