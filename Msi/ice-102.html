<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ICE 102</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Validates the MsiServiceConfig and MsiServiceConfigFailureActions tables.
ms.assetid: 48d8659d-fd10-404a-8310-ef394406f5df
title: ICE 102
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>ICE 102</h1>
<p>Validates the <a href="msiserviceconfig-table.html">MsiServiceConfig</a> and <a href="msiserviceconfigfailureactions-table.html">MsiServiceConfigFailureActions</a> tables.</p>
<p>Verifies that the value in the Event column in the <a href="msiserviceconfig-table.html">MsiServiceConfig</a> and <a href="msiserviceconfigfailureactions-table.html">MsiServiceConfigFailureActions</a> tables is <strong>msidbServiceConfigEventInstall</strong>, <strong>msidbServiceConfigEventUninstall</strong>, or <strong>msidbServiceConfigEventReinstall</strong>. Verifies that the value in the Component_ column in the MsiServiceConfig and MsiServiceConfigFailureActions tables is a valid key into the <a href="component-table.html">Component Table</a>.</p>
<p>Verifies that the values in the ConfigType column of the <a href="msiserviceconfig-table.html">MsiServiceConfig</a> table is one of the allowed values.</p>
<p>Verifies that the values in the Actions and the Delayed Actions columns of the <a href="msiserviceconfigfailureactions-table.html">MsiServiceConfigFailureActions</a> table are separated by [~]. Verifies that the number of values listed in the Actions column and the number of values listed in the Delayed Actions column in each row of the MsiServiceConfigFailureActions table are the same.</p>
<p>If the value in the ConfigType field in the <a href="msiserviceconfig-table.html">MsiServiceConfig table</a> is <strong>SERVICE_CONFIG_DELAYED_AUTO_START</strong> the value in the Argument field must be 0 or 1.</p>
<p>If the value in the ConfigType field in the <a href="msiserviceconfig-table.html">MsiServiceConfig table</a> is <strong>SERVICE_CONFIG_REQUIRED_PRIVILEGES_INFO</strong> the value in the Argument field must contain a valid string of <strong>Privilege Constants</strong>.</p>
<p>If the value in the ConfigType field in the <a href="msiserviceconfig-table.html">MsiServiceConfig table</a> is <strong>SERVICE_CONFIG_SERVICE_SID_INFO</strong> the value in the Argument field must be <strong>SERVICE_SID_TYPE_NONE</strong>, <strong>SERVICE_SID_TYPE_RESTRICTED</strong>, or <strong>SERVICE_SID_TYPE_UNRESTRICTED</strong>.</p>
<p>If the value in the ConfigType field in the <a href="msiserviceconfig-table.html">MsiServiceConfig table</a> is <strong>SERVICE_CONFIG_PRESHUTDOWN_INFO</strong> the value in the Argument field must be positive or empty. If the value in the ConfigType field in the MsiServiceConfig table is <strong>SERVICE_CONFIG_FAILURE_ACTIONS_FLAG</strong> the value in the Argument field must contain 0 or 1.</p>
<p><strong><a href="not-supported-in-windows-installer-4-5.html">Windows Installer 4.5 or earlier</a>:</strong> Not supported. This ICE is available beginning with Windows Installer 5.0.</p>
<h2>Result</h2>
<p>ICE102 posts the following errors.</p>
<table>
<thead>
<tr>
<th>ICE102 error</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>In the MsiServiceConfig table entry (MsiServiceConfig = )[1], ConfigType =%d is not a valid parameter. It should be between 3 and 7.</td>
<td>The Config field of the <a href="msiserviceconfig-table.html">MsiServiceConfig table</a> does not contain one of the allowed values.</td>
</tr>
<tr>
<td>In the MsiServiceConfig table entry (MsiServiceConfig = )[1], Argument =%s is not a valid %s parameter. It should be %s.</td>
<td>The Argument field of the <a href="msiserviceconfig-table.html">MsiServiceConfig table</a> does not contain one of the allowed values.</td>
</tr>
<tr>
<td>In the MsiServiceConfigFailureActions table entry (MsiServiceConfigFailureActions = )[1], Actions=[3] is not a valid parameter. It should be a list of null-separated non-negative integers.</td>
<td>The Actions field of the <a href="msiserviceconfigfailureactions-table.html">MsiServiceConfigFailureActions</a> does not contain an array of positive integers. Separate the values in the array by [~].</td>
</tr>
<tr>
<td>In the MsiServiceConfigFailureActions table entry (MsiServiceConfigFailureActions = )[1], DelayActions=[4] is not a valid parameter. It should be a list of null-separated non-negative integers.</td>
<td>The DelayActions field of the <a href="msiserviceconfigfailureactions-table.html">MsiServiceConfigFailureActions</a> does not contain an array of positive integers. Separate the values in the array by [~].</td>
</tr>
<tr>
<td>In the MsiServiceConfigFailureActions table entry (MsiServiceConfigFailureActions = )[1], number of Actions (=%d) is not equal to the number of DelayActions (=%d). They should be equal.</td>
<td>The number of elements in the Actions and the DelayActions fields of the <a href="msiserviceconfigfailureactions-table.html">MsiServiceConfigFailureActions</a> table are not equal. The number of elements in these arrays should be the same.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>ICE102 posts the following warnings.</p>
<table>
<thead>
<tr>
<th>ICE104 warning</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>In the MsiServiceConfig table entry (MsiServiceConfig = )[1], Argument field is left blank. Default preshutdown value of 180000 will be used</td>
<td>The time delay is 180000 milliseconds because the Argument field of the <a href="msiserviceconfig-table.html">MsiServiceConfig table</a> is blank.</td>
</tr>
<tr>
<td>In the MsiServiceConfigFailureActions table entry (MsiServiceConfigFailureActions = )[1], ResetPeriod is left blank. It will be replaced with INFINITE.</td>
<td>The failure count is never be reset because the ResetPeriod field of the <a href="msiserviceconfigfailureactions-table.html">MsiServiceConfigFailureActions</a> is blank.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
