<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EnforceUpgradeComponentRules</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This is a per-machine system policy that can be used to apply upgrade component rules during small updates and minor upgrades.
ms.assetid: 0d39c059-d936-454c-aed8-efedd3da7473
title: EnforceUpgradeComponentRules
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>EnforceUpgradeComponentRules</h1>
<p>This is a per-machine <a href="system-policy.html">system policy</a> that can be used to apply upgrade component rules during <a href="small-updates.html">small updates</a> and <a href="minor-upgrades.html">minor upgrades</a>.</p>
<p>Set the EnforceUpgradeComponentRules policy to 1 to apply upgrade component rules during <a href="small-updates.html">small updates</a> and <a href="minor-upgrades.html">minor upgrades</a> of all products on the computer. To apply the rules during small updates and minor upgrades of a particular product, set the <a href="msienforceupgradecomponentrules.html"><strong>MSIENFORCEUPGRADECOMPONENTRULES</strong></a> property to 1 on the command line or in the <a href="property-table.html">Property table</a>.</p>
<p>When the property or policy has been set to 1, <a href="small-updates.html">small updates</a> and <a href="minor-upgrades.html">minor upgrades</a> can fail because the update attempts to do the following:</p>
<ul>
<li>
<p>Add a new feature to the top or middle of an existing feature tree.</p>
<p>The new feature must be added as a new leaf feature to an existing feature tree.</p>
<p>In this case, the <a href="productcode.html"><strong>ProductCode</strong></a> of the product can be changed and the updates can be treated as a <a href="major-upgrades.html">major upgrade</a>.</p>
</li>
<li>
<p>Remove a component from a feature.</p>
<p>This can also occur if you change the GUID of a component. The component identified by the original GUID appears to be removed and the component as identified by the new GUID appears as a new component.</p>
<p><strong>Windows Installer 4.5 and later:</strong> The component can be removed correctly using Windows Installer 4.5 or later by setting the <strong>msidbComponentAttributesUninstallOnSupersedence</strong> attribute in the <a href="component-table.html">Component table</a> or by setting the <a href="msiuninstallsupersededcomponents.html"><strong>MSIUNINSTALLSUPERSEDEDCOMPONENTS</strong></a> property.</p>
<p>Alternatively, the <a href="productcode.html"><strong>ProductCode</strong></a> of the product can be changed and the updates can be treated as a <a href="major-upgrades.html">major upgrade</a>.</p>
</li>
</ul>
<h2>Registry Key</h2>
<p><strong>HKEY_LOCAL_MACHINE</strong>\<strong>Software</strong>\<strong>Policies</strong>\<strong>Microsoft</strong>\<strong>Windows</strong>\<strong>Installer</strong></p>
<h2>Data Type</h2>
<p><strong>REG_DWORD</strong></p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="not-supported-in-windows-installer-version-2-0.html">Not Supported in Windows Installer 2.0 and earlier</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
