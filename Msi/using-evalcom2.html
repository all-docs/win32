<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Evalcom2</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Evalcom2.dll can be used to implement validation operations for installation packages and merge modules using Internal Consistency Evaluators - ICEs.
ms.assetid: df38e75e-554c-4a6d-b9ad-8eee5123a16f
title: Using Evalcom2
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using Evalcom2</h1>
<p>Evalcom2.dll can be used to implement validation operations for installation packages and merge modules using <a href="internal-consistency-evaluators-ices.html">Internal Consistency Evaluators - ICEs</a>. The main object implements interfaces for C/C++ programs.</p>
<p>The main object also implements <a href="evalcom2-interfaces.html">Evalcom2 interfaces</a> for C/C++ programs. The CLSID required to obtain the interface from <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> is {6E5E1910-8053-4660-B795-6B612E29BC58}. The REFIID is {E482E5C6-E31E-4143-A2E6-DBC3D8E4B8D3}.</p>
<p>You can use the following procedure to implement validation operations.</p>
<p><strong>To implement validation operations</strong></p>
<ol>
<li>Initialize COM on the calling thread using <a href="/windows/win32/api/objbase/nf-objbase-coinitialize"><strong>CoInitialize</strong></a>.</li>
<li>Obtain the pointer to the <a href="/windows/desktop/api/evalcom2/nn-evalcom2-ivalidate"><strong>IValidate</strong></a> interface using <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a>.</li>
<li>Open the installation package or merge module using the <a href="/windows/desktop/api/evalcom2/nf-evalcom2-ivalidate-opendatabase"><strong>OpenDatabase</strong></a> method.</li>
<li>Open the evaluation file using the <a href="/windows/desktop/api/evalcom2/nf-evalcom2-ivalidate-opencub"><strong>OpenCUB</strong></a> method.</li>
<li>Set the display callback function using the <a href="/windows/desktop/api/evalcom2/nf-evalcom2-ivalidate-setdisplay"><strong>SetDisplay</strong></a> method.</li>
<li>Set the status callback function using the <a href="/windows/desktop/api/evalcom2/nf-evalcom2-ivalidate-setstatus"><strong>SetStatus</strong></a> method.</li>
<li>Perform the validation using the <a href="/windows/desktop/api/evalcom2/nf-evalcom2-ivalidate-validate"><strong>Validate</strong></a> method.</li>
<li>Close the .cub file using the <a href="/windows/desktop/api/evalcom2/nf-evalcom2-ivalidate-closecub"><strong>CloseCUB</strong></a> method.</li>
<li>Close the database using the <a href="/windows/desktop/api/evalcom2/nf-evalcom2-ivalidate-closedatabase"><strong>CloseDatabase</strong></a> method.</li>
<li>Release the <a href="/windows/desktop/api/evalcom2/nn-evalcom2-ivalidate"><strong>IValidate</strong></a> interface.</li>
<li>Uninitialize COM using <a href="/windows/win32/api/combaseapi/nf-combaseapi-couninitialize"><strong>CoUninitialize</strong></a>.</li>
</ol>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="evalcom2-interfaces.html">Evalcom2 Interfaces</a></p>
<!-- raw HTML omitted -->
<p><a href="validation-automation.html">Validation Automation</a></p>
<!-- raw HTML omitted -->
<p><a href="validation-callback-functions.html">Validation Callback Functions</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
