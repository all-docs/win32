<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Installer.ApplyPatch method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: For each product listed by the patch package as eligible to receive the patch, the ApplyPatch method of the Installer object invokes an installation and sets the PATCH property to the path of the patch package.
ms.assetid: eee93b6d-f45b-40ae-8e17-cfe6f46b66f4
title: Installer.ApplyPatch method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Installer.ApplyPatch
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Installer.ApplyPatch method</h1>
<p>For each product listed by the patch package as eligible to receive the patch, the <strong>ApplyPatch</strong> method of the <a href="installer-object.html"><strong>Installer</strong></a> object invokes an installation and sets the <a href="patch.html"><strong>PATCH</strong></a> property to the path of the patch package.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>Installer.ApplyPatch(
  PatchPackage,
  InstallPackage,
  InstallType,
  CommandLine
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>PatchPackage</em></p>
<!-- raw HTML omitted -->
<p>Specifies a path to the patch package.</p>
<!-- raw HTML omitted -->
<p><em>InstallPackage</em></p>
<!-- raw HTML omitted -->
<p>If <em>InstallType</em> is set to msiInstallTypeNetworkImage, <em>InstallPackage</em> specifies the path to the product that is to be patched. If <em>InstallType</em> is set to msiInstallTypeDefault and <em>InstallPackage</em> is set to 0, the installer applies the patch to every eligible product listed in the patch package.</p>
<p>If <em>InstallType</em> is msiInstallTypeSingleInstance, the installer applies the patch to the product specified by <em>InstallPackage</em>. In this case, other eligible products listed in the patch package are ignored and the <em>InstallPackage</em> parameter contains the null-terminated string representing the product code of the instance to patch. This type of installation requires the Windows Installer version shipped with the Windows ServerÂ 2003 or later or Windows Installer XP SP1 or later.</p>
<!-- raw HTML omitted -->
<p><em>InstallType</em></p>
<!-- raw HTML omitted -->
<p>This parameter specifies the type of installation to patch. The <em>InstallType</em> parameter is ignored if <em>InstallPackage</em> is omitted.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiInstallTypeNetworkImage</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Indicates a administrative installation. In this case, <em>InstallPackage</em> must be set to a package path. A value of 1 for msiInstallTypeNetworkImage specifies a administrative installation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiInstallTypeDefault</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Searches system for products to patch. In this case, <em>InstallPackage</em> must be an empty string.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiInstallSingleInstance</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Patch the product specified by <em>InstallPackage</em>. <em>InstallPackage</em> is the product code of the instance to patch. This type of installation requires the Windows Installer version shipped with Windows ServerÂ 2003 or later or Windows Installer XP SP1 or later. For more information see, <a href="installing-multiple-instances-of-products-and-patches.html">Installing Multiple Instances of Products and Patches</a>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>CommandLine</em></p>
<!-- raw HTML omitted -->
<p>Specifies property settings being set on the command line. See Remarks section.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>Because the list delimiter for transforms, sources, and patches is a semicolon, this character should not be used for file names or paths.</p>
<p>The <a href="reinstall.html"><strong>REINSTALL</strong></a> property is required when applying a <a href="small-updates.html">small update</a> or <a href="minor-upgrades.html">minor upgrade</a> patch. Without this property, the patch is registered on the system but cannot update files.</p>
<p><strong>Windows Installer 2.0:</strong> You must set the <a href="reinstall.html"><strong>REINSTALL</strong></a> property on the command line when applying a <a href="small-updates.html">small update</a> or <a href="minor-upgrades.html">minor upgrade</a> patch. For patches that do not use a <a href="custom-action-type-51.html">Custom Action Type 51</a> to automatically set the <strong>REINSTALL</strong> and <a href="reinstallmode.html"><strong>REINSTALLMODE</strong></a> properties, the <strong>REINSTALL</strong> property must be explicitly set with the <em>CommandLine</em> parameter. Set the <strong>REINSTALL</strong> property to list the features affected by the patch, or use a practical default setting of &quot;REINSTALL=ALL&quot;. The default value of the <strong>REINSTALLMODE</strong> property is &quot;omus&quot;.</p>
<p><strong>Windows Installer 3.0 and later:</strong> Beginning with Windows Installer version 3.0, the <a href="reinstall.html"><strong>REINSTALL</strong></a> property is configured by the installer and does not need to be set on the command line.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer 3.0 or later on Windows ServerÂ 2003 or WindowsÂ XP.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IInstaller is defined as 000C1090-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Msi/nf-msi-msiapplypatcha"><strong>MsiApplyPatch</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="about-properties.html">About Properties</a></p>
<!-- raw HTML omitted -->
<p><a href="not-supported-in-windows-installer-version-2-0.html">Not Supported in Windows Installer 2.0 and earlier</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
