<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>_Streams Table</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The _Streams table lists embedded OLE data streams. This is a temporary table, created only when referenced by a SQL statement.
ms.assetid: 1e30472d-6ba5-410a-a81b-07ed225dcb69
title: '_Streams Table'
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>_Streams Table</h1>
<p>The _Streams table lists embedded OLE data streams. This is a temporary table, created only when referenced by a SQL statement.</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Key</th>
<th>Nullable</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td><a href="text.html">Text</a></td>
<td>Y</td>
<td>N</td>
</tr>
<tr>
<td>Data</td>
<td><a href="binary.html">Binary</a></td>
<td>N</td>
<td>Y</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Columns</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Name</p>
<!-- raw HTML omitted -->
<p>A unique key that identifies the stream. The maximum length of Name is 62 characters.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Data</p>
<!-- raw HTML omitted -->
<p>The unformatted binary data.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>To copy an OLE data stream (for example, an object of the <a href="binary.html">Binary</a> data type) from a file into a database, create a record in the _Streams table and enter the name of the data stream into the Name column of this record and copy the data from the file into the Data column using <a href="/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama"><strong>MsiRecordSetStream</strong></a>. Use <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify"><strong>MsiViewModify</strong></a> to insert the new record into the table.</p>
<p>To read a binary data stream embedded in a database, use a SQL query to find and to fetch the record containing the binary data. Use <a href="/windows/desktop/api/Msiquery/nf-msiquery-msirecordreadstream"><strong>MsiRecordReadStream</strong></a> to read the binary data into a buffer.</p>
<p>To move a binary data stream from one database to another, first export the data to a file. Use a SQL query to find the data stream in the file and use <a href="/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama"><strong>MsiRecordSetStream</strong></a> to copy the data from the file into Data column of _Streams table of the second database. This ensures that each database has its own copy of the binary data. You cannot move binary data from one database to another simply by fetching a record with the data from the first database and inserting it into the second database.</p>
<p>To delete a data stream, fetch the record and set the Data column to null before updating the record. Another method is to remove the record from the table, deleting it using either <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify"><strong>MsiViewModify</strong></a> or a plain SQL query. A stream should not be fetched into a record if the stream is deleted from the table.</p>
<p>To rename an OLE data stream, update the 'Name' column of the record.</p>
<p>If a hold is placed on this table using SQL (ALTER TABLE <!-- raw HTML omitted --> HOLD) or a column is added with HOLD, the table must be released using FREE. Streams are not written until the table has been released or committed.</p>
<p>Â </p>
<p>Â </p>
</body>
