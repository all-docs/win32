<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Installer.FileSignatureInfo method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The FileSignatureInfo method of the Installer object takes the path to a file and returns a SAFEARRAY of bytes that represent the hash or the encoded certificate.
ms.assetid: ab34bc46-8a8f-4b48-a1d1-d824ff36a9cc
title: Installer.FileSignatureInfo method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Installer.FileSignatureInfo
api_type:</li>
<li>COM
api_location:</li>
<li>Msi.dll</li>
</ul>
<hr />
<h1>Installer.FileSignatureInfo method</h1>
<p>The <strong>FileSignatureInfo</strong> method of the <a href="installer-object.html"><strong>Installer</strong></a> object takes the path to a file and returns a SAFEARRAY of bytes that represent the hash or the encoded certificate. The values can then be used to populate the <a href="msidigitalsignature-table.html">MsiDigitalSignature</a>, <a href="msipatchcertificate-table.html">MsiPatchCertificate</a>, and <a href="msidigitalcertificate-table.html">MsiDigitalCertificate</a> tables.</p>
<p>For more information, see the <a href="/windows/win32/api/oaidl/ns-oaidl-safearray"><strong>SAFEARRAY Data Type</strong></a>.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>Installer.FileSignatureInfo(
  FilePath,
  Options,
  Format
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>FilePath</em></p>
<!-- raw HTML omitted -->
<p>Full path to a file that is digitally signed.</p>
<p>When populating the <a href="msidigitalsignature-table.html">MsiDigitalSignature</a> and <a href="msidigitalcertificate-table.html">MsiDigitalCertificate</a> tables, <em>FilePath</em> points to a digitally signed cabinet. When populating the <a href="msipatchcertificate-table.html">MsiPatchCertificate</a> and MsiDigitalCertificate tables, <em>FilePath</em> points to a digitally signed patch.</p>
<!-- raw HTML omitted -->
<p><em>Options</em></p>
<!-- raw HTML omitted -->
<p>Special error case flags.</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiSignatureOptionInvalidHashFatal</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>With <em>Options</em> set to msiSignatureOptionInvalidHashFatal, <strong>FileSignatureInfo</strong> always returns a fatal error for an invalid hash. <!-- raw HTML omitted --> If <em>Options</em> is not set to msiSignatureOptionInvalidHashFatal and <em>Format</em> is set to msiSignatureInfoCertificate, <strong>FileSignatureInfo</strong> does not return an error for an invalid hash.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>Format</em></p>
<!-- raw HTML omitted -->
<p>The requested signature information.</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiSignatureInfoCertificate</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns a SAFEARRAY of bytes that represent the encoded certificate.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>msiSignatureInfoHash</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns a SAFEARRAY of bytes that represent the hash.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If successful, the method returns a <a href="/windows/win32/api/oaidl/ns-oaidl-safearray">SAFEARRAY</a> of bytes that contain either the hash or encoded certificate.</p>
<h2>Remarks</h2>
<p>To author a fully verified signed installation by using automation, use the <strong>FileSignatureInfo</strong> method to populate the <a href="msidigitalcertificate-table.html">MsiDigitalCertificate</a>, <a href="msipatchcertificate-table.html">MsiPatchCertificate</a>, and <a href="msidigitalsignature-table.html">MsiDigitalSignature</a> tables. For more information, see <a href="authoring-a-fully-verified-signed-installation-using-automation.html">Authoring a Fully Verified Signed Installation Using Automation</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version<!-- raw HTML omitted --></td>
<td>Windows Installer 5.0 on Windows ServerÂ 2012, WindowsÂ 8, Windows ServerÂ 2008Â R2 or WindowsÂ 7. Windows Installer 4.0 or Windows Installer 4.5 on Windows ServerÂ 2008 or WindowsÂ Vista. Windows Installer on Windows ServerÂ 2003 or WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IInstaller is defined as 000C1090-0000-0000-C000-000000000046<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="authoring-a-fully-verified-signed-installation-using-automation.html">Authoring a Fully Verified Signed Installation Using Automation</a></p>
<!-- raw HTML omitted -->
<p><a href="digital-signatures-and-windows-installer.html">Digital Signatures and Windows Installer</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Msi/nf-msi-msigetfilesignatureinformationa"><strong>MsiGetFileSignatureInformation</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
