<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ICE35</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: ICE35 validates that components containing compressed files stored in a cabinet file are not set to run from source. With Windows Installer 2.0 or later, this restriction has been removed.
ms.assetid: b4df27e2-9790-4b18-a173-25fa8b0ecd4d
title: ICE35
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>ICE35</h1>
<p>ICE35 validates that components containing compressed files stored in a <a href="cabinet-files.html">cabinet file</a> are not set to run from source. With Windows Installer 2.0 or later, this restriction has been removed.</p>
<p>ICE35 queries the Cabinet column of the <a href="media-table.html">Media table</a> to determine which files are compressed and stored in a cabinet file. It queries the <a href="file-table.html">File table</a> to determine which components contain these files. Finally, it checks the <a href="component-table.html">Component table</a> to determine whether the run-from-source bits are set in the Attributes column.</p>
<h2>Result</h2>
<p>ICE35 posts an error message if there is a compressed file stored in a cabinet file belonging to a component with the msidbComponentAttributesSourceOnly bit set in the Attributes column of the <a href="component-table.html">Component table</a>. With Windows Installer 2.0 or later, this is changed from an error to a warning message. A package that supports only Windows Installer 2.0 and later has the PID_PAGECOUNT property of the Summary Information Stream set to a value of at least 200.</p>
<p>ICE35 posts warning message if there is a compressed file stored in a cabinet file belonging to a component with the msidbComponentAttributesOptional bit set in the Attributes column of the <a href="component-table.html">Component table</a>. This warning message has been removed with Windows Installer 2.0 and later.</p>
<p>If multiple files in a component are in a cabinet file, ICE35 reports errors for each file that has the run from source bit set.</p>
<h2>Example</h2>
<p>ICE35 reports the following errors and warnings for the example shown using a version earlier than Windows Installer version 2.0.</p>
<table>
<thead>
<tr>
<th>ICE35 Error</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ERROR: Component Component3 cannot be Run From Source only, because its member file 'File3' is compressed.</td>
<td>There is a compressed file stored in a cabinet file and this file belongs to a component with the SourceOnly bit set in the Attributes column of the <a href="component-table.html">Component table</a>. To fix this error change the lower 2 bits of Component2's Attributes value to &quot;00&quot;, meaning Local only, or remove File4 from the CAB file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>ERROR: Component Component3 cannot be Run From Source only, because its member file 'File3' is compressed.</td>
<td>There is a compressed file stored in a cabinet file and this file belongs to a component with the SourceOnly bit set in the Attributes column of the <a href="component-table.html">Component table</a>. Because the files in a component do not all have to originate from the same media, ICE35 reports errors for each file in the component that is in a cabinet.<!-- raw HTML omitted --> To fix this error change the lower 2 bits of Component2's Attributes value to &quot;00&quot;, meaning Local only, or remove File4 from the CAB file.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p><a href="media-table.html">Media Table</a> (partial)</p>
<table>
<thead>
<tr>
<th>DiskID</th>
<th>LastSequence</th>
<th>Cabinet</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2</td>
<td>Â </td>
</tr>
<tr>
<td>2</td>
<td>4</td>
<td>One.cab</td>
</tr>
<tr>
<td>3</td>
<td>5</td>
<td>#Two.cab</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p><a href="file-table.html">File Table</a> (partial)</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Component_</th>
<th>Sequence</th>
</tr>
</thead>
<tbody>
<tr>
<td>File1</td>
<td>Component1</td>
<td>1</td>
</tr>
<tr>
<td>File2</td>
<td>Component2</td>
<td>2</td>
</tr>
<tr>
<td>File3</td>
<td>Component2</td>
<td>3</td>
</tr>
<tr>
<td>File4</td>
<td>Component3</td>
<td>4</td>
</tr>
<tr>
<td>File5</td>
<td>Component3</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p><a href="component-table.html">Component Table</a> (partial)</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Attributes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Component1</td>
<td>0</td>
</tr>
<tr>
<td>Component2</td>
<td>2</td>
</tr>
<tr>
<td>Component3</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p><a href="shortcut-table.html">Shortcut Table</a> (partial)</p>
<table>
<thead>
<tr>
<th>Shortcut</th>
<th>Icon_</th>
</tr>
</thead>
<tbody>
<tr>
<td>Shortcut1</td>
<td>Icon2</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Note that files can also be marked as compressed using the <a href="word-count-summary.html"><strong>Word Count Summary</strong></a> Property of the <a href="summary-information-stream.html">Summary Information stream</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="ice-reference.html">ICE Reference</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
