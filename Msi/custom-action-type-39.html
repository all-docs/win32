<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Custom Action Type 39</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Developers of Windows Installer packages may choose to use a custom action type 39 when the standard actions are insufficient to execute the installation.
ms.assetid: edf96cc6-ef32-4660-b4ee-50c130626e15
title: Custom Action Type 39
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Custom Action Type 39</h1>
<p>The Custom Action Type 39 is used with concurrent installations. Concurrent installations are not recommended for the installation of applications intended for release to the public. For information about concurrent installations please see <a href="concurrent-installations.html">Concurrent Installations</a>.</p>
<p>Type 39 custom action installs an application that is advertised or already installed. This custom action type may be used to reinstall or remove a product that has been installed as a concurrent installation by the current product's installation package. The Type 39 custom action cannot be used to reinstall or remove any product previously installed by any other means. For example, if the secondary product is installed using a Type 39, Type 23, or Type 7 custom action during the installation of the primary product, a Type 39 custom action may be used to remove the secondary product when the primary product is uninstalled.</p>
<h2>Source</h2>
<p>The Source field of the <a href="customaction-table.html">CustomAction table</a> contains the product code for the application.</p>
<h2>Numeric Type</h2>
<table>
<thead>
<tr>
<th>Type name</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>msidbCustomActionTypeInstall + msidbCustomActionTypeDirectory</td>
<td>39</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Target</h2>
<p>The Target field of the <a href="customaction-table.html">CustomAction table</a> contains property settings that are to be passed to the concurrent installation. These property settings can specify features.</p>
<h2>Return Processing Options</h2>
<p>The custom action type 39 fails if the application is not advertised or installed. To avoid this failure, you must set the <strong>msidbCustomActionTypeContinueflag</strong>.</p>
<p>A concurrent install cannot run asynchronously.</p>
<p>See <a href="custom-action-return-processing-options.html">Custom Action Return Processing Options</a>.</p>
<h2>Execution Scheduling Options</h2>
<p>Options flags are available to control the potential multiple execution of custom actions. See <a href="custom-action-execution-scheduling-options.html">Custom Action Execution Scheduling Options</a>.</p>
<h2>In-Script Execution Options</h2>
<p>The custom action does not use this option.</p>
<h2>Return Values</h2>
<p>The return status of user exit, failure, suspend, or success from a concurrent installation is processed in the same way as any other action. Note however that Windows Installer translates the return values from all actions when it writes the return value into the log file. For example, if the action return value appears as 1 in the log file, this means that the action returned ERROR_SUCCESS. For more information, see <a href="logging-of-action-return-values.html">Logging of Action Return Values</a>.</p>
<p>Note that if a concurrent installation has <strong>msidbCustomActionTypeContinue</strong> set, then a return of ERROR_INSTALL_USEREXIT, ERROR_INSTALL_REBOOT, ERROR_INSTALL_REBOOT_NOW, or ERROR_SUCCESS_REBOOT_REQUIRED is treated as ERROR_SUCCESS. This means that if you set <strong>msidbCustomActionTypeContinue</strong> and your concurrent installation requires a restart, the requirement for the restart will be ignored. Additionally, the error code from the concurrent installation custom action will be ignored.</p>
<p>If <strong>msidbCustomActionTypeContinue</strong> is not set, the following return codes plus ERROR_SUCCESS are treated as success and have the following meanings. Other return codes are treated as failure.</p>
<table>
<thead>
<tr>
<th>Message</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>ERROR_INSTALL_REBOOT</td>
<td>The restart flag will be set to restart at end of the installation.</td>
</tr>
<tr>
<td>ERROR_INSTALL_REBOOT_NOW</td>
<td>A restart is required before completing the installation. The restart will be processed immediately.</td>
</tr>
<tr>
<td>ERROR_SUCCESS_REBOOT_REQUIRED</td>
<td>A restart was required, but was suppressed.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>A conditional expression is required to enable the concurrent installation at either installation or removal of the associated component or feature.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="concurrent-installations.html">Concurrent Installations</a></p>
<!-- raw HTML omitted -->
<p><a href="custom-action-reference.html">Custom Action Reference</a></p>
<!-- raw HTML omitted -->
<p><a href="about-custom-actions.html">About Custom Actions</a></p>
<!-- raw HTML omitted -->
<p><a href="using-custom-actions.html">Using Custom Actions</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
