<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Functions Not for Use in Custom Actions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The following Database Functions must never be called from a custom action.
ms.assetid: 55fdd82b-9f34-4c2c-a837-8a09f21f568a
title: Functions Not for Use in Custom Actions
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Functions Not for Use in Custom Actions</h1>
<p>The following <a href="database-functions.html">Database Functions</a> must never be called from a custom action.</p>
<ul>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiconfigureproducta"><strong>MsiConfigureProduct</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiconfigureproductexa"><strong>MsiConfigureProductEx</strong></a></li>
<li><a href="/windows/desktop/api/Msiquery/nf-msiquery-msicreatetransformsummaryinfoa"><strong>MsiCreateTransformSummaryInfo</strong></a></li>
<li><a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseapplytransforma"><strong>MsiDatabaseApplyTransform</strong></a></li>
<li><a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit"><strong>MsiDatabaseCommit</strong></a></li>
<li><a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta"><strong>MsiDatabaseExport</strong></a></li>
<li><a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabasegeneratetransforma"><strong>MsiDatabaseGenerateTransform</strong></a></li>
<li><a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta"><strong>MsiDatabaseImport</strong></a></li>
<li><a href="/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea"><strong>MsiDatabaseMerge</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msienableloga"><strong>MsiEnableLog</strong></a></li>
<li><a href="/windows/desktop/api/Msiquery/nf-msiquery-msienableuipreview"><strong>MsiEnableUIPreview</strong></a></li>
<li><a href="/windows/desktop/api/Msiquery/nf-msiquery-msigetdatabasestate"><strong>MsiGetDatabaseState</strong></a></li>
<li><a href="/windows/desktop/api/Msiquery/nf-msiquery-msiopendatabasea"><strong>MsiOpenDatabase</strong></a></li>
<li><a href="/windows/desktop/api/Msiquery/nf-msiquery-msipreviewbillboarda"><strong>MsiPreviewBillboard</strong></a></li>
<li><a href="/windows/desktop/api/Msiquery/nf-msiquery-msipreviewdialoga"><strong>MsiPreviewDialog</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msireinstallproducta"><strong>MsiReinstallProduct</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msisetexternaluia"><strong>MsiSetExternalUI</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msisetexternaluirecord"><strong>MsiSetExternalUIRecord</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msisetinternalui"><strong>MsiSetInternalUI</strong></a></li>
</ul>
<p>The following <a href="installer-function-reference.html">Installer Functions</a> must never be called from a custom action.</p>
<ul>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiapplypatcha"><strong>MsiApplyPatch</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msicollectuserinfoa"><strong>MsiCollectUserInfo</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiconfigurefeaturea"><strong>MsiConfigureFeature</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiconfigureproducta"><strong>MsiConfigureProduct</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiconfigureproductexa"><strong>MsiConfigureProductEx</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msienableloga"><strong>MsiEnableLog</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msigetfeatureinfoa"><strong>MsiGetFeatureInfo</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msigetproductcodea"><strong>MsiGetProductCode</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msigetproductpropertya"><strong>MsiGetProductProperty</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiinstallmissingcomponenta"><strong>MsiInstallMissingComponent</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiinstallmissingfilea"><strong>MsiInstallMissingFile</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiinstallproducta"><strong>MsiInstallProduct</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiopenpackagea"><strong>MsiOpenPackage</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiopenproducta"><strong>MsiOpenProduct</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea"><strong>MsiReinstallFeature</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msireinstallproducta"><strong>MsiReinstallProduct</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msisetexternaluia"><strong>MsiSetExternalUI</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msisetinternalui"><strong>MsiSetInternalUI</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiusefeaturea"><strong>MsiUseFeature</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiusefeatureexa"><strong>MsiUseFeatureEx</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiverifypackagea"><strong>MsiVerifyPackage</strong></a></li>
</ul>
<p>The following <a href="installer-function-reference.html">Installer Functions</a> must never be called from a custom action if doing so starts another installation. They may be called from a custom action that does not start another installation.</p>
<ul>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiprovidecomponenta"><strong>MsiProvideComponent</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiprovidequalifiedcomponenta"><strong>MsiProvideQualifiedComponent</strong></a></li>
<li><a href="/windows/desktop/api/Msi/nf-msi-msiprovidequalifiedcomponentexa"><strong>MsiProvideQualifiedComponentEx</strong></a></li>
</ul>
<p>A custom action should never spawn a new thread that uses Windows Installer functions to change the feature state, component state, or to send messages from a Control Event. Attempting to do this causes the installation to fail.</p>
<p>Â </p>
<p>Â </p>
</body>
