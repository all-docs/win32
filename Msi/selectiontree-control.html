<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SelectionTree Control</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This control enables a user to change the selection state of features listed in the Feature table.
ms.assetid: 0daf5b44-ba07-47f1-95d9-28c59f7cf985
title: SelectionTree Control
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>SelectionTree Control</h1>
<p>This control enables a user to change the selection state of features listed in the <a href="feature-table.html">Feature table</a>. The control is associated with a string valued property that the user can set by a <a href="browse-dialog.html">Browse dialog</a>. You can associate the control with a property by entering the property's name in the Property column of the <a href="control-table.html">Control table</a>.</p>
<p>The SelectionTree control automatically publishes the following <a href="control-events.html">Control Events</a> on WindowsÂ XP or earlier operating systems. The SelectionTree control publishes these events when the selected item is changed from one node to another. If the selection tree has no nodes, the control publishes these events and erases the contents of controls that subscribe to the event. These ControlEvents are not required to be listed in the <a href="controlevent-table.html">ControlEvent table</a>.</p>
<table>
<thead>
<tr>
<th>Control event</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="selectionaction-controlevent.html">SelectionAction</a></td>
<td>Publishes a string from the <a href="uitext-table.html">UIText table</a> describing the highlighted item.</td>
</tr>
<tr>
<td><a href="selectionbrowse-controlevent.html">SelectionBrowse</a></td>
<td>Generates a Browse dialog box used to modify the path of the highlighted item.</td>
</tr>
<tr>
<td><a href="selectiondescription-controlevent.html">SelectionDescription</a></td>
<td>Publishes a string from the <a href="feature-table.html">Feature table</a> describing the highlighted item.</td>
</tr>
<tr>
<td><a href="selectionnoitems-controlevent.html">SelectionNoItems</a></td>
<td>Deletes the descriptive text or disables the buttons of an obsolete item.</td>
</tr>
<tr>
<td><a href="selectionpath-controlevent.html">SelectionPath</a></td>
<td>Publishes the path for the highlighted item.</td>
</tr>
<tr>
<td><a href="selectionpathon-controlevent.html">SelectionPathOn</a></td>
<td>Publishes whether or not there is a selection path associated with the currently selected feature.</td>
</tr>
<tr>
<td><a href="selectionsize-controlevent.html">SelectionSize</a></td>
<td>Publishes the size of the highlighted item.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Beginning with the Windows ServerÂ 2003 systems, SelectionTree controls publish all of the events in the above table, and in addition, publish a <a href="doaction-controlevent.html">DoAction ControlEvent</a> or a <a href="setproperty-controlevent.html">SetProperty ControlEvent</a>. Records must be added to the <a href="controlevent-table.html">ControlEvent table</a> to publish DoAction or SetProperty ControlEvents.</p>
<table>
<thead>
<tr>
<th>Control event</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="doaction-controlevent.html">DoAction</a></td>
<td>Notifies the installer to execute a custom action.</td>
</tr>
<tr>
<td><a href="setproperty-controlevent.html">SetProperty</a></td>
<td>Sets a property to a new value.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Beginning with Windows Installer version 3.0, SelectionTree controls publish an event that runs <a href="custom-actions.html">custom actions</a> listed in the <a href="controlevent-table.html">ControlEvent table</a>. The SelectionTree control publishes this event whenever the feature selection changes in the control or whenever a different selection state is chosen for the current feature. The custom actions run each time the event is published. The SelectionTree control sends information to the custom action by setting the values of the following properties. All these properties are all cleared when the SelectionTree control is closed.</p>
<p><strong>Windows Installer 2.0:</strong> Not supported. The SelectionTree control does not publish the event and does not set the following properties.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>MsiSelectionTreeSelectedFeature</td>
<td>The selected feature's name in the Feature field of the <a href="feature-table.html">Feature table</a>.</td>
</tr>
<tr>
<td>MsiSelectionTreeSelectedAction</td>
<td>The selected feature's installation action state. The value may be INSTALLSTATE_ABSENT, INSTALLSTATE_LOCAL, INSTALLSTATE_SOURCE, or INSTALLSTATE_ADVERTISED.</td>
</tr>
<tr>
<td>MsiSelectonTreeChildrenCount</td>
<td>Number of direct child nodes.</td>
</tr>
<tr>
<td>MsiSelectionTreeInstallingChildrenCount</td>
<td>Number of direct child nodes that are INSTALLSTATE_LOCAL, INSTALLSTATE_SOURCE, or INSTALLSTATE_ADVERTISED.</td>
</tr>
<tr>
<td>MsiSelectionTreeSelectedCost</td>
<td>Cost of installing the selected feature in units of 512 bytes.</td>
</tr>
<tr>
<td>MsiSelectionTreeChildrenCost</td>
<td>Cost of installing all the children features in units of 512 bytes.</td>
</tr>
<tr>
<td>MsiSelectionTreeSelectedPath</td>
<td>Path where the selected feature is being installed. Defined only if the feature is being installed as INSTALLSTATE_LOCAL.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<blockquote>
<p>[!Note]</p>
<p>The contents of the Text field of the <a href="control-table.html">Control table</a> is never displayed by the SelectionTree control. Instead this field specifies the style of text to be displayed by the control and contains a description of the control used by screen review utilities. To set the font and font style of a text string, prefix the string of displayed characters with {\style} or {&amp;<em>style</em>}. Where style is an identifier listed in the TextStyle column of the <a href="textstyle-table.html">TextStyle table</a>. If neither of these are present, but the <a href="defaultuifont.html"><strong>DefaultUIFont</strong></a> property is defined as a valid text style, that font is used. The information following this is read by screen review utilities as the description of the control. See <a href="accessibility.html">Accessibility</a>.</p>
</blockquote>
<p>Â </p>
<h2>Control Attributes</h2>
<p>You can use the following attributes with this control. To change the value of an attribute using an event, subscribe the control to a ControlEvent in the <a href="eventmapping-table.html">EventMapping table</a> and list the attribute's identifier in the Attribute column. Enter the identifier of the ControlEvent in the Event column.</p>
<table>
<thead>
<tr>
<th>Attribute identifier</th>
<th>Hexadecimal bit</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="indirectpropertyname-control-attribute.html">IndirectPropertyName</a></td>
<td></td>
<td>Name of an indirect property associated with the control. If the Indirect attribute bit is set, the control displays or changes the value of the property having this name. If the Indirect attribute bit is set, this name is also the value of the property listed in the Property column of the <a href="control-table.html">Control table</a>.</td>
</tr>
<tr>
<td><a href="position-control-attribute.html">Position</a></td>
<td></td>
<td>Position of the control in the dialog box. Enter the control's width, height, and coordinates of the control's left corner into the Width, Height, X, and Y columns of the <a href="control-table.html">Control table</a>. Use <a href="installer-units.html">installer units</a> for length and distance.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="propertyname-control-attribute.html">PropertyName</a></td>
<td></td>
<td>Name of the property associated with this control. If the Indirect attribute bit is not set, the control displays or changes the value of the property having this name. This attribute is specified in the Property column of the <a href="control-table.html">Control table</a>.</td>
</tr>
<tr>
<td><a href="propertyvalue-control-attribute.html">PropertyValue</a></td>
<td></td>
<td>Current value of the property displayed or changed by this control. If the Indirect attribute bit is not set, this is the value of PropertyName. If the Indirect attribute bit is set, this is the value of IndirectPropertyName. If the attribute changes, the control reflects the new value.</td>
</tr>
<tr>
<td><a href="text-control-attribute.html">Text</a></td>
<td></td>
<td>Displays text in screenreaders according to text entered into the Text column of the <a href="control-table.html">Control table</a>. See <a href="accessibility.html">Accessibility</a>.</td>
</tr>
<tr>
<td><a href="visible-control-attribute.html">Visible</a></td>
<td>0x00000000 0x00000001<!-- raw HTML omitted --></td>
<td>Hidden control. Visible control.<!-- raw HTML omitted --> Include this bit in the bit word of the Attributes column in the <a href="control-table.html">Control table</a> to make the control visible or hidden upon its creation.<!-- raw HTML omitted --> You can also hide or show a control by using the <a href="controlcondition-table.html">ControlCondition table</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="enabled-control-attribute.html">Enabled</a></td>
<td>0x00000000 0x00000002<!-- raw HTML omitted --></td>
<td>Control in a disabled state. Control in an enabled state.<!-- raw HTML omitted --> Include this bit in the bit word in the Attributes column of the <a href="control-table.html">Control</a> to enable the control on creation.<!-- raw HTML omitted --> You can also enable or disable a control by using the <a href="controlcondition-table.html">ControlCondition table</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="sunken-control-attribute.html">Sunken</a></td>
<td>0x00000000 0x00000004<!-- raw HTML omitted --></td>
<td>Displays the default visual style. Displays the control with a sunken, 3D, look.<!-- raw HTML omitted --> Include these bits in the bit word in the Attributes column of the <a href="control-table.html">Control table</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="indirect-control-attribute.html">Indirect</a></td>
<td>0x00000000 0x00000008<!-- raw HTML omitted --></td>
<td>The control displays or changes the value of the property in the Property column of the <a href="control-table.html">Control table</a>. The control displays or changes the value of the property that has the Identifier listed in the Property column of the Control table.<!-- raw HTML omitted --> Determines if the property associated with this control is referenced indirectly.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="rtlro-control-attribute.html">RTLRO</a></td>
<td>0x00000000 0x00000020<!-- raw HTML omitted --></td>
<td>Text in the control is displayed in left-to-right reading order. Text in the control is displayed in right-to-left reading order.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="rightaligned-control-attribute.html">RightAligned</a></td>
<td>0x00000000 0x00000040<!-- raw HTML omitted --></td>
<td>Text in the control is aligned to the left. Text in the control is aligned to the right.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="leftscroll-control-attribute.html">LeftScroll</a></td>
<td>0x00000000 0x00000080<!-- raw HTML omitted --></td>
<td>The scroll bar is located on the right side of the control. The scroll bar is located on the left side of the control.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="bidi-control-attribute.html">BiDi</a></td>
<td>0x000000E0</td>
<td>Set this value for a combination of the <a href="rtlro-control-attribute.html">RTLRO</a>, <a href="rightaligned-control-attribute.html">RightAligned</a>, and <a href="leftscroll-control-attribute.html">LeftScroll</a> attributes.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>This control can be created from the WC_TREEVIEW class by using the <a href="/windows/win32/api/winuser/nf-winuser-createwindowexa"><strong>CreateWindowEx</strong></a> function. It has the <strong>WS_BORDER</strong>, <strong>TVS_HASLINES</strong>, <strong>TVS_HASBUTTONS</strong>, <strong>TVS_LINESATROOT</strong>, <strong>TVS_DISABLEDRAGDROP</strong>, <strong>TVS_SHOWSELALWAYS</strong>, <strong>WS_CHILD</strong>, <strong>WS_TABSTOP</strong>, and <strong>WS_GROUP</strong> styles.</p>
<p>The selection tree is only populated if the <a href="costinitialize-action.html">CostInitialize action</a> and <a href="costfinalize-action.html">CostFinalize action</a> have been called.</p>
<p>The following string in the <a href="uitext-table.html">UIText table</a> is related to this control.</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->AbsentPath<!-- raw HTML omitted --></td>
<td>The path displayed for an item in the absent state.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The following six strings are used to display the number of children selected and the size associated with the highlighted item:</p>
<ul>
<li>SelChildCostPos</li>
<li>SelChildCostNeg</li>
<li>SelParentCostPosPos</li>
<li>SelParentCostPosNeg</li>
<li>SelParentCostNegPos</li>
<li>SelParentCostNegNeg</li>
</ul>
<p>The following strings are used to display the available selection options for an item in a popup menu:</p>
<ul>
<li>MenuAbsent</li>
<li>MenuLocal</li>
<li>MenuCD</li>
<li>MenuNetwork</li>
<li>MenuAllLocal</li>
<li>MenuAllCD</li>
<li>MenuAllNetwork</li>
</ul>
<p>The following strings are used to explain the present selection in the <a href="selectiondescription-controlevent.html">SelectionDescription</a> ControlEvent.</p>
<ul>
<li>SelAbsentAbsent</li>
<li>SelAbsentLocal</li>
<li>SelAbsentCD</li>
<li>SelAbsentNetwork</li>
<li>SelLocalAbsent</li>
<li>SelLocalLocal</li>
<li>SelLocalCD</li>
<li>SelLocalNetwork</li>
<li>SelCDAbsent</li>
<li>SelNetworkAbsent</li>
<li>SelCDLocal</li>
<li>SelNetworkLocal</li>
<li>SelCDCD</li>
<li>SelNetworkNetwork</li>
</ul>
<p>The following four localized strings are used in formatting the size of a file:</p>
<ul>
<li>Bytes</li>
<li>KB</li>
<li>MB</li>
<li>GB</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
