<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Adding a Control Event at the End of the Installation to Run Launch</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The installer runs the sample's installation wizard sequence only if the full UI level is used to install the application.
ms.assetid: 323d62ae-333b-49fd-96a1-55b228c8ab2c
title: Adding a Control Event at the End of the Installation to Run Launch
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Adding a Control Event at the End of the Installation to Run Launch</h1>
<p>The installer runs the sample's installation wizard sequence only if the <a href="f-gly.html"><em>full UI</em></a> level is used to install the application. The last dialog box of the sample dialog sequence is an <a href="exit-dialog.html">Exit Dialog</a> named ExitDialog. When a user interacts with the OK button on ExitDialog, this first publishes an <a href="enddialog-controlevent.html">EndDialog ControlEvent</a> that returns control to the installer. The control then publishes a <a href="doaction-controlevent.html">DoAction ControlEvent</a> that runs the Launch custom action. Each control event requires a record in the <a href="controlevent-table.html">ControlEvent table</a>. See <a href="controlevent-overview.html">ControlEvent Overview</a>.</p>
<p><a href="controlevent-table.html">ControlEvent Table</a></p>
<table>
<thead>
<tr>
<th>Dialog</th>
<th>Control_</th>
<th>Event</th>
<th>Argument</th>
<th>Condition</th>
<th>Ordering</th>
</tr>
</thead>
<tbody>
<tr>
<td>ExitDialog</td>
<td>OK</td>
<td>EndDialog</td>
<td>Return</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>ExitDialog</td>
<td>OK</td>
<td>DoAction</td>
<td>Launch</td>
<td>NOT Installed AND $Tutorial=3</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The condition on the DoAction control ensures the custom action only runs during the first installation of the application and that it is being installed locally. The phrase $Tutorial=3 means the action state of the Tutorial component is set to local. See <a href="conditional-statement-syntax.html">Conditional Statement Syntax</a>.</p>
<p>This completes the sample.</p>
<p>Â </p>
<p>Â </p>
</body>
