<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Examples of Database Queries Using SQL and Script</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: An example of using script-driven database queries is provided in the Windows Installer Software Development Kit (SDK) as the utility WiRunSQL.vbs.
ms.assetid: aa38dbe5-411d-432e-b3fe-09994fc59c75
title: Examples of Database Queries Using SQL and Script
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Examples of Database Queries Using SQL and Script</h1>
<p>An example of using script-driven database queries is provided in the Windows <a href="platform-sdk-components-for-windows-installer-developers.html">Installer Software Development Kit</a> (SDK) as the utility WiRunSQL.vbs. This utility handles database queries using the Windows Installer version of SQL described in the section <a href="sql-syntax.html">SQL Syntax</a>.</p>
<p><strong>Delete a record from a table</strong></p>
<p>The following command line deletes the record having the primary key RED from the <a href="feature-table.html">Feature</a> table of the Test.msi database.</p>
<p><strong>Cscript WiRunSQL.vbs Test.msi &quot;DELETE FROM `Feature` WHERE `Feature`.`Feature`='RED'&quot;</strong></p>
<p><strong>Add a table to a database</strong></p>
<p>The following command line adds the <a href="directory-table.html">Directory</a> table to the Test.msi database.</p>
<p><strong>CScript WiRunSQL.vbs Test.msi &quot;CREATE TABLE `Directory` (`Directory` CHAR(72) NOT NULL, `Directory_Parent` CHAR(72), `DefaultDir` CHAR(255) NOT NULL LOCALIZABLE PRIMARY KEY `Directory`)&quot;</strong></p>
<p><strong>Remove a table from a database</strong></p>
<p>The following command line removes the <a href="feature-table.html">Feature</a> table from the Test.msi database.</p>
<p><strong>Cscript WiRunSQL.vbs Test.msi &quot;DROP TABLE `Feature`&quot;</strong></p>
<p><strong>Add a new column to a table</strong></p>
<p>The following command line adds the Test column to the <a href="customaction-table.html">CustomAction</a> table of the Test.msi database.</p>
<p><strong>CScript WiRunSQL.vbs Test.msi &quot;ALTER TABLE `CustomAction` ADD `Test` INTEGER&quot;</strong></p>
<p><strong>Insert a new record into a table</strong></p>
<p>The following command line inserts a new record into the <a href="feature-table.html">Feature</a> table of the Test.msi database.</p>
<p><strong>Cscript WiRunSQL.vbs Test.msi &quot;INSERT INTO `Feature` (`Feature`.`Feature`,`Feature`.`Feature_Parent`,`Feature`.`Title`,`Feature`.`Description`, `Feature`.`Display`,`Feature`.`Level`,`Feature`.`Directory_`,`Feature`.`Attributes`) VALUES ('Tennis','Sport','Tennis','Tournament',25,3,'SPORTDIR',2)&quot;</strong></p>
<p>This inserts the following record into the <a href="feature-table.html">Feature</a> table of Test.msi.</p>
<p><a href="feature-table.html">Feature</a> Table</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Feature_Parent</th>
<th>Title</th>
<th>Description</th>
<th>Display</th>
<th>Level</th>
<th>Directory_</th>
<th>Attributes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tennis</td>
<td>Sport</td>
<td>Tennis</td>
<td>Tournament</td>
<td>25</td>
<td>3</td>
<td>SPORTDIR</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Note that binary data cannot be inserted into a table directly using the INSERT INTO or UPDATE SQL queries. For information see <a href="adding-binary-data-to-a-table-using-sql.html">Adding Binary Data to a Table Using SQL</a>.</p>
<p><strong>Modify an existing record in a table</strong></p>
<p>The following command line changes the existing value in the Title field to &quot;Performances.&quot; The updated record has &quot;Arts&quot; as its primary key and is in the Feature table of the Test.msi database.</p>
<p><strong>Cscript WiRunSQL.vbs Test.msi &quot;UPDATE `Feature` SET `Feature`.`Title`='Performances' WHERE `Feature`.`Feature`='Arts'&quot;</strong></p>
<p><strong>Select a group of records</strong></p>
<p>The following command line selects the name and type of all controls that belong to the ErrorDialog in the Test.msi database.</p>
<p><strong>CScript WiRunSQL.vbs Test.msi &quot;SELECT `Control`, `Type` FROM `Control` WHERE `Dialog_`='ErrorDialog' &quot;</strong></p>
<p><strong>Hold a table in memory</strong></p>
<p>The following command line locks the <a href="component-table.html">Component</a> table of the Test.msi database in memory.</p>
<p><strong>CScript WiRunSQL.vbs Test.msi &quot;ALTER TABLE `Component` HOLD&quot;</strong></p>
<p><strong>Free a table in memory</strong></p>
<p>The following command line frees the <a href="component-table.html">Component</a> table of the Test.msi database from memory.</p>
<p><strong>CScript WiRunSQL.vbs Test.msi &quot;ALTER TABLE `Component` FREE&quot;</strong></p>
<p>Â </p>
<p>Â </p>
</body>
