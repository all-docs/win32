<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Custom Action Type 51</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Developers of Windows Installer packages may choose to use a custom action type 51 when the standard actions are insufficient to execute the installation.
ms.assetid: cdad16ad-426c-4e04-8003-b32c67be7329
title: Custom Action Type 51
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Custom Action Type 51</h1>
<p>This custom action sets a property from a formatted text string.</p>
<p>To affect a property used in a condition on a component or feature, the custom action must come before the <a href="costfinalize-action.html">CostFinalize action</a> in the action sequence.</p>
<h2>Source</h2>
<p>The Source field of the <a href="customaction-table.html">CustomAction table</a> can contain either the name of a property or a key to the <a href="property-table.html">Property table</a>. This property is set by the formatted string in the Target field using <a href="/windows/desktop/api/Msiquery/nf-msiquery-msisetpropertya"><strong>MsiSetProperty</strong></a>.</p>
<h2>Type Value</h2>
<p>Include the following value in the Type column of the <a href="customaction-table.html">CustomAction table</a> to specify the basic numeric type.</p>
<table>
<thead>
<tr>
<th>Constants</th>
<th>Hexadecimal</th>
<th>Decimal</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>msidbCustomActionTypeTextData</strong> + <strong>msidbCustomActionTypeProperty</strong></td>
<td>0x033</td>
<td>51</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Target</h2>
<p>The Target column of the <a href="customaction-table.html">CustomAction table</a> contains a text string formatted using the functionality specified in <a href="/windows/desktop/api/Msiquery/nf-msiquery-msiformatrecorda"><strong>MsiFormatRecord</strong></a> (without the numeric field specifiers). Parameters to be replaced are enclosed in square brackets, [â€¦], and may be properties, environment variables (% prefix), file paths (# prefix), or component directory paths ($ prefix).</p>
<h2>Return Processing Options</h2>
<p>The custom action does not use these options.</p>
<h2>Execution Scheduling Options</h2>
<p>Include optional flag bits in the Type column of the <a href="customaction-table.html">CustomAction table</a> to specify execution scheduling options. These options control the multiple execution of custom actions. For a description of the options, see <a href="custom-action-execution-scheduling-options.html">Custom Action Execution Scheduling Options</a>.</p>
<h2>In-Script Execution Options</h2>
<p>The custom action does not use these options.</p>
<h2>Return Values</h2>
<p>See <a href="custom-action-return-values.html">Custom Action Return Values</a>.</p>
<h2>Remarks</h2>
<p>If you set a <a href="private-properties.html">private property</a> in the UI sequence by authoring a custom action in one of the user interface sequence tables, that property is not set in the execution sequence. To set the property in the execution sequence, you must also put a custom action in an execution sequence table. Alternatively, you can make the property a <a href="public-properties.html">public property</a> and include it in the <a href="securecustomproperties.html"><strong>SecureCustomProperties property</strong></a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="custom-actions.html">Custom_Actions</a></p>
<!-- raw HTML omitted -->
<p><a href="formatted-text-custom-actions.html">Formatted Text Custom Actions</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
