<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Counters.Add method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Counters.Add method
description: Adds a CounterItem instance to the collection.
ms.assetid: 9daecfe6-c2a9-48af-8b59-4f81f0325535
keywords:</p>
<ul>
<li>Add method SysMon</li>
<li>Add method SysMon , Counters class</li>
<li>Counters class SysMon , Add method
topic_type:</li>
<li>apiref
api_name:</li>
<li>Counters.Add
api_location:</li>
<li>Sysmon.ocx
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Counters.Add method</h1>
<p>Adds a <a href="counteritem.html"><strong>CounterItem</strong></a> instance to the collection.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>Counters.Add( _
  ByVal pathname As String _
) As CounterItem
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>pathname</em> [in]</p>
<!-- raw HTML omitted -->
<p>Path to the counter. The path can include a machine name, and must include a performance object name, an object instance name if the specified performance object supports multiple instances, and a counter name. This path specification is not case-sensitive.</p>
<p>For details on specifying a counter path, see <a href="/windows/desktop/PerfCtrs/specifying-a-counter-path">Specifying a Counter Path</a>.</p>
<!-- raw HTML omitted -->
<h2>Exceptions</h2>
<table>
<thead>
<tr>
<th>Exception type</th>
<th>Condition</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->System.Runtime.InteropServices.COMException<!-- raw HTML omitted --></td>
<td>You can receive this exception for one of the following reasons:<!-- raw HTML omitted --><!-- raw HTML omitted -->The specified performance object was not found on the computer. The Err.Number value is 0xC0000BB8.<!-- raw HTML omitted --><!-- raw HTML omitted -->The specified counter could not be found. The Err.Number value is 0xC0000BB9.<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>If you specify a wildcard counter in the <em>pathname</em> parameter, the <strong>Add</strong> method creates one <a href="counteritem.html"><strong>CounterItem</strong></a> object for each expanded path. The <strong>Add</strong> method then returns a pointer to the first added <strong>CounterItem</strong>.</p>
<p>If the wildcard would result in a duplicate counter, the error is not reported and no duplicate is created. If an error condition occurs before all counters are created, the error is reported and the remaining counters are not created.</p>
<p>There is no limit to the number of counters that you can add; however, SYSMON will graph only the first 1,024 counters in the collection. There is no limit on the number of counters that SYSMON will display in a report.</p>
<p>To receive notification when a counter is added, implement the <a href="systemmonitor-oncounteradded.html">OnCounterAdded</a> event.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Sysmon.ocx<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="counteritem.html"><strong>CounterItem</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="counters.html"><strong>Counters</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="systemmonitor-browsecounters.html"><strong>SystemMonitor.BrowseCounters</strong></a></p>
<!-- raw HTML omitted -->
</body>
