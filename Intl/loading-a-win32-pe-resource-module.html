<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Loading a Win32 PE Resource Module</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This topic describes how the application loads a Win32 PE resource module on either WindowsÂ Vista and later or on an earlier operating system. Calls are included for releasing the resource module.
ms.assetid: c9f126a7-315a-4856-80b3-aec02402a80e
title: Loading a Win32 PE Resource Module
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Loading a Win32 PE Resource Module</h1>
<p>This topic describes how the application loads a Win32 PE resource module on either WindowsÂ Vista and later or on an earlier operating system. Calls are included for releasing the resource module.</p>
<h2>Load the Resource Module on Windows Vista and Later</h2>
<p>On WindowsÂ Vista and later, the application loads the resource module using a call to <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya"><strong>LoadLibrary</strong></a> or <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibraryexa"><strong>LoadLibraryEx</strong></a>. The recommended operation is to call this function with both flags specified. The following is an example of application code that loads a module based on system language settings.</p>
<pre lang="C++"><code>HMODULE hResModule = LoadLibraryEx(TEXT(&quot;Mymodule.dll&quot;), 0,
                                   LOAD_LIBRARY_AS_DATAFILE | LOAD_LIBRARY_AS_IMAGE_RESOURCE);
// ... insert code here to call resource loading functions ...
FreeLibrary(hResModule);
</code></pre>
<h2>Load the Resource Module on Pre-Windows Vista Operating Systems</h2>
<p>On pre-WindowsÂ Vista operating systems, the application loads a resource module based on a language setting that is compatible with the target operating system, as well as WindowsÂ Vista and later. For this type of module loading, the application must call the MUI functions <a href="/windows/desktop/api/Muiload/nf-muiload-loadmuilibrarya"><strong>LoadMUILibrary</strong></a> and <a href="/windows/desktop/api/Muiload/nf-muiload-freemuilibrary"><strong>FreeMUILibrary</strong></a>.</p>
<pre lang="C++"><code>#include &quot;MuiLoad.h&quot;
HMODULE hResModule = LoadMUILibrary(TEXT(&quot;Mymodule.dll&quot;), MUI_LANGUAGE_NAME, 0);
// ... insert code here to call resource loading functions ...
FreeMUILibrary(hResModule);
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="locating-win32-pe-resources.html">Locating Win32 PE Resources</a></p>
<!-- raw HTML omitted -->
<p><a href="mui-application-specific-settings-sample-vista.html">MUI: Application-Specific Settings Sample (Windows Vista)</a></p>
<!-- raw HTML omitted -->
<p><a href="mui-application-specific-settings-sample-pre-vista.html">MUI: Application-Specific Settings Sample (Pre-Windows Vista)</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
