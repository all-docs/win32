<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Shaping Engines</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Uniscribe uses multiple shaping engines that contain the layout knowledge for particular scripts.
ms.assetid: 3cdd18f3-51d3-4d1c-be31-f5709074cbe7
title: Using Shaping Engines
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using Shaping Engines</h1>
<p>Uniscribe uses multiple shaping engines that contain the layout knowledge for particular scripts. It also takes advantage of the OpenType layout shaping engine for handling font-specific script features, such as glyph generation, extent measurement, and word-breaking support. Uniscribe manages bidirectional character reordering using the Unicode bidirectional algorithm, and understands non-OpenType layout font formats for Arabic, Hebrew, and Thai shaping.</p>
<p>Since the exact code point ranges assigned to each shaping engine might vary, script numbers are not published, with the exception of SCRIPT_UNDEFINED. However, your application can test the attributes of scripts by calling the <a href="/windows/desktop/api/Usp10/nf-usp10-scriptgetproperties"><strong>ScriptGetProperties</strong></a> function, which accesses the global script properties table. The application can use the global script properties to help combine its own layout rules with the required shaping engine divisions.</p>
<p>The application accesses a shaping engine with a call to the <a href="/windows/desktop/api/Usp10/nf-usp10-scriptshape"><strong>ScriptShape</strong></a> function. All the complex script shaping engines, the digit shaping engines, and the ASCII shaping engines validate the font indicated in the device context handle before shaping. Complex scripts must be shaped using the script returned by the <a href="/windows/desktop/api/Usp10/nf-usp10-scriptitemize"><strong>ScriptItemize</strong></a> function in order to be legible. Other runs remain legible if shaped with SCRIPT_UNDEFINED specified in the <strong>eScript</strong> member of the <a href="/windows/win32/api/usp10/ns-usp10-script_analysis"><strong>SCRIPT_ANALYSIS</strong></a> structure, although they might lose typographic quality.</p>
<p><a href="/windows/desktop/api/Usp10/nf-usp10-scriptshape"><strong>ScriptShape</strong></a> returns 0 if successful, or USP_E_SCRIPT_NOT_IN_FONT if the font supplied by the application does not contain sufficient glyphs or shaping tables. If the application specifies SCRIPT_UNDEFINED and some characters are not supported by the font, the function still succeeds. In this case, the application should scan the glyph output buffer for the presence of missing glyphs. For strategies to deal with missing glyphs, see <a href="using-font-fallback.html">Using Font Fallback</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="using-uniscribe.html">Using Uniscribe</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
