<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>WM_IME_COMPOSITION message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Sent to an application when the IME changes composition status as a result of a keystroke. A window receives this message through its WindowProc function.
ms.assetid: 6de1c4c2-d910-487c-8b82-408cb6e02c44
title: WM_IME_COMPOSITION message (Winuser.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>WM_IME_COMPOSITION message</h1>
<p>Sent to an application when the IME changes composition status as a result of a keystroke. A window receives this message through its <a href="/windows/win32/api/winuser/nc-winuser-wndproc"><em>WindowProc</em></a> function.</p>
<pre lang="C++"><code>LRESULT CALLBACK WindowProc(
  HWND  hwnd,     
  WM_IME_COMPOSITION,   
  WPARAM wParam,
  LPARAM lParam          
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hwnd</em></p>
<!-- raw HTML omitted -->
<p>A handle to window.</p>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>DBCS character representing the latest change to the composition string.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>Value specifying how the composition string or character changed. This parameter can be one or more of the following values. For more information about these values, see <a href="ime-composition-string-values.html">IME Composition String Values</a>.</p>
<!-- raw HTML omitted -->
<p><strong>GCS_COMPATTR</strong></p>
<!-- raw HTML omitted -->
<p><strong>GCS_COMPCLAUSE</strong></p>
<!-- raw HTML omitted -->
<p><strong>GCS_COMPREADSTR</strong></p>
<!-- raw HTML omitted -->
<p><strong>GCS_COMPREADATTR</strong></p>
<!-- raw HTML omitted -->
<p><strong>GCS_COMPREADCLAUSE</strong></p>
<!-- raw HTML omitted -->
<p><strong>GCS_COMPSTR</strong></p>
<!-- raw HTML omitted -->
<p><strong>GCS_CURSORPOS</strong></p>
<!-- raw HTML omitted -->
<p><strong>GCS_DELTASTART</strong></p>
<!-- raw HTML omitted -->
<p><strong>GCS_RESULTCLAUSE</strong></p>
<!-- raw HTML omitted -->
<p><strong>GCS_RESULTREADCLAUSE</strong></p>
<!-- raw HTML omitted -->
<p><strong>GCS_RESULTREADSTR</strong></p>
<!-- raw HTML omitted -->
<p><strong>GCS_RESULTSTR</strong></p>
<!-- raw HTML omitted -->
<p>The <em>lParam</em> parameter can also have one or more of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CS_INSERTCHAR</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Insert the <em>wParam</em> composition character at the current insertion point. An application should display the composition character if it processes this message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CS_NOMOVECARET</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Do not move the caret position as a result of processing the message. For example, if an IME specifies a combination of CS_INSERTCHAR and CS_NOMOVECARET, the application should insert the specified character at the current caret position but should not move the caret to the next position. A subsequent WM_IME_COMPOSITION message with GCS_RESULTSTR will replace this character.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This message has no return value.</p>
<h2>Remarks</h2>
<p>An application should process this message if it displays composition characters itself. Otherwise, it should send the message to the IME window.</p>
<p>If the application has created an IME window, it should pass this message to that window. The <a href="/windows/desktop/api/winuser/nf-winuser-defwindowproca"><strong>DefWindowProc</strong></a>  function processes this message by passing it to the default IME window. The IME window processes this message by updating its appearance based on the change flag specified. An application can call <a href="/windows/desktop/api/Imm/nf-imm-immgetcompositionstringa"><strong>ImmGetCompositionString</strong></a> to retrieve the new composition status.</p>
<p>If none of the GCS_ values are set, the message indicates that the current composition has been canceled and applications that draw the composition string should delete the string.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winuser.h (include Windows.h); <!-- raw HTML omitted --> <!-- raw HTML omitted -->Imm.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="input-method-manager.html">Input Method Manager</a></p>
<!-- raw HTML omitted -->
<p><a href="input-method-manager-messages.html">Input Method Manager Messages</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Imm/nf-imm-immgetcompositionstringa"><strong>ImmGetCompositionString</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
