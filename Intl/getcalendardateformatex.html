<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GetCalendarDateFormatEx function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Deprecated.
ms.assetid: eb2622bc-a98d-42bd-ab59-7a849000d79d
title: GetCalendarDateFormatEx function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>GetCalendarDateFormatEx
api_type:</li>
<li>DllExport
api_location:</li>
<li>Kernel32.dll</li>
<li>API-MS-Win-Core-calendar-l1-1-0.dll</li>
<li>kernel32legacy.dll</li>
</ul>
<hr />
<h1>GetCalendarDateFormatEx function</h1>
<p>Deprecated. Retrieves a properly formatted date string for the specified locale using the specified date and calendar. The user can specify the short date format, the long date format, the year month format, or a custom format pattern.</p>
<blockquote>
<p>[!Note]<br />
This function can retrieve data that changes between releases, for example, due to a custom locale. If your application must persist or transmit data, see <a href="using-persistent-locale-data.html">Using Persistent Locale Data</a>.</p>
</blockquote>
<p>Â </p>
<h2>Syntax</h2>
<pre lang="C++"><code>BOOL GetCalendarDateFormatEx(
  _In_Â Â Â Â Â Â Â Â LPCWSTR Â Â Â Â Â Â lpszLocale,
  _In_Â Â Â Â Â Â Â Â DWORD Â Â Â Â Â Â Â Â dwFlags,
  _In_Â Â const LPCALDATETIME lpCalDateTime,
  _In_Â Â Â Â Â Â Â Â LPCWSTR Â Â Â Â Â Â lpFormat,
  _Out_Â Â Â Â Â Â Â LPWSTR Â Â Â Â Â Â Â lpDateStr,
  _In_Â Â Â Â Â Â Â Â int Â Â Â Â Â Â Â Â Â Â cchDate
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>lpszLocale</em> [in]</p>
<!-- raw HTML omitted -->
<p>Pointer to a locale name, or one of the following predefined values.</p>
<ul>
<li><a href="locale-name-constants.html">LOCALE_NAME_INVARIANT</a></li>
<li><a href="locale-name-constants.html">LOCALE_NAME_SYSTEM_DEFAULT</a></li>
<li><a href="locale-name-constants.html">LOCALE_NAME_USER_DEFAULT</a></li>
</ul>
<!-- raw HTML omitted -->
<p><em>dwFlags</em> [in]</p>
<!-- raw HTML omitted -->
<p>Flags specifying date format options. If <em>lpFormat</em> is not set to <strong>NULL</strong>, this parameter must be set to 0. If <em>lpFormat</em> is set to <strong>NULL</strong>, the application can specify a combination of the following values and <a href="locale-nouseroverride.html">LOCALE_NOUSEROVERRIDE</a>.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DATE_SHORTDATE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Use the short date format. This is the default. This value cannot be used with DATE_LONGDATE or DATE_YEARMONTH. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DATE_LONGDATE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Use the long date format. This value cannot be used with DATE_SHORTDATE or DATE_YEARMONTH. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DATE_YEARMONTH</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Use the year/month format. This value cannot be used with DATE_SHORTDATE or DATE_LONGDATE.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DATE_LTRREADING</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Add marks for left-to-right reading layout. This value cannot be used with DATE_RTLREADING.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DATE_RTLREADING</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Add marks for right-to-left reading layout. This value cannot be used with DATE_LTRREADING<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>lpCalDateTime</em> [in]</p>
<!-- raw HTML omitted -->
<p>Pointer to a <a href="caldatetime.html"><strong>CALDATETIME</strong></a> structure that contains the date and calendar information to format.</p>
<!-- raw HTML omitted -->
<p><em>lpFormat</em> [in]</p>
<!-- raw HTML omitted -->
<p>Pointer to a format picture string that is used to form the date string. Possible values for the format picture string are defined in <a href="day--month--year--and-era-format-pictures.html">Day, Month, Year, and Era Format Pictures</a>.</p>
<p>The format picture string must be null-terminated. The function uses the locale only for information not specified in the format picture string, for example, the day and month names for the locale. The application sets this parameter to <strong>NULL</strong> if the function is to use the date format of the specified locale.</p>
<!-- raw HTML omitted -->
<p><em>lpDateStr</em> [out]</p>
<!-- raw HTML omitted -->
<p>Pointer to a buffer in which this function receives the formatted date string.</p>
<!-- raw HTML omitted -->
<p><em>cchDate</em> [in]</p>
<!-- raw HTML omitted -->
<p>Size, in characters, of the <em>lpDateStr</em> buffer. Alternatively, the application can set this parameter to 0. In this case, the function returns the number of characters required to hold the formatted date string, and the <em>lpDateStr</em> parameter is not used.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns the number of characters written to the <em>lpDateStr</em> buffer if successful. If the <em>cchDate</em> parameter is set to 0, the function returns the number of characters required to hold the formatted date string, including the terminating null character.</p>
<p>This function returns 0 if it does not succeed. To get extended error information, the application can call <a href="/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a>, which can return one of the following error codes:</p>
<ul>
<li>ERROR_DATE_OUT_OF_RANGE. The specified date was out of range.</li>
<li>ERROR_INSUFFICIENT_BUFFER. A supplied buffer size was not large enough, or it was incorrectly set to <strong>NULL</strong>.</li>
<li>ERROR_INVALID_FLAGS. The values supplied for flags were not valid.</li>
<li>ERROR_INVALID_PARAMETER. Any of the parameter values was invalid.</li>
</ul>
<h2>Remarks</h2>
<p>The earliest date supported by this function is January 1, 1601.</p>
<p>This function does not have an associated header file or library file. The application can call <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya"><strong>LoadLibrary</strong></a> with the DLL name (Kernel32.dll) to obtain a module handle. It can then call <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress"><strong>GetProcAddress</strong></a> with that module handle and the name of this function to get the function address.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Kernel32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="national-language-support.html">National Language Support</a></p>
<!-- raw HTML omitted -->
<p><a href="national-language-support-functions.html">National Language Support Functions</a></p>
<!-- raw HTML omitted -->
<p><a href="day--month--year--and-era-format-pictures.html">Day, Month, Year, and Era Format Pictures</a></p>
<!-- raw HTML omitted -->
<p><a href="nls--name-based-apis-sample.html">NLS: Name-based APIs Sample</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Winnls/nf-winnls-enumdateformatsexex"><strong>EnumDateFormatsExEx</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/datetimeapi/nf-datetimeapi-getdateformata"><strong>GetDateFormat</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/datetimeapi/nf-datetimeapi-getdateformatex"><strong>GetDateFormatEx</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="caldatetime.html"><strong>CALDATETIME</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
