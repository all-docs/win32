<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Complex Script Processing</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: 'The following are options for display and related processing of text to support fine typography effects or complex scripts: Text functionsEdit controlsRich edit controlsUniscribe'
ms.assetid: 337bc798-e75d-4389-8fea-577eb82a0ed5
title: Complex Script Processing
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Complex Script Processing</h1>
<p>The following are options for display and related processing of text to support fine typography effects or complex scripts:</p>
<ul>
<li>Text functions</li>
<li>Edit controls</li>
<li>Rich edit controls</li>
<li>Uniscribe</li>
</ul>
<p>The options you choose depend on the following factors:</p>
<ul>
<li>The type of text or scripts.</li>
<li>The implementation model, for example, the text layout and handling of line breaking by the application.</li>
<li>Update of an existing application versus creation of a new application.</li>
</ul>
<p>In general, an application that does relatively simple script processing can choose any option for processing complex scripts. However, for the most complete control of complex script processing, Uniscribe is recommended.</p>
<h2>Complex Script Processing Using Text Functions</h2>
<p>Applications that use mostly plain text, that is, text that uses the same typeface, weight, color, and so on, have traditionally written text and measured line lengths using standard text functions, such as <a href="/windows/win32/api/wingdi/nf-wingdi-textouta"><strong>TextOut</strong></a>, <a href="/windows/win32/api/wingdi/nf-wingdi-exttextouta"><strong>ExtTextOut</strong></a>, <a href="/windows/win32/api/winuser/nf-winuser-tabbedtextouta"><strong>TabbedTextOut</strong></a>, <a href="/windows/win32/api/winuser/nf-winuser-drawtext"><strong>DrawText</strong></a>, and <a href="/windows/win32/api/wingdi/nf-wingdi-gettextextentexpointa"><strong>GetTextExtentExPoint</strong></a>. These functions support processing for complex scripts and fine typography effects. For more information, see <a href="../gdi/fonts-and-text.html">Fonts and Text</a>.</p>
<p>In general, the standard text support is transparent to applications processing complex scripts. However, you should be aware of some specific rules to follow in writing applications that support fine typography and process complex scripts:</p>
<ul>
<li>Your application should save characters in a buffer and display a whole line of text at one time instead of, for example, calling <a href="/windows/win32/api/wingdi/nf-wingdi-exttextouta"><strong>ExtTextOut</strong></a> on each character as it is typed in by the user. This mechanism allows the advanced text shaping modules to use context to reorder and generate <a href="uniscribe-glossary.html">glyphs</a> correctly.</li>
<li>The application should use <a href="/windows/win32/api/wingdi/nf-wingdi-gettextextentexpointa"><strong>GetTextExtentExPoint</strong></a> to determine line length, instead of computing line lengths from cached character widths, since the width of a glyph can vary by context.</li>
<li>The application should optionally add support for right-to-left reading order and right alignment.</li>
<li>The reordering and contextual processing required for complex scripts or fine typography requires a significant increase in processing over basic text display for simple scripts. Therefore, to avoid performance issues, your application should not process large amounts of text before displaying results and returning control to the user.</li>
</ul>
<h2>Complex Script Processing Using Edit Controls</h2>
<p>The standard Windows edit controls have been extended to support multilingual text and complex scripts. The extended support includes input and display, as well as correct cursor movement over character clusters, for example, in Thai and Devanagari scripts. For more information, see <a href="../controls/edit-controls.html">Edit Controls</a>.</p>
<h2>Complex Script Processing Using Rich Edit Controls</h2>
<p>Rich Edit 3.0 is a higher-level collection of interfaces that takes advantage of Uniscribe to insulate text layout applications from the complexities of certain scripts. Rich Edit is the simplest way for applications to display complex scripts even though their primary purpose is not necessarily text layout. Rich Edit provides fast, versatile editing of rich Unicode multilingual text and simple plain text. It includes extensive message and COM interfaces, text editing, formatting, line breaking, simple table layout, vertical text layout, bidirectional text layout, Indic and Thai support, an editing user interface much like Microsoft Word, and Text Object Model interfaces.</p>
<p>Along with the Rich Edit interfaces, applications can use the Rich Edit <a href="/windows/win32/api/wingdi/nf-wingdi-textouta"><strong>TextOut</strong></a> function to automatically parse, shape, position, and break lines. For more information, see <a href="../controls/rich-edit-controls.html">Rich Edit Controls</a>.</p>
<h2>Complex Script Processing Using Uniscribe</h2>
<p><a href="uniscribe.html">Uniscribe</a> provides the most extensive support for processing of text involving fine typography effects and complex scripts. It supports the complex rules found in scripts such as Arabic, Devanagari, and Thai. It handles scripts written from right to left, such as Arabic and Hebrew, and supports the mixing of scripts. Uniscribe also exposes <a href="opentype-font-format.html">OpenType</a> font features that can be used by applications to control fine typography effects. For more information, see <a href="processing-complex-scripts.html">Processing Complex Scripts</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="about-uniscribe.html">About Uniscribe</a></p>
<!-- raw HTML omitted -->
<p><a href="processing-complex-scripts.html">Processing Complex Scripts</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
