<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Windows-Format Metafiles</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Microsoft Windows-format metafiles are limited in their capabilities and should rarely be used.
ms.assetid: ebbf871b-cf78-4a90-8f27-e44699c17178
title: Windows-Format Metafiles
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Windows-Format Metafiles</h1>
<p>Microsoft Windows-format metafiles are limited in their capabilities and should rarely be used. The Windows-format functions are supported to maintain backward compatibility with applications that were written to run as 16 bit Windows-based applications. Instead, you should use the enhanced-format functions.</p>
<p>A <em>Windows-format metafile</em> is used by 16-bit Windows-based applications. The format consists of a header and an array of metafile records.</p>
<p>The following are the limitations of this format:</p>
<ul>
<li>A Windows-format metafile is application and device dependent. Changes in the application's mapping modes or the device resolution affect the appearance of metafiles created in this format.</li>
<li>A Windows-format metafile does not contain a comprehensive header that describes the original picture dimensions, the resolution of the device on which the picture was created, an optional text description, or an optional palette.</li>
<li>A Windows-format metafile does not support the new curve, path, and transformation functions. See the list of supported functions in the table that follows.</li>
<li>Some Windows-format metafile records cannot be scaled.</li>
<li>The metafile device context associated with a Windows-format metafile cannot be queried (that is, an application cannot retrieve device-resolution data, font metrics, and so on).</li>
</ul>
<p>The following are the only functions that are supported by Windows-format metafiles.</p>
<table>
<thead>
<tr>
<th> </th>
<th> </th>
<th> </th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wingdi/nf-wingdi-animatepalette"><strong>AnimatePalette</strong></a><a href="/windows/desktop/api/Wingdi/nf-wingdi-arc"><strong>Arc</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-bitblt"><strong>BitBlt</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-chord"><strong>Chord</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-createbrushindirect"><strong>CreateBrushIndirect</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-createdibpatternbrush"><strong>CreateDIBPatternBrush</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta"><strong>CreateFontIndirect</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-createpalette"><strong>CreatePalette</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-createpatternbrush"><strong>CreatePatternBrush</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-createpenindirect"><strong>CreatePenIndirect</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-deleteobject"><strong>DeleteObject</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-ellipse"><strong>Ellipse</strong></a><!-- raw HTML omitted --> <a href="/windows/win32/api/wingdi/nf-wingdi-escape"><strong>Escape</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-excludecliprect"><strong>ExcludeClipRect</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-extfloodfill"><strong>ExtFloodFill</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-exttextouta"><strong>ExtTextOut</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-fillrgn"><strong>FillRgn</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-floodfill"><strong>FloodFill</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-framergn"><strong>FrameRgn</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-intersectcliprect"><strong>IntersectClipRect</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-invertrgn"><strong>InvertRgn</strong></a><!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Wingdi/nf-wingdi-lineto"><strong>LineTo</strong></a><a href="/windows/desktop/api/Wingdi/nf-wingdi-movetoex"><strong>MoveToEx</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-offsetcliprgn"><strong>OffsetClipRgn</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-offsetviewportorgex"><strong>OffsetViewportOrgEx</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-offsetwindoworgex"><strong>OffsetWindowOrgEx</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-paintrgn"><strong>PaintRgn</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-patblt"><strong>PatBlt</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-pie"><strong>Pie</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-polygon"><strong>Polygon</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-polyline"><strong>Polyline</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-polypolygon"><strong>PolyPolygon</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-realizepalette"><strong>RealizePalette</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-rectangle"><strong>Rectangle</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-resizepalette"><strong>ResizePalette</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-restoredc"><strong>RestoreDC</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-roundrect"><strong>RoundRect</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-savedc"><strong>SaveDC</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-scaleviewportextex"><strong>ScaleViewportExtEx</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-scalewindowextex"><strong>ScaleWindowExtEx</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-selectcliprgn"><strong>SelectClipRgn</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-selectobject"><strong>SelectObject</strong></a><!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/Wingdi/nf-wingdi-selectpalette"><strong>SelectPalette</strong></a><a href="/windows/desktop/api/Wingdi/nf-wingdi-setbkcolor"><strong>SetBkColor</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-setbkmode"><strong>SetBkMode</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice"><strong>SetDIBitsToDevice</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-setmapmode"><strong>SetMapMode</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-setmapperflags"><strong>SetMapperFlags</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-setpaletteentries"><strong>SetPaletteEntries</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-setpixel"><strong>SetPixel</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-setpolyfillmode"><strong>SetPolyFillMode</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-setrop2"><strong>SetROP2</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-setstretchbltmode"><strong>SetStretchBltMode</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-settextalign"><strong>SetTextAlign</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-settextcharacterextra"><strong>SetTextCharacterExtra</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-settextcolor"><strong>SetTextColor</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-settextjustification"><strong>SetTextJustification</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-setviewportorgex"><strong>SetViewportOrgEx</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-setwindowextex"><strong>SetWindowExtEx</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-setwindoworgex"><strong>SetWindowOrgEx</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-stretchblt"><strong>StretchBlt</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-stretchdibits"><strong>StretchDIBits</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Wingdi/nf-wingdi-textouta"><strong>TextOut</strong></a><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<blockquote>
<p>[!NOTE]
To convert a Windows-format metafile to an enhanced-format metafile, call the <a href="/windows/desktop/api/Wingdi/nf-wingdi-getmetafilebitsex"><strong>GetMetaFileBitsEx</strong></a> function to retrieve the data from the Windows-format metafile and then call the <a href="/windows/desktop/api/Wingdi/nf-wingdi-setwinmetafilebits"><strong>SetWinMetaFileBits</strong></a> function to convert this data into an enhanced-format metafile. To convert an enhanced-format record into a Windows-format record, call the <a href="/windows/desktop/api/Wingdi/nf-wingdi-getwinmetafilebits"><strong>GetWinMetaFileBits</strong></a> function.</p>
</blockquote>
</body>
