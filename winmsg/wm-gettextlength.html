<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>WM_GETTEXTLENGTH message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Determines the length, in characters, of the text associated with a window.
ms.assetid: 9e185435-a624-4380-adfd-be4f3645ee5d
title: WM_GETTEXTLENGTH message (Winuser.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>WM_GETTEXTLENGTH message</h1>
<p>Determines the length, in characters, of the text associated with a window.</p>
<pre lang="C++"><code>#define WM_GETTEXTLENGTH                0x000E
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>This parameter is not used and must be zero.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>This parameter is not used and must be zero.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>LRESULT</strong></p>
<p>The return value is the length of the text in characters, not including the terminating null character.</p>
<h2>Remarks</h2>
<p>For an edit control, the text to be copied is the content of the edit control. For a combo box, the text is the content of the edit control (or static-text) portion of the combo box. For a button, the text is the button name. For other windows, the text is the window title. To determine the length of an item in a list box, an application can use the <a href="../controls/lb-gettextlen.html"><strong>LB_GETTEXTLEN</strong></a> message.</p>
<p>When the <strong>WM_GETTEXTLENGTH</strong> message is sent, the <a href="/windows/desktop/api/winuser/nf-winuser-defwindowproca"><strong>DefWindowProc</strong></a> function returns the length, in characters, of the text. Under certain conditions, the <strong>DefWindowProc</strong> function returns a value that is larger than the actual length of the text. This occurs with certain mixtures of ANSI and Unicode, and is due to the system allowing for the possible existence of double-byte character set (DBCS) characters within the text. The return value, however, will always be at least as large as the actual length of the text; you can thus always use it to guide buffer allocation. This behavior can occur when an application uses both ANSI functions and common dialogs, which use Unicode.</p>
<p>To obtain the exact length of the text, use the <a href="wm-gettext.html"><strong>WM_GETTEXT</strong></a>, <a href="../controls/lb-gettext.html"><strong>LB_GETTEXT</strong></a>, or <a href="../controls/cb-getlbtext.html"><strong>CB_GETLBTEXT</strong></a> messages, or the <a href="/windows/win32/api/winuser/nf-winuser-getwindowtexta"><strong>GetWindowText</strong></a> function.</p>
<p>Sending a <strong>WM_GETTEXTLENGTH</strong> message to a non-text static control, such as a static bitmap or static icon controlc, does not return a string value. Instead, it returns zero.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winuser.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/winuser/nf-winuser-defwindowproca"><strong>DefWindowProc</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/winuser/nf-winuser-getwindowtexta"><strong>GetWindowText</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/winuser/nf-winuser-getwindowtextlengtha"><strong>GetWindowTextLength</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="wm-gettext.html"><strong>WM_GETTEXT</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="windows.html">Windows</a></p>
<!-- raw HTML omitted -->
<p><strong>Other Resources</strong></p>
<!-- raw HTML omitted -->
<p><a href="../controls/cb-getlbtext.html"><strong>CB_GETLBTEXT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="../controls/lb-gettext.html"><strong>LB_GETTEXT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="../controls/lb-gettextlen.html"><strong>LB_GETTEXTLEN</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
