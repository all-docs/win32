<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ShellProc function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>UID:
title: ShellProc callback function
description: The function receives notifications of Shell events from the system.
old-location:
ms.assetid: na
ms.date: 04/05/2019
ms.keywords:
ms.topic: reference
req.header:
req.include-header:
req.target-type: Windows
req.target-min-winverclnt:
req.target-min-winversvr:
req.kmdf-ver:
req.umdf-ver:
req.ddi-compliance:
req.unicode-ansi:
req.idl:
req.max-support:
req.namespace:
req.assembly:
req.type-library:
req.lib:
req.dll:
req.irql:
topic_type:</p>
<ul>
<li>APIRef
api_type:
api_location:
api_name:
targetos: Windows
req.typenames:
req.redist:</li>
</ul>
<hr />
<h1>ShellProc function</h1>
<h2>Description</h2>
<p>An application-defined or library-defined callback function used with the <a href="/windows/win32/api/winuser/nf-winuser-setwindowshookexa"><strong>SetWindowsHookExA</strong></a>/<a href="/windows/win32/api/winuser/nf-winuser-setwindowshookexw"><strong>SetWindowsHookExW</strong></a> function. The function receives notifications of Shell events from the system.</p>
<p>The <strong>HOOKPROC</strong> type defines a pointer to this callback function. <em>ShellProc</em> is a placeholder for the application-defined or library-defined function name.</p>
<pre lang="cpp"><code>LRESULT CALLBACK ShellProc(
  _In_ int    nCode,
  _In_ WPARAM wParam,
  _In_ LPARAM lParam
);
</code></pre>
<h2>Parameters</h2>
<h3>nCode [in]</h3>
<p>Type: <strong>int</strong></p>
<p>The hook code.</p>
<p>If <em>nCode</em> is less than zero, the hook procedure must pass the message to the <a href="/windows/desktop/api/winuser/nf-winuser-callnexthookex"><strong>CallNextHookEx</strong></a> function without further processing and should return the value returned by <strong>CallNextHookEx</strong>.</p>
<p>This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>HSHELL_ACCESSIBILITYSTATE</strong> 11</td>
<td>The accessibility state has changed.</td>
</tr>
<tr>
<td><strong>HSHELL_ACTIVATESHELLWINDOW</strong> 3</td>
<td>The shell should activate its main window.</td>
</tr>
<tr>
<td><strong>HSHELL_APPCOMMAND</strong> 12</td>
<td>The user completed an input event (for example, pressed an application command button on the mouse or an application command key on the keyboard), and the application did not handle the <a href="/windows/desktop/inputdev/wm-appcommand">WM_APPCOMMAND</a> message generated by that input. If the Shell procedure handles the <a href="/windows/desktop/menurc/wm-command">WM_COMMAND</a> message, it should not call <strong>CallNextHookEx</strong>. See the Return Value section for more information.</td>
</tr>
<tr>
<td><strong>HSHELL_GETMINRECT</strong> 5</td>
<td>A window is being minimized or maximized. The system needs the coordinates of the minimized rectangle for the window.</td>
</tr>
<tr>
<td><strong>HSHELL_LANGUAGE</strong> 8</td>
<td>Keyboard language was changed or a new keyboard layout was loaded.</td>
</tr>
<tr>
<td><strong>HSHELL_REDRAW</strong> 6</td>
<td>The title of a window in the task bar has been redrawn.</td>
</tr>
<tr>
<td><strong>HSHELL_TASKMAN</strong> 7</td>
<td>The user has selected the task list. A shell application that provides a task list should return <strong>TRUE</strong> to prevent Windows from starting its task list.</td>
</tr>
<tr>
<td><strong>HSHELL_WINDOWACTIVATED</strong> 4</td>
<td>The activation has changed to a different top-level, unowned window.</td>
</tr>
<tr>
<td><strong>HSHELL_WINDOWCREATED</strong> 1</td>
<td>A top-level, unowned window has been created. The window exists when the system calls this hook.</td>
</tr>
<tr>
<td><strong>HSHELL_WINDOWDESTROYED</strong> 2</td>
<td>A top-level, unowned window is about to be destroyed. The window still exists when the system calls this hook.</td>
</tr>
<tr>
<td><strong>HSHELL_WINDOWREPLACED</strong> 13</td>
<td>A top-level window is being replaced. The window exists when the system calls this hook.</td>
</tr>
</tbody>
</table>
<h3>wParam [in]</h3>
<p>Type: <strong>WPARAM</strong></p>
<p>This parameter depends on the value of the <em>nCode</em> parameter, as shown in the following table.</p>
<table>
<thead>
<tr>
<th>nCode</th>
<th>wParam</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>HSHELL_ACCESSIBILITYSTATE</strong></td>
<td>Indicates which accessibility feature has changed state. This value is one of the following: <strong>ACCESS_FILTERKEYS</strong>, <strong>ACCESS_MOUSEKEYS</strong>, or <strong>ACCESS_STICKYKEYS</strong>.</td>
</tr>
<tr>
<td><strong>HSHELL_APPCOMMAND</strong></td>
<td>Indicates where the <strong>WM_APPCOMMAND</strong> message was originally sent; for example, the handle to a window. For more information, see cmd parameter in <strong>WM_APPCOMMAND</strong>.</td>
</tr>
<tr>
<td><strong>HSHELL_GETMINRECT</strong></td>
<td>A handle to the minimized or maximized window.</td>
</tr>
<tr>
<td><strong>HSHELL_LANGUAGE</strong></td>
<td>A handle to the window.</td>
</tr>
<tr>
<td><strong>HSHELL_REDRAW</strong></td>
<td>A handle to the redrawn window.</td>
</tr>
<tr>
<td><strong>HSHELL_WINDOWACTIVATED</strong></td>
<td>A handle to the activated window.</td>
</tr>
<tr>
<td><strong>HSHELL_WINDOWCREATED</strong></td>
<td>A handle to the created window.</td>
</tr>
<tr>
<td><strong>HSHELL_WINDOWDESTROYED</strong></td>
<td>A handle to the destroyed window.</td>
</tr>
<tr>
<td><strong>HSHELL_WINDOWREPLACED</strong></td>
<td>A handle to the window being replaced. Windows 2000:  Not supported.</td>
</tr>
</tbody>
</table>
<h3>lParam [in]</h3>
<p>Type: <strong>LPARAM</strong></p>
<p>This parameter depends on the value of the <em>nCode</em> parameter, as shown in the following table.</p>
<table>
<thead>
<tr>
<th>nCode</th>
<th>lParam</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>HSHELL_APPCOMMAND</strong></td>
<td><code>GET_APPCOMMAND_LPARAM(lParam)</code> is the application command corresponding to the input event. <code>GET_DEVICE_LPARAM(lParam)</code> indicates what generated the input event; for example, the mouse or keyboard. For more information, see the <em>uDevice</em> parameter description under <strong>WM_APPCOMMAND</strong>. <code>GET_FLAGS_LPARAM(lParam)</code> depends on the value of <em>cmd</em> in <strong>WM_APPCOMMAND</strong>. For example, it might indicate which virtual keys were held down when the <strong>WM_APPCOMMAND</strong> message was originally sent. For more information, see the <em>dwCmdFlags</em> description parameter under <strong>WM_APPCOMMAND</strong>.</td>
</tr>
<tr>
<td><strong>HSHELL_GETMINRECT</strong></td>
<td>A pointer to a <a href="/windows/win32/api/windef/ns-windef-rect">RECT</a> structure.</td>
</tr>
<tr>
<td><strong>HSHELL_LANGUAGE</strong></td>
<td>A handle to a keyboard layout.</td>
</tr>
<tr>
<td><strong>HSHELL_MONITORCHANGED</strong></td>
<td>A handle to the window that moved to a different monitor.</td>
</tr>
<tr>
<td><strong>HSHELL_REDRAW</strong></td>
<td>The value is <strong>TRUE</strong> if the window is flashing, or <strong>FALSE</strong> otherwise.</td>
</tr>
<tr>
<td><strong>HSHELL_WINDOWACTIVATED</strong></td>
<td>The value is TRUE if the window is in full-screen mode, or <strong>FALSE</strong> otherwise.</td>
</tr>
<tr>
<td><strong>HSHELL_WINDOWREPLACED</strong></td>
<td>A handle to the new window. Windows 2000:  Not supported.</td>
</tr>
</tbody>
</table>
<h2>Returns</h2>
<p>Type: <strong>LRESULT</strong></p>
<p>The return value should be zero unless the value of <em>nCode</em> is <strong>HSHELL_APPCOMMAND</strong> and the shell procedure handles the <a href="/windows/win32/menurc/wm-command"><strong>WM_COMMAND</strong></a> message. In this case, the return should be nonzero.</p>
<h2>Remarks</h2>
<p>Install this hook procedure by specifying the <a href="about-hooks.html">WH_SHELL</a> hook type and a pointer to the hook procedure in a call to the <strong>SetWindowsHookEx</strong> function.</p>
<h2>See also</h2>
<p><a href="/windows/desktop/api/winuser/nf-winuser-callnexthookex">CallNextHookEx</a></p>
<p><a href="/windows/desktop/api/winuser/nf-winuser-sendmessage">SendMessage</a></p>
<p><a href="/windows/desktop/api/winuser/nf-winuser-setwindowshookexw">SetWindowsHookEx</a></p>
<p><a href="/windows/desktop/inputdev/wm-appcommand">WM_APPCOMMAND</a></p>
<p><a href="/windows/desktop/menurc/wm-command">WM_COMMAND</a></p>
<p><a href="hooks.html">Hooks</a></p>
</body>
