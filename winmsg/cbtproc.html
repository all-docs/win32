<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CBTProc callback function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: CBTProc callback function (Windows)
description: Receive useful notifications from the system.
ms.date: 06/27/2023
f1_keywords:</p>
<ul>
<li>CBTProc</li>
<li>HCBT_ACTIVATE</li>
<li>HCBT_DESTROYWND</li>
<li>HCBT_KEYSKIPPED</li>
<li>HCBT_CREATEWND</li>
<li>HCBT_CLICKSKIPPED</li>
<li>HCBT_MOVESIZE</li>
<li>HCBT_MINMAX</li>
<li>winuser/CBTProc</li>
<li>HCBT_QS</li>
<li>HCBT_SETFOCUS</li>
<li>HCBT_SYSCOMMAND
dev_langs:</li>
<li>C++</li>
<li>C
api_location:</li>
<li>Winuser.h
api_name:</li>
<li>CBTProc
api_type:</li>
<li>UserDefined
product:</li>
<li>Windows
ms.topic: reference
topic_type:</li>
<li>apiref</li>
<li>kbSyntax
product_family_name: VS
ROBOTS: INDEX,FOLLOW</li>
</ul>
<hr />
<h1>CBTProc callback function</h1>
<p>An application-defined or library-defined callback function used with the <a href="/windows/win32/api/winuser/nf-winuser-setwindowshookexa"><strong>SetWindowsHookExA</strong></a>/<a href="/windows/win32/api/winuser/nf-winuser-setwindowshookexw"><strong>SetWindowsHookExW</strong></a> function. The system calls this function before activating, creating, destroying, minimizing, maximizing, moving, or sizing a window; before completing a system command; before removing a mouse or keyboard event from the system message queue; before setting the keyboard focus; or before synchronizing with the system message queue. A computer-based training (CBT) application uses this hook procedure to receive useful notifications from the system.</p>
<h2>Syntax</h2>
<pre lang="c++"><code>LRESULT CALLBACK CBTProc(
  _In_ int    nCode,
  _In_ WPARAM wParam,
  _In_ LPARAM lParam
);
</code></pre>
<h2>Parameters</h2>
<ul>
<li>
<p><em>nCode</em> [in]<br />
Type: <strong>int</strong></p>
<p>The code that the hook procedure uses to determine how to process the message. If <em>nCode</em> is less than zero, the hook procedure must pass the message to the <a href="/windows/win32/api/winuser/nf-winuser-callnexthookex"><strong>CallNextHookEx</strong></a> function without further processing and should return the value returned by <strong>CallNextHookEx</strong>. This parameter can be one of the following values.</p>
<!-- raw HTML omitted -->
</li>
</ul>
<p>The system has retrieved a <a href="wm-queuesync.html"><strong>WM_QUEUESYNC</strong></a> message from the system message queue.</p>
<!-- raw HTML omitted -->
<pre><code> 
</code></pre>
<ul>
<li>
<p><em>wParam</em> [in]<br />
Type: <strong>WPARAM</strong></p>
<p>Depends on the <em>nCode</em> parameter. For details, see the following Remarks section.</p>
</li>
<li>
<p><em>lParam</em> [in]<br />
Type: <strong>LPARAM</strong></p>
<p>Depends on the <em>nCode</em> parameter. For details, see the following Remarks section.</p>
</li>
</ul>
<h2>Return value</h2>
<p>Type: LRESULT</p>
<p>The value returned by the hook procedure determines whether the system allows or prevents one of these operations. For operations corresponding to the following CBT hook codes, the return value must be 0 to allow the operation, or 1 to prevent it.</p>
<ul>
<li><strong>HCBT_ACTIVATE</strong></li>
<li><strong>HCBT_CREATEWND</strong></li>
<li><strong>HCBT_DESTROYWND</strong></li>
<li><strong>HCBT_MINMAX</strong></li>
<li><strong>HCBT_MOVESIZE</strong></li>
<li><strong>HCBT_SETFOCUS</strong></li>
<li><strong>HCBT_SYSCOMMAND</strong></li>
</ul>
<p>For operations corresponding to the following CBT hook codes, the return value is ignored.</p>
<ul>
<li><strong>HCBT_CLICKSKIPPED</strong></li>
<li><strong>HCBT_KEYSKIPPED</strong></li>
<li><strong>HCBT_QS</strong></li>
</ul>
<h2>Remarks</h2>
<p>The <strong>HOOKPROC</strong> type defines a pointer to this callback function. <em>CBTProc</em> is a placeholder for the application-defined or library-defined function name.</p>
<p>The hook procedure should not install a <a href="/windows/win32/winmsg/about-hooks"><strong>WH_JOURNALPLAYBACK</strong></a> hook procedure except in the situations described in the preceding list of hook codes.</p>
<p>An application installs the hook procedure by specifying the <a href="/windows/win32/winmsg/about-hooks"><strong>WH_CBT</strong></a> hook type and a pointer to the hook procedure in a call to the <a href="/windows/win32/api/winuser/nf-winuser-setwindowshookexa"><strong>SetWindowsHookExA</strong></a>/<a href="/windows/win32/api/winuser/nf-winuser-setwindowshookexw"><strong>SetWindowsHookExW</strong></a> function.</p>
<p>The following table describes the <em>wParam</em> and <em>lParam</em> parameters for each <strong>HCBT_</strong> hook code.</p>
<!-- raw HTML omitted -->
<p> </p>
<p>For more details, see <a href="../Events/windows-events.html">Windows Events</a>.</p>
<h2>Requirements</h2>
<!-- raw HTML omitted -->
<h2>See also</h2>
<p><a href="/windows/win32/api/winuser/nf-winuser-callnexthookex"><strong>CallNextHookEx</strong></a></p>
<p><a href="/windows/win32/api/winuser/nf-winuser-createwindowa">CreateWindowA</a>/<a href="/windows/win32/api/winuser/nf-winuser-createwindoww">CreateWindowW</a></p>
<p><a href="/windows/win32/api/winuser/nf-winuser-setwindowshookexa"><strong>SetWindowsHookExA</strong></a>/<a href="/windows/win32/api/winuser/nf-winuser-setwindowshookexw"><strong>SetWindowsHookExW</strong></a></p>
<p><a href="../menurc/wm-syscommand.html">WM_SYSCOMMAND message</a></p>
<p><a href="hooks.html">Hooks</a></p>
</body>
