<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TSPI Basic Telephony Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: All service providers must implement Basic Telephony functions.
ms.assetid: 4250f3a0-a66a-4a6e-8566-d71be7463179
title: TSPI Basic Telephony Functions
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>TSPI Basic Telephony Functions</h1>
<p>All service providers must implement Basic Telephony functions. The following is a list of such functions by category. A function is identified as <em>asynchronous</em> if it indicates completion in a REPLY message to the application. If the function always returns its result immediately, the function is considered <em>synchronous</em>.</p>
<ul>
<li><a href="#addresses">Addresses</a></li>
<li><a href="#answering-incoming-calls">Answering Incoming Calls</a></li>
<li><a href="#call-drop-functions">Call Drop Functions</a></li>
<li><a href="#call-states-and-events">Call States and Events</a></li>
<li><a href="#line-status-and-capabilities">Line Status and Capabilities</a></li>
<li><a href="#line-version-negotiation">Line Version Negotiation</a></li>
<li><a href="#making-calls">Making Calls</a></li>
<li><a href="#opening-and-closing-line-devices">Opening and Closing Line Devices</a></li>
<li><a href="#phone-version-negotiation">Phone Version Negotiation</a></li>
<li><a href="#tsp-initialization-and-shutdown">TSP Initialization and Shutdown</a></li>
</ul>
<h2>TSP Initialization and Shutdown</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tuispi_providerinstall"><strong>TUISPI_providerInstall</strong></a></td>
<td>Installs a TSP. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_providerinstall"><strong>TSPI_providerInstall</strong></a></td>
<td>Installs the TSP. Obsolete with Version 2.0. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_providerinit"><strong>TSPI_providerInit</strong></a></td>
<td>Initializes the TSP. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_providershutdown"><strong>TSPI_providerShutdown</strong></a></td>
<td>Shuts down the service provider.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tuispi_providerremove"><strong>TUISPI_providerRemove</strong></a></td>
<td>Removes a TSP. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_providerremove"><strong>TSPI_providerRemove</strong></a></td>
<td>Removes a TSP. Obsolete with Version 2.0. Synchronous.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Phone Version Negotiation</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_phonenegotiatetspiversion"><strong>TSPI_phoneNegotiateTSPIVersion</strong></a></td>
<td>Returns the highest SPI version the service provider can operate under for this device.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Line Version Negotiation</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linenegotiatetspiversion"><strong>TSPI_lineNegotiateTSPIVersion</strong></a></td>
<td>Allows an application to negotiate a TSPI version to use with a given line device. Synchronous.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Line Status and Capabilities</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linegetdevcaps"><strong>TSPI_lineGetDevCaps</strong></a></td>
<td>Returns the capabilities of a given line device. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linegetdevconfig"><strong>TSPI_lineGetDevConfig</strong></a></td>
<td>Returns configuration of a media stream device. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linegetlinedevstatus"><strong>TSPI_lineGetLineDevStatus</strong></a></td>
<td>Returns current status of the specified open line device. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linesetdevconfig"><strong>TSPI_lineSetDevConfig</strong></a></td>
<td>Sets the configuration of the specified media stream device. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linesetstatusmessages"><strong>TSPI_lineSetStatusMessages</strong></a></td>
<td>Specifies the status changes for which the application needs to be notified. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linegetid"><strong>TSPI_lineGetID</strong></a></td>
<td>Retrieves a device ID associated with the specified open line, address, or call. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linegeticon"><strong>TSPI_lineGetIcon</strong></a></td>
<td>Allows an application to retrieve an icon for display to the user. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tuispi_lineconfigdialog"><strong>TUISPI_lineConfigDialog</strong></a></td>
<td>Causes the provider of the specified line device to display a dialog box that allows the user to configure parameters related to the line device. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tuispi_lineconfigdialogedit"><strong>TUISPI_lineConfigDialogEdit</strong></a></td>
<td>Displays a dialog box allowing the user to change configuration information for a line device. Synchronous.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Addresses</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linegetaddresscaps"><strong>TSPI_lineGetAddressCaps</strong></a></td>
<td>Returns the telephony capabilities of an address. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linegetaddressstatus"><strong>TSPI_lineGetAddressStatus</strong></a></td>
<td>Returns current status of a specified address. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linegetnumaddressids"><strong>TSPI_lineGetNumAddressIDs</strong></a></td>
<td>Retrieves the number of address identifiers supported on the indicated line.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linegetaddressid"><strong>TSPI_lineGetAddressID</strong></a></td>
<td>Retrieves the address ID of an address specified using an alternate format. Synchronous.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Opening and Closing Line Devices</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_lineopen"><strong>TSPI_lineOpen</strong></a></td>
<td>Opens a specified line device for providing subsequent monitoring and/or control of the line. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_lineclose"><strong>TSPI_lineClose</strong></a></td>
<td>Closes a specified opened line device. Synchronous.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Call States and Events</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linegetcallinfo"><strong>TSPI_lineGetCallInfo</strong></a></td>
<td>Returns fixed information about a call. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linegetcallstatus"><strong>TSPI_lineGetCallStatus</strong></a></td>
<td>Returns complete call status information for the specified call. Synchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linesetappspecific"><strong>TSPI_lineSetAppSpecific</strong></a></td>
<td>Sets the application-specific field of a call's information structure. Synchronous.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Making Calls</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linemakecall"><strong>TSPI_lineMakeCall</strong></a></td>
<td>Makes an outbound call and returns a call handle for it. Asynchronous.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linedial"><strong>TSPI_lineDial</strong></a></td>
<td>Dials (parts of one or more) dialable addresses. Asynchronous.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Answering Incoming Calls</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_lineanswer"><strong>TSPI_lineAnswer</strong></a></td>
<td>Answers an incoming call. Asynchronous.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Call Drop Functions</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/tspi/nf-tspi-tspi_linedrop"><strong>TSPI_lineDrop</strong></a></td>
<td>Disconnects a call, or abandons a call attempt in progress. Asynchronous.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
