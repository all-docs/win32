<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Overall Comparison with TAPI</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The TSPI specification is very closely related to the specifications for TAPI 2.2 (TAPI/C).
ms.assetid: 2c51f7e3-c741-4736-9611-2327d65b427e
title: Overall Comparison with TAPI
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Overall Comparison with TAPI</h1>
<p>The TSPI specification is very closely related to the specifications for TAPI 2.2 (TAPI/C). Most of the functions in one have a corresponding function in the other. The usual correspondence is as follows:</p>
<ul>
<li>TSPI functions have the same names as TAPI functions except that they are prepended with &quot;<strong>TSPI_</strong>&quot;. For example, the TAPI function <a href="/windows/win32/api/tapi/nf-tapi-lineaccept"><strong>lineAccept</strong></a> corresponds to the TSPI function <a href="/windows/win32/api/tspi/nf-tspi-tspi_lineaccept"><strong>TSPI_lineAccept</strong></a>.</li>
<li>Procedures that allow asynchronous operation insert a <em>dwRequestID</em> parameter of type <a href="drv-requestid.html">DRV_REQUESTID</a> as their first parameter. This parameter specifies the value to be returned to indicate asynchronous operation and to report asynchronous completion.</li>
<li><em>hCall</em> parameters of type HCALL are replaced with <em>hdCall</em> parameters of type <a href="hdrvline.html">HDRVCALL</a>, indicating the service provider's handle for the call.</li>
<li><em>hLine</em> parameters of type HLINE are replaced with <em>hdLine</em> parameters of -type <a href="hdrvline.html">HDRVLINE</a>, indicating the service provider's handle for the line.</li>
<li><em>hPhone</em> parameters of type HPHONE are replaced with <em>hdPhone</em> parameters of type <a href="hdrvphone.html">HDRVPHONE</a>, indicating the service provider's handle for the phone.</li>
<li>Procedures that create a new call, such as <a href="/windows/win32/api/tspi/nf-tspi-tspi_linemakecall"><strong>TSPI_lineMakeCall</strong></a>, replace a single <em>lphCall</em> parameter with two parameters: an <em>htCall</em> of type <a href="htapicall.html">HTAPICALL</a> parameter that passes in the TAPI handle for the call, and an <em>lphdCall</em> of type LPHDRVCALL that indicates the location to which the service provider must write its new handle for the call. A similar split of parameters occurs in <a href="/windows/win32/api/tspi/nf-tspi-tspi_lineopen"><strong>TSPI_lineOpen</strong></a> and <a href="/windows/win32/api/tspi/nf-tspi-tspi_phoneopen"><strong>TSPI_phoneOpen</strong></a>.</li>
<li>At the TSPI level, there is no notion of &quot;privilege&quot; associated with device handles. Furthermore, at the API level, each application that has a device or call handle has a different handle, but TAPI merges these into a single handle in the service provider side. As a consequence, the error codes and status messages relating to privilege and number of clients using a device do not appear at the TSPI level.</li>
</ul>
<p>The set of TAPI functions do not map one to one onto the set of TSPI functions. In particular, functions related to privilege, phone number translation, and interapplication communication are handled by TAPI and have no corresponding function in TSPI. Other functions, such as those used for service-provider configuration and initialization, have no corresponding functions in TAPI.</p>
<p>Â </p>
<p>Â </p>
</body>
