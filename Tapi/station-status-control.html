<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Station Status Control</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: There are three major station status functions that need control Message Waiting lights, Forwarding, and Do Not Disturb.
ms.assetid: 4a6dc47f-caff-4f2b-8858-0e9bec32b137
title: Station Status Control
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Station Status Control</h1>
<p>There are three major station status functions that need control: Message Waiting lights, Forwarding, and Do Not Disturb. Forwarding and Do Not Disturb are controllable through the existing <a href="/windows/desktop/api/Tapi/nf-tapi-lineforward"><strong>lineForward</strong></a> function (which is address-specific), and queried using <a href="/windows/desktop/api/Tapi/nf-tapi-linegetaddressstatus"><strong>lineGetAddressStatus</strong></a>. The LINEDEVSTATUSFLAGS_MSGWAIT bit in the <strong>dwDevStatusFlags</strong> member of <a href="/windows/desktop/api/Tapi/ns-tapi-linedevstatus"><strong>LINEDEVSTATUS</strong></a> indicates the status of the message waiting light on the device, and a LINEDEVSTATE_MSGWAITON or LINEDEVSTATE_MSGWAITOFF message is sent to indicate when the state changes. The <a href="/windows/desktop/api/Tapi/nf-tapi-linesetlinedevstatus"><strong>lineSetLineDevStatus</strong></a> function allows the message waiting light to be controlled without having to implement a TAPI phone device just for that purpose. The LINEFEATURE_SETDEVSTATUS bit (in the <strong>dwLineFeatures</strong> member of <a href="/windows/desktop/api/Tapi/ns-tapi-linedevcaps"><strong>LINEDEVCAPS</strong></a> and <strong>LINEDEVSTATUS</strong>) indicates when it can be called, and the <strong>dwSettableDevStatus</strong> member of <strong>LINEDEVCAPS</strong> allows the application to detect which device status settings can be controlled from the application. In addition to allowing the message waiting feature to be controlled, it also allows the device's Connected, Inservice, and Locked status to be set, to the extent that these are supported by the switch or other hardware. Calls to this function result in appropriate <a href="line-linedevstate.html"><strong>LINE_LINEDEVSTATE</strong></a> messages being sent to reflect the new status.</p>
<p>Â </p>
<p>Â </p>
</body>
