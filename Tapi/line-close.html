<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>LINE_CLOSE message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The TAPI LINE_CLOSE message is sent when the specified line device has been forcibly closed. The line device handle or any call handles for calls on the line are no longer valid once this message has been sent.
ms.assetid: f254e331-d574-4fa7-8447-6e4535d3d773
title: LINE_CLOSE message (Tapi.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>LINE_CLOSE message</h1>
<p>The TAPI <strong>LINE_CLOSE</strong> message is sent when the specified line device has been forcibly closed. The line device handle or any call handles for calls on the line are no longer valid once this message has been sent.</p>
<pre lang="C++"><code>            
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hDevice</em></p>
<!-- raw HTML omitted -->
<p>A handle to the line device that was closed. This handle is no longer valid.</p>
<!-- raw HTML omitted -->
<p><em>dwCallbackInstance</em></p>
<!-- raw HTML omitted -->
<p>The callback instance supplied when opening the line.</p>
<!-- raw HTML omitted -->
<p><em>dwParam1</em></p>
<!-- raw HTML omitted -->
<p>Unused.</p>
<!-- raw HTML omitted -->
<p><em>dwParam2</em></p>
<!-- raw HTML omitted -->
<p>Unused.</p>
<!-- raw HTML omitted -->
<p><em>dwParam3</em></p>
<!-- raw HTML omitted -->
<p>Unused.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>No return value.</p>
<h2>Remarks</h2>
<p>The <strong>LINE_CLOSE</strong> message is sent to any application only after the TAPI service provider (TSP) has forcibly closed an open line. Whether or not the line can be reopened immediately after a forced close is device-specific.</p>
<p>The causing condition can be a significant change of state, a hardware error, a loss of connection to a server, or even potentially to prevent a single application from monopolizing a line device for too long. A line device can also be forcibly closed after the user has modified the configuration of that line or its driver. If the user wants the configuration changes to be effective immediately (as opposed to after the next system restart), and they affect the application's current view of the device (such as a change in device capabilities), then a service provider can forcibly close the line device.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>TAPI version<!-- raw HTML omitted --></td>
<td>Requires TAPI 2.0 or later<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Tapi.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
