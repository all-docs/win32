<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Phone and Address Device-specific Events</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The following code example illustrates an event handler for address and phone device events. The code for each event shows how to create the event interface and how to retrieve the event data.
ms.assetid: 236d4e7f-865f-4b26-8da6-c86476588c47
title: Phone and Address Device-specific Events
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Phone and Address Device-specific Events</h1>
<p>The following code example illustrates an event handler for address and phone device events. The code for each event shows how to create the event interface and how to retrieve the event data.</p>
<pre lang="syntax"><code>HRESULT STDMETHODCALLTYPE CMyEventNotification::Event(
   TAPI_EVENT TapiEvent,
   IDispatch * pEvent
)
{
    HRESULT hr = S_OK;
    //...
    switch (TapiEvent) 
    {
        case TE_ADDRESSDEVSPECIFIC:
        {
            ITAddressDeviceSpecificEvent* pITADSEvent = NULL;

            hr = pEvent-&gt;QueryInterface( 
                               IID_ITAddressDeviceSpecificEvent,
                               (void **)(&amp;pITADSEvent) );
            // If (hr != S_OK) process the error here...

            // Retrieve data received from the TSP.
            long lParam1=0;
            hr = pITADSEvent-&gt;get_lParam1(&amp;lParam1);
            // If (hr != S_OK) process the error here...

            long lParam2=0;
            hr = pITADSEvent-&gt;get_lParam2(&amp;lParam2);
            // If (hr != S_OK) process the error here...

            long lParam3=0; 
            hr = pITADSEvent-&gt;get_lParam3(&amp;lParam3);
            // If (hr !=S_OK) process the error here...

            // Process the data here.
            // ...
            pITADSEvent-&gt;Release();
            break;
        }

        case TE_PHONEDEVSPECIFIC:
        {
            ITPhoneDeviceSpecificEvent* pITPhEvent = NULL;

            hr = pEvent-&gt;QueryInterface( 
                            IID_ITPhoneDeviceSpecificEvent,
                            (void **)(&amp;pITPhEvent) );
            // If (hr != S_OK) process the error here...

            // Retrieve data received from the TSP.
            long lParam1=0;
            hr = pITPhEvent-&gt;get_lParam1(&amp;lParam1);
            // If (hr != S_OK) process the error here...

            long lParam2=0;
            hr = pITPhEvent-&gt;get_lParam2(&amp;lParam2);
            // If (hr != S_OK) process the error here...

            long lParam3=0;
            hr = pITPhEvent-&gt;get_lParam3(&amp;lParam3);
            // If (hr != S_OK) process the error here...

            // Process the data here.
            //...
            pITPhEvent-&gt;Release();
            break;
        }
        //...
    } // end of switch 
    //...
}
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
