<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ACD Agent Monitoring and Control</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Monitoring and control of ACD agent status on stations is supported through these functions lineGetAgentCaps lineGetAgentStatus lineGetAgentGroupList lineGetAgentActivityList lineSetAgentGroup lineSetAgentState and lineSetAgentActivity.
ms.assetid: 2851fe54-f807-4cef-b6ca-2dcc7e1ae6fb
title: ACD Agent Monitoring and Control
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>ACD Agent Monitoring and Control</h1>
<p>Monitoring and control of ACD agent status on stations is supported through these functions: <a href="/windows/desktop/api/Tapi/nf-tapi-linegetagentcapsa"><strong>lineGetAgentCaps</strong></a>, <a href="/windows/desktop/api/Tapi/nf-tapi-linegetagentstatusa"><strong>lineGetAgentStatus</strong></a>, <a href="/windows/desktop/api/Tapi/nf-tapi-linegetagentgrouplista"><strong>lineGetAgentGroupList</strong></a>, <a href="/windows/desktop/api/Tapi/nf-tapi-linegetagentactivitylista"><strong>lineGetAgentActivityList</strong></a>, <a href="/windows/desktop/api/Tapi/nf-tapi-linesetagentgroup"><strong>lineSetAgentGroup</strong></a>, <a href="/windows/desktop/api/Tapi/nf-tapi-linesetagentstate"><strong>lineSetAgentState</strong></a>, and <a href="/windows/desktop/api/Tapi/nf-tapi-linesetagentactivity"><strong>lineSetAgentActivity</strong></a>.</p>
<p>The <a href="line-agentstatus.html"><strong>LINE_AGENTSTATUS</strong></a> message is used to indicate when agent information has changed.</p>
<p>These controls are associated with an address instead of a line because many ACD systems are implemented with different ACD queues associated with buttons on the phone terminal (and separate call appearances). Also, ACD agent phones can often have separate call appearances for personal calls.</p>
<p>Architecturally, ACD functionality should be implemented in a server-based application. The client functions mentioned above, rather than mapping to the telephony service provider, are conveyed to a server application that has registered (using an option of <a href="/windows/desktop/api/Tapi/nf-tapi-lineopen"><strong>lineOpen</strong></a>) as a handler for such functions. The <a href="line-proxyrequest.html"><strong>LINE_PROXYREQUEST</strong></a> message is used to signal to the handler application when a request has been made; it calls the <a href="/windows/desktop/api/Tapi/nf-tapi-lineproxyresponse"><strong>lineProxyResponse</strong></a> function to return results and data. Handler applications can also call <a href="/windows/desktop/api/Tapi/nf-tapi-lineproxymessage"><strong>lineProxyMessage</strong></a> to generate LINE_AGENTSTATUS messages when required. In the case of a legacy PBX or stand-alone ACD that implements ACD functionality itself, the telephony service provider for the switch must include a proxy server application that accepts the requests and routes them (possibly using <a href="/windows/desktop/api/Tapi/nf-tapi-linedevspecific"><strong>lineDevSpecific</strong></a> functions or a private interface) to the service provider, which routes them to the switch.</p>
<p>Â </p>
<p>Â </p>
</body>
