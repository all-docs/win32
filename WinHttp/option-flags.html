<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Option flags</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Option flags (Winhttp.h)
description: The following option flags are supported by <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpqueryoption"><strong>WinHttpQueryOption</strong></a> and <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsetoption"><strong>WinHttpSetOption</strong></a>.
ms.assetid: 2d0441f4-ddba-4f2a-8861-8803cad6f1ac
ms.topic: reference
ms.custom: snippet-project
ms.date: 06/20/2022</h2>
<h1>Option flags</h1>
<p>The following option flags are supported by <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpqueryoption"><strong>WinHttpQueryOption</strong></a> and <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsetoption"><strong>WinHttpSetOption</strong></a>.</p>
<h2>WINHTTP_OPTION_ASSURED_NON_BLOCKING_CALLBACKS</h2>
<p>The default is FALSE. If set to TRUE, WinHTTP doesn't guarantee progress if status callbacks are blocked by the client application.</p>
<p>The client application must take special care to perform minimal operations within the callback without blocking, returning as quickly as possible, and in particular must not wait for any subsequent WinHTTP calls. If it doesn't follow these guidelines, there is likely to be a negative performance impact or a potential application hang. If used in the prescribed manner, this option may improve performance.</p>
<h2>WINHTTP_OPTION_AUTOLOGON_POLICY</h2>
<p>Sets an unsigned long integer value that specifies the <a href="authentication-in-winhttp.html">Automatic Logon Policy</a> with one of the following values.</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_AUTOLOGON_SECURITY_LEVEL_HIGH</td>
<td>Default credentials are not used. Note that this flag takes effect only if you specify the server by the actual machine name. It will not take effect, if you specify the server by &quot;localhost&quot; or IP address.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_AUTOLOGON_SECURITY_LEVEL_LOW</td>
<td>An authenticated log on using the default credentials is performed for all requests.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_AUTOLOGON_SECURITY_LEVEL_MEDIUM</td>
<td>An authenticated log on using the default credentials is performed only for requests on the local Intranet.</td>
</tr>
</tbody>
</table>
<h2>WINHTTP_OPTION_BACKGROUND_CONNECTIONS</h2>
<p>When you set this option on a session handle, you must pass the number of connections you wish to open. Then, upon first sending a request, rather than opening only a single connection, WinHttp opens a number of connections in parallel. This can improve the performance of subsequent requests to the same destination, which won't have the overhead of connection establishment.</p>
<h2>WINHTTP_OPTION_CALLBACK</h2>
<p>Retrieves the pointer to the callback function set with <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsetstatuscallback"><strong>WinHttpSetStatusCallback</strong></a>.</p>
<h2>WINHTTP_OPTION_CLIENT_CERT_CONTEXT</h2>
<p>Sets the client certificate context. If an application receives <a href="error-messages.html"><strong>ERROR_WINHTTP_CLIENT_AUTH_CERT_NEEDED</strong></a>, it must call <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsetoption"><strong>WinHttpSetOption</strong></a> to supply a certificate before retrying the request. As a part of processing this option, WinHttp calls <a href="/windows/win32/api/wincrypt/nf-wincrypt-certduplicatecertificatecontext"><strong>CertDuplicateCertificateContext</strong></a> on the caller-provided certificate context so that the certificate context can be independently released by the caller.</p>
<blockquote>
<p>[!NOTE]
The application should not attempt to close the certificate store with the CERT_CLOSE_STORE_FORCE_FLAG flag in the call to <a href="/windows/win32/api/wincrypt/nf-wincrypt-certclosestore"><strong>CertCloseStore</strong></a> on the certificate store from which the certificate context was retrieved. An access violation may occur.</p>
</blockquote>
<p>When the server requests a client certificate, <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsendrequest"><strong>WinHttpSendRequest</strong></a>, or <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpreceiveresponse"><strong>WinHttpReceiveResponse</strong></a> returns an <a href="error-messages.html"><strong>ERROR_WINHTTP_CLIENT_AUTH_CERT_NEEDED</strong></a> error. If the server requests the certificate but doesn't require it, the application can specify this option to indicate that it doesn't have a certificate. The server can choose another authentication scheme or allow anonymous access to the server. The application provides the <strong>WINHTTP_NO_CLIENT_CERT_CONTEXT</strong> macro in the <em>lpBuffer</em> parameter of <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsetoption"><strong>WinHttpSetOption</strong></a> as shown in the following code example.</p>
<pre lang="syntax"><code>BOOL fRet = WinHttpSetOption(hRequest,
                             WINHTTP_OPTION_CLIENT_CERT_CONTEXT,
                             WINHTTP_NO_CLIENT_CERT_CONTEXT,
                             0);
</code></pre>
<p>If the server requires a client certificate, it may send a 403 HTTP status code in response. For more information, see the <strong>WINHTTP_OPTION_CLIENT_CERT_ISSUER_LIST</strong> option.</p>
<h2>WINHTTP_OPTION_CLIENT_CERT_ISSUER_LIST</h2>
<p>Retrieves a <a href="/windows/win32/api/schannel/ns-schannel-secpkgcontext_issuerlistinfoex"><strong>SecPkgContext_IssuerListInfoEx</strong></a> structure when the error from <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsendrequest"><strong>WinHttpSendRequest</strong></a> or <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpreceiveresponse"><strong>WinHttpReceiveResponse</strong></a> is <strong>ERROR_WINHTTP_CLIENT_AUTH_CERT_NEEDED</strong>. The issuer list in the structure contains a list of acceptable Certificate Authorities (CA) from the server. The client application can filter the CA list to retrieve the client certificate for SSL authentication.</p>
<p>Alternately, if the server requests the client certificate, but doesn't require it, the application can call <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsetoption"><strong>WinHttpSetOption</strong></a> with the <strong>WINHTTP_OPTION_CLIENT_CERT_CONTEXT</strong> option. For more information, see the <strong>WINHTTP_OPTION_CLIENT_CERT_CONTEXT</strong> option.</p>
<h2>WINHTTP_OPTION_CODEPAGE</h2>
<p>Sets the <a href="glossary.html"><em>code page</em></a> that is used to process the URL (that is, query string). The default is UTF8.</p>
<h2>WINHTTP_OPTION_CONFIGURE_PASSPORT_AUTH</h2>
<p>Sets an unsigned long integer value that specifies whether <a href="passport-authentication-in-winhttp.html">Passport Authentication in WinHTTP</a> authentication is enabled. The value can be one of the following:</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_DISABLE_PASSPORT_AUTH</td>
<td>Microsoft Passport authentication is disabled. This is the default.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_DISABLE_PASSPORT_KEYRING</td>
<td>The Passport keyring is disabled. This is the default.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_ENABLE_PASSPORT_AUTH</td>
<td>Passport authentication is enabled.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_ENABLE_PASSPORT_KEYRING</td>
<td>The Passport keyring is enabled.</td>
</tr>
</tbody>
</table>
<h2>WINHTTP_OPTION_CONNECT_RETRIES</h2>
<p>Sets or retrieves an unsigned long integer value that contains the number of timesWinHTTP attempts to connect to a host. Microsoft Windows HTTP Services (WinHTTP) only attempts once per Internet Protocol (IP) address. For example, if you attempt to connect to a multihomed host that has 10 IP addresses and <strong>WINHTTP_OPTION_CONNECT_RETRIES</strong> is set to 7, then WinHTTP only attempts to connect to the first seven IP address. Given the same set of 10 IP addresses, if <strong>WINHTTP_OPTION_CONNECT_RETRIES</strong> is set to 20, WinHTTP attempts each of the 10 only once. If a connection attempt still fails after the specified number of attempts, or if the connect timeout expired before then, the request is canceled. The default value for <strong>WINHTTP_OPTION_CONNECT_RETRIES</strong> is five attempts.</p>
<h2>WINHTTP_OPTION_CONNECT_TIMEOUT</h2>
<p>Sets or retrieves an unsigned long integer value that contains the time-out value, in milliseconds. Setting this option to infinite (0xFFFFFFFF) will disable this timer.</p>
<p>If a TCP connection request takes longer than this time-out value, the request is canceled. The default timeout is 60 seconds. When you are attempting to connect to multiple IP addresses for a single host (a multihomed host), the timeout limit is for each individual connection.</p>
<h2>WINHTTP_OPTION_CONNECTION_INFO</h2>
<p>Retrieves the source and destination IP address, and port of the request that generated the response when <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpreceiveresponse"><strong>WinHttpReceiveResponse</strong></a> returns. The application calls <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpqueryoption"><strong>WinHttpQueryOption</strong></a> with the <strong>WINHTTP_OPTION_CONNECTION_INFO</strong> option, and provides the <a href="/windows/win32/api/Winhttp/ns-winhttp-winhttp_connection_info"><strong>WINHTTP_CONNECTION_INFO</strong></a> structure in the <em>lpBuffer</em> parameter. For more information, see <strong>WINHTTP_CONNECTION_INFO</strong>.</p>
<p><strong>Applies to</strong>: Windows XP with SP2 and later; Windows 2003 with SP1 and later.</p>
<h2>WINHTTP_OPTION_CONNECTION_GUID</h2>
<p>Mark the connection associated with the WinHTTP request handle with a GUID. This allows custom control over which requests use which groups of connections with the <strong>WINHTTP_OPTION_MATCH_CONNECTION_GUID</strong> option.</p>
<h2>WINHTTP_OPTION_CONNECTION_STATS_V0</h2>
<p>Retreives the <a href="/windows/win32/api/mstcpip/ns-mstcpip-tcp_info_v0"><strong>TCP_INFO_v0</strong></a> struct for the underlying connection used by the request. The returned struct may contain statistics from prior requests sent over the same connection.</p>
<blockquote>
<p>[!NOTE]
This option has been superseded by <strong>WINHTTP_OPTION_CONNECTION_STATS_V1</strong>.</p>
</blockquote>
<h2>WINHTTP_OPTION_CONNECTION_STATS_V1</h2>
<p>Retreives the <a href="/windows/win32/api/mstcpip/ns-mstcpip-tcp_info_v1"><strong>TCP_INFO_v1</strong></a> struct for the underlying connection used by the request. The returned struct may contain statistics from prior requests sent over the same connection.</p>
<h2>WINHTTP_OPTION_CONTEXT_VALUE</h2>
<p>Sets or retrieves a <strong>DWORD_PTR</strong> that contains a pointer to the context value associated with this <a href="hinternet-handles-in-winhttp.html">HINTERNET</a> handle. The value stored in the buffer is used and the <strong>WINHTTP_OPTION_CONTEXT_VALUE</strong> option flag is assigned a new value.</p>
<h2>WINHTTP_OPTION_DECOMPRESSION</h2>
<p>Sets a DWORD of flags which determine whether WinHTTP will automatically decompress response bodies with compressed Content-Encodings. WinHTTP will also set an appropriate Accept-Encoding header, overriding any supplied by the caller. Supported values are:</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_DECOMPRESSION_FLAG_GZIP</td>
<td>Decompress Content-Encoding: gzip responses.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_DECOMPRESSION_FLAG_DEFLATE</td>
<td>Decompress Content-Encoding: deflate responses.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_DECOMPRESSION_FLAG_ALL</td>
<td>Decompress responses with any supported Content-Encoding.</td>
</tr>
</tbody>
</table>
<p>By default, WinHTTP will deliver compressed responses to the caller unmodified.</p>
<h2>WINHTTP_OPTION_DISABLE_CERT_CHAIN_BUILDING</h2>
<p>Setting this option on a WinHttp session handle allows you to enable/disable whether the server certificate chain is built.</p>
<h2>WINHTTP_OPTION_DISABLE_FEATURE</h2>
<p>Sets an unsigned long integer value that specifies which features are disabled with one or more of the following flags. Be aware that this feature should only be passed to <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsetoption"><strong>WinHttpSetOption</strong></a> on request handles after the request handle is created with <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpopenrequest"><strong>WinHttpOpenRequest</strong></a>, and before the request is sent with <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsendrequest"><strong>WinHttpSendRequest</strong></a>.</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_DISABLE_AUTHENTICATION</td>
<td>Automatic authentication is disabled.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_DISABLE_COOKIES</td>
<td>Automatic addition of cookie headers to requests is disabled. Also, returned cookies are not automatically added to the cookie database. Disabling cookies can result in poor performance for Passport authentication.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_DISABLE_KEEP_ALIVE</td>
<td>Disables keep-alive semantics for the connection. Keep-alive semantics are required for MSN, NTLM, and other types of authentication.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_DISABLE_REDIRECTS</td>
<td>Automatic redirection is disabled when sending requests with <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsendrequest"><strong>WinHttpSendRequest</strong></a>. If automatic redirection is disabled, an application must register a callback function in order for Passport authentication to succeed.</td>
</tr>
</tbody>
</table>
<h2>WINHTTP_OPTION_DISABLE_GLOBAL_POOLING</h2>
<p>Disables global, cross-session pooling. This is recommended practice because global, cross-session pooling is legacy behavior that's supported by default for compatibility reasons. This is impacted by later setting max connections manually.</p>
<h2>WINHTTP_OPTION_DISABLE_PROXY_AUTH_SCHEMES</h2>
<p>Disables one or more of the following proxy authentication practices on the WinHTTP session by providing the <code>OR</code> of all applicable choices. These are all schemes, except for <strong>WINHTTP_PROXY_DISABLE_AUTH_LOCAL_SERVICE</strong>, which forces the use of the local machine account when sending requests to a loopback or local address. That prevents leaking system credentials to local HTTP proxies.</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>WINHTTP_PROXY_DISABLE_SCHEME_BASIC</td>
<td>Disables the Basic authentication scheme.</td>
</tr>
<tr>
<td>WINHTTP_PROXY_DISABLE_SCHEME_DIGEST</td>
<td>Disables the Digest authentication scheme.</td>
</tr>
<tr>
<td>WINHTTP_PROXY_DISABLE_SCHEME_NTLM</td>
<td>Disables the NTLM authentication scheme.</td>
</tr>
<tr>
<td>WINHTTP_PROXY_DISABLE_SCHEME_KERBEROS</td>
<td>Disables the Kerberos authentication scheme.</td>
</tr>
<tr>
<td>WINHTTP_PROXY_DISABLE_SCHEME_NEGOTIATE</td>
<td>Disables the Negotiate authentication scheme.</td>
</tr>
<tr>
<td>WINHTTP_PROXY_DISABLE_AUTH_LOCAL_SERVICE</td>
<td>Forces the use of the local machine account when sending requests to a loopback or local address.</td>
</tr>
</tbody>
</table>
<h2>WINHTTP_OPTION_DISABLE_SECURE_PROTOCOL_FALLBACK</h2>
<p>Prevents WinHTTP from retrying a connection with a lower version of the security protocol when the initial protocol negotiation fails.</p>
<h2>WINHTTP_OPTION_DISABLE_STREAM_QUEUE</h2>
<p>Allows new requests to open an additional HTTP/2 connection when the maximum concurrent stream limit is reached, rather than waiting for the next available stream on an existing connection.</p>
<h2>WINHTTP_OPTION_ENABLE_FEATURE</h2>
<p>Sets an unsigned long integer value that specifies the features currently enabled. Can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_ENABLE_SSL_REVERT_IMPERSONATION</td>
<td>If enabled, WinHTTP temporarily reverts client impersonation for the duration of SSL certificate authentication operations. This value can be set only on the session handle.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_ENABLE_SSL_REVOCATION</td>
<td>If enabled, WinHTTP allows SSL revocation. This value can be set only on the request handle.</td>
</tr>
</tbody>
</table>
<h2>WINHTTP_OPTION_ENABLE_HTTP_PROTOCOL</h2>
<p>Sets a DWORD bitmask of acceptable advanced HTTP versions. Possible values are:</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>WINHTTP_PROTOCOL_FLAG_HTTP2 (0x1)</td>
<td>Enables HTTP/2 for the request.</td>
</tr>
<tr>
<td>WINHTTP_PROTOCOL_FLAG_HTTP3 (0x2)</td>
<td>Enables HTTP/3 for the request.</td>
</tr>
<tr>
<td>None (0x0)</td>
<td>Restricts the request to HTTP/1.1 and prior.</td>
</tr>
</tbody>
</table>
<p>Legacy versions of HTTP (1.1 and prior) can't be disabled using this option. The default is 0x0.</p>
<h2>WINHTTP_OPTION_ENABLE_HTTP2_PLUS_CLIENT_CERT</h2>
<p>This option can be set on a WinHttp session handle to allow WinHttp to use the caller-provided client certificate context when HTTP/2 is being used.</p>
<h2>WINHTTP_OPTION_ENABLETRACING</h2>
<p>Sets a <strong>BOOL</strong> value that specifies whether tracing is currently enabled. This option can be set only on a <strong>NULL</strong> <strong>HINTERNET</strong> handle. Also see <a href="collect-traces.html">Collect WinHTTP traces</a>.</p>
<h2>WINHTTP_OPTION_ENCODE_EXTRA</h2>
<p>Enables URL percent encoding for path and query string.</p>
<p>Alternatively, you can percent encode before calling WinHttp.</p>
<h2>WINHTTP_OPTION_EXPIRE_CONNECTION</h2>
<p>This option can only be set on a request handle which is still active (sending or receiving). Setting this option will tell WinHttp to stop serving requests on the connection associated with the request handle passed in. The connection will be closed after the request handle this option is called with is completed. This option doesn't take any parameters.</p>
<h2>WINHTTP_OPTION_EXTENDED_ERROR</h2>
<p>Retrieves an unsigned long integer value that contains a Microsoft Windows Sockets error code that was mapped to the ERROR_WINHTTP_* error messages last returned in this thread context. You can pass <strong>NULL</strong> as the handle value.</p>
<h2>WINHTTP_OPTION_FEATURE_SUPPORTED</h2>
<p>Check to see whether a provided option flag is supported by this version of WinHTTP.</p>
<h2>WINHTTP_OPTION_FIRST_AVAILABLE_CONNECTION</h2>
<p>By default, when WinHttp sends a request, if there are no available connections to serve the request, WinHttp will attempt to establish a new connection, and the request will be bound to this new connection. When you set this option, such a request will instead be served on the first connection that becomes available, and not necessarily the one being established.</p>
<h2>WINHTTP_OPTION_GLOBAL_PROXY_CREDS</h2>
<p>Takes a pointer to a <a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_creds_ex"><strong>WINHTTP_CREDS_EX</strong></a> structure with the <em>hInternet</em> function parameter set to <strong>NULL</strong>. This option requires registry key <strong>HKLM\Software\Microsoft\Windows\CurrentVersion\Internet Settings!ShareCredsWithWinHttp</strong>. If this registry key is not set WinHTTP will return error <strong>ERROR_WINHTTP_INVALID_OPTION</strong>. This registry key is not present by default. When it is set, WinINet will send credentials down to WinHTTP. Whenever WinHttp gets an authentication challenge and if there are no credentials set on the current handle, it will use the credentials provided by WinINet. In order to share server credentials in addition to proxy credentials, users needs to set <strong>WINHTTP_OPTION_USE_GLOBAL_SERVER_CREDENTIALS</strong> .</p>
<h2>WINHTTP_OPTION_GLOBAL_SERVER_CREDS</h2>
<p>Takes a pointer to a <a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_creds_ex"><strong>WINHTTP_CREDS_EX</strong></a> structure with the <em>hInternet</em> function parameter set to <strong>NULL</strong>. This option requires registry key <strong>HKLM\Software\Microsoft\Windows\CurrentVersion\Internet Settings!ShareCredsWithWinHttp</strong>. If this registry key is not set WinHTTP will return error <strong>ERROR_WINHTTP_INVALID_OPTION</strong>. This registry key is not present by default. When it is set, WinINet will send credentials down to WinHTTP. Whenever WinHttp gets an authentication challenge and if there are no credentials set on the current handle, it will use the credentials provided by WinINet. In order to share server credentials in addition to proxy credentials, users needs to set <strong>WINHTTP_OPTION_USE_GLOBAL_SERVER_CREDENTIALS</strong> .</p>
<h2>WINHTTP_OPTION_HANDLE_TYPE</h2>
<p>Retrieves an unsigned long integer value that contains the type of the <a href="hinternet-handles-in-winhttp.html">HINTERNET</a> handle passed in. The return value can be one of the following:</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_HANDLE_TYPE_CONNECT</td>
<td>The handle is a connection handle.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_HANDLE_TYPE_REQUEST</td>
<td>The handle is a request handle.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_HANDLE_TYPE_SESSION</td>
<td>The handle is a session handle.</td>
</tr>
</tbody>
</table>
<h2>WINHTTP_OPTION_HTTP_PROTOCOL_REQUIRED</h2>
<p>Prevents protocol versions other than those enabled by <strong>WINHTTP_OPTION_ENABLE_HTTP_PROTOCOL</strong> from being used for the request.</p>
<h2>WINHTTP_OPTION_HTTP_PROTOCOL_USED</h2>
<p>Gets a DWORD indicating which advanced HTTP version was used on a given request. For a list of possible values, see <strong>WINHTTP_OPTION_ENABLE_HTTP_PROTOCOL</strong>.</p>
<h2>WINHTTP_OPTION_HTTP_VERSION</h2>
<p>Sets or retrieves an <a href="/windows/win32/api/winhttp/ns-winhttp-http_version_info"><strong>HTTP_VERSION_INFO</strong></a> structure that contains the HTTP version being supported. This is a process-wide option; use <strong>NULL</strong> for the handle.</p>
<h2>WINHTTP_OPTION_HTTP2_KEEPALIVE</h2>
<p>This option can be set on a session handle to have WinHttp use HTTP/2 PING frames as a keepalive mechanism. Callers specify a timeout in milliseconds, and after there is no activity on a connection for that timeout period, WinHttp will begin to send HTTP/2 PING frames. Callers cannot set a timeout value less than 5000 milliseconds.</p>
<h2>WINHTTP_OPTION_HTTP2_PLUS_TRANSFER_ENCODING</h2>
<p>This option can be set on a WinHttp request handle to control how WinHttp behaves when an HTTP/2 response contains a &quot;Transfer-Encoding&quot; header. In such a case, WinHttp will return an error if this option is set to <strong>FALSE</strong>.</p>
<h2>WINHTTP_OPTION_HTTP2_RECEIVE_WINDOW</h2>
<p>Set the initial HTTP/2 stream receive window size and the threshold for sending window updates using the <strong>WINHTTP_HTTP2_RECEIVE_WINDOW</strong> struct.</p>
<h2>WINHTTP_OPTION_HTTP3_HANDSHAKE_TIMEOUT</h2>
<p>Uses the buffer to set the HTTP/3 handshake timeout in milliseconds as a PDWORD.</p>
<h2>WINHTTP_OPTION_HTTP3_INITIAL_RTT</h2>
<p>Configures the initial RTT in milliseconds used by <a href="https://github.com/microsoft/msquic">msquic</a>.</p>
<h2>WINHTTP_OPTION_HTTP3_KEEPALIVE</h2>
<p>Enables keep-alive semantics for the connection. Uses the buffer to set the keep-alive timeout in milliseconds as a PDWORD.</p>
<h2>WINHTTP_OPTION_HTTP3_STREAM_ERROR_CODE</h2>
<p>Retrieves the server-provided error on the HTTP/3 stream used to send the request.</p>
<h2>WINHTTP_OPTION_IGNORE_CERT_REVOCATION_OFFLINE</h2>
<p>Allows secure connections to use security certificates for which the certificate revocation list could not be downloaded.</p>
<h2>WINHTTP_OPTION_IPV6_FAST_FALLBACK</h2>
<p>Enables IPv6 fast fallback (Happier Eyeballs) for the connection. This behavior is similar to the Happy Eyeballs behavior described in <a href="https://tools.ietf.org/html/rfc6555">RFC 6555</a> for improving connection times on networks where IPv6 is unreliable.</p>
<ul>
<li>If both IPv6 and IPv4 addresses are resolved for a given host, WinHttp will begin by connecting to the first resolved IPv6 address with a short (300ms) timeout.</li>
<li>Should that connection fail, WinHttp will attempt to connect to the first resolved IPv4 address with the standard timeout.</li>
<li>Should the second connection fail, WinHttp will retry the first resolved IPv6 address with the standard timeout.</li>
<li>Should the third connection fail, WinHttp will revert to the default behavior for any remaining addresses, attempting a connection to each one with the standard timeout until a connection is made or no addresses remain.</li>
</ul>
<h2>WINHTTP_OPTION_IS_PROXY_CONNECT_RESPONSE</h2>
<p>Gets whether or not a Proxy Return Connect Response can be retrieved.</p>
<h2>WINHTTP_OPTION_MATCH_CONNECTION_GUID</h2>
<p>Takes a <a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_match_connection_guid"><strong>WINHTTP_MATCH_CONNECTION_GUID</strong></a> struct to tell WinHTTP to serve the request on a matching connection. If <strong>WINHTTP_MATCH_CONNECTION_GUID_FLAG_REQUIRED</strong> is set, then only connections with a matching GUID can be used. Otherwise, connections with matching GUIDs and connections that are not marked with any GUID can be used.</p>
<h2>WINHTTP_OPTION_MAX_CONNS_PER_1_0_SERVER</h2>
<p>Sets or retrieves an unsigned long integer value that contains the maximum number of connections allowed per HTTP/1.0 server. The default value is <strong>INFINITE</strong>.</p>
<p><strong>Applies to</strong>: Windows Vista with SP1 and later; Windows Server 2008 and later.</p>
<h2>WINHTTP_OPTION_MAX_CONNS_PER_SERVER</h2>
<p>Sets or retrieves an unsigned long integer value that contains the maximum number of connections allowed per server. The default value is <strong>INFINITE</strong>.</p>
<p>When this option is set to zero, WinHTTP sets the limit on the number of connections to 2.</p>
<h2>WINHTTP_OPTION_MAX_HTTP_AUTOMATIC_REDIRECTS</h2>
<p>Sets the maximum number of redirects that WinHTTP follows; the default is 10. This limit prevents unauthorized sites from making the WinHTTP client pause following a large number of redirects.</p>
<p><strong>Applies to</strong>: Windows XP with SP1 and later; Windows 2000 with SP3 and later.</p>
<h2>WINHTTP_OPTION_MAX_HTTP_STATUS_CONTINUE</h2>
<p>The maximum number of Informational 100-199 status code responses ignored before returning the final status code to the WinHTTP client. Informational 100-199 status codes can be sent by the server before the final status code, and are described in the specification for HTTP/1.1 (for more information, see <a href="https://www.ietf.org/rfc/rfc2616.txt">RFC 2616</a>). The default is 10.</p>
<p><strong>Applies to</strong>: Windows XP with SP1 and later; Windows 2000 with SP3 and later.</p>
<h2>WINHTTP_OPTION_MAX_RESPONSE_DRAIN_SIZE</h2>
<p>A bound on the amount of data drained from responses in order to reuse a connection, specified in bytes. The default is 1MB.</p>
<p><strong>Applies to</strong>: Windows XP with SP1 and later; Windows 2000 with SP3 and later.</p>
<h2>WINHTTP_OPTION_MAX_RESPONSE_HEADER_SIZE</h2>
<p>A bound set on the maximum size of the header portion of the server response, specified in bytes. This bound protects the client from an unauthorized server attempting to stall the client by sending a response with an infinite amount of header data. The default value is 64KB.</p>
<p><strong>Applies to</strong>: Windows XP with SP1 and later; Windows 2000 with SP3 and later.</p>
<h2>WINHTTP_OPTION_PARENT_HANDLE</h2>
<p>Retrieves the parent handle to this handle.</p>
<h2>WINHTTP_OPTION_PASSPORT_COBRANDING_TEXT</h2>
<p>Retrieves a string that contains the <a href="glossary.html"><em>cobranding</em></a> text provided by the Passport logon server. This option should be retrieved immediately after the logon server responds with a 401 status code. An application should pass in a buffer size, in bytes, that is big enough to hold the returned string.</p>
<h2>WINHTTP_OPTION_PASSPORT_COBRANDING_URL</h2>
<p>Retrieves a string that contains a URL for a <a href="glossary.html"><em>cobranding</em></a> graphic provided by the Passport logon server. This option should be retrieved immediately after the logon server responds with a 401 status code. An application should pass in a buffer size, in bytes, that is big enough to hold the returned string.</p>
<h2>WINHTTP_OPTION_PASSPORT_RETURN_URL</h2>
<p>Sets a read-only option on a request handle that retrieves the Passport return URL.</p>
<h2>WINHTTP_OPTION_PASSPORT_SIGN_OUT</h2>
<p>Sets the option on a session handle to sign out of any Passport logins. An application should pass in the Passport return URL that was retrieved with <strong>WINHTTP_OPTION_PASSPORT_RETURN_URL</strong>. All cookies related to the return URL are cleared.</p>
<h2>WINHTTP_OPTION_PASSWORD</h2>
<p>Sets or retrieves a string value that contains the password associated with a request handle.</p>
<h2>WINHTTP_OPTION_PROXY</h2>
<p>Sets or retrieves an <a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_proxy_info"><strong>WINHTTP_PROXY_INFO</strong></a> structure that contains the proxy data on an existing session handle or request handle. When retrieving proxy data, an application must free the <strong>lpszProxy</strong> and <strong>lpszProxyBypass</strong> strings contained in this structure (if they are non-<strong>NULL</strong>) using the <a href="/windows/win32/api/winbase/nf-winbase-globalfree"><strong>GlobalFree</strong></a> function. An application can query for the global proxy data (the default proxy) by passing a <strong>NULL</strong> handle.</p>
<h2>WINHTTP_OPTION_PROXY_PASSWORD</h2>
<p>Sets or retrieves a string value that contains the password used to access the proxy.</p>
<h2>WINHTTP_OPTION_PROXY_SPN_USED</h2>
<p>Gets the proxy Server Principal Name that WinHTTP supplied to SSPI during authentication. This string value is usefor passing to <a href="/windows/win32/api/sspi/nf-sspi-sspipromptforcredentialsa"><strong>SspiPromptForCredentials</strong></a> after an authentication failure.</p>
<h2>WINHTTP_OPTION_PROXY_USERNAME</h2>
<p>Sets or retrieves a string value that contains the user name used to access the proxy.</p>
<h2>WINHTTP_OPTION_QUIC_STATS</h2>
<p>Retrieves a <strong>QUIC_STATISTICS</strong> structure that contains connection information such as RTT and bytes sent and received.</p>
<h2>WINHTTP_OPTION_READ_BUFFER_SIZE</h2>
<p>This option is deprecated; it has no effect.</p>
<h2>WINHTTP_OPTION_RECEIVE_PROXY_CONNECT_RESPONSE</h2>
<p>Sets whether or not the proxy response entity can be retrieved. This option is disabled by default.</p>
<h2>WINHTTP_OPTION_RECEIVE_RESPONSE_TIMEOUT</h2>
<p>Sets or retrieves an unsigned long integer value that contains the timeout value, in milliseconds, to wait to receive all response headers to a request. If WinHTTP fails to receive all the headers within this timeout period, the request is canceled. The default timeout value is 90 seconds.</p>
<p>This timeout is checked only when data is received from the socket. As a result, when the timeout expires the client application is not notified until more data arrives from the server. If no data arrives from the server, the delay between the timeout expiration and notification of the client application could be as large as the timeout value set using the <em>dwReceiveTimeout</em> parameter of the <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsettimeouts"><strong>WinHttpSetTimeouts</strong></a> function.</p>
<h2>WINHTTP_OPTION_RECEIVE_TIMEOUT</h2>
<p>Sets or retrieves an unsigned long integer value that contains the time-out value, in milliseconds, to receive a partial response to a request or read some data. If the response takes longer than this time-out value, the request is canceled. The default timeout value is 30 seconds.</p>
<h2>WINHTTP_OPTION_REDIRECT_POLICY</h2>
<p>Sets the behavior of WinHTTP regarding the handling of a 30x HTTP redirect status code. This option can be set on a session or request handle to one of the following values:</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_OPTION_REDIRECT_POLICY_ALWAYS</td>
<td>All redirects are followed automatically.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_OPTION_REDIRECT_POLICY_DISALLOW_HTTPS_TO_HTTP</td>
<td>All redirects are followed, except those that originate from a secure (https) URL to an unsecure (http) URL. This is the default setting.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_OPTION_REDIRECT_POLICY_NEVER</td>
<td>Redirects are never followed. The 30x status is returned to the application.</td>
</tr>
</tbody>
</table>
<h2>WINHTTP_OPTION_REJECT_USERPWD_IN_URL</h2>
<p>Rejects URLs that contain a username and password. This option also rejects URLs that contain <em>username:password</em> semantics, even if no username or password is specified. For example, &quot;u:p@hostname&quot;, &quot;:@hostname&quot;, &quot;u:@hostname&quot;, and &quot;:p@hostname&quot; would all be flagged as invalid. If an invalid URL is passed to the function, it returns <a href="error-messages.html">ERROR_WINHTTP_INVALID_URL</a>. This option is turned off by default.</p>
<h2>WINHTTP_OPTION_REQUEST_ANNOTATION</h2>
<p>Enables getting and setting a request annotation for the provided annotation name. That allows the caller to attach a string to the request for later retrieval to identify requests by whatever custom logic the caller finds useful.</p>
<h2>WINHTTP_OPTION_REQUEST_PRIORITY</h2>
<p>This option is deprecated; it has no effect.</p>
<h2>WINHTTP_OPTION_REQUEST_STATS</h2>
<p>Retreives statistics for the request.  For a list of the available statistics, see <a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_request_stats"><strong>WINHTTP_REQUEST_STATS</strong></a>.</p>
<h2>WINHTTP_OPTION_REQUEST_TIMES</h2>
<p>Retreives timing information for the request. For a list of the available timings, see <a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_request_times"><strong>WINHTTP_REQUEST_TIMES</strong></a>.</p>
<h2>WINHTTP_OPTION_REQUIRE_STREAM_END</h2>
<p>This option tells WinHttp to ignore &quot;Content-Length&quot; response headers, and continue receiving on a stream until the END_STREAM flag is received.</p>
<h2>WINHTTP_OPTION_RESOLUTION_HOSTNAME</h2>
<p>This option can be set on a WinHttp request handle before it has been sent. If set, WinHttp will use the caller-provided string as the hostname for DNS resolution.</p>
<h2>WINHTTP_OPTION_RESOLVE_TIMEOUT</h2>
<p>Sets or retrieves an unsigned long integer value that contains the time-out value, in milliseconds, to resolve a host name. The default timeout value is <strong>INFINITE</strong>. If a non-default value is specified, there is an overhead of one thread-creation per name resolution.</p>
<h2>WINHTTP_OPTION_REVERT_IMPERSONATION_SERVER_CERT</h2>
<p>Reverts any thread impersonation when building the server cert chain, forcing the use of the process token instead.</p>
<h2>WINHTTP_OPTION_SECURE_PROTOCOLS</h2>
<p>Sets an unsigned long integer value that specifies which Secure (HTTPS) protocols are acceptable. The
default value for this setting varies by operating system version and may be impacted by installed updates.</p>
<ul>
<li>Windows 11. By default, only TLS1.2 and TLS1.3 are enabled.</li>
<li>Windows 10, and Windows 8.1. By default, only SSL3, TLS1.0, TLS1.1, and TLS1.2 are enabled.</li>
<li>Windows 8 and Windows 7. By default, only SSL3 and TLS1 are enabled.</li>
</ul>
<p>The value can be a combination of one or more of the following values.</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>WINHTTP_FLAG_SECURE_PROTOCOL_ALL</td>
<td>The Secure Sockets Layer (SSL) 2.0, SSL 3.0, and Transport Layer Security (TLS) 1.0 protocols can be used.</td>
</tr>
<tr>
<td>WINHTTP_FLAG_SECURE_PROTOCOL_SSL2</td>
<td>The SSL 2.0 protocol can be used.</td>
</tr>
<tr>
<td>WINHTTP_FLAG_SECURE_PROTOCOL_SSL3</td>
<td>The SSL 3.0 protocol can be used.</td>
</tr>
<tr>
<td>WINHTTP_FLAG_SECURE_PROTOCOL_TLS1</td>
<td>The TLS 1.0 protocol can be used.</td>
</tr>
<tr>
<td>WINHTTP_FLAG_SECURE_PROTOCOL_TLS1_1</td>
<td>The TLS 1.1 protocol can be used.</td>
</tr>
<tr>
<td>WINHTTP_FLAG_SECURE_PROTOCOL_TLS1_2</td>
<td>The TLS 1.2 protocol can be used.</td>
</tr>
<tr>
<td>WINHTTP_FLAG_SECURE_PROTOCOL_TLS1_3</td>
<td>The TLS 1.3 protocol can be used.</td>
</tr>
</tbody>
</table>
<p>If you need to enable support for newer protocols but are unable to recompile your application to use the appropriate values of <strong>WINHTTP_OPTION_SECURE_PROTOCOLS</strong>, then you can instead add the <code>DefaultSecureProtocols</code> registry entry. That registry entry allows you to specify which secure protocols should be used when the <strong>WINHTTP_OPTION_SECURE_PROTOCOLS</strong> option is not set.</p>
<blockquote>
<p>[!IMPORTANT]
The instructions below involve modifying the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these instructions carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, see <a href="https://support.microsoft.com/topic/how-to-back-up-and-restore-the-registry-in-windows-855140ad-e318-2a13-2829-d428a2ab0692">How to back up and restore the registry in Windows</a>.</p>
</blockquote>
<p>If an application does not call <a href="/windows/win32/api/winhttp/nf-winhttp-winhttpsetoption"><strong>WinHttpSetOption</strong></a>(<strong>WINHTTP_OPTION_SECURE_PROTOCOLS</strong>), the system checks for the <code>DefaultSecureProtocols</code> registry entry and, if it's present, overrides the existing operating system defaults with the protocols specified in the <code>DefaultSecureProtocols</code> registry entry. The WinHTTP-specified protocols can be overruled by Secure Channel (Schannel) configuration settings that may disable protocols.</p>
<p>You can add the <code>DefaultSecureProtocols</code> registry entry in the following path:</p>
<p><strong>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\WinHttp</strong></p>
<p>On x64-based computers, you must also add <code>DefaultSecureProtocols</code> to the <code>Wow6432Node</code> path:</p>
<p><strong>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Internet Settings\WinHttp</strong></p>
<p>The registry value is a DWORD bitmap. The value to use is determined by adding the values corresponding to the protocols desired.</p>
<table>
<thead>
<tr>
<th>DefaultSecureProtocols value</th>
<th>Protocol enabled</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00000008</td>
<td>Enable SSL 2.0 by default</td>
</tr>
<tr>
<td>0x00000020</td>
<td>Enable SSL 3.0 by default</td>
</tr>
<tr>
<td>0x00000080</td>
<td>Enable TLS 1.0 by default</td>
</tr>
<tr>
<td>0x00000200</td>
<td>Enable TLS 1.1 by default</td>
</tr>
<tr>
<td>0x00000800</td>
<td>Enable TLS 1.2 by default</td>
</tr>
<tr>
<td>0x00002000</td>
<td>Enable TLS 1.3 by default</td>
</tr>
</tbody>
</table>
<p>For example, if you want to override the default values for <strong>WINHTTP_OPTION_SECURE_PROTOCOLS</strong> to specify TLS 1.1 and TLS 1.2. In that case, take the value for TLS 1.1 (0x00000200) and the value for TLS 1.2 (0x00000800), add them together in calculator (in programmer mode), and the resulting registry value would be 0x00000A00.</p>
<h2>WINHTTP_OPTION_SECURITY_CERTIFICATE_STRUCT</h2>
<p>Retrieves the certificate for a SSL/TLS server into the <a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_certificate_info"><strong>WINHTTP_CERTIFICATE_INFO</strong></a> structure. The application must free the <strong>lpszSubjectInfo</strong> and <strong>lpszIssuerInfo</strong> members with <a href="/windows/win32/api/winbase/nf-winbase-localfree"><strong>LocalFree</strong></a>.</p>
<h2>WINHTTP_OPTION_SECURITY_FLAGS</h2>
<p>Sets or retrieves an unsigned long integer value that contains the security flags for a handle. It can be a combination of these values:</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->SECURITY_FLAG_IGNORE_CERT_CN_INVALID</td>
<td>Allows an invalid common name in a certificate; that is, the server name specified by the application doesn't match the common name in the certificate. If this flag is set, the application doesn't receive a <strong>WINHTTP_CALLBACK_STATUS_FLAG_CERT_CN_INVALID</strong> callback.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->SECURITY_FLAG_IGNORE_CERT_DATE_INVALID</td>
<td>Allows an invalid certificate date, that is, an expired or not-yet-effective certificate. If this flag is set, the application doesn't receive a <strong>WINHTTP_CALLBACK_STATUS_FLAG_CERT_DATE_INVALID</strong> callback.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->SECURITY_FLAG_IGNORE_UNKNOWN_CA</td>
<td>Allows an invalid certificate authority. If this flag is set, the application doesn't receive a <strong>WINHTTP_CALLBACK_STATUS_FLAG_INVALID_CA</strong> callback.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->SECURITY_FLAG_IGNORE_CERT_WRONG_USAGE</td>
<td>Allows the identity of a server to be established with a non-server certificate (for example, a client certificate).</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->SECURITY_FLAG_IGNORE_WEAK_SIGNATURE</td>
<td>Allows a weak signature to be ignored.<!-- raw HTML omitted -->This flag is available in the rollup update for each OS starting with Windows 7 and Windows Server 2008 R2.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->SECURITY_FLAG_SECURE</td>
<td>Uses secure transfers. This is only returned in a call to <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpqueryoption"><strong>WinHttpQueryOption</strong></a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->SECURITY_FLAG_STRENGTH_MEDIUM</td>
<td>Uses medium (56-bit) encryption. This is only returned in a call to <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpqueryoption"><strong>WinHttpQueryOption</strong></a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->SECURITY_FLAG_STRENGTH_STRONG</td>
<td>Uses strong (128-bit) encryption. This is only returned in a call to <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpqueryoption"><strong>WinHttpQueryOption</strong></a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->SECURITY_FLAG_STRENGTH_WEAK</td>
<td>Uses weak (40-bit) encryption. This is only returned in a call to <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpqueryoption"><strong>WinHttpQueryOption</strong></a>.</td>
</tr>
</tbody>
</table>
<h2>WINHTTP_OPTION_SECURITY_INFO</h2>
<p>Retreives the SChannel connection and cipher information for a request.</p>
<h2>WINHTTP_OPTION_SECURITY_KEY_BITNESS</h2>
<p>Retrieves an unsigned long integer value that contains the cipher strength of the encryption key. A larger number indicates stronger cipher strength encryption.</p>
<h2>WINHTTP_OPTION_SEND_TIMEOUT</h2>
<p>Sets or retrieves an unsigned long integer value that contains the time-out value, in milliseconds, to send a request or write some data. If sending the request takes longer than the timeout, the send operation is canceled. The default timeout is 30 seconds.</p>
<h2>WINHTTP_OPTION_SERVER_CBT</h2>
<p>Gets a pointer to <a href="/windows/win32/api/sspi/ns-sspi-secpkgcontext_bindings"><strong>SecPkgContext_Bindings</strong></a> structure that specifies a Channel Binding Token (CBT).</p>
<p>A Channel Binding Token is a property of a secure transport channel and is used to bind an authentication channel to the secure transport channel. This token can only be obtained by this option after an SSL connection has been established.</p>
<blockquote>
<p>[!NOTE]
Passing this option and a <strong>null</strong> value for <em>lpBuffer</em> to <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpqueryoption"><strong>WinHttpQueryOption</strong></a> will return ERROR_INSUFFICIENT_BUFFER and the required byte size for the buffer in the <em>lpdwBufferLength</em> parameter. This returned buffer size value can be passed in a subsequent call to query for the Channel Binding Token. These steps are necessary when handling WINHTTP_CALLBACK_STATUS_REQUEST if you want to modify request headers based on the Channel Binding Token. Note that Windows XP and Vista do not support modifying request headers during this callback.</p>
</blockquote>
<h2>WINHTTP_OPTION_SERVER_CERT_CHAIN_CONTEXT</h2>
<p>Retrieves the server certification chain context. <strong>WINHTTP_OPTION_SERVER_CERT_CHAIN_CONTEXT</strong> can be passed to obtain a duplicated pointer to the <strong>CERT_CHAIN_CONTEXT</strong> for a server certificate chain received during a negotiated SSL connection. The client must call <a href="/windows/win32/api/wincrypt/nf-wincrypt-certfreecertificatecontext"><strong>CertFreeCertificateContext</strong></a> on the returned PCCERT_CONTEXT pointer that is filled into the buffer.</p>
<h2>WINHTTP_OPTION_SERVER_CERT_CONTEXT</h2>
<p>Retrieves the server certification context. <strong>WINHTTP_OPTION_SERVER_CERT_CONTEXT</strong> can be passed to obtain a duplicated pointer to the <a href="/windows/win32/api/wincrypt/ns-wincrypt-cert_context"><strong>CERT CONTEXT</strong></a> for a server certificate received during a negotiated SSL connection. The client must call <a href="/windows/win32/api/wincrypt/nf-wincrypt-certfreecertificatecontext"><strong>CertFreeCertificateContext</strong></a> on the returned PCCERT_CONTEXT pointer that is filled into the buffer.</p>
<h2>WINHTTP_OPTION_SERVER_SPN_USED</h2>
<p>Gets the server Server Principal Name that WinHTTP supplied to SSPI during authentication. This string value can be passed to <a href="/windows/win32/api/sspi/nf-sspi-sspipromptforcredentialsa"><strong>SspiPromptForCredentials</strong></a> after an authentication failure.</p>
<h2>WINHTTP_OPTION_SPN</h2>
<p>Includes or removes the server port number when the SPN (service principal name) is built for Kerberos or Negotiate Kerberos authentication. This flag is one of the following values:</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_DISABLE_SPN_SERVER_PORT</td>
<td>Removes the server port number.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WINHTTP_ENABLE_SPN_SERVER_PORT</td>
<td>Includes the server port number.</td>
</tr>
</tbody>
</table>
<h2>WINHTTP_OPTION_STREAM_ERROR_CODE</h2>
<p>This option can be queried on a WinHttp request handle, and will return the error code indicated by a RST_STREAM frame received on an HTTP stream.</p>
<h2>WINHTTP_OPTION_TCP_FAST_OPEN</h2>
<p>Enables TCP Fast Open for the connection.</p>
<h2>WINHTTP_OPTION_TCP_KEEPALIVE</h2>
<p>This option can be set on a WinHttp session handle to enable TCP keep-alive behavior on the underlying socket. Takes a <a href="/windows/win32/winsock/sio-keepalive-vals"><strong>tcp_keepalive</strong></a> struct.</p>
<h2>WINHTTP_OPTION_TLS_FALSE_START</h2>
<p>Enables TLS False Start for the connection.</p>
<h2>WINHTTP_OPTION_TCP_PRIORITY_STATUS</h2>
<p>Query the hinted priority of the TCP socket set with <strong>WINHTTP_OPTION_TCP_PRIORITY_HINT</strong>. See the documentation for <a href="/windows/win32/winsock/winsock-ioctls#sio_set_priority_hint-opcode-setting-i-t3"><strong>SIO_SET_PRIORITY_HINT</strong></a> for more details.</p>
<h2>WINHTTP_OPTION_TLS_PROTOCOL_INSECURE_FALLBACK</h2>
<p>This option can be set on a WinHttp session handle to control whether fallback to TLS 1.0 is allowed if there is a TLS handshake failure with a newer protocol version.</p>
<h2>WINHTTP_OPTION_UNLOAD_NOTIFY_EVENT</h2>
<p>Takes an event that will be set when the last callback has completed for a particular session. This flag must be must be used on a session handle. The event cannot be closed until after it has been set by WinHTTP.</p>
<h2>WINHTTP_OPTION_UNSAFE_HEADER_PARSING</h2>
<p>This option is reserved for internal use and should not be called.</p>
<h2>WINHTTP_OPTION_UPGRADE_TO_WEB_SOCKET</h2>
<p>Instructs the stack to start a WebSocket handshake process with <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsendrequest"><strong>WinHttpSendRequest</strong></a>. This option takes no parameters.</p>
<h2>WINHTTP_OPTION_URL</h2>
<p>Retrieves a string value that contains the full URL of a downloaded resource. If the original URL contained any extra data, such as search strings or anchors, or if the call was redirected, the URL returned differs from the original. The application should pass in a buffer, sized in bytes, that is big enough to hold the returned URL in wide char.</p>
<h2>WINHTTP_OPTION_USE_GLOBAL_SERVER_CREDENTIALS</h2>
<p>Takes a <strong>BOOL</strong> and can be set only a session handle. It will only propagate down to handles created from the session handle after the option has been set. If <strong>TRUE</strong>, this option causes as a last resort the use of global server credentials that were pushed down from WinInet. The default for this option is <strong>FALSE</strong>. This option requires registry key <strong>HKLM\Software\Microsoft\Windows\CurrentVersion\Internet Settings!ShareCredsWithWinHttp</strong>. This registry key is not present by default. When it is set, WinINet will send credentials down to WinHTTP. Whenever WinHttp gets an authentication challenge and if there are no credentials set on the current handle, it will use the credentials provided by WinINet.</p>
<h2>WINHTTP_OPTION_USE_SESSION_SCH_CRED</h2>
<p>Allows setting a single credential to use by default for all endpoints within the session instead of having per-endpoint default credentials. That might improve performance by reducing credential management overhead. Note that this default credential will have no effect when a client certificate is explicitly provided.</p>
<h2>WINHTTP_OPTION_USER_AGENT</h2>
<p>Sets or retrieves the <a href="glossary.html"><em>user agent</em></a> string on handles supplied by <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpopen"><strong>WinHttpOpen</strong></a> and used in subsequent <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsendrequest"><strong>WinHttpSendRequest</strong></a> functions, as long as it is not overridden by a header added by <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpaddrequestheaders"><strong>WinHttpAddRequestHeaders</strong></a> or <strong>WinHttpSendRequest</strong>. When retrieving a user agent, the application should pass in a buffer, sized in bytes, that is big enough to hold the returned URL in wide char. When setting the user agent, the buffer size is the length of the string, in characters, plus the <strong>NULL</strong> terminator.</p>
<h2>WINHTTP_OPTION_USERNAME</h2>
<p>Sets or retrieves a string that contains the user name.</p>
<h2>WINHTTP_OPTION_WEB_SOCKET_CLOSE_TIMEOUT</h2>
<p>Sets the time, in milliseconds, that <a href="/windows/win32/api/winhttp/nf-winhttp-winhttpwebsocketclose"><strong>WinHttpWebSocketClose</strong></a> should wait to complete the close handshake. The default is 10 seconds.</p>
<h2>WINHTTP_OPTION_WEB_SOCKET_KEEPALIVE_INTERVAL</h2>
<p>Sets the interval, in milliseconds, to send a keep-alive packet over the connection. The default interval is 30000 (30 seconds). The minimum interval is 15000 (15 seconds). Using <a href="/windows/win32/api/Winhttp/nf-winhttp-winhttpsetoption"><strong>WinHttpSetOption</strong></a> to set a value lower than 15000 will return with <strong>ERROR_INVALID_PARAMETER</strong>.</p>
<blockquote>
<p>[!NOTE]
The default value for <strong>WINHTTP_OPTION_WEB_SOCKET_KEEPALIVE_INTERVAL</strong> is read from <strong>HKLM:\SOFTWARE\Microsoft\WebSocket\KeepaliveInterval</strong>. If a value is not set, the default value of 30000 will be used. It is not possible to have a lower keepalive interval than 15000 milliseconds.</p>
</blockquote>
<h2>WINHTTP_OPTION_WEB_SOCKET_RECEIVE_BUFFER_SIZE</h2>
<p>Sets or retrieves a DWORD which specifies the receive buffer size to be used on WebSocket connections.</p>
<h2>WINHTTP_OPTION_WEB_SOCKET_SEND_BUFFER_SIZE</h2>
<p>Sets or retrieves a DWORD which specifies the send buffer size to be used on WebSocket connections.</p>
<h2>WINHTTP_OPTION_WORKER_THREAD_COUNT</h2>
<p>Sets an unsigned long integer value that specifies the number of worker threads the thread pool should use for asynchronous completions. The default value of this option is zero, which specifies that the number of worker threads is equal to the number of CPUs on the system. This option can only be set on a <strong>NULL</strong>  <a href="hinternet-handles-in-winhttp.html">HINTERNET</a> handle before an asynchronous operation has occurred. This option can only be set once.</p>
<p><strong>Applies to</strong>: Windows 7 and later; Windows Server 2008 R2 and later.</p>
<h2>WINHTTP_OPTION_WRITE_BUFFER_SIZE</h2>
<p>This option is deprecated; it has no effect.</p>
<h2>Remarks</h2>
<p>The following table lists the option flags by specifying which handles they can act upon, whether they can be queried and set, and the data type used. An &quot;X&quot; indicates that the option flag is valid for use with the function or handle, while a &quot;-&quot; specifies that the option flag is invalid.</p>
<p>Attempting to set or query an option flag on a Windows version where it is not supported will result in <strong>ERROR_WINHTTP_INVALID_OPTION</strong>.</p>
<table>
<thead>
<tr>
<th>Option flag, and data type</th>
<th>Session handle</th>
<th>Request handle</th>
<th>Query option</th>
<th>Set option</th>
<th>Minimum Windows Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>WINHTTP_OPTION_ASSURED_NON_BLOCKING_CALLBACKS<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_AUTOLOGON_POLICY<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_BACKGROUND_CONNECTIONS<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 21H1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_CALLBACK<!-- raw HTML omitted --><strong>LPVOID</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_CLIENT_CERT_CONTEXT<!-- raw HTML omitted --><a href="/windows/win32/api/wincrypt/ns-wincrypt-cert_context"><strong>CERT_CONTEXT</strong></a></td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>Windows Vista</td>
</tr>
<tr>
<td>WINHTTP_OPTION_CLIENT_CERT_ISSUER_LIST<!-- raw HTML omitted --><a href="/windows/win32/api/schannel/ns-schannel-secpkgcontext_issuerlistinfoex"><strong>SecPkgContext_IssuerListInfoEx</strong></a></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>Windows Vista</td>
</tr>
<tr>
<td>WINHTTP_OPTION_CODEPAGE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_CONFIGURE_PASSPORT_AUTH<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_CONNECT_RETRIES<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_CONNECT_TIMEOUT<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_CONNECTION_INFO<!-- raw HTML omitted --><a href="/windows/win32/api/Winhttp/ns-winhttp-winhttp_connection_info"><strong>WINHTTP_CONNECTION_INFO</strong></a></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_CONNECTION_STATS_V0<!-- raw HTML omitted --><a href="/windows/win32/api/mstcpip/ns-mstcpip-tcp_info_v0"><strong>TCP_INFO_v0</strong></a></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>Windows 10 Version 1903</td>
</tr>
<tr>
<td>WINHTTP_OPTION_CONNECTION_STATS_V1<!-- raw HTML omitted --><a href="/windows/win32/api/mstcpip/ns-mstcpip-tcp_info_v1"><strong>TCP_INFO_v1</strong></a></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>Windows 10 Version 2004</td>
</tr>
<tr>
<td>WINHTTP_OPTION_CONTEXT_VALUE<!-- raw HTML omitted --><strong>DWORD_PTR</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_DECOMPRESSION<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>Windows 8.1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_DISABLE_CERT_CHAIN_BUILDING<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 21H1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_DISABLE_FEATURE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_DISABLE_SECURE_PROTOCOL_FALLBACK<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 1903</td>
</tr>
<tr>
<td>WINHTTP_OPTION_DISABLE_STREAM_QUEUE<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 1809</td>
</tr>
<tr>
<td>WINHTTP_OPTION_ENABLE_FEATURE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>*</td>
<td>*</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_ENABLE_HTTP_PROTOCOL<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 1607</td>
</tr>
<tr>
<td>WINHTTP_OPTION_ENABLE_HTTP2_PLUS_CLIENT_CERT_CONTEXT<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 21H1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_ENABLETRACING<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_ENCODE_EXTRA<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 1803</td>
</tr>
<tr>
<td>WINHTTP_OPTION_EXPIRE_CONNECTION<!-- raw HTML omitted -->N/A</td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 1903</td>
</tr>
<tr>
<td>WINHTTP_OPTION_EXTENDED_ERROR<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_FIRST_AVAILABLE_CONNECTION<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 21H1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_GLOBAL_PROXY_CREDS<!-- raw HTML omitted --><a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_creds"><strong>WINHTTP_CREDS</strong></a></td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_GLOBAL_SERVER_CREDS<!-- raw HTML omitted --><a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_creds_ex"><strong>WINHTTP_CREDS_EX</strong></a></td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_HANDLE_TYPE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_HTTP_PROTOCOL_REQUIRED<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 1903</td>
</tr>
<tr>
<td>WINHTTP_OPTION_HTTP_PROTOCOL_USED<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>Windows 10 Version 1607</td>
</tr>
<tr>
<td>WINHTTP_OPTION_HTTP_VERSION<!-- raw HTML omitted --><a href="/windows/win32/api/winhttp/ns-winhttp-http_version_info"><strong>HTTP_VERSION_INFO</strong></a></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_HTTP2_KEEPALIVE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 21H1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_HTTP2_PLUS_TRANSFER_ENCODING<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 21H1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_IGNORE_CERT_REVOCATION_OFFLINE<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 2004</td>
</tr>
<tr>
<td>WINHTTP_OPTION_IPV6_FAST_FALLBACK<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 1903</td>
</tr>
<tr>
<td>WINHTTP_OPTION_IS_PROXY_CONNECT_RESPONSE<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_MAX_CONNS_PER_1_0_SERVER<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_MAX_CONNS_PER_SERVER<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_MAX_HTTP_AUTOMATIC_REDIRECTS<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_MAX_HTTP_STATUS_CONTINUE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_MAX_RESPONSE_DRAIN_SIZE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_MAX_RESPONSE_HEADER_SIZE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_PARENT_HANDLE<!-- raw HTML omitted --><a href="hinternet-handles-in-winhttp.html">HINTERNET</a></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_PASSPORT_COBRANDING_TEXT<!-- raw HTML omitted --><strong>LPWSTR</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_PASSPORT_COBRANDING_URL<!-- raw HTML omitted --><strong>LPWSTR</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_PASSPORT_RETURN_URL<!-- raw HTML omitted --><strong>LPVOID</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_PASSPORT_SIGN_OUT<!-- raw HTML omitted --><strong>LPVOID</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_PASSWORD<!-- raw HTML omitted --><strong>LPWSTR</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_PROXY<!-- raw HTML omitted --><a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_proxy_info"><strong>WINHTTP_PROXY_INFO</strong></a></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_PROXY_PASSWORD<!-- raw HTML omitted --><strong>LPWSTR</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_PROXY_SPN_USED<!-- raw HTML omitted --><strong>LPWSTR</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_PROXY_USERNAME<!-- raw HTML omitted --><strong>LPWSTR</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_READ_BUFFER_SIZE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_RECEIVE_PROXY_CONNECT_RESPONSE<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_RECEIVE_RESPONSE_TIMEOUT<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_RECEIVE_TIMEOUT<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_REDIRECT_POLICY<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_REJECT_USERPWD_IN_URL<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_REQUEST_PRIORITY<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_REQUEST_STATS<!-- raw HTML omitted --><a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_request_stats"><strong>WINHTTP_REQUEST_STATS</strong></a></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>Windows 10 Version 1903</td>
</tr>
<tr>
<td>WINHTTP_OPTION_REQUEST_TIMES<!-- raw HTML omitted --><a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_request_times"><strong>WINHTTP_REQUEST_TIMES</strong></a></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>Windows 10 Version 1903</td>
</tr>
<tr>
<td>WINHTTP_OPTION_REQUIRE_STREAM_END<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 21H1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_RESOLUTION_HOSTNAME<!-- raw HTML omitted --><strong>LPWSTR</strong></td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 21H1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_RESOLVE_TIMEOUT<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_SECURE_PROTOCOLS<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_SECURITY_CERTIFICATE_STRUCT<!-- raw HTML omitted --><a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_certificate_info"><strong>WINHTTP_CERTIFICATE_INFO</strong></a></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_SECURITY_FLAGS<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_SECURITY_INFO<!-- raw HTML omitted --><a href="/windows/win32/api/winhttp/ns-winhttp-winhttp_security_info"><strong>WINHTTP_SECURITY_INFO</strong></a></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>Windows 10 Version 2004</td>
</tr>
<tr>
<td>WINHTTP_OPTION_SECURITY_KEY_BITNESS<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_SEND_TIMEOUT<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_SERVER_CBT<!-- raw HTML omitted --><a href="/windows/win32/api/sspi/ns-sspi-secpkgcontext_bindings"><strong>SecPkgContext_Bindings</strong></a>*</td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_SERVER_CERT_CHAIN_CONTEXT<!-- raw HTML omitted --><a href="/windows/win32/api/wincrypt/ns-wincrypt-cert_chain_context"><strong>CERT_CHAIN_CONTEXT</strong></a></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>Windows 10 Version 2004</td>
</tr>
<tr>
<td>WINHTTP_OPTION_SERVER_CERT_CONTEXT<!-- raw HTML omitted --><a href="/windows/win32/api/wincrypt/ns-wincrypt-cert_context"><strong>CERT CONTEXT</strong></a></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_SERVER_SPN_USED<!-- raw HTML omitted --><strong>LPWSTR</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_SPN<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_STREAM_ERROR_CODE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>Windows 10 Version 21H1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_TCP_FAST_OPEN<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 2004</td>
</tr>
<tr>
<td>WINHTTP_OPTION_TCP_KEEPALIVE<!-- raw HTML omitted --><a href="/windows/win32/winsock/sio-keepalive-vals"><strong>tcp_keepalive</strong></a></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 2004</td>
</tr>
<tr>
<td>WINHTTP_OPTION_TLS_FALSE_START<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 2004</td>
</tr>
<tr>
<td>WINHTTP_OPTION_TLS_PROTOCOL_INSECURE_FALLBACK<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>Windows 10 Version 21H1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_UNLOAD_NOTIFY_EVENT<!-- raw HTML omitted --><a href="hinternet-handles-in-winhttp.html">HINTERNET</a></td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_UNSAFE_HEADER_PARSING<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_UPGRADE_TO_WEB_SOCKET<!-- raw HTML omitted -->N/A</td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_URL<!-- raw HTML omitted --><strong>LPWSTR</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_USE_GLOBAL_SERVER_CREDENTIALS<!-- raw HTML omitted --><strong>BOOL</strong></td>
<td>X</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_USER_AGENT<!-- raw HTML omitted --><strong>LPWSTR</strong></td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_USERNAME<!-- raw HTML omitted --><strong>LPWSTR</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_WEB_SOCKET_CLOSE_TIMEOUT<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_WEB_SOCKET_KEEPALIVE_INTERVAL<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_WEB_SOCKET_RECEIVE_BUFFER_SIZE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>Windows 8.1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_WEB_SOCKET_SEND_BUFFER_SIZE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>Windows 8.1</td>
</tr>
<tr>
<td>WINHTTP_OPTION_WORKER_THREAD_COUNT<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>-</td>
</tr>
<tr>
<td>WINHTTP_OPTION_WRITE_BUFFER_SIZE<!-- raw HTML omitted --><strong>DWORD</strong></td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
</tbody>
</table>
<blockquote>
<p>[!NOTE]
For Windows XP and Windows 2000, see <a href="winhttp-start-page.html">Run-Time Requirements</a>.</p>
</blockquote>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client</td>
<td>Windows XP, Windows 2000 Professional with SP3 [desktop apps only]</td>
</tr>
<tr>
<td>Minimum supported server</td>
<td>Windows Server 2003, Windows 2000 Server with SP3 [desktop apps only]</td>
</tr>
<tr>
<td>Redistributable</td>
<td>WinHTTP 5.0 and Internet Explorer 5.01 or later on Windows XP and Windows 2000.</td>
</tr>
<tr>
<td>Header</td>
<td>Winhttp.h</td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<ul>
<li><a href="winhttp-versions.html">WinHTTP versions</a></li>
</ul>
</body>
