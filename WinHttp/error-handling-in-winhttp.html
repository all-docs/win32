<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Error Handling in WinHTTP</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Error Handling in WinHTTP
ms.assetid: 96bceda2-ca96-4f88-ab38-35021889c2dd
title: Error Handling in WinHTTP
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Error Handling in WinHTTP</h1>
<p>Not all WinHTTP API functions report errors in the same way.</p>
<p>Some functions, such as <a href="/windows/desktop/api/Winhttp/nf-winhttp-winhttpsettimeouts"><strong>WinHttpSetTimeouts</strong></a>, return a <strong>BOOL</strong> that indicates failure when <strong>FALSE</strong>. If <strong>FALSE</strong> is returned, callers interested in the error should call <a href="/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a>. If <strong>GetLastError</strong> is called when the function succeded (returned anything but <strong>FALSE</strong>), the returned value is unpredictable and may change between Windows versions, Service Packs, or even between calls to the same function.</p>
<p>Some functions, such as <a href="/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect"><strong>WinHttpConnect</strong></a>, return an <a href="hinternet-handles-in-winhttp.html">HINTERNET</a> pseudo handle. These functions are exactly the same, except failure is indicated by returning <strong>NULL</strong>. If <strong>NULL</strong> is returned, callers interested in the error should call <a href="/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a>. If <strong>GetLastError</strong> is called when the function succeded (returned anything but <strong>NULL</strong>), the returned value is unpredictable and may change between Windows versions, Service Packs, or even between calls to the same function.</p>
<p>Some functions, such as <a href="/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyresult"><strong>WinHttpGetProxyResult</strong></a>, return a <strong>DWORD</strong> error code and there is no need to call any other functions for more error information. For these functions, <a href="/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a> should not be called. If <strong>GetLastError</strong> is called, regardless of the success or failure of the function, the returned value is unpredictable and may change between Windows versions, Service Packs, or even between calls to the same function.</p>
<p>Â </p>
<p>Â </p>
</body>
