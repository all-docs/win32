<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IADsPrintQueue Property Methods</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IADsPrintQueue Property Methods (Iads.h)
description: The property methods of the IADsPrintQueue interface get or set the properties described in the following table. For more information, see Interface Property Methods.
ms.assetid: 7f5b4200-65c8-4230-8561-ad4fefb391f3
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>IADsPrintQueue Property Methods ADSI
topic_type:</li>
<li>apiref
api_name:</li>
<li>IADsPrintQueue Property Methods</li>
<li>IADsPrintQueue.BannerPage</li>
<li>IADsPrintQueue.get_BannerPage</li>
<li>IADsPrintQueue.put_BannerPage</li>
<li>IADsPrintQueue.Datatype</li>
<li>IADsPrintQueue.get_Datatype</li>
<li>IADsPrintQueue.put_Datatype</li>
<li>IADsPrintQueue.DefaultJobPriority</li>
<li>IADsPrintQueue.get_DefaultJobPriority</li>
<li>IADsPrintQueue.put_DefaultJobPriority</li>
<li>IADsPrintQueue.Description</li>
<li>IADsPrintQueue.get_Description</li>
<li>IADsPrintQueue.put_Description</li>
<li>IADsPrintQueue.HostComputer</li>
<li>IADsPrintQueue.get_HostComputer</li>
<li>IADsPrintQueue.put_HostComputer</li>
<li>IADsPrintQueue.Location</li>
<li>IADsPrintQueue.get_Location</li>
<li>IADsPrintQueue.put_Location</li>
<li>IADsPrintQueue.Model</li>
<li>IADsPrintQueue.get_Model</li>
<li>IADsPrintQueue.put_Model</li>
<li>IADsPrintQueue.PrintDevices</li>
<li>IADsPrintQueue.get_PrintDevices</li>
<li>IADsPrintQueue.put_PrintDevices</li>
<li>IADsPrintQueue.PrinterPath</li>
<li>IADsPrintQueue.get_PrinterPath</li>
<li>IADsPrintQueue.put_PrinterPath</li>
<li>IADsPrintQueue.PrintProcessor</li>
<li>IADsPrintQueue.get_PrintProcessor</li>
<li>IADsPrintQueue.put_PrintProcessor</li>
<li>IADsPrintQueue.Priority</li>
<li>IADsPrintQueue.get_Priority</li>
<li>IADsPrintQueue.put_Priority</li>
<li>IADsPrintQueue.StartTime</li>
<li>IADsPrintQueue.get_StartTime</li>
<li>IADsPrintQueue.put_StartTime</li>
<li>IADsPrintQueue.UntilTime</li>
<li>IADsPrintQueue.get_UntilTime</li>
<li>IADsPrintQueue.put_UntilTime
api_location:</li>
<li>Activeds.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>IADsPrintQueue Property Methods</h1>
<p>The property methods of the <a href="/windows/desktop/api/Iads/nn-iads-iadsprintqueue"><strong>IADsPrintQueue</strong></a> interface get or set the properties described in the following table. For more information, see <a href="interface-property-methods.html">Interface Property Methods</a>.</p>
<h2>Properties</h2>
<!-- raw HTML omitted -->
<p><strong>BannerPage</strong></p>
<!-- raw HTML omitted -->
<p>The file system path that points to the banner page used to separate print jobs. If <strong>NULL</strong>, no banner page is used.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_BannerPage(
  [out] BSTR* pbstrBannerPage
);
HRESULT put_BannerPage(
  [in] BSTR bstrBannerPage
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Datatype</strong></p>
<!-- raw HTML omitted -->
<p>The data type that can be processed by this queue.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_Datatype(
  [out] BSTR* pbstrDatatype
);
HRESULT put_Datatype(
  [in] BSTR bstrDatatype
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>DefaultJobPriority</strong></p>
<!-- raw HTML omitted -->
<p>The default priority assigned to each print job.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_DefaultJobPriority(
  [out] LONG* plDefaultJobPriority
);
HRESULT put_DefaultJobPriority(
  [in] BSTR lDefaultJobPriority
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Description</strong></p>
<!-- raw HTML omitted -->
<p>The text description of this print queue.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_Description(
  [out] BSTR* pbstrDescription
);
HRESULT put_Description(
  [in] BSTR bstrDescription
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>HostComputer</strong></p>
<!-- raw HTML omitted -->
<p>The ADsPath string that references the host computer.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_HostComputer(
  [out] BSTR* pbstrHostComputer
);
HRESULT put_HostComputer(
  [in] BSTR bstrHostComputer
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Location</strong></p>
<!-- raw HTML omitted -->
<p>The location of the queue as described by an administrator.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_Location(
  [out] BSTR* pbstrLocation
);
HRESULT put_Location(
  [in] BSTR bstrLocation
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Model</strong></p>
<!-- raw HTML omitted -->
<p>The name of the driver used by this print queue.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_Model(
  [out] BSTR* pbstrModel
);
HRESULT put_Model(
  [in] BSTR bstrModel
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>PrintDevices</strong></p>
<!-- raw HTML omitted -->
<p>A SAFEARRAY of <strong>BSTR</strong> that contains the names of the print devices to which this print queue spools jobs.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>VARIANT</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_PrintDevices(
  [out] VARIANT* pvPrintDevices
);
HRESULT put_PrintDevices(
  [in] VARIANT vPrintDevices
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>PrinterPath</strong></p>
<!-- raw HTML omitted -->
<p>The string that references the path by which a shared printer can be accessed.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_PrinterPath(
  [out] BSTR* pbstrPrinterPath
);
HRESULT put_PrinterPath(
  [in] BSTR bstrPrinterPath
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>PrintProcessor</strong></p>
<!-- raw HTML omitted -->
<p>The print processor associated with this queue.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_PrintProcessor(
  [out] BSTR* pbstrPrintProcessor
);
HRESULT put_PrintProcessor(
  [in] BSTR bstrPrintProcessor
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Priority</strong></p>
<!-- raw HTML omitted -->
<p>The priority of this printer object job queue for any connected devices. All jobs in higher priority print queue objects will be processed first.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>LONG</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_Priority(
  [out] LONG* plPriority
);
HRESULT put_Priority(
  [in] LONG lPriority
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>StartTime</strong></p>
<!-- raw HTML omitted -->
<p>The time when the queue should begin processing jobs. The date portion of the time is ignored.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>DATE</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_StartTime(
  [out] DATE* pdateStartTime
);
HRESULT put_StartTime(
  [in] DATE dateStartTime
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>UntilTime</strong></p>
<!-- raw HTML omitted -->
<p>The time when the queue should stop processing jobs.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>DATE</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_UntilTime(
  [out] DATE* pdateUntilTime
);
HRESULT put_UntilTime(
  [in] DATE dateUntilTime
);
</code></pre>
<!-- raw HTML omitted -->
<h2>Examples</h2>
<p>The following code example shows how to determine if a specified printer is online or offline.</p>
<pre lang="VB"><code>Dim pq As IADsPrintQueue
Dim pqo As IADsPrintQueueOperations
On Error GoTo Cleanup
 
Set pq = GetObject(&quot;WinNT://aMachine/aPrinter&quot;)
Set pqo = pq
If pqo.status = ADS_PRINTER_OFFLINE Then
    MsgBox pq.Model &amp; &quot;@&quot; &amp; pq.Location &amp; is offline.&quot;
Else
    MsgBox pq.Model &amp; &quot;@&quot; &amp; pq.Location &amp; is online.&quot;
End If

Cleanup:
    If (Err.Number&lt;&gt;0) Then
        MsgBox(&quot;An error has occurred. &quot; &amp; Err.Number)
    End If
    Set pq = Nothing
    Set pqo = Nothing
</code></pre>
<p>The following code example shows how to determine if a specified printer is online or offline.</p>
<pre lang="C++"><code>IADsPrintQueue *pq = NULL;
HRESULT hr = S_OK;
IADsPrintQueueOperations *pqo = NULL;
BSTR model = NULL;
BSTR location = NULL;

LPWSTR adsPath = L&quot;WinNT://aMachine/aPrinter&quot;;
hr = ADsGetObject(adsPath,
                  IID_IADsPrintQueue,
                  (void**)&amp;pq);
if(FAILED(hr)) {goto Cleanup;}


hr = pq-&gt;QueryInterface(IID_IADsPrintQueueOperations,(void**)&amp;pqo);
if(FAILED(hr)) {goto Cleanup;}

long status;
hr = pqo-&gt;get_Status(&amp;status);
if(FAILED(hr)) {goto Cleanup;}

hr = pq-&gt;get_Model(&amp;model);
if(FAILED(hr)) {goto Cleanup;}

hr =pq-&gt;get_Location(&amp;location);
if(FAILED(hr)) {goto Cleanup;}

if(status == ADS_PRINTER_OFFLINE) 
{
    printf(&quot;%S @ %S is offline.\n&quot;,model,location);
} 
else 
{
    printf(&quot;%S @ %S is online.\n&quot;,model,location);
}


Cleanup:
    SysFreeString(model);
    SysFreeString(location);
    if(pq) pq-&gt;Release();
    if(pqo) pqo-&gt;Release();
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Iads.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Activeds.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IADsPrintQueue is defined as B15160D0-1226-11CF-A985-00AA006BC149<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Iads/nn-iads-iadsprintqueue"><strong>IADsPrintQueue</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="interface-property-methods.html">Interface Property Methods</a></p>
<!-- raw HTML omitted -->
</body>
