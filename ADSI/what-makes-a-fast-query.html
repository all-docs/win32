<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>What Makes a Fast Query?</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: What Makes a Fast Query
description: This topic lists preferred programming methods to use while querying a directory.
ms.assetid: d96f330f-3c57-4edc-9fd2-970f908b54c2
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>What Makes a Fast Query ADSI</li>
<li>queries ADSI , what makes a fast query
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>What Makes a Fast Query?</h1>
<p>Consider the following performance enhancement concepts when executing a query:</p>
<ul>
<li>If possible, filter on indexed attributes only. Use index attributes that you expect will generate the fewest number of hits. For more information and a comprehensive list of indexed attributes for Windows, see <a href="/windows/desktop/ADSchema/active-directory-schema">Active Directory Schema</a>.</li>
<li>Search on <strong>objectCategory</strong> instead of <strong>objectClass</strong> because <strong>objectClass</strong> is not an indexed property.</li>
<li>Be aware of referrals. Consider searching the global catalog if your attributes are listed as GC replicated.</li>
<li>Avoid searching for text in the middle and at the end of a string. For example, &quot;cn=*hille*&quot; or &quot;cn=*larouse&quot;.</li>
<li>Assume that a subtree search will return a large result set. Use paging when performing subtree searches. The server will then be able to stream a large result set in chunks reducing the server-side memory resources. This effectively flattens out network usage and reduces the need for sending extremely large chunks of data over the network.</li>
<li>Properly scope your searches so as to not retrieve more than is necessary.</li>
<li>Perform a complex search on multiple attributes, because it is less performance intensive than performing multiple searches. One search for an object that reads two attributes is more efficient than two searches for the same object, each returning one attribute.</li>
<li>For reading attribute with a large number of values, use range limits to minimize the search size so that you can read a few thousand members at a time. For more information about specifying attribute range limits, see <a href="attribute-range-retrieval.html">Attribute Range Retrieval</a>.</li>
<li>Bind to an object hold the binding handle for the remainder of your session. Do not bind and unbind for each call. If you are using ADO or OLE DB, do not create many connection objects.</li>
<li>Read the rootDSE once and remember its contents for the remainder of your session.</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
