<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ADSI Component Interaction</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: ADSI Component Interaction
description: The Active Directory router component populates an ADSI provider table from the installed ADSI providers listed in the registry when it receives the first request from the client application.
ms.assetid: d5438059-1d98-44af-aeac-a3d987990222
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>ADSI Component Interaction</h1>
<p>The Active Directory router component populates an ADSI provider table from the installed ADSI providers listed in the registry when it receives the first request from the client application. For more information about the Registry, see <a href="installing-the-example-provider-component.html">Installing the Example Provider Component</a>.</p>
<p>Operations that make a request from a directory for a pointer to an interface on an Active Directory object come through a function (<strong>GetObject</strong> in Visual Basic or <a href="/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject"><strong>ADsOpenObject</strong></a> or <a href="/windows/desktop/api/Adshlp/nf-adshlp-adsgetobject"><strong>ADsGetObject</strong></a> in C or C++), or an interface method ( <a href="/windows/desktop/api/Iads/nf-iads-iadscontainer-getobject"><strong>IADsContainer::GetObject</strong></a>). In the following figure, the ADSI client application passes such a bind request to the ADSI router component (1). The router component identifies the ProgID for the provider from the first part of the ADsPath and uses <a href="/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid"><strong>CLSIDFromProgID</strong></a> to find the matching CLSID in the registry (2) and loads the proper provider component (3).</p>
<p><img src="images/dscspr.png" alt="adsi component interactions in the example provider" /></p>
<p>In the preceding figure, the provider component creates an Active Directory object representing the named directory element. The ADSI support component does a <strong>QueryInterface</strong> on the requested interface identifier. When a pointer to that interface is retrieved (4), as with all COM client/server implementations, it is then passed back to the client (5), and from then on the client application works directly with the provider component (6).</p>
<p>Â </p>
<p>Â </p>
</body>
