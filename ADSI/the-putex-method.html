<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>The PutEx Method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: The PutEx Method
description: The IADs PutEx method uses the name of a property to save a property with single or multiple values into the property cache.
ms.assetid: fb9a0610-e955-424b-a2b9-da4986d0ba5f
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>PutEx ADSI ,about</li>
<li>ADSI ADSI ,example code Visual Basic ,using the PutEx method</li>
<li>properties ADSI ,saving a single or multi-valued property to property cache
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>The PutEx Method</h1>
<p>The <a href="/windows/desktop/api/Iads/nf-iads-iads-putex"><strong>IADs::PutEx</strong></a> method uses the name of a property to save a property with single or multiple values into the property cache. This overwrites any value currently in the property cache. The values in the cache are not written to the underlying directory service until an <a href="/windows/desktop/api/Iads/nf-iads-iads-setinfo"><strong>IADs::SetInfo</strong></a> occurs. The first argument of <strong>PutEx</strong> indicates whether you want to replace or add to any existing values for the property. In the following example, any existing values of the <strong>description</strong> attribute are erased in the cache when <strong>PutEx</strong> is called, and erased on the server when <strong>SetInfo</strong> is called.</p>
<pre lang="VB"><code>Dim x As IADs
Set x = GetObject(&quot;LDAP://CN=Administrator,CN=Users,DC=Fabrikam,DC=com&quot;)
'----------------------------------------------
' Assume the otherHomePhoneNumber has the following values:
' 111-1111, 222-2222
'----------------------------------------------
x.PutEx ADS_PROPERTY_APPEND, &quot;OtherhomePhone&quot;, Array(&quot;333-3333&quot; )  
x.SetInfo              'Now the values are 111-1111,222-222,333-3333.
 
x.PutEx ADS_PROPERTY_DELETE, &quot;OtherHomePhone&quot;, Array(&quot;111-1111&quot;, &quot;222-2222&quot;)
x.SetInfo              'Now the values are 333-3333.
x.PutEx ADS_PROPERTY_UPDATE, &quot;OtherHomePhone&quot;, Array(&quot;888-8888&quot;, &quot;999-9999&quot;)
x.SetInfo              'Now the values are 888-8888,999-9999.
x.PutEx ADS_PROPERTY_CLEAR, &quot;OtherHomePhone&quot;,  vbNull
x.SetInfo              'Now the property has no value.
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
