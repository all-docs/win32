<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IADsADSystemInfo Property Methods</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IADsADSystemInfo Property Methods (Iads.h)
description: The property methods of the IADsADSystemInfo interface get or set the properties described in the following table. For more information, see Interface Property Methods.
ms.assetid: 1cdaa610-4341-4825-b2f9-dd495a9147ff
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>IADsADSystemInfo Property Methods ADSI
topic_type:</li>
<li>apiref
api_name:</li>
<li>IADsADSystemInfo Property Methods</li>
<li>IADsADSystemInfo.UserName</li>
<li>IADsADSystemInfo.get_UserName</li>
<li>IADsADSystemInfo.ComputerName</li>
<li>IADsADSystemInfo.get_ComputerName</li>
<li>IADsADSystemInfo.SiteName</li>
<li>IADsADSystemInfo.get_SiteName</li>
<li>IADsADSystemInfo.DomainShortName</li>
<li>IADsADSystemInfo.get_DomainShortName</li>
<li>IADsADSystemInfo.DomainDNSName</li>
<li>IADsADSystemInfo.get_DomainDNSName</li>
<li>IADsADSystemInfo.ForestDNSName</li>
<li>IADsADSystemInfo.get_ForestDNSName</li>
<li>IADsADSystemInfo.PDCRoleOwner</li>
<li>IADsADSystemInfo.get_PDCRoleOwner</li>
<li>IADsADSystemInfo.SchemaRoleOwner</li>
<li>IADsADSystemInfo.get_SchemaRoleOwner</li>
<li>IADsADSystemInfo.IsNativeMode</li>
<li>IADsADSystemInfo.get_IsNativeMode
api_location:</li>
<li>Activeds.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>IADsADSystemInfo Property Methods</h1>
<p>The property methods of the <a href="/windows/desktop/api/Iads/nn-iads-iadsadsysteminfo"><strong>IADsADSystemInfo</strong></a> interface get or set the properties described in the following table. For more information, see <a href="interface-property-methods.html">Interface Property Methods</a>.</p>
<h2>Properties</h2>
<!-- raw HTML omitted -->
<p><strong>ComputerName</strong></p>
<!-- raw HTML omitted -->
<p>Retrieves the distinguished name of the local computer.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_ComputerName(
  [out] BSTR* pbstrComputer
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>DomainDNSName</strong></p>
<!-- raw HTML omitted -->
<p>Retrieves the DNS name of the local computer's domain, such as &quot;domainName.companyName.com&quot;.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_DomainDNSName(
  [out] BSTR* pbstr
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>DomainShortName</strong></p>
<!-- raw HTML omitted -->
<p>Retrieves the short name of the local computer's domain, such as &quot;domainName&quot;.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_DomainShortName(
  [out] BSTR* pbstrDSN
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>ForestDNSName</strong></p>
<!-- raw HTML omitted -->
<p>Retrieves the DNS name of the local computer's forest.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_ForestDNSName(
  [out] BSTR* pbstr
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>IsNativeMode</strong></p>
<!-- raw HTML omitted -->
<p>Determines whether the local computer's domain is in native or mixed mode.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BOOL</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_IsNativeMode(
  [out] BOOL* pvBool
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>PDCRoleOwner</strong></p>
<!-- raw HTML omitted -->
<p>Retrieves the distinguished name of the directory service agent (DSA) object for the DC that owns the primary domain controller role in the local computer's domain.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_PDCRoleOwner(
  [out] BSTR* pbstr
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>SchemaRoleOwner</strong></p>
<!-- raw HTML omitted -->
<p>Retrieves the distinguished name of the directory service agent (DSA) object for the DC that owns the schema master role in the local computer's forest.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_SchemaRoleOwner(
  [out] BSTR* pbstr
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>SiteName</strong></p>
<!-- raw HTML omitted -->
<p>Retrieves the site name of the local computer.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_SiteName(
  [out] BSTR* pbstrSite
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>UserName</strong></p>
<!-- raw HTML omitted -->
<p>Retrieves the Active Directory distinguished name of the current user, which is the logged-on user or the user impersonated by the calling thread.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_UserName(
  [out] BSTR* pbstrUser
);
</code></pre>
<!-- raw HTML omitted -->
<h2>Examples</h2>
<p>The following C++ code example retrieves the Windows system information. For brevity, error checking is omitted.</p>
<pre lang="C++"><code>#include &lt;activeds.h&gt;
#include &lt;stdio.h&gt;
 
int main()
{
   HRESULT hr;
 
   hr = CoInitialize(NULL);
 
    IADsADSystemInfo *pSys;
    hr = CoCreateInstance(CLSID_ADSystemInfo,
                          NULL,
                          CLSCTX_INPROC_SERVER,
                          IID_IADsADSystemInfo,
                          (void**)&amp;pSys);
 
   BSTR bstr;
   hr = pSys-&gt;get_UserName(&amp;bstr);
   if (SUCCEEDED(hr)) {
      printf(&quot;User: %S\n&quot;, bstr);
      SysFreeString(bstr);
   }
 
   hr = pSys-&gt;get_ComputerName(&amp;bstr);
   if (SUCCEEDED(hr)) {
      printf(&quot;Computer: %S\n&quot;, bstr);
      SysFreeString(bstr);
   }
 
   hr = pSys-&gt;get_DomainDNSName(&amp;bstr);
   if (SUCCEEDED(hr)) {
      printf(&quot;Domain: %S\n&quot;, bstr);
      SysFreeString(bstr);
   }
 
   hr = pSys-&gt;get_PDCRoleOwner(&amp;bstr);
   if (SUCCEEDED(hr)) {
      printf(&quot;PDC Role owner: %S\n&quot;, bstr);
      SysFreeString(bstr);
   }
 
   if(pSys) {
      pSys-&gt;Release();
   }
 
   CoUninitialize();
   return 0;
}
</code></pre>
<p>The following Visual Basic code example retrieves the Windows system information.</p>
<pre lang="VB"><code>Dim sys As New ADSystemInfo
Debug.print &quot;User: &quot; &amp; sys.UserName
Debug.print &quot;Computer: &quot; &amp; sys.ComputerName
Debug.print &quot;Domain: &quot; &amp; sys.DomainDNSName
Debug.print &quot;PDC Role Owner: &quot; &amp; sys.PDCRoleOwner
</code></pre>
<p>The following VBScript/ASP code example retrieves the Windows system information.</p>
<pre lang="VB"><code>&lt;%
Dim sys
Set sys = CreateObject(&quot;ADSystemInfo&quot;)
Response.Write &quot;User: &quot; &amp; sys.UserName
Response.Write &quot;Computer: &quot; &amp; sys.ComputerName
Response.Write &quot;Domain: &quot; &amp; sys.DomainDNSName
Response.Write &quot;PDC Role Owner: &quot; &amp; sys.PDCRoleOwner
%&gt;
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Iads.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Activeds.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IADsADSystemInfo is defined as 5BB11929-AFD1-11D2-9CB9-0000F87A369E<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Iads/nn-iads-iadsadsysteminfo"><strong>IADsADSystemInfo</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a></p>
<!-- raw HTML omitted -->
</body>
