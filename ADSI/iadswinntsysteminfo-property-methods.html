<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IADsWinNTSystemInfo Property Methods</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IADsWinNTSystemInfo Property Methods (Iads.h)
description: The property methods of the IADsWinNTSystemInfo interface get or set the properties described in the following table. For more information, see Interface Property Methods.
ms.assetid: 5ba36851-3d03-4179-8cee-dbebe24b7c4e
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>IADsWinNTSystemInfo Property Methods ADSI
topic_type:</li>
<li>apiref
api_name:</li>
<li>IADsWinNTSystemInfo Property Methods</li>
<li>IADsWinNTSystemInfo.UserName</li>
<li>IADsWinNTSystemInfo.get_UserName</li>
<li>IADsWinNTSystemInfo.ComputerName</li>
<li>IADsWinNTSystemInfo.get_ComputerName</li>
<li>IADsWinNTSystemInfo.DomainName</li>
<li>IADsWinNTSystemInfo.get_DomainName</li>
<li>IADsWinNTSystemInfo.PDC</li>
<li>IADsWinNTSystemInfo.get_PDC
api_location:</li>
<li>Activeds.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>IADsWinNTSystemInfo Property Methods</h1>
<p>The property methods of the <a href="/windows/desktop/api/Iads/nn-iads-iadswinntsysteminfo"><strong>IADsWinNTSystemInfo</strong></a> interface get or set the properties described in the following table. For more information, see <a href="interface-property-methods.html">Interface Property Methods</a>.</p>
<h2>Properties</h2>
<!-- raw HTML omitted -->
<p><strong>ComputerName</strong></p>
<!-- raw HTML omitted -->
<p>Name of the host computer where the application is running.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_ComputerName(
  [out] BSTR* pbstrComputer
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>DomainName</strong></p>
<!-- raw HTML omitted -->
<p>Name of the domain to which the user belongs.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_DomainName(
  [out] BSTR* pbstrDomain
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>PDC</strong></p>
<!-- raw HTML omitted -->
<p>Name of the primary domain controller to which the host computer belongs.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_PDC(
  [out] BSTR* pbstrPDC
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>UserName</strong></p>
<!-- raw HTML omitted -->
<p>Name of the user account under which the <strong>WinNTSystemInfo</strong> object is created.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_UserName(
  [out] BSTR* pbstrUser
);
</code></pre>
<!-- raw HTML omitted -->
<h2>Examples</h2>
<p>The following C/C++ code example retrieves the WinNT system information. For brevity, error checking is omitted.</p>
<pre lang="C++"><code>#include &lt;activeds.h&gt;
#include &lt;stdio.h&gt;
 
int main()
{
   HRESULT hr;
 
   hr = CoInitialize(NULL);
 
    IADsWinNTSystemInfo *pNtSys;
    hr = CoCreateInstance(CLSID_WinNTSystemInfo,
                          NULL,
                          CLSCTX_INPROC_SERVER,
                          IID_IADsWinNTSystemInfo,
                          (void**)&amp;pNTsys);
 
   BSTR bstr;
   hr = pNtSys-&gt;get_UserName(&amp;bstr);
   if (SUCCEEDED(hr)) {
      printf(&quot;User: %S\n&quot;, bstr);
      SysFreeString(bstr);
   }
 
   hr = pNtSys-&gt;get_ComputerName(&amp;bstr);
   if (SUCCEEDED(hr)) {
      printf(&quot;Computer: %S\n&quot;, bstr);
      SysFreeString(bstr);
   }
 
   hr = pNtSys-&gt;get_DomainName(&amp;bstr);
   if (SUCCEEDED(hr)) {
      printf(&quot;Domain: %S\n&quot;, bstr);
      SysFreeString(bstr);
   }
 
   hr = pNtSys-&gt;get_PDC(&amp;bstr);
   if (SUCCEEDED(hr)) {
      printf(&quot;PDC: %S\n&quot;, bstr);
      SysFreeString(bstr);
   }
 
   if(pNtSys) {
      pNtSys-&gt;Release();
   }
 
   CoUninitialize();
   return 0;
}
</code></pre>
<p>The following Visual Basic code example retrieves the WinNT system information.</p>
<pre lang="VB"><code>Dim ntsys As New WinNTSystemInfo
Debug.print &quot;User: &quot; &amp; ntsys.UserName
Debug.print &quot;Computer: &quot; &amp; ntsys.ComputerName
Debug.print &quot;Domain: &quot; &amp; ntsys.DomainName
Debug.print &quot;PDC: &quot; &amp; ntsys.PDC
</code></pre>
<p>The following Visual Basic Scripting Edition/Active Server Pages code example retrieves the WinNT system information.</p>
<pre lang="VB"><code>&lt;%
Dim ntsys
Set ntsys = CreateObject(&quot;WinNTSystemInfo&quot;)
Response.Write &quot;User: &quot; &amp; ntsys.UserName
Response.Write &quot;Computer: &quot; &amp; ntsys.ComputerName
Response.Write &quot;Domain: &quot; &amp; ntsys.DomainName
Response.Write &quot;PDC: &quot; &amp; ntsys.PDC
%&gt;
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Iads.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Activeds.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IADsWinNTSystemInfo is defined as 6C6D65DC-AFD1-11D2-9CB9-0000F87A369E<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Iads/nn-iads-iadswinntsysteminfo"><strong>IADsWinNTSystemInfo</strong></a></p>
<!-- raw HTML omitted -->
</body>
