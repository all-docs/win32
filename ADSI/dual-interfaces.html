<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Dual Interfaces (ADSI)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Dual Interfaces (ADSI)
description: Use COM interfaces to access the properties and methods on any provider ADSI objects.
ms.assetid: 6f3fd725-d660-4cc3-8de2-8ed7800b1141
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Dual Interfaces (ADSI)</h1>
<p>Use COM interfaces to access the properties and methods on any provider ADSI objects. A read-only property maps to an interface entry of the form <strong>get_&lt;PropertyName&gt;</strong>. A read/write property maps to two interface entries of the form <strong>get_&lt;PropertyName&gt;</strong> and <strong>put_&lt;PropertyName&gt;</strong>.</p>
<p>All methods on a COM interface must:</p>
<ul>
<li>Return an HRESULT value to indicate success or failure. The <strong>HRESULT</strong> type is discussed in the COM specification.</li>
<li>On calls to <strong>QueryInterface</strong>, return <strong>E_NOINTERFACE</strong> for unimplemented interfaces.</li>
<li>Return <strong>E_NOTIMPL</strong> for unimplemented methods on interfaces that are otherwise implemented.</li>
<li>Return <strong>E_ADS_PROPERTY_NOT_SUPPORTED</strong> for interface properties that are not supported.</li>
</ul>
<p>To retain compatibility with Automation controllers, all parameters and return types should be within the subset defined by the Automation VARIANT data type. For more information, see <strong>VARIANT</strong> and <strong>VARIANTARG</strong> in the Platform Software Development Kit (SDK).</p>
<p>A provider Active Directory object can expose interfaces that use data types other than those in the <strong>VARIANT</strong> subset. However, Automation controllers such as Visual Basic are not able to call those interfaces. Most ADSI provider interfaces are derived from <a href="/windows/win32/api/oaidl/nn-oaidl-idispatch"><strong>IDispatch</strong></a> and can be used as <strong>IDispatch</strong> interface pointers. However, the <a href="/windows/desktop/api/Iads/nn-iads-idirectoryobject"><strong>IDirectoryObject</strong></a>, <a href="/windows/desktop/api/Iads/nn-iads-idirectorysearch"><strong>IDirectorySearch</strong></a>, and <a href="/windows/desktop/api/Iads/nn-iads-iadsextension"><strong>IADsExtension</strong></a> ADSI interfaces are not derived from <strong>IDispatch</strong>.</p>
<p>Â </p>
<p>Â </p>
</body>
