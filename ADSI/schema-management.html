<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Schema Management</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Schema Management
description: The ADSI example provider component defines the schema classes \ 0034;Organizational Unit \ 0034; and \ 0034;User \ 0034; and manages these schema classes in the following way.
ms.assetid: c3e07846-a11e-46d4-9863-a89810896ad7
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>Schema Management ADSI</li>
<li>schema management ADSI</li>
<li>managing schemas ADSI</li>
<li>schemas, managing ADSI</li>
<li>managing a schema ADSI
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Schema Management</h1>
<p>The ADSI example provider component defines the schema classes &quot;Organizational Unit&quot; and &quot;User&quot; and manages these schema classes in the following way.</p>
<p>The &quot;Organizational Unit&quot; schema class is represented by an ADs container object and can contain other &quot;Organizational Units&quot; and &quot;Users&quot;. The container object supports the interfaces <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a>, <a href="/windows/win32/api/oaidl/nn-oaidl-idispatch"><strong>IDispatch</strong></a>, <a href="/windows/desktop/api/Iads/nn-iads-iads"><strong>IADs</strong></a>, and <a href="/windows/desktop/api/Iads/nn-iads-iadscontainer"><strong>IADsContainer</strong></a>. The &quot;User&quot; schema class is represented by a generic Active Directory object and does not contain other types of objects. In the example provider component, the User object is implemented as a generic Active Directory object that supports the interfaces <strong>IUnknown</strong>, <strong>IDispatch</strong>, and <strong>IADs</strong>. Be aware that the User object, in this case, does not support the <a href="/windows/desktop/api/Iads/nn-iads-iadsuser"><strong>IADsUser</strong></a> interface.</p>
<p>The example provider component must also implement the ADs namespace object, which supports the interfaces <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a>, <a href="/windows/desktop/api/Iads/nn-iads-iads"><strong>IADs</strong></a>, <a href="/windows/desktop/api/Iads/nn-iads-iadscontainer"><strong>IADsContainer</strong></a>, <a href="/windows/desktop/api/Iads/nn-iads-iadsopendsobject"><strong>IADsOpenDSObject</strong></a>, and <a href="/windows/win32/api/oaidl/nn-oaidl-idispatch"><strong>IDispatch</strong></a>.</p>
<p>The following figure shows the details of the schema that represents the two example provider component schema classes.</p>
<p><img src="images/dssmsch.png" alt="adsi example provider component schema" /></p>
<p>Be aware that in the preceding figure the &quot;Organizational Unit&quot; schema class defines three properties: &quot;Description,&quot; &quot;Headcounts,&quot; and &quot;ID.&quot; The &quot;User&quot; schema class defines four properties: &quot;ID,&quot; &quot;Name,&quot; &quot;PhoneNumber,&quot; and &quot;Title.&quot; The &quot;ID&quot; property is shared by both schema classes. Each property is defined by either the &quot;String&quot; or the &quot;Integer&quot; syntax object.</p>
<blockquote>
<p>[!Note]<br />
Syntax objects are not present in the first release of the example provider component. However, in most Microsoft ADSI schema implementations, the syntax objects are included in the schema container object, just as the schema class and property objects are. For this reason, they are shown here.</p>
</blockquote>
<p>Â </p>
<p>This provider component makes schema data accessible to the ADSI client application in the form of ADs class objects, ADs property objects, and ADs syntax objects, all within a schema class container object, so that schema data can be retrieved at run time.</p>
<p>The ADsPaths for the schema class container objects defined for the example provider component are &quot;Sample://Seattle/schema&quot; and &quot;Sample://Toronto/schema&quot;. In this example, the contents of the schemas are identical.</p>
<p>Â </p>
<p>Â </p>
</body>
