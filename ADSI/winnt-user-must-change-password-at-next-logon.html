<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>User Must Change Password at Next Logon (WinNT Provider)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: User Must Change Password at Next Logon (WinNT Provider)
description: To enable this option, set the PasswordExpired attribute of the user to one (1). Setting this attribute to zero (0) enables the user to log on without changing the password.
ms.assetid: 97dd4232-dcd3-44bd-8a2a-1dcb0f85d53c
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>User Must Change Password at Next Logon (WinNT Provider) ADSI</li>
<li>User Must Change Password at Next Logon ADSI , WinNT provider</li>
<li>WinNT provider ADSI , user management examples, User Must Change Password at Next Logon
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>User Must Change Password at Next Logon (WinNT Provider)</h1>
<p>To enable this option, set the <strong>PasswordExpired</strong> attribute of the user to one (1). Setting this attribute to zero (0) enables the user to log on without changing the password.</p>
<h2>Example 1</h2>
<p>The following code example shows how to set the change password on next logon option using Visual Basic with ADSI.</p>
<pre lang="VB"><code>Set usr = GetObject(&quot;WinNT://Fabrikam/jeffsmith,user&quot;)
usr.Put &quot;PasswordExpired&quot;, CLng(1)   ' User must change password.
usr.SetInfo
</code></pre>
<h2>Example 2</h2>
<p>The following code example shows how to set the change password on next logon option using C++ with ADSI.</p>
<pre lang="C++"><code>IADsUser *pUser = NULL;
HRESULT hr;

hr=ADsGetObject(L&quot;WinNT://Fabrikam/jeffsmith,user&quot;,
                IID_IADsUser,
                (void**)&amp;pUser);
VARIANT var;
VariantInit(&amp;var);
V_I4(&amp;var)=1;
V_VT(&amp;var)=VT_I4;
hr = pUser-&gt;Put(_bstr_t(&quot;PasswordExpired&quot;),var); // User must change password.
hr = pUser-&gt;SetInfo();

VariantClear(&amp;var);
pUser-&gt;Release();
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
