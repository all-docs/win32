<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IADs Property Methods</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IADs Property Methods (Iads.h)
description: The property methods of the IADs interface get or set the properties described in the following table. For more information about property methods, see Interface Property Methods.
ms.assetid: d2f6f686-a35a-4a9a-9b57-2ceb2f26ef12
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>IADs Property Methods ADSI
topic_type:</li>
<li>apiref
api_name:</li>
<li>IADs Property Methods</li>
<li>IADs.ADsPath</li>
<li>IADs.get_ADsPath</li>
<li>IADs.Class</li>
<li>IADs.get_Class</li>
<li>IADs.GUID</li>
<li>IADs.get_GUID</li>
<li>IADs.Name</li>
<li>IADs.get_Name</li>
<li>IADs.Parent</li>
<li>IADs.get_Parent</li>
<li>IADs.Schema</li>
<li>IADs.get_Schema
api_location:</li>
<li>Activeds.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>IADs Property Methods</h1>
<p>The property methods of the <a href="/windows/desktop/api/Iads/nn-iads-iads"><strong>IADs</strong></a> interface get or set the properties described in the following table. For more information about property methods, see <a href="interface-property-methods.html">Interface Property Methods</a>.</p>
<h2>Properties</h2>
<!-- raw HTML omitted -->
<p><strong>ADsPath</strong></p>
<!-- raw HTML omitted -->
<p>The ADsPath string of this object. The string uniquely identifies this object in a network environment. The object can always be retrieved using this path.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_ADsPath(
  [out] BSTR* pbstrADsPath
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Class</strong></p>
<!-- raw HTML omitted -->
<p>The name of the object Schema class.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_Class(
  [out] BSTR* pbstrClass
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>GUID</strong></p>
<!-- raw HTML omitted -->
<p>The globally unique identifier of the directory object. The <a href="/windows/desktop/api/Iads/nn-iads-iads"><strong>IADs</strong></a> interface converts the <strong>GUID</strong> from an octet string, as stored on a directory server, into a string format.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_GUID(
  [out] BSTR* pbstrGUID
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Name</strong></p>
<!-- raw HTML omitted -->
<p>The relative name of the object as named within the underlying directory service. This name distinguishes this object from its siblings.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_Name(
  [out] BSTR* pbstrName
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Parent</strong></p>
<!-- raw HTML omitted -->
<p>The ADsPath string of the parent container. Active Directory does not permit the formation of the ADsPath of a given object by concatenating the <strong>Parent</strong> and <strong>Name</strong> properties. While this operation might work in some providers, it is not guaranteed to work for all implementations. The ADsPath is guaranteed to be valid and should always be used to retrieve an object's interface pointer.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_Parent(
  [out] BSTR* pbstrParent
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Schema</strong></p>
<!-- raw HTML omitted -->
<p>The ADsPath string of the Schema class object of this object.</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_Schema(
  [out] BSTR* pbstrSchema
);
</code></pre>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>In Active Directory, the <strong>GUID</strong> returned from GUID is a string of hexadecimals. Use the resultant <strong>GUID</strong> to bind to the object directly.</p>
<pre lang="VB"><code>Dim x As IADs
Set x = GetObject(&quot;LDAP://servername/&lt;GUID=xxx&gt;&quot;)
</code></pre>
<p>where xxx is the value returned from the GUID property. For more information, see <a href="/windows/desktop/AD/using-objectguid-to-bind-to-an-object">Using objectGUID to Bind to an Object</a>. Be aware that if you use a GUID to bind to an object, the <strong>ADsPath</strong> property method returns values that are different from the normal values that would be returned if you used a distinguished name (DN) to bind to the same object. For example, the following table lists the values returned when using the two different binding methods to bind to the same user object.</p>
<table>
<thead>
<tr>
<th></th>
<th>Bind using DN</th>
<th>Bind using GUID</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Name</strong></td>
<td>CN=Jeff Smith</td>
<td>CN=Jeff Smith</td>
</tr>
<tr>
<td><strong>Parent</strong></td>
<td>LDAP://server/CN=Users,DC=Fabrikam,DC=com</td>
<td>LDAP://server/CN=Users,DC=Fabrikam,DC=com</td>
</tr>
<tr>
<td><strong>ADsPath</strong></td>
<td>LDAP://server/CN=Jeff Smith,CN=Users,DC=Fabrikam,DC=com</td>
<td>LDAP://server/<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<blockquote>
<p>[!Note]<br />
The WinNT provider does not support binding using the object <strong>GUID</strong>, and returns the <strong>GUID</strong> property in a slightly different string format.</p>
</blockquote>
<h2>Examples</h2>
<p>The following code example shows how to retrieve object data using property methods of the <a href="/windows/desktop/api/Iads/nn-iads-iads"><strong>IADs</strong></a> interface.</p>
<pre lang="VB"><code>Dim x As IADs
Dim parent As IADsContainer
Dim cls As IADsClass
Dim op As Variant

On Error GoTo Cleanup

Set x = GetObject(&quot;WinNT://Fabrikam/Administrator&quot;)
Debug.Print &quot;Object Name: &quot; &amp; x.Name
Debug.Print &quot;Object Path: &quot; &amp; x.ADsPath
Debug.Print &quot;Object Class: &quot; &amp; x.Class
 
' Get more data about the object schema.
Set cls = GetObject(x.Schema)
Debug.Print &quot;Class Name is: &quot; &amp; cls.Name
For Each op In cls.OptionalProperties
    Debug.Print &quot;Optional Property: &quot; &amp; op
Next op

Cleanup:
    If (Err.Number&lt;&gt;0) Then
        MsgBox(&quot;An error has occurred. &quot; &amp; Err.Number)
    End If
    Set x = Nothing
    Set parent = Nothing
    Set cls = Nothing
</code></pre>
<p>The following code example shows how to retrieve object data using property methods of the <a href="/windows/desktop/api/Iads/nn-iads-iads"><strong>IADs</strong></a> interface.</p>
<pre lang="VB"><code>&lt;HTML&gt;
&lt;head&gt;&lt;title&gt;&lt;/title&gt;&lt;/head&gt;

&lt;body&gt;
&lt;%
Dim x 
On Error Resume Next
 
Set x = GetObject(&quot;WinNT://Fabrikam/Administrator&quot;)
Response.Write &quot;Object Name: &quot; &amp; x.Name &amp; &quot;&lt;br&gt;&quot;
Response.Write &quot;Object Path: &quot; &amp; x.ADsPath &amp; &quot;&lt;br&gt;&quot;
Response.Write &quot;Object Class: &quot; &amp; x.Class &amp; &quot;&lt;br&gt;&quot;
 
' Get more data about the object schema.
Set cls = GetObject(x.Schema)
Response.Write &quot;Class Name is: &quot; &amp; cls.Name &amp; &quot;&lt;br&gt;&quot;
For Each op In cls.OptionalProperties
    Response.Write &quot;Optional Property: &quot; &amp; op &amp; &quot;&lt;br&gt;&quot;
Next op
%&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>The following code example shows how to work with the property methods of the <a href="/windows/desktop/api/Iads/nn-iads-iads"><strong>IADs</strong></a> interface.</p>
<pre lang="C++"><code>#include &lt;stdio.h&gt;
#include &lt;activeds.h&gt;
 
int main(int argc, char* argv[])
{
    IADs *pADs = NULL;
    IADsUser *pADsUser = NULL;
    IADsClass *pCls = NULL;
    CComBSTR sbstr;
 
    HRESULT hr = CoInitialize(NULL);
    if (hr != S_OK) { return 0; }
 
    hr=ADsGetObject(L&quot;WinNT://Fabrikam/Administrator&quot;,
                IID_IADsUser,
                (void**) &amp;pADsUser);
    if (hr != S_OK) { goto Cleanup; }
 
    hr = pADsUser-&gt;QueryInterface(IID_IADs, (void**) &amp;pADs);
    if( hr !=S_OK) { goto Cleanup;}
 
    pADsUser-&gt;Release();
 
    if( S_OK == pADs-&gt;get_Name(&amp;sbstr) ) {
        printf(&quot;Object Name: %S\n&quot;,sbstr);
    }
 
    if( S_OK == pADs-&gt;get_ADsPath(&amp;sbstr) ) {
        printf(&quot;Object path: %S\n&quot;,sbstr);
    }
 
    if( S_OK == pADs-&gt;get_Class(&amp;sbstr) ) {
        printf(&quot;Object class: %S\n&quot;,sbstr);
    }
 
    hr = pADs-&gt;get_Schema(&amp;sbstr);
    if ( hr != S_OK) {goto Cleanup;}
 
    hr = ADsGetObject(sbstr,IID_IADsClass, (void**)&amp;pCls);
    if ( hr != S_OK) {goto Cleanup;}
    if( S_OK == pCls-&gt;get_Name(&amp;sbstr) ) {
        printf(&quot;Class name is %S\n&quot;, sbstr);
    }
 
 Cleanup:
    if(pADs)
        pADs-&gt;Release();

    if(pIADsUser)
        pADsUser-&gt;Release();

    if(IADsClass)
        pADsClass-&gt;Release();

    CoUninitialize();

    if(hr==S_OK)
    {
        return 1;
    }
    else
    {
        return 0;
    }
}
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Iads.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Activeds.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IADs is defined as FD8256D0-FD15-11CE-ABC4-02608C9E7553<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Iads/nn-iads-iads"><strong>IADs</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Iads/nn-iads-iadscontainer"><strong>IADsContainer</strong></a></p>
<!-- raw HTML omitted -->
</body>
