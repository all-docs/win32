<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using an ActiveX Data Object to Bind to ADSI Providers</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Using an ActiveX Data Object to Bind to ADSI Providers
description: Since ADSI is also an OLE DB provider, you can use an ActiveX Data Object (ADO) to connect to ADSI providers.
ms.assetid: b42d804b-f1eb-4085-88aa-015a92309ee8
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>ActiveX data object ADSI</li>
<li>ActiveX data object ADSI ,using ADO to bind to ADSI providers</li>
<li>service providers ADSI ,using ActiveX data object to bind to
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Using an ActiveX Data Object to Bind to ADSI Providers</h1>
<p>Since ADSI is also an OLE DB provider, you can use an ActiveX Data Object (ADO) to connect to ADSI providers. As with other ADO providers, to connect to an OLE DB provider, you must create a new connection object and, optionally, specify the credentials. The name of the ADSI OLE DB provider is <strong>ADsDSOObject</strong>.</p>
<p>For example:</p>
<pre lang="VB"><code>Dim con As New Connection 
'VBScript use: con = CreateObject(&quot;ADODB.Connection&quot;)
con.Provider = &quot;ADsDSOObject&quot;
con.Open &quot;YourDescriptionHere&quot;
</code></pre>
<p>In the previous example, you are connected on behalf of the current user. To specify different credentials, use connection properties:</p>
<pre lang="VB"><code>con.Provider = &quot;ADsDSOObject&quot;
con.Properties(&quot;User ID&quot;) = &quot;jeffsmith&quot;
con.Properties(&quot;Password&quot;) = &quot;guesswhat?&quot;
con.Properties(&quot;Encrypt Password&quot;) = True
con.Open &quot;YourDescriptionHere&quot;
</code></pre>
<p>ADSI OLE DB defines the following connection properties.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Data type</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>&quot;User ID&quot;</td>
<td><strong>BSTR</strong></td>
<td><strong>NULL</strong></td>
</tr>
<tr>
<td>&quot;Password&quot;</td>
<td><strong>BSTR</strong></td>
<td><strong>NULL</strong></td>
</tr>
<tr>
<td>&quot;Encrypt Password&quot;</td>
<td><strong>BOOLEAN</strong></td>
<td><strong>FALSE</strong></td>
</tr>
<tr>
<td>&quot;ADSI Flag&quot;</td>
<td><strong>Long</strong></td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Using OLE DB ADO, you cannot bind to a specific object. You can, however, query a specific object and get a result set back. Only ADSI providers that support <a href="/windows/desktop/api/Iads/nn-iads-idirectorysearch"><strong>IDirectorySearch</strong></a> benefit from having ADO as a programming model.</p>
<p>The ADSI Flag property is used to specify the binding authentication option. This property can be a combination of flags from the <a href="/windows/win32/api/iads/ne-iads-ads_authentication_enum"><strong>ADS_AUTHENTICATION_ENUM</strong></a> enumeration.</p>
<p>Â </p>
<p>Â </p>
</body>
