<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IADsPropertyValue Property Methods</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IADsPropertyValue Property Methods (Iads.h)
description: The property methods of the IADsPropertyValue interface provide access to the properties described in the following table. For more information, see Interface Property Methods.
ms.assetid: 1039d4a9-bef8-457d-9a32-3743c14adef1
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>IADsPropertyValue Property Methods ADSI
topic_type:</li>
<li>apiref
api_name:</li>
<li>IADsPropertyValue Property Methods</li>
<li>IADsPropertyValue.ADsType</li>
<li>IADsPropertyValue.get_ADsType</li>
<li>IADsPropertyValue.put_ADsType</li>
<li>IADsPropertyValue.DNString</li>
<li>IADsPropertyValue.get_DNString</li>
<li>IADsPropertyValue.put_DNString</li>
<li>IADsPropertyValue.CaseExactString</li>
<li>IADsPropertyValue.get_CaseExactString</li>
<li>IADsPropertyValue.put_CaseExactString</li>
<li>IADsPropertyValue.CaseIgnoreString</li>
<li>IADsPropertyValue.get_CaseIgnoreString</li>
<li>IADsPropertyValue.put_CaseIgnoreString</li>
<li>IADsPropertyValue.PrintableString</li>
<li>IADsPropertyValue.get_PrintableString</li>
<li>IADsPropertyValue.put_PrintableString</li>
<li>IADsPropertyValue.NumericString</li>
<li>IADsPropertyValue.get_NumericString</li>
<li>IADsPropertyValue.put_NumericString</li>
<li>IADsPropertyValue.Boolean</li>
<li>IADsPropertyValue.get_Boolean</li>
<li>IADsPropertyValue.put_Boolean</li>
<li>IADsPropertyValue.Integer</li>
<li>IADsPropertyValue.get_Integer</li>
<li>IADsPropertyValue.put_Integer</li>
<li>IADsPropertyValue.OctetString</li>
<li>IADsPropertyValue.get_OctetString</li>
<li>IADsPropertyValue.put_OctetString</li>
<li>IADsPropertyValue.SecurityDescriptor</li>
<li>IADsPropertyValue.get_SecurityDescriptor</li>
<li>IADsPropertyValue.put_SecurityDescriptor</li>
<li>IADsPropertyValue.LargeInteger</li>
<li>IADsPropertyValue.get_LargeInteger</li>
<li>IADsPropertyValue.put_LargeInteger</li>
<li>IADsPropertyValue.UTCTime</li>
<li>IADsPropertyValue.get_UTCTime</li>
<li>IADsPropertyValue.put_UTCTime
api_location:</li>
<li>Activeds.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>IADsPropertyValue Property Methods</h1>
<p>The property methods of the <a href="/windows/desktop/api/Iads/nn-iads-iadspropertyvalue"><strong>IADsPropertyValue</strong></a> interface provide access to the properties described in the following table. For more information, see <a href="interface-property-methods.html">Interface Property Methods</a>.</p>
<h2>Properties</h2>
<!-- raw HTML omitted -->
<p><strong>ADsType</strong></p>
<!-- raw HTML omitted -->
<p>The data type of the value of the property, taken from the <a href="/windows/win32/api/iads/ne-iads-adstypeenum"><strong>ADSTYPEENUM</strong></a> enumeration, of the value property.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>LONG</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_ADsType(
  [out] LONG* ADsType
);
HRESULT put_ADsType(
  [in] LONG ADsType
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Boolean</strong></p>
<!-- raw HTML omitted -->
<p>Boolean value.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>LONG</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_Boolean(
  [out] LONG* lnBoolean
);
HRESULT put_Boolean(
  [in] LONG lnBoolean
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>CaseExactString</strong></p>
<!-- raw HTML omitted -->
<p>String to be interpreted. Case-sensitive.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_CaseExactString(
  [out] BSTR* bstrCaseExactString
);
HRESULT put_CaseExactString(
  [in] BSTR bstrCaseExactString
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>CaseIgnoreString</strong></p>
<!-- raw HTML omitted -->
<p>String to be interpreted. Case insensitive.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_CaseIgnoreString(
  [out] BSTR* bstrCaseIgnoreString
);
HRESULT put_CaseIgnoreString(
  [in] BSTR bstrCaseIgnoreString
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>DNString</strong></p>
<!-- raw HTML omitted -->
<p>String that identifies the distinguished name (path) of a directory service value object.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_DNString(
  [out] BSTR* bstrDNString
);
HRESULT put_DNString(
  [in] BSTR bstrDNString
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Integer</strong></p>
<!-- raw HTML omitted -->
<p>Integer value.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>LONG</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_Integer(
  [out] LONG* lnInteger
);
HRESULT put_Integer(
  [in] LONG lnInteger
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>LargeInteger</strong></p>
<!-- raw HTML omitted -->
<p>Pointer to the <a href="/windows/win32/api/oaidl/nn-oaidl-idispatch"><strong>IDispatch</strong></a> interface of the object implementing <a href="/windows/desktop/api/Iads/nn-iads-iadslargeinteger"><strong>IADsLargeInteger</strong></a> for this value.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>IDispatch</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_LargeInteger(
  [out] IDispatch** ppLargeInteger
);
HRESULT put_LargeInteger(
  [in] IDispatch* pLargeInteger
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>NumericString</strong></p>
<!-- raw HTML omitted -->
<p>Text to be interpreted. Numeric type.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_NumericString(
  [out] BSTR* bstrNumericString
);
HRESULT put_NumericString(
  [in] BSTR bstrNumericString
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>OctetString</strong></p>
<!-- raw HTML omitted -->
<p>Variant array of one-byte characters.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>VARIANT</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_OctetString(
  [in] VARIANT* vOctetString
);
HRESULT put_OctetString(
  [in] VARIANT* vOctetString
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>PrintableString</strong></p>
<!-- raw HTML omitted -->
<p>Display or print string.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>BSTR</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_PrintableString(
  [out] BSTR* bstrPrintableString
);
HRESULT put_PrintableString(
  [in] BSTR bstrPrintableString
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>SecurityDescriptor</strong></p>
<!-- raw HTML omitted -->
<p>Pointer to the <a href="/windows/win32/api/oaidl/nn-oaidl-idispatch"><strong>IDispatch</strong></a> interface of the object implementing <a href="/windows/desktop/api/Iads/nn-iads-iadssecuritydescriptor"><strong>IADsSecurityDescriptor</strong></a> for this value.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>IDispatch</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_SecurityDescriptor(
  [out] IDispatch** ppSecurityDescriptor
);
HRESULT put_SecurityDescriptor(
  [in] IDispatch* pSecurityDescriptor
);
</code></pre>
<!-- raw HTML omitted -->
<p><strong>UTCTime</strong></p>
<!-- raw HTML omitted -->
<p>A date of the <strong>VT_DATE</strong> type expressed in Coordinated Universal Time (UTC) format.</p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Scripting data type: <strong>DATE</strong></p>
<!-- raw HTML omitted -->
<pre lang="syntax"><code>// C++ method syntax
HRESULT get_UTCTime(
  [out] DATE* daUTCTime
);
HRESULT put_UTCTime(
  [in] DATE daUTCTime
);
</code></pre>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The <a href="/windows/desktop/api/Iads/nn-iads-iadspropertyvalue"><strong>IADsPropertyValue</strong></a> properties will only set or retrieve a property value of the specified type. For example, the <strong>CaseIgnoreString</strong> property on an attribute of type <strong>ADSTYPE_DN_STRING</strong>, like the <strong>distinguishedName</strong> attribute, will result in an error. The <strong>CaseIgnoreString</strong> property will only work on attributes of type <strong>ADS_CASE_IGNORE_STRING</strong>. The following table maps the <a href="/windows/win32/api/iads/ne-iads-adstypeenum"><strong>ADSTYPEENUM</strong></a> value to the corresponding <strong>IADsPropertyValue</strong> property that can be used to access that attribute type. If an <strong>ADSTYPEENUM</strong> value is not listed in this table, it is not available from the <strong>IADsPropertyValue</strong> interface. The <a href="/windows/desktop/api/Iads/nn-iads-iadspropertyvalue2"><strong>IADsPropertyValue2</strong></a> interface should be used to obtain data in the other formats.</p>
<table>
<thead>
<tr>
<th><a href="/windows/win32/api/iads/ne-iads-adstypeenum"><strong>ADSTYPEENUM</strong></a> value</th>
<th><a href="/windows/desktop/api/Iads/nn-iads-iadspropertyvalue"><strong>IADsPropertyValue</strong></a> property</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ADSTYPE_DN_STRING</strong></td>
<td><strong>DNString</strong></td>
</tr>
<tr>
<td><strong>ADSTYPE_CASE_EXACT_STRING</strong></td>
<td><strong>CaseExactString</strong></td>
</tr>
<tr>
<td><strong>ADSTYPE_CASE_IGNORE_STRING</strong></td>
<td><strong>CaseIgnoreString</strong></td>
</tr>
<tr>
<td><strong>ADSTYPE_PRINTABLE_STRING</strong></td>
<td><strong>PrintableString</strong></td>
</tr>
<tr>
<td><strong>ADSTYPE_NUMERIC_STRING</strong></td>
<td><strong>NumericString</strong></td>
</tr>
<tr>
<td><strong>ADSTYPE_BOOLEAN</strong></td>
<td><strong>Boolean</strong></td>
</tr>
<tr>
<td><strong>ADSTYPE_INTEGER</strong></td>
<td><strong>Integer</strong></td>
</tr>
<tr>
<td><strong>ADSTYPE_OCTET_STRING</strong></td>
<td><strong>OctetString</strong></td>
</tr>
<tr>
<td><strong>ADSTYPE_UTC_TIME</strong></td>
<td><strong>UTCTime</strong></td>
</tr>
<tr>
<td><strong>ADSTYPE_LARGE_INTEGER</strong></td>
<td><strong>LargeInteger</strong></td>
</tr>
<tr>
<td><strong>ADSTYPE_NT_SECURITY_DESCRIPTOR</strong></td>
<td><strong>SecurityDescriptor</strong></td>
</tr>
</tbody>
</table>
<h2>Examples</h2>
<p>The following code example shows how to retrieve a property from the property list.</p>
<pre lang="VB"><code>Dim propList As IADsPropertyList
Dim propEntry As IADsPropertyEntry
Dim propVal As IADsPropertyValue

On Error GoTo Cleanup
 
' Retrieve the property list.
Set propList = GetObject(&quot;LDAP://dc01/DC=Fabrikam,DC=com&quot;)
propList.GetInfo
 
' Retrieve a property entry. If you are certain of the property type,
' replace ADSTYPE_UNKNOWN with the actual property type.
Set propEntry = propList.GetPropertyItem(&quot;description&quot;, ADSTYPE_UNKNOWN)
 
' Print the property entry values.
For Each v In propEntry.Values
    Set propVal = v
    Select Case propVal.ADsType
        Case ADSTYPE_CASE_EXACT_STRING
            Debug.Print propVal.CaseExactString
        Case ADSTYPE_CASE_IGNORE_STRING
            Debug.Print propVal.CaseIgnoreString
        Case Else
            Debug.Print &quot;Unable to handle a property of type: &quot; &amp; propVal.ADsType
    End Select
    
Next

Cleanup:
    If (Err.Number&lt;&gt;0) Then
       Debug.Print &quot;An error has occurred. &quot; &amp; Err.Number
    End If
    Set propList = Nothing
    Set propEntry = Nothing
    Set propVal = Nothing
</code></pre>
<p>The following code shows how to use <strong>IADsPropertyValue::get_CaseIgnoreString</strong> to retrieve the value of the description property from a property list.</p>
<pre lang="C++"><code>#include &lt;activeds.h&gt;
#include &lt;stdio.h&gt;
 
IADsPropertyList *pList = NULL;
IADsPropertyEntry *pEntry = NULL;
IADsPropertyValue *pVal = NULL;
IADs *pObj = NULL;
VARIANT var, varItem;
BSTR valStr;
IEnumVARIANT *pEnum = NULL;
LONG lstart = 0;
LONG lend = 0;
LONG lADsType = ADSTYPE_UNKNOWN;
 
VariantInit(&amp;var);
VariantInit(&amp;varItem);
 
// Bind to the directory object.
HRESULT hr = ADsGetObject(L&quot;LDAP://dc01/DC=Fabrikam,DC=com&quot;,
                          IID_IADsPropertyList,
                          (void**)&amp;pList);

if(FAILED(hr)){goto Cleanup;}

// Initialize the property cache.
hr = pList-&gt;QueryInterface(IID_IADs,(void**)&amp;pObj);
if(FAILED(hr)){goto Cleanup;}

pObj-&gt;GetInfo();
pObj-&gt;Release();
 
// Retrieve the property entry.
hr = pList-&gt;GetPropertyItem(CComBSTR(&quot;description&quot;), ADSTYPE_CASE_IGNORE_STRING, &amp;var);
pList-&gt;Release();
if(FAILED(hr)){goto Cleanup;}

hr = V_DISPATCH(&amp;var)-&gt;QueryInterface(IID_IADsPropertyEntry,
                                      (void**)&amp;pEntry);
VariantClear(&amp;var);
if(FAILED(hr)){goto Cleanup;}
 
// Retrieve the value array of the property entry.
hr = pEntry-&gt;get_Values(&amp;var);
if(FAILED(hr)){goto Cleanup;}

SAFEARRAY *sa = V_ARRAY( &amp;var );
 
// Retrieve the lower and upper bound. Iterate and print the values.
hr = SafeArrayGetLBound( sa, 1, &amp;lstart );
hr = SafeArrayGetUBound( sa, 1, &amp;lend );
printf(&quot; Property value(s) = &quot;);
for ( long idx=lstart; idx &lt; lend+1; idx++ )    {
    hr = SafeArrayGetElement( sa, &amp;idx, &amp;varItem );
    hr = V_DISPATCH(&amp;varItem)-&gt;QueryInterface(IID_IADsPropertyValue,
                                              (void**)&amp;pVal);
    if(FAILED(hr)){goto Cleanup;}

    pVal-&gt;get_ADsType(&amp;lADsType);

    switch(lADsType)
    {
        case ADSTYPE_CASE_IGNORE_STRING:
        {
            hr = pVal-&gt;get_CaseIgnoreString(&amp;valStr);
            break;
        }
        case ADSTYPE_CASE_EXACT_STRING:
        {
            hr = pVal-&gt;get_CaseExactString(&amp;valStr);
            break;
        }
        default:
        {
            valStr = SysAllocString(L&quot;Unable to handle a property of this type&quot;);
            break;
        }
    }

    if(FAILED(hr)){goto Cleanup;}
    printf(&quot; %S &quot;, valStr);
    SysFreeString(valStr);
    VariantClear(&amp;varItem);
}
printf(&quot;\n&quot;);

Cleanup:
    if(pList)
        pList = NULL;

    if(pEntry)
        pEntry = NULL;

    if(pVal)
        pVal = NULL;

    if(pObj)
        pObj = NULL;

    if(pEnum)
        pEnum = NULL;

    SysFreeString(valStr);
    VariantClear(&amp;varItem);
    VariantClear(&amp;var);
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Iads.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Activeds.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IADsPropertyValue is defined as 79FA9AD0-A97C-11D0-8534-00C04FD8D503<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Iads/nn-iads-iadspropertyvalue"><strong>IADsPropertyValue</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/iads/ne-iads-adstypeenum"><strong>ADSTYPEENUM</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Iads/nn-iads-iadspropertyentry"><strong>IADsPropertyEntry</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Iads/nn-iads-iadspropertylist"><strong>IADsPropertyList</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Iads/nn-iads-iadspropertyvalue2"><strong>IADsPropertyValue2</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Iads/nn-iads-iadssecuritydescriptor"><strong>IADsSecurityDescriptor</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/oaidl/nn-oaidl-idispatch"><strong>IDispatch</strong></a></p>
<!-- raw HTML omitted -->
</body>
