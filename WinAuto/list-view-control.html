<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>List-View Control (MSAA UI Element Reference)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: List-View Control (MSAA UI Element Reference)
description: A list-view control displays a collection of items, each consisting of an icon and a label, and provides several ways to display and arrange the items.
ms.assetid: 412a029f-fb64-4365-aa64-26cbdf3a50d5
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>List-View Control (MSAA UI Element Reference)</h1>
<blockquote>
<p>[!Note]<br />
This topic describes <strong>List-View Control</strong> objects for purposes of MSAA UI Element Reference. How to create <strong>List-View Control</strong> objects in various UI frameworks is not described here. See the API reference documentation for the UI framework you're using.</p>
</blockquote>
<p>A list-view control displays a collection of items, each consisting of an icon and a label, and provides several ways to display and arrange the items. For example, additional information about each item is displayed in columns to the right of the icon and label. Windows Explorer uses a list-view control to display files.</p>
<p>The window class name for a list-view control is WC_LISTVIEW, which is defined as &quot;SysListView&quot; in Commctrl.h.</p>
<h2>IAccessible Methods</h2>
<p>A list-view control supports the following <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> methods:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accdodefaultaction"><strong>accDoDefaultAction</strong></a></td>
<td>The list-view object itself does not have a <strong>DefaultAction</strong> property; however, the <a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accdodefaultaction"><strong>accDoDefaultAction</strong></a> method double clicks list-view items.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest"><strong>accHitTest</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation"><strong>accLocation</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate"><strong>accNavigate</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accselect"><strong>accSelect</strong></a></td>
<td></td>
</tr>
</tbody>
</table>
<h2>IAccessible Properties</h2>
<p>A list-view control supports the following <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> properties:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild"><strong>get_accChild</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchildcount"><strong>get_accChildCount</strong></a></td>
<td>The <strong>ChildCount</strong> property is the number of items in the list.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accdefaultaction"><strong>get_accDefaultAction</strong></a></td>
<td>The list-view object itself does not have a <strong>DefaultAction</strong> property; however, the <strong>DefaultAction</strong> property for each list-view item is &quot;Double Click&quot;.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accdescription"><strong>get_accDescription</strong></a></td>
<td>The list-view object itself does not support the <strong>Description</strong> property; however, the <strong>Description</strong> property for each list-view item is the text contained in the item's second and subsequent columns. A comma is inserted between the text for each column.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accfocus"><strong>get_accFocus</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acchelp"><strong>get_accHelp</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acchelptopic"><strong>get_accHelpTopic</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acckeyboardshortcut"><strong>get_accKeyboardShortcut</strong></a></td>
<td>List-views objects do not have keyboard shortcuts. However, if the window text for the list-view control contains an ampersand (&amp;) character, Microsoft Active Accessibility returns a non-Null string as the <strong>KeyboardShortcut</strong> property.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname"><strong>get_accName</strong></a></td>
<td>The <strong>Name</strong> for the list-view object is obtained from the control's window text (or caption). This text is not displayed with the list-view control, so server developers must provide meaningful text in the control's resource definition statement to help users of client utilities to identify the control. For the list-view items, the <strong>Name</strong> property is the text of the list item.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent"><strong>get_accParent</strong></a></td>
<td>The <strong>Parent</strong> of the list-view object is a window ( <a href="object-roles.html"><strong>ROLE_SYSTEM_WINDOW</strong></a> ) that surrounds the control and has the same <strong>Name</strong> property and window class name as the control. The <strong>Parent</strong> property of the list-view items is the list-view object.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accrole"><strong>get_accRole</strong></a></td>
<td>The <strong>Role</strong> of <a href="object-roles.html"><strong>ROLE_SYSTEM_LIST</strong></a>, and each item in the list-view control has the <strong>Role</strong> property of <a href="object-roles.html"><strong>ROLE_SYSTEM_LISTITEM</strong></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accselection"><strong>get_accSelection</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accstate"><strong>get_accState</strong></a></td>
<td>The <strong>State</strong> property of the list-view object is a combination of one or more of the following <a href="object-state-constants.html">values</a>: <a href="object-state-constants.html"><strong>STATE_SYSTEM_INVISIBLE</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_UNAVAILABLE</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_FOCUSED</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_FOCUSABLE</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_OFFSCREEN</strong></a><!-- raw HTML omitted --> The <strong>State</strong> property of the list-view items is a combination of one or more of the following values:<!-- raw HTML omitted --> <a href="object-state-constants.html"><strong>STATE_SYSTEM_INVISIBLE</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_FOCUSED</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_FOCUSABLE</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_SELECTABLE</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_SELECTED</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_MULTISELECTABLE</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_HOTTRACKED</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_OFFSCREEN</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_NORMAL</strong></a><!-- raw HTML omitted --> Additionally, check box list-view items also have the state <a href="object-state-constants.html"><strong>STATE_SYSTEM_CHECKED</strong></a>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Notes</h2>
<ul>
<li>Microsoft Active Accessibility does not expose list-view item text in applications that use a callback function to add the text to the item.</li>
<li>List-view items that are clipped do not have <a href="object-state-constants.html"><strong>STATE_SYSTEM_INVISIBLE</strong></a> set. To determine if a list item is clipped, clients can compare the item's coordinates returned by <a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation"><strong>accLocation</strong></a> with the clipping region of the window.</li>
<li>Microsoft Active Accessibility does not support using the <a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation"><strong>accNavigate</strong></a> method to navigate to the header control within a list-view control that is in Details view. However, clients use the <a href="/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint"><strong>AccessibleObjectFromPoint</strong></a> function to get to the header control.</li>
<li>For non-rectangular objects such as list-view items in the Details view, the coordinates of the item's bounding rectangle retrieved by <a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation"><strong>accLocation</strong></a> fail if tested with <a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest"><strong>accHitTest</strong></a> because <strong>accHitTest</strong> determines the object's boundaries on a pixel-by-pixel basis.</li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible">IAccessible Interface</a></p>
<!-- raw HTML omitted -->
</body>
