<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Out-of-Context Hook Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Out-of-Context Hook Functions
ms.assetid: 'c0156485-db1e-42d3-bbbd-c51835a597ed'
description: &quot;Learn more about: Out-of-Context Hook Functions&quot;
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Out-of-Context Hook Functions</h1>
<p>The following list outlines the key aspects of out-of-context hook functions:</p>
<ul>
<li>Out-of-context hook functions are located in the client's address space, whether it is in the code body or in a DLL.</li>
<li>Out-of-context hook functions are not mapped into the server's address space.</li>
<li>When an event is triggered, the parameters for the hook function are marshaled across process boundaries.</li>
<li>Out-of-context hook functions are noticeably slower than in-context hook functions due to marshaling.</li>
<li>The system queues the event notifications so that they arrive asynchronously (because of the time required to perform marshaling).</li>
</ul>
<p>Although the event notifications are asynchronous, Microsoft Active Accessibility assures that the callback function receives all events in the order in which they are generated.</p>
<p>The USER component of the operating system allocates memory for events that are handled by out-of-context hook functions. The memory is freed when the hook functions return. If a hook function does not process events quickly enough, USER resources are lowered, eventually resulting in a fault or extremely slow response times. These problems may occur if:</p>
<ul>
<li>Events are fired very rapidly.</li>
<li>The system is slow.</li>
<li>The hook function processes events slowly.</li>
<li>The client is running on Windows 9x.</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
