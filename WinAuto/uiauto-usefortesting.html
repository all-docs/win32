<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using UI Automation for Automated Testing</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Using UI Automation for Automated Testing
description: This overview describes how Microsoft UI Automation can be useful as a framework for programmatic access in automated testing scenarios.
ms.assetid: 192162f9-55bf-4111-9f15-c0d3b5af2ab7
keywords:</p>
<ul>
<li>clients,UI Automation automated testing</li>
<li>clients,automated testing</li>
<li>clients,testing</li>
<li>clients,tools for automated testing</li>
<li>clients,UI Automation tools for automated testing</li>
<li>clients,UI Automation testing</li>
<li>UI Automation,automated testing</li>
<li>UI Automation,testing</li>
<li>UI Automation,tools for automated testing</li>
<li>automated testing</li>
<li>tools for automated testing
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Using UI Automation for Automated Testing</h1>
<p>This overview describes how Microsoft UI Automation can be useful as a framework for programmatic access in automated testing scenarios.</p>
<p>UI Automation provides a unified object model that enables all UI frameworks to expose complex and rich functionality in an accessible and easily automated manner.</p>
<p>UI Automation was developed as a successor to Microsoft Active Accessibility, a framework designed to provide a solution for making controls and applications accessible. Microsoft Active Accessibility was not designed with test automation in mind, although it evolved into that role because of the similar requirements of accessibility and automation. UI Automation is specifically designed to provide robust functionality for automated testing, in addition to providing more refined solutions for accessibility. For example, Microsoft Active Accessibility relies on a single interface to expose information about the UI and to collect the information needed by assistive technology products; UI Automation separates the two models.</p>
<p>Both a provider and a client are required to implement UI Automation for it to be useful as an automated test tool. UI Automation providers are applications, such as Microsoft Word, Microsoft Excel, and other third-party applications or controls based on the Windows operating system. UI Automation clients include automated test scripts and assistive technology applications.</p>
<p>This topic contains the following sections.</p>
<ul>
<li><a href="#ui-automation-in-providers">UI Automation in Providers</a></li>
<li><a href="#ui-automation-in-clients">UI Automation in Clients</a>
<ul>
<li><a href="#programmatic-access">Programmatic Access</a></li>
</ul>
</li>
<li><a href="#key-properties-for-test-automation">Key Properties for Test Automation</a></li>
<li><a href="#related-tools-and-technologies">Related Tools and Technologies</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>UI Automation in Providers</h2>
<p>To automate an element of the user interface, the developer must look at what actions an end user can perform on the UI object by using standard keyboard and mouse interaction. After these key actions have been identified, the UI Automation control patterns that mirror the functionality and behavior of the UI element should be implemented on the control. For example, user interaction with a combo box control typically involves expanding and collapsing the combo box to display or hide a list of items, selecting an item from the list, or adding a new value through keyboard input.</p>
<p>With other accessibility models, developers must gather information directly from individual buttons, menus, or other controls. Every control type comes in dozens of minor variations. In other words, even though 10 variations of a pushbutton work the same way and perform the same function, they must all be treated as unique controls. There is no way to know that these controls are functionally equivalent. UI Automation control patterns were developed to represent these common control behaviors. For more information, see <a href="uiauto-controlpatternsoverview.html">UI Automation Control Patterns Overview</a>.</p>
<p>Without the unified model of control patterns provided by UI Automation, test tools and developers must have framework-specific information to expose properties and control behaviors in that framework. Because several different UI frameworks can be present at the same time in Windows operating systems, including Microsoft Win32, Windows Forms, and Windows Presentation Foundation (WPF), it can be a daunting task to test multiple applications with controls that seem similar. For example, the following table lists the framework-specific property names required to retrieve the name or text associated with a button control and shows the equivalent UI Automation property.</p>
<table>
<thead>
<tr>
<th>Control type</th>
<th>UI framework</th>
<th>Framework-specific property</th>
<th>UI Automation property</th>
</tr>
</thead>
<tbody>
<tr>
<td>Button</td>
<td>WPF</td>
<td>Content</td>
<td>Name property</td>
</tr>
<tr>
<td>Button</td>
<td>Win32</td>
<td>Caption</td>
<td>Name property</td>
</tr>
<tr>
<td>Image</td>
<td>HTML</td>
<td>alt</td>
<td>Name property</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>UI Automation providers are responsible for mapping the framework-specific properties of their controls to the equivalent UI Automation properties. For information on implementing UI Automation in a provider, see <a href="uiauto-providerportal.html">UI Automation Provider Programmer's Guide</a>. For information on implementing control patterns, see <a href="uiauto-implementinguiautocontrolpatterns.html">Implementing UI Automation Control Patterns</a>.</p>
<h2>UI Automation in Clients</h2>
<p>The goal of automated test tools and scenarios is the consistent and repeatable manipulation of the UI. For example, this can involve unit testing specific controls, and recording and running test scripts that iterate through a series of generic actions on a group of controls.</p>
<p>A complication in automated applications is the difficulty of synchronizing a test with a dynamic target, for example, a list box control, such as Windows Task Manager, that displays a list of currently running applications. Because the items in the list box are dynamically updated outside the control of the test application, an attempt to repeat selecting a specific item in the list box with any consistency is impossible. Similar issues can arise when attempting to repeat simple focus changes in a UI that is outside the control of the test application.</p>
<h3>Programmatic Access</h3>
<p>Programmatic access provides the ability to imitate, through code, any interaction and experience exposed by traditional mouse and keyboard input. UI Automation enables programmatic access through five components:</p>
<ul>
<li>The UI Automation tree facilitates navigation through the structure of the UI. The tree is built from the collection of <strong>HWND</strong>s. For more information, see <a href="uiauto-treeoverview.html">UI Automation Tree Overview</a>.</li>
<li>Automation elements are individual components in the UI. These can often be more granular than an <strong>HWND</strong>.</li>
<li>Automation properties provide specific information about UI elements. For more information, see <a href="uiauto-propertiesoverview.html">UI Automation Properties Overview</a>.</li>
<li>Control patterns define a particular aspect of a control's functionality; they can consist of property, method, event, and structure information. For more information, see <a href="uiauto-controlpatternsoverview.html">UI Automation Control Patterns Overview</a>.</li>
<li>Automation events provide event notifications and information. For more information, see <a href="uiauto-eventsoverview.html">UI Automation Events Overview</a>.</li>
</ul>
<h2>Key Properties for Test Automation</h2>
<p>The ability to uniquely identify and subsequently locate any control in the UI provides the basis for automated test applications to operate on that UI. UI Automation properties used by clients and providers to identify and locate controls are described in the following table.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AutomationId</td>
<td>Uniquely distinguishes an automation element from its siblings. Support for the AutomationId property is not required. When it is available, the AutomationId property of an element is the same in any instance of the application, regardless of the local language. Although the AutomationId property is unique among sibling elements, it may not be unique across the entire desktop. For example, multiple instances of an application, or multiple folder views in Microsoft Windows Explorer, may contain elements with the same AutomationIdProperty, such as &quot;SystemMenuBar&quot;. Clients should make no assumptions regarding the AutomationIds exposed by other applications. AutomationId is not guaranteed to be stable across different releases or builds of an application.</td>
</tr>
<tr>
<td>ControlType</td>
<td>Identifies the type of control represented by an automation element. Significant information can be inferred from knowledge of the control type. For more information, see <a href="uiauto-controltypesoverview.html">UI Automation Control Types Overview</a>.</td>
</tr>
<tr>
<td>Name</td>
<td>A text string that identifies or explains the purpose of an automation element. It should be used with caution because it can be localized. The Name property is not a unique identifier among siblings. For test automation, clients should use the AutomationId property or RuntimeId property instead.</td>
</tr>
<tr>
<td>RuntimeId</td>
<td>An array of integers that represent an identifier for an automation element. The identifier is unique on the desktop, but is guaranteed to be unique only to the UI of the desktop on which it was generated. Identifiers can be reused over time. Use <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-compareelements"><strong>IUIAutomation::CompareElements</strong></a> to determine if the element that currently has a particular runtime ID is the same element that previously had that ID. Also, the format of the RuntimeId property may change. It should be treated as an opaque value and used only for comparison; for example, to determine whether an automation element is in the cache.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related Tools and Technologies</h2>
<p><a href="inspect-objects.html">Inspect</a> (Inspect.exe) is a Windows-based tool that you can use to gather UI Automation information for provider and client development and debugging. Inspect is included in the Windows Software Development Kit (SDK).</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="uiauto-securityoverview.html">UI Automation Security Considerations</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
