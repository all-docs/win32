<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TextChild Control Pattern</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: TextChild Control Pattern
description: Introduces guidelines and conventions for implementing ITextChildProvider, including information about properties and methods. The TextChild control pattern is used to access an elementâ€™s nearest ancestor that supports the Text control pattern.
ms.assetid: B33BCBEF-9AD2-4A5A-871E-E97E69BE8195
keywords:</p>
<ul>
<li>UI Automation,implementing TextChild control pattern</li>
<li>UI Automation,TextChild control pattern</li>
<li>UI Automation,ITextChildProvider</li>
<li>ITextChildProvider</li>
<li>implementing UI Automation TextChild control patterns</li>
<li>TextChild control patterns</li>
<li>control patterns,ITextChildProvider</li>
<li>control patterns,implementing UI Automation TextChild</li>
<li>control patterns,TextChild</li>
<li>interfaces,ITextChildProvider
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>TextChild Control Pattern</h1>
<p>Introduces guidelines and conventions for implementing <a href="/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextchildprovider"><strong>ITextChildProvider</strong></a>, including information about properties and methods. The <strong>TextChild</strong> control pattern is used to access an elementâ€™s nearest ancestor that supports the <a href="uiauto-implementingtextandtextrange.html">Text</a> control pattern.</p>
<p>For example, suppose text in a document contains an embedded image and a hyperlink as shown in the following image.</p>
<p><img src="images/textchild-pattern.png" alt="screen shot showing text containing an embedded image and a hyperlink" /></p>
<p>If you use Microsoft UI Automation tools to examine the UI Automation tree for this document content, it might show a document element with one child element that represents the image, and another child element that represents the hyperlink. For example:</p>
<p><img src="images/textchild-pattern-tree.png" alt="screen shot showing inspect reporting a sample ui automation element tree" /></p>
<p>Typically, the document element in the preceding example supports the <a href="uiauto-implementingtextandtextrange.html">Text</a> control pattern, but the two children of the document element do not. If a UI Automation client application has a reference to the image element or hyperlink element, the client can use the <strong>TextChild</strong> control pattern as a convenient way to access the Textcontrol pattern exposed by the containing document element.</p>
<h2>Implementation Guidelines and Conventions</h2>
<p>When implementing the <a href="/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextchildprovider"><strong>ITextChildProvider</strong></a> interface, note the following guidelines and conventions:</p>
<ul>
<li>The <a href="/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextchildprovider-get_textcontainer"><strong>ITextChildProvider::TextContainer</strong></a> property should specify the nearest ancestor element that supports <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider"><strong>ITextProvider</strong></a> interface, regardless of whether elements higher in the ancestor chain also support <strong>ITextProvider</strong>.</li>
<li>An element should not support both the<a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider"><strong>ITextProvider</strong></a> and the <a href="/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextchildprovider">ITextChildProvider**</a> interface.</li>
<li>An element that implements <a href="/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextchildprovider"><strong>ITextChildProvider</strong></a> must be a child, or descendent, of an element that implements <a href="/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider"><strong>ITextProvider</strong></a>. It is not required that this element also implement the <a href="/windows/desktop/WinAuto/uiauto-implementingtextandtextrange">Text control pattern</a>.</li>
<li>The <a href="/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextchildprovider-get_textrange"><strong>ITextChildProvider::TextRange</strong></a> property should specify the same text range as the one that the containing text provider element returns when its <a href="/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild"><strong>ITextProvider::RangeFromChild</strong></a> function is called with the text child element as the enclosed child element.</li>
</ul>
<h2>Required Members for <strong>ITextChildProvider</strong></h2>
<p>These properties and methods are required for implementing the <a href="/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextchildprovider"><strong>ITextChildProvider</strong></a> interface.</p>
<table>
<thead>
<tr>
<th>Required members</th>
<th>Member type</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/uiautomationcore/nf-uiautomationcore-itextchildprovider-get_textcontainer"><strong>TextContainer</strong></a></td>
<td>Property</td>
<td>None</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/uiautomationcore/nf-uiautomationcore-itextchildprovider-get_textrange"><strong>TextRange</strong></a></td>
<td>Property</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>This control pattern has no associated methods or events.</p>
<h2>Related topics</h2>
<p><strong>Conceptual</strong></p>
<ul>
<li><a href="uiauto-controlpatternmapping.html">Control Types and Their Supported Control Patterns</a></li>
<li><a href="uiauto-controlpatternsoverview.html">UI Automation Control Patterns Overview</a></li>
<li><a href="uiauto-treeoverview.html">UI Automation Tree Overview</a></li>
</ul>
</body>
