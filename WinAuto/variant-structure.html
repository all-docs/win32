<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>VARIANT Structure</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: VARIANT Structure
description: Most of the Microsoft Active Accessibility functions and the IAccessible properties and methods take a VARIANT structure as a parameter. Essentially, the VARIANT structure is a container for a large union that carries many types of data.
ms.assetid: 774dfac8-e258-4266-b81e-072eb3961fb1
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>VARIANT Structure</h1>
<p>Most of the Microsoft Active Accessibility functions and the <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> properties and methods take a <a href="/windows/win32/api/oaidl/ns-oaidl-variant"><strong>VARIANT</strong></a> structure as a parameter. Essentially, the <strong>VARIANT</strong> structure is a container for a large union that carries many types of data.</p>
<p>The value in the first member of the structure, <strong>vt</strong>, describes which of the union members is valid. Although the <a href="/windows/win32/api/oaidl/ns-oaidl-variant"><strong>VARIANT</strong></a> structure supports many different data types, Microsoft Active Accessibility uses only the following types.</p>
<table>
<thead>
<tr>
<th>vt Value</th>
<th>Corresponding value member name</th>
</tr>
</thead>
<tbody>
<tr>
<td>VT_I4</td>
<td><strong>lVal</strong></td>
</tr>
<tr>
<td>VT_DISPATCH</td>
<td><strong>pdispVal</strong></td>
</tr>
<tr>
<td>VT_BSTR</td>
<td><strong>bstrVal</strong></td>
</tr>
<tr>
<td>VT_EMPTY</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>When you receive information in a <a href="/windows/win32/api/oaidl/ns-oaidl-variant"><strong>VARIANT</strong></a> structure, check the <strong>vt</strong> member to find out which member contains valid data. Similarly, when you send information using a <strong>VARIANT</strong> structure, always set <strong>vt</strong> to reflect the union member that contains the information.</p>
<p>Before using the structure, initialize it by calling the <a href="/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantinit"><strong>VariantInit</strong></a> Component Object Model (COM) function. When finished with the structure, clear it before the memory that contains the <a href="/windows/win32/api/oaidl/ns-oaidl-variant"><strong>VARIANT</strong></a> is freed by calling <a href="/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantclear"><strong>VariantClear</strong></a>.</p>
<p>Â </p>
<p>Â </p>
</body>
