<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Understanding Performance Issues When Using the Text and TextRange Control Patterns</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Understanding Performance Issues When Using the Text and TextRange Control Patterns.
description: This topic describes performance issues associated with using the Text and TextRange control patterns.
ms.assetid: D78BFFA8-E303-441D-9D32-AD22E1B1A249
keywords:</p>
<ul>
<li>clients,understanding performance issues</li>
<li>clients,text-based controls</li>
<li>clients,text ranges</li>
<li>clients,Text control pattern</li>
<li>clients,TextRange control pattern
ms.topic: article
ms.date: 12/09/2022</li>
</ul>
<hr />
<h1>Understanding Performance Issues When Using the Text and TextRange Control Patterns</h1>
<p>This topic describes performance issues associated with using the <a href="/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationtextpattern"><strong>Text</strong></a> and <a href="/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationtextrange"><strong>TextRange</strong></a> control patterns.</p>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern"><strong>IUIAutomationTextPattern</strong></a> and <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange"><strong>IUIAutomationTextRange</strong></a> interfaces rely on cross-process callsâ€”they do not provide a caching mechanism to improve performance when retrieving or processing textual content.</p>
<p>A client application can improve performance by using the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext"><strong>IUIAutomationTextRange::GetText</strong></a> method to retrieve moderately sized blocks of text. For example, using <strong>GetText</strong> to retrieve single characters will incur a cross-process performance hit for each character, whereas not specifying a maximum length when calling <strong>GetText</strong> will incur one cross-process hit, but can have high latency depending on the size of the text range.</p>
<h2>Related topics</h2>
<p><a href="uiauto-workingwithtextbasedcontrols.html">Working with Text-based Controls</a>, <a href="/windows/win32/winauto/uiauto-ui-automation-textpattern-overview">UI Automation Support for Textual Content</a>, <a href="/windows/win32/winauto/uiauto-about-text-and-textrange-patterns">About the Text and TextRange Control Patterns</a>, <a href="uiauto-clientportal.html">UI Automation Client Programmer's Guide</a></p>
<p>For UI Automation Providers, see <a href="uiauto-implementingtextandtextrange.html">Text and TextRange Control Patterns</a></p>
</body>
