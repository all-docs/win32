<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Checking IAccessible Return Values</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Checking IAccessible Return Values
description: Client developers should not rely on the Component Object Model (COM) macros SUCCEEDED and FAILED to test IAccessible return values, because values other than S_OK are considered a success.
ms.assetid: 0def0349-178b-4be5-aa1d-6602dc015981
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Checking IAccessible Return Values</h1>
<p>Client developers should not rely on the Component Object Model (COM) macros <a href="/windows/desktop/api/winerror/nf-winerror-succeeded"><strong>SUCCEEDED</strong></a> and <a href="/windows/desktop/api/winerror/nf-winerror-failed"><strong>FAILED</strong></a> to test <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> return values, because values other than S_OK are considered a success. For example, a method can return S_FALSE, which is considered a success by the <strong>SUCCEEDED</strong> macro, but still receive a <strong>NULL</strong> pointer in an output parameter.</p>
<p>Client developers must guard against the possibility that some servers return error codes other than the documented values. To be safe, you must ensure that all the output parameters contain valid information and meet the following criteria:</p>
<ul>
<li>All pointers are non-<strong>NULL</strong>.</li>
<li>The <strong>vt</strong> member of any <a href="/windows/win32/api/oaidl/ns-oaidl-variant">VARIANT</a> structure is not equal to VT_EMPTY.</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
