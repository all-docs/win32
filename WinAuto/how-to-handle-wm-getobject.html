<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Handle WM_GETOBJECT</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Handle WM_GETOBJECT
description: When it receives a WM_GETOBJECT message that contains OBJID_CLIENT, the server must return a pointer to the object that implements IAccessible.
ms.assetid: 455398b7-f748-4ab0-8953-3f74439e44f1
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Handle WM_GETOBJECT</h1>
<p>When it receives a <a href="wm-getobject.html"><strong>WM_GETOBJECT</strong></a> message that contains <a href="object-identifiers.html"><strong>OBJID_CLIENT</strong></a>, the server must return a pointer to the object that implements <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a>. This pointer is an LRESULT that is obtained by calling <a href="/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject"><strong>LresultFromObject</strong></a>. Microsoft Active Accessibility, in conjunction with the Component Object Model (COM) library, performs the appropriate marshaling and passes the <strong>IAccessible</strong> interface pointer from the server to the client.</p>
<p>Servers must correctly handle reference counting on the accessible object. Remember that when you create a COM object, the reference count is 1. <a href="/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject"><strong>LresultFromObject</strong></a> then further increments the reference count several times. All the references created by <strong>LresultFromObject</strong> are automatically released when the object is no longer needed, but the server is responsible for releasing the initial reference, and unless it does so, the object will never be destroyed. The examples in the following sections show how to release references to accessible objects.</p>
<p>Servers typically handle <a href="wm-getobject.html"><strong>WM_GETOBJECT</strong></a> in one of the following ways:</p>
<ul>
<li><a href="create-new-accessible-objects.html">Create New Accessible Objects</a></li>
<li><a href="reuse-existing-pointers-to-objects.html">Reuse Existing Pointers to Objects</a></li>
<li><a href="create-new-interfaces-to-the-same-object.html">Create New Interfaces to the Same Object</a></li>
</ul>
<blockquote>
<p>[!Note]<br />
In this section as in the rest of the documentation, when a pointer to an <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> interface is discussed, this pointer may actually be a pointer to a proxy object that wraps the <strong>IAccessible</strong> interface. For more information about proxy objects, see <a href="creating-proxy-objects.html">Creating Proxy Objects</a>.</p>
</blockquote>
<p>Â </p>
<p>For an overview of <a href="wm-getobject.html"><strong>WM_GETOBJECT</strong></a>, see <a href="how-wm-getobject-works.html">How WM_GETOBJECT Works</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
