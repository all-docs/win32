<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MenuItem Control Type</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MenuItem Control Type
description: This topic provides information about Microsoft UI Automation support for the MenuItem control type.
ms.assetid: a6a04489-8e28-44ff-a3b0-ecf19c24daab
keywords:</p>
<ul>
<li>UI Automation,support for MenuItem control type</li>
<li>UI Automation,MenuItem control type</li>
<li>UI Automation,tree structure for MenuItem control type</li>
<li>UI Automation,properties for MenuItem control type</li>
<li>UI Automation,control patterns for MenuItem control type</li>
<li>UI Automation,events for MenuItem control type</li>
<li>tree structures,MenuItem control type</li>
<li>properties,MenuItem control type</li>
<li>control patterns,MenuItem control type</li>
<li>events,MenuItem control type</li>
<li>support for MenuItem control type</li>
<li>MenuItem control type</li>
<li>control types,tree structure for MenuItem control type</li>
<li>control types,control patterns for MenuItem control type</li>
<li>control types,support for MenuItem</li>
<li>control types,MenuItem
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MenuItem Control Type</h1>
<p>This topic provides information about Microsoft UI Automation support for the <strong>MenuItem</strong> control type.</p>
<p>A menu control allows hierarchal organization of elements associated with commands and event handlers. In a typical Windows application, a menu bar contains several menu items (such as <strong>File</strong>, <strong>Edit</strong>, and <strong>Window</strong>), and each menu item displays a menu. A menu contains a collection of menu items (such as <strong>New</strong>, <strong>Open</strong>, and <strong>Close</strong>), which can be expanded to display additional menu items or perform a specific action when clicked.</p>
<p>The following sections define the required UI Automation tree structure, properties, control patterns, and events for the <strong>MenuItem</strong> control type. The UI Automation requirements apply to all menu item controls where the UI framework/platform integrates UI Automation support for control types and control patterns.</p>
<p>This topic contains the following sections.</p>
<ul>
<li><a href="#typical-tree-structure">Typical Tree Structure</a></li>
<li><a href="#relevant-properties">Relevant Properties</a></li>
<li><a href="#required-control-patterns">Required Control Patterns</a></li>
<li><a href="#required-events">Required Events</a></li>
<li><a href="#legacy-issues">Legacy Issues</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Typical Tree Structure</h2>
<p>The following table depicts a typical control and content view of the UI Automation tree that pertains to menu item controls and describes what can be contained in each view. For more information about the UI Automation tree, see <a href="uiauto-treeoverview.html">UI Automation Tree Overview</a>.</p>
<table>
<thead>
<tr>
<th>Control View</th>
<th>Content View</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->MenuItem &quot;Help&quot;<!-- raw HTML omitted --><!-- raw HTML omitted -->Menu (submenu of Help menu item)<!-- raw HTML omitted --><!-- raw HTML omitted -->MenuItem &quot;Help Topics&quot;<!-- raw HTML omitted --><!-- raw HTML omitted -->MenuItem &quot;About Notepad&quot;<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->MenuItem &quot;Help&quot;<!-- raw HTML omitted --><!-- raw HTML omitted -->MenuItem &quot;Help Topics&quot;<!-- raw HTML omitted --><!-- raw HTML omitted -->MenuItem &quot;About Notepad&quot;<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The control view of the menu item control has the UI Automation tree structure shown above. Note that the menu item for <strong>Help</strong> on the menu bar has been added to better illustrate the structure.</p>
<p>For the content view, <strong>Menu</strong> is absent from the UI Automation tree because it does not convey meaningful information to the end user.</p>
<h2>Relevant Properties</h2>
<p>The following table lists the UI Automation properties whose value or definition is especially relevant to the <strong>MenuItem</strong> control type. For more information about UI Automation properties, see <a href="uiauto-propertiesforclients.html">Retrieving Properties from UI Automation Elements</a>.</p>
<table>
<thead>
<tr>
<th>UI Automation Property</th>
<th>Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_AutomationIdPropertyId</strong></a></td>
<td>See notes.</td>
<td>The value of this property must be unique among all peer elements in the raw view of the UI Automation tree. Allocate the <strong>AutomationId</strong> property for a menu item if the element is known to be consistent across different instances of the user interface. If the menu item is dynamically populated and not predictable, leave the <strong>AutomationId</strong> property blank.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_BoundingRectanglePropertyId</strong></a></td>
<td>See notes.</td>
<td>The outermost rectangle that contains the whole control.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_ClickablePointPropertyId</strong></a></td>
<td>See notes.</td>
<td>Supported if there is a bounding rectangle. If not every point within the bounding rectangle is clickable, and the element performs specialized hit testing, override and provide a clickable point.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_ControlTypePropertyId</strong></a></td>
<td><strong>MenuItem</strong></td>
<td></td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsContentElementPropertyId</strong></a></td>
<td>TRUE</td>
<td>The menu item control is always included in the content view of the UI Automation tree.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsControlElementPropertyId</strong></a></td>
<td>TRUE</td>
<td>The menu item control is always included in the control view of the UI Automation tree.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsKeyboardFocusablePropertyId</strong></a></td>
<td>See notes.</td>
<td>If the control can receive keyboard focus, it must support this property.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_LocalizedControlTypePropertyId</strong></a></td>
<td>See notes.</td>
<td>Localized string corresponding to the <strong>MenuItem</strong> control type. The default value is &quot;menu item&quot; for en-US or English (United States).</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_NamePropertyId</strong></a></td>
<td>See notes.</td>
<td>The name of the menu item control is the text used to label it.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Required Control Patterns</h2>
<p>The following table lists the UI Automation control patterns required to be supported by menu item controls. For more information on control patterns, see <a href="uiauto-controlpatternsoverview.html">UI Automation Control Patterns Overview</a>.</p>
<table>
<thead>
<tr>
<th>Control Pattern</th>
<th>Support</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider"><strong>IExpandCollapseProvider</strong></a></td>
<td>Depends</td>
<td>If the control can be expanded or collapsed, implement <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider"><strong>IExpandCollapseProvider</strong></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider"><strong>IInvokeProvider</strong></a></td>
<td>Depends</td>
<td>If the control executes a single action or command, implement <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider"><strong>IInvokeProvider</strong></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iselectionitemprovider"><strong>ISelectionItemProvider</strong></a></td>
<td>Depends</td>
<td>If the control is used to select from a list of options among menu items, implement <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iselectionitemprovider"><strong>ISelectionItemProvider</strong></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itoggleprovider"><strong>IToggleProvider</strong></a></td>
<td>Depends</td>
<td>If the control represents an option that can be turned on or off, implement <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itoggleprovider"><strong>IToggleProvider</strong></a>.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Required Events</h2>
<p>The following table lists the UI Automation events that menu item controls are required to support. For more information on events, see <a href="uiauto-eventsoverview.html">UI Automation Events Overview</a>.</p>
<table>
<thead>
<tr>
<th>UI Automation Event</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="uiauto-event-ids.html"><strong>UIA_AutomationFocusChangedEventId</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_BoundingRectanglePropertyId</strong></a> property-changed event.</td>
<td></td>
</tr>
<tr>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ExpandCollapseExpandCollapseStatePropertyId</strong></a> property-changed event.</td>
<td>If the control supports the <a href="uiauto-implementingexpandcollapse.html">ExpandCollapse</a> control pattern, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-event-ids.html"><strong>UIA_Invoke_InvokedEventId</strong></a></td>
<td>If the control supports the <a href="uiauto-implementinginvoke.html">Invoke</a> control pattern, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsEnabledPropertyId</strong></a> property-changed event.</td>
<td>If the control supports the <a href="uiauto-automation-element-propids.html"><strong>IsEnabled</strong></a> property, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsOffscreenPropertyId</strong></a> property-changed event.</td>
<td>If the control supports the <a href="uiauto-automation-element-propids.html"><strong>IsOffscreen</strong></a> property, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-event-ids.html"><strong>UIA_SelectionItem_ElementAddedToSelectionEventId</strong></a></td>
<td>If the control supports the <a href="uiauto-implementingselectionitem.html">SelectionItem</a> control pattern, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-event-ids.html"><strong>UIA_SelectionItem_ElementRemovedFromSelectionEventId</strong></a></td>
<td>If the control supports the <a href="uiauto-implementingselectionitem.html">SelectionItem</a> control pattern, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-event-ids.html"><strong>UIA_SelectionItem_ElementSelectedEventId</strong></a></td>
<td>If the control supports the <a href="uiauto-implementingselectionitem.html">SelectionItem</a> control pattern, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-event-ids.html"><strong>UIA_StructureChangedEventId</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ToggleToggleStatePropertyId</strong></a> property-changed event.</td>
<td>If the control supports the <a href="uiauto-implementingtoggle.html">Toggle</a> control pattern, it must support this event.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Legacy Issues</h2>
<p>For Microsoft Win32 menu items, the <a href="uiauto-implementingtoggle.html">Toggle</a> control pattern is supported only when a menu item is checked and it is possible to programmatically determine whether support for the Toggle control pattern is required. Because a Win32 menu item does not expose whether it can be checked, the Invoke control pattern is supported when the menu item is not checked. The Invoke control pattern is always supported, even for menu items that are only required to support the Toggle control pattern. This is so clients do not become confused when a menu item that was supporting the <a href="uiauto-implementinginvoke.html">Invoke</a> control pattern (when the menu item was unchecked) no longer supports that pattern when it becomes checked.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-controltypesoverview.html">UI Automation Control Types Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-uiautomationoverview.html">UI Automation Overview</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
