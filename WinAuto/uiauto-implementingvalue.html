<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Value Control Pattern</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Value Control Pattern
description: Describes guidelines and conventions for implementing IValueProvider, including information about properties and methods.
ms.assetid: 6b11d281-aca7-4548-853c-e7322999825d
keywords:</p>
<ul>
<li>UI Automation,implementing Value control pattern</li>
<li>UI Automation,Value control pattern</li>
<li>UI Automation,IValueProvider</li>
<li>IValueProvider</li>
<li>implementing UI Automation Value control patterns</li>
<li>Value control patterns</li>
<li>control patterns,IValueProvider</li>
<li>control patterns,implementing UI Automation Value</li>
<li>control patterns,Value</li>
<li>interfaces,IValueProvider
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Value Control Pattern</h1>
<p>Describes guidelines and conventions for implementing <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider"><strong>IValueProvider</strong></a>, including information about properties and methods. The <strong>Value</strong> control pattern is used to support controls that have an intrinsic value not spanning a range and that can be represented as a string.</p>
<p>The value string can be editable, depending on the control and its settings. For examples of controls that implement this control pattern, see <a href="uiauto-controlpatternmapping.html">Control Types and Their Supported Control Patterns</a>.</p>
<p>This topic contains the following sections.</p>
<ul>
<li><a href="#implementation-guidelines-and-conventions">Implementation Guidelines and Conventions</a></li>
<li><a href="#required-members-for-ivalueprovider">Required Members for <strong>IValueProvider</strong></a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Implementation Guidelines and Conventions</h2>
<p>When implementing the <strong>Value</strong> control pattern, note the following guidelines and conventions:</p>
<ul>
<li>
<p>Controls such as a list item or tree item must support the <strong>Value</strong> control pattern if the value of any of the items is editable, regardless of the current edit mode of the control. The parent control must also support the <strong>Value</strong> control pattern if the child items are editable. The following image shows an example of an editable list item.</p>
<p><img src="images/uia-valuepattern-editable-listitem.jpg" alt="illustration showing editable list item" /></p>
</li>
<li>
<p>Single and multi-line edit controls must implement <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider"><strong>ITextProvider</strong></a> to expose their read-only content.</p>
</li>
<li>
<p>Multi-line edit controls must implement <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider"><strong>IValueProvider</strong></a> if their contents can be changed.</p>
</li>
<li>
<p><a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider"><strong>IValueProvider</strong></a> does not support the retrieval of formatting information or substring values. Implement <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider"><strong>ITextProvider</strong></a> in these scenarios.</p>
</li>
<li>
<p><a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider"><strong>IValueProvider</strong></a> must be implemented by controls such as the color picker selection control from Microsoft Word (see the following image), which supports string mapping between a color value (for example, &quot;yellow&quot;) and an equivalent internal <a href="/windows/win32/api/wingdi/nf-wingdi-rgb">RGB</a> value.</p>
<p><img src="images/uia-valuepattern-colorpicker.jpg" alt="illustration showing color swatch string mapping" /></p>
</li>
<li>
<p>A control should have its <strong>IsEnabled</strong> property set to <strong>TRUE</strong> and its <a href="/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_isreadonly"><strong>ITextProvider::IsReadOnly</strong></a> property set to <strong>FALSE</strong> before allowing a call to <a href="/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-setvalue"><strong>ITextProvider::SetValue</strong></a>.</p>
</li>
</ul>
<h2>Required Members for <strong>IValueProvider</strong></h2>
<p>The following properties and methods are required for implementing the <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider"><strong>IValueProvider</strong></a> interface.</p>
<table>
<thead>
<tr>
<th>Required members</th>
<th>Member type</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_isreadonly"><strong>IsReadOnly</strong></a></td>
<td>Property</td>
<td>None</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_value"><strong>Value</strong></a></td>
<td>Property</td>
<td>None</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-setvalue"><strong>SetValue</strong></a></td>
<td>Method</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>This control pattern has no associated events.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="uiauto-controlpatternmapping.html">Control Types and Their Supported Control Patterns</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-controlpatternsoverview.html">UI Automation Control Patterns Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-treeoverview.html">UI Automation Tree Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-implementingtextandtextrange.html">Text and TextRange Control Patterns</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
