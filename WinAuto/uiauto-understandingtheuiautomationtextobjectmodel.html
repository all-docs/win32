<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Understanding the UI Automation Text Object Model</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Understanding the UI Automation Text Object Model
description: This topic describes how Microsoft UI Automation client applications access the textual content of a text-based control.
ms.assetid: 8545EBA3-6995-4336-A197-27CE3A3339EE
keywords:</p>
<ul>
<li>clients,understanding UI Automation text object model</li>
<li>clients,text-based controls</li>
<li>clients,text ranges</li>
<li>clients,Text control pattern</li>
<li>clients,TextRange control pattern
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Understanding the UI Automation Text Object Model</h1>
<p>This topic describes how Microsoft UI Automation client applications access the textual content of a text-based control.</p>
<ul>
<li><a href="#control-specific-object-model">Control-specific Object Model</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<p>Text-based controls expose textual content to UI Automation client applications through a simple text object model. Client applications have access to the text object model through the <a href="uiauto-about-text-and-textrange-patterns.html">Text and TextRange</a> control pattern interfaces, including <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern"><strong>IUIAutomationTextPattern</strong></a> and <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange"><strong>IUIAutomationTextRange</strong></a>. Client applications can use these interfaces to retrieve textual content, text attributes, and embedded objects such as tables and hyperlinks from text-based controls.</p>
<p>Control types that support the UI Automation text object model include the <a href="uiauto-supporteditcontroltype.html">Edit</a> and <a href="uiauto-supportdocumentcontroltype.html">Document</a> control types. Other control types such as <a href="uiauto-supporttooltipcontroltype.html">ToolTip</a> and <a href="uiauto-supporttextcontroltype.html">Text</a> might also support the text object model, but they are not required to.</p>
<blockquote>
<p>[!Note]<br />
The UI Automation text object model does not provide a means to insert or modify text. However, some controls enable text to be inserted or modified either through the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvaluepattern"><strong>IUIAutomationValuePattern</strong></a> interface, or through direct keyboard input.</p>
</blockquote>
<p>Â </p>
<h2>Control-specific Object Model</h2>
<p>A text-based control that implements its own Document Object Model (DOM) can expose the DOM by implementing the <a href="uiauto-implementingobjectmodel.html">ObjectModel</a> control pattern. Exposing the DOM can give client applications greater access to, and control over, the content of a text-based control.</p>
<p>A client application can discover whether a particular text-based control implements a DOM by retrieving the control's <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement"><strong>IUIAutomationElement</strong></a> interface. Then, call the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpropertyvalue"><strong>IUIAutomationElement::GetCurrentPropertyValue</strong></a> method, specifying the <a href="uiauto-control-pattern-availability-propids.html"><strong>UIA_IsObjectModelPatternAvailablePropertyId</strong></a> property identifier, and a variant that receives TRUE if the control implements a DOM.</p>
<p>To access the DOM, call the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern"><strong>IUIAutomationElement::GetCurrentPattern</strong></a> method, specifying the <a href="uiauto-controlpattern-ids.html"><strong>UIA_ObjectModelPatternId</strong></a> control pattern identifier and a variable that receives the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationobjectmodelpattern"><strong>IUIAutomationObjectModelPattern</strong></a> interface. Call the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationobjectmodelpattern-getunderlyingobjectmodel"><strong>IUIAutomationObjectModelPattern::GetUnderlyingObjectModel</strong></a> method to retrieve the DOM interface.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="uiauto-implementingtextandtextrange.html">Text and TextRange Control Patterns</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-ui-automation-textpattern-overview.html">UI Automation Support for Textual Content</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-workingwithtextbasedcontrols.html">Working with Text-based Controls</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
