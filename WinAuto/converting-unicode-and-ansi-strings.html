<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Converting Unicode and ANSI Strings</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Converting Unicode and ANSI Strings
description: Microsoft Active Accessibility uses Unicode strings as defined by the BSTR data type.
ms.assetid: 47f525fe-6d18-43b9-a706-e49afa796830
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Converting Unicode and ANSI Strings</h1>
<p>Microsoft Active Accessibility uses Unicode strings as defined by the <strong>BSTR</strong> data type. If your application does not use Unicode strings, or if you want to convert strings for certain API calls, use the <a href="/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar"><strong>MultiByteToWideChar</strong></a> and <a href="/windows/desktop/api/stringapiset/nf-stringapiset-widechartomultibyte"><strong>WideCharToMultiByte</strong></a> Microsoft Win32 functions to perform the necessary conversion.</p>
<p>Use <a href="/windows/desktop/api/stringapiset/nf-stringapiset-widechartomultibyte"><strong>WideCharToMultiByte</strong></a> to convert a Unicode string to an ANSI string. The <a href="/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar"><strong>MultiByteToWideChar</strong></a> function converts an ANSI string to a Unicode string.</p>
<p>Use <a href="/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysallocstring"><strong>SysAllocString</strong></a> and <a href="/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysfreestring"><strong>SysFreeString</strong></a> to allocate and free <strong>BSTR</strong> data types.</p>
<p>For more information about these string functions, see their references in the Windows Software Development Kit (SDK).</p>
<p>Â </p>
<p>Â </p>
</body>
