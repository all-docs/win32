<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Architecture and Interoperability</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Architecture and Interoperability
description: This topic briefly describes the architecture of Microsoft Active Accessibility and Microsoft UI Automation, and the components that allow interoperability between applications based on the two different technologies.
ms.assetid: 7309819c-7c72-4bb3-ab9c-608a27c56d42
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Architecture and Interoperability</h1>
<p>This topic briefly describes the architecture of Microsoft Active Accessibility and Microsoft UI Automation, and the components that allow interoperability between applications based on the two different technologies.</p>
<p>For more information about Microsoft Active Accessibility and UI Automation interoperability, see <a href="common-infrastructure.html">Common Infrastructure</a>.</p>
<p>This topic contains the following sections.</p>
<ul>
<li><a href="#microsoft-active-accessibility-architecture">Microsoft Active Accessibility Architecture</a></li>
<li><a href="#ui-automation-architecture">UI Automation Architecture</a></li>
<li><a href="#microsoft-active-accessibility-and-ui-automation-interoperability">Microsoft Active Accessibility and UI Automation Interoperability</a></li>
<li><a href="#the-iaccessibleex-interface">The IAccessibleEx Interface</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Microsoft Active Accessibility Architecture</h2>
<p>Microsoft Active Accessibility exposes basic information about controls such as control name, location on screen, and type of control, as well as state information such as visibility and enabled/disabled status. The UI is represented as a hierarchy of accessible objects; changes and actions are represented as WinEvents.</p>
<p>Microsoft Active Accessibility consists of the following components:</p>
<ul>
<li>Accessible objectâ€”A logical UI element (such as a button) that is represented by an <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> Component Object Model (COM) interface and an integer child identifier (ChildID).</li>
<li>WinEventsâ€”An event system that enables servers to notify clients when an accessible object changes. For more information, see <a href="winevents-infrastructure.html">WinEvents</a>.</li>
<li>OLEACC.dllâ€”The run-time, dynamic-link library that provides the Microsoft Active Accessibility API and the accessibility system framework. OLEACC implements proxy objects that provide default accessibility information for standard UI elements, including USER controls, USER menus, and common controls.</li>
</ul>
<p>For Microsoft Active Accessibility, the system component of the accessibility framework (OLEACC) helps the communication between assistive technologies (accessibility tools) and applications, as the following illustration shows.</p>
<p><img src="images/msaaarch.gif" alt="illustration showing how accessibility tools interact with applications" /></p>
<p>The applications (Microsoft Active Accessibility servers) provide UI accessibility information to tools (Microsoft Active Accessibility clients), which interact with the UI on behalf of users. The code boundary is both a programmatic and a process boundary.</p>
<h2>UI Automation Architecture</h2>
<p>With UI Automation, the UI Automation core component (UIAutomationCore.dll) is loaded into both the accessibility tools' and applications' processes. The core component manages cross-process communication, provides higher level services such as searching for elements by property values, and enables bulk fetching or caching of properties, which provides better performance than the Microsoft Active Accessibility implementation.</p>
<p>UI Automation includes proxy objects that provide UI information about standard UI elements such as USER controls, USER menus, and common controls. It also includes proxies that enable UI Automation clients to get UI information from Microsoft Active Accessibility servers.</p>
<p>The following illustration shows the relationships among the various UI Automation components used in accessibility tools (clients) and in applications (providers).</p>
<p><img src="images/uiaarch.gif" alt="illustration showing how components of accessibility tools interact with those in applications" /></p>
<h2>Microsoft Active Accessibility and UI Automation Interoperability</h2>
<p>The UI Automation to Microsoft Active Accessibility Bridge enables Microsoft Active Accessibility clients to access UI Automation providers by converting the UI Automation object model to a Microsoft Active Accessibility object model. The following illustration shows the role of the UI Automation-to-Microsoft Active Accessibility Bridge.</p>
<p><img src="images/uiatomsaabridge.gif" alt="illustration showing how ui automation works with accessibility tools and applications" /></p>
<p>Similarly, the Microsoft Active Accessibility-to-UI Automation Proxy translates Microsoft Active Accessibility-based server object models for UI Automation clients. The following illustration shows the role of the Microsoft Active Accessibility-to-UI Automation Proxy.</p>
<p><img src="images/msaatouiaproxy.gif" alt="illustration showing how ui automation proxy works with accessibility tools and applications" /></p>
<h2>The IAccessibleEx Interface</h2>
<p>The <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iaccessibleex"><strong>IAccessibleEx</strong></a> interface enables existing applications or UI libraries to extend their Microsoft Active Accessibility object model to support UI Automation without rewriting the implementation from scratch. With <strong>IAccessibleEx</strong>, you can implement only the additional UI Automation properties and control patterns needed to fully describe the UI and its functionality.</p>
<p>Because the Microsoft Active Accessibility-to-UI Automation Proxy translates the object models of <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iaccessibleex"><strong>IAccessibleEx</strong></a>-enabled Microsoft Active Accessibility servers as UI Automation object models, UI Automation clients do not need to do any extra work. The <strong>IAccessibleEx</strong> interface can also enable in-process Microsoft Active Accessibility clients to interact directly with UI Automation providers.</p>
<p>For more information, see <a href="iaccessibleex.html">The IAccessibleEx Interface</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="windows-automation-api-overview.html">Windows Automation API Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="iaccessibleex.html">The IAccessibleEx Interface</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-securityoverview.html">Security Considerations for Assistive Technologies</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
