<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Menu Item (MSAA UI Element Reference)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Menu Item (MSAA UI Element Reference)
description: A menu item represents a particular item in a menu bar or pop-up menu.
ms.assetid: 330782d6-4293-4e65-ab49-a616d133d273
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Menu Item (MSAA UI Element Reference)</h1>
<blockquote>
<p>[!Note]<br />
This topic describes <strong>Menu Item</strong> objects for purposes of MSAA UI Element Reference. How to create <strong>Menu Item</strong> objects in various UI frameworks is not described here. See the API reference documentation for the UI framework you're using.</p>
</blockquote>
<p>A menu item represents a particular item in a menu bar or pop-up menu. For example, Microsoft Active Accessibility creates a menu item object for the <strong>File</strong> menu in the menu bar. Similarly, Microsoft Active Accessibility creates a menu item object for the <strong>Open</strong> menu item from the <strong>File</strong> pop-up menu.</p>
<p>The window class name for a menu item is &quot;#32768&quot;.</p>
<h2>IAccessible Methods</h2>
<p>A menu item supports the following <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> methods:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accdodefaultaction"><strong>accDoDefaultAction</strong></a></td>
<td>For menu items from the menu bar, <a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accdodefaultaction"><strong>accDoDefaultAction</strong></a> either displays or closes the menu depending on the state of the menu. For menu items from a pop-up menu, <strong>accDoDefaultAction</strong> clicks the menu item to execute the menu command.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest"><strong>acchittest</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation"><strong>accLocation</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate"><strong>accNavigate</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accselect"><strong>accSelect</strong></a></td>
<td></td>
</tr>
</tbody>
</table>
<h2>IAccessible Properties</h2>
<p>A menu item supports the following <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> properties:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild"><strong>get_accChild</strong></a></td>
<td>Retrieves the <a href="idispatch-interface.html"><strong>IDispatch</strong></a> interface to the pop-up menu object for this item.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchildcount"><strong>get_accChildCount</strong></a></td>
<td>The <strong>ChildCount</strong> property is one for menu items that display a menu or submenu; otherwise the <strong>ChildCount</strong> property is zero.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accdefaultaction"><strong>get_accDefaultAction</strong></a></td>
<td>The <strong>DefaultAction</strong> property for menu items that display a menu or submenu is either &quot;Open&quot; or &quot;Close&quot; depending on the state of the menu. The <strong>DefaultAction</strong> property for all other menu items is &quot;Execute&quot;.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accfocus"><strong>get_accFocus</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acckeyboardshortcut"><strong>get_accKeyboardShortcut</strong></a></td>
<td>The <strong>KeyboardShortcut</strong> property is the menu item's access key, which is the underlined character in the text of the menu item's name. For example, the <strong>KeyboardShortcut</strong> property for theFile menu item is &quot;f&quot;.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname"><strong>get_accName</strong></a></td>
<td>The <strong>Name</strong> property is the same as the name of the menu item.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent"><strong>get_accParent</strong></a></td>
<td>The <strong>Parent</strong> property is the menu bar or pop-up menu that contains the menu item.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accrole"><strong>get_accRole</strong></a></td>
<td>The <strong>Role</strong> property is <a href="object-roles.html"><strong>ROLE_SYSTEM_MENUITEM</strong></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accstate"><strong>get_accState</strong></a></td>
<td>The <strong>State</strong> property is either <a href="object-state-constants.html"><strong>STATE_SYSTEM_INVISIBLE</strong></a> or a combination of one or more of the following values: <a href="object-state-constants.html"><strong>STATE_SYSTEM_UNAVAILABLE</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_CHECKED</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_DEFAULT</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_HOTTRACKED</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_FOCUSED</strong></a> | <a href="object-state-constants.html"><strong>STATE_SYSTEM_HASPOPUP</strong></a><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Notes</h2>
<ul>
<li>When used on a menu item, <a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accdodefaultaction"><strong>accDoDefaultAction</strong></a> returns S_OK but fails to perform the action if the character used in the access key is ?, !, @, or any other character that requires the SHIFT key or another modifier key. This also happens on international keyboards with an access key character that requires the ALT GR key to be pressed.</li>
<li>The <a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accselect"><strong>accSelect</strong></a> method with <a href="selflag.html"><strong>SELFLAG_TAKEFOCUS</strong></a> does not cause a menu item to open or close a pop-up menu. Clients use the <a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accdodefaultaction"><strong>accDoDefaultAction</strong></a> method to open or close a pop-up menu.</li>
<li>A menu bar item that does not display a pop-up menu returns &quot;Application&quot; for the <strong>Name</strong> property instead of the name of the menu item.</li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible">IAccessible Interface</a></p>
<!-- raw HTML omitted -->
<p><a href="menu-bar.html"><strong>Menu Bar</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="pop-up-menu.html"><strong>Pop-up Menu</strong></a></p>
<!-- raw HTML omitted -->
</body>
