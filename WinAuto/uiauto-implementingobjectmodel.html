<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ObjectModel Control Pattern</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: ObjectModel Control Pattern
description: Describes guidelines and conventions for implementing IObjectModelProvider, including information about methods. The ObjectModel control pattern is used to expose a pointer to the underlying object model of a document.
ms.assetid: 90A6937E-0E98-41EF-8EEB-E23CB71510E4
keywords:</p>
<ul>
<li>UI Automation,implementing ObjectModel control pattern</li>
<li>UI Automation,ObjectModel control pattern</li>
<li>UI Automation,IObjectModelProvider</li>
<li>IObjectModelProvider</li>
<li>implementing UI Automation ObjectModel control pattern</li>
<li>ObjectModel control pattern</li>
<li>control patterns,IObjectModelProvider</li>
<li>control patterns,implementing UI Automation ObjectModel</li>
<li>control patterns,ObjectModel</li>
<li>interfaces,IObjectModelProvider
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>ObjectModel Control Pattern</h1>
<p>Describes guidelines and conventions for implementing <a href="/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iobjectmodelprovider"><strong>IObjectModelProvider</strong></a>, including information about methods. The <strong>ObjectModel</strong> control pattern is used to expose a pointer to the underlying object model of a document.</p>
<p>Many applications implement rich object models that add value beyond what Microsoft UI Automation provides. This control pattern allows a client to navigate from a UI Automation element into the underlying object model.</p>
<p>This topic contains the following sections.</p>
<ul>
<li><a href="#implementation-guidelines-and-conventions">Implementation Guidelines and Conventions</a></li>
<li><a href="#required-members-for-iobjectmodelprovider">Required Members for <strong>IObjectModelProvider</strong></a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Implementation Guidelines and Conventions</h2>
<p>When implementing the <strong>ObjectModel</strong> control pattern, note the following guidelines and conventions:</p>
<ul>
<li>The <a href="/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iobjectmodelprovider-getunderlyingobjectmodel"><strong>IObjectModelProvider::GetUnderlyingObjectModel</strong></a> method should return a pointer to the object that is as close as possible to the source UI element. For example, in a web browser, a UI Automation provider for a single element should return an object model pointer for the element. Returning an object model pointer for the document root would be far less useful.</li>
<li>The client of the <strong>ObjectModel</strong> control pattern is expected to have the IID for the interface they are seeking, which is why it is enough to return a simple <a href="/windows/desktop/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> pointer.</li>
<li>Because UI Automation marshals the pointer to the client process, the provider should expect the client to access the object model using standard Component Object Model (COM) practices.</li>
</ul>
<h2>Required Members for <strong>IObjectModelProvider</strong></h2>
<p>The following method is required for implementing the <a href="/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iobjectmodelprovider"><strong>IObjectModelProvider</strong></a> interface.</p>
<table>
<thead>
<tr>
<th>Required members</th>
<th>Member type</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iobjectmodelprovider-getunderlyingobjectmodel"><strong>GetUnderlyingObjectModel</strong></a></td>
<td>Method</td>
<td>Returns a COM pointer to the underlying object model. The client is expected to call the <a href="/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)"><strong>IUnknown::QueryInterface</strong></a> method to retrieve specific object model pointers.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>This control pattern has no associated events.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="uiauto-controlpatternmapping.html">Control Types and Their Supported Control Patterns</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-controlpatternsoverview.html">UI Automation Control Patterns Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-treeoverview.html">UI Automation Tree Overview</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
