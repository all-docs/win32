<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>UI Automation and Active Accessibility</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: UI Automation and Active Accessibility
description: Microsoft Active Accessibility is the legacy API that was introduced in WindowsÂ 95, and was designed to make Windows applications accessible.
ms.assetid: 6fc92e67-b94b-4ba3-9f5d-42be6072f110
keywords:</p>
<ul>
<li>UI Automation,Microsoft Active Accessibility</li>
<li>UI Automation,accessibility</li>
<li>UI Automation,Active Accessibility</li>
<li>UI Automation,programming languages</li>
<li>UI Automation,tree views</li>
<li>UI Automation,navigation</li>
<li>UI Automation,control types</li>
<li>accessibility</li>
<li>Active Accessibility</li>
<li>Microsoft Active Accessibility</li>
<li>control types,about
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>UI Automation and Active Accessibility</h1>
<p>Microsoft Active Accessibility is the legacy API that was introduced in WindowsÂ 95, and was designed to make Windows applications accessible. Microsoft UI Automation is the new accessibility model for Windows and is intended to address the needs of assistive technology products and automated testing tools. UI Automation offers many improvements over Microsoft Active Accessibility. This topic explains the differences between the two technologies.</p>
<p>This topic contains the following sections.</p>
<ul>
<li><a href="#programming-languages">Programming Languages</a></li>
<li><a href="#servers-and-clients">Servers and Clients</a></li>
<li><a href="#ui-elements">UI Elements</a></li>
<li><a href="#tree-views-and-navigation">Tree Views and Navigation</a></li>
<li><a href="#roles-and-control-types">Roles and Control Types</a></li>
<li><a href="#states-and-properties">States and Properties</a></li>
<li><a href="#events">Events</a></li>
<li><a href="#accessing-active-accessibility-properties-and-objects-from-ui-automation">Accessing Active Accessibility Properties and Objects from UI Automation</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Programming Languages</h2>
<p>Microsoft Active Accessibility is based on the Component Object Model (COM) with support for dual interfaces, and therefore, is programmable in C/C++ and scripting languages.</p>
<p>When UI Automation was introduced, the client API was limited to managed code, while the provider API included both managed and unmanaged implementations. With WindowsÂ 7, a new COM-based client API was introduced to make it easier to program UI Automation client applications in C/C++.</p>
<h2>Servers and Clients</h2>
<p>In Microsoft Active Accessibility, servers and clients communicate directly, largely through the server implementation of the <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> interface.</p>
<p>In UI Automation, a core service lies between the server (provider) and the client. The core service makes calls to the interfaces implemented by providers and provides additional services, such as generating unique run-time identifiers for UI elements. Client applications gain access to this core service by creating a <a href="/previous-versions/windows/desktop/legacy/ff384838(v=vs.85)"><strong>CUIAutomation</strong></a> object. This object supports a set of client interfaces that are separate from the provider interfaces. For more information, see <a href="uiauto-creatingcuiautomation.html">Creating the CUIAutomation Object</a>.</p>
<p>UI Automation providers can provide information to Microsoft Active Accessibility clients, and Microsoft Active Accessibility servers can provide information to UI Automation client applications. However, because Microsoft Active Accessibility does not expose as much information as UI Automation, the two models are not fully compatible.</p>
<h2>UI Elements</h2>
<p>Microsoft Active Accessibility presents a UI element as an <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> interface paired with a child identifier. It is difficult to compare two <strong>IAccessible</strong> pointers to determine if they refer to the same element.</p>
<p>In UI Automation, every element is represented as an object that exposes the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement"><strong>IUIAutomationElement</strong></a> interface to clients. Elements can be compared by their run-time identifiers, which are retrieved by using <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getruntimeid"><strong>IUIAutomationElement::GetRuntimeId</strong></a>.</p>
<h2>Tree Views and Navigation</h2>
<p>The UI elements on the screen can be seen as a tree structure with the desktop as the root, application windows as immediate children, and elements within applications as further descendants.</p>
<p>In Microsoft Active Accessibility, many UI elements that are irrelevant to end users are exposed in the tree structure. Client applications must examine all elements in the tree to determine which elements are meaningful.</p>
<p>UI Automation client applications see the UI through a filtered view. The view contains only elements that give information to the user or that the user can interact with. Predefined views that include only control elements and only content elements are available, and client applications can define custom views. UI Automation makes it easier to describe the UI to the user, and to help the user interact with applications.</p>
<p>In Microsoft Active Accessibility, navigation between elements is spatial, for example, moving to the element that lies to the left on the screen, logical, for example, moving to the next menu item or the next item in the tab order in a dialog box, or hierarchical, for example, moving to the first child element in a container or from a child element to its parent element. Hierarchical navigation is complicated by the fact that child elements are not always objects that implement <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a>.</p>
<p>In UI Automation, all UI elements are COM objects that expose the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement"><strong>IUIAutomationElement</strong></a> interface and support the same basic functionality. From the standpoint of the provider, COM objects implement an interface that is inherited from <a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple"><strong>IRawElementProviderSimple</strong></a>. Navigation is mainly hierarchical; that is, from parents to children, and from one sibling to the next. However, navigation between siblings has a logical element, as it may follow the tab order. A client can navigate from any starting-point, using any filtered view of the tree, by using <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker"><strong>IUIAutomationTreeWalker</strong></a>. A client can also navigate to particular children or descendants by using <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst"><strong>IUIAutomationElement::FindFirst</strong></a> and <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall"><strong>IUIAutomationElement::FindAll</strong></a>. For example, it is easy to retrieve all elements in a dialog box that support a specified control pattern.</p>
<p>Navigation in UI Automation is more consistent than in Microsoft Active Accessibility. Some elements, such as drop-down lists and pop-up windows, appear twice in the Microsoft Active Accessibility tree, and navigation from those elements may have unexpected results. It is difficult to implement Microsoft Active Accessibility properly for a rebar control. UI Automation enables reparenting and repositioning, so that an element can be placed anywhere in the tree, despite the hierarchy imposed by ownership of windows.</p>
<h2>Roles and Control Types</h2>
<p>Microsoft Active Accessibility uses the accRole property (<a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accrole"><strong>IAccessible::get_accRole</strong></a>) to retrieve a description of the element role in the UI, such as <a href="object-roles.html"><strong>ROLE_SYSTEM_SLIDER</strong></a> or <a href="object-roles.html"><strong>ROLE_SYSTEM_MENUITEM</strong></a>. The role of an element is the main clue to its available functionality. Interaction with a control is achieved by using fixed methods such as <a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accselect"><strong>IAccessible::accSelect</strong></a> and <a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accdodefaultaction"><strong>IAccessible::accDoDefaultAction</strong></a>. The interaction between the client application and the UI is limited to what can be done through <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a>.</p>
<p>In contrast, UI Automation decouples the control type of the element, which is described by the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentcontroltype"><strong>IUIAutomationElement::CurrentControlType</strong></a> (or <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_cachedcontroltype"><strong>IUIAutomationElement::CachedControlType</strong></a>) property, from its expected functionality. Functionality is determined by the control patterns that are supported by the provider through its implementation of specialized interfaces. Control patterns can be combined to describe the full set of functionality that is supported by a particular UI element. Some providers are required to support a particular control pattern. For example, the provider for a check box must support the <a href="uiauto-implementingtoggle.html">Toggle</a> control pattern. Other providers are required to support one or more of a set of control patterns. For example, a button must support either the Toggle or the <a href="uiauto-implementinginvoke.html">Invoke</a> control pattern. Still others support no control patterns. For example, a pane that cannot be moved, resized, or docked has no control patterns.</p>
<p>UI Automation supports custom controls, which are identified by the <a href="uiauto-controltype-ids.html"><strong>UIA_CustomControlTypeId</strong></a> constant and can be described by the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentlocalizedcontroltype"><strong>IUIAutomationElement::CurrentLocalizedControlType</strong></a> (or <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_cachedlocalizedcontroltype"><strong>IUIAutomationElement::CachedLocalizedControlType</strong></a>) property.</p>
<p>The following table maps Microsoft Active Accessibility <a href="object-roles.html">object roles</a> to UI Automation control types.</p>
<table>
<thead>
<tr>
<th>Active Accessibility role</th>
<th>UI Automation control type</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_PUSHBUTTON</strong></a></td>
<td><a href="uiauto-supportbuttoncontroltype.html">Button</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_CLIENT</strong></a></td>
<td><a href="uiauto-supportcalendarcontroltype.html">Calendar</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_CHECKBUTTON</strong></a></td>
<td><a href="uiauto-supportcheckboxcontroltype.html">CheckBox</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_COMBOBOX</strong></a></td>
<td><a href="uiauto-supportcomboboxcontroltype.html">ComboBox</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_CLIENT</strong></a></td>
<td>See <a href="uiauto-designingcustompropseventpatterns.html">Custom Control Types</a>.</td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_LIST</strong></a></td>
<td><a href="uiauto-supportdatagridcontroltype.html">DataGrid</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_LISTITEM</strong></a></td>
<td><a href="uiauto-supportdataitemcontroltype.html">DataItem</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_DOCUMENT</strong></a></td>
<td><a href="uiauto-supportdocumentcontroltype.html">Document</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_TEXT</strong></a></td>
<td><a href="uiauto-supporteditcontroltype.html">Edit</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_GROUPING</strong></a></td>
<td><a href="uiauto-supportgroupcontroltype.html">Group</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_LIST</strong></a></td>
<td><a href="uiauto-supportheadercontroltype.html">Header</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_COLUMNHEADER</strong></a></td>
<td><a href="uiauto-supportheaderitemcontroltype.html">HeaderItem</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_LINK</strong></a></td>
<td><a href="uiauto-supporthyperlinkcontroltype.html">Hyperlink</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_GRAPHIC</strong></a></td>
<td><a href="uiauto-supportimagecontroltype.html">Image</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_LIST</strong></a></td>
<td><a href="uiauto-supportlistcontroltype.html">List</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_LISTITEM</strong></a></td>
<td><a href="uiauto-supportlistitemcontroltype.html">ListItem</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_MENUPOPUP</strong></a></td>
<td><a href="uiauto-supportmenucontroltype.html">Menu</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_MENUBAR</strong></a></td>
<td><a href="uiauto-supportmenubarcontroltype.html">MenuBar</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_MENUITEM</strong></a></td>
<td><a href="uiauto-supportmenuitemcontroltype.html">MenuItem</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_PANE</strong></a></td>
<td><a href="uiauto-supportpanecontroltype.html">Pane</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_PROGRESSBAR</strong></a></td>
<td><a href="uiauto-supportprogressbarcontroltype.html">ProgressBar</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_RADIOBUTTON</strong></a></td>
<td><a href="uiauto-supportradiobuttoncontroltype.html">RadioButton</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_SCROLLBAR</strong></a></td>
<td><a href="uiauto-supportscrollbarcontroltype.html">ScrollBar</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_SEPARATOR</strong></a></td>
<td><a href="uiauto-supportseparatorcontroltype.html">Separator</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_SLIDER</strong></a></td>
<td><a href="uiauto-supportslidercontroltype.html">Slider</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_SPINBUTTON</strong></a></td>
<td><a href="uiauto-supportspinnercontroltype.html">Spinner</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_SPLITBUTTON</strong></a></td>
<td><a href="uiauto-supportsplitbuttoncontroltype.html">SplitButton</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_STATUSBAR</strong></a></td>
<td><a href="uiauto-supportstatusbarcontroltype.html">StatusBar</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_PAGETABLIST</strong></a></td>
<td><a href="uiauto-supporttabcontroltype.html">Tab</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_PAGETAB</strong></a></td>
<td><a href="uiauto-supporttabitemcontroltype.html">TabItem</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_TABLE</strong></a></td>
<td><a href="uiauto-supporttablecontroltype.html">Table</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_STATICTEXT</strong></a></td>
<td><a href="uiauto-supporttextcontroltype.html">Text</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_INDICATOR</strong></a></td>
<td><a href="uiauto-supportthumbcontroltype.html">Thumb</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_TITLEBAR</strong></a></td>
<td><a href="uiauto-supporttitlebarcontroltype.html">TitleBar</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_TOOLBAR</strong></a></td>
<td><a href="uiauto-supporttoolbarcontroltype.html">ToolBar</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_TOOLTIP</strong></a></td>
<td><a href="uiauto-supporttooltipcontroltype.html">ToolTip</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_OUTLINE</strong></a></td>
<td><a href="uiauto-supporttreecontroltype.html">Tree</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_OUTLINEITEM</strong></a></td>
<td><a href="uiauto-supporttreeitemcontroltype.html">TreeItem</a></td>
</tr>
<tr>
<td><a href="object-roles.html"><strong>ROLE_SYSTEM_WINDOW</strong></a></td>
<td><a href="uiauto-supportwindowcontroltype.html">Window</a></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>States and Properties</h2>
<p>Microsoft Active Accessibility elements support a common set of properties. Some properties, such as accState, must describe different conditions, depending on the element role. Servers must implement all methods of <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> that return a property, even those properties that are not relevant to the element.</p>
<p>UI Automation defines additional properties, some of which correspond to states in Microsoft Active Accessibility. Some properties are common to all elements, but other properties are specific to control types and control patterns. A UI Automation provider does not have to implement irrelevant properties, but can return a null value for any properties it does not support. The UI Automation core service can obtain some properties from the default window provider, and these are amalgamated with properties explicitly implemented by the provider.</p>
<p>As well as supporting many more properties, UI Automation enables better performance by allowing properties to be cached.</p>
<p>The following table shows the correspondence between some properties in the two models. For descriptions of the UI Automation property IDs, see <a href="uiauto-automation-element-propids.html">Automation Element Property Identifiers</a>.</p>
<table>
<thead>
<tr>
<th>Active Accessibility property accessor</th>
<th>UI Automation property ID</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acckeyboardshortcut"><strong>get_accKeyboardShortcut</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_AccessKeyPropertyId</strong></a> or <a href="uiauto-automation-element-propids.html"><strong>UIA_AcceleratorKeyPropertyId</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_AccessKeyPropertyId</strong></a> takes precedence if both are present.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname"><strong>get_accName</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_NamePropertyId</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accrole"><strong>get_accRole</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_ControlTypePropertyId</strong></a></td>
<td>See the previous table for mapping roles to control types.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accvalue"><strong>get_accValue</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ValueValuePropertyId</strong></a> or <a href="uiauto-control-pattern-propids.html"><strong>UIA_RangeValueValuePropertyId</strong></a></td>
<td>Valid only for control types that support <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvaluepattern"><strong>IUIAutomationValuePattern</strong></a> or <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationrangevaluepattern"><strong>IUIAutomationRangeValuePattern</strong></a>. Range values are normalized to 0-100, to be consistent with Microsoft Active Accessibility behavior. Values are represented as strings.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acchelp"><strong>get_accHelp</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_HelpTextPropertyId</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation"><strong>accLocation</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_BoundingRectanglePropertyId</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accdescription"><strong>get_accDescription</strong></a></td>
<td>Not supported.</td>
<td>accDescription did not have a clear specification in Microsoft Active Accessibility, which resulted in servers placing different pieces of information in this property.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acchelptopic"><strong>get_accHelpTopic</strong></a></td>
<td>Not supported.</td>
<td></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The following table shows the UI Automation property IDs that correspond to Microsoft Active Accessibility <a href="object-state-constants.html">object state constants</a>.</p>
<table>
<thead>
<tr>
<th>Active Accessibility state</th>
<th>UI Automation property</th>
<th>Triggers WinEvent state change?</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_CHECKED</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ToggleToggleStatePropertyId</strong></a> for check box. <a href="uiauto-control-pattern-propids.html"><strong>UIA_SelectionItemIsSelectedPropertyId</strong></a> for radio button.</td>
<td>Y</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_COLLAPSED</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ExpandCollapseExpandCollapseStatePropertyId</strong></a> (value = <a href="/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-expandcollapsestate"><strong>ExpandCollapseState_Collapsed</strong></a>).</td>
<td>Y</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_EXPANDED</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ExpandCollapseExpandCollapseStatePropertyId</strong></a> (value = <a href="/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-expandcollapsestate"><strong>ExpandCollapseState_Expanded</strong></a> or <a href="/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-expandcollapsestate"><strong>ExpandCollapseState_PartiallyExpanded</strong></a>).</td>
<td>Y</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_FOCUSABLE</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsKeyboardFocusablePropertyId</strong></a>.</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_FOCUSED</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_HasKeyboardFocusPropertyId</strong></a>.</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_HASPOPUP</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ExpandCollapseExpandCollapseStatePropertyId</strong></a> for menu items.</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_INVISIBLE</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsOffscreenPropertyId</strong></a> (value = True and <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getclickablepoint"><strong>IUIAutomationElement::GetClickablePoint</strong></a> fails).</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_LINKED</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_ControlTypePropertyId</strong></a> (value = <a href="uiauto-controltype-ids.html"><strong>UIA_HyperlinkControlTypeId</strong></a>).</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_MIXED</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ToggleToggleStatePropertyId</strong></a> (value = <a href="/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-togglestate"><strong>ToggleState_Indeterminate</strong></a>.</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_MOVEABLE</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_TransformCanMovePropertyId</strong></a>.</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_MULTISELECTABLE</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_SelectionCanSelectMultiplePropertyId</strong></a>.</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_OFFSCREEN</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsOffscreenPropertyId</strong></a>.</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_PROTECTED</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsPasswordPropertyId</strong></a>.</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_READONLY</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_RangeValueIsReadOnlyPropertyId</strong></a> and <a href="uiauto-control-pattern-propids.html"><strong>UIA_ValueIsReadOnlyPropertyId</strong></a>.</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_SELECTABLE</strong></a></td>
<td><a href="uiauto-control-pattern-availability-propids.html"><strong>UIA_IsSelectionItemPatternAvailablePropertyId</strong></a> .</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_SELECTED</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_SelectionItemIsSelectedPropertyId</strong></a>.</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_SIZEABLE</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_TransformCanResizePropertyId</strong></a>.</td>
<td>N</td>
</tr>
<tr>
<td><a href="object-state-constants.html"><strong>STATE_SYSTEM_UNAVAILABLE</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsEnabledPropertyId</strong></a>.</td>
<td>Y</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>For a complete list of property IDs, see <a href="uiauto-entry-propids.html">Property Identifiers</a>.</p>
<h2>Events</h2>
<p>Unlike Microsoft Active Accessibility, the event mechanism in UI Automation, does not rely on Windows event routing, which is closely tied to window handles, and does not require the client application to set up hooks. Subscriptions to events can be fine-tuned to particular parts of the tree, not just to particular events. Providers can also fine-tune raising events by keeping track of which events are being listened for.</p>
<p>It is also easier for clients to retrieve the elements that raise events because these are passed directly to the event callback. Properties of the element are prefetched automatically, if a cache request was supplied when the client subscribed to the event.</p>
<p>The following table shows the correspondence of Microsoft Active Accessibility <a href="event-constants.html">event constants</a> and UI Automation event IDs.</p>
<table>
<thead>
<tr>
<th>WinEvent</th>
<th>UI Automation Event ID</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_ACCELERATORCHANGE</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_AcceleratorKeyPropertyId</strong></a> property change.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_CONTENTSCROLLED</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollVerticalScrollPercentPropertyId</strong></a> or <a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollHorizontalScrollPercentPropertyId</strong></a> property change on the associated scroll bars.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_CREATE</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_StructureChangedEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_DEFACTIONCHANGE</strong></a></td>
<td>No equivalent.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_DESCRIPTIONCHANGE</strong></a></td>
<td>No exact equivalent; perhaps <a href="uiauto-automation-element-propids.html"><strong>UIA_HelpTextPropertyId</strong></a> or <a href="uiauto-automation-element-propids.html"><strong>UIA_LocalizedControlTypePropertyId</strong></a> property change.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_DESTROY</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_StructureChangedEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_FOCUS</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_AutomationFocusChangedEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_HELPCHANGE</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_HelpTextPropertyId</strong></a> change.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_HIDE</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_StructureChangedEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_LOCATIONCHANGE</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_BoundingRectanglePropertyId</strong></a> property change.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_NAMECHANGE</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_NamePropertyId</strong></a> property change.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_PARENTCHANGE</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_StructureChangedEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_REORDER</strong></a></td>
<td>Not consistently used in Microsoft Active Accessibility. No directly corresponding event is defined in UI Automation.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_SELECTION</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_SelectionItem_ElementSelectedEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_SELECTIONADD</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_SelectionItem_ElementAddedToSelectionEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_SELECTIONREMOVE</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_SelectionItem_ElementRemovedFromSelectionEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_SELECTIONWITHIN</strong></a></td>
<td>No equivalent.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_SHOW</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_StructureChangedEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_STATECHANGE</strong></a></td>
<td>Various property-changed events.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_OBJECT_VALUECHANGE</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_RangeValueValuePropertyId</strong></a> and <a href="uiauto-control-pattern-propids.html"><strong>UIA_ValueValuePropertyId</strong></a> changed.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_ALERT</strong></a></td>
<td>No equivalent.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_CAPTUREEND</strong></a></td>
<td>No equivalent.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_CAPTURESTART</strong></a></td>
<td>No equivalent.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_CONTEXTHELPEND</strong></a></td>
<td>No equivalent.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_CONTEXTHELPSTART</strong></a></td>
<td>No equivalent.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_DIALOGEND</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_Window_WindowClosedEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_DIALOGSTART</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_Window_WindowOpenedEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_DRAGDROPEND</strong></a></td>
<td>No equivalent.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_DRAGDROPSTART</strong></a></td>
<td>No equivalent.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_FOREGROUND</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_AutomationFocusChangedEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_MENUEND</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_MenuModeEndEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_MENUPOPUPEND</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_MenuClosedEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_MENUPOPUPSTART</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_MenuOpenedEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_MENUSTART</strong></a></td>
<td><a href="uiauto-event-ids.html"><strong>UIA_MenuModeStartEventId</strong></a>.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_MINIMIZEEND</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_WindowWindowVisualStatePropertyId</strong></a> property change.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_MINIMIZESTART</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_WindowWindowVisualStatePropertyId</strong></a> property change.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_MOVESIZEEND</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_BoundingRectanglePropertyId</strong></a> property change.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_MOVESIZESTART</strong></a></td>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_BoundingRectanglePropertyId</strong></a> property change.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_SCROLLINGEND</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollVerticalScrollPercentPropertyId</strong></a> or <a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollHorizontalScrollPercentPropertyId</strong></a> property change.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_SCROLLINGSTART</strong></a></td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollVerticalScrollPercentPropertyId</strong></a> or <a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollHorizontalScrollPercentPropertyId</strong></a> property change.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_SOUND</strong></a></td>
<td>No equivalent.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_SWITCHEND</strong></a></td>
<td>No equivalent, but a <a href="uiauto-event-ids.html"><strong>UIA_AutomationFocusChangedEventId</strong></a> event signals that a new application has received the focus.</td>
</tr>
<tr>
<td><a href="event-constants.html"><strong>EVENT_SYSTEM_SWITCHSTART</strong></a></td>
<td>No equivalent.</td>
</tr>
<tr>
<td>No equivalent.</td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_MultipleViewCurrentViewPropertyId</strong></a> property change.</td>
</tr>
<tr>
<td>No equivalent.</td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollHorizontallyScrollablePropertyId</strong></a> property change.</td>
</tr>
<tr>
<td>No equivalent.</td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollVerticallyScrollablePropertyId</strong></a> property change.</td>
</tr>
<tr>
<td>No equivalent.</td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollHorizontalScrollPercentPropertyId</strong></a> property change.</td>
</tr>
<tr>
<td>No equivalent.</td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollVerticalScrollPercentPropertyId</strong></a> property change.</td>
</tr>
<tr>
<td>No equivalent.</td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollHorizontalViewSizePropertyId</strong></a> property change.</td>
</tr>
<tr>
<td>No equivalent.</td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollVerticalViewSizePropertyId</strong></a> property change.</td>
</tr>
<tr>
<td>No equivalent.</td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ToggleToggleStatePropertyId</strong></a> property change.</td>
</tr>
<tr>
<td>No equivalent.</td>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_WindowWindowVisualStatePropertyId</strong></a> property change</td>
</tr>
<tr>
<td>No equivalent.</td>
<td><a href="uiauto-event-ids.html"><strong>UIA_AsyncContentLoadedEventId</strong></a> event.</td>
</tr>
<tr>
<td>No equivalent.</td>
<td><a href="uiauto-event-ids.html"><strong>UIA_ToolTipOpenedEventId</strong></a> event.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Accessing Active Accessibility Properties and Objects from UI Automation</h2>
<p>A key feature of UI Automation that is not available in Microsoft Active Accessibility is the ability to fetch multiple properties with a single cross-process operation.</p>
<p>Existing Microsoft Active Accessibility clients can take advantage of this ability by using the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern"><strong>IUIAutomationLegacyIAccessiblePattern</strong></a> interface. This interface represents a <em>control pattern</em> that exposes Microsoft Active Accessibility properties and methods on UI elements. When retrieving elements, an application can request that this control pattern and its properties be cached.</p>
<p><a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern"><strong>IUIAutomationLegacyIAccessiblePattern</strong></a> also enables clients to obtain Microsoft Active Accessibility properties from elements that have no native support for <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a>.</p>
<p>Changes in the properties of an <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern"><strong>IUIAutomationLegacyIAccessiblePattern</strong></a> do not raise UI Automation events.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="uiauto-usingiaccessibleex.html">Adding UI Automation Functionality to Active Accessibility Servers</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-treeoverview.html">UI Automation Tree Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-propertiesoverview.html">UI Automation Properties Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-controltypesoverview.html">UI Automation Control Types Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-eventsoverview.html">UI Automation Events Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="microsoft-active-accessibility.html">Microsoft Active Accessibility</a></p>
<!-- raw HTML omitted -->
</body>
