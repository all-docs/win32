<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Registering a Hook Function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Registering a Hook Function
description: Client applications receive WinEvents in a WinEventProc callback function. The actions performed by the callback function are defined by the application, but the syntax must be as specified in the prototype.
ms.assetid: 7e999335-6a41-4d22-82ef-1a8dd6cb656e
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Registering a Hook Function</h1>
<p>Client applications receive WinEvents in a <a href="/windows/desktop/api/Winuser/nc-winuser-wineventproc"><em>WinEventProc</em></a> callback function. The actions performed by the callback function are defined by the application, but the syntax must be as specified in the prototype.</p>
<p>Before it can receive events, the function must be registered by calling <a href="/windows/desktop/api/Winuser/nf-winuser-setwineventhook"><strong>SetWinEventHook</strong></a>. The client can call <strong>SetWinEventHook</strong> more than once to register different hook functions, or to set additional events for a previously registered hook function.</p>
<p>When calling <a href="/windows/desktop/api/Winuser/nf-winuser-setwineventhook"><strong>SetWinEventHook</strong></a> the client specifies which events to receive and how to receive them. The client can choose to:</p>
<ul>
<li>Receive all events or a specific set of events.</li>
<li>Receive events from all threads or from a specific thread.</li>
<li>Receive events from all processes or from a specific process.</li>
<li>Handle events in process or out of process.</li>
</ul>
<p>When an event is generated that matches the specified criteria, the system calls the client's <a href="/windows/desktop/api/Winuser/nc-winuser-wineventproc"><em>WinEventProc</em></a> callback function (or &quot;hook procedure&quot;). The parameters that the hook function receives tell the client about the window, object, and possible child element that generated the event. A client uses these parameters in an object retrieval call, such as <a href="/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent"><strong>AccessibleObjectFromEvent</strong></a>.</p>
<p>Â </p>
<p>Â </p>
</body>
