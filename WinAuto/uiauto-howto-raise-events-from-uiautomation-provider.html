<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Raise Events from a UI Automation Provider</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Raise Events from a UI Automation Provider
description: This topic contains example code that shows how a Microsoft UI Automation provider raises an event.
ms.assetid: 43826258-9321-4d44-bd31-6a3b42f00d39
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Raise Events from a UI Automation Provider</h1>
<p>This topic contains example code that shows how a Microsoft UI Automation provider raises an event.</p>
<p>The following example code shows a method from an application that implements a custom button. The application calls the method whenever the custom button is invoked. The method checks whether any clients are listening for events and, if so, raises the <a href="uiauto-event-ids.html"><strong>UIA_Invoke_InvokedEventId</strong></a> event to notify the clients that the button was invoked.</p>
<pre lang="C++"><code>// Responds to a button click. The source of the click could 
// be the mouse, the keyboard, or a client's call to 
// IUIAutomationInvokePattern::Invoke.
void CustomButton::InvokeButton(HWND hwnd)
{
    // TODO: Perform program actions invoked by the control.

    // Check whether any clients are listening for UI Automation 
    // events.
    if (UiaClientsAreListening())
    {
        // Raise an Invoked event. GetUIAutomationProvider is an
        // application-defined method that returns a pointer to
        // the application's IRawElementProviderSimple interface.
        UiaRaiseAutomationEvent(
            GetUIAutomationProvider(hwnd), UIA_Invoke_InvokedEventId); 
    }
}
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-eventsoverview.html">UI Automation Events Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-howto-topics-for-uiautomation-providers.html">How-To Topics for UI Automation Providers</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
