<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Accessing Spreadsheet Content</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Accessing Spreadsheet Content
description: This topic describes how Microsoft UI Automation client applications can access the content of a spreadsheet.
ms.assetid: F32EFA46-222B-4A4E-9938-10DE0F6A2CA7
keywords:</p>
<ul>
<li>clients,accessing spreadsheet content</li>
<li>clients,text-based controls</li>
<li>clients,Spreadsheet control pattern</li>
<li>clients,SpreadsheetItem control pattern
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Accessing Spreadsheet Content</h1>
<p>A text-based control that contains spreadsheet content can enable clients to access the content by supporting the <a href="uiauto-implementingspreadsheet.html">Spreadsheet</a> and <a href="uiauto-implementingspreadsheetitem.html">SpreadsheetItem</a> control patterns. This topic describes how Microsoft UI Automation client applications can access the content of a spreadsheet.</p>
<p>To determine whether a text-based control supports the <a href="uiauto-implementingspreadsheet.html">Spreadsheet</a> and <a href="uiauto-implementingspreadsheetitem.html">SpreadsheetItem</a> control patterns, first retrieve the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement"><strong>IUIAutomationElement</strong></a> interface for the control (see <a href="uiauto-obtainingelements.html">Obtaining UI Automation Elements</a>.) Next, call the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern"><strong>IUIAutomationElement::GetCurrentPattern</strong></a> method, specifying a control pattern identifier of <a href="uiauto-controlpattern-ids.html"><strong>UIA_SpreadsheetPatternId</strong></a> or <a href="uiauto-controlpattern-ids.html"><strong>UIA_SpreadsheetItemPatternId</strong></a>, and a variant that receives TRUE if the control supports the particular control pattern.</p>
<p>To access the spreadsheet content, retrieve the <a href="/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationspreadsheetpattern"><strong>IUIAutomationSpreadsheetPattern</strong></a> interface by calling <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern"><strong>IUIAutomationElement::GetCurrentPattern</strong></a> method and specifying <a href="uiauto-controlpattern-ids.html"><strong>UIA_SpreadsheetPatternId</strong></a> as the control pattern identifier. Next, use the <a href="/windows/desktop/api/uiautomationclient/nf-uiautomationclient-iuiautomationspreadsheetpattern-getitembyname"><strong>IUIAutomationSpreadsheetPattern::GetItemByName</strong></a> method to get the <a href="/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationspreadsheetitempattern"><strong>IUIAutomationSpreadsheetItem</strong></a> interface for a particular spreadsheet item (typically a cell). Use the properties and methods of the <strong>IUIAutomationSpreadsheetItem</strong> interface to retrieve the formula for the cell, and any annotations associated with the cell. For more information about annotations, see <a href="uiauto-usingtextrangeobjects.html">Retrieving Annotations.</a></p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="uiauto-ui-automation-textpattern-overview.html">UI Automation Support for Textual Content</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-workingwithtextbasedcontrols.html">Working with Text-based Controls</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
