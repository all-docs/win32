<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Tree Control Type</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Tree Control Type
description: This topic provides information about Microsoft UI Automation support for the Tree control type.
ms.assetid: 0fa8f308-7815-4561-a1ce-c5f5582861da
keywords:</p>
<ul>
<li>UI Automation,support for Tree control type</li>
<li>UI Automation,Tree control type</li>
<li>UI Automation,tree structure for Tree control type</li>
<li>UI Automation,properties for Tree control type</li>
<li>UI Automation,control patterns for Tree control type</li>
<li>UI Automation,events for Tree control type</li>
<li>tree structures,Tree control type</li>
<li>properties,Tree control type</li>
<li>control patterns,Tree control type</li>
<li>events,Tree control type</li>
<li>support for Tree control type</li>
<li>Tree control type</li>
<li>control types,tree structure for Tree control type</li>
<li>control types,control patterns for Tree control type</li>
<li>control types,support for Tree</li>
<li>control types,Tree
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Tree Control Type</h1>
<p>This topic provides information about Microsoft UI Automation support for the <strong>Tree</strong> control type.</p>
<p>The <strong>Tree</strong> control type is used for containers whose contents have relevance as a hierarchy of nodes, as with the way files and folders are displayed in the left pane of Windows Explorer. Each node has the potential to contain other nodes, called child nodes. Parent nodes, or nodes that contain child nodes, can be displayed as expanded or collapsed. The Windows tree-view control (as identified by <a href="/windows/desktop/Controls/common-control-window-classes"><strong>WC_TREEVIEW</strong></a>) is an example of a control that belongs to the <strong>Tree</strong> control type.</p>
<p>The following sections define the required UI Automation tree structure, properties, control patterns, and events for the <strong>Tree</strong> control type. The UI Automation requirements apply to all tree item controls where the UI framework/platform integrates UI Automation support for control types and control patterns.</p>
<p>This topic contains the following sections.</p>
<ul>
<li><a href="#typical-tree-structure">Typical Tree Structure</a></li>
<li><a href="#relevant-properties">Relevant Properties</a></li>
<li><a href="#required-control-patterns">Required Control Patterns</a></li>
<li><a href="#required-events">Required Events</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Typical Tree Structure</h2>
<p>The following table depicts a typical control and content view of the UI Automation tree that pertains to tree controls, and describes what can be contained in each view. For more information about the UI Automation tree, see <a href="uiauto-treeoverview.html">UI Automation Tree Overview</a>.</p>
<table>
<thead>
<tr>
<th>Control View</th>
<th>Content View</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Tree<!-- raw HTML omitted --><!-- raw HTML omitted -->DataItem (0 or more)<!-- raw HTML omitted --><!-- raw HTML omitted -->TreeItem (0 or more)<!-- raw HTML omitted --><!-- raw HTML omitted -->TreeItem (0 or more)<!-- raw HTML omitted --><!-- raw HTML omitted -->...<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ScrollBar (0, 1, 2)<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->Tree<!-- raw HTML omitted --><!-- raw HTML omitted -->DataItem (0 or more)<!-- raw HTML omitted --><!-- raw HTML omitted -->TreeItem (0 or more)<!-- raw HTML omitted --><!-- raw HTML omitted -->TreeItem (0 or more)<!-- raw HTML omitted --><!-- raw HTML omitted -->...<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The control view of the UI Automation tree consists of:</p>
<ul>
<li>Zero of many items within the container (items can be based on the <a href="uiauto-supporttreeitemcontroltype.html">TreeItem</a> or <a href="uiauto-supportdataitemcontroltype.html">DataItem</a> control types).</li>
<li>Zero, one, or two scroll bar controls</li>
</ul>
<p>The content view of the UI Automation tree consists of zero or many items within the container (items can be based on the <a href="uiauto-supporttreeitemcontroltype.html">TreeItem</a> or <a href="uiauto-supportdataitemcontroltype.html">DataItem</a> control types).</p>
<h2>Relevant Properties</h2>
<p>The following table lists the UI Automation properties whose value or definition is especially relevant to the <strong>Tree</strong> control type. For more information about UI Automation properties, see <a href="uiauto-propertiesforclients.html">Retrieving Properties from UI Automation Elements</a>.</p>
<table>
<thead>
<tr>
<th>UI Automation Property</th>
<th>Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_AutomationIdPropertyId</strong></a></td>
<td>See notes.</td>
<td>The value of this property must be unique among all peer elements in the raw view of the UI Automation tree.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_BoundingRectanglePropertyId</strong></a></td>
<td>See notes.</td>
<td>The outermost rectangle that contains the whole control.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_ClickablePointPropertyId</strong></a></td>
<td>See notes.</td>
<td>Tree controls have a clickable point that causes the tree or one of the items in the tree container to receive the focus. A tree control can have a clickable point only if it is possible to click a location in the tree without causing an item to be selected or to receive the focus.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_ControlTypePropertyId</strong></a></td>
<td><strong>Tree</strong></td>
<td>This value is the same for all UI frameworks.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsContentElementPropertyId</strong></a></td>
<td>TRUE</td>
<td>The tree control is always included in the content view of the UI Automation tree.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsControlElementPropertyId</strong></a></td>
<td>TRUE</td>
<td>The tree control is always included in the control view of the UI Automation tree.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsKeyboardFocusablePropertyId</strong></a></td>
<td>See notes.</td>
<td>If the control can receive keyboard focus, it must support this property.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_LabeledByPropertyId</strong></a></td>
<td>See notes.</td>
<td>If the tree control has a label associated with it, this property returns a <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement"><strong>IUIAutomationElement</strong></a> pointer for that label. Otherwise, the property returns a null reference.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_LocalizedControlTypePropertyId</strong></a></td>
<td>See notes.</td>
<td>Localized string corresponding to the <strong>Tree</strong> control type. The default value is &quot;tree&quot; for en-US or English (United States).</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_NamePropertyId</strong></a></td>
<td>See notes.</td>
<td>The value of a tree control's name property usually comes from text that labels the control. If there is no text label, you must provide a value for this property.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Required Control Patterns</h2>
<p>The following table lists the UI Automation control patterns required to be supported by all tree controls. For more information on control patterns, see <a href="uiauto-controlpatternsoverview.html">UI Automation Control Patterns Overview</a>.</p>
<table>
<thead>
<tr>
<th>Control Pattern/Pattern Property</th>
<th>Support/Value</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iscrollprovider"><strong>IScrollProvider</strong></a></td>
<td>Depends</td>
<td>Implement the <a href="uiauto-implementingscroll.html">Scroll</a> control pattern if items in the tree container can be scrolled.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iselectionprovider"><strong>ISelectionProvider</strong></a></td>
<td>Depends</td>
<td>Tree controls that contain a set of selectable items must implement the <a href="uiauto-implementingselection.html">Selection</a> control pattern. It need not be implemented if selecting an item conveys no meaningful information to the user.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iselectionprovider-get_canselectmultiple"><strong>CanSelectMultiple</strong></a></td>
<td>See notes.</td>
<td>Implement this property if the tree control supports multiple selection (most tree controls do not support multiple selection).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iselectionprovider-get_isselectionrequired"><strong>IsSelectionRequired</strong></a></td>
<td>See notes.</td>
<td>The value of this property is exposed if the control requires that an item be selected.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Required Events</h2>
<p>The following table lists the UI Automation events that all tree controls must support. For more information on events, see <a href="uiauto-eventsoverview.html">UI Automation Events Overview</a>.</p>
<table>
<thead>
<tr>
<th>UI Automation Event</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="uiauto-event-ids.html"><strong>UIA_AutomationFocusChangedEventId</strong></a></td>
<td></td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_BoundingRectanglePropertyId</strong></a> property-changed event.</td>
<td></td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsEnabledPropertyId</strong></a> property-changed event.</td>
<td>If the control supports the <a href="uiauto-automation-element-propids.html"><strong>IsEnabled</strong></a> property, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-automation-element-propids.html"><strong>UIA_IsOffscreenPropertyId</strong></a> property-changed event.</td>
<td>If the control supports the <a href="uiauto-automation-element-propids.html"><strong>IsOffscreen</strong></a> property, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollHorizontallyScrollablePropertyId</strong></a> property-changed event.</td>
<td>If the control supports the <a href="uiauto-implementingscroll.html">Scroll</a> control pattern, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollHorizontalScrollPercentPropertyId</strong></a> property-changed event.</td>
<td>If the control supports the <a href="uiauto-implementingscroll.html">Scroll</a> control pattern, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollHorizontalViewSizePropertyId</strong></a> property-changed event.</td>
<td>If the control supports the <a href="uiauto-implementingscroll.html">Scroll</a> control pattern, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollVerticalScrollPercentPropertyId</strong></a> property-changed event.</td>
<td>If the control supports the <a href="uiauto-implementingscroll.html">Scroll</a> control pattern, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollVerticallyScrollablePropertyId</strong></a> property-changed event.</td>
<td>If the control supports the <a href="uiauto-implementingscroll.html">Scroll</a> control pattern, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-control-pattern-propids.html"><strong>UIA_ScrollVerticalViewSizePropertyId</strong></a> property-changed event.</td>
<td>If the control supports the <a href="uiauto-implementingscroll.html">Scroll</a> control pattern, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-event-ids.html"><strong>UIA_Selection_InvalidatedEventId</strong></a></td>
<td>If the control supports the <a href="uiauto-implementingselection.html">Selection</a> control pattern, it must support this event.</td>
</tr>
<tr>
<td><a href="uiauto-event-ids.html"><strong>UIA_StructureChangedEventId</strong></a></td>
<td></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-controltypesoverview.html">UI Automation Control Types Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-uiautomationoverview.html">UI Automation Overview</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
