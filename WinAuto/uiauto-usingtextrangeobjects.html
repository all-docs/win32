<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using IUIAutomationTextRange to Access and Manipulate a Text Range</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Using IUIAutomationTextRange to Access and Manipulate a Text Range
description: This topic describes how to use the properties and methods of the IUIAutomationTextRange interface to access and manipulate the textual content of a text-based control.
ms.assetid: 66BC7324-5322-4996-AF62-766936559F0E
keywords:</p>
<ul>
<li>clients,using text range objects</li>
<li>text-based controls</li>
<li>clients,text ranges</li>
<li>clients,TextRange control pattern
ms.topic: article
ms.date: 12/13/2022</li>
</ul>
<hr />
<h1>Using IUIAutomationTextRange to Access and Manipulate a Text Range</h1>
<p>This topic describes how to use the properties and methods of the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange"><strong>IUIAutomationTextRange</strong></a> interface to access and manipulate the textual content of a text-based control.</p>
<h2>What is a Text Range?</h2>
<p>The Microsoft UI Automation text object model is based on the concept of the <em>text range</em>. A text range is an object that exposes the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange"><strong>IUIAutomationTextRange</strong></a> interface, and represents a contiguous span of text in a text-based control. Each text range has both a starting endpoint and an ending endpoint, and all textual content between the two endpoints is considered part of the range. A text range whose starting endpoint and ending endpoint are at the same location is called a <em>degenerate</em> (or empty) text range. A degenerate text range is used to mark a specific location within the text of a control, such as the location of the text insertion point.</p>
<h2>Acquiring Text Range Objects</h2>
<p>Client applications acquire text range objects by using the properties and methods of the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern"><strong>IUIAutomationTextPattern</strong></a> interface. The <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-get_documentrange"><strong>IUIAutomationTextRangePattern::DocumentRange</strong></a> property retrieves a text range that represents the entire textual content of a text-based control, while other methods acquire text ranges that represent some portion of the content, such as the selected text, the visible text, or an object embedded in the text.</p>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-getvisibleranges"><strong>IUIAutomationTextRangePattern::GetVisibleRanges</strong></a> and <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-getselection"><strong>GetSelection</strong></a> methods can retrieve arrays of text range objects. If a control is partially obscured by an overlapping window or other object, <strong>GetVisibleRanges</strong> returns an array containing a text range object for each partially visible line of text. Similarly, if a text-based control supports the selection of multiple, disjoint spans of text, <strong>GetSelection</strong> returns an array that contains a text range object for each selected span.</p>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild"><strong>IUIAutomationTextRangePattern::RangeFromChild</strong></a> method enables a client application to retrieve a text range that encloses an object that is embedded in the textual content. The client specifies the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement"><strong>IUIAutomationElement</strong></a> interface pointer of an embedded object, such as an image, a table, or a hyperlink, and the method returns a text range that encloses the object. However, if the embedded object has no text associated with it, the method returns a degenerate text range.</p>
<p>A client application can use the <a href="/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint"><strong>IUIAutomationTextRangePattern::RangeFromPoint</strong></a> method to retrieve a text range for the visible text or embedded object that is nearest to the specified screen coordinates.</p>
<h2>Selecting Text in a Text Range</h2>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange"><strong>IUIAutomationTextRange</strong></a> interface includes a number of methods that enable a client application to control the selection of text in a text-based control.</p>
<p>Client applications can use the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-select"><strong>IUIAutomationTextRange::Select</strong></a> method to select the text that corresponds to a text range, and to remove the previous selection, if any, from the text control. Calling <strong>Select</strong> with a degenerate text range moves the insertion point to the location of the text range without selecting any text.</p>
<p>If a control supports the selection of multiple, disjoint spans of text, a client can use the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-addtoselection"><strong>IUIAutomationTextRange::AddToSelection</strong></a> and <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-removefromselection"><strong>RemoveFromSelection</strong></a> methods to add text ranges to, and remove them from, the collection of selected text ranges. If the control supports only one selected text range at a time, but the selection operation would result in the selection of multiple disjoint text ranges, the method returns either an <strong>E_INVALIDOPERATION</strong> error, or extends or truncates the current selection. A client application can discover whether a control supports the selection of single or multiple spans of text, or none at all, by checking the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-get_supportedtextselection"><strong>IUIAutomationTextPattern::SupportedTextSelection</strong></a> property.</p>
<p>If a text-based control supports text insertions, calling <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-addtoselection"><strong>IUIAutomationTextRange::AddToSelection</strong></a> or <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-removefromselection"><strong>RemoveFromSelection</strong></a> on a degenerate text range in the control moves the insertion point but does not select any text.</p>
<h2>Retrieving Text from a Text Range</h2>
<p>Client applications can use the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext"><strong>IUIAutomationTextRange::GetText</strong></a> method to retrieve the plain text of a text range. The plain text includes all control characters found in the source text, such as carriage returns and the Unicode left-to-right mark (LRM). The plain text does not include any markup tags such as HTML that may be present in the source text. Also, any escape codes in the source text are converted to the plain text equivalents. For example, &quot; &quot; is converted to a simple space character.</p>
<p>If an embedded object spans a range of text, the plain text includes the inner text of the object, but not the alternative text (the name property of the embedded object). For more information, see <a href="uiauto-textpattern-and-embedded-objects-overview.html">How UI Automation Exposes Embedded Objects</a>.</p>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-findtext"><strong>IUIAutomationTextRange::FindText</strong></a> method searches a text range for a particular string and, if it is found, returns a new text range that encompasses the string.</p>
<h2>Retrieving Text Attributes from a Text Range</h2>
<p>Text attributes determine the formatting style of the text in a text-based control, and include such things as foreground color, bullet style, font size, and so on. UI Automation supports a number of text attributes, and defines an identifier for each supported attribute. A client application can query a text range for the value of a particular text attribute by specifying an attribute identifier in a call to the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue"><strong>IUIAutomationTextRange::GetAttributeValue</strong></a> method, along with a pointer to a <a href="/windows/win32/api/oaidl/ns-oaidl-variant"><strong>VARIANT</strong></a> structure that receives the attribute value. For detailed information about each text attribute that UI Automation supports, see <a href="uiauto-textattribute-ids.html">Text Attribute Identifiers</a>.</p>
<p>The value retrieved by <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue"><strong>GetAttributeValue</strong></a> represents the value of the attribute across the entire text range. If all text in the range shares the same value for the specified attribute, that value is returned by <strong>GetAttributeValue</strong>. However, if the value of the attribute varies across the text range, <strong>GetAttributeValue</strong> returns an <a href="/windows/desktop/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> pointer to a static token object called the <strong>ReservedMixedAttribute</strong> object. To discover whether the value of an attribute varies across a text range, a client application should compare the results of <strong>GetAttributeValue</strong> with the <strong>ReservedMixedAttribute</strong> object retrieved from the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_reservedmixedattributevalue"><strong>IUIAutomation::ReservedMixedAttributeValue</strong></a> property.</p>
<p>A text-based control is not required to support all UI Automation text attributes. If a client calls the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue"><strong>IUIAutomationTextRange::GetAttributeValue</strong></a> method and passes the identifier of an unsupported attribute, the method returns an <a href="/windows/desktop/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> pointer to a static token object called the <strong>ReservedNotSupported</strong> object. To discover whether a particular attribute is supported, a client application should compare the results of <strong>GetAttributeValue</strong> with the <strong>ReservedNotSupported</strong> object retrieved from the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_reservednotsupportedvalue"><strong>IUIAutomation::ReservedNotSupportedValue</strong></a> property.</p>
<p>Client applications can use the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-findattribute"><strong>IUIAutomationTextRange::FindAttribute</strong></a> method to search a text range for text that has a particular text attribute. If found, the method returns a new text range that encompasses the matching text. Note that <strong>FindAttribute</strong> returns a text range for matching text even if the text is not visible.</p>
<h2>Retrieving Embedded Objects from a Text Range</h2>
<p>A text range can include embedded objects such as tables, images, hyperlinks, and so on. A client application can retrieve a collection of all embedded objects in a range by calling the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren"><strong>IUIAutomationTextRange::GetChildren</strong></a> method. Embedded objects that overlap with the range but are not entirely enclosed by it are also included in the collection. If the range contains no embedded objects, <strong>GetChildren</strong> retrieves an empty collection.</p>
<p>Although it depends on the provider of the text-based control, the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren"><strong>GetChildren</strong></a> method typically does not return any children of the embedded elements. For example, if a text range contains a table that has a number of child cells, the <strong>GetChildren</strong> method typically returns just the table element and not the cell elements.</p>
<p>For performance or architectural reasons, <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren"><strong>GetChildren</strong></a> may not be able to retrieve <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement"><strong>IUIAutomationElement</strong></a> objects for all embedded objects in a text range. Instead, the provider might return a collection that includes virtualized items. For more information, see <a href="uiauto-workingwithvirtualizeditems.html">Working with Virtualized Items</a>.</p>
<h2>Manipulating a Text Range</h2>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange"><strong>IUIAutomationTextRange</strong></a> interface provides several methods for manipulating and navigating text ranges in a text-based control. The <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move"><strong>IUIAutomationTextRange::Move</strong></a>, <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyunit"><strong>MoveEndpointByUnit</strong></a>, and <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit"><strong>ExpandToEnclosingUnit</strong></a> methods move a text range or one of its endpoints by the specified text unit, such as character, word, paragraph, and so on. For more information, see <a href="/windows/desktop/WinAuto/uiauto-uiautomationtextunits">UI Automation Text Units</a>.</p>
<p>Despite its name, the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit"><strong>ExpandToEnclosingUnit</strong></a> method does not necessarily expand a text range. Instead, it &quot;normalizes&quot; a text range by moving the endpoints so that the range encompasses the specified text unit exactly. The range is expanded if it is smaller than the specified unit, or shortened if it is longer than the specified unit. The following diagram shows how <strong>ExpandToEnclosingUnit</strong> normalizes a text range by moving the endpoints of the range.</p>
<p><img src="images/expandtoenclosingunit.jpg" alt="diagram showing endpoint positions before and after a call to expandtoenclosingunit" /></p>
<p>If the text range starts at the beginning of a text unit and ends at the beginning of, or before, the next text unit boundary, the ending endpoint is moved to the next text unit boundary (see 1 and 2 in the previous illustration).</p>
<p>If the text range starts at the beginning of a text unit and ends at, or after, the next unit boundary, the ending endpoint stays or is moved backward to the next unit boundary after the starting endpoint (see 3 and 4 in the previous illustration). If there is more than one text unit boundary between the starting and ending endpoints, the ending endpoint is moved backward to the next unit boundary after the starting endpoint, resulting in a text range that is one text unit in length.</p>
<p>If the text range starts in the middle of a text unit, the starting endpoint is moved backward to the beginning of the text unit, and the ending endpoint is moved forward or backward, as necessary, to the next unit boundary after the starting endpoint (see 5 through 8 in the previous illustration).</p>
<p>When the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move"><strong>IUIAutomationTextRange::Move</strong></a> method is called, the provider normalizes the text range by the specified text unit. Then, the provider moves the range backward or forward by the specified number of text units. When moving the range, the provider ignores the boundaries of any embedded objects in the text. (However, the unit boundary itself may be affected by the existence of an embedded object). The following diagram demonstrates how the <strong>Move</strong> method moves a text range, unit by unit, across embedded objects and text unit boundaries.</p>
<p><img src="images/move.jpg" alt="diagram showing how the move method moves range endpoints across object and text unit boundaries" /></p>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyunit"><strong>IUIAutomationTextRange::MoveEndpointByUnit</strong></a> method moves one of the endpoints forward or backward by specified text unit. The following illustration shows how an endpoint moves forward.</p>
<p><img src="images/moveendpointbyunit.gif" alt="diagram showing how moveendpointbyunit moves the endpoint of a range" /></p>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyrange"><strong>IUIAutomationTextRange::MoveEndpointByRange</strong></a> method enables a client application to set one endpoint of a text range to same location as the specified endpoint of a second text range.</p>
<h2>Scrolling a Text Range into View</h2>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-scrollintoview"><strong>IUIAutomationTextRange::ScrollIntoView</strong></a> method scrolls a text range so that the text is visible in the viewport of the text-based control. When calling <strong>ScrollIntoView</strong>, a client can specify whether the text should be aligned with the top or bottom of the viewport.</p>
<h2>Retrieving the Enclosing Element of a Text Range</h2>
<p>A client application can use the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement"><strong>IUIAutomationTextRange::GetEnclosingElement</strong></a> method to retrieve the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation"><strong>IUIAutomation</strong></a> interface pointer of the innermost element that encloses a text range. The enclosing element is typically the text provider that supplies the text range. However, if the text provider supports child elements such as tables or hyperlinks, the enclosing element could be a descendant of the text provider.</p>
<h2>Comparing and Cloning Text Ranges</h2>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange"><strong>IUIAutomationTextRange</strong></a> interface includes two methods for comparing text ranges. The <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-compareendpoints"><strong>IUIAutomationTextRange::Compare</strong></a> method compares the starting and ending endpoints of two text ranges and returns <strong>TRUE</strong> if both endpoints are the same. The <strong>IUIAutomationTextRange::CompareEndpoints</strong> method compares either the start or the ending endpoint of the two ranges. The return value is zero if the endpoints are the same, or a positive value or negative value that indicates the relative positions of the two endpoints.</p>
<p>Client applications can use the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-clone"><strong>IUIAutomationTextRange::Clone</strong></a> method to create an exact copy of text range. The new text range can be manipulated independently of the original text range.</p>
<h2>Retrieving Annotations</h2>
<p>A text range can include annotations if the text-based control supports them. There are many different kinds of annotations. The UIAutomationClient.h header file defines a set of named constant values that identify the types of annotations that UI Automation supports. For more information, see <a href="uiauto-annotation-type-identifiers.html"><strong>Annotation Type Identifiers</strong></a>.</p>
<p>Some kinds of annotations are represented by an automation element that supports the <a href="uiauto-implementingannotation.html">Annotation</a> control pattern (<a href="/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationannotationpattern"><strong>IUIAutomationAnnotationPattern</strong></a> interface). Other kinds of annotations are exposed through the <a href="uiauto-about-text-and-textrange-patterns.html">TextRange</a> control pattern. For example, a provider could expose a simple spelling-error indicator by having the <a href="/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue"><strong>IUIAutomationTextRange::GetAttributeValue</strong></a> method return an <a href="uiauto-textattribute-ids.html"><strong>AnnotationTypes</strong></a> text attribute of <a href="uiauto-annotation-type-identifiers.html"><strong>AnnotationType_SpellingError</strong></a>, and a null value for the <a href="uiauto-textattribute-ids.html"><strong>AnnotationObjects</strong></a> text attribute.</p>
<h3>Retrieving Annotations Types from a Text Range</h3>
<p>You can retrieve a list of the types of annotations that are present in a text range by using the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue"><strong>IUIAutomationTextRange::GetAttributeValue</strong></a> method. When calling the method, specify a text attribute ID of <a href="uiauto-textattribute-ids.html"><strong>UIA_AnnotationTypesAttributeId</strong></a> and a pointer to a parameter of type <a href="/windows/win32/api/oaidl/ns-oaidl-variant"><strong>VARIANT</strong></a>. When the method returns, the <strong>VARIANT</strong> parameter contains a list of annotation type identifiers, one for each type of annotation in the text range. For more information, see <a href="uiauto-annotation-type-identifiers.html"><strong>Annotation Type Identifiers</strong></a>.</p>
<h3>Retrieving All Annotations from a Text Range</h3>
<p>To retrieve the annotations from a text range, call the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue"><strong>IUIAutomationTextRange::GetAttributeValue</strong></a> method, specifying a text attribute ID of <a href="uiauto-textattribute-ids.html"><strong>UIA_AnnotationObjectsAttributeId</strong></a> and a pointer to a parameter of type <a href="/windows/win32/api/oaidl/ns-oaidl-variant"><strong>VARIANT</strong></a>. When the method returns, the <strong>VARIANT</strong> parameter contains an <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelementarray"><strong>IUIAutomationElementArray</strong></a> interface that represents an array of automation elements, one for each annotation in the text range. The <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelementarray-get_length"><strong>IUIAutomationElementArray::Length</strong></a> property indicates the number of elements in the array, and the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelementarray-getelement"><strong>IUIAutomationElementArray::GetElement</strong></a> method retrieves the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement"><strong>IUIAutomationElement</strong></a> interface for a particular element.</p>
<h3>Retrieving Information About a Particular Annotation</h3>
<p>To retrieve information about a particular annotation, first retrieve the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement"><strong>IUIAutomationElement</strong></a> interface for the annotation element as described in the previous section. Next, retrieve the <a href="/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationannotationpattern"><strong>IUIAutomationAnnotationPattern</strong></a> interface for the annotation by calling the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpatternas"><strong>IUIAutomationElement::GetCurrentPatternAs</strong></a> method with a control pattern ID of <a href="uiauto-controlpattern-ids.html"><strong>UIA_AnnotationPatternId</strong></a>, an interface identifier of IID_IUIAutomationAnnotationPattern, and the address of a variable that receives the <strong>IUIAutomationAnnotation</strong> pointer for the annotation. Query the properties of the <strong>IUIAutomationAnnotation</strong> interface to retrieve the annotation type name and type ID, the name of the annotation author, the date and time of the annotation, and the <strong>IUIAutomationElement</strong> interface for the element that is being annotated.</p>
<h3>Retrieving the Annotation Target Text</h3>
<p>Typically, an annotation applies to some subset of the text in a text range. After you retrieve the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement"><strong>IUIAutomationElement</strong></a> interface for an annotation, you can pass the interface to the <a href="/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider2-rangefromannotation"><strong>IUIAutomationTextRange2::RangeFromAnnotation</strong></a> method to retrieve a text range that contains the text that is the target of the annotation.</p>
<h2>Retrieving Visual Styles</h2>
<p>A provider implements the <a href="/windows/desktop/WinAuto/uiauto-implementingstyles">Styles</a> control pattern to describe a UI element that has a specific style, fill color, fill pattern, or shape. This is especially useful when describing elements in a document, which frequently have such styles. Styles like this often carry information that is useful for customers with disabilities; for example, styles can describe a certain string as the title of a document, or a certain flowchart object as a diamond or a circle.</p>
<p>You can use the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue"><strong>IUIAutomationTextRange::GetAttributeValue</strong></a> method to retrieve the names and identifiers of the visual styles that are used in a text range. Use the <a href="uiauto-textattribute-ids.html"><strong>UIA_StyleNameAttributeId</strong></a> text attribute to retrieve the style names, and <a href="uiauto-textattribute-ids.html"><strong>UIA_StyleIdAttributeId</strong></a> to retrieve the style identifiers.</p>
<p>A text-based control that supports visual styles can implement the <a href="/windows/desktop/WinAuto/uiauto-implementingstyles">Styles</a> control pattern to enable clients to access information about a visual style used by the control. Clients access the Styles control pattern through the <a href="/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationstylespattern"><strong>IUIAutomationStylesPattern</strong></a> interface. You can retrieve this interface by calling the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern"><strong>IUIAutomationElement::GetCurrentPattern</strong></a> or <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpatternas"><strong>GetCurrentPatternAs</strong></a> method, specifying <a href="uiauto-controlpattern-ids.html"><strong>UIA_StylesPatternId</strong></a> as the control pattern identifier.</p>
<p>The <a href="/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationstylespattern"><strong>IUIAutomationStylesPattern</strong></a> interface includes properties and methods that provide the following information about a visual style:</p>
<ul>
<li>The name of the visual style, such as &quot;Normal&quot; or &quot;Heading 1&quot;.</li>
<li>The identifier of the visual style. For more information, see <a href="uiauto-style-identifiers.html"><strong>Style Identifiers</strong></a>.</li>
<li>The color used to fill the text-based control.</li>
<li>The color of the pattern used to fill the text-based control.</li>
<li>The shape of the text-based control.</li>
<li>The extended properties; that is, a list of control-specific style names and values.</li>
</ul>
<h2>Invoking Context Menus From Text Ranges</h2>
<p>Starting with WindowsÂ 8.1, text ranges may support the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange2"><strong>IUIAutomationTextRange2</strong></a> interface. This interface supports the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange2-showcontextmenu"><strong>ShowContextMenu</strong></a> method. You can call this method to invoke any context menu that is associated with a text range. The scenario for this is autocorrection of text ranges or IME candidate selection. In these cases a context menu appears that supports user interaction.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="uiauto-implementingtextandtextrange.html">Text and TextRange Control Patterns</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-ui-automation-textpattern-overview.html">UI Automation Support for Textual Content</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-workingwithtextbasedcontrols.html">Working with Text-based Controls</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
