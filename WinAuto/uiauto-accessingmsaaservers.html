<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Accessing Microsoft Active Accessibility Servers</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Accessing Microsoft Active Accessibility Servers
description: The Microsoft Active Accessibility to UI Automation Proxy is a software component that enables Microsoft UI Automation clients to interact with Microsoft Active Accessibility servers that implement the IAccessible interface natively.
ms.assetid: 44690b16-4a9d-4e8b-865a-b428ad616b1e
keywords:</p>
<ul>
<li>UI Automation,accessing Active Accessibility</li>
<li>UI Automation,Active Accessibility</li>
<li>UI Automation Proxy</li>
<li>UI Automation,UI Automation Proxy</li>
<li>LegacyIAccessible control pattern</li>
<li>UI Automation,LegacyIAccessible control pattern</li>
<li>Microsoft Active Accessibility</li>
<li>Active Accessibility</li>
<li>clients,accessing Active Accessibility servers
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Accessing Microsoft Active Accessibility Servers</h1>
<p>The Microsoft Active Accessibility to UI Automation Proxy is a software component that enables Microsoft UI Automation clients to interact with Microsoft Active Accessibility servers that implement the <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> interface natively. The proxy supports the <a href="uiauto-implementinglegacyiaccessible.html">LegacyIAccessible</a> control pattern, and supplies an instance of the <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern"><strong>IUIAutomationLegacyIAccessiblePattern</strong></a> interface for each Microsoft Active Accessibility server detected. UI Automation clients use the methods exposed by <strong>IUIAutomationLegacyIAccessiblePattern</strong> to access the Microsoft Active Accessibility properties and objects supported by the server.</p>
<p>If a UI Automation element has an underlying Microsoft Active Accessibility implementation, a client can obtain an <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern"><strong>IUIAutomationLegacyIAccessiblePattern</strong></a> interface pointer for the element by passing the <a href="uiauto-controlpattern-ids.html"><strong>UIA_LegacyIAccessiblePatternId</strong></a> control pattern ID to one of the following <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement"><strong>IUIAutomationElement</strong></a> methods:</p>
<ul>
<li><a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpattern"><strong>GetCachedPattern</strong></a></li>
<li><a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpatternas"><strong>GetCachedPatternAs</strong></a></li>
<li><a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern"><strong>GetCurrentPattern</strong></a></li>
<li><a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpatternas"><strong>GetCurrentPatternAs</strong></a></li>
</ul>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern"><strong>IUIAutomationLegacyIAccessiblePattern</strong></a> interface is not available for controls based on UI Automation.</p>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern"><strong>IUIAutomationLegacyIAccessiblePattern</strong></a> interface enables UI Automation clients to access the underlying <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> implementation of an Microsoft Active Accessibility element. However, the interface does not support methods that are obsolete or redundant with UI Automation features. For example, <strong>IUIAutomationLegacyIAccessiblePattern</strong> does not have a method that is equivalent to <a href="/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation"><strong>IAccessible::accLocation</strong></a> because the current location of a UI element is available from the UI Automation BoundingRectangle property.</p>
<p>The <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationlegacyiaccessiblepattern-getiaccessible"><strong>IUIAutomationLegacyIAccessiblePattern::GetIAccessible</strong></a> method enables a client to retrieve an <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> interface pointer from an UI Automation element. The reverse is also possible by using the <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromiaccessible"><strong>IUIAutomation::ElementFromIAccessible</strong></a> and <a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromiaccessiblebuildcache"><strong>IUIAutomation::ElementFromIAccessibleBuildCache</strong></a> methods.</p>
<p><a href="/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationlegacyiaccessiblepattern-getiaccessible"><strong>IUIAutomationLegacyIAccessiblePattern::GetIAccessible</strong></a> returns <strong>NULL</strong> if the <a href="/windows/desktop/api/oleacc/nn-oleacc-iaccessible"><strong>IAccessible</strong></a> interface for the element is provided by a proxy object from OLEACC.dll or from the UI Automation to Microsoft Active Accessibility Bridge.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-msaa.html">UI Automation and Active Accessibility</a></p>
<!-- raw HTML omitted -->
<p><a href="uiauto-controlpatternsoverview.html">UI Automation Control Patterns Overview</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
