<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Setting Properties on Sources</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Setting Properties on Sources
ms.assetid: fa1c7c40-915b-4577-aa33-6bd06707d93a
title: Setting Properties on Sources
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>Setting Properties on Sources</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>[This API is not supported and may be altered or unavailable in the future.]</p>
<p>When you create a new source object, there are a few properties you are required to set and others you can optionally set. You must set the following properties.</p>
<ul>
<li>The start and stop times, relative to the rest of the timeline. Call the <a href="iamtimelineobj-setstartstop.html"><strong>IAMTimelineObj::SetStartStop</strong></a> method. Do not set overlapping times on source objects within the same track, or it will cause undefined behavior.</li>
<li>The media file to use as a source clip. Call the <a href="iamtimelinesrc-setmedianame.html"><strong>IAMTimelineSrc::SetMediaName</strong></a>.</li>
<li>The media start and stop times, relative to the original source file. Call the <a href="iamtimelinesrc-setmediatimes.html"><strong>IAMTimelineSrc::SetMediaTimes</strong></a> method. Exception: If the source is a still image, do not specify the media times. For more information about media times, see <a href="time-in-directshow-editing-services.html">Time in DirectShow Editing Services</a>.</li>
</ul>
<p>A source object inherits its media type from the parent group, so it is not necessary to specify a media type.</p>
<p>Optional properties include the following:</p>
<ul>
<li>The stretch mode. The stretch mode specifies how MicrosoftÂ® DirectShowÂ® Editing Services (DES) renders a source whose size does not match the output dimensions. By default, DES stretches an image without preserving the aspect ratio. Alternatively, DES can crop an image or create a letterbox. Call the <a href="iamtimelinesrc-setstretchmode.html"><strong>IAMTimelineSrc::SetStretchMode</strong></a> method to specify the stretch mode.</li>
<li>The duration of the source file. If you set this property before setting the media times, DES validates the media stop time and truncates the stop time if it exceeds the file duration. This can help avoid rendering errors later. You can obtain the duration of the file using the media detector, as described in <a href="using-the-media-detector.html">Using the Media Detector</a>. Call the <a href="iamtimelinesrc-setmedialength.html"><strong>IAMTimelineSrc::SetMediaLength</strong></a> method to specify the file duration.</li>
<li>The stream number. By default, a source object uses the first stream in the file that matches the media type of the parent group. If a file contains two or more streams of the same media type, select which stream to use by calling <a href="iamtimelinesrc-setstreamnumber.html"><strong>IAMTimelineSrc::SetStreamNumber</strong></a>. You can use the media detector to find the number of streams.</li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="working-with-sources.html">Working with Sources</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
