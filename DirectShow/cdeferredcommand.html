<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CDeferredCommand class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Deferred commands are queued by calls to methods on the IQueueCommand interface and are exposed by the filter graph manager and by some filters.
ms.assetid: b2b177c6-af2b-4585-914f-001a6355a298
title: CDeferredCommand class
ms.topic: reference
ms.date: 4/26/2023
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>CDeferredCommand
api_type:</li>
<li>COM
api_location:
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>CDeferredCommand class</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p><img src="images/cutil13.png" alt="cdeferredcommand class hierarchy" /></p>
<p>Deferred commands are queued by calls to methods on the <a href="/windows/desktop/api/Control/nn-control-iqueuecommand"><strong>IQueueCommand</strong></a> interface and are exposed by the filter graph manager and by some filters. A successful call to one of these methods returns an <a href="/windows/desktop/api/Control/nn-control-ideferredcommand"><strong>IDeferredCommand</strong></a> interface representing the queued command.</p>
<p>A <code>CDeferredCommand</code> object represents a single deferred command and exposes the <a href="/windows/desktop/api/Control/nn-control-ideferredcommand"><strong>IDeferredCommand</strong></a> interface as well as other methods that permit time checks and actual execution. A <code>CDeferredCommand</code> object contains a reference to the <a href="ccmdqueue.html"><strong>CCmdQueue</strong></a> object on which it is queued.</p>
<p>Reference counts control the lifetime of the <code>CDeferredCommand</code> class. When calling the <a href="cdeferredcommand-invoke.html"><strong>CDeferredCommand::Invoke</strong></a> member function, the calling application gets an interface pointer that is reference-counted, and the <a href="ccmdqueue.html"><strong>CCmdQueue</strong></a> object also holds a reference count on the deferred command. Calling the <a href="/windows/desktop/api/Control/nf-control-ideferredcommand-cancel"><strong>IDeferredCommand::Cancel</strong></a> member function takes the deferred command off the command queue and thus reduces the reference count by one. Once taken off the queue, the command cannot be put back on the queue.</p>
<table>
<thead>
<tr>
<th>Protected Data Members</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>m_bStream</td>
<td>Flag for <a href="stream-time.html"><strong>stream time</strong></a> or presentation time. to be passed to the invoked method.</td>
</tr>
<tr>
<td>m_Dispatch</td>
<td>Accesses the <strong>ITypeInfo</strong> interface.</td>
</tr>
<tr>
<td>m_dispidMethod</td>
<td>Method on the interface to run.</td>
</tr>
<tr>
<td>m_DispParams</td>
<td><a href="cdispparams.html"><strong>CDispParams</strong></a> object containing the <strong>DISPPARAMS</strong> parameter list</td>
</tr>
<tr>
<td>m_hrResult</td>
<td>Stores the returned <strong>HRESULT</strong> value.</td>
</tr>
<tr>
<td>m_iid</td>
<td>Globally unique identifier (<strong>GUID</strong>) of the interface.</td>
</tr>
<tr>
<td>m_pQueue</td>
<td>Pointer to the <a href="ccmdqueue.html"><strong>CCmdQueue</strong></a> object that exposes the <a href="/windows/desktop/api/Control/nn-control-iqueuecommand"><strong>IQueueCommand</strong></a> interface.</td>
</tr>
<tr>
<td>m_pUnk</td>
<td><strong>IUnknown</strong> pointer to the interface on which the command will be run.</td>
</tr>
<tr>
<td>m_pvarResult</td>
<td>Resulting information, if any, from the invoked method.</td>
</tr>
<tr>
<td>m_time</td>
<td>Time at which the command will be run.</td>
</tr>
<tr>
<td>m_wFlags</td>
<td>Flags specifying the context of the invocation.</td>
</tr>
<tr>
<td>Member Functions</td>
<td>Description</td>
</tr>
<tr>
<td><a href="cdeferredcommand-cdeferredcommand.html"><strong>CDeferredCommand</strong></a></td>
<td>Constructs a <strong>CDeferredCommand</strong> object.</td>
</tr>
<tr>
<td><a href="cdeferredcommand-getflags.html"><strong>GetFlags</strong></a></td>
<td>Retrieves the context flags associated with the deferred command.</td>
</tr>
<tr>
<td><a href="cdeferredcommand-getiid.html"><strong>GetIID</strong></a></td>
<td>Retrieves the interface identifier (IID) of the interface on which the method will be run.</td>
</tr>
<tr>
<td><a href="cdeferredcommand-getmethod.html"><strong>GetMethod</strong></a></td>
<td>Retrieves the dispatch identifier of the method to be run.</td>
</tr>
<tr>
<td><a href="cdeferredcommand-getparams.html"><strong>GetParams</strong></a></td>
<td>Retrieves the <strong>DISPPARAMS</strong> argument list to the method.</td>
</tr>
<tr>
<td><a href="cdeferredcommand-getresult.html"><strong>GetResult</strong></a></td>
<td>Retrieves the resulting argument list, if one exists.</td>
</tr>
<tr>
<td><a href="cdeferredcommand-gettime.html"><strong>GetTime</strong></a></td>
<td>Retrieves the time when the method will be run.</td>
</tr>
<tr>
<td><a href="cdeferredcommand-invoke.html"><strong>Invoke</strong></a></td>
<td>Provides access to methods and properties exposed by an object.</td>
</tr>
<tr>
<td><a href="cdeferredcommand-isstreamtime.html"><strong>IsStreamTime</strong></a></td>
<td>Specifies whether the command is to be run at stream time or presentation time.</td>
</tr>
<tr>
<td>IDeferredCommand Methods</td>
<td>Description</td>
</tr>
<tr>
<td><a href="cdeferredcommand-cancel.html"><strong>Cancel</strong></a></td>
<td>Cancels a previously queued <a href="cdeferredcommand-invoke.html"><strong>CDeferredCommand::Invoke</strong></a> request.</td>
</tr>
<tr>
<td><a href="cdeferredcommand-confidence.html"><strong>Confidence</strong></a></td>
<td>Not currently implemented.</td>
</tr>
<tr>
<td><a href="cdeferredcommand-postpone.html"><strong>Postpone</strong></a></td>
<td>Specifies a new presentation time for a previously queued command.</td>
</tr>
<tr>
<td><a href="cdeferredcommand-gethresult.html"><strong>GetHResult</strong></a></td>
<td>Retrieves the <strong>HRESULT</strong> value of the invoked method.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
