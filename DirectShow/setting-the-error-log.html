<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Setting the Error Log</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Setting the Error Log
ms.assetid: 2e3124e3-32d0-4eb6-9c1d-91b625018ac4
title: Setting the Error Log
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>Setting the Error Log</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>[This API is not supported and may be altered or unavailable in the future.]</p>
<p>After you implement the error logging class, create a new instance of the class. Then, give <a href="directshow-editing-services.html">DirectShow Editing Services</a> a pointer to it by calling the <a href="iamseterrorlog-put-errorlog.html"><strong>IAMSetErrorLog::put_ErrorLog</strong></a> method on the timeline. Query the timeline for the <strong>IAMSetErrorLog</strong> interface. To ensure that all errors are logged, you should call this method before you load, save, or render the timeline.</p>
<pre lang="C++"><code>IAMSetErrorLog  *pSetLog = NULL;
IAMErrorLog     *pLog = new CErrReporter();

pTL-&gt;QueryInterface(IID_IAMSetErrorLog, (void **)&amp;pSetLog);
pSetLog-&gt;put_ErrorLog(pLog);
pSetLog-&gt;Release();
</code></pre>
<p>Error logging has no effect on the return values that you receive when you call methods in your application. Error logging complements but does not replace the usual error handling techniques. To create a robust application, always check HRESULT values.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="logging-errors.html">Logging Errors</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
