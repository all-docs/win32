<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CBasePin.QueryInternalConnections method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The QueryInternalConnections method retrieves the pins that are connected internally to this pin (within the filter). This method implements the IPin::QueryInternalConnections method.
ms.assetid: 08344fc5-38b2-4dbe-8ef9-30d2fcd64187
title: CBasePin.QueryInternalConnections method (Amfilter.h)
ms.topic: reference
ms.date: 4/26/2023
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>CBasePin.QueryInternalConnections
api_type:</li>
<li>COM
api_location:</li>
<li>Strmbase.lib</li>
<li>Strmbase.dll</li>
<li>Strmbasd.lib</li>
<li>Strmbasd.dll
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>CBasePin.QueryInternalConnections method</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The <code>QueryInternalConnections</code> method retrieves the pins that are connected internally to this pin (within the filter). This method implements the <a href="/windows/desktop/api/Strmif/nf-strmif-ipin-queryinternalconnections"><strong>IPin::QueryInternalConnections</strong></a> method.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT QueryInternalConnections(
   IPin  *apPin,
   ULONG *nPin
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>apPin</em></p>
<!-- raw HTML omitted -->
<p>Address of an array of <a href="/windows/desktop/api/Strmif/nn-strmif-ipin"><strong>IPin</strong></a> pointers.</p>
<!-- raw HTML omitted -->
<p><em>nPin</em></p>
<!-- raw HTML omitted -->
<p>On input, specifies the size of the array. When the method returns, the value is set to the number of pointers returned in the array.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns one of the <strong>HRESULT</strong> values shown in the following table.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_FALSE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Insufficient array size.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Success.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_FAIL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Failure.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_NOTIMPL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Not implemented.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>On some filters, input pins correspond to particular output pins. For each pin, this method fills an array with pointers to the corresponding pins. If every input pin provides data for every output pin, return E_NOTIMPL.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Amfilter.h (include Streams.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbase.lib (retail builds); <!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbasd.lib (debug builds)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cbasepin.html"><strong>CBasePin Class</strong></a></p>
<!-- raw HTML omitted -->
</body>
