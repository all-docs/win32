<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Windows Media in DirectShow</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Using Windows Media in DirectShow
ms.assetid: 2fae0504-d1da-413a-80dd-de7818f506ef
title: Using Windows Media in DirectShow
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>Using Windows Media in DirectShow</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>This section describes how to use DirectShow to play and write Advanced Systems Format (ASF) files. ASF files commonly contain audio and video content encoded using the Windows Media Audio and Video codecs. However, ASF can contain any type of data.</p>
<p>The following DirectShow filters support reading and writing ASF files:</p>
<ul>
<li><a href="wm-asf-reader-filter.html">WM ASF Reader Filter</a>. Reads ASF files.</li>
<li><a href="wm-asf-writer-filter.html">WM ASF Writer Filter</a>. Wrties ASF files.</li>
<li><a href="dmo-wrapper-filter.html">DMO Wrapper Filter</a>. Wraps the Windows Media encoder and decoder DMOs.</li>
</ul>
<h3>Versions</h3>
<p>The WM ASF Reader and WM ASF Writer filters are packaged in the DLL named qasf.dll, and the filters are collectively named &quot;QASF components.&quot; These filters are wrappers for the Windows Media Format SDK. The DLL (qasf.dll) was first published in the DirectX SDK but was later updated in the Windows Media Format SDK. Here is the version history of the QASF filters:</p>
<ul>
<li>DirectShow 8.1 supports Windows Media Format SDK version 7.0.</li>
<li>DirectShow 9.0 supports Windows Media Format SDK version 7.1.</li>
<li>Windows XP Service Pack 2 supports Windows Media Format 9 SDK.</li>
<li>Windows Vista supports Windows Media Format 11 SDK.</li>
<li>Windows Media Format 9 SDK and later contain corresponding versions of QASF.</li>
</ul>
<p>To get the latest version of QASF, always download the latest Windows Media Format SDK.</p>
<h3>Legacy Windows Media Source Filter</h3>
<p>In Windows XP Service Pack 1 and earlier, the default source filter for ASF files (.asf, .wmv, and .wma file extensions) is the obsolete <a href="windows-media-source-filter.html">Windows Media Source Filter</a>. This behavior was maintained to ensure backward compatibility with applications that used the Windows Media Player 6.4. New applications should use the newer versions of QASF, which make the WM ASF Reader filter the default filter for playing ASF files.</p>
<p>For more information on the Windows Media suite of software development kits, see the <a href="../audio-and-video.html">Audio and Video</a> section of the MDSN Library.</p>
<p>This article contains the following topics:</p>
<ul>
<li><a href="reading-asf-files-in-directshow.html">Reading ASF Files in DirectShow</a></li>
<li><a href="creating-asf-files-in-directshow.html">Creating ASF Files in DirectShow</a></li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="using-directshow.html">Using DirectShow</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
