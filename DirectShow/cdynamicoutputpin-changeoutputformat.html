<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CDynamicOutputPin.ChangeOutputFormat method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The ChangeOutputFormat method dynamically changes the media type for the connection, and delivers new segment information.
ms.assetid: d1204ca0-a489-48a0-8fe5-3ade04f51c93
title: CDynamicOutputPin.ChangeOutputFormat method (Amfilter.h)
ms.topic: reference
ms.date: 4/26/2023
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>CDynamicOutputPin.ChangeOutputFormat
api_type:</li>
<li>COM
api_location:</li>
<li>Strmbase.lib</li>
<li>Strmbase.dll</li>
<li>Strmbasd.lib</li>
<li>Strmbasd.dll
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>CDynamicOutputPin.ChangeOutputFormat method</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The <code>ChangeOutputFormat</code> method dynamically changes the media type for the connection, and delivers new segment information. The change can occur while the filter graph is running. Once this method is called, samples with the old media type cannot be delivered. The caller must ensure that no old samples are pending.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT ChangeOutputFormat(
   const AM_MEDIA_TYPE  *pmt,
         REFERENCE_TIME tSegmentStart,
         REFERENCE_TIME tSegmentStop,
         double         dSegmentRate
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>pmt</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <a href="/windows/win32/api/strmif/ns-strmif-am_media_type"><strong>AM_MEDIA_TYPE</strong></a> structure that specifies the media type.</p>
<!-- raw HTML omitted -->
<p><em>tSegmentStart</em></p>
<!-- raw HTML omitted -->
<p>Start time of the segment.</p>
<!-- raw HTML omitted -->
<p><em>tSegmentStop</em></p>
<!-- raw HTML omitted -->
<p>Stop time of the segment.</p>
<!-- raw HTML omitted -->
<p><em>dSegmentRate</em></p>
<!-- raw HTML omitted -->
<p>Segment rate.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns an <strong>HRESULT</strong> value. Possible values include those shown in the following table.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Success.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_FAIL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Failure. Possibly the owning filter did not call <a href="cdynamicoutputpin-setconfiginfo.html"><strong>CDynamicOutputPin::SetConfigInfo</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>VFW_E_NOT_CONNECTED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The pin is not connected.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>This method changes the format type while the filter is running. If the downstream pin accepts the new format, no reconnection is necessary. Otherwise, the method attempts to reconnect the pin. If the method successfully changes the format, it delivers the new segment information. This method calls the <a href="cdynamicoutputpin-changemediatype.html"><strong>CDynamicOutputPin::ChangeMediaType</strong></a> method to perform the format change.</p>
<p>You must call the <a href="cdynamicoutputpin-startusingoutputpin.html"><strong>CDynamicOutputPin::StartUsingOutputPin</strong></a> method before calling this method.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Amfilter.h (include Streams.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbase.lib (retail builds); <!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbasd.lib (debug builds)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cdynamicoutputpin.html"><strong>CDynamicOutputPin Class</strong></a></p>
<!-- raw HTML omitted -->
</body>
