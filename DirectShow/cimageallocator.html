<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CImageAllocator class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The CImageAllocator class implements an allocator that manages GDI device-independent bitmaps (DIBs). This class derives from the CBaseAllocator class. It creates media samples that are implemented using the CImageSample class.
ms.assetid: edda34a5-3916-4a41-9e2f-a19f12df0947
title: CImageAllocator class (Winutil.h)
ms.topic: reference
ms.date: 4/26/2023
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>CImageAllocator
api_type:</li>
<li>COM
api_location:</li>
<li>Strmbase.lib</li>
<li>Strmbase.dll</li>
<li>Strmbasd.lib</li>
<li>Strmbasd.dll
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>CImageAllocator class</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p><img src="images/wutil04.png" alt="cimageallocator class hierarchy" /></p>
<p>The <code>CImageAllocator</code> class implements an allocator that manages GDI device-independent bitmaps (DIBs). This class derives from the <a href="cbaseallocator.html"><strong>CBaseAllocator</strong></a> class. It creates media samples that are implemented using the <a href="cimagesample.html"><strong>CImageSample</strong></a> class.</p>
<p>An allocator is shared by two connected pins, but is always owned by one of the filters in the connection. A filter that uses <code>CImageAllocator</code> must keep track of whether the allocator was provided by itself or by the other filter. If the allocator was provided by itself, the owning filter can rely on the fact that all media samples from the allocator are <strong>CImageSample</strong> objects. It can therefore use the <strong>CImageSample</strong> object to obtain information about the DIB, which is stored in a <a href="dibdata.html"><strong>DIBDATA</strong></a> structure.</p>
<p>The owning filter should call <strong>NotifyMediaType</strong> whenever the media type changes.</p>
<table>
<thead>
<tr>
<th>Protected Member Variables</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="cimageallocator-m-pfilter.html"><strong>m_pFilter</strong></a></td>
<td>Pointer to the owning filter.</td>
</tr>
<tr>
<td><a href="cimageallocator-m-pmediatype.html"><strong>m_pMediaType</strong></a></td>
<td>Pointer to the current media type.</td>
</tr>
<tr>
<td>Protected Methods</td>
<td>Description</td>
</tr>
<tr>
<td><a href="cimageallocator-alloc.html"><strong>Alloc</strong></a></td>
<td>Allocates memory for the buffers.</td>
</tr>
<tr>
<td><a href="cimageallocator-checksizes.html"><strong>CheckSizes</strong></a></td>
<td>Checks allocator properties against the current media type.</td>
</tr>
<tr>
<td><a href="cimageallocator-createdib.html"><strong>CreateDIB</strong></a></td>
<td>Creates a DIB.</td>
</tr>
<tr>
<td><a href="cimageallocator-createimagesample.html"><strong>CreateImageSample</strong></a></td>
<td>Creates a media sample. Virtual.</td>
</tr>
<tr>
<td><a href="cimageallocator-free.html"><strong>Free</strong></a></td>
<td>Releases all of the buffer memory.</td>
</tr>
<tr>
<td>Public Methods</td>
<td>Description</td>
</tr>
<tr>
<td><a href="cimageallocator-cimageallocator.html"><strong>CImageAllocator</strong></a></td>
<td>Constructor method.</td>
</tr>
<tr>
<td><a href="cimageallocator-notifymediatype.html"><strong>NotifyMediaType</strong></a></td>
<td>Informs the object of the current media type.</td>
</tr>
<tr>
<td>IMemAllocator Methods</td>
<td>Description</td>
</tr>
<tr>
<td><a href="cimageallocator-setproperties.html"><strong>SetProperties</strong></a></td>
<td>Specifies the number of buffers to allocate and the size of each buffer.</td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winutil.h (include Streams.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbase.lib (retail builds); <!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbasd.lib (debug builds)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cdrawimage.html"><strong>CDrawImage Class</strong></a></p>
<!-- raw HTML omitted -->
</body>
