<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>File Writer Filter</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: File Writer Filter
ms.assetid: 2bfbea8a-679f-4656-9ff3-fdf34aa0eb26
title: File Writer Filter
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>File Writer Filter</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The File Writer filter can be used to write files to disc regardless of format. The filter simply writes to disc whatever it receives on its input pin, so it must be connected upstream to a multiplexer that can format the file correctly. You can create a new output file with the File Writer or specify an existing file; if the file already exists, it will be completely overwritten with the new data.</p>
<p>The file writer filter uses the input stream's time stamps as file offsets and provides random access to the file. It supports <strong>IStream</strong> to allow reading and writing the file header after the graph is stopped. To improve performance it also supports unbuffered overlapped writes and handles the corresponding buffer negotiation.</p>
<blockquote>
<p>[!Note]<br />
To write ASF files, use the <a href="wm-asf-writer-filter.html">WM ASF Writer</a> filter.</p>
</blockquote>
<p>Â </p>
<table>
<thead>
<tr>
<th>Label</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Filter Interfaces</td>
<td><a href="/windows/desktop/api/Strmif/nn-strmif-iamfiltermiscflags"><strong>IAMFilterMiscFlags</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ibasefilter"><strong>IBaseFilter</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ifilesinkfilter"><strong>IFileSinkFilter</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ifilesinkfilter2"><strong>IFileSinkFilter2</strong></a>, <strong>IPersistStream</strong></td>
</tr>
<tr>
<td>Input Pin Media Types</td>
<td>MEDIATYPE_Stream, MEDIASUBTYPE_NULL</td>
</tr>
<tr>
<td>Input Pin Interfaces</td>
<td><a href="/windows/desktop/api/Strmif/nn-strmif-imeminputpin"><strong>IMemInputPin</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ipin"><strong>IPin</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-iqualitycontrol"><strong>IQualityControl</strong></a>, <strong>IStream</strong></td>
</tr>
<tr>
<td>Output Pin Media Types</td>
<td>Not applicable</td>
</tr>
<tr>
<td>Output Pin Interfaces</td>
<td>Not applicable</td>
</tr>
<tr>
<td>Filter CLSID</td>
<td>CLSID_FileWriter</td>
</tr>
<tr>
<td>Property Page CLSID</td>
<td>No property page</td>
</tr>
<tr>
<td>Executable</td>
<td>qcap.dll</td>
</tr>
<tr>
<td><a href="merit.html">Merit</a></td>
<td>MERIT_DO_NOT_USE</td>
</tr>
<tr>
<td><a href="filter-categories.html">Filter Category</a></td>
<td>CLSID_LegacyAmFilterCategory</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="directshow-filters.html">DirectShow Filters</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
