<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Audio Capabilities</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Audio Capabilities
ms.assetid: de96f6ee-b526-4ac2-93ac-a731f86ef5d5
title: Audio Capabilities
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>Audio Capabilities</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>For audio capabilities, <a href="/windows/desktop/api/Strmif/nf-strmif-iamstreamconfig-getstreamcaps"><strong>IAMStreamConfig::GetStreamCaps</strong></a> returns an array of pairs of <a href="/windows/win32/api/strmif/ns-strmif-am_media_type"><strong>AM_MEDIA_TYPE</strong></a> and <a href="/windows/win32/api/strmif/ns-strmif-audio_stream_config_caps"><strong>AUDIO_STREAM_CONFIG_CAPS</strong></a> structures. As with video, you can use this to expose all kinds of audio capabilities on the pin, such as data rate and whether it supports mono or stereo.</p>
<p>For video-related examples relating to GetStreamCaps, see <a href="video-capabilities.html">Video Capabilities</a>.</p>
<p>Suppose you support pulse code modulation (PCM) wave format (as represented by the <a href="/previous-versions/dd757713(v=vs.85)"><strong>WAVEFORMATEX</strong></a> structure) at sampling rates of 11,025, 22,050, and 44,100 samples per second, all at 8- or 16-bit mono or stereo. In this case, you would offer two pairs of structures. The first pair would have an <strong>AUDIO_STREAM_CONFIG_CAPS</strong> capability structure saying you support a minimum of 11,025 to a maximum of 22,050 samples per second with a granularity of 11,025 samples per second (granularity is the difference between supported values); an 8-bit minimum to a 16-bit maximum bits per sample with a granularity of 8 bits per sample; and one-channel minimum and two-channel maximum. The first pair's media type would be your default PCM format in that range, perhaps 22 kilohertz (kHz), 16-bit stereo. Your second pair would be a capability showing 44,100 for both minimum and maximum samples per second; 8-bit (minimum) and 16-bit (maximum) bits per sample, with a granularity of 8 bits per sample; and one-channel minimum and two-channel maximum. The media type would be your default 44 kHz format, perhaps 44 kHz 16-bit stereo.</p>
<p>If you support non-PCM wave formats, the media type returned by this method can show which non-PCM formats you support (with a default sample rate, bit rate, and channels) and the capabilities structure accompanying that media type can describe which other sample rates, bit rates, and channels you support.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="exposing-capture-and-compression-formats.html">Exposing Capture and Compression Formats</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
