<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CBaseAllocator.SetProperties method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The SetProperties method specifies the number of buffers to allocate and the size of each buffer. This method implements the IMemAllocator::SetProperties method.
ms.assetid: f53c22a4-c01d-4d2f-81f0-bedf8f2ae5f0
title: CBaseAllocator.SetProperties method (Amfilter.h)
ms.topic: reference
ms.date: 4/26/2023
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>CBaseAllocator.SetProperties
api_type:</li>
<li>COM
api_location:</li>
<li>Strmbase.lib</li>
<li>Strmbase.dll</li>
<li>Strmbasd.lib</li>
<li>Strmbasd.dll
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>CBaseAllocator.SetProperties method</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The <code>SetProperties</code> method specifies the number of buffers to allocate and the size of each buffer. This method implements the <a href="/windows/desktop/api/Strmif/nf-strmif-imemallocator-setproperties"><strong>IMemAllocator::SetProperties</strong></a> method.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT SetProperties(
   ALLOCATOR_PROPERTIES *pRequest,
   ALLOCATOR_PROPERTIES *pActual
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>pRequest</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <a href="/windows/win32/api/strmif/ns-strmif-allocator_properties"><strong>ALLOCATOR_PROPERTIES</strong></a> structure that contains the buffer requirements.</p>
<!-- raw HTML omitted -->
<p><em>pActual</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <strong>ALLOCATOR_PROPERTIES</strong> structure that receives the actual buffer properties.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns one of the following <strong>HRESULT</strong> values.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Success.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_POINTER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>NULL</strong> pointer argument.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>VFW_E_ALREADY_COMMITTED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Cannot change allocated memory while the filter is active.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>VFW_E_BADALIGN</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An invalid alignment was specified.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>VFW_E_BUFFERS_OUTSTANDING</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>One or more buffers are still active.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>This method specifies the buffer requirements, but does not allocate any buffers. Call the <a href="cbaseallocator-commit.html"><strong>CBaseAllocator::Commit</strong></a> method to allocate buffers.</p>
<p>The caller allocates two ALLOCATOR_PROPERTIES structures. The <em>pRequest</em> parameter contains the caller's buffer requirements, including the number of buffers and the size of each buffer. When the method returns, the <em>pActual</em> parameter contains the actual buffer properties, as set by the allocator. In the base class, assuming that the method succeeds, the actual properties always match the requested properties. Derived classes might override this behavior.</p>
<p>The allocator must not be committed, and must not have outstanding buffers. In the base class, the alignment must equal 1. The <a href="cmemallocator.html"><strong>CMemAllocator</strong></a> class overrides this requirement.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Amfilter.h (include Streams.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbase.lib (retail builds); <!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbasd.lib (debug builds)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cbaseallocator.html"><strong>CBaseAllocator Class</strong></a></p>
<!-- raw HTML omitted -->
</body>
