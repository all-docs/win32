<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Windows Media Source Filter</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Windows Media Source Filter
ms.assetid: e59b3086-4f62-4541-8bef-b0581f01906f
title: Windows Media Source Filter
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>Windows Media Source Filter</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>This filter is the legacy source filter for Windows MediaÂ® content. It is used by Windows Media Player 6.4. In general, the simplest and most reliable way to use this filter is to use the Windows Media Player 6.4 ActiveX control. Many of the methods exposed by this filter are also exposed through the ActiveX control. See the Windows Media Player SDK for more information.</p>
<p>When this filter is given the name of a local ASF file or a URL for a remote file, it reads the file, parses the compressed streams, and creates an output pin for each one. This filter does not use the Windows Media Format SDK. It uses the installable codec versions of the Windows Media decoders, not the DMO versions. The audio output pin always connects to the ASF ACM Handler filter, and the video pin always connects to the ASF ICM Handler. (ICM in this case refers to the original name of the Video Compression Manager.) The filter does not support seeking.</p>
<p>The following diagram shows a filter graph with this filter.</p>
<p><img src="images/wms-wmv-graph.png" alt="windows media source filter graph" /></p>
<p>To maintain backward compatibility with Windows Media Player 6.4, this filter is the default source filter for files with .wma, .wmv, and .asf file extensions. For file playback, newer applications should use the <a href="wm-asf-reader-filter.html">WM ASF Reader</a> filter. However, the WM ASF Reader does not support playback of streamed content.</p>
<p>The simplest way for an application to play streamed Windows Media-based content is to use the Windows Media Player SDK. Another option is to use the Windows Media Format SDK. Attempting to create a custom player based on the Windows Media Source Filter is not recommended.</p>
<table>
<thead>
<tr>
<th>Label</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Filter interfaces</td>
<td><a href="/windows/desktop/api/Strmif/nn-strmif-ibasefilter"><strong>IBaseFilter</strong></a>, <a href="/previous-versions/windows/desktop/api/Qnetwork/nn-qnetwork-iamchannelinfo"><strong>IAMChannelInfo</strong></a>, <a href="/previous-versions/windows/desktop/api/Qnetwork/nn-qnetwork-iamextendedseeking"><strong>IAMExtendedSeeking</strong></a>, <a href="/previous-versions/windows/desktop/api/Qnetwork/nn-qnetwork-iammediacontent"><strong>IAMMediaContent</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-iamopenprogress"><strong>IAMOpenProgress</strong></a>, <a href="/previous-versions/windows/desktop/api/Qnetwork/nn-qnetwork-iamnetshowconfig"><strong>IAMNetShowConfig</strong></a>, <a href="/previous-versions/windows/desktop/api/Qnetwork/nn-qnetwork-iamnetshowexprops"><strong>IAMNetShowExProps</strong></a>, <a href="/previous-versions/windows/desktop/api/Qnetwork/nn-qnetwork-iamnetshowpreroll"><strong>IAMNetShowPreroll</strong></a>, <a href="/previous-versions/windows/desktop/api/Qnetwork/nn-qnetwork-iamnetworkstatus"><strong>IAMNetworkStatus</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ifilesourcefilter"><strong>IFileSourceFilter</strong></a></td>
</tr>
<tr>
<td>Input pin media types</td>
<td>Not applicable.</td>
</tr>
<tr>
<td>Input pin interfaces</td>
<td>Not applicable.</td>
</tr>
<tr>
<td>Output pin media types</td>
<td>Varies depending on the streams within the ASF file.</td>
</tr>
<tr>
<td>Output pin interfaces</td>
<td><a href="/windows/desktop/api/Strmif/nn-strmif-imediaseeking"><strong>IMediaSeeking</strong></a></td>
</tr>
<tr>
<td>Filter CLSID</td>
<td>See Remarks</td>
</tr>
<tr>
<td>Executable</td>
<td>dxmasf.dll</td>
</tr>
<tr>
<td><a href="merit.html">Merit</a></td>
<td>MERIT_NORMAL</td>
</tr>
<tr>
<td><a href="filter-categories.html">Filter Category</a></td>
<td>CLSID_LegacyAmFilterCategory</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>The filter's CLSID is not defined in qnetwork.h. Use this macro in your own header file:</p>
<pre lang="C++"><code>//  {6B6D0800-9ADA-11d0-A520-00A0D10129C0}
DEFINE_GUID(CLSID_NetShowSource, 
0x6b6d0800, 0x9ada, 0x11d0, 0xa5, 0x20, 0x0, 0xa0, 0xd1, 0x1, 0x29, 0xc0);
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="directshow-filters.html">DirectShow Filters</a></p>
<!-- raw HTML omitted -->
<p><a href="reading-asf-files-in-directshow.html">Reading ASF Files in DirectShow</a></p>
<!-- raw HTML omitted -->
<p><a href="wm-asf-reader-filter.html">WM ASF Reader Filter</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
