<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CCmdQueue.New method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The New method initializes a command to be run and returns a new CDeferredCommand object.
ms.assetid: bdd80747-a15b-422a-b742-ebfa4076bdf7
title: CCmdQueue.New method (Winutil.h)
ms.topic: reference
ms.date: 4/26/2023
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>CCmdQueue.New
api_type:</li>
<li>COM
api_location:</li>
<li>Strmbase.lib</li>
<li>Strmbase.dll</li>
<li>Strmbasd.lib</li>
<li>Strmbasd.dll
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>CCmdQueue.New method</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The <code>New</code> method initializes a command to be run and returns a new <a href="cdeferredcommand.html"><strong>CDeferredCommand</strong></a> object.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>virtual HRESULT New(
   CDeferredCommand **ppCmd,
   LPUNKNOWN        pUnk,
   REFTIME          time,
   GUID             *iid,
   long             dispidMethod,
   short            wFlags,
   long             cArgs,
   VARIANT          *pDispParams,
   VARIANT          *pvarResult,
   short            *puArgErr,
   BOOL             bStream
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>ppCmd</em></p>
<!-- raw HTML omitted -->
<p>Address of a pointer to a <a href="cdeferredcommand.html"><strong>CDeferredCommand</strong></a> object by which an application can cancel the command, set a new presentation time for it, or retrieve estimate information.</p>
<!-- raw HTML omitted -->
<p><em>pUnk</em></p>
<!-- raw HTML omitted -->
<p>Pointer to the object that will run the command.</p>
<!-- raw HTML omitted -->
<p><em>time</em></p>
<!-- raw HTML omitted -->
<p>Time at which to run the queued command or commands.</p>
<!-- raw HTML omitted -->
<p><em>iid</em></p>
<!-- raw HTML omitted -->
<p>Pointer to the globally unique identifier (<strong>GUID</strong>) of the interface to call.</p>
<!-- raw HTML omitted -->
<p><em>dispidMethod</em></p>
<!-- raw HTML omitted -->
<p>Method on the interface to be called.</p>
<!-- raw HTML omitted -->
<p><em>wFlags</em></p>
<!-- raw HTML omitted -->
<p>Flags describing the context of the call. This parameter supports the same flags as the <strong>IDispatch::Invoke</strong> method.</p>
<!-- raw HTML omitted -->
<p><em>cArgs</em></p>
<!-- raw HTML omitted -->
<p>Number of arguments passed.</p>
<!-- raw HTML omitted -->
<p><em>pDispParams</em></p>
<!-- raw HTML omitted -->
<p>Pointer to the list of variant types associated with the dispatch parameters.</p>
<!-- raw HTML omitted -->
<p><em>pvarResult</em></p>
<!-- raw HTML omitted -->
<p>Pointer to the list where results, if any, are to be returned.</p>
<!-- raw HTML omitted -->
<p><em>puArgErr</em></p>
<!-- raw HTML omitted -->
<p>Pointer to the index within the <em>pDispParams</em> parameter list where the last error occurred.</p>
<!-- raw HTML omitted -->
<p><em>bStream</em></p>
<!-- raw HTML omitted -->
<p>Value indicating whether the <em>time</em> parameter is a stream-time value (<strong>TRUE</strong>) or a presentation-time value (<strong>FALSE</strong>).</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns S_OK if successful. Returns E_OUTOFMEMORY if <em>ppCmd</em> returns from creating the new <a href="cdeferredcommand.html"><strong>CDeferredCommand</strong></a> object with a value of <strong>NULL</strong>. Otherwise, returns an <strong>HRESULT</strong> that indicates an error from attempting to create a new <strong>CDeferredCommand</strong> object. If there is an error, no object has been queued.</p>
<h2>Remarks</h2>
<p>The new <a href="cdeferredcommand.html"><strong>CDeferredCommand</strong></a> object will be initialized with the parameters and will be added to the queue during construction. This method is similar to the <strong>IDispatch::Invoke</strong> method.</p>
<p>Values for the <em>wFlags</em> parameter include the following:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DISPATCH_METHOD</td>
<td>The member is being run as a method. If a property has the same name, both this and the DISPATCH_PROPERTYGET flag can be set.</td>
</tr>
<tr>
<td>DISPATCH_PROPERTYGET</td>
<td>The member is being retrieved as a property or data member.</td>
</tr>
<tr>
<td>DISPATCH_PROPERTYPUT</td>
<td>The member is being changed as a property or data member.</td>
</tr>
<tr>
<td>DISPATCH_PROPERTYPUTREF</td>
<td>The member is being changed via a reference assignment, rather than a value assignment. This value is valid only when the property accepts a reference to an object.</td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winutil.h (include Streams.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbase.lib (retail builds); <!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbasd.lib (debug builds)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="ccmdqueue.html"><strong>CCmdQueue Class</strong></a></p>
<!-- raw HTML omitted -->
</body>
