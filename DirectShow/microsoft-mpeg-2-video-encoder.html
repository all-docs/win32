<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Microsoft MPEG-2 Video Encoder</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The Microsoft MPEG-2 Video Encoder filter encodes MPEG-2 and MPEG-1 video.
ms.assetid: d52c1299-0641-405c-8960-edd738b56823
title: Microsoft MPEG-2 Video Encoder (Wmcodecdsp.h)
ms.topic: reference
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>Microsoft MPEG-2 Video Encoder</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The Microsoft MPEG-2 Video Encoder filter encodes MPEG-2 and MPEG-1 video.</p>
<p>To encode and multiplex audio/video streams, use the <a href="microsoft-mpeg-2-encoder.html"><strong>Microsoft MPEG-2 Encoder</strong></a> filter, which encapsulates the functions of both this filter and the <a href="microsoft-mpeg-2-audio-encoder.html"><strong>Microsoft MPEG-2 Audio Encoder</strong></a> filter.</p>
<blockquote>
<p>[!Note]<br />
This filter is not supported on IA-64-based platforms.</p>
</blockquote>
<p>Â </p>
<p>Filter Information</p>
<p>Filter Interfaces</p>
<p><a href="/windows/desktop/api/Strmif/nn-strmif-ibasefilter"><strong>IBaseFilter</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Strmif/nn-strmif-icodecapi"><strong>ICodecAPI</strong></a><!-- raw HTML omitted --> <strong>IEncoderAPI</strong><!-- raw HTML omitted --> <a href="/windows/desktop/api/Strmif/nn-strmif-imediaseeking"><strong>IMediaSeeking</strong></a><!-- raw HTML omitted --> <a href="/windows/win32/api/strmif/nn-strmif-ivideoencoder"><strong>IVideoEncoder</strong></a><!-- raw HTML omitted --></p>
<p>Input Pin Media Types</p>
<p><strong>MEDIATYPE_Video</strong>, <strong>MEDIASUBTYPE_I420</strong><!-- raw HTML omitted --> <strong>MEDIATYPE_Video</strong>, <strong>MEDIASUBTYPE_IYUV</strong><!-- raw HTML omitted --> <strong>MEDIATYPE_Video</strong>, <strong>MEDIASUBTYPE_RGB24</strong><!-- raw HTML omitted --> <strong>MEDIATYPE_Video</strong>, <strong>MEDIASUBTYPE_UYVY</strong><!-- raw HTML omitted --> <strong>MEDIATYPE_Video</strong>, <strong>MEDIASUBTYPE_YUY2</strong><!-- raw HTML omitted --> <strong>MEDIATYPE_Video</strong>, <strong>MEDIASUBTYPE_YV12</strong><!-- raw HTML omitted --></p>
<p>Input Pin Interfaces</p>
<p><a href="/windows/desktop/api/Strmif/nn-strmif-imeminputpin"><strong>IMemInputPin</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Strmif/nn-strmif-ipin"><strong>IPin</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Strmif/nn-strmif-iqualitycontrol"><strong>IQualityControl</strong></a><!-- raw HTML omitted --></p>
<p>Output Pin Media Types</p>
<p><strong>MEDIATYPE_Stream</strong>, <strong>MEDIASUBTYPE_MPEG2_VIDEO</strong><!-- raw HTML omitted --> <strong>MEDIATYPE_Stream</strong>, <strong>MEDIASUBTYPE_MPEG2_PROGRAM</strong><!-- raw HTML omitted --> <strong>MEDIATYPE_Stream</strong>, <strong>MEDIASUBTYPE_MPEG2_TRANSPORT</strong><!-- raw HTML omitted --> <strong>MEDIATYPE_Video</strong>, <strong>MEDIASUBTYPE_MPEG2_VIDEO</strong><!-- raw HTML omitted --></p>
<p>Output Pin Interfaces</p>
<p><a href="/windows/desktop/api/Strmif/nn-strmif-imediaseeking"><strong>IMediaSeeking</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Strmif/nn-strmif-ipin"><strong>IPin</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Strmif/nn-strmif-iqualitycontrol"><strong>IQualityControl</strong></a><!-- raw HTML omitted --></p>
<p>Filter CLSID</p>
<p><strong>CLSID_CMPEG2EncoderVideoDS</strong> (declared in wmcodecdsp.h)</p>
<p>Executable</p>
<p>msmpeg2enc.dll</p>
<p><a href="merit.html">Merit</a></p>
<p><strong>MERIT_DO_NOT_USE</strong></p>
<p><a href="filter-categories.html">Filter Category</a></p>
<p><strong>CLSID_LegacyAmFilterCategory</strong></p>
<p>Â </p>
<h2>Remarks</h2>
<p>The MPEG-2 Video Encoder can produce the following kinds of output:</p>
<ul>
<li>Video elementary stream</li>
<li>Video in an MPEG-2 program stream</li>
<li>Video in an MPEG-2 transport stream</li>
</ul>
<p>It supports the following MPEG-2 profiles and levels:</p>
<table>
<thead>
<tr>
<th>Profile</th>
<th>Levels</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td>Simple Profile</td>
<td>Main</td>
<td></td>
</tr>
<tr>
<td>Main Profile</td>
<td>Low, Main, High, High-1440</td>
<td></td>
</tr>
<tr>
<td>High Profile</td>
<td>Main, High, High-1440</td>
<td>No scalability or 4:2:2/4:4:4 support (only 4:2:0)</td>
</tr>
<tr>
<td>4:2:2 Profile</td>
<td>Main, High</td>
<td>No scalability or 4:2:2 support (only 4:2:0)</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Codec Properties</h3>
<p>The filter supports the following properties through <a href="/windows/desktop/api/Strmif/nn-strmif-icodecapi"><strong>ICodecAPI</strong></a>.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Default</th>
<th>Supported Values</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="avenccodectype-property.html"><strong>AVEncCodecType</strong></a></td>
<td>MPEG-2 video</td>
<td><strong>CODECAPI_GUID_AVEncMPEG1Video</strong><!-- raw HTML omitted --> <strong>CODECAPI_GUID_AVEncMPEG2Video</strong><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="avenccommonbufferinlevel-property.html"><strong>AVEncCommonBufferInLevel</strong></a></td>
<td>12222464 bits</td>
<td></td>
</tr>
<tr>
<td><a href="avenccommonbufferoutlevel-property.html"><strong>AVEncCommonBufferOutLevel</strong></a></td>
<td>12222464 bits</td>
<td></td>
</tr>
<tr>
<td><a href="avenccommonbuffersize-property.html"><strong>AVEncCommonBufferSize</strong></a></td>
<td>12222464 bits</td>
<td></td>
</tr>
<tr>
<td><a href="avenccommonformatconstraint-property.html"><strong>AVEncCommonFormatConstraint</strong></a></td>
<td>Unspecified</td>
<td><strong>CODECAPI_GUID_AVEncCommonFormatUnSpecified</strong> (No format constraint)<!-- raw HTML omitted --> <strong>CODECAPI_GUID_AVEncCommonFormatDVD_V</strong> (DVD-Video)<!-- raw HTML omitted --> <strong>CODECAPI_GUID_AVEncCommonFormatVCD</strong> (Video CD)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="avenccommonmaxbitrate-property.html"><strong>AVEncCommonMaxBitRate</strong></a></td>
<td>9800000 (9.8 Mbits/second)</td>
<td></td>
</tr>
<tr>
<td><a href="avenccommonmeanbitrate-property.html"><strong>AVEncCommonMeanBitRate</strong></a></td>
<td>7000000 (7.0 Mbits/second)</td>
<td></td>
</tr>
<tr>
<td><a href="avenccommonminbitrate-property.html"><strong>AVEncCommonMinBitRate</strong></a></td>
<td>128</td>
<td></td>
</tr>
<tr>
<td><a href="avenccommonmultipassmode-property.html"><strong>AVEncCommonMultipassMode</strong></a></td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><a href="avenccommonquality-property.html"><strong>AVEncCommonQuality</strong></a></td>
<td>100</td>
<td>1 â€” 100</td>
</tr>
<tr>
<td><a href="avenccommonqualityvsspeed-property.html"><strong>AVEncCommonQualityVsSpeed</strong></a></td>
<td>75</td>
<td>0 â€” 100</td>
</tr>
<tr>
<td><a href="avenccommonratecontrolmode-property.html"><strong>AVEncCommonRateControlMode</strong></a></td>
<td>CBR</td>
<td><strong>eAVEncCommonRateControlMode_CBR</strong><!-- raw HTML omitted --> <strong>eAVEncCommonRateControlMode_PeakConstrainedVBR</strong><!-- raw HTML omitted --> <strong>eAVEncCommonRateControlMode_Quality</strong><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="avencinputvideosystem-property.html"><strong>AVEncInputVideoSystem</strong></a></td>
<td>Unspecified</td>
<td>eAVEncInputVideoSystem_Unspecified<!-- raw HTML omitted --> eAVEncInputVideoSystem_PAL<!-- raw HTML omitted --> eAVEncInputVideoSystem_NTSC<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="avencmpvdefaultbpicturecount-property.html"><strong>AVEncMPVDefaultBPictureCount</strong></a></td>
<td>2</td>
<td>0 â€” 2</td>
</tr>
<tr>
<td><a href="avencmpvframefieldmode-property.html"><strong>AVEncMPVFrameFieldMode</strong></a></td>
<td>Frame mode</td>
<td></td>
</tr>
<tr>
<td><a href="avencmpvgenerateheaderseqdispext-property.html"><strong>AVEncMPVGenerateHeaderSeqDispExt</strong></a></td>
<td><strong>TRUE</strong></td>
<td></td>
</tr>
<tr>
<td><a href="avencmpvgenerateheaderseqext-property.html"><strong>AVEncMPVGenerateHeaderSeqExt</strong></a></td>
<td><strong>TRUE</strong></td>
<td></td>
</tr>
<tr>
<td><a href="avencmpvgopopen-property.html"><strong>AVEncMPVGOPOpen</strong></a></td>
<td><strong>FALSE</strong></td>
<td></td>
</tr>
<tr>
<td><a href="avencmpvgopsinseq-property.html"><strong>AVEncMPVGOPSInSeq</strong></a></td>
<td>1</td>
<td>0 â€” 1</td>
</tr>
<tr>
<td><a href="avencmpvgopsize-property.html"><strong>AVEncMPVGOPSize</strong></a></td>
<td>18 frames (36 fields) for NTSC; 15 frames (30 fields) otherwise.</td>
<td>1 â€” 30; see Remarks</td>
</tr>
<tr>
<td><a href="avencmpvintradcprecision-property.html"><strong>AVEncMPVIntraDCPrecision</strong></a></td>
<td>9</td>
<td>8 â€” 10</td>
</tr>
<tr>
<td><a href="avencmpvlevel-property.html"><strong>AVEncMPVLevel</strong></a></td>
<td>High</td>
<td></td>
</tr>
<tr>
<td><a href="avencmpvprofile-property.html"><strong>AVEncMPVProfile</strong></a></td>
<td>Main</td>
<td></td>
</tr>
<tr>
<td><a href="avencvideodefaultupperfielddominant-property.html"><strong>AVEncVideoDefaultUpperFieldDominant</strong></a></td>
<td><strong>TRUE</strong></td>
<td></td>
</tr>
<tr>
<td><a href="avencvideoforcesourcescantype-property.html"><strong>AVEncVideoForceSourceScanType</strong></a></td>
<td>Interlaced</td>
<td><strong>eAVEncVideoSourceScan_Interlaced</strong><!-- raw HTML omitted --> <strong>eAVEncVideoSourceScan_Progressive</strong><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="avencvideoinputchromaresolution-property.html"><strong>AVEncVideoInputChromaResolution</strong></a></td>
<td>4:2:0</td>
<td><strong>eAVEncVideoChromaResolution_420</strong> (4:2:0)<!-- raw HTML omitted --> <strong>eAVEncVideoChromaResolution_SameAsSource</strong><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="avencvideoinputchromasubsampling-property.html"><strong>AVEncVideoInputChromaSubsampling</strong></a></td>
<td>Same as source</td>
<td></td>
</tr>
<tr>
<td><a href="avencvideoinputcolornominalrange-property.html"><strong>AVEncVideoInputColorNominalRange</strong></a></td>
<td>Same as source</td>
<td></td>
</tr>
<tr>
<td><a href="avencvideoinputcolorprimaries-property.html"><strong>AVEncVideoInputColorPrimaries</strong></a></td>
<td>Same as source</td>
<td></td>
</tr>
<tr>
<td><a href="avencvideoinputcolortransferfunction-property.html"><strong>AVEncVideoInputColorTransferFunction</strong></a></td>
<td>Same as source</td>
<td></td>
</tr>
<tr>
<td><a href="avencvideoinputcolortransfermatrix-property.html"><strong>AVEncVideoInputColorTransferMatrix</strong></a></td>
<td>Same as source</td>
<td></td>
</tr>
<tr>
<td><a href="avencvideomaxkeyframedistance-property.html"><strong>AVEncVideoMaxKeyframeDistance</strong></a></td>
<td><a href="avencmpvgopsize-property.html"><strong>AVEncMPVGOPSize</strong></a> - 1</td>
<td>0 or <a href="avencmpvgopsize-property.html"><strong>AVEncMPVGOPSize</strong></a> - 1</td>
</tr>
<tr>
<td><a href="avencvideonooffieldstoencode-property.html"><strong>AVEncVideoNoOfFieldsToEncode</strong></a></td>
<td>0</td>
<td></td>
</tr>
<tr>
<td><a href="avencvideooutputchromaresolution-property.html"><strong>AVEncVideoOutputChromaResolution</strong></a></td>
<td>4:2:0</td>
<td><strong>eAVEncVideoChromaResolution_420</strong> (4:2:0)<!-- raw HTML omitted --> <strong>eAVEncVideoChromaResolution_SameAsSource</strong><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="avencvideooutputframerate-property.html"><strong>AVEncVideoOutputFrameRate</strong></a></td>
<td></td>
<td>Must be the same as the input frame rate.</td>
</tr>
<tr>
<td><a href="avencvideooutputscantype-property.html"><strong>AVEncVideoOutputScanType</strong></a></td>
<td>Same as input</td>
<td><strong>eAVEncVideoOutputScan_SameAsInput</strong></td>
</tr>
<tr>
<td><a href="avencvideopixelaspectratio-property.html"><strong>AVEncVideoPixelAspectRatio</strong></a></td>
<td>1:1</td>
<td></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>It is recommended to set properties in the following order:</p>
<ol>
<li><a href="avenccommonformatconstraint-property.html"><strong>AVEncCommonFormatConstraint</strong></a></li>
<li><a href="avenccodectype-property.html"><strong>AVEncCodecType</strong></a></li>
<li><a href="avencmpvprofile-property.html"><strong>AVEncMPVProfile</strong></a></li>
<li><a href="avencmpvlevel-property.html"><strong>AVEncMPVLevel</strong></a></li>
<li><a href="avencinputvideosystem-property.html"><strong>AVEncInputVideoSystem</strong></a></li>
</ol>
<p>Set the remaining properties in any order. (However, see <a href="#gop-structure">GOP Structure</a>.)</p>
<p>It is possible to set properties while the filter graph is running. There is a delay of at least one GOP before the new settings take effect.</p>
<h3>Encoder Operation</h3>
<p>When encoding MPEG-1 video, the encoder automatically sets the 1-bit <strong>constrained_parameters_flag</strong> code in the sequence header if all constraints are met.</p>
<p>If needed, the encoder rounds up the input video dimensions so that the output video dimensions match the MPEG requirements. For progressive video, the output dimensions are rounded up to a multiple of 16 in both width and height. For interlaced video, width is rounded up to a multiple of 16, and height is rounded up to a multiple of 32. This round-up operation uses padding as needed.</p>
<p>If the video is interlaced, the encoder performs automatic telecine (3:2 pull-down) detection. The input video can contain field picture pairs, in addition to interlaced frames.</p>
<p>The encoder's internal format is 4:2:0 IYUV (identical to I420). It can perform color conversion from YUY2, YV12, UYVY, and RGB-24 video formats.</p>
<p>To constrain the bitstream to a target format (DVD or VCD), set the <a href="avenccommonformatconstraint-property.html"><strong>AVEncCommonFormatConstraint</strong></a> property. If this property has a value other than <strong>GUID_AVEncCommonFormatUnSpecified</strong>, the encoder limits the MPEG syntax to that allowed by the target format.</p>
<p>For live encoding, set the <a href="avenccommonqualityvsspeed-property.html"><strong>AVEncCommonQualityVsSpeed</strong></a> property to zero. This causes the encoder to optimize for speed.</p>
<h3>Encoding Modes</h3>
<p>The encoder supports several encoding modes:</p>
<ul>
<li>One-pass constant bit rate (CBR).</li>
<li>One-pass quality-based variable bit rate (VBR), using a constant quantizer step size. In this mode, the encoder attempts to meet a target quality level, up to a maximum bit rate.</li>
<li>One-pass peak-constrained VBR. In this mode, the encoder attempts to achieve a target average bit rate within certain internal limits.</li>
</ul>
<p>To configure the encoding mode, set the following properties:</p>
<table>
<thead>
<tr>
<th>Mode</th>
<th>Properties</th>
</tr>
</thead>
<tbody>
<tr>
<td>CBR</td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->AVEncCommonRateControlMode<!-- raw HTML omitted --><!-- raw HTML omitted --> = <!-- raw HTML omitted -->eAVEncCommonRateControlMode_CBR<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->AVEncCommonQualityVsSpeed<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->AVEncCommonMeanBitRate<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Quality-based VBR</td>
<td><a href="avenccommonratecontrolmode-property.html"><strong>AVEncCommonRateControlMode</strong></a> = <strong>eAVEncCommonRateControlMode_Quality</strong><!-- raw HTML omitted --><a href="avenccommonquality-property.html"><strong>AVEncCommonQuality</strong></a><!-- raw HTML omitted --><a href="avenccommonmaxbitrate-property.html"><strong>AVEncCommonMaxBitRate</strong></a><!-- raw HTML omitted --> <strong>Note:</strong> In this mode, the <a href="avenccommonmeanbitrate-property.html"><strong>AVEncCommonMeanBitRate</strong></a> and <a href="avenccommonminbitrate-property.html"><strong>AVEncCommonMinBitRate</strong></a> properties are not used. The minimum bit rate is assumed to be zero.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Peak-constrained VBR</td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->AVEncCommonRateControlMode<!-- raw HTML omitted --><!-- raw HTML omitted --> = <!-- raw HTML omitted -->eAVEncCommonRateControlMode_PeakConstrainedVBR<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->AVEncCommonMultipassMode<!-- raw HTML omitted --><!-- raw HTML omitted --> = 1<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->AVEncCommonMinBitRate<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->AVEncCommonMaxBitRate<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->AVEncCommonMeanBitRate<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<blockquote>
<p>[!Note]<br />
Two-pass VBR is not supported.</p>
</blockquote>
<p>Â </p>
<h3>Aspect Ratio</h3>
<p>The display aspect ratio and pixel aspect ratio (PAR) are related by the following formula:</p>
<!-- raw HTML omitted -->
<p>The encoder uses this formula to calculate the value of pel_aspect_ratio for MPEG-1 bitstreams or aspect_ratio_information for MPEG-2 bitstreams. (See ISO/IEC 11172 and ISO/IEC 138181-2, respectively.)</p>
<p>The encoder tries the following settings, in order:</p>
<ol>
<li>If the application sets the <a href="avencvideopixelaspectratio-property.html"><strong>AVEncVideoPixelAspectRatio</strong></a> property at any time before the filter graph runs, this property is used for the PAR.</li>
<li>Otherwise, if the <strong>dwPictAspectRatioX</strong> and <strong>dwPictAspectRatioY</strong> members of the <a href="/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2"><strong>VIDEOINFOHEADER2</strong></a> structure are non-zero, these members are used for the display aspect ratio, and the PAR is calculated from the display aspect ratio.</li>
<li>If none of these values is present, the PAR is assumed to be 1.0, and the display aspect ratio is calculated accordingly.</li>
</ol>
<p>In live encoding mode (<a href="avenccommonqualityvsspeed-property.html"><strong>AVEncCommonQualityVsSpeed</strong></a> equal to zero), the display aspect ratio must be either 4:3 or 16:9, with a default value of 4:3. If the computed display aspect ratio is not 4:3 or 16:9, the encoder uses the value 4:3.</p>
<h3>GOP Structure</h3>
<p>To specify the group of picture (GOP) structure, set the following properties in order:</p>
<ol>
<li><a href="avencmpvgopsize-property.html"><strong>AVEncMPVGOPSize</strong></a></li>
<li><a href="avencvideomaxkeyframedistance-property.html"><strong>AVEncVideoMaxKeyframeDistance</strong></a></li>
<li><a href="avencmpvdefaultbpicturecount-property.html"><strong>AVEncMPVDefaultBPictureCount</strong></a></li>
</ol>
<p>Based on these settings, the encoder produces one of the following GOP structures:</p>
<table>
<thead>
<tr>
<th><a href="avencvideomaxkeyframedistance-property.html"><strong>AVEncVideoMaxKeyframeDistance</strong></a></th>
<th><a href="avencmpvdefaultbpicturecount-property.html"><strong>AVEncMPVDefaultBPictureCount</strong></a></th>
<th>GOP Structure</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>IIII...</td>
</tr>
<tr>
<td><a href="avencmpvgopsize-property.html"><strong>AVEncMPVGOPSize</strong></a> - 1</td>
<td>0</td>
<td>IPPP...</td>
</tr>
<tr>
<td><a href="avencmpvgopsize-property.html"><strong>AVEncMPVGOPSize</strong></a> - 1</td>
<td>1</td>
<td>IBPBP...</td>
</tr>
<tr>
<td><a href="avencmpvgopsize-property.html"><strong>AVEncMPVGOPSize</strong></a> - 1</td>
<td>2</td>
<td>IBBPBBP...</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The default GOP structure is IBBPBBP... with a GOP size of 15 frames.</p>
<p>If the application constrains the target format to DVD (through the <a href="avenccommonformatconstraint-property.html"><strong>AVEncCommonFormatConstraint</strong></a> property) and sets the <a href="avencinputvideosystem-property.html"><strong>AVEncInputVideoSystem</strong></a> property to NTSC or PAL, the encoder supports the following GOP sizes:</p>
<table>
<thead>
<tr>
<th>Video System</th>
<th>Valid GOP Sizes</th>
<th>Default GOP Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>NTSC</td>
<td>1-18</td>
<td>18 (36 fields)</td>
</tr>
<tr>
<td>PAL</td>
<td>1-15</td>
<td>15 (30 fields)</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Codec Property Change Lists</h3>
<p>Setting the value of one codec property can change the valid range of another property. (For example, constraining the target format restricts the average bit rate.) Whenever the application sets a property, the encoder checks if any other properties now fall outside their valid range. If so, the encoder resets that property to its new default value. To receive notifications when this occurs, do the following:</p>
<ol>
<li>Call <a href="/windows/desktop/api/Strmif/nf-strmif-icodecapi-registerforevent"><strong>ICodecAPI::RegisterForEvent</strong></a> with the value <strong>CODECAPI_CHANGELISTS</strong>.</li>
<li>Use the <a href="/windows/desktop/api/Control/nn-control-imediaeventex"><strong>IMediaEventEx</strong></a> interface to monitor events from the filter graph.</li>
<li>If the range or default value of a property changes, the encoder sends an <a href="ec-codecapi-event.html"><strong>EC_CODECAPI_EVENT</strong></a> event with a list of changed properties.</li>
</ol>
<h3>IEncoderAPI Support</h3>
<p>For backward compatibility, the filter supports the following properties through the <strong>IEncoderAPI</strong> interface:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ENCAPIPARAM_BITRATE</strong></td>
<td>Equivalent to <a href="avenccommonmeanbitrate-property.html"><strong>AVEncCommonMeanBitRate</strong></a>.</td>
</tr>
<tr>
<td><strong>ENCAPIPARAM_PEAK_BITRATE</strong></td>
<td>Equivalent to <a href="avenccommonmaxbitrate-property.html"><strong>AVEncCommonMaxBitRate</strong></a>.</td>
</tr>
<tr>
<td><strong>ENCAPIPARAM_BITRATE_MODE</strong></td>
<td>Equivalent to <a href="avenccommonratecontrolmode-property.html"><strong>AVEncCommonRateControlMode</strong></a>.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>When setting the <strong>ENCAPIPARAM_BITRATE_MODE</strong> property, the values are mapped as follows:</p>
<table>
<thead>
<tr>
<th><strong>ENCAPIPARAM_BITRATE_MODE</strong></th>
<th><a href="avenccommonratecontrolmode-property.html"><strong>AVEncCommonRateControlMode</strong></a></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ConstantBitRate</strong></td>
<td><strong>eAVEncCommonRateControlMode_CBR</strong></td>
</tr>
<tr>
<td><strong>VariableBitRateAverage</strong></td>
<td>See Note.</td>
</tr>
<tr>
<td><strong>VariableBitRatePeak</strong></td>
<td><strong>eAVEncCommonRateControlMode_PeakConstrainedVBR</strong></td>
</tr>
</tbody>
</table>
<p>Â </p>
<blockquote>
<p>[!Note]<br />
Currently, the MPEG-2 video encoder does not support the <strong>VariableBitRateAverage</strong> encoding mode. If you set this value, the encoder defaults to CBR encoding (<strong>eAVEncCommonRateControlMode_CBR</strong>).</p>
</blockquote>
<p>Â </p>
<p>When getting the <strong>ENCAPIPARAM_BITRATE_MODE</strong> property, the values are mapped as follows:</p>
<table>
<thead>
<tr>
<th><a href="avenccommonratecontrolmode-property.html"><strong>AVEncCommonRateControlMode</strong></a></th>
<th><strong>ENCAPIPARAM_BITRATE_MODE</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>eAVEncCommonRateControlMode_CBR</strong></td>
<td><strong>ConstantBitRate</strong></td>
</tr>
<tr>
<td><strong>eAVEncCommonRateControlMode_Quality</strong></td>
<td><strong>VariableBitRatePeak</strong></td>
</tr>
<tr>
<td><strong>eAVEncCommonRateControlMode_PeakConstrainedVBR</strong></td>
<td><strong>VariableBitRatePeak</strong></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Limitations</h3>
<p>Currently the encoder does not support any of the following features:</p>
<ul>
<li>Generation of packetized elementary stream (PES) packets.</li>
<li>Frame-rate conversion. The input stream must have a frame rate that is valid for an MPEG-2 bitstream.</li>
<li>Frame-rate extensions for MPEG-2 (<strong>frame_rate_extension_n</strong>, <strong>frame_rate_extension_d</strong>).</li>
<li>Entry/exit buffer (VBV) positions for a clip.</li>
<li>Insertion of line-21 data (Closed Caption information) into the video elementary stream.</li>
<li>Setting the 25-bit <strong>time_code</strong> field in the GOP header for MPEG-2.</li>
<li>Denoise filter.</li>
<li>Digital rights management (DRM).</li>
</ul>
<p>The encoder introduces an encoding latency of at least one GOP.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista Home Premium, WindowsÂ Vista Ultimate, WindowsÂ 7 Home Premium, WindowsÂ 7 Professional, WindowsÂ 7 Enterprise, WindowsÂ 7 Ultimate [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wmcodecdsp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="directshow-filters.html">DirectShow Filters</a></p>
<!-- raw HTML omitted -->
<p><a href="mpeg-2-demultiplexer-media-types.html"><strong>MPEG-2 Demultiplexer Media Types</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
