<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CBasePin class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The CBasePin class is an abstract class that implements a generic pin.
ms.assetid: 23b9a0e2-24fe-4ff9-b2bb-97630c237de9
title: CBasePin class (Amfilter.h)
ms.topic: reference
ms.date: 4/26/2023
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>CBasePin
api_type:</li>
<li>COM
api_location:</li>
<li>Strmbase.lib</li>
<li>Strmbase.dll</li>
<li>Strmbasd.lib</li>
<li>Strmbasd.dll
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>CBasePin class</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p><img src="images/filter02.png" alt="cbasepin class hierarchy" /></p>
<p>The <code>CBasePin</code> class is an abstract class that implements a generic pin.</p>
<p>The following topics describe how to use this class:</p>
<ul>
<li><a href="cbasepin-connection-process.html">CBasePin Connection Process</a></li>
<li><a href="notifying-cbasepin-of-filter-state-changes.html">Notifying CBasePin of Filter State Changes</a></li>
<li><a href="deriving-from-cbasepin.html">Deriving from CBasePin</a></li>
</ul>
<table>
<thead>
<tr>
<th>Protected Member Variables</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="cbasepin-m-pname.html"><strong>m_pName</strong></a></td>
<td>Pin name.</td>
</tr>
<tr>
<td><a href="cbasepin-m-connected.html"><strong>m_Connected</strong></a></td>
<td>Pointer to the pin that is connected to this pin.</td>
</tr>
<tr>
<td><a href="cbasepin-m-dir.html"><strong>m_dir</strong></a></td>
<td>Direction of the pin.</td>
</tr>
<tr>
<td><a href="cbasepin-m-plock.html"><strong>m_pLock</strong></a></td>
<td>Pointer to a critical section object.</td>
</tr>
<tr>
<td><a href="cbasepin-m-bruntimeerror.html"><strong>m_bRunTimeError</strong></a></td>
<td>Flag that indicates whether a run-time error has occurred.</td>
</tr>
<tr>
<td><a href="cbasepin-m-bcanreconnectwhenactive.html"><strong>m_bCanReconnectWhenActive</strong></a></td>
<td>Flag that indicates whether the pin supports dynamic reconnection.</td>
</tr>
<tr>
<td><a href="cbasepin-m-btrymytypesfirst.html"><strong>m_bTryMyTypesFirst</strong></a></td>
<td>Flag that indicates whether the pin tries its own preferred media types before those of the receiving pin.</td>
</tr>
<tr>
<td><a href="cbasepin-m-pfilter.html"><strong>m_pFilter</strong></a></td>
<td>Pointer to the filter that created the pin.</td>
</tr>
<tr>
<td><a href="cbasepin-m-pqsink.html"><strong>m_pQSink</strong></a></td>
<td>Pointer to the object that handles quality messages.</td>
</tr>
<tr>
<td><a href="cbasepin-m-typeversion.html"><strong>m_TypeVersion</strong></a></td>
<td>Current version of the set of preferred media types.</td>
</tr>
<tr>
<td><a href="cbasepin-m-mt.html"><strong>m_mt</strong></a></td>
<td>Media type for the current pin connection.</td>
</tr>
<tr>
<td><a href="cbasepin-m-tstart.html"><strong>m_tStart</strong></a></td>
<td>Segment start time.</td>
</tr>
<tr>
<td><a href="cbasepin-m-tstop.html"><strong>m_tStop</strong></a></td>
<td>Segment stop time.</td>
</tr>
<tr>
<td><a href="cbasepin-m-drate.html"><strong>m_dRate</strong></a></td>
<td>Segment rate.</td>
</tr>
<tr>
<td>Protected Methods</td>
<td>Description</td>
</tr>
<tr>
<td><a href="cbasepin-displaypininfo.html"><strong>DisplayPinInfo</strong></a></td>
<td>Traces a pin connection during debugging.</td>
</tr>
<tr>
<td><a href="cbasepin-displaytypeinfo.html"><strong>DisplayTypeInfo</strong></a></td>
<td>Displays media type information during debugging.</td>
</tr>
<tr>
<td><a href="cbasepin-attemptconnection.html"><strong>AttemptConnection</strong></a></td>
<td>Connects to another pin using a specified media type.</td>
</tr>
<tr>
<td><a href="cbasepin-trymediatypes.html"><strong>TryMediaTypes</strong></a></td>
<td>Given a list of media types, tries to complete a connection using one of those types.</td>
</tr>
<tr>
<td><a href="cbasepin-agreemediatype.html"><strong>AgreeMediaType</strong></a></td>
<td>Searches for a media type to make a pin connection.</td>
</tr>
<tr>
<td><a href="cbasepin-disconnectinternal.html"><strong>DisconnectInternal</strong></a></td>
<td>Breaks the current pin connection.</td>
</tr>
<tr>
<td>Public Methods</td>
<td>Description</td>
</tr>
<tr>
<td><a href="cbasepin-cbasepin.html"><strong>CBasePin</strong></a></td>
<td>Constructor method.</td>
</tr>
<tr>
<td><a href="cbasepin--cbasepin.html">**~ CBasePin**</a></td>
<td>Destructor method. Virtual.</td>
</tr>
<tr>
<td><a href="cbasepin-isconnected.html"><strong>IsConnected</strong></a></td>
<td>Determines whether the pin is connected to another pin.</td>
</tr>
<tr>
<td><a href="cbasepin-getconnected.html"><strong>GetConnected</strong></a></td>
<td>Retrieves the pin that is connected to this pin.</td>
</tr>
<tr>
<td><a href="cbasepin-isstopped.html"><strong>IsStopped</strong></a></td>
<td>Determines whether the filter containing this pin is stopped.</td>
</tr>
<tr>
<td><a href="cbasepin-getmediatypeversion.html"><strong>GetMediaTypeVersion</strong></a></td>
<td>Retrieves a version number for the set of preferred media types. Virtual.</td>
</tr>
<tr>
<td><a href="cbasepin-incrementtypeversion.html"><strong>IncrementTypeVersion</strong></a></td>
<td>Increments the version number on the set of preferred media types.</td>
</tr>
<tr>
<td><a href="cbasepin-active.html"><strong>Active</strong></a></td>
<td>Notifies the pin that the filter is now active. Virtual.</td>
</tr>
<tr>
<td><a href="cbasepin-inactive.html"><strong>Inactive</strong></a></td>
<td>Notifies the pin that the filter is no longer active. Virtual.</td>
</tr>
<tr>
<td><a href="cbasepin-run.html"><strong>Run</strong></a></td>
<td>Notifies the pin that the filter is now running. Virtual.</td>
</tr>
<tr>
<td><a href="cbasepin-setmediatype.html"><strong>SetMediaType</strong></a></td>
<td>Sets the media type for the connection. Virtual.</td>
</tr>
<tr>
<td><a href="cbasepin-checkconnect.html"><strong>CheckConnect</strong></a></td>
<td>Determines whether a pin connection is suitable. Virtual.</td>
</tr>
<tr>
<td><a href="cbasepin-breakconnect.html"><strong>BreakConnect</strong></a></td>
<td>Releases the pin from a connection. Virtual.</td>
</tr>
<tr>
<td><a href="cbasepin-completeconnect.html"><strong>CompleteConnect</strong></a></td>
<td>Completes a connection to another pin. Virtual.</td>
</tr>
<tr>
<td><a href="cbasepin-getmediatype.html"><strong>GetMediaType</strong></a></td>
<td>Retrieves a preferred media type, by index value. Virtual.</td>
</tr>
<tr>
<td><a href="cbasepin-currentstoptime.html"><strong>CurrentStopTime</strong></a></td>
<td>Retrieves the segment stop time.</td>
</tr>
<tr>
<td><a href="cbasepin-currentstarttime.html"><strong>CurrentStartTime</strong></a></td>
<td>Retrieves the segment start time.</td>
</tr>
<tr>
<td><a href="cbasepin-currentrate.html"><strong>CurrentRate</strong></a></td>
<td>Retrieves the segment rate.</td>
</tr>
<tr>
<td><a href="cbasepin-name.html"><strong>Name</strong></a></td>
<td>Retrieves the pin identifier.</td>
</tr>
<tr>
<td><a href="cbasepin-setreconnectwhenactive.html"><strong>SetReconnectWhenActive</strong></a></td>
<td>Specifies whether the pin supports dynamic reconnections.</td>
</tr>
<tr>
<td><a href="cbasepin-canreconnectwhenactive.html"><strong>CanReconnectWhenActive</strong></a></td>
<td>Queries whether the pin supports dynamic reconnections.</td>
</tr>
<tr>
<td>Pure Virtual Methods</td>
<td>Description</td>
</tr>
<tr>
<td><a href="cbasepin-checkmediatype.html"><strong>CheckMediaType</strong></a></td>
<td>Determines if the pin accepts a specific media type.</td>
</tr>
<tr>
<td>IPin Methods</td>
<td>Description</td>
</tr>
<tr>
<td><a href="cbasepin-connect.html"><strong>Connect</strong></a></td>
<td>Connects the pin to another pin.</td>
</tr>
<tr>
<td><a href="cbasepin-receiveconnection.html"><strong>ReceiveConnection</strong></a></td>
<td>Accepts a connection from another pin.</td>
</tr>
<tr>
<td><a href="cbasepin-disconnect.html"><strong>Disconnect</strong></a></td>
<td>Breaks the current pin connection.</td>
</tr>
<tr>
<td><a href="cbasepin-connectedto.html"><strong>ConnectedTo</strong></a></td>
<td>Retrieves the pin connected to this pin.</td>
</tr>
<tr>
<td><a href="cbasepin-connectionmediatype.html"><strong>ConnectionMediaType</strong></a></td>
<td>Retrieves the media type for the current pin connection, if any.</td>
</tr>
<tr>
<td><a href="cbasepin-querypininfo.html"><strong>QueryPinInfo</strong></a></td>
<td>Retrieves information about the pin.</td>
</tr>
<tr>
<td><a href="cbasepin-querydirection.html"><strong>QueryDirection</strong></a></td>
<td>Retrieves the direction of the pin (input or output).</td>
</tr>
<tr>
<td><a href="cbasepin-queryid.html"><strong>QueryId</strong></a></td>
<td>Retrieves the pin identifier.</td>
</tr>
<tr>
<td><a href="cbasepin-queryaccept.html"><strong>QueryAccept</strong></a></td>
<td>Determines whether the pin accepts a specified media type.</td>
</tr>
<tr>
<td><a href="cbasepin-enummediatypes.html"><strong>EnumMediaTypes</strong></a></td>
<td>Enumerates the pin's preferred media types.</td>
</tr>
<tr>
<td><a href="cbasepin-queryinternalconnections.html"><strong>QueryInternalConnections</strong></a></td>
<td>Retrieves the pins that are connected internally to this pin (within the filter).</td>
</tr>
<tr>
<td><a href="cbasepin-endofstream.html"><strong>EndOfStream</strong></a></td>
<td>Notifies the pin that no additional data is expected.</td>
</tr>
<tr>
<td><a href="cbasepin-newsegment.html"><strong>NewSegment</strong></a></td>
<td>Notifies the pin that media samples received after this call are grouped as a segment.</td>
</tr>
<tr>
<td>IQualityControl Methods</td>
<td>Description</td>
</tr>
<tr>
<td><a href="cbasepin-notify.html"><strong>Notify</strong></a></td>
<td>Notifies the pin that a quality change is requested.</td>
</tr>
<tr>
<td><a href="cbasepin-setsink.html"><strong>SetSink</strong></a></td>
<td>Sets an external quality manager.</td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Amfilter.h (include Streams.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbase.lib (retail builds); <!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbasd.lib (debug builds)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
