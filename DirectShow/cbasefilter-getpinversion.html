<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CBaseFilter.GetPinVersion method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The GetPinVersion method retrieves a version number for the set of pins on this filter.
ms.assetid: 6cc186b2-4d9f-4d1c-a8b3-975e9c248df7
title: CBaseFilter.GetPinVersion method (Amfilter.h)
ms.topic: reference
ms.date: 4/26/2023
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>CBaseFilter.GetPinVersion
api_type:</li>
<li>COM
api_location:</li>
<li>Strmbase.lib</li>
<li>Strmbase.dll</li>
<li>Strmbasd.lib</li>
<li>Strmbasd.dll
ms.custom: UpdateFrequency5</li>
</ul>
<hr />
<h1>CBaseFilter.GetPinVersion method</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The <code>GetPinVersion</code> method retrieves a version number for the set of pins on this filter.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>virtual long GetPinVersion();
</code></pre>
<h2>Parameters</h2>
<p>This method has no parameters.</p>
<h2>Return value</h2>
<p>Returns the <a href="cbasefilter-m-pinversion.html"><strong>CBaseFilter::m_PinVersion</strong></a> member variable.</p>
<h2>Remarks</h2>
<p>The <strong>CBaseFilter</strong> constructor initializes the pin version to 1. In the base class, this number never changes. If the filter dynamically creates or destroys pins, it should increment the pin version whenever the pins change. To increment the version number, call the <a href="cbasefilter-incrementpinversion.html"><strong>CBaseFilter::IncrementPinVersion</strong></a> method.</p>
<p>The pin enumerator object, which is implemented by the <a href="cenumpins.html"><strong>CEnumPins</strong></a> class, uses the pin version to keep itself synchronized with the filter.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Amfilter.h (include Streams.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbase.lib (retail builds); <!-- raw HTML omitted --> <!-- raw HTML omitted -->Strmbasd.lib (debug builds)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cbasefilter.html"><strong>CBaseFilter Class</strong></a></p>
<!-- raw HTML omitted -->
</body>
