<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Certified Output Protection Protocol (COPP)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Using Certified Output Protection Protocol (COPP)
ms.assetid: 23eebe93-416b-48c8-a05f-019e38b9a660
title: Using Certified Output Protection Protocol (COPP)
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>Using Certified Output Protection Protocol (COPP)</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>Certified Output Protection Protocol (COPP) enables an application to protect a video stream as it travels from the graphics adapter to the display device. An application can use COPP to discover what kind of physical connector is attached to the display device, and what types of output protection are available. Protection mechanisms include the following:</p>
<ul>
<li>High-Bandwidth Digital Content Protection (HDCP)</li>
<li>Copy Generation Management System â€” Analog (CGMS-A)</li>
<li>Analog Copy Protection (ACP)</li>
</ul>
<p>If the graphics adapter supports one of these mechanisms, the application can use COPP to set the protection level.</p>
<p>COPP defines a protocol that is used to establish a secure communications channel with the graphics driver. It uses Message Authentication Codes (MACs) to verify the integrity of the COPP commands that are passed between the application and the display driver. The application uses COPP by calling methods on the <a href="/windows/desktop/api/Strmif/nn-strmif-iamcertifiedoutputprotection"><strong>IAMCertifiedOutputProtection</strong></a> interface of the DirectShow Video Mixing Renderer filter (VMR-7 or VMR-9).</p>
<p>COPP does not define anything about the digital rights policies that might apply to digital media content. Also, COPP itself does not implement any output protection systems. The COPP protocol simply provides a way to set and query protection levels on the graphics adapter, using the protection systems provided by the adapter.</p>
<p>This section assumes that you are familiar with the following technologies:</p>
<ul>
<li>DirectShow</li>
<li>Windows Media Format SDK</li>
<li>XML</li>
<li>Public-key cryptography and symmetric cryptography</li>
</ul>
<p>The code examples in this section use Microsoft's CryptoAPI to perform cryptographic operations. This section contains the following topics:</p>
<ul>
<li><a href="overview-of-copp.html">Overview of COPP</a></li>
<li><a href="obtaining-the-drivers-certificate-chain.html">Obtaining the Driver's Certificate Chain</a></li>
<li><a href="validating-the-certificate-chain.html">Validating the Certificate Chain</a></li>
<li><a href="certificate-revocation-lists.html">Certificate Revocation Lists</a></li>
<li><a href="importing-the-drivers-public-key.html">Importing the Driver's Public Key</a></li>
<li><a href="initiating-a-copp-session.html">Initiating a COPP Session</a></li>
<li><a href="sending-copp-status-requests.html">Sending COPP Status Requests</a></li>
<li><a href="sending-copp-commands.html">Sending COPP Commands</a></li>
<li><a href="testing-whether-a-graphics-driver-supports-copp.html">Testing Whether a Graphics Driver Supports COPP</a></li>
<li><a href="copp-query-reference.html">COPP Query Reference</a></li>
<li><a href="copp-command-reference.html">COPP Command Reference</a></li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="using-the-video-mixing-renderer.html">Using the Video Mixing Renderer</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
