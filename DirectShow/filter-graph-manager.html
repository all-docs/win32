<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Filter Graph Manager</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Filter Graph Manager
ms.assetid: 'b1a53193-27c6-4e86-a5b9-f3c1e4401690'
title: Filter Graph Manager
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>Filter Graph Manager</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>The Filter Graph Manager builds and controls filter graphs. This object is the central component in DirectShow. Applications use it to build and control filter graphs. The Filter Graph Manager also handles synchronization, event notification, and other aspects of the controlling the filter graph. Create this object by calling <strong>CoCreateInstance</strong>.</p>
<h3>CLSID</h3>
<p>There are two CLSIDs for creating the Filter Graph Manager:</p>
<table>
<thead>
<tr>
<th>CLSID</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>CLSID_FilterGraph</td>
<td>Creates the Filter Graph Manager on a shared worker thread.</td>
</tr>
<tr>
<td>CLSID_FilterGraphNoThread</td>
<td>Creates the Filter Graph Manager on the application thread.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Generally, applications should use CLSID_FilterGraph. Both CLSIDs create the same object, but they use different threading models:</p>
<ul>
<li>CLSID_FilterGraph creates the Filter Graph Manager on a worker thread, which is shared by all CLSID_FilterGraph instances within the same process. The thread dispatches messages sent by filters, and controls the lifetime of any windows created by filters.</li>
<li>CLSID_FilterGraphNoThread creates the Filter Graph Manager on the application's thread. If you use this CLSID, the thread that calls <strong>CoCreateInstance</strong> must have a message loop that dispatches messages; otherwise, deadlocks can occur. Also, before the application thread exits, it must release the Filter Graph Manager and all graph objects (such as filters, pins, reference clocks, and so forth).</li>
</ul>
<h3>Interfaces</h3>
<p>The Filter Graph Manager exposes the following interfaces:</p>
<ul>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-iamgraphstreams"><strong>IAMGraphStreams</strong></a></li>
<li><a href="/windows/desktop/api/Control/nn-control-iamstats"><strong>IAMStats</strong></a></li>
<li><a href="/windows/desktop/api/Control/nn-control-ibasicaudio"><strong>IBasicAudio</strong></a></li>
<li><a href="/windows/desktop/api/Control/nn-control-ibasicvideo"><strong>IBasicVideo</strong></a></li>
<li><a href="/windows/desktop/api/Control/nn-control-ibasicvideo2"><strong>IBasicVideo2</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-ifilterchain"><strong>IFilterChain</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-ifiltergraph"><strong>IFilterGraph</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-ifiltergraph2"><strong>IFilterGraph2</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-ifiltergraph3"><strong>IFilterGraph3</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-ifiltermapper2"><strong>IFilterMapper2</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-igraphbuilder"><strong>IGraphBuilder</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-igraphconfig"><strong>IGraphConfig</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-igraphversion"><strong>IGraphVersion</strong></a></li>
<li><a href="/windows/desktop/api/Control/nn-control-imediacontrol"><strong>IMediaControl</strong></a></li>
<li><a href="/windows/desktop/api/Control/nn-control-imediaevent"><strong>IMediaEvent</strong></a></li>
<li><a href="/windows/desktop/api/Control/nn-control-imediaeventex"><strong>IMediaEventEx</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-imediaeventsink"><strong>IMediaEventSink</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-imediafilter"><strong>IMediaFilter</strong></a></li>
<li><a href="/windows/desktop/api/Control/nn-control-imediaposition"><strong>IMediaPosition</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-imediaseeking"><strong>IMediaSeeking</strong></a></li>
<li><a href="/windows/desktop/api/Control/nn-control-iqueuecommand"><strong>IQueueCommand</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-iregisterserviceprovider"><strong>IRegisterServiceProvider</strong></a></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-iresourcemanager"><strong>IResourceManager</strong></a></li>
<li><strong>IServiceProvider</strong></li>
<li><a href="/windows/desktop/api/Strmif/nn-strmif-ivideoframestep"><strong>IVideoFrameStep</strong></a></li>
<li><a href="/windows/desktop/api/Control/nn-control-ivideowindow"><strong>IVideoWindow</strong></a></li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="directshow-objects.html">DirectShow Objects</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
