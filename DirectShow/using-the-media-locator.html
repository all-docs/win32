<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using the Media Locator</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Using the Media Locator
ms.assetid: 07840a37-7065-41e8-aee5-855c9f89fb77
title: Using the Media Locator
ms.topic: article
ms.date: 4/26/2023
ms.custom: UpdateFrequency5</h2>
<h1>Using the Media Locator</h1>
<p>[The feature associated with this page, <a href="/windows/win32/directshow/directshow">DirectShow</a>, is a legacy feature. It has been superseded by <a href="/uwp/api/Windows.Media.Playback.MediaPlayer">MediaPlayer</a>, <a href="/windows/win32/api/mfmediaengine/nn-mfmediaengine-imfmediaengine">IMFMediaEngine</a>, and <a href="/windows/win32/medfound/audio-video-capture-in-media-foundation">Audio/Video Capture in Media Foundation</a>. Those features have been optimized for Windows 10 and Windows 11. Microsoft strongly recommends that new code use <strong>MediaPlayer</strong>, <strong>IMFMediaEngine</strong> and <strong>Audio/Video Capture in Media Foundation</strong> instead of <strong>DirectShow</strong>, when possible. Microsoft suggests that existing code that uses the legacy APIs be rewritten to use the new APIs if possible.]</p>
<p>[This API is not supported and may be altered or unavailable in the future.]</p>
<p>The media locator is a helper object that verifies file names and searches for missing files on local or network directories. The media detector keeps a cache of directory paths where it has successfully found files in past searches. To locate a file, it searches the directories in its cache. Failing that, the media detector can display an Open File dialog for the user to locate a file manually. Assuming the user locates the file, the media locator adds the new directory to its cache. The media locator exposes the <a href="imedialocator.html"><strong>IMediaLocator</strong></a> interface.</p>
<p>Typically, your application does not directly create an instance of the media locator. Instead, the timeline and the render engine provide the following methods for validating file names using the media detector.</p>
<ul>
<li>To validate file names in the timeline, call <a href="iamtimeline-validatesourcenames.html"><strong>IAMTimeline::ValidateSourceNames</strong></a>. Optionally, this method also updates the source objects with the correct file names.</li>
<li>To validate file names when the project is rendered, call <a href="irenderengine-setsourcenamevalidation.html"><strong>IRenderEngine::SetSourceNameValidation</strong></a>.</li>
</ul>
<p>Both methods take flags that control the behavior of the media locator. For example, you can restrict the search to local directories.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="working-with-sources.html">Working with Sources</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
