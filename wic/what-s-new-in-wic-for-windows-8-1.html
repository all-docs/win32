<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>What's New in WIC</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Windows Imaging Component (WIC) has been updated with new releases of Windows. This topic provides a quick introduction to these new features.
ms.assetid: 710B71CE-6FCC-46DA-A65C-6E4FC6A04275
title: What's New in WIC
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>What's New in WIC</h1>
<p>Windows Imaging Component (WIC) has been updated with new releases of Windows. This topic provides a quick introduction to these new features.</p>
<h2>What's new for Windows 10, version 1507</h2>
<h3>Access to low level JPEG data for WIC decoding and encoding</h3>
<p>Starting in WindowsÂ 10, version 1507, WIC provides access to low level JPEG data structures, including Huffman and quantization tables. For more information, see the following topics:</p>
<ul>
<li><a href="/windows/win32/api/Wincodec/nn-wincodec-iwicjpegframedecode"><strong>IWICJpegFrameDecode</strong></a> interface</li>
<li><a href="/windows/win32/api/Wincodec/nn-wincodec-iwicjpegframeencode"><strong>IWICJpegFrameEncode</strong></a> interface</li>
</ul>
<h3>JPEG indexing</h3>
<p>JPEG indexing is a technique that significantly improves the performance of randomly accessing small sub regions of a large JPEG image, at the cost of some additional memory usage. JPEG indexing can be leveraged by any caller of WIC.</p>
<p>The <a href="/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesourcefromwic"><strong>ID2D1ImageSourceFromWic</strong></a> interface is designed to leverage JPEG indexing if it is turned on. For example, the ID2D1ImageSource API will only request the needed sections of the image in a scenario such as pan and zoom for a large resolution image. For more information, see the following topics:</p>
<ul>
<li><a href="/windows/win32/api/Wincodec/nf-wincodec-iwicjpegframedecode-setindexing"><strong>IWICJpegFrameDecode::SetIndexing</strong></a> method</li>
<li><a href="/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesourcefromwic"><strong>ID2D1ImageSourceFromWic</strong></a> interface</li>
</ul>
<h2>What's new for Windows 8.1</h2>
<h3>Support for JPEG YCbCr images</h3>
<p>Starting in WindowsÂ 8.1, WIC provides support for decoding, transforming and encoding JPEG Y'CbCr image data in its native format. This allows apps to significantly decrease processing time and memory consumption for certain imaging operations when working with Y'CbCr encoded JPEGs. For more information, see the following topics:</p>
<ul>
<li><a href="-wic-sample-d2d-viewer.html">Direct2D</a><a href="../direct2d/ycbcr-effect.html">YCbCr effect</a></li>
<li><a href="/windows/win32/api/Wincodec/nn-wincodec-iwicplanarbitmapsourcetransform"><strong>IWICPlanarBitmapSourceTransform</strong></a> interface</li>
<li><a href="/windows/win32/api/Wincodec/nn-wincodec-iwicplanarbitmapframeencode"><strong>IWICPlanarBitmapFrameEncode</strong></a> interface</li>
</ul>
<h3>Support for block compressed formats (DDS files)</h3>
<p>Starting in WindowsÂ 8.1, WIC adds a new codec that supports DDS images encoded in the following formats: DXGI_FORMAT_BC1_UNORM, DXGI_FORMAT_BC2_UNORM, and DXGI_FORMAT_BC3_UNORM. DDS block compressed data can be accessed in a decoded form using standard WIC interfaces, or directly accessed using new DDS specific interfaces. For more information, see the following topics:</p>
<ul>
<li><a href="/windows/win32/api/Wincodec/nn-wincodec-iwicddsdecoder"><strong>IWICDdsDecoder</strong></a> interface</li>
<li><a href="/windows/win32/api/Wincodec/nn-wincodec-iwicddsencoder"><strong>IWICDdsEncoder</strong></a> interface</li>
</ul>
<h2>What's new for Windows 8</h2>
<p>In WindowsÂ 8, WIC has been updated with several new features. The updated version of WIC is also available on WindowsÂ 7 and Windows ServerÂ 2008Â R2 via the <a href="../direct3darticles/platform-update-for-windows-7.html">Platform Update for Windows 7</a>, which is available through the <a href="https://support.microsoft.com/kb/2670838">Platform Update for Windows 7</a>.</p>
<h3>Improved Direct2D integration</h3>
<p>WIC in WindowsÂ 8 provides these APIs to improve Direct2D integration with WIC:</p>
<ul>
<li><a href="/windows/win32/api/Wincodec/nn-wincodec-iwicimageencoder"><strong>IWICImageEncoder</strong></a> - A new interface which can encode Direct2D<a href="/windows/win32/api/d2d1/nn-d2d1-id2d1image"><strong>ID2D1Image</strong></a> content to an <a href="-wic-imp-iwicbitmapframeencode.html">IWICBitmapFrameEncode</a>. The methods of this interface take a pointer to <a href="/windows/win32/api/Wincodec/ns-wincodec-wicimageparameters"><strong>WICImageParameters</strong></a>, which are parameters to control encoding.</li>
<li><a href="/windows/win32/api/Wincodec/nn-wincodec-iwicimagingfactory2"><strong>IWICImagingFactory2</strong></a> - New WIC factory with the <a href="/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory2-createimageencoder"><strong>CreateImageEncoder</strong></a> method. This interface inherits from the original WIC factory, <a href="/windows/win32/api/Wincodec/nn-wincodec-iwicimagingfactory"><strong>IWICImagingFactory</strong></a>, and is created the same way.</li>
</ul>
<h3>Changes to BMP codec alpha support</h3>
<p>WIC in WindowsÂ 8 supports loading <a href="/windows/win32/api/wingdi/ns-wingdi-bitmapv5header"><strong>BITMAPV5HEADER</strong></a> image files as <a href="-wic-codec-native-pixel-formats.html">WICPixelFormat32bppBGRA</a>-formatted images. In addition, the BMP encoder supports a new Boolean ,encoder option &quot;EnableV5Header32bppBGRA&quot;, which instructs the encoder to write a <strong>BITMAPV5HEADER</strong> with the 32bppBGRA image data.</p>
<p>For more info about BMP formats, see <a href="bmp-format-overview.html">BMP Format Overview</a>.</p>
<h3>New pixel formats</h3>
<p>WIC in WindowsÂ 8 defines these new pixel formats:</p>
<ul>
<li>GUID_WICPixelFormat32bppRGB</li>
<li>GUID_WICPixelFormat64bppRGB</li>
<li>GUID_WICPixelFormat96bppRGBFloat</li>
<li>GUID_WICPixelFormat64bppPRGBAHalf</li>
</ul>
<blockquote>
<p>[!Note]<br />
The TIFF built-in codec will return GUID_WICPixelFormat96bppRGBFloat data. The other three formats are not used by built-in codecs.</p>
</blockquote>
<p>Â </p>
<h3>Restrictions to component extensibility in AppContainer</h3>
<p>When running in an AppContainer process, which includes all Windows Store apps, WIC will only use Windows-provided components, regardless of whether additional components are installed on the system. App that are not running in AppContainer are not affected.</p>
<p>Apps don't need to make any code changes to run in an AppContainger, but the <a href="/windows/win32/api/Wincodec/ne-wincodec-wiccomponentenumerateoptions"><strong>WICComponentEnumerateOptions</strong></a> flag and vendor GUID parameters will have no effect. WIC will fail to load an image if it cannot be decoded by a Windows provided codec, and calling the <a href="/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory-createcomponentenumerator"><strong>CreateComponentEnumerator</strong></a> method will only return Windows provided components.</p>
<h3>Changes to CLSID_WICPngDecoder and PNG decoder color context support</h3>
<p><strong>CLSID_WICPngDecoder1</strong> has been added with the same GUID as <strong>CLSID_WICPngDecoder</strong>, and <strong>CLSID_WICPngDecoder2</strong> has been added.</p>
<p>When compiled against the Windows 8 SDK, <strong>CLSID_WICPngDecoder</strong> is #defined to <strong>CLSID_WICPngDecoder2</strong> to promote newly compiled apps using the new PNG decoder behavior. Apps should continue to specify <strong>CLSID_WICPngDecoder</strong>.</p>
<p>Specifying <strong>CLSID_WICPngDecoder2</strong> will create a version of the WIC PNG decoder that will generate an <a href="/windows/win32/api/Wincodec/nn-wincodec-iwiccolorcontext"><strong>IWICColorContext</strong></a> from cHRM and gAMA chunks. This allows this color space metadata to be used with other Windows APIs for color managing the source image. An <strong>IWICColorContext</strong> is not generated from the gAMA and cHRM chunks if an iCCP chunk is present, if an sRGB chunk is present, or if the gAMA and cHRM chunks indicate an sRGB color space.</p>
<p>An app can specify <strong>CLSID_WICPngDecoder1</strong> to create a version of the WIC PNG decoder that does not generate an <a href="/windows/win32/api/Wincodec/nn-wincodec-iwiccolorcontext"><strong>IWICColorContext</strong></a> from the gAMA and cHRM chunks. This matches the behavior of the PNG decoder in previous versions of Windows.</p>
<h3>Changes to WINCODEC_SDK_VERSION</h3>
<p>When compiled against the WindowsÂ 8 SDK, <strong>WINCODEC_SDK_VERSION</strong> is #defined to <strong>WINCODEC_SDK_VERSION2</strong> to promote newly compiled apps using the new PNG decoder behavior. Otherwise, it is #defined to <strong>WINCODEC_SDK_VERSION1</strong>. Apps should continue to specify <strong>WINCODEC_SDK_VERSION</strong>.</p>
<p>Specifying <strong>WINCODEC_SDK_VERSION</strong> when calling <a href="-wic-codec-wiccreateimagingfactory-proxy.html"><strong>WICCreateImagingFactory_Proxy</strong></a> to create the imaging factory causes <strong>CLSID_WICPngDecoder2</strong> to be created instead of <strong>CLSID_WICPngDecoder1</strong> from the <a href="/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory-createdecoder"><strong>CreateDecoder</strong></a> method and its variants. Also, a decoder component info enumerator will return <strong>CLSID_WICPngDecoder2</strong> component info, but not <strong>CLSID_WICPngDecoder1</strong> info.</p>
<p>Specifying <strong>WINCODEC_SDK_VERSION1</strong> will cause <strong>CLSID_WICPngDecoder1</strong> to be used instead of <strong>CLSID_WICPngDecoder2</strong> in the above cases.</p>
<h3>Changes to CLSID_WICImagingFactory</h3>
<p><strong>CLSID_WICImagingFactory1</strong> has been added with the same GUID as <strong>CLSID_WICImagingFactory</strong>, and <strong>CLSID_WICImagingFactory2</strong> has been added.</p>
<p>When compiled against the Windows 8 SDK, <strong>CLSID_WICImagingFactory</strong> is #defined to <strong>CLSID_WICImagingFactory2</strong> to promote newly compiled apps using the new PNG decoder behavior. Apps should continue to specify <strong>CLSID_WICImagingFactory</strong>.</p>
<p>Specifying <strong>CLSID_WICImagingFactory2</strong> when calling <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> to create the imaging factory causes <strong>CLSID_WICPngDecoder2</strong> to be created instead of <strong>CLSID_WICPngDecoder1</strong> from the <a href="/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory-createdecoder"><strong>CreateDecoder</strong></a> method and its variants. Also, a decoder component info enumerator will return <strong>CLSID_WICPngDecoder2</strong> component info, but not <strong>CLSID_WICPngDecoder1</strong> info.</p>
<p>Specifying <strong>CLSID_WICImagingFactory1</strong> will cause <strong>CLSID_WICPngDecoder1</strong> to be used instead of <strong>CLSID_WICPngDecoder2</strong> in the above cases.</p>
<h2>What's new for Windows 7</h2>
<p>In WindowsÂ 7, WIC has been updated with several new features. This topic provides a quick introduction to these new features.</p>
<h3>Updates to the TIFF Codec</h3>
<p>The WIC TIFF codec has been updated for WindowsÂ 7 to support several features not supported by the previous version of WIC.</p>
<ul>
<li>Support for large TIFF files.</li>
<li>Decode tiled TIFF images.</li>
<li>Decode flat (planar) TIFF images.</li>
<li>Decode JPEG encoded TIFF images.</li>
</ul>
<h3>Progressive Decoding</h3>
<p>Progressive decoding provides the ability to incrementally decode and render portions of an image before the entire image has finished downloading. This feature greatly improves the user experience when viewing images from the Internet, because the user does not have to wait for the entire image to download before decoding can begin. With progressive decoding, users are able to see an image preview with available data long before the entire image is downloaded. This feature is essential for any application used to view images from the Internet or from data sources with limited bandwidth.</p>
<p>For more information, see the <a href="-wic-progressive-decoding.html">Progressive Decoding Overview</a>.</p>
<h3>Extended Metadata Support for JPEG, PNG, and GIF</h3>
<p>In WindowsÂ 7, WIC has extended its metadata support for JPEG, PNG, and GIF images.</p>
<ul>
<li>Added support for animated GIF and GIF properties.</li>
<li>Expanded JPG metadata handlers to support chrominance, luminance, and comment metadata.</li>
<li>Expanded PNG metadata handlers to support tIME, sRGB, iCCP, hIST, cHRM, iTXt, bKGD, and gAMA metadata.</li>
<li>Added new 8BIM metadata handlers for ResolutionInfo metadata and IPTC digest metadata.</li>
<li>Added new metadata handlers for Logical Screen Descriptor (LSD), Image Descriptor (IMD), Graphic Control Extensions (GCE), and Application Extensions (APE) metadata.</li>
<li>Support for metadata that spans APPn blocks.</li>
</ul>
<h3>Multi Threaded Apartment Support</h3>
<p>Objects within a multithreaded apartment (MTA) may be called concurrently by any number of threads within the MTA, allowing for better performance on multicore systems and certain server scenarios. In addition, WIC codecs that live within an MTA can call other objects that live within the MTA without the marshaling cost associated of calling between threads that live in different STA apartments. In WindowsÂ 7, all in-box WIC codecs have been updated to support MTA, including JPEG, TIFF, PNG, GIF, ICO, and BMP. It is highly recommended that codecs be written to support MTA. Codecs that do not support MTA will cause significant performance degredation in multithreaded applications due to marshaling. Enabling MTA support requires proper synchronization to be implemented in the codec. Exact implementation of these synchronization techniques is beyond the scope of this paper. A general reference for synchronizing Component Object Model (COM) objects is provided below.</p>
<h3>Metadata Working Group Implementations</h3>
<p>There are currently a variety of metadata storage formats that contain overlapping properties, without any clear industry standard or guidance on consistent methods for reading and writing these metadata formats. To help with this variety of formats and properties, the Metadata Working Group (MWG) was formed. The aim of the MWG is to provide guidelines that ensure interoperability among a wide variety of platforms, applications, and devices. The guidelines established by the MWG apply to the XMP, Exif, and IPTC metadata fields, and to the JPEG, TIFF, and PSD image formats.</p>
<p>In WindowsÂ 7, the photo metadata handler and the metadata policy layer have been updated to read and write image metadata according to the guidelines established by the MWG. For more information on the Metadata Working Group (MWG), view the <a href="https://s3.amazonaws.com/software.tagthatphoto.com/docs/mwg_guidance.pdf">established metadata guidelines</a>.</p>
<h3>Windows 7 features supported on Windows Vista and Windows Server 2008</h3>
<p>The <a href="../win7ip/platform-update-for-windows-vista-portal.html">Platform Update for Windows Vista</a> is a set of run-time libraries that enables developers to target applications to both Windows 7 and Windows Vista. The Platform Update for Windows ServerÂ 2008 is a set of run-time libraries that enables developers to target applications to both Windows Server 2008 R2 and Windows Server 2008. The Platform Update for WindowsÂ Vista and the Platform Update for Windows ServerÂ 2008 will be available to all Windows Vista and Windows Server 2008 customers through Windows Update. Third-party applications that require Platform Update for WindowsÂ Vista or Platform Update for Windows ServerÂ 2008 can have Windows Update detect whether the required updated is installed; if it is not, Windows Update will download and install it in the background. For more information about both updates, see Platform Update for Windows Vista</p>
<p>Â </p>
<p>Â </p>
</body>
