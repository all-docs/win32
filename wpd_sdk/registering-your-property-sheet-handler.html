<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Registering Your Property Sheet Handler</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Registering Your Property Sheet Handler
ms.assetid: 6621529c-717b-4f36-8d9e-769d6b720b8a
title: Registering Your Property Sheet Handler
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Registering Your Property Sheet Handler</h1>
<p>In order for your property sheet handler to be recognized by the WPD namespace you must register it properly in the Windows registry. The registration entries for a WPD property sheet handler are similar to those for the shell, but they are registered as special file types. WPD property sheet handlers are registered according to the content type they represent. Below is a sample registration tree for a WPD context menu handler:</p>
<pre lang="C++"><code>HKEY_CLASSES_ROOT
 \-- WPDPropSheet.Image
      \-- shellex
           \-- PropertySheetHandlers
                \-- MyHandler (Default)  REG_SZ {0000000-0000-0000-0000-000000000000}

</code></pre>
<p>The above example registers a custom handler with the WPD namespace. When a user right-clicks an image file on a device through the Windows Shell and selects <strong>Properties</strong>, it invokes this property sheet handler. The WPD namespace uses the WPD_CONTENT_TYPE to determine which property sheet handlers to load. If the content type does not provide a useful classification, then the namespace will load the property sheet handlers under the <strong>WPDPropSheet.Generic registry</strong> key. The following table lists all of the file classes available to a context menu handler and what content types and file extensions they represent.</p>
<table>
<thead>
<tr>
<th>Registry Key</th>
<th>WPD Content Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>WPDContextMenu.Device</strong></td>
<td>Registering under this key enables your context menu handler at the device level. (Right-click on a device.)</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Storage</strong></td>
<td>Registering under this key enables your context menu handler at the storage level. (Right-click on a storage.)</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Folder</strong></td>
<td>WPD_CONTENT_TYPE_FOLDER</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Image</strong></td>
<td>WPD_CONTENT_TYPE_IMAGE</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Audio</strong></td>
<td>WPD_CONTENT_TYPE_AUDIO</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Video</strong></td>
<td>WPD_CONTENT_TYPE_VIDEO</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Playlist</strong></td>
<td>WPD_CONTENT_TYPE_PLAYLIST</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Document</strong></td>
<td>WPD_CONTENT_TYPE_DOCUMENT</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Contact</strong></td>
<td>WPD_CONTENT_TYPE_CONTACT</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Email</strong></td>
<td>WPD_CONTENT_TYPE_EMAIL</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Appointment</strong></td>
<td>WPD_CONTENT_TYPE_APPOINTMENT</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Task</strong></td>
<td>WPD_CONTENT_TYPE_TASK</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Memo</strong></td>
<td>WPD_CONTENT_TYPE_MEMO</td>
</tr>
<tr>
<td><strong>WPDContextMenu.ImageAlbum</strong></td>
<td>WPD_CONTENT_TYPE_IMAGE_ALBUM</td>
</tr>
<tr>
<td><strong>WPDContextMenu.AudioAlbum</strong></td>
<td>WPD_CONTENT_TYPE_AUDIO_ALBUM</td>
</tr>
<tr>
<td><strong>WPDContextMenu.VideoAlbum</strong></td>
<td>WPD_CONTENT_TYPE_VIDEO_ALBUM</td>
</tr>
<tr>
<td><strong>WPDContextMenu.MixedAlbum</strong></td>
<td>WPD_CONTENT_TYPE_MIXED_CONTENT_ALBUM</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Generic</strong></td>
<td>WPD_CONTENT_TYPE_UNSPECIFIED<!-- raw HTML omitted --> WPD_CONTENT_TYPE_GENERIC_FILE<!-- raw HTML omitted --> WPD_CONTENT_TYPE_PROGRAM<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
