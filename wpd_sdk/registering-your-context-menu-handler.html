<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Registering Your Context Menu Handler</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Registering Your Context Menu Handler
ms.assetid: 0023004b-b6b3-486a-8b8c-8e63c5731206
title: Registering Your Context Menu Handler
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Registering Your Context Menu Handler</h1>
<p>In order for your context menu handler to be recognized by the WPD namespace you must register it properly in the Windows registry. The registration entries for a WPD context menu handler are similar to those for the shell, but they are registered as special file types. WPD context menu handlers are registered according to the content type they represent. Below is a sample registration tree for a WPD context menu handler:</p>
<pre lang="C++"><code>HKEY_CLASSES_ROOT
 \-- WPDContextMenu.Image
      \-- shellex
           \-- ContextMenuHandlers
                \-- ShImageViewer (Default)  REG_SZ {E847DA7C-1D6A-45F6-B725-CB260C236066}

</code></pre>
<p>The above example registers the shell image viewer with the WPD namespace. When a user right-clicks or double-clicks content on a device through the Windows Vista Shell, it invokes this context menu handler. The WPD namespace uses WPD_CONTENT_TYPE to determine which context menu handlers to load. If WPD_CONTENT_TYPE is equal to WPD_CONTENT_TYPE_UNSPECIFIED, WPD_CONTENT_TYPE_GENERIC_FILE or WPD_CONTENT_TYPE_PROGRAM, then the WPD namespace will try to find the best match based on the extension of the selected file. If neither the file extension nor the content type provides a useful classification, the WPD namespace will load the context menu handlers under the <strong>WPDContextMenu.Generic</strong> registry key. The following table lists all of the file classes available to a context menu handler and what content types and file extensions they represent:</p>
<table>
<thead>
<tr>
<th>Registry Key</th>
<th>WPD Content Type</th>
<th>File Extension</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>WPDContextMenu.Device</strong></td>
<td>Registering under this key enables your context menu handler at the device level. (Right-click on a device.)</td>
<td>(N/A)</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Storage</strong></td>
<td>Registering under this key enables your context menu handler at the storage level. (Right-click on a storage.)</td>
<td>(N/A)</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Folder</strong></td>
<td>WPD_CONTENT_TYPE_FOLDER</td>
<td>(N/A)</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Image</strong></td>
<td>WPD_CONTENT_TYPE_IMAGE</td>
<td>.bmp <!-- raw HTML omitted --> .gif <!-- raw HTML omitted --> .png <!-- raw HTML omitted --> .jpg <!-- raw HTML omitted --> .jpe <!-- raw HTML omitted --> .jpeg <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>WPDContextMenu.Audio</strong></td>
<td>WPD_CONTENT_TYPE_AUDIO</td>
<td>.aiff <!-- raw HTML omitted --> .mp3 <!-- raw HTML omitted --> .wav <!-- raw HTML omitted --> .wma <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>WPDContextMenu.Video</strong></td>
<td>WPD_CONTENT_TYPE_VIDEO</td>
<td>.asf<!-- raw HTML omitted --> .avi <!-- raw HTML omitted --> .dvr-ms <!-- raw HTML omitted --> .mpeg <!-- raw HTML omitted --> .mpg <!-- raw HTML omitted --> .wmv <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>WPDContextMenu.Playlist</strong><!-- raw HTML omitted --></td>
<td>WPD_CONTENT_TYPE_PLAYLIST</td>
<td>.wpl <!-- raw HTML omitted --> .m3u <!-- raw HTML omitted --> .mpl <!-- raw HTML omitted --> .asx <!-- raw HTML omitted --> .pls <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>WPDContextMenu.Document</strong></td>
<td>WPD_CONTENT_TYPE_DOCUMENT</td>
<td>.doc <!-- raw HTML omitted --> .txt <!-- raw HTML omitted --> .rtf <!-- raw HTML omitted --> .xls <!-- raw HTML omitted --> .ppt <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>WPDContextMenu.Contact</strong><!-- raw HTML omitted --></td>
<td>WPD_CONTENT_TYPE_CONTACT</td>
<td>None</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Email</strong></td>
<td>WPD_CONTENT_TYPE_EMAIL</td>
<td>None</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Appointment</strong></td>
<td>WPD_CONTENT_TYPE_APPOINTMENT</td>
<td>None</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Task</strong></td>
<td>WPD_CONTENT_TYPE_TASK</td>
<td>None</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Memo</strong></td>
<td>WPD_CONTENT_TYPE_MEMO</td>
<td>None</td>
</tr>
<tr>
<td><strong>WPDContextMenu.ImageAlbum</strong></td>
<td>WPD_CONTENT_TYPE_IMAGE_ALBUM</td>
<td>None</td>
</tr>
<tr>
<td><strong>WPDContextMenu.AudioAlbum</strong></td>
<td>WPD_CONTENT_TYPE_AUDIO_ALBUM</td>
<td>None</td>
</tr>
<tr>
<td><strong>WPDContextMenu.VideoAlbum</strong></td>
<td>WPD_CONTENT_TYPE_VIDEO_ALBUM</td>
<td>None</td>
</tr>
<tr>
<td><strong>WPDContextMenu.MixedAlbum</strong></td>
<td>WPD_CONTENT_TYPE_MIXED_CONTENT_ALBUM</td>
<td>None</td>
</tr>
<tr>
<td><strong>WPDContextMenu.Generic</strong></td>
<td>WPD_CONTENT_TYPE_UNSPECIFIED</td>
<td>All other file extensions</td>
</tr>
</tbody>
</table>
</body>
