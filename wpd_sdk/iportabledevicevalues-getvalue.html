<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IPortableDeviceValues::GetValue method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The GetValue method retrieves a PROPVARIANT value specified by a key.
ms.assetid: 927844f5-8f57-4596-ae0d-c67b8011ca87
title: IPortableDeviceValues::GetValue method (PortableDeviceTypes.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>IPortableDeviceValues.GetValue
api_type:</li>
<li>COM
api_location:</li>
<li>PortableDeviceGUIDs.lib</li>
<li>PortableDeviceGUIDs.dll</li>
</ul>
<hr />
<h1>IPortableDeviceValues::GetValue method</h1>
<p>The <strong>GetValue</strong> method retrieves a <strong>PROPVARIANT</strong> value specified by a key.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT GetValue(
  [in]  REFPROPERTYKEY key,
  [out] PROPVARIANT    *pValue
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>key</em> [in]</p>
<!-- raw HTML omitted -->
<p>A <strong>REFPROPERTYKEY</strong> key that specifies the item to retrieve.</p>
<!-- raw HTML omitted -->
<p><em>pValue</em> [out]</p>
<!-- raw HTML omitted -->
<p>Pointer to the retrieved <strong>PROPVARIANT</strong> value. The caller must release the memory by calling <strong>PropVariantClear</strong> when done with it.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>The method returns an <strong>HRESULT</strong>. Possible values include, but are not limited to, those in the following table.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The method succeeded.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>HRESULT_FROM_WIN32(ERROR_NOT_FOUND)</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The property specified by <em>key</em> is not in the collection.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>When the VARTYPE for <em>pValue</em> is VT_VECTOR or VT_UI1, retrieving a <strong>NULL</strong> or zero-sized buffer is not supported. For example, neither pValue.caub.pElems = <strong>NULL</strong> nor pValue.caub.cElems = 0 are allowed.</p>
<p>This method can be used to retrieve a value of any type from the collection. However, if you know the value type in advance, use one of the specialized retrieval methods of this interface to avoid the overhead of working with PROPVARIANT values directly.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->PortableDeviceTypes.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->PortableDeviceGUIDs.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="iportabledevicevalues.html"><strong>IPortableDeviceValues Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="iportabledevicevalues-removevalue.html"><strong>IPortableDeviceValues::RemoveValue</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="iportabledevicevalues-setvalue.html"><strong>IPortableDeviceValues::SetValue</strong></a></p>
<!-- raw HTML omitted -->
</body>
