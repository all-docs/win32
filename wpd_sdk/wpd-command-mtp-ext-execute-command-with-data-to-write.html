<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>WPD_COMMAND_MTP_EXT_EXECUTE_COMMAND_WITH_DATA_TO_WRITE Command</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The WPD_COMMAND_MTP_EXT_EXECUTE_COMMAND_WITH_DATA_TO_WRITE command sends an MTP command block, which is followed by a data phase. The data is sent from the host to the device.
ms.assetid: b675fc3c-4d50-429d-9e00-42160d409a2b
title: WPD_COMMAND_MTP_EXT_EXECUTE_COMMAND_WITH_DATA_TO_WRITE Command (WpdMtpExtensions.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>WPD_COMMAND_MTP_EXT_EXECUTE_COMMAND_WITH_DATA_TO_WRITE Command</h1>
<p>The <strong>WPD_COMMAND_MTP_EXT_EXECUTE_COMMAND_WITH_DATA_TO_WRITE</strong> command sends an MTP command block, which is followed by a data phase. The data is sent from the host to the device.</p>
<h2>Command category</h2>
<p><strong>WPD_CATEGORY_MTP_EXT_VENDOR_OPERATIONS</strong></p>
<h2>Parameters</h2>
<p>The driver expects the following parameters.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>VarType</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>WPD_PROPERTY_MTP_EXT_OPERATION_CODE</strong></td>
<td>VT_UI4</td>
<td>Required. Identifies a vendor-extended MTP operation code.</td>
</tr>
<tr>
<td><strong>WPD_PROPERTY_MTP_EXT_OPERATION_PARAMS</strong></td>
<td>VT_UI4</td>
<td>Required. An <strong>IPortableDevicePropVariantCollection</strong> collection that identifies the required parameters for the vendor operation code.</td>
</tr>
<tr>
<td><strong>WPD_PROPERTY_MTP_EXT_TRANSFER_TOTAL_DATA_SIZE</strong></td>
<td>VT_UI8</td>
<td>Required.Specifies the total data size, in bytes, excluding any overhead, to be sent to device.</td>
</tr>
</tbody>
</table>
<h2>Return Value</h2>
<p>The driver returns the following results.</p>
<table>
<thead>
<tr>
<th>Result</th>
<th>VarType</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>WPD_PROPERTY_MTP_EXT_OPTIMAL_TRANSFER_BUFFER_SIZE</strong></td>
<td>VT_UI4</td>
<td>Required. Specifies the optimal size of the transfer buffer.</td>
</tr>
<tr>
<td><strong>WPD_PROPERTY_MTP_EXT_TRANSFER_CONTEXT</strong></td>
<td>VT_LPWSTR</td>
<td>Optional. A context identifier that the driver uses for subsequent data transfers.</td>
</tr>
</tbody>
</table>
<h2>Calling Methods</h2>
<p>Can only be called directly by using <a href="/windows/desktop/api/PortableDeviceApi/nf-portabledeviceapi-iportabledevice-sendcommand"><strong>IPortableDevice::SendCommand</strong></a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WpdMtpExtensions.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="supporting-mtp-extensions.html">Supporting MTP Extensions</a></p>
<!-- raw HTML omitted -->
</body>
