<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Creating a Windows Media Device Manager Application</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Creating a Windows Media Device Manager Application
description: Creating a Windows Media Device Manager Application
ms.assetid: 6a200bd9-19dd-4130-acb4-e038b469c334
keywords:</p>
<ul>
<li>Windows Media Device Manager,creating applications</li>
<li>Device Manager,creating applications</li>
<li>Windows Media Device Manager,programming guide</li>
<li>Device Manager,programming guide</li>
<li>programming guide,desktop applications</li>
<li>programming guide,Windows Media Device Manager</li>
<li>programming guide,plug-ins</li>
<li>programming guide,creating applications</li>
<li>Windows Media Device Manager,desktop applications</li>
<li>Device Manager,desktop applications</li>
<li>Windows Media Device Manager,plug-ins</li>
<li>Device Manager,plug-insp</li>
<li>plug-ins,creating</li>
<li>plug-ins,programming guide</li>
<li>desktop applications,creating</li>
<li>creating Windows Media Device Manager applications,about
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Creating a Windows Media Device Manager Application</h1>
<p>This section describes how to use Windows Media Device Manager in your application. The term &quot;application&quot; here means either an executable, such as a media player, or a COM plug-in, such as a metering plug-in.</p>
<p>Microsoft includes several service providers with Windows XP and Windows Media Player 10, including an MTP service provider, a Windows CE service provider (for devices running Windows CE and using the RAPI protocol, such as the Pocket PC), and a service provider for mass-storage category (MSC) devices. You can also create your own service provider to ensure communication with your own device; for more information, see <a href="creating-a-service-provider.html">Creating a Service Provider</a>.</p>
<p>There are a number of third-party legacy service providers that address a particular manufacturer's non-MTP, non-RAPI, or non-MSC device. These service providers are included on the driver disk shipped with these devices.</p>
<p>An application that uses Windows Media Device Manager must perform the following steps.</p>
<ol>
<li><strong>Become aware of privacy issues involved with developing an application.</strong> See <a href="privacy-statement.html">Privacy Statement</a> to learn about some privacy issues involving developing a Windows Media Device Manager application.</li>
<li><strong>Include the required library and header files for your application.</strong> See <a href="required-library-and-header-files-for-an-application.html">Required Library and Header Files for an Application</a> to learn what files you will need to include in your project.</li>
<li><strong>Authenticate the application and acquire the root IWMDMDevice interface.</strong> The first task an application must do to use Windows Media Device Manager is to authenticate itself. This process verifies the identity of the application to Windows Media Device Manager using a dummy certificate for limited Windows Media Device Manager functionality, or using an official certificate for full functionality. For more information, see <a href="authenticating-the-application.html">Authenticating the Application</a>.</li>
<li><strong>Enumerate the connected devices.</strong> The first step in communicating with devices is to find out what devices are connected and accessible to Windows Media Device Manager. For more information, see <a href="enumerating-devices.html">Enumerating Devices</a>.</li>
<li><strong>Check the status of the device's DRM components.</strong> To use DRM-protected files, a device must be built on some version of Windows Media DRM for Portable Devices, and the DRM components must be up to date. Before you begin handling files on the device, it is best to see if the device supports DRM-protected files, and whether the device needs to be updated. For more information, see <a href="handling-protected-content-in-the-application.html">Handling Protected Content in the Application</a>.</li>
<li><strong>Explore a device.</strong> After you have found the device you want, you can explore the contents of that device. For more information, see <a href="exploring-a-device.html">Exploring a Device</a>.</li>
<li><strong>Read files from the device, and write files to the device.</strong> After you know about the layout of the device, you can begin transferring files to and from the device. For more information, see <a href="reading-files-from-the-device.html">Reading Files from the Device</a> and <a href="writing-files-to-the-device.html">Writing Files to the Device</a>.</li>
<li><strong>Create playlists on the device.</strong> One kind of file you can write to the device is an abstract file, which is a collection of references to other files. Although the ability to write abstract files to a device depends on the service provider and the device, generally only MTP devices have this capability. For more information, see <a href="creating-a-playlist-on-the-device.html">Creating a Playlist on the Device</a>.</li>
</ol>
<p>In addition to these steps, there are several more features that you can enable in your application:</p>
<ul>
<li><strong>Notifications.</strong> You can enable your application to receive notifications when devices connect or disconnect from the computer. For more information, see <a href="enabling-notifications.html">Enabling Notifications</a>.</li>
<li><strong>Logging.</strong> Windows Media Device Manager uses a logging object that saves a record of its actions to a local text file. You can add messages to this log to help you analyze errors or performance in your application. For more information, see <a href="enabling-logging.html">Enabling Logging</a>.</li>
<li><strong>Metering content usage.</strong> You can retrieve content usage statistics for licenses that grant this right. These statistics can then be sent up to a Web server to calculate royalty payments to content owners. For more information, see <a href="metering-content-usage.html">Metering Content Usage</a>.</li>
</ul>
<p><strong>A note of caution</strong></p>
<p>Your application may need to work with a variety of devices, including some that you have not developed and have never tested your code against. These devices might or might not accurately respond to queries and commands, or implement MTP or other specifications. Be sure to include robust error checking and fallback functionality to deal with the unexpected. Program defensively.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="programming-guide.html"><strong>Programming Guide</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
