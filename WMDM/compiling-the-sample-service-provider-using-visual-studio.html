<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Compiling the Sample Service Provider Using Visual Studio</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Compiling the Sample Service Provider Using Visual Studio
description: Compiling the Sample Service Provider Using Visual Studio
ms.assetid: db0ecc18-d5b0-47d8-9b3f-3a9644343de8
keywords:</p>
<ul>
<li>Windows Media Device Manager,samples</li>
<li>Device Manager,samples</li>
<li>Windows Media Device Manager,service provider sample</li>
<li>Device Manager,service provider sample</li>
<li>service providers,samples</li>
<li>samples,service providers</li>
<li>samples,compiling using Visual Studio
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Compiling the Sample Service Provider Using Visual Studio</h1>
<p>The Windows Media Format SDK does not include a Visual Studio solution file. However, this document includes two files that enable you to use Visual Studio to build and debug the sample service provider. Both the files provided are for Visual Studio .NET 2003.</p>
<ul>
<li>Save the following code as a text file named mshdsp.vcproj in the folder <!-- raw HTML omitted -->\WMFSDK\WMFSDK95\WMDM\mdsp\mshdsp.</li>
</ul>
<pre lang="C++"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;Windows-1252&quot;?&gt;
&lt;VisualStudioProject
    ProjectType=&quot;Visual C++&quot;
    Version=&quot;7.10&quot;
    Name=&quot;mshdsp&quot;
    ProjectGUID=&quot;{B0BD0EEB-2048-46E2-ADCB-DA058B246F5E}&quot;
    Keyword=&quot;AtlProj&quot;&gt;
    &lt;Platforms&gt;
        &lt;Platform
            Name=&quot;Win32&quot;/&gt;
    &lt;/Platforms&gt;
    &lt;Configurations&gt;
        &lt;Configuration
            Name=&quot;Debug|Win32&quot;
            OutputDirectory=&quot;Debug&quot;
            IntermediateDirectory=&quot;Debug&quot;
            ConfigurationType=&quot;2&quot;
            UseOfATL=&quot;1&quot;
            ATLMinimizesCRunTimeLibraryUsage=&quot;FALSE&quot;
            CharacterSet=&quot;2&quot;&gt;
            &lt;Tool
                Name=&quot;VCCLCompilerTool&quot;
                Optimization=&quot;0&quot;
                AdditionalIncludeDirectories=&quot;..\..\inc&quot;
                PreprocessorDefinitions=&quot;WIN32;_WINDOWS;_DEBUG;_USRDLL;_ATL_ATTRIBUTES;ATL_STATIC_REGISTRY;INC_OLE2;&quot;
                MinimalRebuild=&quot;TRUE&quot;
                BasicRuntimeChecks=&quot;3&quot;
                RuntimeLibrary=&quot;3&quot;
                UsePrecompiledHeader=&quot;0&quot;
                WarningLevel=&quot;3&quot;
                Detect64BitPortabilityProblems=&quot;TRUE&quot;
                DebugInformationFormat=&quot;4&quot;/&gt;
            &lt;Tool
                Name=&quot;VCCustomBuildTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCLinkerTool&quot;
                IgnoreImportLibrary=&quot;TRUE&quot;
                AdditionalOptions=&quot;/FIXED:NO&quot;
                AdditionalDependencies=&quot;advapi32.lib gdi32.lib kernel32.lib ole32.lib oleaut32.lib olepro32.lib user32.lib uuid.lib mssachlp.lib oldnames.lib shell32.lib atlsd.lib shlwapi.lib msvcrtd.lib&quot;
                OutputFile=&quot;$(OutDir)/mshdsp.dll&quot;
                LinkIncremental=&quot;2&quot;
                AdditionalLibraryDirectories=&quot;..\..\lib&quot;
                IgnoreAllDefaultLibraries=&quot;TRUE&quot;
                ModuleDefinitionFile=&quot;MsHDSP.def&quot;
                MergedIDLBaseFileName=&quot;_mshdsp.idl&quot;
                GenerateDebugInformation=&quot;TRUE&quot;
                SubSystem=&quot;2&quot;
                OptimizeReferences=&quot;1&quot;
                ImportLibrary=&quot;$(OutDir)/mshdsp.lib&quot;
                TargetMachine=&quot;1&quot;/&gt;
            &lt;Tool
                Name=&quot;VCMIDLTool&quot;
                PreprocessorDefinitions=&quot;_DEBUG;UNICODE;_UNICODE&quot;
                MkTypLibCompatible=&quot;FALSE&quot;
                TargetEnvironment=&quot;1&quot;
                GenerateStublessProxies=&quot;TRUE&quot;
                TypeLibraryName=&quot;$(IntDir)/mshdsp.tlb&quot;
                HeaderFileName=&quot;mshdsp.h&quot;
                DLLDataFileName=&quot;&quot;
                InterfaceIdentifierFileName=&quot;mshdsp_i.c&quot;
                ProxyFileName=&quot;mshdsp_p.c&quot;/&gt;
            &lt;Tool
                Name=&quot;VCPostBuildEventTool&quot;
                Description=&quot;Performing registration&quot;
                CommandLine=&quot;regsvr32 /s /c &amp;quot;$(TargetPath)&amp;quot;&quot;/&gt;
            &lt;Tool
                Name=&quot;VCPreBuildEventTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCPreLinkEventTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCResourceCompilerTool&quot;
                PreprocessorDefinitions=&quot;_DEBUG&quot;
                Culture=&quot;1033&quot;
                AdditionalIncludeDirectories=&quot;$(IntDir)&quot;/&gt;
            &lt;Tool
                Name=&quot;VCWebServiceProxyGeneratorTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCXMLDataGeneratorTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCWebDeploymentTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCManagedWrapperGeneratorTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCAuxiliaryManagedWrapperGeneratorTool&quot;/&gt;
        &lt;/Configuration&gt;
        &lt;Configuration
            Name=&quot;Release|Win32&quot;
            OutputDirectory=&quot;Release&quot;
            IntermediateDirectory=&quot;Release&quot;
            ConfigurationType=&quot;2&quot;
            UseOfATL=&quot;1&quot;
            ATLMinimizesCRunTimeLibraryUsage=&quot;FALSE&quot;
            CharacterSet=&quot;2&quot;&gt;
            &lt;Tool
                Name=&quot;VCCLCompilerTool&quot;
                PreprocessorDefinitions=&quot;WIN32;_WINDOWS;NDEBUG;_USRDLL;_ATL_ATTRIBUTES&quot;
                RuntimeLibrary=&quot;2&quot;
                UsePrecompiledHeader=&quot;3&quot;
                WarningLevel=&quot;3&quot;
                Detect64BitPortabilityProblems=&quot;TRUE&quot;
                DebugInformationFormat=&quot;3&quot;/&gt;
            &lt;Tool
                Name=&quot;VCCustomBuildTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCLinkerTool&quot;
                IgnoreImportLibrary=&quot;TRUE&quot;
                OutputFile=&quot;$(OutDir)/mshdsp.dll&quot;
                LinkIncremental=&quot;1&quot;
                MergedIDLBaseFileName=&quot;_mshdsp.idl&quot;
                GenerateDebugInformation=&quot;TRUE&quot;
                SubSystem=&quot;2&quot;
                OptimizeReferences=&quot;2&quot;
                EnableCOMDATFolding=&quot;2&quot;
                ImportLibrary=&quot;$(OutDir)/mshdsp.lib&quot;
                TargetMachine=&quot;1&quot;/&gt;
            &lt;Tool
                Name=&quot;VCMIDLTool&quot;
                PreprocessorDefinitions=&quot;NDEBUG&quot;
                MkTypLibCompatible=&quot;FALSE&quot;
                TargetEnvironment=&quot;1&quot;
                GenerateStublessProxies=&quot;TRUE&quot;
                TypeLibraryName=&quot;$(IntDir)/mshdsp.tlb&quot;
                HeaderFileName=&quot;mshdsp.h&quot;
                DLLDataFileName=&quot;&quot;
                InterfaceIdentifierFileName=&quot;mshdsp_i.c&quot;
                ProxyFileName=&quot;mshdsp_p.c&quot;/&gt;
            &lt;Tool
                Name=&quot;VCPostBuildEventTool&quot;
                Description=&quot;Performing registration&quot;
                CommandLine=&quot;regsvr32 /s /c &amp;quot;$(TargetPath)&amp;quot;&quot;/&gt;
            &lt;Tool
                Name=&quot;VCPreBuildEventTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCPreLinkEventTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCResourceCompilerTool&quot;
                PreprocessorDefinitions=&quot;NDEBUG&quot;
                Culture=&quot;1033&quot;
                AdditionalIncludeDirectories=&quot;$(IntDir)&quot;/&gt;
            &lt;Tool
                Name=&quot;VCWebServiceProxyGeneratorTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCXMLDataGeneratorTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCWebDeploymentTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCManagedWrapperGeneratorTool&quot;/&gt;
            &lt;Tool
                Name=&quot;VCAuxiliaryManagedWrapperGeneratorTool&quot;/&gt;
        &lt;/Configuration&gt;
    &lt;/Configurations&gt;
    &lt;References&gt;
    &lt;/References&gt;
    &lt;Files&gt;
        &lt;Filter
            Name=&quot;Source Files&quot;
            Filter=&quot;cpp;c;cxx;def;odl;idl;hpj;bat;asm;asmx&quot;
            UniqueIdentifier=&quot;{4FC737F1-C7A5-4376-A066-2A32D752A2FF}&quot;&gt;
            &lt;File
                RelativePath=&quot;.\hdsppch.cpp&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\key.c&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\loghelp.cpp&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDServiceProvider.cpp&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\Mdsp.cpp&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDSPDevice.cpp&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDSPEnumDevice.cpp&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDSPEnumStorage.cpp&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDSPStorage.cpp&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDSPStorageGlobals.cpp&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDSPutil.cpp&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MsHDSP.def&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MsHDSP.idl&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\proppage.cpp&quot;&gt;
            &lt;/File&gt;
        &lt;/Filter&gt;
        &lt;Filter
            Name=&quot;Header Files&quot;
            Filter=&quot;h;hpp;hxx;hm;inl;inc;xsd&quot;
            UniqueIdentifier=&quot;{93995380-89BD-4b04-88EB-625FBE52EBFB}&quot;&gt;
            &lt;File
                RelativePath=&quot;.\hdsppch.h&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\hdsprc.h&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\loghelp.h&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDServiceProvider.h&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MdspDefs.h&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDSPDevice.h&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDSPEnumDevice.h&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDSPEnumStorage.h&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDSPStorage.h&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDSPStorageGlobals.h&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\proppage.h&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\verinfo.h&quot;&gt;
            &lt;/File&gt;
        &lt;/Filter&gt;
        &lt;Filter
            Name=&quot;Resource Files&quot;
            Filter=&quot;rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx&quot;
            UniqueIdentifier=&quot;{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}&quot;&gt;
            &lt;File
                RelativePath=&quot;.\icon_hd.ico&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\MDServiceProvider.rgs&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\mdsp.rc&quot;&gt;
            &lt;/File&gt;
            &lt;File
                RelativePath=&quot;.\proppage.rgs&quot;&gt;
            &lt;/File&gt;
        &lt;/Filter&gt;
        &lt;File
            RelativePath=&quot;.\Makefile&quot;&gt;
        &lt;/File&gt;
        &lt;File
            RelativePath=&quot;.\mshdsp.ncb&quot;&gt;
        &lt;/File&gt;
    &lt;/Files&gt;
    &lt;Globals&gt;
    &lt;/Globals&gt;
&lt;/VisualStudioProject&gt;
</code></pre>
<ul>
<li>Save the following code as a text file named mshdsp.sln in the same folder where you saved mshdsp.vcproj.</li>
</ul>
<pre lang="C++"><code>Microsoft Visual Studio Solution File, Format Version 8.00
Project(&quot;{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}&quot;) = &quot;mshdsp&quot;, &quot;mshdsp.vcproj&quot;, &quot;{B0BD0EEB-2048-46E2-ADCB-DA058B246F5E}&quot;
    ProjectSection(ProjectDependencies) = postProject
    EndProjectSection
EndProject
Global
    GlobalSection(SolutionConfiguration) = preSolution
        Debug = Debug
        Release = Release
    EndGlobalSection
    GlobalSection(ProjectConfiguration) = postSolution
        {B0BD0EEB-2048-46E2-ADCB-DA058B246F5E}.Debug.ActiveCfg = Debug|Win32
        {B0BD0EEB-2048-46E2-ADCB-DA058B246F5E}.Debug.Build.0 = Debug|Win32
        {B0BD0EEB-2048-46E2-ADCB-DA058B246F5E}.Release.ActiveCfg = Release|Win32
        {B0BD0EEB-2048-46E2-ADCB-DA058B246F5E}.Release.Build.0 = Release|Win32
        {C82A4AF9-14FD-474E-AD38-6EED4A0C0903}.Debug.ActiveCfg = Debug|Win32
        {C82A4AF9-14FD-474E-AD38-6EED4A0C0903}.Release.ActiveCfg = Release|Win32
    EndGlobalSection
    GlobalSection(ExtensibilityGlobals) = postSolution
    EndGlobalSection
    GlobalSection(ExtensibilityAddIns) = postSolution
    EndGlobalSection
EndGlobal
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="sample-service-provider.html"><strong>Sample Service Provider</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
