<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Mandatory and Optional Interfaces</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Mandatory and Optional Interfaces
description: Mandatory and Optional Interfaces
ms.assetid: 582c9dd5-f8ab-48df-afb3-fba931ee0dea
keywords:</p>
<ul>
<li>Windows Media Device Manager,interfaces</li>
<li>Device Manager,interfaces</li>
<li>programming guide,interfaces</li>
<li>service providers,interfaces</li>
<li>creating service providers,interfaces</li>
<li>interfaces
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Mandatory and Optional Interfaces</h1>
<p>The following table describes the mandatory and optional interfaces and methods for service providers to implement. All the interfaces with one or more mandatory methods must be implemented. A mandatory method cannot return WMDM_E_NOTSUPPORTED or E_NOTIMPL.</p>
<table>
<thead>
<tr>
<th>Interface and method</th>
<th>Implementation option</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider-enumdevices"><strong>IMDServiceProvider::EnumDevices</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider-getdevicecount"><strong>IMDServiceProvider::GetDeviceCount</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider2-createdevice"><strong>IMDServiceProvider2::CreateDevice</strong></a></td>
<td>Optional. This method must be implemented for PnP and Windows Explorer support.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-enumstorage"><strong>IMDSPDevice::EnumStorage</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getdeviceicon"><strong>IMDSPDevice::GetDeviceIcon</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getformatsupport"><strong>IMDSPDevice::GetFormatSupport</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getmanufacturer"><strong>IMDSPDevice::GetManufacturer</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getname"><strong>IMDSPDevice::GetName</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getpowersource"><strong>IMDSPDevice::GetPowerSource</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getserialnumber"><strong>IMDSPDevice::GetSerialNumber</strong></a></td>
<td>Optional. For protected content transfer, Windows Media Device Manager uses <strong>IMDSPStorageGlobals::GetSerialNumber</strong>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getstatus"><strong>IMDSPDevice::GetStatus</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-gettype"><strong>IMDSPDevice::GetType</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getversion"><strong>IMDSPDevice::GetVersion</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-sendopaquecommand"><strong>IMDSPDevice::SendOpaqueCommand</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getcanonicalname"><strong>IMDSPDevice2::GetCanonicalName</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getformatsupport2"><strong>IMDSPDevice2::GetFormatSupport2</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getspecifypropertypages"><strong>IMDSPDevice2::GetSpecifyPropertyPages</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getstorage"><strong>IMDSPDevice2::GetStorage</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevicecontrol"><strong>IMDSPDeviceControl Interface</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-clone"><strong>IMDSPEnumDevice::Clone</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-next"><strong>IMDSPEnumDevice::Next</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-reset"><strong>IMDSPEnumDevice::Reset</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-skip"><strong>IMDSPEnumDevice::Skip</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-clone"><strong>IMDSPEnumStorage::Clone</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-next"><strong>IMDSPEnumStorage::Next</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-reset"><strong>IMDSPEnumStorage::Reset</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-skip"><strong>IMDSPEnumStorage::Skip</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-close"><strong>IMDSPObject::Close</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-delete"><strong>IMDSPObject::Delete</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-move"><strong>IMDSPObject::Move</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-open"><strong>IMDSPObject::Open</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-read"><strong>IMDSPObject::Read</strong></a></td>
<td>Mandatory (if Windows Media Player support is desired).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-rename"><strong>IMDSPObject::Rename</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-seek"><strong>IMDSPObject::Seek</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-write"><strong>IMDSPObject::Write</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nn-mswmdm-imdspobjectinfo"><strong>IMDSPObjectInfo Interface</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nn-mswmdm-imdsprevoked"><strong>IMDSPRevoked Interface</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-createstorage"><strong>IMDSPStorage::CreateStorage</strong></a></td>
<td>Mandatory only if <em>dwAttributes</em> is WMDM_FILE_ATTR_FILE.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-enumstorage"><strong>IMDSPStorage::EnumStorage</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getattributes"><strong>IMDSPStorage::GetAttributes</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getdate"><strong>IMDSPStorage::GetDate</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getname"><strong>IMDSPStorage::GetName</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getrights"><strong>IMDSPStorage::GetRights</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getsize"><strong>IMDSPStorage::GetSize</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getstorageglobals"><strong>IMDSPStorage::GetStorageGlobals</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-sendopaquecommand"><strong>IMDSPStorage::SendOpaqueCommands</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-setattributes"><strong>IMDSPStorage::SetAttributes</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-createstorage2"><strong>IMDSPStorage2::CreateStorage2</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-getattributes2"><strong>IMDSPStorage2::GetAttributes2</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-getstorage"><strong>IMDSPStorage2::GetStorage</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-setattributes2"><strong>IMDSPStorage2::SetAttributes2</strong></a></td>
<td>Optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage3"><strong>IMDSPStorage3 Interface</strong></a></td>
<td>Optional. However, if the device parameter <em>UseMetadataViews</em> is set to 1, this interface must be implemented, and <strong>IMDSPStorage3::GetMetadata</strong> becomes mandatory, although <strong>IMDSPStorage3::SetMetadata</strong> is still optional.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getcapabilities"><strong>IMDSPStorageGlobals::GetCapabilities</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getdevice"><strong>IMDSPStorageGlobals::GetDevice</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getrootstorage"><strong>IMDSPStorageGlobals::GetRootStorage</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getserialnumber"><strong>IMDSPStorageGlobals::GetSerialNumber</strong></a></td>
<td>Mandatory for PDDRM only. Optional otherwise.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getstatus"><strong>IMDSPStorageGlobals::GetStatus</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalbad"><strong>IMDSPStorageGlobals::GetTotalBad</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalfree"><strong>IMDSPStorageGlobals::GetTotalFree</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalsize"><strong>IMDSPStorageGlobals::GetTotalSize</strong></a></td>
<td>Mandatory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-initialize"><strong>IMDSPStorageGlobals::Initialize</strong></a></td>
<td>Optional. This method should be implemented if the device supports this functionality. If this method is not implemented, <strong>IMDSPStorageGlobals::GetCapabilites</strong> must return WMDM_STORAGECAP_NOT_INITIALIZABLE in addition to any other flags.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevice3"><strong>IMDSPDevice3</strong></a><a href="/windows/desktop/api/mswmdm/nn-mswmdm-imdspobject2"><strong>IMDSPObject2</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage4"><strong>IMDSPStorage4</strong></a><!-- raw HTML omitted --></td>
<td>Required to support automatic synchronization with Windows Media Player</td>
</tr>
</tbody>
</table>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="creating-a-service-provider.html"><strong>Creating a Service Provider</strong></a></p>
<!-- raw HTML omitted -->
</body>
