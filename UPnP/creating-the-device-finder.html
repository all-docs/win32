<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Creating the Device Finder</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Creating the Device Finder
description: The following examples demonstrate how to create an instance of the Device Finder object in C++, Visual Basic, and VBScript.
ms.assetid: 0084a64d-458e-471c-a6be-aeb6ed0962d0
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Creating the Device Finder</h1>
<p>The following examples demonstrate how to create an instance of the Device Finder object in C++, Visual Basic, and VBScript. The script languages use the programmatic ID (ProgID) <a href="/windows/desktop/api/Upnp/nn-upnp-iupnpdevicefinder"><strong>UPnP.UPnPDeviceFinder</strong></a> to identify the Device Finder class. The C++ code uses the class identifier.</p>
<h2>C++ Example</h2>
<pre lang="C++"><code>HRESULT hr = S_OK;
IUPnPDeviceFinder *pDeviceFinder = NULL;

hr = CoCreateInstance(CLSID_UPnPDeviceFinder, 
                      NULL,
                      CLSCTX_INPROC_SERVER,
                      IID_IUPnPDeviceFinder,
                      (void **) &amp;pDeviceFinder);
</code></pre>
<p>As this C++ example indicates, the Device Finder object exposes a default interface, <a href="/windows/desktop/api/Upnp/nn-upnp-iupnpdevicefinder"><strong>IUPnPDeviceFinder</strong></a>. The methods of this interface perform searches according to the valid search criteria for a UPnP-based device. This interface is Automation capable, so its methods can be called by scripting code.</p>
<h2>VBScript Example</h2>
<pre lang="VB"><code>Dim deviceFinder

Set deviceFinder = CreateObject( &quot;UPnP.UPnPDeviceFinder&quot; )
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
