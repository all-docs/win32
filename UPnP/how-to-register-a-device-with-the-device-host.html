<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Register a Device with the Device Host</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Register a Device with the Device Host
description: You can register either a running device or a non-running device.
ms.assetid: 40e30881-d5fb-4cf9-8dd7-0d50d2621d5c
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Register a Device with the Device Host</h1>
<p>You can register either a running device or a non-running device.</p>
<h2>Registering a Running Device</h2>
<p>Devices are registered using the <a href="/windows/desktop/api/Upnphost/nn-upnphost-iupnpregistrar"><strong>IUPnPRegistrar</strong></a> interface. Only administrators are allowed to register running devices. To register a device that has a running device control object, an application must invoke <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice"><strong>IUPnPRegistrar::RegisterRunningDevice</strong></a>, passing the following:</p>
<ul>
<li>The text of the device's description.</li>
<li>An <strong>IUnknown</strong> pointer to the device control object.</li>
<li>An initialization string that is passed to the device control object's <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpdevicecontrol-initialize"><strong>IUPnPDeviceControl::Initialize</strong></a> method.</li>
<li>The location of the resource directory.</li>
<li>The lifetime of the device.</li>
<li>The Device ID parameter (an OUT parameter), which is the return value of this call; a pointer to the Device ID is returned in C++.</li>
</ul>
<h2>Registering a Non-Running Device</h2>
<p>By default, only administrators and interactive users are allowed to register non-running devices. To register a device with a device control object that is not running, the application uses the <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerdevice"><strong>IUPnPRegistrar::RegisterDevice</strong></a> method.</p>
<p>To programmatically register a device with a non-running device control object, the application must invoke <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerdevice"><strong>IUPnPRegistrar::RegisterDevice</strong></a> and pass it the following parameters:</p>
<ul>
<li>The text of the device's description.</li>
<li>The ProgID of the device control object.</li>
<li>An initialization string that is passed to the device control object's <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpdevicecontrol-initialize"><strong>IUPnPDeviceControl::Initialize</strong></a> method.</li>
<li>A container ID.</li>
<li>The location of the resource directory.</li>
<li>The lifetime of the device.</li>
<li>The Device ID parameter (an OUT parameter), which is the return value of this call; a pointer to the Device ID is returned in C++.</li>
</ul>
<p>The registrations of non-running devices can be configured to persist across system boots (the devices are unpublished during the shutdown phase). Therefore, if they are configured this way, devices are published and announced every time the computer is booted.</p>
<p>Â </p>
<p>Â </p>
</body>
