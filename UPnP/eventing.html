<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Eventing</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Eventing
description: A hosted service must implement the IUPnPEventSource interface if it has evented state variables.
ms.assetid: 7558496d-c909-4602-bfaa-d21108392fed
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Eventing</h1>
<p>A hosted service must implement the <a href="/windows/desktop/api/Upnphost/nn-upnphost-iupnpeventsource"><strong>IUPnPEventSource</strong></a> interface if it has evented state variables. This interface has two methods: <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-advise"><strong>Advise</strong></a> and <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-unadvise"><strong>Unadvise</strong></a>. This interface provides a mechanism for the device host to subscribe to event notifications generated by the hosted service. There will be no more than one event sink registered at a time.</p>
<p>A hosted service must implement the <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-advise"><strong>Advise</strong></a> method by holding a reference to the <a href="/windows/desktop/api/Upnphost/nn-upnphost-iupnpeventsink"><strong>IUPnPEventSink</strong></a> interface, which was passed as a parameter. If the interface is found, the <strong>Advise</strong> method holds a reference to that interface until <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-unadvise"><strong>Unadvise</strong></a> is invoked, or until the hosted service object is removed. <strong>Advise</strong> is called only once.</p>
<p>To remove the subscription, the device host invokes <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-unadvise"><strong>Unadvise</strong></a> and passes in the object pointer used when it called <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-advise"><strong>Advise</strong></a>. The hosted service removes the subscription if the pointer is the same as the one passed to <strong>Advise</strong>.</p>
<p>When a state variable's value changes, the hosted service must signal that an event has occurred. The services does this by invoking the <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsink-onstatechanged"><strong>IUPnPEventSink::OnStateChanged</strong></a> method.</p>
<p>When the device host no longer needs to receive notifications from the hosted service, it invokes <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-unadvise"><strong>IUPnPEventSource::Unadvise</strong></a>, passing in the same object pointer that it received from <a href="/windows/desktop/api/Upnphost/nf-upnphost-iupnpeventsource-advise"><strong>Advise</strong></a>. The device host invokes this method when the device is no longer going to be on the network.</p>
<p>Â </p>
<p>Â </p>
</body>
