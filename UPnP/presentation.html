<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Presentation</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Presentation
description: Presentation is the final step in the UPnP process.
ms.assetid: e8d20ae6-2dd8-4de2-b07b-6cf4e725735e
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Presentation</h1>
<p>Presentation is the final step in the UPnP process. If a device has a URL for presentation, a control point can retrieve a page from this URL and load the page into a browser. Depending on the capabilities of the presentation page and the device, the control point can control the device and view the status of the device.</p>
<p>The resource path, which is passed to <a href="/windows/desktop/api/Upnphost/nn-upnphost-iupnpregistrar"><strong>IUPnPRegistrar</strong></a> during registration, is where all the files relevant to the presentation of the device are located. Device developers can provide separate pages for each embedded device. The presentation URL in the device description template can either be an absolute URL or a relative URL. For relative URLs, which are relative to the resource path, the device description template should contain a file name. <strong>IUPnPRegistrar</strong> converts this to a URL with the actual location. For absolute URLs, the location is not modified.</p>
<p>To support client side scripts within a presentation page, extra information is normally appended to the URL in the form of a &quot;query string&quot;. The extra information that is appended is the URL to the device description document, and the UDN of the device or embedded device. The device description URL can be used to load a description document in the script, and then control the device through its services. The UDN is used to select an embedded device from the root device.</p>
<p>The format of the modified presentation URL is: the actual presentation URL, a question mark (&quot;?&quot;), the device description URL, a plus sign (&quot;+&quot;), the device UDN. The question mark denotes the start of the query string.</p>
<p>If the presentation URL in the device description template was an absolute URL and it already contained a question mark (&quot;?&quot;), then the extra information is not added to the presentation URL.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>In the device description template</td>
<td><strong>presentationURL</strong>MyDevice.html**/presentationURL**</td>
</tr>
<tr>
<td>Generated by the device host</td>
<td><strong>presentationURL</strong><a href="https://machinename/deviceID/MyDevice.html/?https://machine/upnphost/udhisapi.dll?content=uuid:487394%C3%A2%E2%82%AC%C2%A6">https://machinename/deviceID/MyDevice.html/?https://machine/upnphost/udhisapi.dll?content=uuid:487394â€¦</a> + UDN**/presentationURL**</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>A client-side script may have to extract the device description URL from the presentation URL to load the <a href="/windows/desktop/api/Upnp/nn-upnp-iupnpdescriptiondocument"><strong>IUPnPDescriptionDocument</strong></a> object. This is done by taking the query string, and terminating it at the plus sign (&quot;+&quot;).</p>
<pre lang="VB"><code>Dim QueryString
QueryString = window.location.search
Dim DescURLString
DescURLString = Trim(Mid(QueryString,2,Instr(QueryString,&quot;+&quot;)-2))&amp; vbCrLf

    Dim LightDesc
    Set LightDesc = CreateObject(&quot;UPnP.DescriptionDocument.1&quot;)
    LightDesc.Load(DescURLString)
</code></pre>
<p>In the case of a presentation page for an embedded device, some additional work is required. After loading the <a href="/windows/desktop/api/Upnp/nn-upnp-iupnpdescriptiondocument"><strong>UPnPDescriptionDocument</strong></a>, the script must obtain the collection of embedded devices, then select the device that matches the UDN in the query string. The following script shows how to select the embedded device for the current presentation page. It assumes LightDesc is already loaded.</p>
<pre lang="VB"><code>Dim LightDevice
Set LightDevice = LightDesc.RootDevice

Dim EmbeddedDevices 
set EmbeddedDevices = LightDevice.Children

Dim DeviceUdnString
DeviceUdnString = Trim(Mid(QueryString,Instr(QueryString,&quot;+&quot;)+1,Len(QueryString)))

Dim Item
set Item = EmbeddedDevices.Item(DeviceUdnString)
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
