<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ActiveX Controls</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: ActiveX Controls
description: ActiveX Controls
ms.assetid: e491b66c-d6ba-4476-8413-7a9e41c05e8d
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>ActiveX Controls</h1>
<p>ActiveX controls technology rests on a foundation consisting of COM, connectable objects, compound documents, property pages, OLE automation, object persistence, and system-provided font and picture objects. As summarized below, each of these core technologies plays a role in controls.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->COM</p>
<!-- raw HTML omitted -->
<p>A control is essentially a COM object that exposes the <a href="/windows/desktop/api/Unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> interface, through which clients can obtain pointers to its other interfaces. Controls can support licensing through <a href="/windows/desktop/api/OCIdl/nn-ocidl-iclassfactory2"><strong>IClassFactory2</strong></a> and self-registration. See <a href="the-component-object-model.html">The Component Object Model</a> for more information on COM, licensing, and self-registration.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Connectable objects</p>
<!-- raw HTML omitted -->
<p>Controls can support outgoing interfaces through connectable objects so that the control can communicate with its client. For example, an outgoing interface can trigger an action in the client, can notify the client of some change in the control, or can request permission from the client before the control takes some action. See <a href="events-in-com-and-connectable-objects.html">Events in COM and Connectable Objects</a> for more information on how connectable objects work.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Uniform data transfer</p>
<!-- raw HTML omitted -->
<p>Controls can support being dragged and dropped within a container with help from their container. See <a href="/windows/desktop/api/OCIdl/nf-ocidl-ioleinplaceobjectwindowless-getdroptarget"><strong>IOleInPlaceObjectWindowless::GetDropTarget</strong></a> for more information on drag and drop.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Compound documents</p>
<!-- raw HTML omitted -->
<p>A control can be an in-place active object that can be embedded in a containing client. An end-user activates the control to initiate an action in the container application. See <a href="compound-documents.html">Compound Documents</a> for more information on in-place activation and other compound document interfaces.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Property pages</p>
<!-- raw HTML omitted -->
<p>Controls can provide property pages so end users can view and change the control's properties. See <a href="property-pages-and-property-sheets.html">Property Pages and Property Sheets</a> for more information on how property pages work.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->OLE automation</p>
<!-- raw HTML omitted -->
<p>Controls can provide programmability through OLE automation so clients can take advantage of the control's features through a programming language supplied by the client. See the OLE Automation section for more information on OLE automation.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Persistent storage</p>
<!-- raw HTML omitted -->
<p>A control can implement one or more of several persistence interfaces to support persistence of its state. The control implementer must decide what kinds of persistence are most important and implement the appropriate persistence interfaces. The client decides which interface it prefers to use. See <a href="the-component-object-model.html">The Component Object Model</a> for more information on all the persistence interfaces.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Font and picture objects</p>
<!-- raw HTML omitted -->
<p>Controls can use these system provided objects to provide a visual representation of themselves within the client. The font object implements several interfaces, including <a href="/windows/desktop/api/OCIdl/nn-ocidl-ifont"><strong>IFont</strong></a> and <a href="/windows/win32/api/ocidl/nn-ocidl-ifontdisp"><strong>IFontDisp</strong></a>. A font object can be created with <a href="/windows/desktop/api/OleCtl/nf-olectl-olecreatefontindirect"><strong>OleCreateFontIndirect</strong></a>. The picture object also implements several interfaces, including <a href="/windows/desktop/api/OCIdl/nn-ocidl-ipicture"><strong>IPicture</strong></a> and <a href="/windows/win32/api/ocidl/nn-ocidl-ipicturedisp"><strong>IPictureDisp</strong></a>. A picture object can be created using <a href="/windows/desktop/api/OleCtl/nf-olectl-olecreatepictureindirect"><strong>OleCreatePictureIndirect</strong></a> and can loaded from a stream with <a href="/windows/desktop/api/OleCtl/nf-olectl-oleloadpicture"><strong>OleLoadPicture</strong></a>.</p>
<!-- raw HTML omitted -->
<p>It is important to understand that these features can be used in any OLE object. One does not need to implement a control in order to use these features. Also, the only required interface on a control is IUnknown. The control optionally supports other interfaces based on the need to support the related features.</p>
<p>In addition to these features, the following interfaces and functions are specific to controls technology: <a href="/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol"><strong>IOleControl</strong></a>, <a href="/windows/desktop/api/OCIdl/nn-ocidl-iolecontrolsite"><strong>IOleControlSite</strong></a>, <a href="/windows/desktop/api/OCIdl/nn-ocidl-isimpleframesite"><strong>ISimpleFrameSite</strong></a>, and <a href="/windows/desktop/api/OleCtl/nf-olectl-oletranslatecolor"><strong>OleTranslateColor</strong></a>. Also specific to controls are a set of standards for properties and methods that a control or a control container can support.</p>
<blockquote>
<p>[!Note]<br />
The system library OleAut32.dll contains implementations of the functions (<a href="/windows/desktop/api/OleCtl/nf-olectl-olecreatepropertyframe"><strong>OleCreatePropertyFrame</strong></a>, <a href="/windows/desktop/api/OleCtl/nf-olectl-olecreatepropertyframeindirect"><strong>OleCreatePropertyFrameIndirect</strong></a>, <a href="/windows/desktop/api/OleCtl/nf-olectl-olecreatefontindirect"><strong>OleCreateFontIndirect</strong></a>, <a href="/windows/desktop/api/OleCtl/nf-olectl-olecreatepictureindirect"><strong>OleCreatePictureIndirect</strong></a>, <a href="/windows/desktop/api/OleCtl/nf-olectl-oleloadpicture"><strong>OleLoadPicture</strong></a>, and <a href="/windows/desktop/api/OleCtl/nf-olectl-oletranslatecolor"><strong>OleTranslateColor</strong></a>). In addition, OleAut32.dll contains the implementations of the standard font and picture objects, as well as a type library for all the interfaces used with controls as well as the additional data structures and data types.</p>
</blockquote>
<p>Â </p>
<p>For more information, see the following topics:</p>
<ul>
<li><a href="activex-controls-architecture.html">ActiveX Controls Architecture</a></li>
<li><a href="activex-controls-interfaces.html">ActiveX Controls Interfaces</a></li>
<li><a href="properties-and-methods.html">Properties and Methods</a></li>
<li><a href="control-events.html">Control Events</a></li>
<li><a href="visual-representation.html">Visual Representation</a></li>
<li><a href="keyboard-handling-for-controls.html">Keyboard Handling for Controls</a></li>
<li><a href="persistence.html">Persistence</a></li>
<li><a href="registration-and-licensing.html">Registration and Licensing</a></li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="activex-control-and-control-container-guidelines.html">ActiveX Control and Control Container Guidelines</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
