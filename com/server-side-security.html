<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Server-Side Security</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Server-Side Security
description: Server-Side Security
ms.assetid: 6c1d210e-daf0-490a-a6b9-65d99b9e1d7d
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Server-Side Security</h1>
<p>The server can retrieve security information about a caller or impersonate the caller by using the methods of <a href="/windows/win32/api/objidlbase/nn-objidlbase-iserversecurity"><strong>IServerSecurity</strong></a>. An implementation of <strong>IServerSecurity</strong> is supplied by COM on the context object for the current call when standard marshaling is used. However, this interface may be absent for some custom-marshaled interfaces.</p>
<p>When a call arrives at the server, the server can call <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cogetcallcontext"><strong>CoGetCallContext</strong></a> to obtain a pointer to the <a href="/windows/win32/api/objidlbase/nn-objidlbase-iserversecurity"><strong>IServerSecurity</strong></a> interface. With this pointer, <strong>IServerSecurity</strong> methods can be called by the server to find out what the client's authentication settings are and to impersonate the client, if needed. The <strong>IServerSecurity</strong> object is valid on any thread in the apartment until the call represented by <strong>IServerSecurity</strong> completes. For more information about impersonation, see <a href="impersonation.html">Impersonation</a> and <a href="cloaking.html">Cloaking</a>.</p>
<p>The following helper functions that rely on the call context object's <a href="/windows/win32/api/objidlbase/nn-objidlbase-iserversecurity"><strong>IServerSecurity</strong></a> interface implementation are also available:</p>
<ul>
<li><a href="/windows/desktop/api/combaseapi/nf-combaseapi-coqueryclientblanket"><strong>CoQueryClientBlanket</strong></a></li>
<li><a href="/windows/desktop/api/combaseapi/nf-combaseapi-coimpersonateclient"><strong>CoImpersonateClient</strong></a></li>
<li><a href="/windows/desktop/api/combaseapi/nf-combaseapi-coreverttoself"><strong>CoRevertToSelf</strong></a></li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="security-in-com.html">Security in COM</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
