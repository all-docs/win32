<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Surrogate Sharing</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Surrogate Sharing
description: DLL servers will share a surrogate if they have matching security identities and share the same AppID value.
ms.assetid: 88544be1-4716-47b6-9c08-2b5b2b178e1f
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Surrogate Sharing</h1>
<p>DLL servers will share a surrogate if they have matching security identities and share the same AppID value.</p>
<p>DLL servers are loaded, by default, into their own surrogate process. To load other DLL servers into an existing surrogate so that it supports more than one DLL server, there are two requirements:</p>
<ul>
<li>The DLL servers must have the same AppID value.</li>
<li>The security context of the DLL servers must be the same.</li>
</ul>
<p>If two DLL servers are to be launched under different security identities, they must be in different surrogates, whether their AppIDs match.</p>
<p>Following is an example of administering surrogate sharing with AppIDs:</p>
<pre lang="syntax"><code>    AppID
        {00001111-aaaa-2222-bbbb-3333cccc4444}
            @DllSurrogate    REG_SZ
    CLSID
        {12345678-0000-0000-0000-000000000001}
            @AppId    REG_SZ    {00001111-aaaa-2222-bbbb-3333cccc4444}
            InProcServer32
    @    REG_SZ    c:\myapp\comp1.dll
        {12345678-0000-0000-0000-000000000002}
            @AppId    REG_SZ    {00001111-aaaa-2222-bbbb-3333cccc4444}
            InProcServer32
    @    REG_SZ    c:\myapp\comp2.dll
 
</code></pre>
<p>The two CLSIDs for DLL components comp1.dll and comp2.dll have been configured to share an AppID. The <a href="appid-key.html">AppID</a> key specifies that the DLL server can be loaded in a surrogate by specifying the <a href="dllsurrogate.html">DllSurrogate</a> value. In this example, the <strong>DllSurrogate</strong> value is an empty string, indicating that the default system implementation of the DLL surrogate should be used.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="dll-server-requirements.html">DLL Server Requirements</a></p>
<!-- raw HTML omitted -->
<p><a href="registering-the-dll-server-for-surrogate-activation.html">Registering the DLL Server for Surrogate Activation</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
