<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DllSurrogate</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: DllSurrogate
description: Enables DLL servers to run in a surrogate process. If an empty string is specified, the system-supplied surrogate is used; otherwise, the value specifies the path of the surrogate to be used.
ms.assetid: ae02d828-9cdb-4faa-8fa9-971da97e27b1
keywords:</p>
<ul>
<li>DllSurrogate registry value COM
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>DllSurrogate</h1>
<p>Enables DLL servers to run in a surrogate process. If an empty string is specified, the system-supplied surrogate is used; otherwise, the value specifies the path of the surrogate to be used.</p>
<h2>Registry Entry</h2>
<pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID
Â Â Â {AppID_GUID}
Â Â Â Â Â Â DllSurrogate = path
</code></pre>
<h2>Remarks</h2>
<p>This is a <strong>REG_SZ</strong> value that specifies that the class is a DLL that is to be activated in a surrogate process, and the surrogate process to be used. To use the system-supplied generic surrogate process, set <em>path</em> to an empty string or <strong>NULL</strong>. To specify another surrogate process, set <em>path</em> to the path of the surrogate. As in the specification of the path of a server under the <a href="localserver32.html"><strong>LocalServer32</strong></a> key, a full path specification is not necessary. The surrogate must be written to properly communicate with the DCOM service as described in <a href="writing-a-custom-surrogate.html">Writing a Custom Surrogate</a>.</p>
<p>The <strong>DllSurrogate</strong> value must be present for a DLL server to be activated in a surrogate. Activation refers to a call to <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject"><strong>CoGetClassObject</strong></a>, <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex"><strong>CoCreateInstanceEx</strong></a>, <strong>CoCreateInstanceEx</strong>, <a href="/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile"><strong>CoGetInstanceFromFile</strong></a>, <a href="/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage"><strong>CoGetInstanceFromIStorage</strong></a>, or <a href="/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtoobject"><strong>IMoniker::BindToObject</strong></a>. Running DLLs in a surrogate process provides the benefits of an executable implementation, including fault isolation, the ability to serve multiple clients simultaneously, and allowing the server to provide services to remote clients in a distributed environment.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/combaseapi/nf-combaseapi-coregistersurrogate"><strong>CoRegisterSurrogate</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="dll-surrogates.html">DLL Surrogates</a></p>
<!-- raw HTML omitted -->
<p><a href="dllsurrogateexecutable.html"><strong>DllSurrogateExecutable</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/objidlbase/nn-objidlbase-isurrogate"><strong>ISurrogate</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
