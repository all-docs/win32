<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Reference Tracking</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Reference Tracking
description: Reference Tracking
ms.assetid: 1e2cf555-3b96-42d5-a0bb-abb720c93520
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Reference Tracking</h1>
<p>Reference tracking can prevent the unintentional or malicious early release of objects.</p>
<p>When you enable reference tracking, you are requesting that distributed <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-addref"><strong>AddRef</strong></a> and <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-release"><strong>Release</strong></a> calls be authenticated by COM. When reference tracking is enabled, COM keeps track of per-user reference counts so that a user can call <strong>Release</strong> only on objects that the user previously called <strong>AddRef</strong> on. Although reference tracking can decrease performance, it ensures that no matter how many times a given user calls <strong>Release</strong>, the objects and stubs will still exist if someone else has a reference to them.</p>
<p>The client can set reference tracking for a process by passing the EOAC_SECURE_REFS capability flag in a call to <a href="/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity"><strong>CoInitializeSecurity</strong></a>. You can also enable or disable reference tracking for all applications on a computer by using Dcomcnfg.exe.</p>
<p>If reference tracking is enabled, <a href="/windows/desktop/api/Unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> always uses default security settings. In this case, calls to <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cosetproxyblanket"><strong>CoSetProxyBlanket</strong></a> on <strong>IUnknown</strong> will fail.</p>
<p>Â </p>
<p>Â </p>
</body>
