<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Delegation of QueryInterface</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Delegation of QueryInterface
description: Delegation of QueryInterface
ms.assetid: c5c1b584-9ca3-4dc4-a769-0142e5d8790a
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Delegation of QueryInterface</h1>
<p>Handlers that require access to some of the internal interfaces on the proxy manager have to go through the <a href="/windows/win32/api/objidlbase/nn-objidlbase-iinternalunknown"><strong>IInternalUnknown</strong></a> interface. This prevents handlers from blindly delegating and exposing the aggregatee's internal interfaces outside of the aggregate. These interfaces include <a href="/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity"><strong>IClientSecurity</strong></a> and <a href="/windows/win32/api/objidlbase/nn-objidlbase-imultiqi"><strong>IMultiQI</strong></a>. If the handler wants to expose <strong>IClientSecurity</strong> or <strong>IMultiQI</strong>, it should implement them itself.</p>
<p>In the case of <a href="/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity"><strong>IClientSecurity</strong></a>, if the client tries to set the security on an interface that the handler has exposed, the handler should set the security on the underlying network interface proxy.</p>
<p>In the case of <a href="/windows/win32/api/objidlbase/nn-objidlbase-imultiqi"><strong>IMultiQI</strong></a>, the handler should fill in the interfaces it knows about and then forward the call to the proxy manager to get the rest of the interfaces filled in.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="the-lightweight-client-side-handler.html">The Lightweight Client-Side Handler</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
