<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>LocalService</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: LocalService
description: Installs an object as a service application.
ms.assetid: e8086118-f956-4cc2-a0fb-3cebd2e66799
keywords:</p>
<ul>
<li>LocalService registry value COM
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>LocalService</h1>
<p>Installs an object as a service application.</p>
<h2>Registry Entry</h2>
<pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID
Â Â Â {AppID_GUID}
Â Â Â Â Â Â LocalService = name
</code></pre>
<h2>Remarks</h2>
<p>In addition to running as a local server executable (EXE), a COM object may also choose to package itself to run as a service application when activated by a local or remote client. Services support numerous useful and UI-integrated administrative features, including local and remote starting, stopping, pausing, and restarting, as well as the ability to establish the server to run under a specific user account and window station.</p>
<p>An object written as a service is installed for use by COM by establishing a <strong>LocalService</strong> value and performing a standard service installation. The <strong>LocalService</strong> value must be set to the service name, as configured in <strong>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services</strong>, as the default <strong>REG_SZ</strong> value.</p>
<p>When <strong>LocalService</strong> is set, any string assigned to <a href="serviceparameters.html"><strong>ServiceParameters</strong></a> is passed as a command-line argument to the service as it is being launched.</p>
<p>The service configuration is preferred in many situations where the capabilities of the local and remote service management APIs and user interface might be useful for the services that the object provides. For example, leveraging the existing administrative framework of the service architecture should be an obvious choice if the object is long-lived or readily supports concepts such as starting, stopping, resetting, or pausing.</p>
<p>Services can be dynamically configured and can be configured to run automatically when the machine boots, or to be launched when requested by a client application.</p>
<p>If you are implementing classes as services, you should be aware of the following points:</p>
<ul>
<li>This value is used in preference to the <a href="localserver32.html"><strong>LocalServer32</strong></a> key for local and remote activation requests, if <strong>LocalService</strong> exists and refers to a valid service, the <strong>LocalServer32</strong> key is ignored.</li>
<li>Currently, only a single instance of a service application may be running at a given time on a computer. COM services must therefore register their class objects on launch using REGCLS_MULTIPLEUSE to support multiple clients.</li>
<li>To launch and initialize properly, COM services configured to run automatically when a machine boots must include RPCSS in their list of dependent services.</li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="registering-com-servers.html">Registering COM Servers</a></p>
<!-- raw HTML omitted -->
<p><a href="serviceparameters.html"><strong>ServiceParameters</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/Services/services">Services</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
