<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Optional Methods</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Optional Methods
description: Optional Methods
ms.assetid: 8cdb5686-177c-48c9-8315-e5921520007c
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>Optional Methods</h1>
<p>An OLE component can implement an interface without implementing all the semantics of every method in the interface, instead returning E_NOTIMPL or S_OK as appropriate. The following table describes those methods that an ActiveX control container is not required to implement (i.e. the control container can return E_NOTIMPL).</p>
<p>The table below describes optional methods; note that the method must still exist, but can simply return E_NOTIMPL instead of implementing real semantics. Note that any method from a mandatory interface that is not listed below must be considered mandatory and may not return E_NOTIMPL.</p>
<h2>IOleClientSite</h2>
<table>
<thead>
<tr>
<th>Method</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-saveobject"><strong>SaveObject</strong></a><!-- raw HTML omitted --></td>
<td>Necessary for persistence to be successfully supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-getmoniker"><strong>GetMoniker</strong></a><!-- raw HTML omitted --></td>
<td>Necessary only if the container supports linking to controls within its own form or document.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>IOleInPlaceSite</h2>
<table>
<thead>
<tr>
<th>Method</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-contextsensitivehelp"><strong>ContextSensitiveHelp</strong></a><!-- raw HTML omitted --></td>
<td>Optional<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleinplacesite-scroll"><strong>Scroll</strong></a><!-- raw HTML omitted --></td>
<td>May return S_FALSE with no action.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleinplacesite-discardundostate"><strong>DiscardUndoState</strong></a><!-- raw HTML omitted --></td>
<td>Can return S_OK with no action.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleinplacesite-deactivateandundo"><strong>DeactivateAndUndo</strong></a><!-- raw HTML omitted --></td>
<td>Deactivation is mandatory; Undo is optional. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>IOleControlSite</h2>
<table>
<thead>
<tr>
<th>Method</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-getextendedcontrol"><strong>GetExtendedControl</strong></a><!-- raw HTML omitted --></td>
<td>Necessary for containers that support extended controls.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-showpropertyframe"><strong>ShowPropertyFrame</strong></a><!-- raw HTML omitted --></td>
<td>Necessary for containers that wish to include their own property pages to handle extended control properties in addition to those provided by a control.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-translateaccelerator"><strong>TranslateAccelerator</strong></a><!-- raw HTML omitted --></td>
<td>May return S_FALSE with no action.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-lockinplaceactive"><strong>LockInPlaceActive</strong></a><!-- raw HTML omitted --></td>
<td>Optional<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>IDispatch (Ambient properties)</h2>
<table>
<thead>
<tr>
<th>Method</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td>GetTypeInfoCount<!-- raw HTML omitted --></td>
<td>Necessary for containers that support non-standard ambient properties.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>GetTypeInfo<!-- raw HTML omitted --></td>
<td>Necessary for containers that support non-standard ambient properties.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>GetIDsOfNames<!-- raw HTML omitted --></td>
<td>Necessary for containers that support non-standard ambient properties.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>IDispatch (Event sink)</h2>
<table>
<thead>
<tr>
<th>Method</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td>GetTypeInfoCount<!-- raw HTML omitted --></td>
<td>The control knows its own type information, so it has no need to call this.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>GetTypeInfo<!-- raw HTML omitted --></td>
<td>The control knows its own type information, so it has no need to call this.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>GetIDsOfNames<!-- raw HTML omitted --></td>
<td>The control knows its own type information, so it has no need to call this.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>IOleInPlaceFrame</h2>
<table>
<thead>
<tr>
<th>Method</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-contextsensitivehelp"><strong>ContextSensitiveHelp</strong></a><!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceuiwindow-getborder"><strong>GetBorder</strong></a><!-- raw HTML omitted --></td>
<td>Necessary for containers with toolbar UI (which is optional)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceuiwindow-requestborderspace"><strong>RequestBorderSpace</strong></a><!-- raw HTML omitted --></td>
<td>Necessary for containers with toolbar UI (which is optional)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceuiwindow-setborderspace"><strong>SetBorderSpace</strong></a><!-- raw HTML omitted --></td>
<td>Necessary for containers with toolbar UI (which is optional)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceframe-insertmenus"><strong>InsertMenus</strong></a><!-- raw HTML omitted --></td>
<td>Necessary for containers with menu UI (which is optional)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceframe-setmenu"><strong>SetMenu</strong></a><!-- raw HTML omitted --></td>
<td>Necessary for containers with menu UI (which is optional)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceframe-removemenus"><strong>RemoveMenus</strong></a><!-- raw HTML omitted --></td>
<td>Necessary for containers with menu UI (which is optional)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceframe-setstatustext"><strong>SetStatusText</strong></a><!-- raw HTML omitted --></td>
<td>Necessary only for containers that have a status line<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceframe-enablemodeless"><strong>EnableModeless</strong></a><!-- raw HTML omitted --></td>
<td>Optional<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceframe-translateaccelerator"><strong>TranslateAccelerator</strong></a><!-- raw HTML omitted --></td>
<td>Optional<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>IOleContainer</h2>
<table>
<thead>
<tr>
<th>Method</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-iparsedisplayname-parsedisplayname"><strong>ParseDisplayName</strong></a><!-- raw HTML omitted --></td>
<td>Only if linking to controls or other embeddings in the container is supported, as this is necessary for moniker binding.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-iolecontainer-lockcontainer"><strong>LockContainer</strong></a><!-- raw HTML omitted --></td>
<td>As for ParseDisplayName<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nf-oleidl-iolecontainer-enumobjects"><strong>EnumObjects</strong></a><!-- raw HTML omitted --></td>
<td>Returns all ActiveX controls through an enumerator with <a href="/windows/win32/api/objidlbase/nn-objidlbase-ienumunknown"><strong>IEnumUnknown</strong></a>, but not necessarily all objects (because there's no guarantee that all objects are ActiveX controls; some may be regular Windows controls).<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="containers.html">Containers</a></p>
<!-- raw HTML omitted -->
</body>
