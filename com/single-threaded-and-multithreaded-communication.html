<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Single-Threaded and Multithreaded Communication</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Single-Threaded and Multithreaded Communication
description: Single-Threaded and Multithreaded Communication
ms.assetid: 8d3a855c-b52d-48bb-9fdf-efbf8005c374
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Single-Threaded and Multithreaded Communication</h1>
<p>A client or server that supports both single-threaded and multithreaded apartments will have one multithreaded apartment, containing all threads initialized as free-threaded, and one or more single-threaded apartments. Interface pointers must be marshaled between apartments but can be used without marshaling within an apartment. Calls to objects in a single-threaded apartment will be synchronized by COM. Calls to objects in the multithreaded apartment will not be synchronized by COM.</p>
<p>All of the information on single-threaded apartments applies to the threads marked as apartment model, and all of the information on multithreaded apartments applies to all of the threads marked as free-threaded. Apartment threading rules apply to inter-apartment communication, requiring that interface pointers be marshaled between apartments with calls to <a href="/windows/desktop/api/combaseapi/nf-combaseapi-comarshalinterthreadinterfaceinstream"><strong>CoMarshalInterThreadInterfaceInStream</strong></a> and <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cogetinterfaceandreleasestream"><strong>CoGetInterfaceAndReleaseStream</strong></a>, as described in <a href="single-threaded-apartments.html">Single-Threaded Apartments</a>.</p>
<blockquote>
<p>[!Note]<br />
Some special considerations apply when dealing with in-process servers. For more information, see <a href="in-process-server-threading-issues.html">In-Process Server Threading Issues</a>.</p>
</blockquote>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="accessing-interfaces-across-apartments.html">Accessing Interfaces Across Apartments</a></p>
<!-- raw HTML omitted -->
<p><a href="choosing-the-threading-model.html">Choosing the Threading Model</a></p>
<!-- raw HTML omitted -->
<p><a href="multithreaded-apartments.html">Multithreaded Apartments</a></p>
<!-- raw HTML omitted -->
<p><a href="in-process-server-threading-issues.html">In-Process Server Threading Issues</a></p>
<!-- raw HTML omitted -->
<p><a href="processes--threads--and-apartments.html">Processes, Threads, and Apartments</a></p>
<!-- raw HTML omitted -->
<p><a href="single-threaded-apartments.html">Single-Threaded Apartments</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
