<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Storage Interfaces</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Storage Interfaces
description: Storage Interfaces
ms.assetid: bce0fd46-eeba-4a14-be1f-63d16885c28d
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Storage Interfaces</h1>
<p>Control containers must be able to support controls that implement <a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage"><strong>IPersistStorage</strong></a>, <a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream"><strong>IPersistStream</strong></a>, or <a href="/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit"><strong>IPersistStreamInit</strong></a>. Optionally, a container can support any other persistence interfaces such as <a href="/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)"><strong>IPersistMemory</strong></a>, <a href="/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag"><strong>IPersistPropertyBag</strong></a>, and <a href="/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)"><strong>IPersistMoniker</strong></a> for those controls that provide support.</p>
<p>Once an ActiveX control container has chosen and initialized a storage interface to use (<a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage"><strong>IPersistStorage</strong></a>, <a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream"><strong>IPersistStream</strong></a>, <a href="/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit"><strong>IPersistStreamInit</strong></a>, etc), that storage interface will remain the primary storage interface for the lifetime of the control, i.e. the control will remain in possession of the storage. This does not preclude the container from saving to other storage interfaces.</p>
<p>ActiveX control containers do not need to support a save as text mechanism, thus using <a href="/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag"><strong>IPersistPropertyBag</strong></a> and the associated container-side interface <a href="/windows/win32/api/oaidl/nn-oaidl-ipropertybag"><strong>IPropertyBag</strong></a> are optional.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="containers.html">Containers</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
