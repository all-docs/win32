<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>FileType Key</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: FileType Key
description: Used by GetClassFile to match patterns against various file bytes in a non-compound file.
ms.assetid: ced23cdb-c184-43fe-ba37-fe1af8664b66
keywords:</p>
<ul>
<li>FileType registry key COM
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>FileType Key</h1>
<p>Used by <a href="/windows/desktop/api/Objbase/nf-objbase-getclassfile"><strong>GetClassFile</strong></a> to match patterns against various file bytes in a non-compound file.</p>
<h2>Registry Entry</h2>
<pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Classes\FileType
Â Â Â {CLSID}
Â Â Â Â Â Â n = offset, cb, mask, value
</code></pre>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>offset</em></p>
<!-- raw HTML omitted -->
<p>Determines how far from the beginning or end of the file to begin the comparison. If the offset is a negative value, the comparison begins from the end of the file minus the offset value. The offset value is a decimal type unless preceded by &quot;0x&quot;.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>cb</em></p>
<!-- raw HTML omitted -->
<p>Represents the length in bytes from the beginning to the end of the file. Represents the byte range in the file. The <em>cb</em> value is a decimal unless preceded by &quot;0x&quot;.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>mask</em></p>
<!-- raw HTML omitted -->
<p>A binary value used for masking, which is performed by using a logical AND operation, and the byte range specified by <em>offset</em> and <em>cb</em>. If this value is omitted, the bytes are set to all ones. This value is always hexadecimal.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><em>value</em></p>
<!-- raw HTML omitted -->
<p>Represents the pattern that must match for a file to be of this file type. The pattern is used to properly identify a known file format from its contents, not by its extension.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>Entries are used by the <a href="/windows/desktop/api/Objbase/nf-objbase-getclassfile"><strong>GetClassFile</strong></a> function to match patterns against various file bytes in a non-compound file. <strong>FileType</strong> has CLSID subkeys, each of which has a series of subkeys <strong>0</strong>, <strong>1</strong>, <strong>2</strong>, <strong>3</strong>. These values contain patterns that, if one matches, yield the indicated CLSID. For example, a value of &quot;0, 4, FFFFFFFF, ABCD1234&quot; indicates that the first 4 bytes must be ABCD1234, in that order. A value of &quot;-4, 4, FEFEFEFE &quot; indicates that the last four bytes in the file must be FEFEFEFE. If either pattern matches, the CLSID is returned.</p>
<p>The <strong>HKEY_LOCAL_MACHINE\SOFTWARE\Classes</strong> key corresponds to the <strong>HKEY_CLASSES_ROOT</strong> key, which was retained for compatibility with earlier versions of COM.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="-file-extension--key.html"><strong><!-- raw HTML omitted --></strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Objbase/nf-objbase-getclassfile"><strong>GetClassFile</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
