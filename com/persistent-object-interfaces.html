<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Persistent Object Interfaces</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Persistent Object Interfaces (COM)
description: A persistent object implements one or more persistent object interfaces.
ms.assetid: 8c8e44e4-f564-4af5-9a8a-ac6883862cae
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Persistent Object Interfaces</h1>
<p>A persistent object implements one or more <em>persistent object interfaces</em>. Clients use persistent object interfaces to tell those objects when and where to store their state. All persistent object interfaces are derived from <a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersist"><strong>IPersist</strong></a>, so any object that implements any persistent object interface also implements <strong>IPersist</strong>.</p>
<p>The following persistent object interfaces are currently defined:</p>
<ul>
<li><a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream"><strong>IPersistStream</strong></a></li>
<li><a href="/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit"><strong>IPersistStreamInit</strong></a></li>
<li><a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage"><strong>IPersistStorage</strong></a></li>
<li><a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersistfile"><strong>IPersistFile</strong></a></li>
<li><a href="/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)"><strong>IPersistMoniker</strong></a></li>
<li><a href="/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)">IPersistMemory</a></li>
<li><a href="/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)">IPersistPropertyBag</a></li>
</ul>
<p>Implementers choose which persistent object interfaces an object supports depending on how the object is to be used. By not supporting any persistent object interfaces, the implementer is effectively saying, &quot;This object's state cannot be persistently stored.&quot; By supporting one or more persistent object interfaces, the implementer is effectively saying, &quot;This object's state can be persistently stored in one or more data store mediums.&quot;</p>
<p>For example, the following table lists several object types that allow support for different persistent object interfaces.</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Persistent object interfaces typically supported</th>
</tr>
</thead>
<tbody>
<tr>
<td>Monikers<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream"><strong>IPersistStream</strong></a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>OLE embeddable objects<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage"><strong>IPersistStorage</strong></a>, <a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersistfile"><strong>IPersistFile</strong></a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>ActiveX controls<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit"><strong>IPersistStreamInit</strong></a>, <a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage"><strong>IPersistStorage</strong></a>, IPersistMemory, IPersistPropertyBag, <a href="/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)"><strong>IPersistMoniker</strong></a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>ActiveX document objects<!-- raw HTML omitted --></td>
<td><a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage"><strong>IPersistStorage</strong></a>, <a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersistfile"><strong>IPersistFile</strong></a><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Client implementers can also choose which persistent object interfaces the client can use. The interfaces a client uses is usually determined by where the client can store its own data. A client that can store its data only in a flat file will probably use only <a href="/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit"><strong>IPersistStreamInit</strong></a>, <a href="/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)"><strong>IPersistMoniker</strong></a>, and IPersistPropertyBag. (<strong>IPersistStreamInit</strong> can replace <a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream"><strong>IPersistStream</strong></a> in most applications, because it contains that definition and adds an initialization method.) A client that can save its data to a structured storage file will, in addition, use <a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage"><strong>IPersistStorage</strong></a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="initializing-persistent-objects.html">Initializing Persistent Objects</a></p>
<!-- raw HTML omitted -->
</body>
