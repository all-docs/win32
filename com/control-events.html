<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Control Events (COM)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Control Events (COM)
description: In addition to providing properties and methods, a control also provides outgoing interfaces to notify its client of events.
ms.assetid: e7085bc0-c087-4cc8-9c69-ba05b0923b74
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Control Events (COM)</h1>
<p>In addition to providing properties and methods, a control also provides outgoing interfaces to notify its client of events. The client must support handling of these events. See <a href="events-in-com-and-connectable-objects.html">Events in COM and Connectable Objects</a> for more information on how connectable objects work.</p>
<p>A control can support different outgoing interfaces for different purposes. All outgoing interfaces are marked as source interfaces in the control's type information, but only one is marked default to indicate that it is the primary outgoing interface.</p>
<p>A container can support one or more of the outgoing interfaces defined by a control. The control should be prepared to deal with containers that only provide support for some of their outgoing interfaces.</p>
<p>Controls support four kinds of events:</p>
<ul>
<li>Request events. A control requests permission from its client to do something by calling a method in the outgoing interface, thus triggering a request event. The client signals the control through a boolean, out-parameter in the method that the control called. The client can thus prevent the control from performing the action.</li>
<li>Before events. A control notifies its client hat it is going to do something by calling a method in the outgoing interface, thus triggering a before event. The client does not have the opportunity to prevent the action, but it can take any necessary steps given the action that is about to occur.</li>
<li>After events. A control notifies its client that it has just done something by calling a method in the outgoing interface, thus triggering an after event. Again, the client cannot cancel this action, but it can take necessary steps given the action that has occurred.</li>
<li>Do events. A control triggers a do event to allow its client to override the control's action and provide some alternative or supplementary actions. Usually, the method that a control calls for a do event has a number of parameters for negotiating with the client about the actions that will occur.</li>
</ul>
<p>The following dispids are defined for standard events that controls can support: Click, DblClick, KeyDown, KeyPress, KeyUp, MouseMove, MouseUp, and Error. All of these standard events have negative DISPID values, indicating their standard status.</p>
<p>The <a href="/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents"><strong>IOleControl::FreezeEvents</strong></a> method, when called with <strong>TRUE</strong>, tells a control whether the container will bother handling events from the control until <strong>FreezeEvents</strong> is again called with <strong>FALSE</strong>. During this time control cannot depend on the container actually handling any events. If an event must be handled, the control should queue the event in order to fire it when <strong>FreezeEvents</strong> is called with <strong>FALSE</strong>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="activex-controls.html">ActiveX Controls</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
