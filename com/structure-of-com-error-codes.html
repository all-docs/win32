<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Structure of COM Error Codes</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Structure of COM Error Codes
description: Structure of COM Error Codes
ms.assetid: 97e68708-eb62-4481-af03-cf8b80304103
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Structure of COM Error Codes</h1>
<p>The following illustration shows the format of an <a href="/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a"><strong>HRESULT</strong></a> (or SCODE); the numbers indicate bit positions:</p>
<p><img src="images/a5a947d1-7b5a-4474-afed-2a1c58fe2421.png" alt="Shows the format of an 'H RESULT' or 'S CODE' with numbers indicating bit positions." /></p>
<p>The high-order bit in the <strong>HRESULT</strong> or SCODE indicates whether the return value represents success or failure. If set to 0, SEVERITY_SUCCESS, the value indicates success. If set to 1, SEVERITY_ERROR, it indicates failure.</p>
<p>The R, C, N, and r bits are reserved.</p>
<p>The facility field indicates the system service responsible for the error. Microsoft allocates new facility codes as they become necessary. Most SCODEs and <strong>HRESULT</strong> values set the facility field to FACILITY_ITF, indicating an interface method error.</p>
<p>Common facility fields are described in the following table.</p>
<table>
<thead>
<tr>
<th>Facility Field</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>FACILITY_DISPATCH<!-- raw HTML omitted --></td>
<td>2<!-- raw HTML omitted --></td>
<td>For late-binding <strong>IDispatch</strong> interface errors. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>FACILITY_ITF<!-- raw HTML omitted --></td>
<td>4<!-- raw HTML omitted --></td>
<td>For most status codes returned from interface methods. The actual meaning of the error is defined by the interface. That is, two <strong>HRESULT</strong>s with exactly the same 32-bit value returned from two different interfaces might have different meanings. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>FACILITY_NULL<!-- raw HTML omitted --></td>
<td>0<!-- raw HTML omitted --></td>
<td>For broadly applicable common status codes such as S_OK. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>FACILITY_RPC<!-- raw HTML omitted --></td>
<td>1<!-- raw HTML omitted --></td>
<td>For status codes returned from remote procedure calls. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>FACILITY_STORAGE<!-- raw HTML omitted --></td>
<td>3<!-- raw HTML omitted --></td>
<td>For status codes returned from <a href="/windows/desktop/api/objidl/nn-objidl-istorage"><strong>IStorage</strong></a> or <a href="/windows/desktop/api/objidl/nn-objidl-istream"><strong>IStream</strong></a> method calls relating to structured storage. Status codes whose code (lower 16 bits) value is in the range of MS-DOS error codes (that is, less than 256) have the same meaning as the corresponding MS-DOS error. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>FACILITY_WIN32<!-- raw HTML omitted --></td>
<td>7<!-- raw HTML omitted --></td>
<td>Used to provide a means of handling error codes from functions in the Windows API as an <strong>HRESULT</strong>. Error codes in 16-bit OLE that duplicated system error codes have also been changed to FACILITY_WIN32. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>FACILITY_WINDOWS<!-- raw HTML omitted --></td>
<td>8<!-- raw HTML omitted --></td>
<td>Used for additional error codes from Microsoft-defined interfaces.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>The code field is a unique number that is assigned to represent the error or warning.</p>
<p>By convention, <strong>HRESULT</strong> values generally have names in the following format: <em>Facility</em>_<em>Severity</em>_<em>Reason</em>.</p>
<p><em>Facility</em> is either the facility name or some other distinguishing identifier; <em>Severity</em> is a single letter, S or E, that indicates whether the function call succeeded (S) or produced an error (E); and <em>Reason</em> is an identifier that describes the meaning of the code. For example, the status code STG_E_FILENOTFOUND indicates a storage-related error has occurred; specifically, a requested file does not exist. Status codes from FACILITY_NULL omit the <em>Facility</em>_ prefix.</p>
<p>Error codes are defined within the context of an interface implementation. Once defined, success codes cannot be changed or new success codes added. However, new failure codes can be written. Microsoft reserves the right to define new failure codes (but not success codes) for the interfaces described in FACILITY_ITF or in new facilities.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="error-handling-in-com.html">Error Handling in COM</a></p>
<!-- raw HTML omitted -->
<p><a href="/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a">Windows Protocols: HRESULT</a></p>
<!-- raw HTML omitted -->
</body>
