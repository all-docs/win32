<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IUnknown and Interface Inheritance</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: IUnknown and Interface Inheritance
description: IUnknown and Interface Inheritance
ms.assetid: c45f0947-6020-4aa1-9250-561603a46a68
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>IUnknown and Interface Inheritance</h1>
<p>Inheritance in COM does not mean code reuse. Because no implementations are associated with interfaces, interface inheritance does not mean code inheritance. It means only that the contract associated with an interface is inherited in a C++ pure-virtual base-class fashion and modified â€” either by adding new methods or by further qualifying the allowed usage of methods. There is no selective inheritance in COM. If one interface inherits from another, it includes all the methods that the other interface defines.</p>
<p>Inheritance is used sparingly in the predefined COM interfaces. All predefined interfaces (and any custom interfaces you define) inherit their definitions from the important interface <a href="/windows/desktop/api/Unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a>, which contains three vital methods: <a href="/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)"><strong>QueryInterface</strong></a>, <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-addref"><strong>AddRef</strong></a>, and <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-release"><strong>Release</strong></a>. All COM objects must implement the <strong>IUnknown</strong> interface because it provides the means, using <strong>QueryInterface</strong>, to move freely between the different interfaces that an object supports as well as the means to manage its lifetime by using <strong>AddRef</strong> and <strong>Release</strong>.</p>
<p>In creating an object that supports <a href="aggregation.html">aggregation</a>, you would need to implement one set of <a href="/windows/desktop/api/Unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> functions for all interfaces as well as a stand-alone <strong>IUnknown</strong> interface. In any case, any object implementor will implement <strong>IUnknown</strong> methods. See the section <a href="using-and-implementing-iunknown.html">Using and Implementing IUnknown</a> for more information.</p>
<p>While there are a few interfaces that inherit their definitions from a second interface in addition to <a href="/windows/desktop/api/Unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a>, the majority simply inherit the <strong>IUnknown</strong> interface methods. This makes most interfaces relatively compact and easy to encapsulate.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="com-objects-and-interfaces.html">COM Objects and Interfaces</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
