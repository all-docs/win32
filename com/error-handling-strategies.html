<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Error Handling Strategies</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Error Handling Strategies
description: Error Handling Strategies
ms.assetid: 8d03ede8-0661-43dc-adaf-3c1f5fc1687e
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Error Handling Strategies</h1>
<p>Because interface methods are virtual, it is not possible for a caller to know the full set of values that may be returned from any one call. One implementation of a method may return five values; another may return eight.</p>
<p>The documentation lists common values that may be returned for each method; these are the values that you must check for and handle in your code because they have special meanings. Other values may be returned, but because they are not meaningful, you do not need to write special code to handle them. A simple check for zero or nonzero is adequate.</p>
<h2>HRESULT Values</h2>
<p>The return value of COM functions and methods is an <strong>HRESULT</strong>. The values of some HRESULTs have been changed in COM to eliminate all duplication and overlapping with the system error codes. Those that duplicate system error codes have been changed to FACILITY_WIN32, and those that overlap remain in FACILITY_NULL. Common <strong>HRESULT</strong> values and their values are listed in the following table.</p>
<table>
<thead>
<tr>
<th>HRESULT</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>E_ABORT<!-- raw HTML omitted --></td>
<td>0x80004004<!-- raw HTML omitted --></td>
<td>The operation was aborted because of an unspecified error.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>E_ACCESSDENIED<!-- raw HTML omitted --></td>
<td>0x80070005<!-- raw HTML omitted --></td>
<td>A general access-denied error.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>E_FAIL<!-- raw HTML omitted --></td>
<td>0x80004005<!-- raw HTML omitted --></td>
<td>An unspecified failure has occurred.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>E_HANDLE<!-- raw HTML omitted --></td>
<td>0x80070006<!-- raw HTML omitted --></td>
<td>An invalid handle was used.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>E_INVALIDARG<!-- raw HTML omitted --></td>
<td>0x80070057<!-- raw HTML omitted --></td>
<td>One or more arguments are invalid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>E_NOINTERFACE<!-- raw HTML omitted --></td>
<td>0x80004002<!-- raw HTML omitted --></td>
<td>The <a href="/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)"><strong>QueryInterface</strong></a> method did not recognize the requested interface. The interface is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>E_NOTIMPL<!-- raw HTML omitted --></td>
<td>0x80004001<!-- raw HTML omitted --></td>
<td>The method is not implemented.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>E_OUTOFMEMORY<!-- raw HTML omitted --></td>
<td>0x8007000E<!-- raw HTML omitted --></td>
<td>The method failed to allocate necessary memory.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>E_PENDING<!-- raw HTML omitted --></td>
<td>0x8000000A<!-- raw HTML omitted --></td>
<td>The data necessary to complete the operation is not yet available.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>E_POINTER<!-- raw HTML omitted --></td>
<td>0x80004003<!-- raw HTML omitted --></td>
<td>An invalid pointer was used.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>E_UNEXPECTED<!-- raw HTML omitted --></td>
<td>0x8000FFFF<!-- raw HTML omitted --></td>
<td>A catastrophic failure has occurred.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>S_FALSE<!-- raw HTML omitted --></td>
<td>0x00000001<!-- raw HTML omitted --></td>
<td>The method succeeded and returned the boolean value <strong>FALSE</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>S_OK<!-- raw HTML omitted --></td>
<td>0x00000000<!-- raw HTML omitted --></td>
<td>The method succeeded. If a boolean return value is expected, the returned value is <strong>TRUE</strong>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Network Errors</h2>
<p>If the first four digits of the error code are 8007, this indicates a system or network error. You can use the <strong>net</strong> command to decode these types of errors. To decode the error, first convert the last four digits of the hexadecimal error code to decimal. Then, at the command prompt, type the following, where decimal code is replaced with the return value you want to decode:</p>
<p><strong>net helpmsg <!-- raw HTML omitted --></strong></p>
<p>The net command returns a description of the error. For example, if COM returns the error 8007054B, convert the 054B to decimal (1355). Then type the following:</p>
<p><strong>net helpmsg 1355</strong></p>
<p>The net command returns the error description: &quot;The specified domain did not exist&quot;.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="error-handling-in-com.html">Error Handling in COM</a></p>
<!-- raw HTML omitted -->
</body>
