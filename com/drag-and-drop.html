<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Drag and Drop</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Drag and Drop
description: Drag and drop refers to data transfers in which a mouse or other pointing device is used to specify both the data source and its destination.
ms.assetid: bba0ddf8-fcf9-4827-bf85-7ac597d33b4b
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Drag and Drop</h1>
<p><em>Drag and drop</em> refers to data transfers in which a mouse or other pointing device is used to specify both the data source and its destination. In a typical drag and drop operation, a user selects the object to be transferred by moving the mouse pointer to it and holding down either the left button or some other button designated for this purpose. While continuing to hold down the button, the user initiates the transfer by dragging the object to its destination, which can be any OLE container. Drag and drop provides exactly the same functionality as the OLE clipboard copy and paste but adds visual feedback and eliminates the need for menus. In fact, if an application supports clipboard copy and paste, little extra is needed to support drag and drop.</p>
<p>During an OLE drag and drop operation, the following three separate pieces of code are used.</p>
<table>
<thead>
<tr>
<th>Drag-and-drop code source</th>
<th>Implementation and use</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nn-oleidl-idropsource"><strong>IDropSource</strong></a> interface<!-- raw HTML omitted --></td>
<td>Implemented by the object containing the dragged data, referred to as the <em>drag source</em>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/OleIdl/nn-oleidl-idroptarget"><strong>IDropTarget</strong></a> interface<!-- raw HTML omitted --></td>
<td>Implemented by the object that is intended to accept the drop, referred to as the <em>drop target</em>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ole2/nf-ole2-dodragdrop"><strong>DoDragDrop</strong></a> function<!-- raw HTML omitted --></td>
<td>Implemented by OLE and used to initiate a drag and drop operation. After the operation is in progress, it facilitates communication between the drag source and the drop target.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>The <a href="/windows/desktop/api/OleIdl/nn-oleidl-idropsource"><strong>IDropSource</strong></a> and <a href="/windows/desktop/api/OleIdl/nn-oleidl-idroptarget"><strong>IDropTarget</strong></a> interfaces can be implemented in either a container or in an object application. The role of drag source or drop target is not limited to any one type of OLE application.</p>
<p>The OLE function <a href="/windows/desktop/api/Ole2/nf-ole2-dodragdrop"><strong>DoDragDrop</strong></a> implements a loop that tracks mouse and keyboard movement until such time as the drag is canceled or a drop occurs. <strong>DoDragDrop</strong> is the key function in the drag and drop process, facilitating communication between the drag source and drop target.</p>
<p>During a drag and drop operation, three types of feedback can be displayed to the user.</p>
<table>
<thead>
<tr>
<th>Type of feedback</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Source feedback<!-- raw HTML omitted --></td>
<td>Provided by the drag source, the source feedback indicates the data is being dragged and does not change during the course of the drag. Typically, the data is highlighted to signal it has been selected.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Pointer feedback<!-- raw HTML omitted --></td>
<td>Provided by the drag source, the pointer feedback indicates what happens if the mouse is released at any given moment. Pointer feedback changes continually as the user moves the mouse and/or presses a modifier key. For example, if the pointer is moved into a window that cannot accept a drop, the pointer changes to the &quot;not allowed&quot; symbol.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Target feedback<!-- raw HTML omitted --></td>
<td>Provided by the drop target, target feedback indicates where the drop is to occur.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>For more information, see <a href="drag-source-responsibilities.html">Drag Source Responsibilities</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="data-transfer.html">Data Transfer</a></p>
<!-- raw HTML omitted -->
</body>
