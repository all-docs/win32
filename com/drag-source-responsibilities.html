<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Drag Source Responsibilities</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Drag Source Responsibilities
description: Drag Source Responsibilities
ms.assetid: bafef0c1-f78e-424a-9ed0-07764a60b22d
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Drag Source Responsibilities</h1>
<p>The drag source is responsible for the following tasks:</p>
<ul>
<li>Providing a data-transfer object for the drop target that exposes the <a href="/windows/desktop/api/ObjIdl/nn-objidl-idataobject"><strong>IDataObject</strong></a> and <a href="/windows/desktop/api/OleIdl/nn-oleidl-idropsource"><strong>IDropSource</strong></a> interfaces.</li>
<li>Generating pointer and source feedback.</li>
<li>Determining when the drag operation has been canceled or a drop operation has occurred.</li>
<li>Performing any action on the original data caused by the drop operation, such as deleting the data or creating a link to it.</li>
</ul>
<p>The main task is creating a data-transfer object that exposes the <a href="/windows/desktop/api/ObjIdl/nn-objidl-idataobject"><strong>IDataObject</strong></a> and <a href="/windows/desktop/api/OleIdl/nn-oleidl-idropsource"><strong>IDropSource</strong></a> interfaces. The drag source might or might not include a copy of the selected data. Including it is not mandatory, but doing so helps protect against inadvertent changes and allows the Clipboard operations code to be identical to the drag and drop code.</p>
<p>While a drag operation is in progress, the drag source is responsible for setting the mouse pointer and, if appropriate, for providing additional source feedback to the user. The drag source cannot provide any feedback that tracks the mouse position other than by actually setting the real pointer (see the <a href="/windows/win32/api/winuser/nf-winuser-setcursor"><strong>SetCursor</strong></a> function). This rule must be enforced to avoid conflicts with the feedback provided by the drop target. (A drag source can also be a drop target. When dropping on itself, the source/target can, of course, provide target feedback to track the mouse position. In this case, however, it is the drop target tracking the mouse, not the source.) Based on the feedback offered by the drop target, the source sets an appropriate pointer.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="drag-and-drop.html">Drag and Drop</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
