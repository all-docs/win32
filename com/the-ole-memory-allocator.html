<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>The OLE Memory Allocator</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: The OLE Memory Allocator
description: The OLE Memory Allocator
ms.assetid: 026c62e5-c296-4059-b028-77c98fdb77ce
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>The OLE Memory Allocator</h1>
<p>The COM library provides an implementation of a memory allocator that is thread-safe. (That is, it cannot cause problems in multithreaded situations.) Whenever ownership of an allocated chunk of memory is passed through a COM interface or between a client and the COM library, you must use this COM allocator to allocate the memory. Allocation internal to an object can use any allocation scheme desired, but the COM memory allocator is a handy, efficient, and thread-safe allocator.</p>
<p>A call to the API function <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc"><strong>CoGetMalloc</strong></a> provides a pointer to the OLE allocator, which is an implementation of the <a href="/windows/win32/api/objidlbase/nn-objidlbase-imalloc"><strong>IMalloc</strong></a> interface. However, it is more efficient to call the helper functions <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemalloc"><strong>CoTaskMemAlloc</strong></a>, <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemrealloc"><strong>CoTaskMemRealloc</strong></a>, and <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemfree"><strong>CoTaskMemFree</strong></a>, which wrap getting a pointer to the task memory allocator, calling the corresponding <strong>IMalloc</strong> method, and then releasing the pointer to the allocator.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="managing-memory-allocation.html">Managing Memory Allocation</a></p>
<!-- raw HTML omitted -->
<p><a href="the-com-library.html">The COM Library</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
