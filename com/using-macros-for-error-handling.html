<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Macros for Error Handling</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Using Macros for Error Handling
description: COM defines a number of macros that make it easier to work with HRESULT values.
ms.assetid: ad28eb80-cab9-4bec-9601-34660f6dcad4
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using Macros for Error Handling</h1>
<p>COM defines a number of macros that make it easier to work with <strong>HRESULT</strong> values.</p>
<p>The error handling macros are described in the following table.</p>
<table>
<thead>
<tr>
<th>Macro</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/dmerror/nf-dmerror-make_hresult"><strong>MAKE_HRESULT</strong></a><!-- raw HTML omitted --></td>
<td>Returns an <strong>HRESULT</strong> given the severity bit, facility code, and error code that comprise the <strong>HRESULT</strong>.<!-- raw HTML omitted --> <strong>Note:</strong> Calling <a href="/windows/desktop/api/dmerror/nf-dmerror-make_hresult"><strong>MAKE_HRESULT</strong></a> for S_OK verification carries a performance penalty. You should not routinely use <strong>MAKE_HRESULT</strong> for successful results.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->MAKE_SCODE<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Returns an <!-- raw HTML omitted -->SCODE<!-- raw HTML omitted --> given the severity bit, facility code, and error code that comprise the <!-- raw HTML omitted -->SCODE<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->HRESULT_CODE<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Extracts the error code portion of the <!-- raw HTML omitted -->HRESULT<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->HRESULT_FACILITY<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Extracts the facility code of the <!-- raw HTML omitted -->HRESULT<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->HRESULT_SEVERITY<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Extracts the severity bit of the <!-- raw HTML omitted -->HRESULT<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->SCODE_CODE<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Extracts the error code portion of the <!-- raw HTML omitted -->SCODE<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->SCODE_FACILITY<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Extracts the facility code of the <!-- raw HTML omitted -->SCODE<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->SCODE_SEVERITY<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Extracts the severity field of the <!-- raw HTML omitted -->SCODE<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->SUCCEEDED<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Tests the severity bit of the <!-- raw HTML omitted -->SCODE<!-- raw HTML omitted --> or <!-- raw HTML omitted -->HRESULT<!-- raw HTML omitted -->; returns <!-- raw HTML omitted -->TRUE<!-- raw HTML omitted --> if the severity is zero and <!-- raw HTML omitted -->FALSE<!-- raw HTML omitted --> if it is one.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->FAILED<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Tests the severity bit of the <!-- raw HTML omitted -->SCODE<!-- raw HTML omitted --> or <!-- raw HTML omitted -->HRESULT<!-- raw HTML omitted -->; returns <!-- raw HTML omitted -->TRUE<!-- raw HTML omitted --> if the severity is one and <!-- raw HTML omitted -->FALSE<!-- raw HTML omitted --> if it is zero.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->IS_ERROR<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Provides a generic test for errors on any status value. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->HRESULT_FROM_WIN32<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Maps a <!-- raw HTML omitted -->system error code<!-- raw HTML omitted --> to an <!-- raw HTML omitted -->HRESULT<!-- raw HTML omitted --> value. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->HRESULT_FROM_NT<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Maps an NT status value to an <!-- raw HTML omitted -->HRESULT<!-- raw HTML omitted --> value.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="error-handling-in-com.html">Error Handling in COM</a></p>
<!-- raw HTML omitted -->
</body>
