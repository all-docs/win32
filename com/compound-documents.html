<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Compound Documents</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Compound Documents
description: OLE compound documents enable users working within a single application to manipulate data written in various formats and derived from multiple sources.
ms.assetid: d17dc0dd-3115-4830-8c6b-694a8d1accaa
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Compound Documents</h1>
<p>OLE compound documents enable users working within a single application to manipulate data written in various formats and derived from multiple sources. For example, a user might insert into a word processing document a graph created in a second application and a sound object created in a third application. Activating the graph causes the second application to load its user interface, or at least that part containing tools necessary to edit the object. Activating the sound object causes the third application to play it. In both cases, a user is able to manipulate data from external sources from within the context of a single document.</p>
<p>OLE compound document technology rests on a foundation consisting of COM, structured storage, and uniform data transfer. As summarized below, each of these core technologies plays a critical role in OLE compound documents:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->COM</p>
<!-- raw HTML omitted -->
<p>A compound document object is essentially a COM object that can be embedded in, or linked to, an existing document. As a COM object, a compound document object exposes the <a href="/windows/desktop/api/Unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> interface, through which clients can obtain pointers to its other interfaces, including several, such as <a href="/windows/desktop/api/OleIdl/nn-oleidl-ioleobject"><strong>IOleObject</strong></a>, <a href="/windows/desktop/api/OleIdl/nn-oleidl-iolelink"><strong>IOleLink</strong></a>, and <a href="/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2"><strong>IViewObject2</strong></a>, that provide special features unique to compound document objects.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Structured Storage</p>
<!-- raw HTML omitted -->
<p>A compound document object must implement the <a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage"><strong>IPersistStorage</strong></a> or, optionally, <a href="/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream"><strong>IPersistStream</strong></a> interfaces to manage its own storage. A container used to create compound documents must supply the <a href="/windows/desktop/api/objidl/nn-objidl-istorage"><strong>IStorage</strong></a> interface, through which objects store and retrieve data. Containers almost always provide instances of <strong>IStorage</strong> obtained from OLE's Compound Files implementation. Containers must also use an object's <strong>IPersistStorage</strong> and/or <strong>IPersistStream</strong> interfaces.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Uniform Data Transfer</p>
<!-- raw HTML omitted -->
<p>Applications that support compound documents must implement <a href="/windows/desktop/api/ObjIdl/nn-objidl-idataobject"><strong>IDataObject</strong></a> because embedded objects and linked objects begin as data that has been transferred using special OLE clipboard formats, rather than standard Microsoft Windows clipboard formats. In other words, formatting data as an embedded or linked object is simply one more option provided by OLE's uniform data transfer model.</p>
<!-- raw HTML omitted -->
<p>OLE's compound document technology benefits both software developers and users alike. Instead of feeling obligated to cram every conceivable feature into a single application, software developers are now free, if they like, to develop smaller, more focused applications that rely on other applications to supply additional features. In cases where a software developer decides to provide an application with capabilities beyond its core features, the developer can implement these additional services as separate DLLs, which are loaded into memory only when their services are required. Users benefit from smaller, faster, more capable software that they can mix and match as needed, manipulating all required components from within a single master document.</p>
<p>For more information, see the following topics:</p>
<ul>
<li><a href="containers-and-servers.html">Containers and Servers</a></li>
<li><a href="linking-and-embedding.html">Linking and Embedding</a></li>
<li><a href="object-handlers.html">Object Handlers</a></li>
<li><a href="in-process-servers.html">In-Process Servers</a></li>
<li><a href="linked-objects-and-monikers.html">Linked Objects and Monikers</a></li>
<li><a href="notifications.html">Notifications</a></li>
<li><a href="compound-document-interfaces.html">Compound Document Interfaces</a></li>
<li><a href="object-states.html">Object States</a></li>
<li><a href="implementing-in-place-activation.html">Implementing In-Place Activation</a></li>
<li><a href="creating-linked-and-embedded-objects-from-existing-data.html">Creating Linked and Embedded Objects from Existing Data</a></li>
<li><a href="view-caching.html">View Caching</a></li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="data-transfer.html">Data Transfer</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/Stg/structured-storage-start-page">Structured Storage</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
