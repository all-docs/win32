<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>The FORMATETC Structure</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: The FORMATETC Structure
description: The FORMATETC structure is a generalized clipboard format, enhanced to encompass a target device, an aspect or view of the data, and a storage medium.
ms.assetid: 46d8988a-4b97-4c86-8b1b-db87044a7e01
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>The FORMATETC Structure</h1>
<p>The FORMATETC structure is a generalized clipboard format, enhanced to encompass a target device, an <em>aspect</em> or view of the data, and a storage medium. A data consumer, such as an OLE container application, passes the <a href="/windows/win32/api/objidl/ns-objidl-formatetc"><strong>FORMATETC</strong></a> structure as an argument in calls to <a href="/windows/desktop/api/ObjIdl/nn-objidl-idataobject"><strong>IDataObject</strong></a> to indicate the type of data it wants from a data source, such as a compound document object. The source uses the <strong>FORMATETC</strong> structure to describe what formats it can provide.</p>
<p><a href="/windows/win32/api/objidl/ns-objidl-formatetc"><strong>FORMATETC</strong></a> can describe virtually any data, including other objects such as monikers. A container can ask one of its embedded objects to list its data formats by calling <a href="/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc"><strong>IDataObject::EnumFormatEtc</strong></a>, which returns an enumerator object that implements the <a href="/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc"><strong>IEnumFORMATETC</strong></a> interface. Instead of replying merely that it has &quot;text and a bitmap,&quot; the object can provide a detailed description of the data, including the device (normally screen or printer) for which it is rendered, the aspect to be presented to the user (full contents, thumbnail, icon, or formatted for printing), and the storage medium containing the data (global memory, disk file, storage object, or stream). This ability to tightly describe data will, in time, result in higher quality printer and screen output as well as more efficiency in data browsing, where a thumbnail sketch is much faster to retrieve and display than a fully detailed rendering.</p>
<p>The following table lists fields of the <a href="/windows/win32/api/objidl/ns-objidl-formatetc"><strong>FORMATETC</strong></a> data structure and the information that they specify.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Specifies</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>cfFormat</strong><!-- raw HTML omitted --></td>
<td>The format in which the data is to be rendered, which can be a standard clipboard format, a proprietary format, or an OLE format. For more information on OLE formats, see <a href="compound-documents.html">Compound Documents</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>ptd</strong><!-- raw HTML omitted --></td>
<td>A <a href="/windows/win32/api/objidl/ns-objidl-dvtargetdevice"><strong>DVTARGETDEVICE</strong></a> structure, which contains enough information about a Windows target device, such as a screen or printer, so that a handle to its device context (hDC) can be created using the <a href="/windows/desktop/api/wingdi/nf-wingdi-createdca"><strong>CreateDC</strong></a> function. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>dwAspect</strong><!-- raw HTML omitted --></td>
<td>The aspect or view of the data to be rendered; can be the full contents, a thumbnail sketch, an icon, or formatted for printing.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>lindex</strong><!-- raw HTML omitted --></td>
<td>The part of the aspect that is of interest; for the present, the value must be -1, indicating that the entire view is of interest.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>tymed</strong><!-- raw HTML omitted --></td>
<td>The data's storage medium, which can be global memory, disk file, or an instance of one of COM's structured-storage interfaces.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="data-formats-and-transfer-media.html">Data Formats and Transfer Media</a></p>
<!-- raw HTML omitted -->
</body>
