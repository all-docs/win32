<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Delegation and Impersonation</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Delegation and Impersonation
description: In client/server scenarios, it is common for one server to call another server to accomplish some task on a client's behalf. The situation where a server is given the authority to act on a client's behalf is called delegation.
ms.assetid: 245bff1a-31d3-49ce-847e-c37d0c96f9d1
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Delegation and Impersonation</h1>
<p>In client/server scenarios, it is common for one server to call another server to accomplish some task on a client's behalf. The situation where a server is given the authority to act on a client's behalf is called <em>delegation</em>.</p>
<p>From a security standpoint, two issues arise regarding delegation:</p>
<ul>
<li>What should the server be allowed to do when acting on the client's behalf?</li>
<li>What identity is presented by the server when it calls other servers on behalf of a client?</li>
</ul>
<p>To deal with these issues, COM provides the following functionality. The client can set an <em>impersonation level</em> that determines to what extent the server will be able to act as the client. If the client grants enough authority to the server, the server can <em>impersonate</em> (pretend to be) the client. When impersonating the client, the server is given access to only those objects or resources that the client has permission to use. The server, acting as a client, can also enable <em>cloaking</em> to mask its own identity and project the client's identity in calls to other COM components.</p>
<p><img src="images/172e04f7-568d-450b-9785-2c1a2b40e549.png" alt="Diagram that shows how the server acting as the client can enable cloaking." /></p>
<p>Consider the scenario illustrated by the preceding figure, where A and B are processes on a different machine from C. Process A calls B, and B calls C. Client A sets the impersonation level. B sets the cloaking capability. If A sets an impersonation level that permits impersonation, B can impersonate A when calling C on A's behalf. The identity that is presented to process C will be either A's identity or B's identity, depending on whether cloaking was enabled by B. If cloaking is enabled, the identity presented to process C will be that of A. If cloaking is not enabled, B's identity will be presented to C.</p>
<p>For more information, see the following topics:</p>
<ul>
<li><a href="impersonation.html">Impersonation</a></li>
<li><a href="impersonation-levels.html">Impersonation Levels</a></li>
<li><a href="cloaking.html">Cloaking</a></li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
