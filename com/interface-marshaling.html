<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Interface Marshaling</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Interface Marshaling
description: Interface Marshaling
ms.assetid: 71069bd3-5f90-406a-be78-bb1af9b1c1c0
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Interface Marshaling</h1>
<p>Unless you know beyond all doubt that your interface will never be used across apartment, thread, or process boundaries, you need to decide how to provide marshaling support for your interfaces. There are three ways to provide marshaling support:</p>
<ul>
<li>Write your own proxy/stub code that calls the COM channel, which in turn calls the RPC run-time libraries. Theoretically, it is possible to do this, but in practice it is almost impossible to do without a significant amount of effort.</li>
<li>Describe your interfaces in an interface definition language (IDL) file and use the MIDL compiler to generate a proxy/stub DLL. This method provides the best performance and the most flexibility in terms of acceptable data types. Using MIDL-generated proxy stubs, you can control not only memory management but even the marshaling and unmarshaling of complex data types across different platforms.</li>
<li>Use MIDL to generate a type library that the system uses to provide marshaling support at run time. This is the easiest way to implement marshaling support. All you have to do is generate a type library and register it. Your interfaces must be Automation-compatible (either <a href="/windows/desktop/Midl/oleautomation"><strong>oleautomation</strong></a> or <a href="/windows/desktop/Midl/dual"><strong>dual</strong></a>), which places some restrictions on the kinds of data types you can use as method parameters. However, in most cases, the advantage of having your interfaces accessible to programs written in other languages, such as Microsoft Visual Basic and Java, outweighs the limitations on data types.</li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="inter-object-communication.html">Inter-Object Communication</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
