<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Accessing Interfaces Across Apartments</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Accessing Interfaces Across Apartments
description: Accessing Interfaces Across Apartments
ms.assetid: 4e0467b9-bbf1-410c-8aab-40450a7f963a
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Accessing Interfaces Across Apartments</h1>
<p>COM provides a way for any apartment in a process to get access to an interface implemented on an object in any other apartment in the process. This is done through the <a href="/windows/desktop/api/ObjIdl/nn-objidl-iglobalinterfacetable"><strong>IGlobalInterfaceTable</strong></a> interface. This interface has three methods, which allow you to do the following:</p>
<ul>
<li>Register an interface as a <em>global</em> (processwide) interface.</li>
<li>Get a pointer to that interface from any other apartment through a cookie.</li>
<li>Revoke the global registration of an interface.</li>
</ul>
<p>The <a href="/windows/desktop/api/ObjIdl/nn-objidl-iglobalinterfacetable"><strong>IGlobalInterfaceTable</strong></a> interface is an efficient way for a process to store an interface pointer in a memory location that can be accessed from multiple apartments within the process, such as process-wide variables and <em>agile</em> objects (free-threaded, marshaled objects) containing interface pointers to other objects.</p>
<p>An agile object is unaware of the underlying COM infrastructure in which it runs; in other words, what apartment, context, and thread it is executing on. The object may be holding on to interfaces that are specific to an apartment or context. For this reason, calling these interfaces from wherever the agile component is executing might not always work properly. The global interface table avoids this problem by guaranteeing that a valid proxy (or direct pointer) to the object is used, based on where the agile object is executing.</p>
<blockquote>
<p>[!Note]<br />
The global interface table is not portable across process or machine boundaries, so it cannot be used in place of the normal parameter-passing mechanism.</p>
</blockquote>
<p>Â </p>
<p>For information about creating and using a global interface table, see the following topics:</p>
<ul>
<li><a href="creating-the-global-interface-table.html">Creating the Global Interface Table</a></li>
<li><a href="when-to-use-the-global-interface-table.html">When to Use the Global Interface Table</a></li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="choosing-the-threading-model.html">Choosing the Threading Model</a></p>
<!-- raw HTML omitted -->
<p><a href="multithreaded-apartments.html">Multithreaded Apartments</a></p>
<!-- raw HTML omitted -->
<p><a href="in-process-server-threading-issues.html">In-Process Server Threading Issues</a></p>
<!-- raw HTML omitted -->
<p><a href="processes--threads--and-apartments.html">Processes, Threads, and Apartments</a></p>
<!-- raw HTML omitted -->
<p><a href="single-threaded-and-multithreaded-communication.html">Single-Threaded and Multithreaded Communication</a></p>
<!-- raw HTML omitted -->
<p><a href="single-threaded-apartments.html">Single-Threaded Apartments</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
