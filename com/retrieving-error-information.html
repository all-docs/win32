<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Retrieving Error Information</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Retrieving Error Information
description: Retrieving Error Information
ms.assetid: 51a0e401-43f2-4738-9799-a96e2580a29f
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Retrieving Error Information</h1>
<p>Using the COM error-handling interfaces and functions, you can retrieve error information as follows:</p>
<ol>
<li>Check whether the returned value represents an error that the object is prepared to handle.</li>
<li>Call <a href="/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)"><strong>QueryInterface</strong></a> to get a pointer to the <a href="/windows/win32/api/oaidl/nn-oaidl-isupporterrorinfo"><strong>ISupportErrorInfo</strong></a> interface. Then call <a href="/windows/win32/api/oaidl/nf-oaidl-isupporterrorinfo-interfacesupportserrorinfo"><strong>ISupportErrorInfo::InterfaceSupportsErrorInfo</strong></a> to verify that the error was raised by the object that returned it and that the error object pertains to the current error and not to a previous call.</li>
<li>To get a pointer to the error object, call the <a href="/windows/win32/api/oleauto/nf-oleauto-geterrorinfo"><strong>GetErrorInfo</strong></a> function.</li>
<li>To retrieve information from the error object, use the <a href="/windows/win32/api/oaidl/nn-oaidl-ierrorinfo"><strong>IErrorInfo</strong></a> methods.</li>
</ol>
<p>If the object is not prepared to handle the error but needs to propagate the error information further down the call chain, it should simply pass the return value to its caller. Because the <a href="/windows/win32/api/oleauto/nf-oleauto-geterrorinfo"><strong>GetErrorInfo</strong></a> function clears the error information and passes ownership of the error object to the caller, the function should be called only by the object that handles the error.</p>
<p>Â </p>
<p>Â </p>
</body>
