<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Anti-Monikers</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Anti-Monikers
description: OLE provides an implementation of a special type of moniker called an anti-moniker.
ms.assetid: 3b52d3bd-8375-4463-a0e3-5117fa96a1c1
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Anti-Monikers</h1>
<p>OLE provides an implementation of a special type of moniker called an <em>anti-moniker</em>. You use this moniker in the creation of new moniker classes. You use it as the inverse of the moniker that it is composed onto, effectively canceling that moniker, in much the same way that the &quot;..&quot; operator moves up a directory level in a file system command.</p>
<p>It is necessary to have an anti-moniker available, because once a composite moniker is created, it is not possible to delete parts of the moniker if, for example, an object moves. Instead, you use an anti-moniker to remove one or more entries from a composite moniker.</p>
<p>Anti-monikers are a moniker class explicitly intended for use as an inverse. COM defines the named <a href="/windows/desktop/api/Objbase/nf-objbase-createantimoniker"><strong>CreateAntiMoniker</strong></a> function, which returns an anti-moniker. You generally use this function to implement the <a href="/windows/desktop/api/ObjIdl/nf-objidl-imoniker-inverse"><strong>IMoniker::Inverse</strong></a> method.</p>
<p>An anti-moniker is only an inverse for those types of monikers that are implemented to treat anti-monikers as an inverse. For example, if you want to remove the last piece of a composite moniker, you should not create an anti-moniker and compose it to the end of the composite. You cannot be sure that the last piece of the composite considers an anti-moniker to be its inverse. Instead, you should call <a href="/windows/desktop/api/ObjIdl/nf-objidl-imoniker-enum"><strong>IMoniker::Enum</strong></a> on the composite moniker, specifying <strong>FALSE</strong> as the first parameter. This creates an enumerator that returns the component monikers in reverse order. Use the enumerator to retrieve the last piece of the composite, and call <a href="/windows/desktop/api/ObjIdl/nf-objidl-imoniker-inverse"><strong>Inverse</strong></a> on that moniker. The moniker returned by <strong>Inverse</strong> is what you need to remove the last piece of the composite.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="class-monikers.html">Class Monikers</a></p>
<!-- raw HTML omitted -->
<p><a href="composite-monikers.html">Composite Monikers</a></p>
<!-- raw HTML omitted -->
<p><a href="file-monikers.html">File Monikers</a></p>
<!-- raw HTML omitted -->
<p><a href="item-monikers.html">Item Monikers</a></p>
<!-- raw HTML omitted -->
<p><a href="pointer-monikers.html">Pointer Monikers</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
