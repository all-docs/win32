<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GetCryptProvFromCert function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Gets a handle to a cryptographic service provider (CSP) and a key specification for a certificate context.
ms.assetid: ff72231f-e10f-49d2-b0e0-0008923803cc
title: GetCryptProvFromCert function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>GetCryptProvFromCert
api_type:</li>
<li>DllExport
api_location:</li>
<li>Mssign32.dll</li>
</ul>
<hr />
<h1>GetCryptProvFromCert function</h1>
<blockquote>
<p>[!IMPORTANT]
This API is deprecated. Microsoft may remove this API in future releases.</p>
</blockquote>
<p>Â </p>
<p>The <strong>GetCryptProvFromCert</strong> function gets a handle to a <a href="../secgloss/c-gly.html"><em>cryptographic service provider</em></a> (CSP) and a key specification for a <a href="../secgloss/c-gly.html"><em>certificate</em></a> context. Use this function to get access to the <a href="../secgloss/p-gly.html"><em>private key</em></a> of the certificate issuer.</p>
<blockquote>
<p>[!Note]<br />
This function has no associated header file or import library. To call this function, you must create a user-defined header file and use the <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya"><strong>LoadLibrary</strong></a> and <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress"><strong>GetProcAddress</strong></a> functions to dynamically link to Mssign32.dll.</p>
</blockquote>
<p>Â </p>
<h2>Syntax</h2>
<pre lang="C++"><code>BOOL WINAPI GetCryptProvFromCert(
  _In_Â Â Â Â Â Â HWND Â Â Â Â Â Â Â Â Â Â hwnd,
  _In_Â Â Â Â Â Â PCCERT_CONTEXT pCert,
  _Out_Â Â Â Â Â HCRYPTPROV Â Â Â Â *phCryptProv,
  _Out_Â Â Â Â Â DWORD Â Â Â Â Â Â Â Â Â *pdwKeySpec,
  _In_Â Â Â Â Â Â BOOL Â Â Â Â Â Â Â Â Â Â *pfDidCryptAcquire,
  _Out_opt_Â LPWSTR Â Â Â Â Â Â Â Â *ppwszTmpContainer,
  _Out_opt_Â LPWSTR Â Â Â Â Â Â Â Â *ppwszProviderName,
  _Out_Â Â Â Â Â DWORD Â Â Â Â Â Â Â Â Â *pdwProviderType
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hwnd</em> [in]</p>
<!-- raw HTML omitted -->
<p>The handle of the window to use as the owner of any dialog boxes that are displayed. This member is not currently used and is ignored. It is safe to pass <strong>NULL</strong> for this parameter.</p>
<!-- raw HTML omitted -->
<p><em>pCert</em> [in]</p>
<!-- raw HTML omitted -->
<p>A pointer to a <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-cert_context"><strong>CERT_CONTEXT</strong></a> structure for the certificate.</p>
<!-- raw HTML omitted -->
<p><em>phCryptProv</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to an <a href="hcryptprov.html"><strong>HCRYPTPROV</strong></a> structure that is a handle to the CSP.</p>
<!-- raw HTML omitted -->
<p><em>pdwKeySpec</em> [out]</p>
<!-- raw HTML omitted -->
<p>The specification of the private key to retrieve. Possible values include <strong>AT_KEYEXCHANGE</strong> or <strong>AT_SIGNATURE</strong>.</p>
<!-- raw HTML omitted -->
<p><em>pfDidCryptAcquire</em> [in]</p>
<!-- raw HTML omitted -->
<p>A value that specifies whether the function acquired the provider handle based on the certificate.</p>
<!-- raw HTML omitted -->
<p><em>ppwszTmpContainer</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>The address of a pointer to a null-terminated string for the temporary key container name. The <strong>GetCryptProvFromCert</strong> function provides and initializes the temporary container. When calling <strong>GetCryptProvFromCert</strong>, the address should point to a <strong>NULL</strong> value.</p>
<!-- raw HTML omitted -->
<p><em>ppwszProviderName</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>The address of a pointer to a null-terminated string for the provider name. The <strong>GetCryptProvFromCert</strong> function returns the provider name. When calling <strong>GetCryptProvFromCert</strong>, the address should point to a <strong>NULL</strong> value.</p>
<!-- raw HTML omitted -->
<p><em>pdwProviderType</em> [out]</p>
<!-- raw HTML omitted -->
<p>Specifies the CSP type. This can be zero or one of the <a href="cryptographic-provider-types.html">Cryptographic Provider Types</a>. If this member is zero, the key container is one of the CNG key storage providers.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Upon success, this function returns <strong>TRUE</strong>. The <strong>GetCryptProvFromCert</strong> function returns <strong>FALSE</strong> if it fails.</p>
<h2>Remarks</h2>
<p>The <a href="makecert.html">MakeCert</a> tool calls <strong>GetCryptProvFromCert</strong> when you invoke it by using the <strong>-is</strong> command line option.</p>
<p>If the <em>pfDidCryptAcquire</em> parameter is set to <strong>TRUE</strong>, the function sets <em>phCryptProv</em>, <em>pdwKeySpec</em>, and <em>pdwProviderType</em> parameters to the provider values.</p>
<p>When you have finished using the CSP, free it by calling the <a href="freecryptprovfromcert.html"><strong>FreeCryptProvFromCert</strong></a> function.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mssign32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
