<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Method Return Values</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The return value for C++ interface methods is always of type HRESULT; this value can be checked to determine success or failure.
ms.assetid: f6478e72-0fe9-4c3b-b08a-f71c9c943910
title: Method Return Values
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Method Return Values</h1>
<p>The return value for C++ interface methods is always of type <strong>HRESULT</strong>; this value can be checked to determine success or failure. The use of &quot;output&quot; parameters allows values to be assigned to variables during the method or property call. The following example shows a C++ method call to enumerate providers.</p>
<pre lang="C++"><code>UINT          ucEnumProvIndex = 0;
BSTR          bstrProvider = NULL;
HRESULT       hr;

// pEnroll is previously instantiated CEnroll interface pointer
hr = pEnroll-&gt;enumProviders(ucEnumProvIndex, 0, &amp;bstrProvider);
</code></pre>
<p>In the preceding code fragment, success or failure is returned to the &quot;hr&quot; variable. If the call was successful, hr will be set to S_OK and the variable bstrProvider will contain the name of the enumerated provider.</p>
<p>A C++ call to retrieve a property value would be as follows.</p>
<pre lang="C++"><code>BSTR     bstrStoreName = NULL;
HRESULT  hr;

// pEnroll is previously instantiated CEnroll interface pointer

// get the storename
hr = pEnroll-&gt;get_CAStoreName( &amp;bstrStoreName );

// (When done using bstrStoreName, free it by calling SysFreeString).
</code></pre>
<p>A C++ call to set a property value would be as follows.</p>
<pre lang="C++"><code>// bstrNewName previously set to a valid store name
hr = pEnroll-&gt;put_CAStoreName( bstrNewName );
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
