<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Getting Ready to Use CAPICOM</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Provides information about preparing to use CAPICOM in x86 applications.
ms.assetid: 69de5232-e2f9-4aed-935d-5fbcd7998cc9
title: Getting Ready to Use CAPICOM
ms.topic: article
ms.date: 07/15/2024</h2>
<h1>Getting Ready to Use CAPICOM</h1>
<blockquote>
<p>[!NOTE]
CAPICOM 2.1.0.2 was available in the <a href="https://developer.microsoft.com/windows/downloads/windows-sdk/">Windows SDK</a> for use in the following operating systems: Windows ServerÂ 2008, WindowsÂ Vista, and WindowsÂ XP. For x64 and use in later operating systems, instead use .NET or .NET Framework to implement security features. For more alternatives and addtional information, see <a href="alternatives-to-using-capicom.html">Alternatives to Using CAPICOM</a>.</p>
</blockquote>
<blockquote>
<p>[!NOTE]
For information about CAPICOM versions, see <a href="capicom-versions.html">CAPICOM Versions</a>.</p>
</blockquote>
<p>Applications that use CAPICOM objects must be created by using CAPICOM.dll. CAPICOM.dll must also be present and registered at run time to use CAPICOM objects. CAPICOM.dll should be added to Visual Basic projects references to use CAPICOM objects.</p>
<p>To register <code>CAPICOM.dll</code> at a command prompt, go to the directory where CAPICOM DLL is stored and enter the following command:</p>
<pre lang="cmd"><code>regsvr32 CAPICOM.dll
</code></pre>
<h2>Example Code Limitations</h2>
<p>To provide more concise, more readable code, principles of good programming practice are not always followed in these examples. In particular, only limited error responses are shown. Working applications should always check returned error codes and perform appropriate actions when an error is encountered.</p>
<h2>Necessary Key Containers, Keys, and Certificates in CAPICOM</h2>
<p>While some operations with CAPICOM objects can be done on any computer by any user, creating <a href="../secgloss/d-gly.html"><em>digital signatures</em></a> and retrieving the plaintext content of an enveloped message using CAPICOM objects are certificate-based operations. The user who creates a digital signature and the user who retrieves the encrypted contents of an enveloped message must have a digital certificate with an available associated private key. If a certificate with an associated private key is not present, the cryptographic operation will fail. Users of CAPICOM applications must ensure that they have the appropriate certificate and available private key when the applications are running.</p>
<p>Some examples in the following sections perform operations that require an available <a href="../secgloss/p-gly.html"><em>public/private key pair</em></a> for encrypting and decrypting files, messages, and signatures. Many of these programs will compile and run but fail at run time without the existence of proper <a href="../secgloss/k-gly.html"><em>key containers</em></a>, keys, certificate stores, and <a href="../secgloss/c-gly.html"><em>certificates</em></a> in those stores.</p>
<h2>Create a self-signed certificate</h2>
<p>To create a self-signed certificate, use the <code>makecert.exe</code> tool. The following steps show how to create a self-signed certificate:</p>
<ol>
<li>
<p>Install the signing tools. These are installed as part of the Microsoft Windows Software Development Kit (SDK), the Platform Software Development Kit (SDK), or the .NET Framework SDK.</p>
</li>
<li>
<p>After Makecert.exe is downloaded, run the following command at a command prompt, substituting a user name for <em>UserName</em>, an organization name for <em>OrganizationName</em>, and a company name for <em>CompanyName</em>:</p>
<pre lang="cmd"><code>makecert -r -n &quot;cn=UserName, ou=OrganizationName, o=CompanyName&quot; -ss my
</code></pre>
</li>
<li>
<p>The certificate can be placed in the My store of the current user. Import the certificate created into the root store so that it is trusted.</p>
</li>
</ol>
</body>
