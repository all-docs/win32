<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>WTHelperGetFileHash function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Verifies the signature of a signed file and obtains the hash value and algorithm identifier for the file.
ms.assetid: 130b3c3e-cc67-44ec-acc7-daa87b714299
title: WTHelperGetFileHash function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>WTHelperGetFileHash
api_type:</li>
<li>DllExport
api_location:</li>
<li>Wintrust.dll</li>
</ul>
<hr />
<h1>WTHelperGetFileHash function</h1>
<p>[The <strong>WTHelperGetFileHash</strong> function is available for use in the operating systems specified in the Requirements section. It may be altered or unavailable in subsequent versions.]</p>
<p>The <strong>WTHelperGetFileHash</strong> function verifies the signature of a signed file and obtains the hash value and algorithm identifier for the file.</p>
<blockquote>
<p>[!Note]<br />
This function is not declared in a published header file. To use this function, declare it in the exact format shown. This function also has no associated import library. You must use the <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya"><strong>LoadLibrary</strong></a> and <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress"><strong>GetProcAddress</strong></a> functions to dynamically link to Wintrust.dll.</p>
</blockquote>
<p>Â </p>
<h2>Syntax</h2>
<pre lang="C++"><code>LONG WINAPI WTHelperGetFileHash(
  _In_Â Â Â Â Â Â Â Â LPCWSTR pwszFilename,
  _In_Â Â Â Â Â Â Â Â DWORD Â Â dwFlags,
  _Inout_opt_Â PVOID Â Â pvReserved,
  _Out_opt_Â Â Â BYTE Â Â Â *pbFileHash,
  _Inout_opt_Â DWORD Â Â *pcbFileHash,
  _Out_opt_Â Â Â ALG_ID Â *pHashAlgid
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>pwszFilename</em> [in]</p>
<!-- raw HTML omitted -->
<p>A pointer to a null-terminated Unicode string that contains the path and file name of the file to get the hash for.</p>
<!-- raw HTML omitted -->
<p><em>dwFlags</em> [in]</p>
<!-- raw HTML omitted -->
<p>This parameter is not used and should be zero.</p>
<!-- raw HTML omitted -->
<p><em>pvReserved</em> [in, out, optional]</p>
<!-- raw HTML omitted -->
<p>This parameter is not used and should be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>pbFileHash</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a buffer to receive the hash value for the file. The <em>pcbFileHash</em> parameter contains the size of this buffer.</p>
<!-- raw HTML omitted -->
<p><em>pcbFileHash</em> [in, out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a <strong>DWORD</strong> variable that, on input, contains the size, in bytes, of the <em>pbFileHash</em> buffer and, on output, receives the size, in bytes, of the hash value.</p>
<p>To obtain the required size of the hash value, pass <strong>NULL</strong> for the <em>pbFileHash</em> parameter. This function will place the required size, in bytes, of the hash value in this location.</p>
<p>If the <em>pbFileHash</em> parameter is not <strong>NULL</strong>, and the size is not large enough to receive the hash value, this function will place the required size, in bytes, in this location and return <strong>ERROR_MORE_DATA</strong>.</p>
<!-- raw HTML omitted -->
<p><em>pHashAlgid</em> [out, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to an <a href="alg-id.html"><strong>ALG_ID</strong></a> variable to receive the identifier of the algorithm used to create the hash value. This parameter can be <strong>NULL</strong> if this information is not needed.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns a status code that indicates the success or failure of the function.</p>
<p>Possible return codes include, but are not limited to, the following.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>ERROR_SUCCESS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The file is signed, and the signature was verified.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>ERROR_MORE_DATA</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>pbFileHash</em> parameter is not <strong>NULL</strong>, and the size specified by the <em>pcbFileHash</em> parameter is not large enough to receive the hash.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>ERROR_NOT_ENOUGH_MEMORY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A memory allocation failure occurred.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TRUST_E_BAD_DIGEST</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The signature of the file was not verified.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TRUST_E_NOSIGNATURE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The file was not signed or had a signature that is not valid.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wintrust.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
