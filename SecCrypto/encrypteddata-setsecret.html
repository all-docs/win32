<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EncryptedData.SetSecret method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Sets the value of the secret used to derive the cryptographic session key used to encrypt and decrypt data.
ms.assetid: d940ae0b-a697-4529-b494-0051b9a6db5e
title: EncryptedData.SetSecret method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>EncryptedData.SetSecret
api_type:</li>
<li>COM
api_location:</li>
<li>Capicom.dll</li>
</ul>
<hr />
<h1>EncryptedData.SetSecret method</h1>
<p>[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows ServerÂ 2008, WindowsÂ Vista, and WindowsÂ XP. Instead, use Platform Invocation Services (PInvoke) to call the Win32 API functions <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencryptmessage"><strong>CryptEncryptMessage</strong></a> and <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecryptmessage"><strong>CryptDecryptMessage</strong></a> to encrypt and decrypt messages. For information about PInvoke, see <a href="https://msdn.microsoft.com/library/aa288468.aspx">Platform Invoke Tutorial</a>. The <a href="/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5">.NET and CryptoAPI via P/Invoke: Part 1</a> and <a href="/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6">.NET and CryptoAPI via P/Invoke: Part 2</a> subsections of <a href="/previous-versions/ms867087(v=msdn.10)">Extending .NET Cryptography with CAPICOM and P/Invoke</a> may also be helpful.]</p>
<p>The <strong>SetSecret</strong> method sets the value of the secret used to derive the cryptographic <a href="../secgloss/s-gly.html"><em>session key</em></a> used to encrypt and decrypt data.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>EncryptedData.SetSecret( _
  ByVal newVal, _
  [ ByVal SecretType ] _
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>newVal</em> [in]</p>
<!-- raw HTML omitted -->
<p>A string that contains a secret used to create a session cryptographic key.</p>
<!-- raw HTML omitted -->
<p><em>SecretType</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A value of the <a href="capicom-secret-type.html"><strong>CAPICOM_SECRET_TYPE</strong></a> enumeration that indicates the kind of secret used to generate the session key. The default value is CAPICOM_SECRET_PASSWORD. This parameter can be the following value.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_SECRET_PASSWORD</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The encryption key is to be derived from a password.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>The secret is used to create the session key for encryption or decryption. The same secret must be used for both operations. If the secret used to encrypt data is lost, the encrypted data cannot be decrypted.</p>
<p>If appropriate for your application, consider using <a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptprotectmemory"><strong>CryptProtectMemory</strong></a> or <a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptprotectdata"><strong>CryptProtectData</strong></a> to protect the secret before and after use. Clear the memory associated with the secret when done.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of server support<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>CAPICOM 2.0 or later on Windows ServerÂ 2003 and WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Capicom.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cryptography-objects.html"><strong>Cryptography Objects</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="encrypteddata.html"><strong>EncryptedData</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
