<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Store.Open method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Opens a specified certificate store.
ms.assetid: d6f398b4-dba6-4d84-b5eb-3c7737d17a6e
title: Store.Open method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Store.Open
api_type:</li>
<li>COM
api_location:</li>
<li>Capicom.dll</li>
</ul>
<hr />
<h1>Store.Open method</h1>
<p>[The <strong>Open</strong> method is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509store"><strong>X509Store Class</strong></a> in the <a href="/dotnet/api/system.security.cryptography.x509certificates.publickey.-ctor"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.]</p>
<p>The <strong>Open</strong> method opens a specified <a href="../secgloss/c-gly.html"><em>certificate store</em></a>. By default, the CAPICOM_CURRENT_USER_STORE location and CAPICOM_MY_STORE store are opened as read-only.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>Store.Open( _
  [ ByVal StoreLocation ], _
  [ ByVal StoreName ], _
  [ ByVal OpenMode ] _
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>StoreLocation</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A value of the <a href="capicom-store-location.html">CAPICOM_STORE_LOCATION</a> enumeration that indicates the location of the store to be opened. The default value is CAPICOM_CURRENT_USER_STORE. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_ACTIVE_DIRECTORY_USER_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The store is an Active Directory store. No error will be generated if an Active Directory store is opened as read/write, but any changes to the store will not be persisted. Certificates cannot be added to or removed from Active Directory stores.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CURRENT_USER_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The store is a current user store. A current user store may be a read/write store. If it is, changes in the contents of the store are persisted.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_LOCAL_MACHINE_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The store is a local computer store. Local computer stores can be read/write stores only if the user has read/write permissions. If the user has read/write permissions and if the store is opened read/write, then changes in the contents of the store are persisted.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_MEMORY_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The store is a memory store. Any changes in the contents of the store are not persisted.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_SMART_CARD_USER_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The store is the group of present smart cards. Introduced in CAPICOM 2.0.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>StoreName</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A string that contains the name of the system certificate store to be opened. The default value is CAPICOM_MY_STORE. If the store is opened from a web script, the backslash (\) character is not allowed in the name. In addition to stores defined by the system, user-defined stores can be opened.</p>
<p>This parameter can be a user-defined store or one of the following system certificate stores.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CA_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>CA store. This store is used to store intermediate CA certificates.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_MY_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>My store. This store is used for a user's personal certificates.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_OTHER_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>AddressBook store. This store is used to keep the certificates of others.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_ROOT_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Root store. This store is used to store the root CA and self-signed, trusted certificates.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>OpenMode</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A value of the <a href="capicom-store-open-mode.html">CAPICOM_STORE_OPEN_MODE</a> enumeration that indicates the open mode of the store. The default value is CAPICOM_STORE_OPEN_READ_ONLY. If the store is opened from a web script, this value is forced to CAPICOM_STORE_OPEN_EXISTING_ONLY. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Open the store in read/write mode if the user has read/write permissions; otherwise, open the store in read-only mode.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_STORE_OPEN_READ_ONLY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Open the store in read-only mode.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_STORE_OPEN_READ_WRITE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Open the store in read/write mode.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The following flags can be combined with the values in the previous table by using a logical-<strong>OR</strong> operation.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_STORE_OPEN_EXISTING_ONLY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Open existing stores only; do not create a new store. Introduced in CAPICOM 2.0.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_STORE_OPEN_INCLUDE_ARCHIVED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Include archived certificates when using the store. Introduced in CAPICOM 2.0.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Stores in some locations can be opened only in read-only mode. These include all stores in CAPICOM_LOCAL_MACHINE_STORE for which the user does not have write permissions. Attempts to open a store as a read/write store without proper access and permissions will result in the failure of the <strong>Open</strong> method. Active Directory stores can be opened as a read/write store without failure of the <strong>Open</strong> method, but changes to the store will not be persisted.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>If this method is called on a SmartCard store, additional SmartCard user interfaces may be invoked.</p>
<blockquote>
<p>[!IMPORTANT]
When this method is called from a web script, the script needs to access digital certificates on the local computer. If you allow the script to access your digital certificates, the website from which the script is run will also gain access to any personal information stored in the certificates. The first time this method is called from a particular domain, a dialog box is generated in which the user must indicate whether access to the certificates should be allowed. Stores opened from a web script automatically force the CAPICOM_STORE_OPEN_EXISTING_ONLY flag.</p>
</blockquote>
<p>Â </p>
<p>If <em>StoreLocation</em> is <strong>CAPICOM_SMART_CARD_USER_STORE</strong>, <em>StoreName</em> is ignored. In this case, CAPICOM reads all certificates from all available readers that contain a smart card.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>CAPICOM 2.0 or later on Windows ServerÂ 2003 and WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Capicom.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="store.html"><strong>Store</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="cryptography-objects.html"><strong>Cryptography Objects</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="store-close.html"><strong>Close</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
