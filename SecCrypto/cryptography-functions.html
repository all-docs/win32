<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Cryptography Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Lists the functions provided by CryptoAPI.
ms.assetid: 9a65f73d-6f8c-4271-a2d0-d91ad952f9c6
title: Cryptography Functions
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Cryptography Functions</h1>
<p>Cryptography functions are categorized according to usage as follows:</p>
<ul>
<li><a href="#cryptxml-functions">CryptXML Functions</a></li>
<li><a href="#signer-functions">Signer Functions</a></li>
<li><a href="#base-cryptography-functions">Base Cryptography Functions</a>
<ul>
<li><a href="#service-provider-functions">Service Provider Functions</a></li>
<li><a href="#key-generation-and-exchange-functions">Key Generation and Exchange Functions</a></li>
<li><a href="#object-encoding-and-decoding-functions">Object Encoding and Decoding Functions</a></li>
<li><a href="#data-encryption-and-decryption-functions">Data Encryption and Decryption Functions</a></li>
<li><a href="#hash-and-digital-signature-functions">Hash and Digital Signature Functions</a></li>
</ul>
</li>
<li><a href="#certificate-and-certificate-store-functions">Certificate and Certificate Store Functions</a>
<ul>
<li><a href="#certificate-and-certificate-store-functions">Certificate Store Functions</a></li>
<li><a href="#certificate-and-certificate-store-maintenance-functions">Certificate and Certificate Store Maintenance Functions</a></li>
<li><a href="#certificate-functions">Certificate Functions</a></li>
<li><a href="#certificate-revocation-list-functions">Certificate Revocation List Functions</a></li>
<li><a href="#certificate-trust-list-functions">Certificate Trust List Functions</a></li>
<li><a href="#extended-property-functions">Extended Property Functions</a></li>
</ul>
</li>
<li><a href="#makecert-functions">MakeCert Functions</a></li>
<li><a href="#certificate-verification-functions">Certificate Verification Functions</a>
<ul>
<li><a href="#verification-functions-using-ctls">Verification Functions Using CTLs</a></li>
<li><a href="#certificate-chain-verification-functions">Certificate Chain Verification Functions</a></li>
</ul>
</li>
<li><a href="#message-functions">Message Functions</a>
<ul>
<li><a href="#low-level-message-functions">Low-level Message Functions</a></li>
<li><a href="#simplified-message-functions">Simplified Message Functions</a></li>
</ul>
</li>
<li><a href="#auxiliary-functions">Auxiliary Functions</a>
<ul>
<li><a href="#data-management-functions">Data Management Functions</a></li>
<li><a href="#data-conversion-functions">Data Conversion Functions</a></li>
<li><a href="#enhanced-key-usage-functions">Enhanced Key Usage Functions</a></li>
<li><a href="#key-identifier-functions">Key Identifier Functions</a></li>
<li><a href="#oid-support-functions">OID Support Functions</a></li>
<li><a href="#remote-object-retrieval-functions">Remote Object Retrieval Functions</a></li>
<li><a href="#pfx-functions">PFX Functions</a></li>
</ul>
</li>
<li><a href="#certificate-services-backup-and-restore-functions">Certificate Services Backup and Restore Functions</a></li>
<li><a href="#callback-functions">Callback Functions</a></li>
<li><a href="#catalog-definition-functions">Catalog Definition Functions</a></li>
<li><a href="#catalog-functions">Catalog Functions</a></li>
<li><a href="#wintrust-functions">WinTrust Functions</a></li>
<li><a href="#object-locator-functions">Object Locator Functions</a></li>
</ul>
<h2>CryptXML Functions</h2>
<p>The cryptographic XML functions provide an API for creating and representing digital signatures by using XML formatted data. For information about XML formatted signatures, see the XML-Signature Syntax and Processing specification at <a href="https://go.microsoft.com/fwlink/p/?linkid=139649">https://go.microsoft.com/fwlink/p/?linkid=139649</a>.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="a-shafinal.html"><strong>A_SHAFinal</strong></a></td>
<td>Computes the final hash of the data entered by the MD5Update function.</td>
</tr>
<tr>
<td><a href="a-shainit.html"><strong>A_SHAInit</strong></a></td>
<td>Initiates the hashing of a stream of data.</td>
</tr>
<tr>
<td><a href="a-shaupdate.html"><strong>A_SHAUpdate</strong></a></td>
<td>Adds data to a specified hash object.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlcreatereference"><strong>CryptXmlCreateReference</strong></a></td>
<td>Creates a reference to an XML signature.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmladdobject"><strong>CryptXmlAddObject</strong></a></td>
<td>Adds the <strong>Object</strong> element to the Signature in the Document Context opened for encoding.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlclose"><strong>CryptXmlClose</strong></a></td>
<td>Closes a cryptographic XML object handle.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmldigestreference"><strong>CryptXmlDigestReference</strong></a></td>
<td>Used by an application to digest the resolved reference. This function applies transforms before updating the digest.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllclosedigest"><strong>CryptXmlDllCloseDigest</strong></a></td>
<td>Frees the CRYPT_XML_DIGEST allocated by the <a href="/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllcreatedigest"><strong>CryptXmlDllCreateDigest</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllcreatedigest"><strong>CryptXmlDllCreateDigest</strong></a></td>
<td>Creates a digest object for the specified method.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllcreatekey"><strong>CryptXmlDllCreateKey</strong></a></td>
<td>Parses the <strong>KeyValue</strong> element and creates a Cryptography API: Next Generation (CNG) BCrypt key handle to verify a signature.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldlldigestdata"><strong>CryptXmlDllDigestData</strong></a></td>
<td>Puts data into the digest.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllencodealgorithm"><strong>CryptXmlDllEncodeAlgorithm</strong></a></td>
<td>Encodes <strong>SignatureMethod</strong> or <strong>DigestMethod</strong> elements for agile algorithms with default parameters.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllencodekeyvalue"><strong>CryptXmlDllEncodeKeyValue</strong></a></td>
<td>Encodes a <strong>KeyValue</strong> element.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllfinalizedigest"><strong>CryptXmlDllFinalizeDigest</strong></a></td>
<td>Retrieves the digest value.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllgetalgorithminfo"><strong>CryptXmlDllGetAlgorithmInfo</strong></a></td>
<td>Decodes the XML algorithm and returns information about the algorithm.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllgetinterface"><strong>CryptXmlDllGetInterface</strong></a></td>
<td>Retrieves a pointer to the cryptographic extension functions for the specified algorithm.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllsigndata"><strong>CryptXmlDllSignData</strong></a></td>
<td>Signs data.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllverifysignature"><strong>CryptXmlDllVerifySignature</strong></a></td>
<td>Verifies a signature.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlencode"><strong>CryptXmlEncode</strong></a></td>
<td>Encodes signature data by using the supplied XML writer callback function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlgetalgorithminfo"><strong>CryptXmlGetAlgorithmInfo</strong></a></td>
<td>Decodes the CRYPT_XML_ALGORITHM structure and returns information about the algorithm.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlgetdoccontext"><strong>CryptXmlGetDocContext</strong></a></td>
<td>Returns the document context specified by the supplied handle.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlgetreference"><strong>CryptXmlGetReference</strong></a></td>
<td>Returns the <strong>Reference</strong> element specified by the supplied handle.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlgetsignature"><strong>CryptXmlGetSignature</strong></a></td>
<td>Returns an XML <strong>Signature</strong> element.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlgetstatus"><strong>CryptXmlGetStatus</strong></a></td>
<td>Returns a <a href="/windows/desktop/api/Cryptxml/ns-cryptxml-crypt_xml_status"><strong>CRYPT_XML_STATUS</strong></a> structure that contains status information about the object specified by the supplied handle.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlgettransforms"><strong>CryptXmlGetTransforms</strong></a></td>
<td>Returns information about the default transform chain engine.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlimportpublickey"><strong>CryptXmlImportPublicKey</strong></a></td>
<td>Imports the public key specified by the supplied handle.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlopentoencode"><strong>CryptXmlOpenToEncode</strong></a></td>
<td>Opens an XML digital signature to encode and returns a handle of the opened <strong>Signature</strong> element. The handle encapsulates a document context with a single <a href="/windows/desktop/api/Cryptxml/ns-cryptxml-crypt_xml_signature"><strong>CRYPT_XML_SIGNATURE</strong></a> structure and remains open until the <a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlclose"><strong>CryptXmlClose</strong></a> function is called.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlopentodecode"><strong>CryptXmlOpenToDecode</strong></a></td>
<td>Opens an XML digital signature to decode and returns the handle of the document context that encapsulates a <a href="/windows/desktop/api/Cryptxml/ns-cryptxml-crypt_xml_signature"><strong>CRYPT_XML_SIGNATURE</strong></a> structure. The document context can include one or more <strong>Signature</strong> elements.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlsethmacsecret"><strong>CryptXmlSetHMACSecret</strong></a></td>
<td>Sets the HMAC secret on the handle before calling the <a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlsign"><strong>CryptXmlSign</strong></a> or <a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlverifysignature"><strong>CryptXmlVerify</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlsign"><strong>CryptXmlSign</strong></a></td>
<td>Creates a cryptographic signature of a <strong>SignedInfo</strong> element.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlverifysignature"><strong>CryptXmlVerifySignature</strong></a></td>
<td>Performs a cryptographic signature validation of a <strong>SignedInfo</strong> element.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nc-cryptxml-pfn_crypt_xml_write_callback"><em>PFN_CRYPT_XML_WRITE_CALLBACK</em></a></td>
<td>Creates a transform for a specified data provider.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nc-cryptxml-pfn_crypt_xml_create_transform"><em>PFN_CRYPT_XML_CREATE_TRANSFORM</em></a></td>
<td>Writes cryptographic XML data.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nc-cryptxml-pfn_crypt_xml_data_provider_read"><em>PFN_CRYPT_XML_DATA_PROVIDER_READ</em></a></td>
<td>Reads cryptographic XML data.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nc-cryptxml-pfn_crypt_xml_data_provider_close"><em>PFN_CRYPT_XML_DATA_PROVIDER_CLOSE</em></a></td>
<td>Releases the cryptographic XML data provider.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptxml/nc-cryptxml-pfn_crypt_xml_enum_alg_info"><em>PFN_CRYPT_XML_ENUM_ALG_INFO</em></a></td>
<td>Enumerates predefined and registered <a href="/windows/desktop/api/Cryptxml/ns-cryptxml-crypt_xml_algorithm_info"><strong>CRYPT_XML_ALGORITHM_INFO</strong></a> entries.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Signer Functions</h2>
<p>Provides functions to sign and time stamp data.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="signerfreesignercontext.html"><strong>SignerFreeSignerContext</strong></a></td>
<td>Frees a <a href="signer-context.html"><strong>SIGNER_CONTEXT</strong></a> structure allocated by a previous call to the <a href="signersignex.html"><strong>SignerSignEx</strong></a> function.</td>
</tr>
<tr>
<td><a href="signerror.html"><strong>SignError</strong></a></td>
<td>Calls the <a href="/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a> function and converts the return code to an <strong>HRESULT</strong>.</td>
</tr>
<tr>
<td><a href="signersign.html"><strong>SignerSign</strong></a></td>
<td>Signs the specified file.</td>
</tr>
<tr>
<td><a href="signersignex.html"><strong>SignerSignEx</strong></a></td>
<td>Signs the specified file and returns a pointer to the signed data.</td>
</tr>
<tr>
<td><a href="signersignex2.html"><strong>SignerSignEx2</strong></a></td>
<td>Signs and time stamps the specified file, allowing multiple nested signatures.</td>
</tr>
<tr>
<td><a href="signertimestamp.html"><strong>SignerTimeStamp</strong></a></td>
<td>Time stamps the specified subject. This function supports Authenticode time stamping. To perform X.509 Public Key Infrastructure (RFC 3161) time stamping, use the <a href="signertimestampex2.html"><strong>SignerTimeStampEx2</strong></a> function.</td>
</tr>
<tr>
<td><a href="signertimestampex.html"><strong>SignerTimeStampEx</strong></a></td>
<td>Time stamps the specified subject and optionally returns a pointer to a <a href="signer-context.html"><strong>SIGNER_CONTEXT</strong></a> structure that contains a pointer to a <a href="../secgloss/b-gly.html"><em>BLOB</em></a>. This function supports Authenticode time stamping. To perform X.509 Public Key Infrastructure (RFC 3161) time stamping, use the <a href="signertimestampex2.html"><strong>SignerTimeStampEx2</strong></a> function.</td>
</tr>
<tr>
<td><a href="signertimestampex2.html"><strong>SignerTimeStampEx2</strong></a></td>
<td>Time stamps the specified subject and optionally returns a pointer to a <a href="signer-context.html"><strong>SIGNER_CONTEXT</strong></a> structure that contains a pointer to a <a href="../secgloss/b-gly.html"><em>BLOB</em></a>. This function can be used to perform X.509 Public Key Infrastructure, RFC 3161â€“compliant, time stamps.</td>
</tr>
<tr>
<td><a href="signertimestampex3.html"><strong>SignerTimeStampEx3</strong></a></td>
<td>Time stamps the specified subject and supports setting time stamps on multiple signatures.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Base Cryptography Functions</h2>
<p>Base cryptographic functions provide the most flexible means of developing cryptography applications. All communication with a <a href="../secgloss/c-gly.html"><em>cryptographic service provider</em></a> (CSP) occurs through these functions.</p>
<p>A CSP is an independent module that performs all cryptographic operations. At least one CSP is required with each application that uses cryptographic functions. A single application can occasionally use more than one CSP.</p>
<p>If more than one CSP is used, the one to use can be specified in the CryptoAPI cryptographic function calls. One CSP, the Microsoft Base Cryptographic Provider, is bundled with the <a href="../secgloss/c-gly.html"><em>CryptoAPI</em></a>. This CSP is used as a default provider by many of the CryptoAPI functions if no other CSP is specified.</p>
<p>Each CSP provides a different implementation of the cryptographic support provided to CryptoAPI. Some provide stronger cryptographic algorithms; others contain hardware components, such as <a href="../secgloss/s-gly.html"><em>smart cards</em></a>. In addition, some CSPs can occasionally communicate directly with users, such as when <a href="../secgloss/d-gly.html"><em>digital signatures</em></a> are performed by using the user's <a href="../secgloss/s-gly.html"><em>signature private key</em></a>.</p>
<p>Base cryptographic functions are in the following broad groups:</p>
<ul>
<li>Service Provider Functions</li>
<li>Key Generation and Exchange Functions</li>
<li>Object Encoding and Decoding Functions</li>
<li>Data Encryption and Decryption Functions</li>
<li>Hash and Digital Signature Functions</li>
</ul>
<h3>Service Provider Functions</h3>
<p>Applications use the following service functions to connect and disconnect a <a href="../secgloss/c-gly.html"><em>cryptographic service provider</em></a> (CSP).</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta"><strong>CryptAcquireContext</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Acquires a handle to the current user's <a href="/windows/desktop/SecGloss/k-gly"><strong>key container</strong></a> within a particular CSP.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptcontextaddref"><strong>CryptContextAddRef</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Increments the <a href="/windows/desktop/SecGloss/r-gly"><strong>reference count</strong></a> on an <a href="hcryptprov.html"><strong>HCRYPTPROV</strong></a> handle.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumprovidersa"><strong>CryptEnumProviders</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Enumerates the providers on a computer.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumprovidertypesa"><strong>CryptEnumProviderTypes</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Enumerates the types of providers supported on the computer.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetdefaultprovidera"><strong>CryptGetDefaultProvider</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Determines the default CSP either for the current user or for the computer for a specified provider type.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetprovparam"><strong>CryptGetProvParam</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Retrieves the parameters that govern the operations of a CSP.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptinstalldefaultcontext"><strong>CryptInstallDefaultContext</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Installs a previously acquired <a href="hcryptprov.html"><strong>HCRYPTPROV</strong></a> context to be used as a default context.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptreleasecontext"><strong>CryptReleaseContext</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Releases the handle acquired by the <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta"><strong>CryptAcquireContext</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetprovidera"><strong>CryptSetProvider</strong></a> and <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetproviderexa"><strong>CryptSetProviderEx</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Specifies the user default CSP for a particular CSP type.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetprovparam"><strong>CryptSetProvParam</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Specifies attributes of a CSP.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptuninstalldefaultcontext"><strong>CryptUninstallDefaultContext</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Removes a default context previously installed by <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptinstalldefaultcontext"><strong>CryptInstallDefaultContext</strong></a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->FreeCryptProvFromCertEx<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Releases the handle either to a <!-- raw HTML omitted --><!-- raw HTML omitted -->cryptographic service provider<!-- raw HTML omitted --><!-- raw HTML omitted --> (CSP) or to a Cryptography API: Next Generation (CNG) key.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Key Generation and Exchange Functions</h3>
<p>Key generation and exchange functions <a href="../secgloss/e-gly.html"><em>exchange keys</em></a> with other users and create, configure, and destroy <a href="../secgloss/c-gly.html"><em>cryptographic keys</em></a>.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptderivekey"><strong>CryptDeriveKey</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Creates a key derived from a password.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdestroykey"><strong>CryptDestroyKey</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Destroys a key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptduplicatekey"><strong>CryptDuplicateKey</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Makes an exact copy of a key, including the <a href="/windows/desktop/SecGloss/s-gly"><strong>state</strong></a> of the key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportkey"><strong>CryptExportKey</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Transfers a key from the CSP into a <a href="/windows/desktop/SecGloss/k-gly"><strong>key BLOB</strong></a> in the application's memory space.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey"><strong>CryptGenKey</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Creates a random key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenrandom"><strong>CryptGenRandom</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Generates random data.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetkeyparam"><strong>CryptGetKeyParam</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Retrieves a key's parameters.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetuserkey"><strong>CryptGetUserKey</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Gets a handle to the key exchange or signature key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportkey"><strong>CryptImportKey</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Transfers a key from a <a href="/windows/desktop/SecGloss/k-gly"><strong>key BLOB</strong></a> to a CSP.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetkeyparam"><strong>CryptSetKeyParam</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Specifies a key's parameters.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Object Encoding and Decoding Functions</h3>
<p>These are generalized encoding and decoding functions. They are used to encode and decode <a href="../secgloss/c-gly.html"><em>certificates</em></a>, <a href="../secgloss/c-gly.html"><em>certificate revocation lists</em></a> (CRLs), <a href="../secgloss/c-gly.html"><em>certificate requests</em></a>, and certificate extensions.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobject"><strong>CryptDecodeObject</strong></a></td>
<td>Decodes a structure of type <em>lpszStructType</em>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobjectex"><strong>CryptDecodeObjectEx</strong></a></td>
<td>Decodes a structure of type <em>lpszStructType</em>. <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobjectex"><strong>CryptDecodeObjectEx</strong></a> supports the one-pass memory allocation option.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject"><strong>CryptEncodeObject</strong></a></td>
<td>Encodes a structure of type <em>lpszStructType</em>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobjectex"><strong>CryptEncodeObjectEx</strong></a></td>
<td>Encodes a structure of type <em>lpszStructType</em>. <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobjectex"><strong>CryptEncodeObjectEx</strong></a> supports the one-pass memory allocation option.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Data Encryption and Decryption Functions</h3>
<p>The following functions support encryption and decryption operations. <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencrypt"><strong>CryptEncrypt</strong></a> and <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecrypt"><strong>CryptDecrypt</strong></a> require a <a href="../secgloss/c-gly.html"><em>cryptographic key</em></a> before being called. This is done by using the <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey"><strong>CryptGenKey</strong></a>, <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptderivekey"><strong>CryptDeriveKey</strong></a>, or <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportkey"><strong>CryptImportKey</strong></a> function. The encryption algorithm is specified when the key is created. <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetkeyparam"><strong>CryptSetKeyParam</strong></a> can set additional encryption parameters.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecrypt"><strong>CryptDecrypt</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Decrypts a section of <a href="/windows/desktop/SecGloss/c-gly"><strong>ciphertext</strong></a> by using the specified encryption key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencrypt"><strong>CryptEncrypt</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Encrypts a section of <a href="/windows/desktop/SecGloss/p-gly"><strong>plaintext</strong></a> by using the specified encryption key.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptProtectData<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Performs encryption on the data in a <!-- raw HTML omitted --><!-- raw HTML omitted -->DATA_BLOB<!-- raw HTML omitted --><!-- raw HTML omitted --> structure.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptProtectMemory<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Encrypts memory to protect sensitive information.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptUnprotectData<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Performs a decryption and integrity check of the data in a <!-- raw HTML omitted --><!-- raw HTML omitted -->DATA_BLOB<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptUnprotectMemory<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Decrypts memory that was encrypted using <!-- raw HTML omitted --><!-- raw HTML omitted -->CryptProtectMemory<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Hash and Digital Signature Functions</h3>
<p>These functions compute <a href="../secgloss/h-gly.html"><em>hashes</em></a> of data and also create and verify <a href="../secgloss/d-gly.html"><em>digital signatures</em></a>. Hashes are also known as message digests.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptcreatehash"><strong>CryptCreateHash</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Creates an empty hash object.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdestroyhash"><strong>CryptDestroyHash</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Destroys a hash object.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptDuplicateHash<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Duplicates a hash object.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptGetHashParam<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Retrieves a hash object parameter.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashdata"><strong>CryptHashData</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Hashes a block of data, adding it to the specified hash object.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashsessionkey"><strong>CryptHashSessionKey</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Hashes a session key, adding it to the specified hash object.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsethashparam"><strong>CryptSetHashParam</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Sets a hash object parameter.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignhasha"><strong>CryptSignHash</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Signs the specified hash object.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptUIWizDigitalSign<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Displays a wizard that digitally signs a document or a <!-- raw HTML omitted --><!-- raw HTML omitted -->BLOB<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptUIWizFreeDigitalSignContext<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Releases a pointer to a <!-- raw HTML omitted --><!-- raw HTML omitted -->CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT<!-- raw HTML omitted --><!-- raw HTML omitted --> structure.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifysignaturea"><strong>CryptVerifySignature</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Verifies a digital signature, given a handle to the hash object.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->PFNCFILTERPROC<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Filters the certificates that appear in the digital signature wizard displayed by the <!-- raw HTML omitted --><!-- raw HTML omitted -->CryptUIWizDigitalSign<!-- raw HTML omitted --><!-- raw HTML omitted --> function.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Certificate and Certificate Store Functions</h2>
<p>Certificate and certificate store functions manage the use, storage, and retrieval of <a href="../secgloss/c-gly.html"><em>certificates</em></a>, <a href="../secgloss/c-gly.html"><em>certificate revocation lists</em></a> (CRLs), and <a href="../secgloss/c-gly.html"><em>certificate trust lists</em></a> (CTLs). These functions are divided into the following groups:</p>
<ul>
<li>Certificate Store Functions</li>
<li>Certificate and Certificate Store Maintenance Functions</li>
<li>Certificate Functions</li>
<li>Certificate Revocation List Functions</li>
<li>Certificate Trust List Functions</li>
<li>Extended Property Functions</li>
<li>MakeCert Functions</li>
</ul>
<h3>Certificate Store Functions</h3>
<p>A user site can, over time, collect many certificates. Typically, a site has certificates for the user of the site as well as other certificates that describe those individuals and entities with whom the user communicates. For each entity, there can be more than one certificate. For each individual certificate, there should be a chain of verifying certificates that provides a trail back to a trusted <a href="../secgloss/r-gly.html"><em>root certificate</em></a>. <a href="../secgloss/c-gly.html"><em>Certificate stores</em></a> and their related functions provide functionality to store, retrieve, enumerate, verify, and use the information stored in the certificates.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddstoretocollection"><strong>CertAddStoreToCollection</strong></a></td>
<td>Adds a sibling certificate store to a collection certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certclosestore"><strong>CertCloseStore</strong></a></td>
<td>Closes a certificate store handle.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcontrolstore"><strong>CertControlStore</strong></a></td>
<td>Allows an application to be notified when there is a difference between the contents of a cached store and the contents of the store that is persisted to storage. It also provides desynchronization of the cached store, if necessary, and provides a means to commit changes made in the cached store to persisted storage.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certduplicatestore"><strong>CertDuplicateStore</strong></a></td>
<td>Duplicates a store handle by incrementing the <a href="../secgloss/r-gly.html"><em>reference count</em></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumphysicalstore"><strong>CertEnumPhysicalStore</strong></a></td>
<td>Enumerates the physical stores for a specified system store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumsystemstore"><strong>CertEnumSystemStore</strong></a></td>
<td>Enumerates all available system stores.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumsystemstorelocation"><strong>CertEnumSystemStoreLocation</strong></a></td>
<td>Enumerates all of the locations that have an available system store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetstoreproperty"><strong>CertGetStoreProperty</strong></a></td>
<td>Gets a store property.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certopenstore"><strong>CertOpenStore</strong></a></td>
<td>Opens a certificate store using a specified store provider type.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certopensystemstorea"><strong>CertOpenSystemStore</strong></a></td>
<td>Opens a system certificate store based on a subsystem protocol.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certregisterphysicalstore"><strong>CertRegisterPhysicalStore</strong></a></td>
<td>Adds a physical store to a registry system store collection.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certregistersystemstore"><strong>CertRegisterSystemStore</strong></a></td>
<td>Registers a system store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certremovestorefromcollection"><strong>CertRemoveStoreFromCollection</strong></a></td>
<td>Removes a sibling certificate store from a collection store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certsavestore"><strong>CertSaveStore</strong></a></td>
<td>Saves the certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certsetstoreproperty"><strong>CertSetStoreProperty</strong></a></td>
<td>Sets a store property.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certunregisterphysicalstore"><strong>CertUnregisterPhysicalStore</strong></a></td>
<td>Removes a physical store from a specified system store collection.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certunregistersystemstore"><strong>CertUnregisterSystemStore</strong></a></td>
<td>Unregisters a specified system store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuiwizexport"><strong>CryptUIWizExport</strong></a></td>
<td>Presents a wizard that exports a certificate, certificate trust list (CTL), certificate revocation list (CRL), or certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuiwizimport"><strong>CryptUIWizImport</strong></a></td>
<td>Presents a wizard that imports a certificate, certificate trust list (CTL), certificate revocation list (CRL), or certificate store.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Certificate and Certificate Store Maintenance Functions</h3>
<p>CryptoAPI provides a set of general certificate and certificate store maintenance functions.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddserializedelementtostore"><strong>CertAddSerializedElementToStore</strong></a></td>
<td>Adds the serialized certificate or CRL element to the store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatecontext"><strong>CertCreateContext</strong></a></td>
<td>Creates the specified context from the encoded bytes. The new context is not put into a store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumsubjectinsortedctl"><strong>CertEnumSubjectInSortedCTL</strong></a></td>
<td>Enumerates the TrustedSubjects in a sorted CTL context.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindsubjectinctl"><strong>CertFindSubjectInCTL</strong></a></td>
<td>Finds the specified subject in a CTL.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindsubjectinsortedctl"><strong>CertFindSubjectInSortedCTL</strong></a></td>
<td>Finds the specified subject in a sorted CTL.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/wintrust/nf-wintrust-openpersonaltrustdbdialog"><strong>OpenPersonalTrustDBDialog</strong></a> and <a href="/windows/desktop/api/wintrust/nf-wintrust-openpersonaltrustdbdialogex"><strong>OpenPersonalTrustDBDialogEx</strong></a></td>
<td>Displays the <strong>Certificates</strong> dialog box.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Certificate Functions</h3>
<p>Most <a href="../secgloss/c-gly.html"><em>Certificate</em></a> functions have related functions to deal with <a href="../secgloss/c-gly.html"><em>CRLs</em></a> and <a href="../secgloss/c-gly.html"><em>CTLs</em></a>. For more information about related CRL and CTL functions, see Certificate Revocation List Functions and Certificate Trust List Functions.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddcertificatecontexttostore"><strong>CertAddCertificateContextToStore</strong></a></td>
<td>Adds a certificate context to the certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddcertificatelinktostore"><strong>CertAddCertificateLinkToStore</strong></a></td>
<td>Adds a link in a certificate store to a certificate context in a different store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddencodedcertificatetostore"><strong>CertAddEncodedCertificateToStore</strong></a></td>
<td>Converts the encoded certificate to a certificate context, and then adds the context to the certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddrefserverocspresponse"><strong>CertAddRefServerOcspResponse</strong></a></td>
<td>Increments the reference count for an <strong>HCERT_SERVER_OCSP_RESPONSE</strong> handle.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddrefserverocspresponsecontext"><strong>CertAddRefServerOcspResponseContext</strong></a></td>
<td>Increments the reference count for a <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-cert_server_ocsp_response_context"><strong>CERT_SERVER_OCSP_RESPONSE_CONTEXT</strong></a> structure.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcloseserverocspresponse"><strong>CertCloseServerOcspResponse</strong></a></td>
<td>Closes an <a href="../secgloss/o-gly.html"><em>online certificate status protocol</em></a> (OCSP) server response handle.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatecertificatecontext"><strong>CertCreateCertificateContext</strong></a></td>
<td>Creates a certificate context from an encoded certificate. The created context is not put in a certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcreateselfsigncertificate"><strong>CertCreateSelfSignCertificate</strong></a></td>
<td>Creates a self-signed certificate.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certdeletecertificatefromstore"><strong>CertDeleteCertificateFromStore</strong></a></td>
<td>Deletes a certificate from the certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certduplicatecertificatecontext"><strong>CertDuplicateCertificateContext</strong></a></td>
<td>Duplicates a certificate context by incrementing its <a href="../secgloss/r-gly.html"><em>reference count</em></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumcertificatesinstore"><strong>CertEnumCertificatesInStore</strong></a></td>
<td>Enumerates the certificate contexts in the certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindcertificateinstore"><strong>CertFindCertificateInStore</strong></a></td>
<td>Finds the first, or next, certificate context in the certificate store that meets a search criterion.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfreecertificatecontext"><strong>CertFreeCertificateContext</strong></a></td>
<td>Frees a certificate context.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetissuercertificatefromstore"><strong>CertGetIssuerCertificateFromStore</strong></a></td>
<td>Gets a certificate context from the certificate store for the first, or next, issuer of the specified subject certificate.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetserverocspresponsecontext"><strong>CertGetServerOcspResponseContext</strong></a></td>
<td>Retrieves a non-blocking, time valid <a href="../secgloss/o-gly.html"><em>online certificate status protocol</em></a> (OCSP) response context for the specified handle.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetsubjectcertificatefromstore"><strong>CertGetSubjectCertificateFromStore</strong></a></td>
<td>Gets from the certificate store the subject certificate context, which is uniquely identified by its issuer and serial number.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetvalidusages"><strong>CertGetValidUsages</strong></a></td>
<td>Returns an array of usages that consist of the intersection of the valid usages for all certificates in an array of certificates.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certopenserverocspresponse"><strong>CertOpenServerOcspResponse</strong></a></td>
<td>Opens a handle to an <a href="../secgloss/o-gly.html"><em>online certificate status protocol</em></a> (OCSP) response associated with a server certificate chain.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certretrievelogoorbiometricinfo"><strong>CertRetrieveLogoOrBiometricInfo</strong></a></td>
<td>Performs a URL retrieval of logo or biometric information specified in either the <strong>szOID_LOGOTYPE_EXT</strong> or <strong>szOID_BIOMETRIC_EXT</strong> certificate extension.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/cryptdlg/nf-cryptdlg-certselectcertificatea"><strong>CertSelectCertificate</strong></a></td>
<td>Presents a dialog box that allows the user to select certificates from a set of certificates that match a given criteria.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certselectcertificatechains"><strong>CertSelectCertificateChains</strong></a></td>
<td>Retrieves certificate chains based on specified selection criteria.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-certselectiongetserializedblob"><strong>CertSelectionGetSerializedBlob</strong></a></td>
<td>A helper function used to retrieve a serialized certificate <a href="../secgloss/b-gly.html"><em>BLOB</em></a> from a <a href="/windows/desktop/api/Cryptuiapi/ns-cryptuiapi-cert_selectui_input"><strong>CERT_SELECTUI_INPUT</strong></a> structure.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certserializecertificatestoreelement"><strong>CertSerializeCertificateStoreElement</strong></a></td>
<td>Serializes a certificate context's encoded certificate and an encoded representation of its properties.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifysubjectcertificatecontext"><strong>CertVerifySubjectCertificateContext</strong></a></td>
<td>Performs the enabled verification checks on the subject certificate using the issuer.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuidlgcertmgr"><strong>CryptUIDlgCertMgr</strong></a></td>
<td>Displays a dialog box that allows the user to manage certificates.</td>
</tr>
<tr>
<td><a href="cryptuidlgselectcertificate.html"><strong>CryptUIDlgSelectCertificate</strong></a></td>
<td>Displays a dialog box that allows a user to select a certificate.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuidlgselectcertificatefromstore"><strong>CryptUIDlgSelectCertificateFromStore</strong></a></td>
<td>Displays a dialog box that allows the selection of a certificate from a specified store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuidlgviewcertificatea"><strong>CryptUIDlgViewCertificate</strong></a></td>
<td>Presents a dialog box that displays a specified certificate.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuidlgviewcontext"><strong>CryptUIDlgViewContext</strong></a></td>
<td>Displays a certificate, CRL, or CTL.</td>
</tr>
<tr>
<td><a href="cryptuidlgviewsignerinfo.html"><strong>CryptUIDlgViewSignerInfo</strong></a></td>
<td>Displays a dialog box that contains the signer information for a signed message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/CryptDlg/nf-cryptdlg-getfriendlynameofcerta"><strong>GetFriendlyNameOfCert</strong></a></td>
<td>Retrieves the display name for a certificate.</td>
</tr>
<tr>
<td><a href="rkeyclosekeyservice.html"><strong>RKeyCloseKeyService</strong></a></td>
<td>Closes a key service handle.</td>
</tr>
<tr>
<td><a href="rkeyopenkeyservice.html"><strong>RKeyOpenKeyService</strong></a></td>
<td>Opens a key service handle on a remote computer.</td>
</tr>
<tr>
<td><a href="rkeypfxinstall.html"><strong>RKeyPFXInstall</strong></a></td>
<td>Installs a certificate on a remote computer.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Certificate Revocation List Functions</h3>
<p>These functions manage the storage and retrieval of <a href="../secgloss/c-gly.html"><em>certificate revocation lists</em></a> (CRLs).</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddcrlcontexttostore"><strong>CertAddCRLContextToStore</strong></a></td>
<td>Adds a CRL context to the certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddcrllinktostore"><strong>CertAddCRLLinkToStore</strong></a></td>
<td>Adds a link in a store to a CRL context in a different store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddencodedcrltostore"><strong>CertAddEncodedCRLToStore</strong></a></td>
<td>Converts the encoded CRL to a CRL context, and then adds the context to the certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatecrlcontext"><strong>CertCreateCRLContext</strong></a></td>
<td>Creates a CRL context from an encoded CRL. The created context is not put in a certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certdeletecrlfromstore"><strong>CertDeleteCRLFromStore</strong></a></td>
<td>Deletes a CRL from the certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certduplicatecrlcontext"><strong>CertDuplicateCRLContext</strong></a></td>
<td>Duplicates a CRL context by incrementing the <a href="../secgloss/r-gly.html"><em>reference count</em></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumcrlsinstore"><strong>CertEnumCRLsInStore</strong></a></td>
<td>Enumerates the CRL contexts in a store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindcertificateincrl"><strong>CertFindCertificateInCRL</strong></a></td>
<td>Searches the <a href="../secgloss/c-gly.html"><em>certificate revocation list</em></a> (CRL) for the specified certificate.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindcrlinstore"><strong>CertFindCRLInStore</strong></a></td>
<td>Finds the first, or next, CRL context in the certificate store that matches a specific criterion.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfreecrlcontext"><strong>CertFreeCRLContext</strong></a></td>
<td>Frees a CRL context.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcrlfromstore"><strong>CertGetCRLFromStore</strong></a></td>
<td>Gets the first, or next, CRL context from the certificate store for the specified issuer certificate.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certserializecrlstoreelement"><strong>CertSerializeCRLStoreElement</strong></a></td>
<td>Serializes the CRL context's encoded CRL and its properties.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Certificate Trust List Functions</h3>
<p>These functions manage the storage and retrieval of <a href="../secgloss/c-gly.html"><em>certificate trust lists</em></a> (CTLs).</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddctlcontexttostore"><strong>CertAddCTLContextToStore</strong></a></td>
<td>Adds a CTL context to the certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddctllinktostore"><strong>CertAddCTLLinkToStore</strong></a></td>
<td>Adds a link in a store to a CRL context in a different store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddencodedctltostore"><strong>CertAddEncodedCTLToStore</strong></a></td>
<td>Converts the encoded CTL to a CTL context, and then adds the context to the certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatectlcontext"><strong>CertCreateCTLContext</strong></a></td>
<td>Creates a CTL context from an encoded certificate trust list. The created context is not put in a certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certdeletectlfromstore"><strong>CertDeleteCTLFromStore</strong></a></td>
<td>Deletes a CTL from the certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certduplicatectlcontext"><strong>CertDuplicateCTLContext</strong></a></td>
<td>Duplicates a CTL context by incrementing the reference count.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumctlsinstore"><strong>CertEnumCTLsInStore</strong></a></td>
<td>Enumerates the CTL contexts in the certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindctlinstore"><strong>CertFindCTLInStore</strong></a></td>
<td>Finds the first, or next, CTL context in the certificate store that matches a specific criteria.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfreectlcontext"><strong>CertFreeCTLContext</strong></a></td>
<td>Frees a CTL context.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/CryptDlg/nf-cryptdlg-certmodifycertificatestotrust"><strong>CertModifyCertificatesToTrust</strong></a></td>
<td>Modifies the set of certificates in a CTL for a given purpose.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certserializectlstoreelement"><strong>CertSerializeCTLStoreElement</strong></a></td>
<td>Serializes the CTL context's encoded CTL and its properties.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Extended Property Functions</h3>
<p>The following functions work with extended properties of certificates, CRLs, and CTLs.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumcertificatecontextproperties"><strong>CertEnumCertificateContextProperties</strong></a></td>
<td>Enumerates the properties for the specified certificate context.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumcrlcontextproperties"><strong>CertEnumCRLContextProperties</strong></a></td>
<td>Enumerates the properties for the specified CRL context.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumctlcontextproperties"><strong>CertEnumCTLContextProperties</strong></a></td>
<td>Enumerates the properties for the specified CTL context.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcertificatecontextproperty"><strong>CertGetCertificateContextProperty</strong></a></td>
<td>Retrieves certificate properties.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcrlcontextproperty"><strong>CertGetCRLContextProperty</strong></a></td>
<td>Retrieves CRL properties.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetctlcontextproperty"><strong>CertGetCTLContextProperty</strong></a></td>
<td>Retrieves CTL properties.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certsetcertificatecontextproperty"><strong>CertSetCertificateContextProperty</strong></a></td>
<td>Sets certificate properties.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certsetcrlcontextproperty"><strong>CertSetCRLContextProperty</strong></a></td>
<td>Sets CRL properties.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certsetctlcontextproperty"><strong>CertSetCTLContextProperty</strong></a></td>
<td>Sets CTL properties.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>MakeCert Functions</h2>
<p>The following functions support the <a href="makecert.html">MakeCert</a> tool.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="freecryptprovfromcert.html"><strong>FreeCryptProvFromCert</strong></a></td>
<td>Releases the handle to a <a href="../secgloss/c-gly.html"><em>cryptographic service provider</em></a> (CSP) and optionally deletes the temporary container created by the <a href="getcryptprovfromcert.html"><strong>GetCryptProvFromCert</strong></a> function.</td>
</tr>
<tr>
<td><a href="getcryptprovfromcert.html"><strong>GetCryptProvFromCert</strong></a></td>
<td>Gets a handle to a CSP and a key specification for a certificate context.</td>
</tr>
<tr>
<td><a href="pvkfreecryptprov.html"><strong>PvkFreeCryptProv</strong></a></td>
<td>Releases the handle to a CSP and optionally deletes the temporary container created by the <a href="pvkgetcryptprov.html"><strong>PvkGetCryptProv</strong></a> function.</td>
</tr>
<tr>
<td><a href="pvkgetcryptprov.html"><strong>PvkGetCryptProv</strong></a></td>
<td>Gets a handle to a CSP based on either a <a href="../secgloss/p-gly.html"><em>private key</em></a> file name or a key container name.</td>
</tr>
<tr>
<td><a href="pvkprivatekeyacquirecontextfrommemory.html"><strong>PvkPrivateKeyAcquireContextFromMemory</strong></a></td>
<td>Creates a temporary container in the CSP and loads a private key from memory into the container.</td>
</tr>
<tr>
<td><a href="pvkprivatekeysave.html"><strong>PvkPrivateKeySave</strong></a></td>
<td>Saves a private key and its corresponding <a href="../secgloss/p-gly.html"><em>public key</em></a> to a specified file.</td>
</tr>
<tr>
<td><a href="signerror.html"><strong>SignError</strong></a></td>
<td>Calls <a href="/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a> and converts the return code to an <strong>HRESULT</strong>.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Certificate Verification Functions</h2>
<p>Certificates are verified using <a href="../secgloss/c-gly.html"><em>CTLs</em></a> or certificate chains. Functions are provided for both of these:</p>
<ul>
<li>Verification Functions Using CTLs</li>
<li>Certificate Chain Verification Functions</li>
</ul>
<h3>Verification Functions Using CTLs</h3>
<p>These functions use CTLs in the verification process. Additional functions for working with CTLs can be found in Certificate Trust List Functions and Extended Property Functions.</p>
<p>The following functions use CTLs directly for verification.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifyctlusage"><strong>CertVerifyCTLUsage</strong></a></td>
<td>Verifies the usage of a CTL.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgencodeandsignctl"><strong>CryptMsgEncodeAndSignCTL</strong></a></td>
<td>Encodes and signs a CTL as a message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsggetandverifysigner"><strong>CryptMsgGetAndVerifySigner</strong></a></td>
<td>Retrieves and verifies a CTL from a message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgsignctl"><strong>CryptMsgSignCTL</strong></a></td>
<td>Signs a message that contains a CTL.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Certificate Chain Verification Functions</h3>
<p>Certificate chains are built to provide trust information about individual certificates.</p>
<table>
<thead>
<tr>
<th>Function Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatecertificatechainengine"><strong>CertCreateCertificateChainEngine</strong></a></td>
<td>Creates a new, nondefault chain engine for an application.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatectlentryfromcertificatecontextproperties"><strong>CertCreateCTLEntryFromCertificateContextProperties</strong></a></td>
<td>Creates a CTL entry whose attributes are the certificate context's properties.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certduplicatecertificatechain"><strong>CertDuplicateCertificateChain</strong></a></td>
<td>Duplicates a certificate chain by incrementing the chain's <a href="../secgloss/r-gly.html"><em>reference count</em></a> and returning a pointer to the chain.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindchaininstore"><strong>CertFindChainInStore</strong></a></td>
<td>Finds the first, or next, certificate chain context in a store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfreecertificatechain"><strong>CertFreeCertificateChain</strong></a></td>
<td>Frees a certificate chain by reducing its reference count.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfreecertificatechainengine"><strong>CertFreeCertificateChainEngine</strong></a></td>
<td>Frees a nondefault certificate chain engine.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfreecertificatechainlist"><strong>CertFreeCertificateChainList</strong></a></td>
<td>Frees the array of pointers to chain contexts.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcertificatechain"><strong>CertGetCertificateChain</strong></a></td>
<td>Builds a chain context starting from an end certificate and going back to a trusted <a href="../secgloss/r-gly.html"><em>root certificate</em></a>, if possible.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certisvalidcrlforcertificate"><strong>CertIsValidCRLForCertificate</strong></a></td>
<td>Checks a <a href="../secgloss/c-gly.html"><em>CRL</em></a> to determine whether it would include a specific certificate if that certificate were revoked.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certsetcertificatecontextpropertiesfromctlentry"><strong>CertSetCertificateContextPropertiesFromCTLEntry</strong></a></td>
<td>Sets properties on the certificate context using the attributes in the CTL entry.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifycertificatechainpolicy"><strong>CertVerifyCertificateChainPolicy</strong></a></td>
<td>Checks a certificate chain to verify its validity, including its compliance with any specified validity policy criteria.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Message Functions</h2>
<p><a href="../secgloss/c-gly.html"><em>CryptoAPI</em></a> message functions consist of two groups of functions: low-level message functions and <a href="../secgloss/s-gly.html"><em>simplified message functions</em></a>.</p>
<p>Low-level message functions create and work directly with PKCS #7 messages. These functions encode PKCS #7 data for transmission and decode PKCS #7 data received. They also decrypt and verify the signatures of received messages. For an overview of the PKCS #7 standard and low-level messages, see <a href="low-level-messages.html">Low-level Messages</a>.</p>
<p>Simplified message functions are at a higher level and wrap several low-level message functions and certificate functions into single functions that perform a specific task in a specific manner. These functions reduce the number of function calls needed to accomplish a task, thereby simplifying CryptoAPI use. For an overview of simplified messages, see <a href="simplified-messages.html">Simplified Messages</a>.</p>
<ul>
<li>Low-level Message Functions</li>
<li>Simplified Message Functions</li>
</ul>
<h3>Low-level Message Functions</h3>
<p>Low-level message functions provide the functionality necessary to encode data for transmission and to decode PKCS #7 messages received. Functionality is also provided to decrypt and verify the signatures of received messages. Use of these low-level message functions in most applications is not recommended. For most applications, the use of Simplified Message Functions, which wrap several low-level message functions into a single function call, is preferred.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgcalculateencodedlength"><strong>CryptMsgCalculateEncodedLength</strong></a></td>
<td>Calculates the length of an encoded cryptographic message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgclose"><strong>CryptMsgClose</strong></a></td>
<td>Closes a handle of a cryptographic message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgcontrol"><strong>CryptMsgControl</strong></a></td>
<td>Performs a special control function after the final <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgupdate"><strong>CryptMsgUpdate</strong></a> of an encoded or decoded cryptographic message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgcountersign"><strong>CryptMsgCountersign</strong></a></td>
<td>Countersigns an already existing signature in a message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgcountersignencoded"><strong>CryptMsgCountersignEncoded</strong></a></td>
<td>Countersigns an already existing signature (encoded SignerInfo, as defined by PKCS #7).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgduplicate"><strong>CryptMsgDuplicate</strong></a></td>
<td>Duplicates a cryptographic message handle by incrementing the <a href="../secgloss/r-gly.html"><em>reference count</em></a>. The reference count keeps track of the lifetime of the message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsggetparam"><strong>CryptMsgGetParam</strong></a></td>
<td>Acquires a parameter after encoding or decoding a cryptographic message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgopentodecode"><strong>CryptMsgOpenToDecode</strong></a></td>
<td>Opens a cryptographic message for decoding.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgopentoencode"><strong>CryptMsgOpenToEncode</strong></a></td>
<td>Opens a cryptographic message for encoding.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgupdate"><strong>CryptMsgUpdate</strong></a></td>
<td>Updates the contents of a cryptographic message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgverifycountersignatureencoded"><strong>CryptMsgVerifyCountersignatureEncoded</strong></a></td>
<td>Verifies a <a href="../secgloss/c-gly.html"><em>countersignature</em></a> in terms of the SignerInfo structure (as defined by PKCS #7).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgverifycountersignatureencodedex"><strong>CryptMsgVerifyCountersignatureEncodedEx</strong></a></td>
<td>Verifies that the <em>pbSignerInfoCounterSignature</em> parameter contains the encrypted <a href="../secgloss/h-gly.html"><em>hash</em></a> of the <strong>encryptedDigest</strong> field of the <em>pbSignerInfo</em> parameter structure.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Simplified Message Functions</h3>
<p><a href="../secgloss/s-gly.html"><em>simplified message functions</em></a> wrap Low-level Message Functions into a single function to accomplish a specified task.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodemessage"><strong>CryptDecodeMessage</strong></a></td>
<td>Decodes a cryptographic message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecryptandverifymessagesignature"><strong>CryptDecryptAndVerifyMessageSignature</strong></a></td>
<td>Decrypts the specified message, and verifies the signer.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecryptmessage"><strong>CryptDecryptMessage</strong></a></td>
<td>Decrypts the specified message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencryptmessage"><strong>CryptEncryptMessage</strong></a></td>
<td>Encrypts the message for the recipient or recipients.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetmessagecertificates"><strong>CryptGetMessageCertificates</strong></a></td>
<td>Returns the <a href="../secgloss/c-gly.html"><em>certificate store</em></a> that contains the message's certificates and <a href="../secgloss/c-gly.html"><em>CRLs</em></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetmessagesignercount"><strong>CryptGetMessageSignerCount</strong></a></td>
<td>Returns the count of signers in the signed message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashmessage"><strong>CryptHashMessage</strong></a></td>
<td>Creates a hash of the message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignandencryptmessage"><strong>CryptSignAndEncryptMessage</strong></a></td>
<td>Signs the message, and then encrypts it for the recipient or recipients.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignmessagewithkey"><strong>CryptSignMessageWithKey</strong></a></td>
<td>Signs a message using a CSP's private key specified in the parameters to the function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignmessage"><strong>CryptSignMessage</strong></a></td>
<td>Signs the message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifydetachedmessagehash"><strong>CryptVerifyDetachedMessageHash</strong></a></td>
<td>Verifies a hashed message that contains a detached hash.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifydetachedmessagesignature"><strong>CryptVerifyDetachedMessageSignature</strong></a></td>
<td>Verifies a signed message that contains a detached signature or signatures.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifymessagehash"><strong>CryptVerifyMessageHash</strong></a></td>
<td>Verifies a hashed message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifymessagesignature"><strong>CryptVerifyMessageSignature</strong></a></td>
<td>Verifies a signed message.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifymessagesignaturewithkey"><strong>CryptVerifyMessageSignatureWithKey</strong></a></td>
<td>Verifies a signed message's signature by using specified public key information.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Auxiliary Functions</h2>
<p>The auxiliary functions are grouped as follows:</p>
<ul>
<li>Data Management Functions</li>
<li>Data Conversion Functions</li>
<li>Enhanced Key Usage Functions</li>
<li>Key Identifier Functions</li>
<li>OID Support Functions</li>
<li>Remote Object Retrieval Functions</li>
<li>PFX Functions</li>
</ul>
<h3>Data Management Functions</h3>
<p>The following CryptoAPI functions manage data and certificates.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertCompareCertificate<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares two certificates to determine whether they are identical.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertCompareCertificateName<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares two certificate names to determine whether they are identical.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertCompareIntegerBlob<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares two integer <!-- raw HTML omitted --><!-- raw HTML omitted -->BLOBs<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertComparePublicKeyInfo<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares two <!-- raw HTML omitted --><!-- raw HTML omitted -->public keys<!-- raw HTML omitted --><!-- raw HTML omitted --> to determine whether they are identical.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertFindAttribute<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Finds the first attribute identified by its <!-- raw HTML omitted --><!-- raw HTML omitted -->object identifier<!-- raw HTML omitted --><!-- raw HTML omitted --> (OID).</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertFindExtension<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Finds the first extension identified by its OID.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertFindRDNAttr<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Finds the first <!-- raw HTML omitted --><!-- raw HTML omitted -->RDN<!-- raw HTML omitted --><!-- raw HTML omitted --> attribute identified by its OID in the name list of the <!-- raw HTML omitted -->Relative Distinguished Names<!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertGetIntendedKeyUsage<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Acquires the intended key usage bytes from the certificate.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertGetPublicKeyLength<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Acquires the public/private key's bit length from the <!-- raw HTML omitted --><!-- raw HTML omitted -->public key BLOB<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertIsRDNAttrsInCertificateName<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares the attributes in the <!-- raw HTML omitted --><!-- raw HTML omitted -->certificate name<!-- raw HTML omitted --><!-- raw HTML omitted --> with the specified <!-- raw HTML omitted --><!-- raw HTML omitted -->CERT_RDN<!-- raw HTML omitted --><!-- raw HTML omitted --> to determine whether all attributes are included there.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertIsStrongHashToSign<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Determines whether the specified hash algorithm and the public key in the signing certificate can be used to perform strong signing.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertVerifyCRLRevocation<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Verifies that the subject certificate is not on the <!-- raw HTML omitted --><!-- raw HTML omitted -->certificate revocation list<!-- raw HTML omitted --><!-- raw HTML omitted --> (CRL).</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertVerifyCRLTimeValidity<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Verifies the time validity of a CRL.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertVerifyRevocation<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Verifies that the subject certificate is not on the CRL.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertVerifyTimeValidity<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Verifies the time validity of a certificate.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CertVerifyValidityNesting<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Verifies that the subject's time validity nests within the issuer's time validity.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptExportPKCS8<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>This function is superseded by the <!-- raw HTML omitted --><!-- raw HTML omitted -->CryptExportPKCS8Ex<!-- raw HTML omitted --><!-- raw HTML omitted --> function.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptExportPKCS8Ex<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Exports the private key in PKCS #8 format.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptExportPublicKeyInfo<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Exports the public key information associated with the provider's corresponding private key.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptExportPublicKeyInfoEx<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Exports the public key information associated with the provider's corresponding private key. This function differs from <!-- raw HTML omitted --><!-- raw HTML omitted -->CryptExportPublicKeyInfo<!-- raw HTML omitted --><!-- raw HTML omitted --> in that the user can specify the public key algorithm, thereby overriding the default provided by the CSP.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptExportPublicKeyInfoFromBCryptKeyHandle<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Exports the public key info associated with a provider's corresponding private key.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptFindCertificateKeyProvInfo<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Enumerates the cryptographic providers and their <!-- raw HTML omitted --><!-- raw HTML omitted -->key containers<!-- raw HTML omitted --><!-- raw HTML omitted --> to find the private key that corresponds to a certificate's public key.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptFindLocalizedName<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Finds the localized name for a specified name, for example, finds the localized name for the store name of the Root system.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashcertificate"><strong>CryptHashCertificate</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Hashes the encoded content.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptHashCertificate2<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Hashes a block of data by using a Cryptography API: Next Generation (CNG) hash provider.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashpublickeyinfo"><strong>CryptHashPublicKeyInfo</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Computes the hash of the encoded public key information.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashtobesigned"><strong>CryptHashToBeSigned</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Computes the hash of the &quot;to be signed&quot; information in the encoded signed content (<a href="/windows/desktop/api/Wincrypt/ns-wincrypt-cert_signed_content_info"><strong>CERT_SIGNED_CONTENT_INFO</strong></a>).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpkcs8"><strong>CryptImportPKCS8</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Imports the <a href="/windows/desktop/SecGloss/p-gly"><strong>private key</strong></a> in PKCS #8 format to a <a href="/windows/desktop/SecGloss/c-gly"><strong>cryptographic service provider</strong></a> (CSP).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfo"><strong>CryptImportPublicKeyInfo</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Converts and imports public key information into the provider, and returns a handle of the public key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfoex"><strong>CryptImportPublicKeyInfoEx</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Converts and imports the public key information into the provider, and returns a handle of the public key. Additional parameters (over those specified by <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfo"><strong>CryptImportPublicKeyInfo</strong></a>) that can be used to override defaults are provided to supplement <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-cert_public_key_info"><strong>CERT_PUBLIC_KEY_INFO</strong></a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptImportPublicKeyInfoEx2<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Imports a public key into a CNG asymmetric provider.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptMemAlloc<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Allocates memory for a buffer. This memory is used by all Crypt32.lib functions that return allocated buffers.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptMemFree<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Frees memory allocated by <!-- raw HTML omitted --><!-- raw HTML omitted -->CryptMemAlloc<!-- raw HTML omitted --><!-- raw HTML omitted --> or <!-- raw HTML omitted --><!-- raw HTML omitted -->CryptMemRealloc<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptMemRealloc<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Frees memory currently allocated for a buffer, and allocates memory for a new buffer.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptqueryobject"><strong>CryptQueryObject</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Retrieves information about the content of a BLOB or a file.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSignAndEncodeCertificate<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Encodes the &quot;to be signed&quot; information, signs this encoded information, and encodes the resulting signed, encoded information.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSignCertificate<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Signs the &quot;to be signed&quot; information in the encoded, signed content.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSIPAddProvider<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Adds a Subject Interface Package (SIP).</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSIPCreateIndirectData<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Returns a <!-- raw HTML omitted --><!-- raw HTML omitted -->SIP_INDIRECT_DATA<!-- raw HTML omitted --><!-- raw HTML omitted --> structure that contains a <!-- raw HTML omitted --><!-- raw HTML omitted -->hash<!-- raw HTML omitted --><!-- raw HTML omitted --> of the supplied <!-- raw HTML omitted --><!-- raw HTML omitted -->SIP_SUBJECTINFO<!-- raw HTML omitted --><!-- raw HTML omitted --> structure, the digest algorithm, and an encoding attribute. The hash can be used as an indirect reference to the data.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSIPGetCaps<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Retrieves the capabilities of an SIP.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSIPGetSignedDataMsg<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Retrieves an Authenticode signature from the file.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSIPLoad<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Loads the dynamic link library that implements a subject interface package and assigns appropriate library export functions to a <!-- raw HTML omitted --><!-- raw HTML omitted -->SIP_DISPATCH_INFO<!-- raw HTML omitted --><!-- raw HTML omitted --> structure.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSIPPutSignedDataMsg<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Stores an Authenticode Signature in the target file.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSIPRemoveProvider<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Removes a SIP added by a previous call to the <!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSIPAddProvider<!-- raw HTML omitted --><!-- raw HTML omitted --> function.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSIPRemoveSignedDataMsg<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Removes a specified Authenticode signature.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSIPRetrieveSubjectGuid<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Retrieves a GUID based on the header information in a specified file.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSIPRetrieveSubjectGuidForCatalogFile<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Retrieves the subject GUID associated with the specified file.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptSIPVerifyIndirectData<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Validates the indirect hashed data against the supplied subject.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptUpdateProtectedState<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Migrates the current user's master keys after the user's <!-- raw HTML omitted --><!-- raw HTML omitted -->security identifier<!-- raw HTML omitted --><!-- raw HTML omitted --> (SID) has changed.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptVerifyCertificateSignature<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Verifies the signature of a subject certificate or a <!-- raw HTML omitted --><!-- raw HTML omitted -->CRL<!-- raw HTML omitted --><!-- raw HTML omitted --> by using the public key information.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptVerifyCertificateSignatureEx<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>An extended version of <!-- raw HTML omitted --><!-- raw HTML omitted -->CryptVerifyCertificateSignature<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->GetEncSChannel<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Stores the encrypted Schannel DLL contents in memory.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->pCryptSIPGetCaps<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Implemented by an SIP to report capabilities.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Data Conversion Functions</h3>
<p>The following CryptoAPI functions convert certificate structure members to different forms.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certalgidtooid"><strong>CertAlgIdToOID</strong></a></td>
<td>Converts a CryptoAPI algorithm identifier (ALG_ID) to an <a href="../secgloss/a-gly.html"><em>Abstract Syntax Notation One</em></a> (ASN.1) <a href="../secgloss/o-gly.html"><em>object identifier</em></a> (OID) string.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetnamestringa"><strong>CertGetNameString</strong></a></td>
<td>Acquires the subject or issuer name from a certificate, and converts it to a null-terminated character string.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certnametostra"><strong>CertNameToStr</strong></a></td>
<td>Converts a certificate name <a href="../secgloss/b-gly.html"><em>BLOB</em></a> to a zero-terminated string.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certoidtoalgid"><strong>CertOIDToAlgId</strong></a></td>
<td>Converts the ASN.1 Object Identifier string to the CSP algorithm identifier.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certrdnvaluetostra"><strong>CertRDNValueToStr</strong></a></td>
<td>Converts a Name Value to a null-terminated string.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certstrtonamea"><strong>CertStrToName</strong></a></td>
<td>Converts a null-terminated <a href="../secgloss/x-gly.html"><em>X.500</em></a> string to an encoded certificate name.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptbinarytostringa"><strong>CryptBinaryToString</strong></a></td>
<td>Converts a binary sequence into a formatted string.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptformatobject"><strong>CryptFormatObject</strong></a></td>
<td>Formats encoded data, and returns a Unicode string.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptstringtobinarya"><strong>CryptStringToBinary</strong></a></td>
<td>Converts a formatted string to a binary sequence.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Enhanced Key Usage Functions</h3>
<p>The following functions deal with the <a href="../secgloss/e-gly.html"><em>enhanced key usage</em></a> (EKU) extension and the EKU extended property of certificates. The EKU extension and extended property specify and limit the valid uses of a certificate. The extensions are part of the certificate itself. They are set by the issuer of the certificate and are read-only. Certificate-extended properties are values associated with a certificate that can be set in an application.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certaddenhancedkeyusageidentifier"><strong>CertAddEnhancedKeyUsageIdentifier</strong></a></td>
<td>Adds a usage identifier to a certificate's EKU property.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetenhancedkeyusage"><strong>CertGetEnhancedKeyUsage</strong></a></td>
<td>Acquires, from a certificate, information about the EKU extension or property.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certremoveenhancedkeyusageidentifier"><strong>CertRemoveEnhancedKeyUsageIdentifier</strong></a></td>
<td>Removes the usage identifier from a certificate's EKU extended property.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certsetenhancedkeyusage"><strong>CertSetEnhancedKeyUsage</strong></a></td>
<td>Sets the EKU property for a certificate.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Key Identifier Functions</h3>
<p>Key identifier functions allow the user to create, set, retrieve, or locate a key identifier or its properties.</p>
<p>A key identifier is the unique identifier of a <a href="../secgloss/p-gly.html"><em>public/private key pair</em></a>. It can be any unique identifier but is usually the 20-byte SHA1 hash of an encoded <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-cert_public_key_info"><strong>CERT_PUBLIC_KEY_INFO</strong></a> structure. A key identifier can be obtained through the certificate's CERT_KEY_IDENTIFIER_PROP_ID. The key identifier allows the use of that <a href="../secgloss/k-gly.html"><em>key pair</em></a> to encrypt or decrypt messages without using the certificate.</p>
<p>Key identifiers are not associated with <a href="../secgloss/c-gly.html"><em>CRLs</em></a> or <a href="../secgloss/c-gly.html"><em>CTLs</em></a>.</p>
<p>A key identifier can have the same properties as a certificate context. For more information, see <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatecontext"><strong>CertCreateContext</strong></a>.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptcreatekeyidentifierfromcsp"><strong>CryptCreateKeyIdentifierFromCSP</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Creates a key identifier from a CSP's <a href="/windows/desktop/SecGloss/p-gly"><strong>public key BLOB</strong></a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CryptEnumKeyIdentifierProperties<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Enumerates key identifiers and their properties.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetkeyidentifierproperty"><strong>CryptGetKeyIdentifierProperty</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Acquires a specific property from a specified key identifier.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetkeyidentifierproperty"><strong>CryptSetKeyIdentifierProperty</strong></a></td>
<td><strong>Important:</strong> <!-- raw HTML omitted -->This API is deprecated. New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a> Microsoft may remove this API in future releases.<!-- raw HTML omitted --> Sets a property of a specified key identifier.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>OID Support Functions</h3>
<p>These functions provide <a href="../secgloss/o-gly.html"><em>object identifier</em></a> (OID) support. These functions install, register, and dispatch to OID and encoding type-specific functions.</p>
<p>The following CryptoAPI functions use these OID support functions:</p>
<ul>
<li><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject"><strong>CryptEncodeObject</strong></a></li>
<li><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobjectex"><strong>CryptEncodeObjectEx</strong></a></li>
<li><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobject"><strong>CryptDecodeObject</strong></a></li>
<li><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobjectex"><strong>CryptDecodeObjectEx</strong></a></li>
<li><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifyrevocation"><strong>CertVerifyRevocation</strong></a></li>
<li><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certopenstore"><strong>CertOpenStore</strong></a></li>
</ul>
<p>For an overview of this process, see <a href="extending-cryptoapi-functionality.html">Extending CryptoAPI Functionality</a>.</p>
<p>The following functions work with OIDs.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumoidfunction"><strong>CryptEnumOIDFunction</strong></a></td>
<td>Enumerates the registered OID functions identified by their encoding type, function name, and OID.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumoidinfo"><strong>CryptEnumOIDInfo</strong></a></td>
<td>Enumerates the registered OID information identified by their group, and calls <em>pfnEnumOIDInfo</em> for matches.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptfindoidinfo"><strong>CryptFindOIDInfo</strong></a></td>
<td>Uses the specified key and group to find OID information.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptfreeoidfunctionaddress"><strong>CryptFreeOIDFunctionAddress</strong></a></td>
<td>Releases the handle count that was incremented and returned by <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetoidfunctionaddress"><strong>CryptGetOIDFunctionAddress</strong></a> or <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetdefaultoidfunctionaddress"><strong>CryptGetDefaultOIDFunctionAddress</strong></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetdefaultoiddlllist"><strong>CryptGetDefaultOIDDllList</strong></a></td>
<td>Acquires the list of registered default DLL entries for the specified function set and encoding type.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetdefaultoidfunctionaddress"><strong>CryptGetDefaultOIDFunctionAddress</strong></a></td>
<td>Either acquires the first or next installed default function, or loads the DLL that contains the default function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetoidfunctionaddress"><strong>CryptGetOIDFunctionAddress</strong></a></td>
<td>Searches the list of installed functions for an encoding type and OID match. If a match is not found there, the registry is searched for a match.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetoidfunctionvalue"><strong>CryptGetOIDFunctionValue</strong></a></td>
<td>Acquires the value for the specified encoding type, function name, OID, and value name.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptinitoidfunctionset"><strong>CryptInitOIDFunctionSet</strong></a></td>
<td>Initializes and returns a handle of the OID function set identified by the function name supplied.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptinstalloidfunctionaddress"><strong>CryptInstallOIDFunctionAddress</strong></a></td>
<td>Installs a set of callable OID function addresses.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptregisterdefaultoidfunction"><strong>CryptRegisterDefaultOIDFunction</strong></a></td>
<td>Registers the DLL that contains the default function to be called for the specified encoding type and function name.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptregisteroidfunction"><strong>CryptRegisterOIDFunction</strong></a></td>
<td>Registers the DLL that contains the function to be called for the specified encoding type, function name, and OID.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptregisteroidinfo"><strong>CryptRegisterOIDInfo</strong></a></td>
<td>Registers the OID information specified in the <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_oid_info"><strong>CRYPT_OID_INFO</strong></a> structure, persisting it to the registry.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetoidfunctionvalue"><strong>CryptSetOIDFunctionValue</strong></a></td>
<td>Sets the value for the specified encoding type, function name, OID, and value name.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptunregisterdefaultoidfunction"><strong>CryptUnregisterDefaultOIDFunction</strong></a></td>
<td>Removes the registration for the DLL that contains the default function to be called for the specified encoding type and function name.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptunregisteroidfunction"><strong>CryptUnregisterOIDFunction</strong></a></td>
<td>Removes the registration for the DLL that contains the function to be called for the specified encoding type, function name, and OID.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptunregisteroidinfo"><strong>CryptUnregisterOIDInfo</strong></a></td>
<td>Removes the registration for the specified OID information.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Remote Object Retrieval Functions</h3>
<p>The following functions allow the user to retrieve a Public Key Infrastructure (PKI) object, acquire the URL of a certificate, CTL, or CRL, or to extract a URL from an object.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetobjecturl"><strong>CryptGetObjectUrl</strong></a></td>
<td>Acquires the URL of the remote object from a certificate, CTL, or CRL.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptretrieveobjectbyurla"><strong>CryptRetrieveObjectByUrl</strong></a></td>
<td>Retrieves the PKI object from a location specified by a URL.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>PFX Functions</h3>
<p>The following functions support Personal Information Exchange (PFX) format <a href="../secgloss/b-gly.html"><em>BLOBs</em></a>.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-pfxexportcertstore"><strong>PFXExportCertStore</strong></a></td>
<td>Exports from the referenced <a href="../secgloss/c-gly.html"><em>certificate store</em></a> the certificates and, if available, their associated <a href="../secgloss/p-gly.html"><em>private keys</em></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-pfxexportcertstoreex"><strong>PFXExportCertStoreEx</strong></a></td>
<td>Exports from the referenced certificate store the certificates and, if available, their associated private keys.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-pfximportcertstore"><strong>PFXImportCertStore</strong></a></td>
<td>Imports a PFX BLOB, and returns the handle of a store that contains certificates and any associated private keys.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-pfxispfxblob"><strong>PFXIsPFXBlob</strong></a></td>
<td>Attempts to decode the outer layer of a BLOB as a PFX packet.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-pfxverifypassword"><strong>PFXVerifyPassword</strong></a></td>
<td>Attempts to decode the outer layer of a BLOB as a PFX packet and to decrypt it with the given password.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Certificate Services Backup and Restore Functions</h2>
<p>Certificate Services includes functions for backing up and restoring the Certificate Services database. These Certificate Services backup and restore functions are contained in Certadm.dll. Unlike the other API elements associated with Certificate Services, these functions are not encapsulated in an object that can be used to call class methods. Instead, the backup and restore APIs are called by first loading the Certadm.dll library into memory by calling <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya"><strong>LoadLibrary</strong></a> and then determining the address of the functions by calling <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress"><strong>GetProcAddress</strong></a>. When you have finished calling the Certificate Services backup and restore functions, call <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary"><strong>FreeLibrary</strong></a> to free Certadm.dll resources from memory.</p>
<blockquote>
<p>[!Note]
Backup and restore functions provided by Certadm.dll do not backup or restore the Certificate Service's <a href="../secgloss/p-gly.html"><em>private keys</em></a>. For information about backing up the Certificate Services private keys, see <a href="backing-up-and-restoring-the-certificate-services-private-key.html">Backing Up and Restoring the Certificate Services Private Key</a>.</p>
<p>To call the backup and restore functions, you must have backup and restore <a href="../secgloss/p-gly.html"><em>privileges</em></a>. For details, see <a href="setting-the-backup-and-restore-privileges.html">Setting the Backup and Restore Privileges</a>.</p>
</blockquote>
<p>Â </p>
<blockquote>
<p>[!Note]<br />
If <strong>CoInitializeEx</strong> was previously called in the same thread used to call the Certificate Services backup and restore APIs, the COINIT_APARTMENTTHREADED flag must have been passed to <strong>CoInitializeEx</strong>. That is, when using the same thread, you cannot call the Certificate Services backup and restore API if the thread has previously passed in the COINIT_MULTITHREADED flag in a call to <strong>CoInitializeEx</strong>.</p>
</blockquote>
<p>Â </p>
<p>The Certificate Services Backup APIs are defined in Certbcli.h. However, when you create your program, use Certsrv.h as the include file.</p>
<p>The following APIs are exported by Certadm.dll.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupclose"><strong>CertSrvBackupClose</strong></a></td>
<td>Closes an opened file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupend"><strong>CertSrvBackupEnd</strong></a></td>
<td>Ends a backup session.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupfree"><strong>CertSrvBackupFree</strong></a></td>
<td>Frees a buffer allocated by the backup and restore APIs.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupgetbackuplogsw"><strong>CertSrvBackupGetBackupLogs</strong></a></td>
<td>Returns a list of log files that need to be backed up.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupgetdatabasenamesw"><strong>CertSrvBackupGetDatabaseNames</strong></a></td>
<td>Returns a list of database files that need to be backed up.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupgetdynamicfilelistw"><strong>CertSrvBackupGetDynamicFileList</strong></a></td>
<td>Retrieves the list of Certificate Services dynamic file names that need to be backed up for the given backup context.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupopenfilew"><strong>CertSrvBackupOpenFile</strong></a></td>
<td>Opens a file in preparation for backing it up.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackuppreparew"><strong>CertSrvBackupPrepare</strong></a></td>
<td>Prepares the database for the online backup.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupread"><strong>CertSrvBackupRead</strong></a></td>
<td>Reads the contents of an opened file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackuptruncatelogs"><strong>CertSrvBackupTruncateLogs</strong></a></td>
<td>Truncates the log files.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvisserveronlinew"><strong>CertSrvIsServerOnline</strong></a></td>
<td>Determines whether a Certificate Services server is online (actively running).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvrestoreend"><strong>CertSrvRestoreEnd</strong></a></td>
<td>Ends a restore session.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvrestoregetdatabaselocationsw"><strong>CertSrvRestoreGetDatabaseLocations</strong></a></td>
<td>Retrieves database locations (used for both backup and restore scenarios).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvrestorepreparew"><strong>CertSrvRestorePrepare</strong></a></td>
<td>Begins a restore session.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvrestoreregisterw"><strong>CertSrvRestoreRegister</strong></a></td>
<td>Registers a restore operation.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvrestoreregistercomplete"><strong>CertSrvRestoreRegisterComplete</strong></a></td>
<td>Completes a previously registered restore operation.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvrestoreregisterthroughfile"><strong>CertSrvRestoreRegisterThroughFile</strong></a></td>
<td>Registers a restore operation.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Certbcli/nf-certbcli-certsrvservercontrolw"><strong>CertSrvServerControl</strong></a></td>
<td>Sends a control command to the Certificate Services instance.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Callback Functions</h2>
<p>The callback functions in this section are used to register or install application-defined <a href="../secgloss/c-gly.html"><em>certificate store</em></a> providers and to provide related functionality through callback functions. Callback functions are implemented by an application and are called by <a href="../secgloss/c-gly.html"><em>CryptoAPI</em></a> functions. Callback functions enable the application to control, in part, the way that CryptoAPI functions manipulate data.</p>
<table>
<thead>
<tr>
<th>Callback function</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_chain_find_by_issuer_callback"><strong>CertChainFindByIssuerCallback</strong></a></td>
<td>An application-defined callback function that allows the application to filter certificates that might be added to the certificate chain.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_dll_open_store_prov_func"><strong>CertDllOpenStoreProv</strong></a></td>
<td>Defines the store provider open function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_enum_physical_store"><strong>CertEnumPhysicalStoreCallback</strong></a></td>
<td>Callback function used by the <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumphysicalstore"><strong>CertEnumPhysicalStore</strong></a> function to format and present information on each physical store found.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_enum_system_store"><strong>CertEnumSystemStoreCallback</strong></a></td>
<td>Callback function used by the <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumsystemstore"><strong>CertEnumSystemStore</strong></a> function to format and present information on each physical store found.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_enum_system_store_location"><strong>CertEnumSystemStoreLocationCallback</strong></a></td>
<td>Callback function used by the <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certenumsystemstorelocation"><strong>CertEnumSystemStoreLocation</strong></a> function to format and present information on each physical store found.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_close"><strong>CertStoreProvCloseCallback</strong></a></td>
<td>Determines what happens when an open store's <a href="../secgloss/r-gly.html"><em>reference count</em></a> becomes zero.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cert_store_prov_control"><strong>CertStoreProvControl</strong></a></td>
<td>Allows an application to be notified when there is a difference between the contents of a cached store in use and the contents of that store as it is persisted to storage.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_delete_cert"><strong>CertStoreProvDeleteCertCallback</strong></a></td>
<td>Determines actions to be taken before a certificate is deleted from a certificate store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_delete_crl"><strong>CertStoreProvDeleteCRLCallback</strong></a></td>
<td>Determines actions to be taken before a <a href="../secgloss/c-gly.html"><em>certificate revocation list</em></a> (CRL) is deleted from a certificate store.</td>
</tr>
<tr>
<td><a href="certstoreprovdeletectl.html"><strong>CertStoreProvDeleteCTL</strong></a></td>
<td>Determines whether a CTL can be deleted.</td>
</tr>
<tr>
<td><a href="certstoreprovfindcert.html"><strong>CertStoreProvFindCert</strong></a></td>
<td>Finds the first, or next, certificate in a store that matches specified criteria.</td>
</tr>
<tr>
<td><a href="certstoreprovfindcrl.html"><strong>CertStoreProvFindCRL</strong></a></td>
<td>Finds the first, or next, CRL in a store that matches specified criteria.</td>
</tr>
<tr>
<td><a href="certstoreprovfindctl.html"><strong>CertStoreProvFindCTL</strong></a></td>
<td>Finds the first, or next, CTL in a store that matches specified criteria.</td>
</tr>
<tr>
<td><a href="certstoreprovfreefindcert.html"><strong>CertStoreProvFreeFindCert</strong></a></td>
<td>Frees a previously found certificate context.</td>
</tr>
<tr>
<td><a href="certstoreprovfreefindcrl.html"><strong>CertStoreProvFreeFindCRL</strong></a></td>
<td>Frees a previously found CRL context.</td>
</tr>
<tr>
<td><a href="certstoreprovfreefindctl.html"><strong>CertStoreProvFreeFindCTL</strong></a></td>
<td>Frees a previously found CTL context.</td>
</tr>
<tr>
<td><a href="certstoreprovgetcertproperty.html"><strong>CertStoreProvGetCertProperty</strong></a></td>
<td>Retrieves a specified property of a certificate.</td>
</tr>
<tr>
<td><a href="certstoreprovgetcrlproperty.html"><strong>CertStoreProvGetCRLProperty</strong></a></td>
<td>Retrieves a specified property of a CRL.</td>
</tr>
<tr>
<td><a href="certstoreprovgetctlproperty.html"><strong>CertStoreProvGetCTLProperty</strong></a></td>
<td>Retrieves a specified property of a CTL.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_read_cert"><strong>CertStoreProvReadCertCallback</strong></a></td>
<td>Currently not used but might be exported to future CSPs.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_read_crl"><strong>CertStoreProvReadCRLCallback</strong></a></td>
<td>Currently not used but might be exported to future CSPs.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cert_store_prov_read_ctl"><strong>CertStoreProvReadCTL</strong></a></td>
<td>Read the provider's copy of the CTL context, and, if it exists, create a new CTL context.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_set_cert_property"><strong>CertStoreProvSetCertPropertyCallback</strong></a></td>
<td>Determines actions to be taken before a call to <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certsetcertificatecontextproperty"><strong>CertSetCertificateContextProperty</strong></a> or <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcertificatecontextproperty"><strong>CertGetCertificateContextProperty</strong></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_set_crl_property"><strong>CertStoreProvSetCRLPropertyCallback</strong></a></td>
<td>Determines actions to be taken before a call to <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certsetcrlcontextproperty"><strong>CertSetCRLContextProperty</strong></a> or <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcrlcontextproperty"><strong>CertGetCRLContextProperty</strong></a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_set_ctl_property"><strong>CertStoreProvSetCTLProperty</strong></a></td>
<td>Determines whether a property can be set on a CTL.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_write_cert"><strong>CertStoreProvWriteCertCallback</strong></a></td>
<td>Determines actions to be taken before adding a certificate to a store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_write_crl"><strong>CertStoreProvWriteCRLCallback</strong></a></td>
<td>Determines actions to be taken before adding a CRL to a store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_write_ctl"><strong>CertStoreProvWriteCTL</strong></a></td>
<td>Determines whether a CTL can be added to the store.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_enum_keyid_prop"><strong>CRYPT_ENUM_KEYID_PROP</strong></a></td>
<td>Callback function used by the <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumkeyidentifierproperties"><strong>CryptEnumKeyIdentifierProperties</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_enum_oid_func"><strong>CRYPT_ENUM_OID_FUNCTION</strong></a></td>
<td>Callback function used by the <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumoidfunction"><strong>CryptEnumOIDFunction</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_enum_oid_info"><strong>CRYPT_ENUM_OID_INFO</strong></a></td>
<td>Callback function used by the <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumoidinfo"><strong>CryptEnumOIDInfo</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_get_signer_certificate"><strong>CryptGetSignerCertificateCallback</strong></a></td>
<td>Callback function used with the <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_verify_message_para"><strong>CRYPT_VERIFY_MESSAGE_PARA</strong></a> structure to get and verify a message signer's certificate.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pcrypt_decrypt_private_key_func"><strong>PCRYPT_DECRYPT_PRIVATE_KEY_FUNC</strong></a></td>
<td>Callback function used by the <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpkcs8"><strong>CryptImportPKCS8</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pcrypt_encrypt_private_key_func"><strong>PCRYPT_ENCRYPT_PRIVATE_KEY_FUNC</strong></a></td>
<td>Callback function used when creating the <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_encrypted_private_key_info"><strong>CRYPT_ENCRYPTED_PRIVATE_KEY_INFO</strong></a> structure.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pcrypt_resolve_hcryptprov_func"><strong>PCRYPT_RESOLVE_HCRYPTPROV_FUNC</strong></a></td>
<td>Callback function used by the <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpkcs8"><strong>CryptImportPKCS8</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/mscat/nc-mscat-pfn_cdf_parse_error_callback"><strong>PFN_CDF_PARSE_ERROR_CALLBACK</strong></a></td>
<td>A user-defined function called for Catalog Definition Function errors while parsing a catalog definition file (CDF).</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cert_create_context_sort_func"><strong>PFN_CERT_CREATE_CONTEXT_SORT_FUNC</strong></a></td>
<td>Called for each sorted context entry when a context is created.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_cng_import_content_encrypt_key"><strong>PFN_CMSG_CNG_IMPORT_CONTENT_ENCRYPT_KEY</strong></a></td>
<td>A CNG <a href="../secgloss/o-gly.html"><em>object identifier</em></a> (OID) installable function for import of an already decrypted content encryption key (CEK).</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_cng_import_key_agree"><strong>PFN_CMSG_CNG_IMPORT_KEY_AGREE</strong></a></td>
<td>Imports a content encryption key for a key transport recipient of an enveloped message.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_cng_import_key_trans"><strong>PFN_CMSG_CNG_IMPORT_KEY_TRANS</strong></a></td>
<td>A CNG OID installable function for import and <a href="../secgloss/d-gly.html"><em>decryption</em></a> of a key-transport-recipient, encrypted, content <a href="../secgloss/e-gly.html"><em>encryption</em></a> key (CEK).</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_export_key_agree"><strong>PFN_CMSG_EXPORT_KEY_AGREE</strong></a></td>
<td>Encrypts and exports the content encryption key for a key agreement recipient of an enveloped message.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_export_key_trans"><strong>PFN_CMSG_EXPORT_KEY_TRANS</strong></a></td>
<td>Encrypts and exports the content encryption key for a key transport recipient of an enveloped message.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_export_mail_list"><strong>PFN_CMSG_EXPORT_MAIL_LIST</strong></a></td>
<td>Encrypts and exports the content encryption key for a mailing list recipient of an enveloped message.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_gen_content_encrypt_key"><strong>PFN_CMSG_GEN_CONTENT_ENCRYPT_KEY</strong></a></td>
<td>Generates the <a href="../secgloss/s-gly.html"><em>symmetric key</em></a> used to encrypt content for an enveloped message.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_import_key_agree"><strong>PFN_CMSG_IMPORT_KEY_AGREE</strong></a></td>
<td>Imports a content encryption key for a key transport recipient of an enveloped message.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_import_key_trans"><strong>PFN_CMSG_IMPORT_KEY_TRANS</strong></a></td>
<td>Imports a content encryption key for a key transport recipient of an enveloped message.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_import_mail_list"><strong>PFN_CMSG_IMPORT_MAIL_LIST</strong></a></td>
<td>Imports a content encryption key for a key transport recipient of an enveloped message.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_crypt_export_public_key_info_ex2_func"><strong>PFN_CRYPT_EXPORT_PUBLIC_KEY_INFO_EX2_FUNC</strong></a></td>
<td>Called by <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpublickeyinfoex"><strong>CryptExportPublicKeyInfoEx</strong></a> to export a public key BLOB and encode it.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_crypt_extract_encoded_signature_parameters_func"><strong>PFN_CRYPT_EXTRACT_ENCODED_SIGNATURE_PARAMETERS_FUNC</strong></a></td>
<td>Called to decode and return the hash algorithm identifier and optionally the signature parameters.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_crypt_sign_and_encode_hash_func"><strong>PFN_CRYPT_SIGN_AND_ENCODE_HASH_FUNC</strong></a></td>
<td>Called to sign and encode a computed hash.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_crypt_verify_encoded_signature_func"><strong>PFN_CRYPT_VERIFY_ENCODED_SIGNATURE_FUNC</strong></a></td>
<td>Called to decrypt an encoded signature and compare it to a computed hash.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/wincrypt/nc-wincrypt-pfn_import_public_key_info_ex2_func"><strong>PFN_IMPORT_PUBLIC_KEY_INFO_EX2_FUNC</strong></a></td>
<td>Called by <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfoex2"><strong>CryptImportPublicKeyInfoEx2</strong></a> to decode the <a href="../secgloss/p-gly.html"><em>public key algorithm</em></a> identifier, load the algorithm provider, and import the <a href="../secgloss/k-gly.html"><em>key pair</em></a>.</td>
</tr>
<tr>
<td><a href="pfnccertdisplayproc.html"><strong>PFNCCERTDISPLAYPROC</strong></a></td>
<td>A user-defined callback function that allows the caller of the <a href="cryptuidlgselectcertificate.html"><strong>CryptUIDlgSelectCertificate</strong></a> function to handle the display of certificates that the user selects to view.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/CryptDlg/nc-cryptdlg-pfncmfilterproc"><strong>PFNCMFILTERPROC</strong></a></td>
<td>Filters each certificate to decide if it will appear in the certificate selection dialog box displayed by the <a href="/windows/win32/api/cryptdlg/nf-cryptdlg-certselectcertificatea"><strong>CertSelectCertificate</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/CryptDlg/nc-cryptdlg-pfncmhookproc"><strong>PFNCMHOOKPROC</strong></a></td>
<td>Called before messages are processed by the certificate selection dialog box produced by the <a href="/windows/win32/api/cryptdlg/nf-cryptdlg-certselectcertificatea"><strong>CertSelectCertificate</strong></a> function.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Catalog Definition Functions</h2>
<p>These functions are used to create a catalog. All of these functions are called by <a href="makecat.html">MakeCat</a>.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatcdfclose"><strong>CryptCATCDFClose</strong></a></td>
<td>Closes a catalog definition file and frees the memory for the corresponding <a href="/windows/win32/api/mscat/ns-mscat-cryptcatcdf"><strong>CRYPTCATCDF</strong></a> structure.</td>
</tr>
<tr>
<td><a href="cryptcatcdfenumattributeswithcdftag.html"><strong>CryptCATCDFEnumAttributesWithCDFTag</strong></a></td>
<td>Enumerates the attributes of member files in the <strong>CatalogFiles</strong> section of a CDF.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatcdfenumcatattributes"><strong>CryptCATCDFEnumCatAttributes</strong></a></td>
<td>Enumerates catalog-level attributes within the <strong>CatalogHeader</strong> section of a CDF.</td>
</tr>
<tr>
<td><a href="cryptcatcdfenummembersbycdftagex.html"><strong>CryptCATCDFEnumMembersByCDFTagEx</strong></a></td>
<td>Enumerates the individual file members in the <strong>CatalogFiles</strong> section of a CDF.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatcdfopen"><strong>CryptCATCDFOpen</strong></a></td>
<td>Opens an existing CDF for reading and initializes a <a href="/windows/win32/api/mscat/ns-mscat-cryptcatcdf"><strong>CRYPTCATCDF</strong></a> structure.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Catalog Functions</h2>
<p>These functions are used to manage a catalog.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminacquirecontext"><strong>CryptCATAdminAcquireContext</strong></a></td>
<td>Acquires a handle to a catalog administrator context. This handle can be used by subsequent calls to the <a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminaddcatalog"><strong>CryptCATAdminAddCatalog</strong></a>, <a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminenumcatalogfromhash"><strong>CryptCATAdminEnumCatalogFromHash</strong></a>, and <a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminremovecatalog"><strong>CryptCATAdminRemoveCatalog</strong></a> functions.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminacquirecontext2"><strong>CryptCATAdminAcquireContext2</strong></a></td>
<td>Acquires a handle to a catalog administrator context for a given hash algorithm and hash policy.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminaddcatalog"><strong>CryptCATAdminAddCatalog</strong></a></td>
<td>Adds a catalog to the catalog database.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadmincalchashfromfilehandle"><strong>CryptCATAdminCalcHashFromFileHandle</strong></a></td>
<td>Calculates the hash for a file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadmincalchashfromfilehandle2"><strong>CryptCATAdminCalcHashFromFileHandle2</strong></a></td>
<td>Calculates the hash for a file by using the specified algorithm.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminenumcatalogfromhash"><strong>CryptCATAdminEnumCatalogFromHash</strong></a></td>
<td>Enumerates the catalogs that contain a specified hash.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminreleasecatalogcontext"><strong>CryptCATAdminReleaseCatalogContext</strong></a></td>
<td>Releases a handle to a catalog context previously returned by the <a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminaddcatalog"><strong>CryptCATAdminAddCatalog</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminreleasecontext"><strong>CryptCATAdminReleaseContext</strong></a></td>
<td>Releases the handle previously assigned by the <a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminacquirecontext"><strong>CryptCATAdminAcquireContext</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminremovecatalog"><strong>CryptCATAdminRemoveCatalog</strong></a></td>
<td>Deletes a catalog file and removes that catalog's entry from the Windows catalog database.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatadminresolvecatalogpath"><strong>CryptCATAdminResolveCatalogPath</strong></a></td>
<td>Retrieves the fully qualified path of the specified catalog.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatcataloginfofromcontext"><strong>CryptCATCatalogInfoFromContext</strong></a></td>
<td>Retrieves catalog information from a specified catalog context.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatclose"><strong>CryptCATClose</strong></a></td>
<td>Closes a catalog handle opened previously by the <a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatopen"><strong>CryptCATOpen</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatenumerateattr"><strong>CryptCATEnumerateAttr</strong></a></td>
<td>Enumerates the attributes associated with a member of a catalog.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatenumeratecatattr"><strong>CryptCATEnumerateCatAttr</strong></a></td>
<td>Enumerates the attributes associated with a catalog.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatenumeratemember"><strong>CryptCATEnumerateMember</strong></a></td>
<td>Enumerates the members of a catalog.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatgetattrinfo"><strong>CryptCATGetAttrInfo</strong></a></td>
<td>Retrieves information about an attribute of a member of a catalog.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatgetmemberinfo"><strong>CryptCATGetMemberInfo</strong></a></td>
<td>Retrieves member information from the catalog's PKCS #7. In addition to retrieving the member information for a specified reference tag, this function opens a member context.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-cryptcatopen"><strong>CryptCATOpen</strong></a></td>
<td>Opens a catalog, and returns a context handle to the open catalog.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mscat/nf-mscat-iscatalogfile"><strong>IsCatalogFile</strong></a></td>
<td>Retrieves a Boolean value that indicates whether the specified file is a catalog file.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>WinTrust Functions</h2>
<p>The following functions are used to perform various trust operations.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wintrustaddactionid"><strong>WintrustAddActionID</strong></a></td>
<td>Adds a trust provider action to the user's system.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wintrustgetregpolicyflags"><strong>WintrustGetRegPolicyFlags</strong></a></td>
<td>Retrieves policy flags for a policy provider.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wintrustadddefaultforusage"><strong>WintrustAddDefaultForUsage</strong></a></td>
<td>Specifies the default usage identifier and callback information for a provider</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wintrustgetdefaultforusage"><strong>WintrustGetDefaultForUsage</strong></a></td>
<td>Retrieves the default usage identifier and callback information.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wintrustloadfunctionpointers"><strong>WintrustLoadFunctionPointers</strong></a></td>
<td>Loads function entry points for a specified action GUID.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wintrustremoveactionid"><strong>WintrustRemoveActionID</strong></a></td>
<td>Removes an action added by the <a href="/windows/desktop/api/Wintrust/nf-wintrust-wintrustaddactionid"><strong>WintrustAddActionID</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wintrustsetdefaultincludepepagehashes"><strong>WintrustSetDefaultIncludePEPageHashes</strong></a></td>
<td>Sets the default setting that determines whether page hashes are included when creating subject interface package (SIP) indirect data for portable executable files.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wintrustsetregpolicyflags"><strong>WintrustSetRegPolicyFlags</strong></a></td>
<td>Sets policy flags for a policy provider.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-winverifytrust"><strong>WinVerifyTrust</strong></a></td>
<td>Performs a trust verification action on a specified object.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-winverifytrustex"><strong>WinVerifyTrustEx</strong></a></td>
<td>Performs a trust verification action on a specified object and takes a pointer to a WINTRUST_DATA structure.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wthelpercertcheckvalidsignature"><strong>WTHelperCertCheckValidSignature</strong></a></td>
<td>Checks whether a signature is valid.</td>
</tr>
<tr>
<td><a href="wthelpercertfindissuercertificate.html"><strong>WTHelperCertFindIssuerCertificate</strong></a></td>
<td>Finds an issuer certificate from the specified certificate stores that matches the specified subject certificate.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wthelpercertisselfsigned"><strong>WTHelperCertIsSelfSigned</strong></a></td>
<td>Checks whether a certificate is self-signed.</td>
</tr>
<tr>
<td><a href="wthelpergetfilehash.html"><strong>WTHelperGetFileHash</strong></a></td>
<td>Verifies the signature of a signed file and obtains the hash value and algorithm identifier for the file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wthelpergetprovcertfromchain"><strong>WTHelperGetProvCertFromChain</strong></a></td>
<td>Retrieves a trust provider certificate from the certificate chain.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wthelpergetprovprivatedatafromchain"><strong>WTHelperGetProvPrivateDataFromChain</strong></a></td>
<td>Receives a <a href="/windows/desktop/api/Wintrust/ns-wintrust-crypt_provider_privdata"><strong>CRYPT_PROVIDER_PRIVDATA</strong></a> structure from the chain by using the provider ID.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wthelpergetprovsignerfromchain"><strong>WTHelperGetProvSignerFromChain</strong></a></td>
<td>Retrieves a signer or countersigner by index from the chain.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wintrust/nf-wintrust-wthelperprovdatafromstatedata"><strong>WTHelperProvDataFromStateData</strong></a></td>
<td>Retrieves trust provider information from a specified handle.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Object Locator Functions</h2>
<p>The following callback functions can be implemented by a custom provider that is intended to be called by the Secure Channel (Schannel) security package to retrieve certificates.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_flush"><strong>PFN_CRYPT_OBJECT_LOCATOR_PROVIDER_FLUSH</strong></a></td>
<td>Specifies that an object has changed.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_get"><strong>PFN_CRYPT_OBJECT_LOCATOR_PROVIDER_GET</strong></a></td>
<td>Retrieves an object.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_release"><strong>PFN_CRYPT_OBJECT_LOCATOR_PROVIDER_RELEASE</strong></a></td>
<td>Releases the provider.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_free_password"><strong>PFN_CRYPT_OBJECT_LOCATOR_PROVIDER_FREE_PASSWORD</strong></a></td>
<td>Releases the password used to encrypt a PFX byte array.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_free"><strong>PFN_CRYPT_OBJECT_LOCATOR_PROVIDER_FREE</strong></a></td>
<td>Releases the object returned by the provider.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_free_identifier"><strong>PFN_CRYPT_OBJECT_LOCATOR_PROVIDER_FREE_IDENTIFIER</strong></a></td>
<td>Releases memory for an object identifier.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_initialize"><strong>PFN_CRYPT_OBJECT_LOCATOR_PROVIDER_INITIALIZE</strong></a></td>
<td>Initializes the provider.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
