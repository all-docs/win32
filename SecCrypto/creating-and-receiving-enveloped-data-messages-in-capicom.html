<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Creating and Receiving Enveloped Data Messages in CAPICOM</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The enveloped message consists of the encrypted message, the certificates of the intended recipients, and the set of encrypted keys, one for each recipient. The message generated is in PKCS #7/CMS format.
ms.assetid: 2acd0b58-1028-478d-bfa1-b02fa457d7e3
title: Creating and Receiving Enveloped Data Messages in CAPICOM
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Creating and Receiving Enveloped Data Messages in CAPICOM</h1>
<p>[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows ServerÂ 2008, WindowsÂ Vista, and WindowsÂ XP. Instead, use the .NET Framework to implement security features. For more information, see <a href="alternatives-to-using-capicom.html">Alternatives to Using CAPICOM</a>.]</p>
<p>An enveloped message is a message that is encrypted for a set of recipients. In the envelopment process, a session encryption key is generated and the message is encrypted with that key. The encryption key itself is then encrypted separately for each recipient using the public keys from each intended recipient's certificate. The enveloped message consists of the encrypted message, the certificates of the intended recipients, and the set of encrypted keys, one for each recipient. The message generated is in PKCS #7/CMS format.</p>
<p>The following sections show procedures and examples for enveloped message tasks:</p>
<ul>
<li><a href="sending-an-enveloped-data-message.html">Sending an Enveloped Data Message</a></li>
<li><a href="receiving-an-enveloped-data-message.html">Receiving an Enveloped Data Message</a></li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
