<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Verifying a CTL</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: To make it more difficult for an interloper to substitute a bogus certificate trust list (CTL) for an existing one, verify the signature on the CTL each time the CTL is used.
ms.assetid: 24ba6955-f6d1-4123-ab39-50385f6e03a0
title: Verifying a CTL
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Verifying a CTL</h1>
<p>To make it more difficult for an interloper to substitute a bogus <a href="../secgloss/c-gly.html"><em>certificate trust list</em></a> (CTL) for an existing one, verify the signature on the CTL each time the CTL is used. Do not use a CTL that does not contain a trusted signature.</p>
<p><strong>To verify a CTL signature</strong></p>
<ol>
<li>Open the <a href="../secgloss/c-gly.html"><em>certificate store</em></a> containing the desired CTL.</li>
<li>Get a handle to a <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-ctl_context"><strong>CTL_CONTEXT</strong></a> for the CTL. This can be done by calling any of the functions that return a handle to the <strong>CTL_CONTEXT</strong>, such as <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindctlinstore"><strong>CertFindCTLInStore</strong></a>.</li>
<li>Call <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsggetandverifysigner"><strong>CryptMsgGetAndVerifySigner</strong></a>, passing the <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-ctl_context"><strong>CTL_CONTEXT</strong></a> retrieved in step 2 in the <em>hCryptMsg</em> parameter, a handle to the certificate store containing the certificate of the trusted source for CTLs in the <em>rghSignerStore</em> parameter, and the CMSG_TRUSTED_SIGNER_FLAG in the <em>dwFlags</em> parameter. If the function returns <strong>TRUE</strong>, the signature was verified, and a pointer to the CTL signer's <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-cert_context"><strong>PCCERT_CONTEXT</strong></a> is returned in the <em>ppSigner</em> parameter.</li>
</ol>
<p>Â </p>
<p>Â </p>
</body>
