<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>RKeyOpenKeyService function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The RKeyOpenKeyService function is not supported.
ms.assetid: 3af18cf7-bc98-4ebc-a62c-7234e9fbddaa
title: RKeyOpenKeyService function (Rkeysvcc.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>RKeyOpenKeyService
api_type:</li>
<li>HeaderDef
api_location:</li>
<li>Rkeysvcc.h</li>
</ul>
<hr />
<h1>RKeyOpenKeyService function</h1>
<p>The <strong>RKeyOpenKeyService</strong> function is not supported.</p>
<p><strong>Windows ServerÂ 2003:</strong> The <strong>RKeyOpenKeyService</strong> function establishes a connection to a remote computer and opens a key service handle. The key service handle can subsequently be used by the <a href="rkeypfxinstall.html"><strong>RKeyPFXInstall</strong></a> function. Note that this behavior has changed with Windows ServerÂ 2003 with Service PackÂ 1 (SP1).</p>
<h2>Syntax</h2>
<pre lang="C++"><code>ULONG RKeyOpenKeyService(
  _In_Â Â Â Â LPSTR Â Â Â Â Â Â Â Â Â pszMachineName,
  _In_Â Â Â Â KEYSVC_TYPE Â Â Â OwnerType,
  _In_Â Â Â Â LPWSTR Â Â Â Â Â Â Â Â pwszOwnerName,
  _In_Â Â Â Â void Â Â Â Â Â Â Â Â Â Â *pAuthentication,
  _Inout_Â void Â Â Â Â Â Â Â Â Â Â *pReserved,
  _Out_Â Â Â KEYSVCC_HANDLE *phKeySvcCli
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>pszMachineName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Long pointer to a null-terminated string that represents the computer where the key service handle will be opened.</p>
<!-- raw HTML omitted -->
<p><em>OwnerType</em> [in]</p>
<!-- raw HTML omitted -->
<p><a href="keysvc-type.html"><strong>KEYSVC_TYPE</strong></a> value that represents the key type. The only supported value is <strong>KeySvcMachine</strong>.</p>
<!-- raw HTML omitted -->
<p><em>pwszOwnerName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Reserved. Set this value to <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>pAuthentication</em> [in]</p>
<!-- raw HTML omitted -->
<p>A pointer to a <strong>void</strong> that represents the authentication settings. This pointer can point to a value of zero or the following value.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>RKEYSVC_CONNECT_SECURE_ONLY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The client requires mutual authentication. If this value is specified, fallback to NTLM will fail.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>pReserved</em> [in, out]</p>
<!-- raw HTML omitted -->
<p>Reserved. Set this value to <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>phKeySvcCli</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to a <a href="keysvcc-handle.html"><strong>KEYSVCC_HANDLE</strong></a> that receives the opened key service handle. When you have finished using the handle, free the resource by calling the <a href="rkeyclosekeyservice.html"><strong>RKeyCloseKeyService</strong></a> function.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function is successful, the return value is S_OK.</p>
<p>If the function fails, the return value is a <strong>ULONG</strong> that indicates the error.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Rkeysvcc.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="rkeyclosekeyservice.html"><strong>RKeyCloseKeyService</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="rkeypfxinstall.html"><strong>RKeyPFXInstall</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
