<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PrivateKey.Open method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Accesses an existing key container. This method associates the key container to the certificate that corresponds to the private key by adding the CERT_KEY_PROV_INFO_PROP_ID property using the specified information.
ms.assetid: e5e19452-bfdc-4427-ac1d-cf8aa349bb89
title: PrivateKey.Open method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>PrivateKey.Open
api_type:</li>
<li>COM
api_location:</li>
<li>Capicom.dll</li>
</ul>
<hr />
<h1>PrivateKey.Open method</h1>
<p>[The <strong>Open</strong> method is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509certificate2.privatekey"><strong>X509Certificate2.PrivateKey Property</strong></a> in the <a href="/dotnet/api/system.security.cryptography.x509certificates.publickey.-ctor"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.]</p>
<p>The <strong>Open</strong> method accesses an existing <a href="../secgloss/k-gly.html"><em>key container</em></a>. This method associates the key container to the <a href="../secgloss/c-gly.html"><em>certificate</em></a> that corresponds to the <a href="../secgloss/p-gly.html"><em>private key</em></a> by adding the CERT_KEY_PROV_INFO_PROP_ID property using the specified information.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>PrivateKey.Open( _
  ByVal ContainerName, _
  [ ByVal ProviderName ], _
  [ ByVal ProviderType ], _
  [ ByVal KeySpec ], _
  [ ByVal StoreLocation ], _
  [ ByVal bCheckExistence ] _
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>ContainerName</em> [in]</p>
<!-- raw HTML omitted -->
<p>A string that contains the name of the key container.</p>
<!-- raw HTML omitted -->
<p><em>ProviderName</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A string that contains the name of the provider. The default value is CAPICOM_PROV_MS_ENHANCED_PROV. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_MS_DEF_PROV</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Microsoft base cryptographic provider.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_MS_ENHANCED_PROV</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Microsoft enhanced cryptographic provider.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_MS_STRONG_PROV</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Microsoft strong cryptographic provider.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_MS_DEF_RSA_SIG_PROV</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Microsoft RSA signature cryptographic provider.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_MS_DEF_RSA_SCHANNEL_PROV</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Microsoft RSA Schannel cryptographic provider.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_MS_DEF_DSS_PROV</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Microsoft base DSS cryptographic provider.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_MS_DEF_DSS_DH_PROV</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Microsoft base DSS and Diffie-Hellman cryptographic provider.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_MS_ENH_DSS_DH_PROV</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Microsoft enhanced DSS and Diffie-Hellman cryptographic provider.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_MS_DEF_DH_SCHANNEL_PROV</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Microsoft DH Schannel cryptographic provider.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_MS_SCARD_PROV</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Microsoft base smart card cryptographic provider.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_MS_ENH_RSA_AES_PROV</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Microsoft enhanced RSA and AES cryptographic provider.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>ProviderType</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A value of the <a href="capicom-prov-type.html"><strong>CAPICOM_PROV_TYPE</strong></a> enumeration that specifies a provider type. The default value is CAPICOM_PROV_RSA_FULL. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_RSA_FULL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The full <a href="../secgloss/r-gly.html"><em>RSA</em></a> <a href="../secgloss/c-gly.html"><em>cryptographic service provider</em></a> (CSP). This provider type supports both <a href="../secgloss/d-gly.html"><em>digital signatures</em></a> and data <a href="../secgloss/e-gly.html"><em>encryption</em></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_RSA_SIG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The subset of the RSA CSP that supports only those functions and algorithms that are required for <a href="../secgloss/h-gly.html"><em>hashes</em></a> and <a href="../secgloss/d-gly.html"><em>digital signatures</em></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_DSS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <a href="../secgloss/d-gly.html"><em>Digital Signature Standard</em></a> (DSS) CSP. This provider type supports only hashes and digital signatures. DSS uses the <a href="../secgloss/d-gly.html"><em>Digital Signature Algorithm</em></a> (DSA).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_FORTEZZA</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that contains the cryptographic protocols and algorithms owned by the <a href="../secgloss/n-gly.html"><em>National Institute of Standards and Technology</em></a> (NIST).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_MS_EXCHANGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that supports the Microsoft Exchange mail application and other applications that are compatible with Microsoft Mail.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_SSL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that supports the <a href="../secgloss/s-gly.html"><em>Secure Sockets Layer</em></a> (SSL) protocol.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_RSA_SCHANNEL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that supports both RSA and <a href="../secgloss/s-gly.html"><em>Schannel</em></a> protocols.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_DSS_DH</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that supports both DSS and <a href="../secgloss/d-gly.html"><em>Diffie-Hellman</em></a> protocols.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_EC_ECDSA_SIG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that supports the Elliptic Curve Digital Signature Algorithm (ECDSA) functions and algorithms required for digital signatures.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_EC_ECNRA_SIG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that supports the Elliptic Curve Nyberg-Rueppel Analog (ECNRA) functions and algorithms required for digital signatures.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_EC_ECDSA_FULL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that supports the full ECDSA.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_EC_ECNRA_FULL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that supports the full ECNRA.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_DH_SCHANNEL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that supports both <a href="../secgloss/d-gly.html"><em>Diffie-Hellman</em></a> and <a href="../secgloss/s-gly.html"><em>Schannel</em></a> protocols.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_SPYRUS_LYNKS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that supports the SPYRUS LYNKS Card device.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_RNG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that handles random number generation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_INTEL_SEC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that provides Intel security.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_REPLACE_OWF</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that supports replacement of the manner in which one-way formats are generated from passwords.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_PROV_RSA_AES</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The CSP that supports both digital signatures and data encryption using the Advanced Encryption Standard (<a href="../secgloss/a-gly.html"><em>AES</em></a>) algorithm.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>KeySpec</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A value of the <a href="capicom-key-spec.html"><strong>CAPICOM_KEY_SPEC</strong></a> enumeration that specifies the type of private key. The default value is CAPICOM_KEY_SPEC_SIGNATURE. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_KEY_SPEC_KEYEXCHANGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The key can be used for encryption and signing.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_KEY_SPEC_SIGNATURE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The key can be used only for signing.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>StoreLocation</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A value of the <a href="capicom-store-location.html"><strong>CAPICOM_STORE_LOCATION</strong></a> enumeration that specifies the location of the store where the key resides. The default value is CAPICOM_CURRENT_USER_STORE. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_MEMORY_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The store is a memory store. Any changes in the contents of the store are not persisted.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_LOCAL_MACHINE_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The store is a local computer store. Local computer stores can be read/write stores only if the user has read/write permissions. If the user has read/write permissions and if the store is opened read/write, then changes in the contents of the store are persisted.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CURRENT_USER_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The store is a current user store. A current user store may be a read/write store. If it is, changes in the contents of the store are persisted.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_ACTIVE_DIRECTORY_USER_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The store is an Active Directory store. Active Directory stores can be opened only in read-only mode. Certificates cannot be added to or removed from Active Directory stores.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_SMART_CARD_USER_STORE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The store is the group of present smart cards. Introduced in CAPICOM 2.0.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>bCheckExistence</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A Boolean value that indicates whether CAPICOM will attempt to access the key. If <strong>True</strong>, CAPICOM attempts to access the key. If the key is user protected or on a smart card or other device, a dialog box may be generated. The default value is <strong>False</strong>.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>This method returns CAPICOM_E_NOT_ALLOWED when it is scripted from a web-based application.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>CAPICOM 2.0 or later on Windows ServerÂ 2003 and WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Capicom.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="privatekey.html"><strong>PrivateKey</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="certificate-hasprivatekey.html"><strong>Certificate.HasPrivateKey</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
