<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Certificate Stores</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: CAPICOM uses digital certificates to create signatures, encrypt session encryption keys when creating enveloped messages, and decrypt encrypted session keys when an enveloped message is received.
ms.assetid: 018fc41a-19fd-4e4c-bfed-e0215afb5150
title: Using Certificate Stores
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using Certificate Stores</h1>
<p>[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows ServerÂ 2008, WindowsÂ Vista, and WindowsÂ XP. Instead, use the .NET Framework to implement security features. For more information, see <a href="alternatives-to-using-capicom.html">Alternatives to Using CAPICOM</a>.]</p>
<p>CAPICOM uses <a href="../secgloss/d-gly.html"><em>digital certificates</em></a> to create signatures, encrypt session encryption keys when creating enveloped messages, and decrypt encrypted session keys when an enveloped message is received. By default, CAPICOM uses certificates in the My store that have an associated private key for both <a href="../secgloss/d-gly.html"><em>digital signatures</em></a> creation and session key decryption. In most cases, an application would never need to open or otherwise directly deal with a certificate store.</p>
<p>However, applications creating enveloped messages use the <a href="../secgloss/p-gly.html"><em>public key</em></a> of each intended recipient of an enveloped message. These keys are retrieved from the certificates of the intended recipients. Thus, to create enveloped messages for a group of intended recipients, the certificates of those recipients would be collected in a certificate store.</p>
<p>The following table lists the standard certificate stores normally persisted on a user station.</p>
<table>
<thead>
<tr>
<th>Store</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>My</td>
<td>Contains personal certificates. These certificates will usually have an associated private key.</td>
</tr>
<tr>
<td>Other people</td>
<td>Contains the certificates of those that the user normally sends enveloped messages to or receives signed messages from.</td>
</tr>
<tr>
<td>Ca and Root</td>
<td>Contains the <a href="../secgloss/r-gly.html"><em>certificates</em></a> of certificate authorities that the user trusts to issue certificates to others. Certificates in these stores are normally supplied with the operating system or by the user's network administrator. Certificates in the Root store are typically self-signed.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Additional CAPICOM_CURRENT_USER stores can be created, opened, and persisted by giving a different store name as a string. If a store by that name does not exist, an empty store is created and opened. If a store does exist, it is opened and any certificates currently in the store are made available.</p>
<p>The following sections show examples for certificate store tasks:</p>
<ul>
<li><a href="opening-the-active-directory-store-and-retrieving-certificates.html">Opening the Active Directory Store and Retrieving Certificates</a></li>
<li><a href="adding-certificates-to-a-certificate-store.html">Adding Certificates to a Certificate Store</a></li>
<li><a href="using-stores-in-different-locations.html">Using Stores in Different Locations</a></li>
<li><a href="collecting-and-verifying-certificates.html">Collecting and Verifying Certificates</a></li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
