<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Private Key Caching Constants</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Used to represent registry entries that control private key caching by Microsoft software-based CSPs.
ms.assetid: 67909072-72fe-4777-ae52-a7b9047c9dd5
title: Private Key Caching Constants (Wincrypt.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>Private Key Caching Constants</h1>
<p>The following constants are used to represent registry entries that control <a href="../secgloss/p-gly.html"><em>private key</em></a> caching by Microsoft software-based CSPs.</p>
<table>
<thead>
<tr>
<th align="left">Constant/value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>szKEY_CRYPTOAPI_PRIVATE_KEY_OPTIONS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&quot;Software\\Policies\\Microsoft\\Cryptography&quot;<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">The path, under the <strong>HKEY_LOCAL_MACHINE</strong> root, of the private key caching registry entries.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>The following constants are used to identify registry values that control private key caching globally for a specific process by Microsoft software-based CSPs.</p>
<table>
<thead>
<tr>
<th align="left">Constant/value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>szPRIV_KEY_CACHE_MAX_ITEMS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&quot;PrivKeyCacheMaxItems&quot;<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">A <strong>REG_DWORD</strong> value under the <strong>szKEY_CRYPTOAPI_PRIVATE_KEY_OPTIONS</strong> registry key that specifies the maximum number of private keys that can be cached at one time for a single process. This check is performed whenever a stored private key is read. If the maximum number is exceeded, the least recently used key is removed from the cache.<!-- raw HTML omitted --> If this value is zero, no keys are cached. If this value is not present, the <strong>cPRIV_KEY_CACHE_MAX_ITEMS_DEFAULT</strong> value is used as the default.<!-- raw HTML omitted --> If a private key that is deleted from the cache is currently referenced in an open context, then the key is read from storage the next time an attempt is made to use the key.<!-- raw HTML omitted --> <strong>Windows ServerÂ 2003 and WindowsÂ XP with SP1 and earlier:</strong> This registry value is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>cPRIV_KEY_CACHE_MAX_ITEMS_DEFAULT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->20<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">The default value of the <strong>szPRIV_KEY_CACHE_MAX_ITEMS</strong> registry entry if no value is specified.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>szPRIV_KEY_CACHE_PURGE_INTERVAL_SECONDS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&quot;PrivKeyCachePurgeIntervalSeconds&quot;<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">A <strong>REG_DWORD</strong> value under the <strong>szKEY_CRYPTOAPI_PRIVATE_KEY_OPTIONS</strong> registry key that specifies the maximum age, in seconds, of any cached private key. This check is performed whenever a stored private key is used or read. If this amount of time has elapsed since the last clearing occurred, all cached keys that have not been referenced since the last clearing will be removed from the cache.<!-- raw HTML omitted --> If this value is not present, the <strong>cPRIV_KEY_CACHE_PURGE_INTERVAL_SECONDS_DEFAULT</strong> value is used as the default.<!-- raw HTML omitted --> If a private key that is cleared from the cache is currently referenced in an open context, then the key will be read from storage the next time an attempt is made to use the key.<!-- raw HTML omitted --> <strong>Windows ServerÂ 2003 and WindowsÂ XP with SP1 and earlier:</strong> This registry value is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>cPRIV_KEY_CACHE_PURGE_INTERVAL_SECONDS_DEFAULT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->86400<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">The default value of the <strong>szPRIV_KEY_CACHE_PURGE_INTERVAL_SECONDS</strong> registry entry if no value is specified. This value is equivalent to one day.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>The following constants are used to identify registry values that control private key caching for a single Microsoft software-based <a href="../secgloss/c-gly.html"><em>cryptographic service provider</em></a> (CSP) instance.</p>
<table>
<thead>
<tr>
<th align="left">Constant/value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted -->&quot;AllowCachePW&quot;<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">A <strong>REG_DWORD</strong> value under the <strong>HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Cryptography\Protect</strong> registry key that specifies whether password caching is enabled for password-protected keys in the Microsoft software-based CSPs. If this value is 0, then password caching is disabeld and the user is prompted for the password every time a password-protected key is used. Any other value, or the absence of this value, indicates that the password will be cached. In this scenario, the user is only prompted once per process for each such key. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>szKEY_CACHE_ENABLED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&quot;CachePrivateKeys&quot;<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">A <strong>REG_DWORD</strong> value under the <strong>szKEY_CRYPTOAPI_PRIVATE_KEY_OPTIONS</strong> registry key that specifies whether private key caching is enabled. If this value is 1, then private key caching is enabled. Any other value, or the absence of this value, indicates that private key caching is disabled.<!-- raw HTML omitted --> <strong>WindowsÂ Vista with SP1, WindowsÂ Vista and WindowsÂ XP:</strong> This registry value is not supported.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>szKEY_CACHE_SECONDS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->&quot;PrivateKeyLifetimeSeconds&quot;<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">A <strong>REG_DWORD</strong> value under the <strong>szKEY_CRYPTOAPI_PRIVATE_KEY_OPTIONS</strong> registry key that specifies the maximum age, in seconds, of any cached private key.<!-- raw HTML omitted --> <strong>WindowsÂ XP:</strong> This registry value is not supported.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>The differences between the <strong>szKEY_CACHE_SECONDS</strong> and the <strong>szPRIV_KEY_CACHE_PURGE_INTERVAL_SECONDS</strong> values are as follows:</p>
<p><strong>szKEY_CACHE_SECONDS</strong></p>
<ul>
<li>This value only applies to a specific CSP. After the CSP is released, the CSP's cache is released as well.</li>
<li>This value is only applied when an attempt is made to use a specific private key with a specific context handle.</li>
</ul>
<p><strong>szPRIV_KEY_CACHE_PURGE_INTERVAL_SECONDS</strong></p>
<ul>
<li>This value applies to all CSPs in a process. Even if the CSP is released, this cache is not released.</li>
<li>This value applies whenever any stored private key is used or read from storage in a single process.</li>
</ul>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wincrypt.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
