<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ICertificates2::Find method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Returns a Certificates object that contains all certificates that match the specified search criteria.
ms.assetid: a2b8f4d4-dce3-467b-aaa0-a125056a1dd3
title: ICertificates2::Find method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Certificates.Find</li>
<li>ICertificates2.Find
api_type:</li>
<li>COM
api_location:</li>
<li>Capicom.dll</li>
</ul>
<hr />
<h1>ICertificates2::Find method</h1>
<p>[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows ServerÂ 2008, WindowsÂ Vista, and WindowsÂ XP. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509certificate2collection"><strong>X509Certificate2Collection Class</strong></a> in the <a href="/dotnet/api/system.security.cryptography.x509certificates.publickey.-ctor"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.]</p>
<p>The <strong>Find</strong> method returns a <a href="certificates.html"><strong>Certificates</strong></a> object that contains all certificates that match the specified search criteria. This method was introduced in CAPICOM 2.0.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>Certificates.Find( _
  ByVal FindType, _
  [ ByVal varCriteria ], _
  [ ByVal bFindValidOnly ] _
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>FindType</em> [in]</p>
<!-- raw HTML omitted -->
<p>A value of the <a href="capicom-certificate-find-type.html"><strong>CAPICOM_CERTIFICATE_FIND_TYPE</strong></a> enumeration that specifies the type of matching criteria supplied in the <em>varCriteria</em> parameter. The following table shows the possible values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_SHA1_HASH</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates with a SHA1 hash that matches the SHA1 hash specified in the <em>varCriteria</em> parameter.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_SUBJECT_NAME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates whose subject name exactly or partially matches the subject name specified in the <em>varCriteria</em> parameter. This call searches the subject name field only.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_ISSUER_NAME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates whose issuer name exactly or partially matches the issuer name specified in the <em>varCriteria</em> parameter. This call searches the issuer name field only.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_ROOT_NAME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates whose root subject name exactly or partially matches the root subject name specified in the <em>varCriteria</em> parameter. This call creates a chain. This call searches the subject name field of the root certificate.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_TEMPLATE_NAME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates whose template name matches the template name specified in the <em>varCriteria</em> parameter.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_EXTENSION</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates that have an extension that matches the extension specified in the <em>varCriteria</em> parameter.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_EXTENDED_PROPERTY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates in the store that explicitly contain an extended property with the value specified in the <em>varCriteria</em> parameter.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_APPLICATION_POLICY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates in the store that have either an enhanced key usage extension, application policy extension, or extended property specified in the <em>varCriteria</em> parameter.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_CERTIFICATE_POLICY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates that contain the policy OID in the Certificate Policy extension specified in the <em>varCriteria</em> parameter.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_TIME_VALID</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates whose time is valid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_TIME_NOT_YET_VALID</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates whose time is not yet valid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_TIME_EXPIRED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates whose time has expired.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_CERTIFICATE_FIND_KEY_USAGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Returns certificates containing key usages in the KeyUsage extension specified in the <em>varCriteria</em> parameter. If the KeyUsage extension is not present, all of the key usages are assumed to be unavailable.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>varCriteria</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A variant that contains the search criteria. This data must match the type of data specified in the <em>FindType</em> parameter. If the value of the <em>FindType</em> parameter is CAPICOM_CERTIFICATE_FIND_TIME_VALID, CAPICOM_CERTIFICATE_FIND_TIME_NOT_YET_VALID, or CAPICOM_CERTIFICATE_FIND_TIME_EXPIRED and you do not pass a value into this parameter, the current time is assumed. For examples of each data type, see Remarks. The default value is 0.</p>
<!-- raw HTML omitted -->
<p><em>bFindValidOnly</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A Boolean value that indicates whether only valid certificates are returned. The default value is false; this indicates that all certificates that match the search criteria are returned.</p>
<p>If true, the search will not return the following types of certificates:</p>
<ul>
<li>Certificates whose time has expired or is not yet valid.</li>
<li>Certificates not chained properly.</li>
<li>Certificates that have signature problems.</li>
<li>Certificates that are revoked.</li>
</ul>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p><a href="certificates.html"><strong>Certificates</strong></a> object that contains the results of the search.</p>
<p><strong>CAPICOM 2.1:</strong> The <a href="certificates.html"><strong>Certificates</strong></a> object that is returned contains references to the certificates in the collection in which the search was done. Any changes made to the certificates in the returned <strong>Certificates</strong> object are reflected in that collection.</p>
<p><strong>CAPICOM 2.0, CAPICOM 2.0.0.1, CAPICOM 2.0.0.2, and CAPICOM 2.0.0.3:</strong> The <a href="certificates.html"><strong>Certificates</strong></a> object that is returned contains copies of the certificates in the collection in which the search was done. Any changes made to the certificates in the returned <strong>Certificates</strong> object are not reflected in that collection.</p>
<h2>Remarks</h2>
<p>The following examples show possible search criteria for the different search criteria types.</p>
<table>
<thead>
<tr>
<th><em>FindType</em> parameter</th>
<th><em>varCriteria</em> parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_SHA1_HASH</td>
<td>33F362434B577F844BB7226BE36F7D72EF9D9393</td>
</tr>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_SUBJECT_NAME</td>
<td>&quot;NameOfPerson&quot;</td>
</tr>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_ISSUER_NAME</td>
<td>&quot;VeriSign&quot;</td>
</tr>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_ROOT_NAME</td>
<td>&quot;Microsoft Root Authority&quot;</td>
</tr>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_TEMPLATE_NAME</td>
<td>&quot;AutoEnrollEFS&quot;<!-- raw HTML omitted --> 1.3.6.1.4.1.311.21.8.3692315854.1256661383.1690418588.4201632533.1741915387.2177932052<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_EXTENSION</td>
<td>&quot;2.5.29.31&quot;<!-- raw HTML omitted --> CAPICOM_OID_KEY_USAGE_EXTENSION<!-- raw HTML omitted --> &quot;CRL Distribution List&quot;<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_EXTENDED_PROPERTY</td>
<td>CAPICOM_PROPID_KEY_PROV_INFO</td>
</tr>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_APPLICATION_POLICY</td>
<td>&quot;1.3.6.1.5.5.7.3.3&quot;<!-- raw HTML omitted --> &quot;1.3.6.1.5.5.7.3.4&quot;<!-- raw HTML omitted --> CAPICOM_OID_SERVER_AUTH_EKU<!-- raw HTML omitted --> &quot;Code Signing&quot;<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_CERTIFICATE_POLICY</td>
<td>&quot;1.3.6.1.5.5.7.3.4.3.5&quot;<!-- raw HTML omitted --> &quot;Corporate High Assurance&quot;<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_TIME_VALID</td>
<td>#04/15/2002, 6:00 PM#</td>
</tr>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_TIME_NOT_YET_VALID</td>
<td>#04/15/2002, 6:00 PM#</td>
</tr>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_TIME_EXPIRED</td>
<td>#04/15/2002, 6:00 PM#</td>
</tr>
<tr>
<td>CAPICOM_CERTIFICATE_FIND_KEY_USAGE</td>
<td>CAPICOM_ENCIPHER_ONLY_KEY_USAGE</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of server support<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>CAPICOM 2.0 or later on Windows ServerÂ 2003 and WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Capicom.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="certificates.html"><strong>Certificates</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="capicom-oid.html"><strong>CAPICOM_OID</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
