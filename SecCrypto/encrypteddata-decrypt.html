<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EncryptedData.Decrypt method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Decrypts an encrypted and encoded data string.
ms.assetid: 7601083d-0adb-48e1-98a7-804a49f71206
title: EncryptedData.Decrypt method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>EncryptedData.Decrypt
api_type:</li>
<li>COM
api_location:</li>
<li>Capicom.dll</li>
</ul>
<hr />
<h1>EncryptedData.Decrypt method</h1>
<p>[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows ServerÂ 2008, WindowsÂ Vista, and WindowsÂ XP. Instead, use Platform Invocation Services (PInvoke) to call the Win32 API functions <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencryptmessage"><strong>CryptEncryptMessage</strong></a> and <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecryptmessage"><strong>CryptDecryptMessage</strong></a> to encrypt and decrypt messages. For information about PInvoke, see <a href="https://msdn.microsoft.com/library/aa288468.aspx">Platform Invoke Tutorial</a>. The <a href="/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5">.NET and CryptoAPI via P/Invoke: Part 1</a> and <a href="/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6">.NET and CryptoAPI via P/Invoke: Part 2</a> subsections of <a href="/previous-versions/ms867087(v=msdn.10)">Extending .NET Cryptography with CAPICOM and P/Invoke</a> may also be helpful.]</p>
<p>The <strong>Decrypt</strong> method decrypts an encrypted and encoded data string. The resulting plaintext data becomes the <a href="encrypteddata-content.html"><strong>Content</strong></a> property of the <a href="encrypteddata.html"><strong>EncryptedData</strong></a> object. Decryption of the content fails unless the secret, set by the <a href="encrypteddata-setsecret.html"><strong>SetSecret</strong></a> method, is exactly the same as the secret used to derive the key used to encrypt the content.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>EncryptedData.Decrypt( _
  ByVal EncryptedMessage _
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>EncryptedMessage</em> [in]</p>
<!-- raw HTML omitted -->
<p>String that contains the encoded, encrypted data to be decrypted.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>The session key derived from the current secret is used for the decryption. This method will not produce the correct plaintext unless the current secret exactly matches the secret used to encrypt the message.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of server support<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>CAPICOM 2.0 or later on Windows ServerÂ 2003 and WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Capicom.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cryptography-objects.html"><strong>Cryptography Objects</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="encrypteddata.html"><strong>EncryptedData</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
