<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SignedData.Verify method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Determines whether the signatures on signed data in the SignedData object are valid.
ms.assetid: 920ac235-0c1a-4b15-9cdd-c7e0c3ea6107
title: SignedData.Verify method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>SignedData.Verify
api_type:</li>
<li>COM
api_location:</li>
<li>Capicom.dll</li>
</ul>
<hr />
<h1>SignedData.Verify method</h1>
<p>[The <strong>Verify</strong> method is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.pkcs.signedcms?view=dotnet-plat-ext-3.1&amp;preserve-view=true"><strong>SignedCms Class</strong></a> in the <a href="/dotnet/api/system.security.cryptography.pkcs?view=dotnet-plat-ext-3.1&amp;preserve-view=true"><strong>System.Security.Cryptography.Pkcs</strong></a> namespace.]</p>
<p>The <strong>Verify</strong> method determines whether the <a href="../secgloss/d-gly.html"><em>signatures</em></a> on signed data in the <a href="signeddata.html"><strong>SignedData</strong></a> object are valid. To verify a signature, the encrypted <a href="../secgloss/h-gly.html"><em>hash</em></a> of the contents is decrypted by using the signer's public key from the signer's certificate. The decrypted hash is compared to a new hash of the data content. A signature is valid if the hashes match. In addition, this method also builds a certificate chain to determine the validity of the certificate that provides the <a href="../secgloss/p-gly.html"><em>public key</em></a> used to decrypt the hash.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>SignedData.Verify( _
  ByVal SignedMessage, _
  [ ByVal bDetached ], _
  [ ByVal VerifyFlag ] _
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>SignedMessage</em> [in]</p>
<!-- raw HTML omitted -->
<p>A string that contains the signed message to be verified.</p>
<!-- raw HTML omitted -->
<p><em>bDetached</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>If <strong>True</strong>, the data to be signed is detached; that is, the content that is signed is not included as part of the signed object. To verify the signature on detached content, an application must have a copy of the original content. Detached content is often used to decrease the size of a signed object to be sent across the web, if the recipient of the signed message has an original copy of the signed data. The default value is <strong>False</strong>.</p>
<!-- raw HTML omitted -->
<p><em>VerifyFlag</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A value of the <a href="capicom-signed-data-verify-flag.html">CAPICOM_SIGNED_DATA_VERIFY_FLAG</a> enumeration that indicates the verification policy. The default value is CAPICOM_VERIFY_SIGNATURE_AND_CERTIFICATE. Using this value, both the validity of the certificate and the validity of the signature are checked. This parameter may be set to verify the signature and not the certificate. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_VERIFY_SIGNATURE_ONLY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Only the signature is checked.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_VERIFY_SIGNATURE_AND_CERTIFICATE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Both the signature and the validity of the certificate used to create the signature are checked.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method returns a string that contains the encoded, signed data.</p>
<p>If this method fails, an error will be thrown. The <strong>Err</strong> object will contain additional information about the error.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>CAPICOM 2.0 or later on Windows ServerÂ 2003 and WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Capicom.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cryptography-objects.html"><strong>Cryptography Objects</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="signeddata.html"><strong>SignedData</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
