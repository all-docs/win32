<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EnvelopedData.Decrypt method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Decrypts enveloped content.
ms.assetid: 717d0595-e8bb-4725-bd53-fc1281cbc8ee
title: EnvelopedData.Decrypt method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>EnvelopedData.Decrypt
api_type:</li>
<li>COM
api_location:</li>
<li>Capicom.dll</li>
</ul>
<hr />
<h1>EnvelopedData.Decrypt method</h1>
<p>[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows ServerÂ 2008, WindowsÂ Vista, and WindowsÂ XP. Instead, use the <a href="/dotnet/api/system.security.cryptography.pkcs.envelopedcms?view=dotnet-plat-ext-3.1&amp;preserve-view=true"><strong>EnvelopedCms Class</strong></a> in the <a href="/dotnet/api/system.security.cryptography.pkcs?view=dotnet-plat-ext-3.1&amp;preserve-view=true"><strong>System.Security.Cryptography.Pkcs</strong></a> namespace.]</p>
<p>The <strong>Decrypt</strong> method decrypts enveloped content. Decryption is done if the recipient of the message has access to the <a href="../secgloss/p-gly.html"><em>private key</em></a> paired with one of the <a href="../secgloss/p-gly.html"><em>public keys</em></a> used to envelop the message. Calling the <strong>Decrypt</strong> method resets the <a href="../secgloss/s-gly.html"><em>state</em></a> of the object. If the <strong>Decrypt</strong> method succeeds, the <a href="envelopeddata-content.html"><strong>Content</strong></a> property of the <a href="envelopeddata.html"><strong>EnvelopedData</strong></a> object is set to the plaintext message.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>EnvelopedData.Decrypt( _
  ByVal EnvelopedMessage _
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>EnvelopedMessage</em> [in]</p>
<!-- raw HTML omitted -->
<p>String that contains the enveloped data to be decrypted.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>The decrypted data becomes the <a href="envelopeddata-content.html"><strong>Content</strong></a> property value for the <a href="envelopeddata.html"><strong>EnvelopedData</strong></a> object.</p>
<p>If the user of this method does not have access to a private key that matches one of the public keys used to envelop the message, the method fails. This method will fail if the certificate for the associated private key is not in either the local computer MY store or the current user MY store.</p>
<blockquote>
<p>[!IMPORTANT]
When this method is called from a web script, the script needs to use your <a href="../secgloss/p-gly.html"><em>private key</em></a> to decrypt the data. Allowing untrusted websites to use your private key is a security risk. A dialog box that asks whether the website can use your private key appears when this method is first called. If you allow the script to use your private key and select &quot;Do not ask me this again,&quot; the dialog box will no longer appear for any script that uses your private key to decrypt data within that domain. However, scripts outside that domain that attempt to use your private key to decrypt data will still cause this dialog box to appear. If you do not allow the script to use your private key and select &quot;Do not ask me this again,&quot; scripts within that domain will automatically be refused the ability to use your private key to decrypt data.</p>
</blockquote>
<p>Â </p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of server support<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>CAPICOM 2.0 or later on Windows ServerÂ 2003 and WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Capicom.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cryptography-objects.html"><strong>Cryptography Objects</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="envelopeddata.html"><strong>EnvelopedData</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
