<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EnvelopedData.Encrypt method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Generates a session key and encrypts and envelopes data.
ms.assetid: 7ae0c908-207b-4a74-a195-d12e9e7dec76
title: EnvelopedData.Encrypt method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>EnvelopedData.Encrypt
api_type:</li>
<li>COM
api_location:</li>
<li>Capicom.dll</li>
</ul>
<hr />
<h1>EnvelopedData.Encrypt method</h1>
<p>[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows ServerÂ 2008, WindowsÂ Vista, and WindowsÂ XP. Instead, use the <a href="/dotnet/api/system.security.cryptography.pkcs.envelopedcms?view=dotnet-plat-ext-3.1&amp;preserve-view=true"><strong>EnvelopedCms Class</strong></a> in the <a href="/dotnet/api/system.security.cryptography.pkcs?view=dotnet-plat-ext-3.1&amp;preserve-view=true"><strong>System.Security.Cryptography.Pkcs</strong></a> namespace.]</p>
<p>The <strong>Encrypt</strong> method generates a session key, uses that key to encrypt the contents, envelops the encrypted content for each recipient by encrypting the session key with each recipient's public key, and then returns the <a href="../secgloss/b-gly.html"><em>BLOB</em></a> that contains the encrypted contents and the encrypted session keys as an encoded string.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>EnvelopedData.Encrypt( _
  [ ByVal EncodingType ] _
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>EncodingType</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A value of the <a href="capicom-encoding-type.html"><strong>CAPICOM_ENCODING_TYPE</strong></a> enumeration that indicates the encoding type used to encode the enveloped data. The default encoding value is CAPICOM_ENCODE_BASE64. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_ENCODE_ANY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>This encoding type is used only when the input data has an unknown encoding type. If this value is used to specify the output's encoding type, CAPICOM_ENCODE_BASE64 will be used instead. Introduced in CAPICOM 2.0.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_ENCODE_BASE64</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Data is saved as a base64-encoded string.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_ENCODE_BINARY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Data is saved as a pure binary sequence.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method returns a BLOB that contains the enveloped data in an encoded string.</p>
<h2>Remarks</h2>
<p>The returned BLOB contains the encrypted content and an encrypted session key for each intended recipient. These session keys are encrypted using the public key of each recipient. The encrypted session keys can be decrypted only with a recipient's private key.</p>
<p>If the <a href="envelopeddata-recipients.html"><strong>Recipients</strong></a> property does not contain any information, this method searches the current user's AddressBook certificate store for potential recipients. If more than one potential recipient is found, the user is prompted to select a recipient from a selection dialog box.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of server support<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>CAPICOM 2.0 or later on Windows ServerÂ 2003 and WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Capicom.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="cryptography-objects.html"><strong>Cryptography Objects</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="envelopeddata.html"><strong>EnvelopedData</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
