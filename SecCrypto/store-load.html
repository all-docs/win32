<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Store.Load method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Imports certificates from a file into the store.
ms.assetid: 884326b4-77ca-43d4-bda9-127d823ce9bc
title: Store.Load method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Store.Load
api_type:</li>
<li>COM
api_location:</li>
<li>Capicom.dll</li>
</ul>
<hr />
<h1>Store.Load method</h1>
<p>[The <strong>Load</strong> method is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509store"><strong>X509Store Class</strong></a> in the <a href="/dotnet/api/system.security.cryptography.x509certificates.publickey.-ctor"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.]</p>
<p>The <strong>Load</strong> method imports certificates from a file into the store.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>Store.Load( _
  ByVal FileName, _
  [ ByVal Password ], _
  [ ByVal KeyStorageFlag ] _
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>FileName</em> [in]</p>
<!-- raw HTML omitted -->
<p>The string that contains the path to a .cer, .sst, .spc, .p7s, or .pfx file, or any Authenticode signed file.</p>
<!-- raw HTML omitted -->
<p><em>Password</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>The string that contains the plaintext password to the file. Up to 32 Unicode characters, including a terminating null character, can be used for the password. For information about protecting the password, see <a href="../secbp/handling-passwords.html">Handling Passwords</a>.</p>
<!-- raw HTML omitted -->
<p><em>KeyStorageFlag</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A value of the <a href="capicom-key-storage-flag.html"><strong>CAPICOM_KEY_STORAGE_FLAG</strong></a> enumeration that defines key storage flags. The default is CAPICOM_KEY_STORAGE_DEFAULT. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_KEY_STORAGE_DEFAULT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Default key storage.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_KEY_STORAGE_EXPORTABLE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The key is exportable.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CAPICOM_KEY_STORAGE_USER_PROTECTED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The key is user protected.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>If the <strong>Load</strong> method is called on a memory store, any key containers that are created will be deleted when the memory store is deleted. For example, if a .pfx file is loaded into a memory store and later added to a system store (such as the My store) from the memory store, the certificate in the My store will not contain a key. In this case, the .pfx file should be loaded directly into the My store.</p>
<p>This method raises CAPICOM_E_NOT_ALLOWED when it is scripted from a web-based application.</p>
<p>If the password fails to decrypt the private key file, then the default <a href="../secgloss/c-gly.html"><em>cryptographic service provider</em></a> (CSP) should be queried. If the default CSP is the Microsoft Base Cryptographic Provider and the decrypt operation fails, then the decrypt operation should be tried again with the Microsoft Strong Cryptographic Provider or Microsoft Enhanced Cryptographic Provider, whichever is available.</p>
<p>If the certificate being loaded into the store is the same as one that is already there, the <strong>Load</strong> method will delete the existing certificate from the store and then add the new certificate. The new certificate will inherit properties from the existing certificate. The existing private key container is replaced by the new private key container.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>CAPICOM 2.0 or later on Windows ServerÂ 2003 and WindowsÂ XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Capicom.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="store.html"><strong>Store</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
