<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Alternatives to Using CAPICOM</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Suggested alternatives to using CAPICOM in Windows.
ms.assetid: 8f74ff84-6165-46a3-976b-36c7f70546be
title: Alternatives to Using CAPICOM
ms.topic: article
ms.date: 07/15/2024</h2>
<h1>Alternatives to Using CAPICOM</h1>
<blockquote>
<p>[!NOTE]
CAPICOM is a 32-bit only component that was available in the <a href="https://developer.microsoft.com/windows/downloads/windows-sdk/">Windows SDK</a> for use in the following operating systems: Windows ServerÂ 2008, WindowsÂ Vista, WindowsÂ XP. Instead, use .NET or .NET Framework to implement security features. For more information, see the alternatives listed below.</p>
</blockquote>
<blockquote>
<p>[!IMPORTANT]
None of the alternatives to CAPICOM offer a solution for scripts; therefore, you must write your own ActiveX control. For more information, see <a href="/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa751968(v=vs.85)">ActiveX Controls</a>.</p>
</blockquote>
<ul>
<li><a href="#certificate-store-objects">Certificate Store Objects</a></li>
<li><a href="#digital-signature-objects">Digital Signature Objects</a></li>
<li><a href="#enveloped-data-objects">Enveloped Data Objects</a></li>
<li><a href="#data-encryption-objects">Data Encryption Objects</a></li>
<li><a href="#auxiliary-objects">Auxiliary Objects</a></li>
</ul>
<h2>Certificate Store Objects</h2>
<p>We suggest the following alternatives for working with <a href="../secgloss/c-gly.html"><em>certificate stores</em></a> and the certificates in those stores.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Alternative</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="certificate.html"><strong>Certificate</strong></a></td>
<td>The <a href="certificate.html"><strong>Certificate</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509certificate2"><strong>X509Certificate2 Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="certificatepolicies.html"><strong>CertificatePolicies</strong></a></td>
<td>The <a href="certificatepolicies.html"><strong>CertificatePolicies</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509extension"><strong>X509Extension Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace by calling the constructor that takes an OID as a parameter, and then use the OID for Certificate Policies to retrieve the certificate policies.</td>
</tr>
<tr>
<td><a href="certificates.html"><strong>Certificates</strong></a></td>
<td>The <a href="certificates.html"><strong>Certificates</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509certificate2collection"><strong>X509Certificate2Collection Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="certificatestatus.html"><strong>CertificateStatus</strong></a></td>
<td>The <a href="certificatestatus.html"><strong>CertificateStatus</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509chainstatus"><strong>X509ChainStatus Structure</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="chain.html"><strong>Chain</strong></a></td>
<td>The <a href="chain.html"><strong>Chain</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509chain"><strong>X509Chain Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="extendedproperties.html"><strong>ExtendedProperties</strong></a></td>
<td>The <a href="extendedproperties.html"><strong>ExtendedProperties</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use Platform Invocation Services (PInvoke) to call the Win32 API function <a href="/windows/win32/api/Wincrypt/nf-wincrypt-certgetcertificatecontextproperty"><strong>CertGetCertificateContextProperty</strong></a> and obtain the properties. For information about PInvoke, see <a href="/dotnet/standard/native-interop/pinvoke">Platform Invoke (P/Invoke)</a>. The <a href="/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5">.NET and CryptoAPI via P/Invoke: Part 1</a> and <a href="/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6">.NET and CryptoAPI via P/Invoke: Part 2</a> subsections of <a href="/previous-versions/ms867087(v=msdn.10)">Extending .NET Cryptography with CAPICOM and P/Invoke</a> may also be helpful.</td>
</tr>
<tr>
<td><a href="extendedproperty.html"><strong>ExtendedProperty</strong></a></td>
<td>The <a href="extendedproperty.html"><strong>ExtendedProperty</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use Platform Invocation Services (PInvoke) to call the Win32 API function <a href="/windows/win32/api/Wincrypt/nf-wincrypt-certgetcertificatecontextproperty"><strong>CertGetCertificateContextProperty</strong></a> and obtain the properties. For information about PInvoke, see <a href="/dotnet/standard/native-interop/pinvoke">Platform Invoke (P/Invoke)</a>. The <a href="/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5">.NET and CryptoAPI via P/Invoke: Part 1</a> and <a href="/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6">.NET and CryptoAPI via P/Invoke: Part 2</a> subsections of <a href="/previous-versions/ms867087(v=msdn.10)">Extending .NET Cryptography with CAPICOM and P/Invoke</a> may also be helpful.</td>
</tr>
<tr>
<td><a href="extension.html"><strong>Extension</strong></a></td>
<td>The <a href="extension.html"><strong>Extension</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509extension"><strong>X509Extension Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="extensions.html"><strong>Extensions</strong></a></td>
<td>The <a href="extensions.html"><strong>Extensions</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509extensioncollection"><strong>X509ExtensionCollection Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="privatekey.html"><strong>PrivateKey</strong></a></td>
<td>The <a href="privatekey.html"><strong>PrivateKey</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509certificate2.privatekey"><strong>X509Certificate2.PrivateKey Property</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="publickey.html"><strong>PublicKey</strong></a></td>
<td>The <a href="publickey.html"><strong>PublicKey</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509certificate2.publickey"><strong>X509Certificate2.PublicKey Property</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="store.html"><strong>Store</strong></a></td>
<td>The <a href="store.html"><strong>Store</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/previous-versions/windows/embedded/hh424027(v=msdn.10)"><strong>X509Store Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="template.html"><strong>Template</strong></a></td>
<td>The <a href="template.html"><strong>Template</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509extension"><strong>X509Extension Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace by calling the constructor that takes an OID as a parameter, and then use the OID for Certificate Template to retrieve the certificate extension template.</td>
</tr>
</tbody>
</table>
<h2>Digital Signature Objects</h2>
<p>We suggest the following alternatives to digitally sign data and to verify digital signatures.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Alternative</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="signedcode.html"><strong>SignedCode</strong></a></td>
<td>The <a href="signedcode.html"><strong>SignedCode</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use Platform Invocation Services (PInvoke) to call the Win32 API <a href="signersignex.html"><strong>SignerSignEx</strong></a>, <a href="signertimestampex.html"><strong>SignerTimeStampEx</strong></a>, and <a href="/windows/win32/api/Wintrust/nf-wintrust-winverifytrust"><strong>WinVerifyTrust</strong></a> functions to sign content with an Authenticode digital signature. For information about PInvoke, see <a href="/dotnet/standard/native-interop/pinvoke">Platform Invoke (P/Invoke)</a>. The <a href="/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5">.NET and CryptoAPI via P/Invoke: Part 1</a> and <a href="/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6">.NET and CryptoAPI via P/Invoke: Part 2</a> subsections of <a href="/previous-versions/ms867087(v=msdn.10)">Extending .NET Cryptography with CAPICOM and P/Invoke</a> may also be helpful.</td>
</tr>
<tr>
<td><a href="signeddata.html"><strong>SignedData</strong></a></td>
<td>The <a href="signeddata.html"><strong>SignedData</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.pkcs.signedcms"><strong>SignedCms Class</strong></a> in the <a href="/dotnet/api/system.security.cryptography.pkcs"><strong>System.Security.Cryptography.Pkcs</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="signer.html"><strong>Signer</strong></a></td>
<td>The <a href="signer.html"><strong>Signer</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.pkcs.cmssigner"><strong>CmsSigner Class</strong></a> in the <a href="/dotnet/api/system.security.cryptography.pkcs"><strong>System.Security.Cryptography.Pkcs</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="signers.html"><strong>Signers</strong></a></td>
<td>The <a href="signers.html"><strong>Signers</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use a collection of CmsSigner objects. For more information, see the <a href="/dotnet/api/system.security.cryptography.pkcs.cmssigner"><strong>CmsSigner Class</strong></a> in the <a href="/dotnet/api/system.security.cryptography.pkcs"><strong>System.Security.Cryptography.Pkcs</strong></a> namespace.</td>
</tr>
</tbody>
</table>
<h2>Enveloped Data Objects</h2>
<p>We suggest the following alternatives to create enveloped data messages for privacy and to decrypt data in enveloped messages.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="envelopeddata.html"><strong>EnvelopedData</strong></a></td>
<td>The <a href="envelopeddata.html"><strong>EnvelopedData</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.pkcs.envelopedcms"><strong>EnvelopedCms Class</strong></a> in the <a href="/dotnet/api/system.security.cryptography.pkcs"><strong>System.Security.Cryptography.Pkcs</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="recipients.html"><strong>Recipients</strong></a></td>
<td>The <a href="recipients.html"><strong>Recipients</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.pkcs.cmsrecipientcollection"><strong>CmsRecipientCollection Class</strong></a> in the <a href="/dotnet/api/system.security.cryptography.pkcs"><strong>System.Security.Cryptography.Pkcs</strong></a> namespace.</td>
</tr>
</tbody>
</table>
<h2>Data Encryption Objects</h2>
<p>We suggest the following alternatives to encrypt arbitrary data for privacy and to decrypt encrypted data.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="encrypteddata.html"><strong>EncryptedData</strong></a></td>
<td>The <a href="encrypteddata.html"><strong>EncryptedData</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use Platform Invocation Services (PInvoke) to call the Win32 API functions <a href="/windows/win32/api/Wincrypt/nf-wincrypt-cryptencryptmessage"><strong>CryptEncryptMessage</strong></a> and <a href="/windows/win32/api/Wincrypt/nf-wincrypt-cryptdecryptmessage"><strong>CryptDecryptMessage</strong></a> to encrypt and decrypt messages. For information about PInvoke, see <a href="/dotnet/standard/native-interop/pinvoke">Platform Invoke (P/Invoke)</a>. The <a href="/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5">.NET and CryptoAPI via P/Invoke: Part 1</a> and <a href="/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6">.NET and CryptoAPI via P/Invoke: Part 2</a> subsections of <a href="/previous-versions/ms867087(v=msdn.10)">Extending .NET Cryptography with CAPICOM and P/Invoke</a> may also be helpful.</td>
</tr>
</tbody>
</table>
<h2>Auxiliary Objects</h2>
<p>We suggest the following alternatives to change default behaviors of other objects and to manage certificates, certificate stores, and messages.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="algorithm.html"><strong>Algorithm</strong></a></td>
<td>The <a href="algorithm.html"><strong>Algorithm</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.pkcs.algorithmidentifier"><strong>AlgorithmIdentifier Class</strong></a> in the <a href="/dotnet/api/system.security.cryptography.pkcs"><strong>System.Security.Cryptography.Pkcs</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="attribute.html"><strong>Attribute</strong></a></td>
<td>The <a href="attribute.html"><strong>Attribute</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.cryptographicattributeobject"><strong>CryptographicAttributeObject Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="attributes.html"><strong>Attributes</strong></a></td>
<td>The <a href="attributes.html"><strong>Attributes</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.cryptographicattributeobjectcollection"><strong>CryptographicAttributeObjectCollection Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="basicconstraints.html"><strong>BasicConstraints</strong></a></td>
<td>The <a href="basicconstraints.html"><strong>BasicConstraints</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509basicconstraintsextension"><strong>X509BasicConstraintsExtension Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="eku.html"><strong>EKU</strong></a></td>
<td>The <a href="eku.html"><strong>EKU</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509enhancedkeyusageextension"><strong>X509EnhancedKeyUsageExtension Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="ekus.html"><strong>EKUs</strong></a></td>
<td>The <a href="ekus.html"><strong>EKUs</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509extensioncollection"><strong>X509ExtensionCollection Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="encodeddata.html"><strong>EncodedData</strong></a></td>
<td>The <a href="encodeddata.html"><strong>EncodedData</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.asnencodeddata"><strong>AsnEncodedData Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="extendedkeyusage.html"><strong>ExtendedKeyUsage</strong></a></td>
<td>The <a href="extendedkeyusage.html"><strong>ExtendedKeyUsage</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509enhancedkeyusageextension"><strong>X509EnhancedKeyUsageExtension Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="hasheddata.html"><strong>HashedData</strong></a></td>
<td>The <a href="hasheddata.html"><strong>HashedData</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/previous-versions/windows/"><strong>HashAlgorithm Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="keyusage.html"><strong>KeyUsage</strong></a></td>
<td>The <a href="keyusage.html"><strong>KeyUsage</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509enhancedkeyusageextension"><strong>X509EnhancedKeyUsageExtension Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="noticenumbers.html"><strong>NoticeNumbers</strong></a></td>
<td>The <a href="noticenumbers.html"><strong>NoticeNumbers</strong></a> object is available for use in the operating systems specified in the Requirements section. For more information, see <a href="qualifier.html"><strong>Qualifier</strong></a>.</td>
</tr>
<tr>
<td><a href="oid.html"><strong>OID</strong></a></td>
<td>The <a href="oid.html"><strong>OID</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.oid"><strong>Oid Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="oids.html"><strong>OIDs</strong></a></td>
<td>The <a href="oids.html"><strong>OIDs</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.oidcollection"><strong>OidCollection Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography</strong></a> namespace.</td>
</tr>
<tr>
<td><a href="policyinformation.html"><strong>PolicyInformation</strong></a></td>
<td>The <a href="policyinformation.html"><strong>PolicyInformation</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509extension"><strong>X509Extension Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace by calling the constructor that takes an OID as a parameter, and then use the OID for Certificate Policies to process policy information in the Certificate policies extension.</td>
</tr>
<tr>
<td><a href="qualifier.html"><strong>Qualifier</strong></a></td>
<td>The <a href="qualifier.html"><strong>Qualifier</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509extension"><strong>X509Extension Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace by calling the constructor that takes an OID as a parameter, and then use the OID for Certificate Policies to process qualifiers that are part of the policy information in the Certificate Policies extension.</td>
</tr>
<tr>
<td><a href="qualifiers.html"><strong>Qualifiers</strong></a></td>
<td>The <a href="qualifiers.html"><strong>Qualifiers</strong></a> object is available for use in the operating systems specified in the Requirements section. Instead, use the <a href="/dotnet/api/system.security.cryptography.x509certificates.x509extension"><strong>X509Extension Class</strong></a> in the <a href="/previous-versions/windows/"><strong>System.Security.Cryptography.X509Certificates</strong></a> namespace by calling the constructor that takes an OID as a parameter, and then use the OID for Certificate Policies to process qualifiers that are part of the policy information in the Certificate Policies extension.</td>
</tr>
<tr>
<td><a href="settings.html"><strong>Settings</strong></a></td>
<td>No alternative is available.</td>
</tr>
<tr>
<td><a href="utilities.html"><strong>Utilities</strong></a></td>
<td>No alternative is available.</td>
</tr>
</tbody>
</table>
</body>
