<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SPFILENOTIFY_STARTREGISTRATION message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: SPFILENOTIFY_STARTREGISTRATION message - When using the RegisterDlls INF directive to self-register DLLs, callers of SetupInstallFromInfSection may receive notifications on each file as it is registered or unregistered.
ms.assetid: 0faf277c-7805-478f-9cec-0dd7b6acdb0e
title: SPFILENOTIFY_STARTREGISTRATION message (Setupapi.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>SPFILENOTIFY_STARTREGISTRATION message</h1>
<p>When using the <strong>RegisterDlls</strong> INF directive to self-register DLLs, callers of <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona"><strong>SetupInstallFromInfSection</strong></a> may receive notifications on each file as it is registered or unregistered. To send a <strong>SPFILENOTIFY_STARTREGISTRATION</strong> notification to the callback routine once before registering a file, include SPINST_REGISTERCALLBACKAWARE plus SPINST_REGSVR in the <em>Flags</em> parameter of <strong>SetupInstallFromInfSection</strong>. To send notification of unregistration, include SPINST_REGISTERCALLBACKAWARE plus SPINST_UNREGSVR in the <em>Flags</em> parameter.</p>
<p>The callback routine specified by the <em>MsgHandler</em> parameter of <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona"><strong>SetupInstallFromInfSection</strong></a> must be the type <a href="/windows/win32/api/setupapi/nc-setupapi-psp_file_callback_a">PSP_FILE_CALLBACK</a>. Set the <em>Context</em> parameter to the same <em>Context</em> specified in <strong>SetupInstallFromInfSection</strong>. Set the <em>Notification</em> parameter to <strong>SPFILENOTIFY_STARTREGISTRATION</strong>.</p>
<pre lang="C++"><code>SPFILENOTIFY_STARTREGISTRATION
  Param1 = (UINT_PTR) pointer to file information;
  Param2 = (UINT_PTR) file registration or unregistration;
            
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Param1</em></p>
<!-- raw HTML omitted -->
<p>Pointer to a <a href="/windows/desktop/api/Setupapi/ns-setupapi-sp_register_control_statusa"><strong>SP_REGISTER_CONTROL_STATUS</strong></a> structure containing information about the file being registered or unregistered. The member <strong>cbsize</strong> should be set to the size of the structure. The <strong>FileName</strong> member should be set to the fully qualified path of the file being registered. <strong>Win32Error</strong> is not used and should be set to NO_ERROR. <strong>FailureCode</strong> is not used and should be set to SPREG_SUCCESS.</p>
<!-- raw HTML omitted -->
<p><em>Param2</em></p>
<!-- raw HTML omitted -->
<p>If the file is being registered, <em>Param2</em> should be set to a pointer to a nonzero value. If the file is being unregistered, <em>Param2</em> should be set to a pointer to zero.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>After receiving notification, the callback function may return one of the following values.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FILEOP_ABORT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Do not register or unregister the file and stop processing the INF section.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FILEOP_DOIT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Register or unregister the file and continue processing the INF section.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>FILE_SKIP</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Skip registration or unregistration of the file but continue processing the INF section<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Setupapi.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="overview.html">Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="notifications.html">Notifications</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona"><strong>SetupInstallFromInfSection</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="spfilenotify-endregistration.html"><strong>SPFILENOTIFY_ENDREGISTRATION</strong></a></p>
<!-- raw HTML omitted -->
</body>
