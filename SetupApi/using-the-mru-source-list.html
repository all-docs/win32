<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using the MRU Source List</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The SetupSetSourceList function will open or create a source list on the users system.
ms.assetid: cda632cf-6c92-48fb-aef1-25b320affd3e
title: Using the MRU Source List
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using the MRU Source List</h1>
<p>The <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupsetsourcelista"><strong>SetupSetSourceList</strong></a> function will open or create a source list on the user's system. You can specify to set the user list, the system list, a combination of the user and system lists, or a temporary list as the MRU source list. If a temporary list is used, it will be the only list available to the setup application until <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupcanceltemporarysourcelist"><strong>SetupCancelTemporarySourceList</strong></a> is called, or <strong>SetupSetSourceList</strong> is called a second time.</p>
<p>After a list is set, you can query the source list by using <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupquerysourcelista"><strong>SetupQuerySourceList</strong></a> to obtain an array of the source paths. When the source list array is no longer needed, you must call the <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupfreesourcelista"><strong>SetupFreeSourceList</strong></a> function to free the resources allocated by <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupquerysourcelista"><strong>SetupQuerySourceList</strong></a>.</p>
<p>To add a path to a source list, either one that is resident on the user's system, or a temporary list, call <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupaddtosourcelista"><strong>SetupAddToSourceList</strong></a>. If the source list specified is not temporary, that source will remain on the user's system and is accessible to subsequent installations.</p>
<p>To remove a path from the source path, call the <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupremovefromsourcelista"><strong>SetupRemoveFromSourceList</strong></a> function.</p>
<p>Â </p>
<p>Â </p>
</body>
