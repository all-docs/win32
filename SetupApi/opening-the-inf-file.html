<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Opening the INF File</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: You must use the SetupOpenInfFile function to open the INF file before you can retrieve information from it, or append other INF files to it.
ms.assetid: ba4d511a-ad19-4619-a10a-cafef789821b
title: Opening the INF File
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Opening the INF File</h1>
<p>You must use the <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupopeninffilea"><strong>SetupOpenInfFile</strong></a> function to open the INF file before you can retrieve information from it, or append other INF files to it.</p>
<p>The following opens an INF file using <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupopeninffilea"><strong>SetupOpenInfFile</strong></a> and returns a handle, MyInf, to the opened INF file. The <em>InfClass</em> parameter of <strong>SetupOpenInfFile</strong> is specified as <strong>NULL</strong> to indicate that the Class of the INF file should be ignored.</p>
<pre lang="C++"><code>HINF MyInf;                //variable to hold the INF handle
UINT ErrorLine;            //variable to hold errors returned
BOOL test=0;                 //variable to receive function success
 
MyInf = SetupOpenInfFile (
      szInfFileName,       //the filename of the inf file to open
      NULL,                //optional class information
      INF_STYLE_WIN4,      //the inf style
      &amp;ErrorLine           //line number of the syntax error
);
</code></pre>
<p>After an INF file is opened, you can call the <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupopenappendinffilea"><strong>SetupOpenAppendInfFile</strong></a> function to append a file to the open INF file. To append several files, repeat this process. If you call the <strong>SetupOpenAppendInfFile</strong> function and the filename passed to it is <strong>NULL</strong>, then the function will search the Version section of the open INF file (and any appended INF files) for a LayoutFile key. If the function finds a key, it will append the file specified by that key (usually LAYOUT.INF). When multiple INF files have been combined, <strong>SetupOpenAppendInfFile</strong> starts with the last appended INF file when it searches for a Version section.</p>
<p>Â </p>
<p>Â </p>
</body>
