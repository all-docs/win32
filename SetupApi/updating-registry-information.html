<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Updating Registry Information</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: After the queue has successfully committed, you will need to update registry information for the product you are installing.
ms.assetid: 32161538-c1bd-41a0-bb4f-a32883fe8285
title: Updating Registry Information
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Updating Registry Information</h1>
<p>After the queue has successfully committed, you will need to update registry information for the product you are installing. It is recommended that you wait until all necessary file copy operations have been successfully completed before altering registry information.</p>
<p>One way to update the registry is to call <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona"><strong>SetupInstallFromInfSection</strong></a> with the SPINST_INIFILES, SPINST_REGISTRY, or SPINST_INI2REG flags specified. These flags can be combined in one call to <strong>SetupInstallFromInfSection</strong>.</p>
<p>The following example uses SPINST_ALL^SPINST_FILES to indicate that the function should process all of the listed operations except file operations. Since only INI, registry, and file operations are listed in the <strong>Install</strong> section, this is a shorthand method of specifying the function should process all INI and registry operations.</p>
<p>The following example shows how to install registry information using the <strong>SetupInstallFromINFSection</strong> function.</p>
<pre lang="syntax"><code>Test = SetupInstallFromINFSection (
     NULL,                     //Window to own any dialog boxes
                               //created 
     MyInf,                    //INF file containing the section 
     MySection,                //the section to install
     SPINST_ALL ^ SPINST_FILES,//which installation operations 
                               //to process
     NULL,                     //the relative root key
     NULL,                     //the source root path
     0,                        //copy style
     NULL,                     //Message handler routine
     NULL,                     //Context
     NULL,                     //Device info set
     NULL                      //device info data
);
</code></pre>
<p>In the example, <em>OwnerWindow</em> is <strong>NULL</strong> because only file operations generate dialog boxes, and thus a parent window is not needed. &quot;MyInf&quot; is the INF file containing the section to process. The parameter, &quot;MySection&quot;, specifies the section to be installed. The combined flags, SPINST_ALL ^ SPINST_FILES, specify which installation operations to process, in this case, all operations except file operations. The source root path is specified as &quot;A:\&quot;.</p>
<p>Since no copy operations are being processed, the <em>CopyFlags</em>, <em>MsgHandler</em>, <em>Context</em>, <em>DeviceInfoSet</em>, and <em>DeviceInfoData</em> parameters are not specified.</p>
<p>Â </p>
<p>Â </p>
</body>
