<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Installing From an INF File</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: After you retrieve installation information from an INF file, there are several file-handling functions that you can use to install the files listed in an INF section.
ms.assetid: 4e6042a0-36a9-4f74-b6cc-554e7f7aa2d9
title: Installing From an INF File
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Installing From an INF File</h1>
<p>After you retrieve installation information from an INF file, there are several file-handling functions that you can use to install the files listed in an INF section. Low-level functions such as <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfilea"><strong>SetupInstallFile</strong></a> and <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfileexa"><strong>SetupInstallFileEx</strong></a> install a single file.</p>
<p>There are also functions to handle compressed files. The <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupgetfilecompressioninfoa"><strong>SetupGetFileCompressionInfo</strong></a> function returns information about compressed files. This information can then be used by <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupdecompressorcopyfilea"><strong>SetupDecompressOrCopyFile</strong></a> to copy and, if necessary, expand the file.</p>
<p>High-level functions such as <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona"><strong>SetupInstallFromInfSection</strong></a>, <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfilesfrominfsectiona"><strong>SetupInstallFilesFromInfSection</strong></a>, and <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallservicesfrominfsectiona"><strong>SetupInstallServicesFromInfSection</strong></a> process the installation operations in an <strong>Install</strong> or <strong>Service</strong> section. Of these, <strong>SetupInstallFromInfSection</strong> is the most versatile because it can perform any type of installation operation listed in the <strong>Install</strong> section of an INF file. This includes the registry and INI operations listed in the <strong>AddReg</strong>, <strong>DelReg</strong>, <strong>UpdateInis</strong>, or <strong>UpdateIniField</strong> lines of an <strong>Install</strong> section.</p>
<p>The <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfilesfrominfsectiona"><strong>SetupInstallFilesFromInfSection</strong></a> and <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallservicesfrominfsectiona"><strong>SetupInstallServicesFromInfSection</strong></a> functions queue operations from an <strong>Install</strong> or <strong>Service</strong> section, respectively, to an existing file queue. Note that you must call SetupInstallFromInfSection and SetupInstallServicesFromInfSection separately to queue operations and services. For more information, see <a href="file-queues.html">File Queues</a>.</p>
<p>In contrast, the <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona"><strong>SetupInstallFromInfSection</strong></a> function creates and destroys its own internal queue. A common use for <strong>SetupInstallFromInfSection</strong> is to call it after all files have been successfully copied to perform the registry and INI transactions.</p>
<p>On Windows 2000, DLL files may be self-registered by calling <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona"><strong>SetupInstallFromInfSection</strong></a> on an INF file that includes the <strong>RegisterDlls</strong> directive in its <strong>Install</strong> section. <strong>SetupInstallFromInfSection</strong> can also self-register 32-bit DLLs from a 64-bit process.</p>
<p>On 64-bit operating systems, <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona"><strong>SetupInstallFromInfSection</strong></a> may be called to perform operations on the 32-bit portion of the registry. To add a registry key to the 32-bit portion of the registry, include the FLG_ADDREG_32BITKEY flag in the <strong>AddReg</strong> line of the INF. To delete a registry key only in the 32-bit portion of the registry, include the FLG_DELREG_32BITKEY key in the <strong>DelReg</strong> line. To set or clear a binary value only in the 32-bit portion of the registry, include the FLG_BITREG_32BITKEY in the <strong>BitReg</strong> line.</p>
<p>In addition to the functions previously listed, the Setup API includes functions that queue file installation operations, either by file, or by INF section. For more information, see <a href="file-queues.html">File Queues</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
