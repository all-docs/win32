<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Extracting Files from Cabinets</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: You can extract files from a cabinet in two ways. The first and simplest way is to take advantage of the automatic cabinet processing built into the setup functions.
ms.assetid: 113333c8-28d1-4b0e-8da4-0c94389d8038
title: Extracting Files from Cabinets
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Extracting Files from Cabinets</h1>
<p>You can extract files from a cabinet in two ways. The first and simplest way is to take advantage of the automatic cabinet processing built into the setup functions.</p>
<p>The installation functions, such as <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupcommitfilequeuea"><strong>SetupCommitFileQueue</strong></a>, <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfilea"><strong>SetupInstallFile</strong></a>, and <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona"><strong>SetupInstallFromInfSection</strong></a>, check the compression on each file. If the file is in a cabinet, the functions first search for a file of that name outside the cabinet. If found, the functions install the external file, ignoring the file inside the cabinet. This enables you to update a single file inside the cabinet without rebuilding the cabinet.</p>
<p>The setup functions also track which files in a cabinet have been retrieved, so that a file is extracted only once, even if it is installed several times.</p>
<p>The second way to extract files from a cabinet is by using <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupiteratecabineta"><strong>SetupIterateCabinet</strong></a>. This function iterates through each file in a cabinet, sending a notification to a callback routine for each file found. The callback routine then returns a value that indicates whether the file should be extracted or skipped.</p>
<blockquote>
<p>[!Note]<br />
The Setup API does not supply a default callback routine to handle cabinet notifications. If you call <a href="/windows/desktop/api/Setupapi/nf-setupapi-setupiteratecabineta"><strong>SetupIterateCabinet</strong></a> explicitly, you must supply a callback routine to process the cabinet notifications that the function returns.</p>
</blockquote>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
