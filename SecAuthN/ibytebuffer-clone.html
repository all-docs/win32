<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IByteBuffer::Clone method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The Clone method creates a new object with its own seek pointer that references the same bytes as the original IByteBuffer object.
ms.assetid: 41530f1d-81e5-4bea-a254-d7d741976904
title: IByteBuffer::Clone method (Scardssp.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>IByteBuffer.Clone
api_type:</li>
<li>COM
api_location:</li>
<li>Scardssp.dll</li>
</ul>
<hr />
<h1>IByteBuffer::Clone method</h1>
<p>[The <strong>Clone</strong> method is available for use in the operating systems specified in the Requirements section. It is not available for use in Windows Server 2003 with Service Pack 1 (SP1) and later, Windows Vista, Windows Server 2008, and subsequent versions of the operating system. The <a href="/windows/desktop/api/objidl/nn-objidl-istream"><strong>IStream</strong></a> interface provides similar functionality.]</p>
<p>The <strong>Clone</strong> method creates a new object with its own seek pointer that references the same bytes as the original <a href="ibytebuffer.html"><strong>IByteBuffer</strong></a> object.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT Clone(
  [out] LPBYTEBUFFER *ppByteBuffer
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>ppByteBuffer</em> [out]</p>
<!-- raw HTML omitted -->
<p>When successful, points to the location of an <a href="ibytebuffer.html"><strong>IByteBuffer</strong></a> pointer to the new stream object. When you have finished using the <strong>IByteBuffer</strong> pointer, release it by calling the <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-release"><strong>IUnknown::Release</strong></a> function. If an error occurs, this parameter is <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>The return value is an <strong>HRESULT</strong>. A value of S_OK indicates the call was successful.</p>
<h2>Remarks</h2>
<p>This method creates a new stream object for accessing the same bytes but using a separate seek pointer. The new stream object sees the same data as the source stream object. Changes written to one object are immediately visible in the other. Range locking is shared between the stream objects.</p>
<p>The initial setting of the seek pointer in the cloned stream instance is the same as the current setting of the seek pointer in the original stream at the time of the clone operation.</p>
<h2>Examples</h2>
<p>The following example shows cloning the <a href="ibytebuffer.html"><strong>IByteBuffer</strong></a> interface.</p>
<pre lang="C++"><code>HRESULT  hr;

// Clone the buffer.
hr = pIByteBuff-&gt;Clone(&amp;pIByteClone);
if (FAILED(hr))
  printf(&quot;Failed IByteBuffer::Clone\n&quot;);
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>Windows XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of server support<!-- raw HTML omitted --></td>
<td>Windows Server 2003<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Scardssp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Type library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Scardssp.tlb<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Scardssp.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IByteBuffer is defined as E126F8FE-A7AF-11D0-B88A-00C04FD424B9<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
