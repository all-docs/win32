<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Load balancing using Schannel</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Each server can set a MachineID registry key value in the registry that gets set as a fixed part of the session ID.
ms.assetid: 1B373496-1C1B-4D4B-8CAC-B572C58E43A2
title: Load balancing using Schannel
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Load balancing using Schannel</h1>
<p>Each server can set a MachineID registry key value in the registry that gets set as a fixed part of the session ID. The MachineID registry key is a <strong>REG_DWORD</strong> value type. The load balancer can use this part of the session ID to determine which server has generated the SSL session and can maintain the map to that server. The session ID is part of the SSL/TLS handshake that is sent over the wire. The load balancer code should be using the second <strong>DWORD</strong> in the session ID when resuming or reconnecting to the client. The second <strong>DWORD</strong> of the random session ID generated by an Schannel server is replaced by the <strong>DWORD</strong> stored in the registry. The registry value for the <strong>DWORD</strong> cannot be 0xffffffff.</p>
<p>The registry key value is as follows.</p>
<pre><code>HKEY_LOCAL_MACHINE
Â Â Â SYSTEM
Â Â Â Â Â Â CurrentControlSet
Â Â Â Â Â Â Â Â Â Control
Â Â Â Â Â Â Â Â Â Â Â Â SecurityProviders
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â SCHANNEL
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MachineID&lt;dl&gt;
&lt;dt&gt;

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Data type
&lt;/dt&gt;
&lt;dd&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â REG_DWORD&lt;/dd&gt;
&lt;/dl&gt;
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
