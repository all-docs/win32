<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IByteBuffer::SetSize method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The SetSize method changes the size of the stream object.
ms.assetid: e4027a98-fce4-4db4-a9fe-e7e7436b5147
title: IByteBuffer::SetSize method (Scardssp.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>IByteBuffer.SetSize
api_type:</li>
<li>COM
api_location:</li>
<li>Scardssp.dll</li>
</ul>
<hr />
<h1>IByteBuffer::SetSize method</h1>
<p>[The <strong>SetSize</strong> method is available for use in the operating systems specified in the Requirements section. It is not available for use in Windows Server 2003 with Service Pack 1 (SP1) and later, Windows Vista, Windows Server 2008, and subsequent versions of the operating system. The <a href="/windows/desktop/api/objidl/nn-objidl-istream"><strong>IStream</strong></a> interface provides similar functionality.]</p>
<p>The <strong>SetSize</strong> method changes the size of the stream object.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT SetSize(
  [in] LONG libNewSize
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>libNewSize</em> [in]</p>
<!-- raw HTML omitted -->
<p>New size of the stream as a number of bytes</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>The return value is an <strong>HRESULT</strong>. A value of S_OK indicates the call was successful.</p>
<h2>Remarks</h2>
<p>The <strong>IByteBuffer::SetSize</strong> method changes the size of the stream object. Call this method to preallocate space for the stream. If the <em>libNewSize</em> parameter is larger than the current stream size, the stream is extended to the indicated size by filling the intervening space with bytes of undefined value. This operation is similar to the <a href="ibytebuffer-write.html"><strong>IByteBuffer::Write</strong></a> method if the seek pointer is past the current end-of-stream.</p>
<p>If the <em>libNewSize</em> parameter is smaller than the current stream, then the stream is truncated to the indicated size.</p>
<p>The seek pointer is not affected by the change in stream size.</p>
<p>Calling <strong>IByteBuffer::SetSize</strong> can be an effective way of trying to obtain a large chunk of contiguous space.</p>
<h2>Examples</h2>
<p>The following example shows setting the buffer size.</p>
<pre lang="C++"><code>LONG     lNewSize = 256;
HRESULT  hr;

// Change the buffer size.
hr = pIByteBuff-&gt;SetSize(lNewSize);
if (FAILED(hr))
  printf(&quot;Failed IByteBuffer::SetSize\n&quot;);
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>Windows XP<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of server support<!-- raw HTML omitted --></td>
<td>Windows Server 2003<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Scardssp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Type library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Scardssp.tlb<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Scardssp.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_IByteBuffer is defined as E126F8FE-A7AF-11D0-B88A-00C04FD424B9<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
