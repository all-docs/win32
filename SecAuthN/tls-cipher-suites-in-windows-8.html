<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TLS Cipher Suites in Windows 8</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Learn about TLS cipher suites in Windows 8. Cipher suites can only be negotiated for TLS versions which support them.
ms.assetid: F37C3596-E273-4144-87B9-D589EBB82C0B
title: TLS Cipher Suites in Windows 8
ms.topic: article
ms.date: 06/26/2024</h2>
<h1>TLS Cipher Suites in Windows 8</h1>
<p>Cipher suites can only be negotiated for TLS versions which support them. The highest supported TLS version is always preferred in the TLS handshake. For example, SSL_CK_RC4_128_WITH_MD5 can only be used when both the client and server do not support TLS 1.2, 1.1 &amp; 1.0 or SSL 3.0 since it is only supported with SSL 2.0.</p>
<p>Availability of cipher suites should be controlled in one of two ways:</p>
<ul>
<li>Default priority order is overridden when a priority list is configured. Cipher suites not in the priority list will not be used.</li>
<li>Allowed when application passes SCH_USE_STRONG_CRYPTO: The Microsoft Schannel provider will filter out known weak cipher suites when the application uses the SCH_USE_STRONG_CRYPTO flag. In WindowsÂ 8, RC4 cipher suites are filtered out.</li>
</ul>
<blockquote>
<p>[!IMPORTANT]
HTTP/2 web services fail with non-HTTP/2-compatible cipher suites. To ensure your web services function with HTTP/2 clients and browsers, see <a href="/troubleshoot/windows-server/windows-security/deploy-custom-cipher-suite-ordering">How to deploy custom cipher suite ordering</a>.</p>
</blockquote>
<p>FIPS-compliance has become more complex with the addition of elliptic curves making the FIPS mode enabled column in previous versions of this table misleading. For example, a cipher suite such as TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 is only FIPS-compliant when using NIST elliptic curves. To find out which combinations of elliptic curves and cipher suites will be enabled in FIPS mode, see section 3.3.1 of <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf">Guidelines for the Selection, Configuration, and Use of TLS Implementations</a>.</p>
<p>WindowsÂ 7, WindowsÂ 8, and Windows ServerÂ 2012 are updated by the Windows Update by the 3042058 update which changes the priority order. See <a href="/security-updates/SecurityAdvisories/2015/3042058">Microsoft Security Advisory 3042058</a> for more information. The following cipher suites are enabled and in this priority order by default by the Microsoft Schannel Provider:</p>
<table>
<thead>
<tr>
<th>Cipher suite string</th>
<th>Allowed by SCH_USE_STRONG_CRYPTO</th>
<th>TLS/SSL Protocol versions</th>
</tr>
</thead>
<tbody>
<tr>
<td>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384_P256</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384_P384</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P384</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA_P256</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA_P384</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA_P256</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA_P384</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_DHE_RSA_WITH_AES_128_GCM_SHA256</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_RSA_WITH_AES_256_GCM_SHA384</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_RSA_WITH_AES_128_GCM_SHA256</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_RSA_WITH_AES_256_CBC_SHA256</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_RSA_WITH_AES_128_CBC_SHA256</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_RSA_WITH_AES_256_CBC_SHA</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_RSA_WITH_AES_128_CBC_SHA</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384_P384</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_P256</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_P384</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384_P384</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256_P256</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256_P384</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA_P256</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA_P384</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA_P256</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA_P384</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_DHE_DSS_WITH_AES_256_CBC_SHA256</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_DHE_DSS_WITH_AES_128_CBC_SHA256</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_DHE_DSS_WITH_AES_256_CBC_SHA</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_DHE_DSS_WITH_AES_128_CBC_SHA</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_RSA_WITH_3DES_EDE_CBC_SHA</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0</td>
</tr>
<tr>
<td>TLS_RSA_WITH_RC4_128_SHA</td>
<td>No</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0</td>
</tr>
<tr>
<td>TLS_RSA_WITH_RC4_128_MD5</td>
<td>No</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0</td>
</tr>
<tr>
<td>TLS_RSA_WITH_NULL_SHA256       Only used when application explicitly requests.</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_RSA_WITH_NULL_SHA       Only used when application explicitly requests.</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0</td>
</tr>
<tr>
<td>SSL_CK_RC4_128_WITH_MD5       Only used when application explicitly requests.</td>
<td>No</td>
<td>SSL 2.0</td>
</tr>
<tr>
<td>SSL_CK_DES_192_EDE3_CBC_WITH_MD5       Only used when application explicitly requests.</td>
<td>Yes</td>
<td>SSL 2.0</td>
</tr>
</tbody>
</table>
<p>The following cipher suites are supported by the Microsoft Schannel Provider, but not enabled by default:</p>
<table>
<thead>
<tr>
<th>Cipher suite string</th>
<th>Allowed by SCH_USE_STRONG_CRYPTO</th>
<th>TLS/SSL Protocol versions</th>
</tr>
</thead>
<tbody>
<tr>
<td>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384_P521</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P521</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA_P521</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA_P521</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384_P521</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_P521</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384_P521</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256_P521</td>
<td>Yes</td>
<td>TLS 1.2</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA_P521</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA_P521</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0</td>
</tr>
<tr>
<td>TLS_RSA_WITH_DES_CBC_SHA</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0</td>
</tr>
<tr>
<td>TLS_RSA_EXPORT1024_WITH_RC4_56_SHA</td>
<td>No</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0</td>
</tr>
<tr>
<td>TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0</td>
</tr>
<tr>
<td>TLS_RSA_EXPORT_WITH_RC4_40_MD5</td>
<td>No</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0</td>
</tr>
<tr>
<td>TLS_RSA_WITH_NULL_MD5</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0</td>
</tr>
<tr>
<td>TLS_DHE_DSS_WITH_DES_CBC_SHA</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0</td>
</tr>
<tr>
<td>TLS_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA</td>
<td>Yes</td>
<td>TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0</td>
</tr>
<tr>
<td>SSL_CK_DES_64_CBC_WITH_MD5</td>
<td>Yes</td>
<td>SSL 2.0</td>
</tr>
<tr>
<td>SSL_CK_RC4_128_EXPORT40_WITH_MD5</td>
<td>No</td>
<td>SSL 2.0</td>
</tr>
</tbody>
</table>
<p>To add cipher suites, use the group policy setting SSL Cipher Suite Order under Computer Configuration &gt; Administrative Templates &gt; Network &gt; SSL Configuration Settings to configure a priority list for all cipher suites you want enabled.</p>
</body>
