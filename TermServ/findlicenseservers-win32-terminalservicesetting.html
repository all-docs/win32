<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>FindLicenseServers method of the Win32_TerminalServiceSetting class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: FindLicenseServers method of the Win32_TerminalServiceSetting class
description: Enumerates all of the Remote Desktop license servers, and the method of discovery.
ms.assetid: 0de2ee6f-6c56-4293-84da-131b433c6a9d
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>FindLicenseServers method Remote Desktop Services</li>
<li>FindLicenseServers method Remote Desktop Services , Win32_TerminalServiceSetting class</li>
<li>Win32_TerminalServiceSetting class Remote Desktop Services , FindLicenseServers method
topic_type:</li>
<li>apiref
api_name:</li>
<li>Win32_TerminalServiceSetting.FindLicenseServers
api_location:</li>
<li>TSCfgWmi.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>FindLicenseServers method of the Win32_TerminalServiceSetting class</h1>
<p>Enumerates all of the Remote Desktop license servers, and the method of discovery.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 FindLicenseServers(
  [out] Win32_TSDiscoveredLicenseServer LicenseServersList[],
  [out] uint32                          Count
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>LicenseServersList</em> [out]</p>
<!-- raw HTML omitted -->
<p>The list of <a href="win32-tsdiscoveredlicenseserver.html"><strong>Win32_TSDiscoveredLicenseServer</strong></a> objects. Each object in the output list has the name of the Remote Desktop license server, and the method of discovery.</p>
<!-- raw HTML omitted -->
<p><em>Count</em> [out]</p>
<!-- raw HTML omitted -->
<p>The total number of discovered Remote Desktop license servers in the output list.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>To connect to the \root\CIMV2\TerminalServices namespace, the authentication level must include packet privacy. For C/C++ calls, this is an authentication level of <strong>RPC_C_AUTHN_LEVEL_PKT_PRIVACY</strong>. For Visual Basic and scripting calls, this is an authentication level of <strong>WbemAuthenticationLevelPktPrivacy</strong> or &quot;pktPrivacy&quot;, with a value of 6. The following Visual Basic Scripting Edition (VBScript) example shows how to connect to a remote computer with packet privacy.</p>
<pre lang="VB"><code>strComputer = &quot;RemoteServer1&quot; 
Set objServices = GetObject( _
    &quot;winmgmts:{authenticationLevel=pktPrivacy}!Root/CIMv2/TerminalServices&quot;)
</code></pre>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Microsoft Windows Software Development Kit (SDK). They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="/windows/desktop/WmiSdk/managed-object-format--mof-">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMv2\TerminalServices<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->TSCfgWmi.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->TSCfgWmi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-terminalservicesetting.html"><strong>Win32_TerminalServiceSetting</strong></a></p>
<!-- raw HTML omitted -->
</body>
