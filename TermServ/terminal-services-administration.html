<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Remote Desktop Services Administration</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Remote Desktop Services Administration
description: The Remote Desktop Services API enables you to enumerate and manage Remote Desktop Session Host (RDÂ Session Host) servers, client sessions, and processes.
ms.assetid: 85a9ed9d-79d6-4011-93a4-00847c689747
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Remote Desktop Services Administration</h1>
<p>The Remote Desktop Services API enables you to enumerate and manage Remote Desktop Session Host (RDÂ Session Host) servers, client sessions, and processes.</p>
<p>To retrieve the names of all the RDÂ Session Host servers in a domain, call the <a href="/windows/desktop/api/lmserver/nf-lmserver-netserverenum"><strong>NetServerEnum</strong></a> function to enumerate servers of the SV_TYPE_TERMINALSERVER type. To open a handle to a specific RDÂ Session Host server, pass the server name in a call to the <a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsopenservera"><strong>WTSOpenServer</strong></a> function. When you have finished using the handle, release it by calling the <a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtscloseserver"><strong>WTSCloseServer</strong></a> function.</p>
<p>You can use the handle returned by <strong>WTSOpenServer</strong> to perform the following operations on the server.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Operation</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsdisconnectsession"><strong>WTSDisconnectSession</strong></a></td>
<td>Disconnects the client from a specified session. The session remains active and the user can log on again to connect to the same session.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsenumeratesessionsa"><strong>WTSEnumerateSessions</strong></a></td>
<td>Returns a list of sessions on the specified RDÂ Session Host server.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsenumerateprocessesa"><strong>WTSEnumerateProcesses</strong></a></td>
<td>Returns a list of processes on the specified RDÂ Session Host server.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtslogoffsession"><strong>WTSLogoffSession</strong></a></td>
<td>Logs off the specified session.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsquerysessioninformationa"><strong>WTSQuerySessionInformation</strong></a></td>
<td>Returns information about the specified session on the specified RDÂ Session Host server.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssendmessagea"><strong>WTSSendMessage</strong></a></td>
<td>Shows a message box on the client display of a specified session.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsshutdownsystem"><strong>WTSShutdownSystem</strong></a></td>
<td>Shuts down and optionally restarts a specified RDÂ Session Host server.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsterminateprocess"><strong>WTSTerminateProcess</strong></a></td>
<td>Terminates a specified process on a specified RDÂ Session Host server.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelopen"><strong>WTSVirtualChannelOpen</strong></a></td>
<td>Opens a handle to the server end of a specified virtual channel. For more information about virtual channels, see <a href="using-terminal-services-virtual-channels.html">Using Remote Desktop Services Virtual Channels</a>.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtswaitsystemevent"><strong>WTSWaitSystemEvent</strong></a></td>
<td>Waits for an event, such as the creation of a client session or a user logging on to the RDÂ Session Host server.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Several of these functions allocate buffers to return information to the caller. When you have finished using the buffer, free it by calling the <a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsfreememory"><strong>WTSFreeMemory</strong></a> function.</p>
<p>Â </p>
<p>Â </p>
</body>
