<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Registering the Protocol Manager</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Registering the Protocol Manager
description: You must create at least one registry value entry for your protocol manager so that the Remote Desktop Services service can instantiate it.
ms.assetid: 4cc7197b-88f3-4906-9b59-66587f970e2a
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Registering the Protocol Manager</h1>
<p>You must create at least one registry value entry for your protocol manager so that the Remote Desktop Services service can instantiate it.</p>
<h2>Registry Location</h2>
<p>Create a registry key in the following location for each listener (<a href="/windows/desktop/api/wtsprotocol/nn-wtsprotocol-iwrdsprotocollistener"><strong>IWRdsProtocolListener</strong></a>) that your protocol uses. In this example, the new listener keys are called <em>MyListener1</em> and <em>MyListener2</em>.</p>
<pre><code>HKEY_LOCAL_MACHINE
Â Â Â System
Â Â Â Â Â Â CurrentControlSet
Â Â Â Â Â Â Â Â Â Control
Â Â Â Â Â Â Â Â Â Â Â Â Terminal Server
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â WinStations
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â RDP-Tcp
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MyListener1
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MyListener2
</code></pre>
<p>For reference, you can view the value entries under the default <strong>RDP-Tcp</strong> listener key in this location.</p>
<h2>Registry Value Entries</h2>
<p>The listener key for the protocol must have a value entry called <strong>LoadableProtocol_Object</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></p>
<p>Data type</p>
<!-- raw HTML omitted -->
<p>If your protocol provider uses more than one listener, the Remote Desktop Services service only creates one instance of the protocol manager, and uses it to call <a href="/windows/desktop/api/wtsprotocol/nf-wtsprotocol-iwrdsprotocolmanager-createlistener"><strong>CreateListener</strong></a> once for each listener.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="creating-a-custom-remote-protocol.html">Creating a Remote Desktop Protocol Provider</a></p>
<!-- raw HTML omitted -->
<p><a href="method-call-sequence.html">Method Call Sequence</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
