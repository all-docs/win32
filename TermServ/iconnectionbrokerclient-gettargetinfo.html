<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IConnectionBrokerClient::GetTargetInfo method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IConnectionBrokerClient GetTargetInfo method (Cbclient.h)
description: Requests information about the target computer where the connection should be redirected.
ms.assetid: 43970B06-8CBD-4204-94AE-090A63918A90
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>GetTargetInfo method Remote Desktop Services</li>
<li>GetTargetInfo method Remote Desktop Services , IConnectionBrokerClient interface</li>
<li>IConnectionBrokerClient interface Remote Desktop Services , GetTargetInfo method
topic_type:</li>
<li>apiref
api_name:</li>
<li>IConnectionBrokerClient.GetTargetInfo
api_location:</li>
<li>Cbclient.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>IConnectionBrokerClient::GetTargetInfo method</h1>
<p>Requests information about the target computer where the connection should be redirected. This method is used by the redirector to get redirection information for the incoming connection request.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT GetTargetInfo(
  [in]  CB_CONNECTION_INFO       *pConnectionInfo,
  [in]  DWORD                    Reserved,
  [in]  HANDLE                   hStatusEvent,
  [out] CB_TARGET_INFO           *pTargetInfo,
  [out] DWORD                    *pResult,
  [out] IConnectionBrokerRequest **ppCbReq
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>pConnectionInfo</em> [in]</p>
<!-- raw HTML omitted -->
<p>The address of a <a href="cb-connection-info.html"><strong>CB_CONNECTION_INFO</strong></a> structure that contains information about the incoming connection request.</p>
<!-- raw HTML omitted -->
<p><em>Reserved</em> [in]</p>
<!-- raw HTML omitted -->
<p>This parameter is reserved for future use and must be zero.</p>
<!-- raw HTML omitted -->
<p><em>hStatusEvent</em> [in]</p>
<!-- raw HTML omitted -->
<p>The handle of an event that will get set whenever there is an update to the progress of the request. You are responsible for creating and closing this event.</p>
<!-- raw HTML omitted -->
<p><em>pTargetInfo</em> [out]</p>
<!-- raw HTML omitted -->
<p>The address of a <a href="cb-target-info.html"><strong>CB_TARGET_INFO</strong></a> structure that receives information about the target computer where the incoming connection should be redirected. Because this is an asynchronous method, this memory must remain available until the request is complete. For more information, see Remarks.</p>
<!-- raw HTML omitted -->
<p><em>pResult</em> [out]</p>
<!-- raw HTML omitted -->
<p>The address of a <strong>DWORD</strong> variable that receives a result code. Because this is an asynchronous method, this memory must remain available until the request is complete. For more information, see Remarks.</p>
<p>This result code will be one of the following values.</p>
<!-- raw HTML omitted -->
<p>0</p>
<!-- raw HTML omitted -->
<p>Success.</p>
<!-- raw HTML omitted -->
<p>0x0000400</p>
<!-- raw HTML omitted -->
<p>The destination computer could not be found.</p>
<!-- raw HTML omitted -->
<p>0x0000401</p>
<!-- raw HTML omitted -->
<p>The destination computer is not available.</p>
<!-- raw HTML omitted -->
<p>0x0000402</p>
<!-- raw HTML omitted -->
<p>Error loading destination computer.</p>
<!-- raw HTML omitted -->
<p>0x0000403</p>
<!-- raw HTML omitted -->
<p>Error bringing destination computer online.</p>
<!-- raw HTML omitted -->
<p>0x0000404</p>
<!-- raw HTML omitted -->
<p>Error redirecting to destination computer.</p>
<!-- raw HTML omitted -->
<p>0x0000405</p>
<!-- raw HTML omitted -->
<p>Error waking virtual machine.</p>
<!-- raw HTML omitted -->
<p>0x0000406</p>
<!-- raw HTML omitted -->
<p>Error booting virtual machine.</p>
<!-- raw HTML omitted -->
<p>0x0000407</p>
<!-- raw HTML omitted -->
<p>Error finding the IP address of the virtual machine.</p>
<!-- raw HTML omitted -->
<p>0x0000408</p>
<!-- raw HTML omitted -->
<p>The session broker could not find any available computers in the pool.</p>
<!-- raw HTML omitted -->
<p>0x0000409</p>
<!-- raw HTML omitted -->
<p>The session broker canceled the connection.</p>
<!-- raw HTML omitted -->
<p>0x0000410</p>
<!-- raw HTML omitted -->
<p>The session broker could not validate the connection settings.</p>
<!-- raw HTML omitted -->
<p><em>ppCbReq</em> [out]</p>
<!-- raw HTML omitted -->
<p>The address of an <a href="iconnectionbrokerrequest.html"><strong>IConnectionBrokerRequest</strong></a> interface pointer that you use to obtain status updates for an asynchronous operation. This interface is used in conjunction with the <em>hStatusEvent</em> parameter to wait for and get the results of this asynchronous operation.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns <strong>E_PENDING</strong> if the asynchronous request is created. Otherwise, it returns an <strong>HRESULT</strong> error code.</p>
<h2>Remarks</h2>
<p>This method is asynchronous. The <em>pTargetInfo</em> and <em>pResult</em> parameters must remain valid until the <a href="iconnectionbrokerrequest-checkstatus.html"><strong>IConnectionBrokerRequest::CheckStatus</strong></a> method obtains <strong>CB_STATUS_REQUEST_COMPLETED</strong>.</p>
<p>For more information about how to use this method, see <a href="use-the-remote-desktop-connection-broker-client-api.html">How to use the Remote Desktop Connection Broker client API</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 8<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Cbclient.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Cbclient.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Cbclient.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="iconnectionbrokerclient.html"><strong>IConnectionBrokerClient</strong></a></p>
<!-- raw HTML omitted -->
</body>
