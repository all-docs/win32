<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Win32_TSVirtualIP class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Win32_TSVirtualIP class
description: Defines Internet protocol (IP) virtualization settings for a Remote Desktop Session Host (RD Session Host) server.
ms.assetid: c37d572c-f6db-438b-8290-006a623c6593
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>Win32_TSVirtualIP class Remote Desktop Services</li>
<li>Win32_TSVirtualIP class Remote Desktop Services , described
topic_type:</li>
<li>apiref
api_name:</li>
<li>Win32_TSVirtualIP</li>
<li>Win32_TSVirtualIP.Caption</li>
<li>Win32_TSVirtualIP.Description</li>
<li>Win32_TSVirtualIP.InstallDate</li>
<li>Win32_TSVirtualIP.Name</li>
<li>Win32_TSVirtualIP.Status</li>
<li>Win32_TSVirtualIP.VirtualIPActive</li>
<li>Win32_TSVirtualIP.PolicySourceVirtualIPActive</li>
<li>Win32_TSVirtualIP.VirtualIPMode</li>
<li>Win32_TSVirtualIP.PolicySourceVirtualIPMode</li>
<li>Win32_TSVirtualIP.ProgramList</li>
<li>Win32_TSVirtualIP.PolicySourceProgramList</li>
<li>Win32_TSVirtualIP.NetworkAdapterDescription</li>
<li>Win32_TSVirtualIP.NetworkAdapterMacAddress</li>
<li>Win32_TSVirtualIP.PolicySourceNetworkAdapter</li>
<li>Win32_TSVirtualIP.NetworkAdapterDescriptionList</li>
<li>Win32_TSVirtualIP.NetworkAdapterMacList</li>
<li>Win32_TSVirtualIP.VirtualizeLoopbackAddressesEnabled
api_location:</li>
<li>TSCfgWmi.dll
api_type:</li>
<li>DllExport
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Win32_TSVirtualIP class</h1>
<p>Defines Internet protocol (IP) virtualization settings for a Remote Desktop Session Host (RD Session Host) server.</p>
<p>The following syntax is simplified from Managed Object Format (MOF) code and includes all of the inherited properties.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[dynamic, provider(&quot;Win32_WIN32_TSVIRTUALIP_Prov&quot;), ClassContext(&quot;local|hkey_local_machine\\SYSTEM\\CurrentControlSet\\Control\\TerminalServer\\TSAppSrv\\VirtualIP&quot;), AMENDMENT]
class Win32_TSVirtualIP : CIM_Setting
{
  string   Caption;
  string   Description;
  datetime InstallDate;
  string   Name;
  string   Status;
  uint32   VirtualIPActive;
  uint32   PolicySourceVirtualIPActive;
  uint32   VirtualIPMode;
  uint32   PolicySourceVirtualIPMode;
  string   ProgramList[];
  uint32   PolicySourceProgramList;
  string   NetworkAdapterDescription;
  string   NetworkAdapterMacAddress;
  uint32   PolicySourceNetworkAdapter;
  string   NetworkAdapterDescriptionList[];
  string   NetworkAdapterMacList[];
  uint32   VirtualizeLoopbackAddressesEnabled;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>Win32_TSVirtualIP</strong> class has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>Win32_TSVirtualIP</strong> class has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="addprogram-win32-tsvirtualip.html"><strong>AddProgram</strong></a></td>
<td align="left">Adds a program to the list of programs that use IP virtualization.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="removeprogram-win32-tsvirtualip.html"><strong>RemoveProgram</strong></a></td>
<td align="left">Removes a program from the list of programs that use IP virtualization.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="selectnetworkadapter-win32-tsvirtualip.html"><strong>SelectNetworkAdapter</strong></a></td>
<td align="left">Sets the MAC address of the network adapter to use for IP virtualization.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="setprogramlist-win32-tsvirtualip.html"><strong>SetProgramList</strong></a></td>
<td align="left">Overwrites the list of programs that use IP virtualization.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="setvirtualipactive-win32-tsvirtualip.html"><strong>SetVirtualIPActive</strong></a></td>
<td align="left">Sets the <strong>VirtualIPActive</strong> property value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="setvirtualipmode-win32-tsvirtualip.html"><strong>SetVirtualIPMode</strong></a></td>
<td align="left">Sets the <strong>VirtualIPMode</strong> property value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="setvirtualizeloopbackaddressesenabled-win32-tsvirtualip.html"><strong>SetVirtualizeLoopbackAddressesEnabled</strong></a></td>
<td align="left">Sets the <strong>VirtualizeLoopbackAddressesEnabled</strong> property value.<!-- raw HTML omitted --> <strong>Windows Server 2008 R2:</strong> This method is not available prior to Windows Server 2012.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<p>The <strong>Win32_TSVirtualIP</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>Caption</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="/windows/desktop/WmiSdk/standard-qualifiers"><strong>MaxLen</strong></a> (64)</p>
<!-- raw HTML omitted -->
<p>Short description (one-line string) of the object.</p>
<p>This property is inherited from <a href="cim-managedsystemelement.html"><strong>CIM_ManagedSystemElement</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>Description</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Description of the object.</p>
<p>This property is inherited from <a href="cim-managedsystemelement.html"><strong>CIM_ManagedSystemElement</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>InstallDate</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>datetime</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="/windows/desktop/WmiSdk/standard-qualifiers"><strong>Mappingstrings</strong></a> (&quot;MIF.DMTF|ComponentID|001.5&quot;)</p>
<!-- raw HTML omitted -->
<p>The date the object was installed. A lack of a value does not indicate that the object is not installed.</p>
<p>This property is inherited from <a href="cim-managedsystemelement.html"><strong>CIM_ManagedSystemElement</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>Name</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>The name of the object.</p>
<p>This property is inherited from <a href="cim-managedsystemelement.html"><strong>CIM_ManagedSystemElement</strong></a>.</p>
<!-- raw HTML omitted -->
<p><strong>NetworkAdapterDescription</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>The description for the network adapter.</p>
<!-- raw HTML omitted -->
<p><strong>NetworkAdapterDescriptionList</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong> array</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>The list of descriptions of the available physical network adapters.</p>
<!-- raw HTML omitted -->
<p><strong>NetworkAdapterMacAddress</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>The MAC address of the network adapter.</p>
<!-- raw HTML omitted -->
<p><strong>NetworkAdapterMacList</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong> array</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>The list of MAC addresses of the available physical network adapters.</p>
<!-- raw HTML omitted -->
<p><strong>PolicySourceNetworkAdapter</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Indicates whether the network adapter is configured by the server or by group policy.</p>
<!-- raw HTML omitted -->
<p>0 (0x0)</p>
<!-- raw HTML omitted -->
<p>Server</p>
<!-- raw HTML omitted -->
<p>1 (0x1)</p>
<!-- raw HTML omitted -->
<p>Group policy</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>PolicySourceProgramList</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Indicates whether the <strong>ProgramList</strong> property is configured by the server or by group policy.</p>
<!-- raw HTML omitted -->
<p>0 (0x0)</p>
<!-- raw HTML omitted -->
<p>Server</p>
<!-- raw HTML omitted -->
<p>1 (0x1)</p>
<!-- raw HTML omitted -->
<p>Group policy</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>PolicySourceVirtualIPActive</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Indicates if the <strong>VirtualIPActive</strong> property is configured by the server or by group policy.</p>
<!-- raw HTML omitted -->
<p>0 (0x0)</p>
<!-- raw HTML omitted -->
<p>Server</p>
<!-- raw HTML omitted -->
<p>1 (0x1)</p>
<!-- raw HTML omitted -->
<p>Group policy</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>PolicySourceVirtualIPMode</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Indicates if the <strong>VirtualIPMode</strong> property is configured by the server or by group policy.</p>
<!-- raw HTML omitted -->
<p>0 (0x0)</p>
<!-- raw HTML omitted -->
<p>Server</p>
<!-- raw HTML omitted -->
<p>1 (0x1)</p>
<!-- raw HTML omitted -->
<p>Group policy</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>ProgramList</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong> array</p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Specifies the programs that are configured to use IP virtualization. This may a program name or the full path.</p>
<!-- raw HTML omitted -->
<p><strong>Status</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="/windows/desktop/WmiSdk/standard-qualifiers"><strong>MaxLen</strong></a> (10)</p>
<!-- raw HTML omitted -->
<p>Current status of the object. Various operational and nonoperational statuses can be defined. Operational statuses include: &quot;OK&quot;, &quot;Degraded&quot;, and &quot;Pred Fail&quot; (an element, such as a SMART-enabled hard disk drive, may be functioning properly but predicting a failure in the near future). Nonoperational statuses include: &quot;Error&quot;, &quot;Starting&quot;, &quot;Stopping&quot;, and &quot;Service&quot;. The latter, &quot;Service&quot;, could apply during mirror-resilvering of a disk, reload of a user permissions list, or other administrative work. Not all such work is on-line, yet the managed element is neither &quot;OK&quot; nor in one of the other states.</p>
<p>This property is inherited from <a href="cim-managedsystemelement.html"><strong>CIM_ManagedSystemElement</strong></a>.</p>
<!-- raw HTML omitted -->
<p>(&quot;OK&quot;)</p>
<!-- raw HTML omitted -->
<p>(&quot;Error&quot;)</p>
<!-- raw HTML omitted -->
<p>(&quot;Degraded&quot;)</p>
<!-- raw HTML omitted -->
<p>(&quot;Unknown&quot;)</p>
<!-- raw HTML omitted -->
<p>(&quot;Pred Fail&quot;)</p>
<!-- raw HTML omitted -->
<p>(&quot;Starting&quot;)</p>
<!-- raw HTML omitted -->
<p>(&quot;Stopping&quot;)</p>
<!-- raw HTML omitted -->
<p>(&quot;Service&quot;)</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>VirtualIPActive</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="/windows/desktop/WmiSdk/key-qualifier"><strong>key</strong></a></p>
<!-- raw HTML omitted -->
<p>Specifies if IP virtualization is active on the server. This can be one of the following values.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FALSE</strong> (0)</p>
<!-- raw HTML omitted -->
<p>IP virtualization is not active.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>TRUE</strong> (1)</p>
<!-- raw HTML omitted -->
<p>IP virtualization is active.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>VirtualIPMode</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Specifies which IP virtualization mode is being used on the server. This can be one of the following values.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Per-Session</strong> (0)</p>
<!-- raw HTML omitted -->
<p>The IP virtualization mode is per-session.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>Per-Program</strong> (1)</p>
<!-- raw HTML omitted -->
<p>The IP virtualization mode is per-user.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>VirtualizeLoopbackAddressesEnabled</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Specifies whether loopback address virtualization is enabled.</p>
<p><strong>Windows Server 2008 R2:</strong> This property is not available prior to Windows Server 2012.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FALSE</strong> (0)</p>
<!-- raw HTML omitted -->
<p>Not enabled</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>TRUE</strong> (1)</p>
<!-- raw HTML omitted -->
<p>Enabled</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Microsoft Windows Software Development Kit (SDK). They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="/windows/desktop/WmiSdk/managed-object-format--mof-">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008 R2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMv2\TerminalServices<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->TSCfgWmi.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->TSCfgWmi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
