<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Remote Desktop Services API Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Remote Desktop Services API Functions
description: The following functions are used with Remote Desktop Services.
ms.assetid: e99a86ee-af0e-46db-8dad-69703ca84fa0
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Remote Desktop Services API Functions</h1>
<p>The following functions are used with Remote Desktop Services.</p>
<h2>In this section</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/processthreadsapi/nf-processthreadsapi-processidtosessionid"><strong>ProcessIdToSessionId</strong></a></p>
<!-- raw HTML omitted -->
<p>Retrieves the Remote Desktop Services session associated with a specified process.</p>
<!-- raw HTML omitted -->
<p><a href="tlsconnecttolsserver.html"><strong>TLSConnectToLsServer</strong></a></p>
<!-- raw HTML omitted -->
<p>Opens a handle to the specified Remote Desktop license server.</p>
<!-- raw HTML omitted -->
<p><a href="tlsdisconnectfromserver.html"><strong>TLSDisconnectFromServer</strong></a></p>
<!-- raw HTML omitted -->
<p>Closes an open handle to a Remote Desktop license server.</p>
<!-- raw HTML omitted -->
<p><a href="tlsgetservercertificate.html"><strong>TLSGetServerCertificate</strong></a></p>
<!-- raw HTML omitted -->
<p>Returns the certificate of the Remote Desktop license server.</p>
<!-- raw HTML omitted -->
<p><a href="tlskeypackenumbegin.html"><strong>TLSKeyPackEnumBegin</strong></a></p>
<!-- raw HTML omitted -->
<p>Begins enumeration through all key packs that are installed on a Remote Desktop license server based on search criteria.</p>
<!-- raw HTML omitted -->
<p><a href="tlskeypackenumend.html"><strong>TLSKeyPackEnumEnd</strong></a></p>
<!-- raw HTML omitted -->
<p>Continues from a previous call to the <a href="tlskeypackenumbegin.html"><strong>TLSKeyPackEnumBegin</strong></a> function and terminates the enumeration.</p>
<!-- raw HTML omitted -->
<p><a href="tlskeypackenumnext.html"><strong>TLSKeyPackEnumNext</strong></a></p>
<!-- raw HTML omitted -->
<p>Continues from a previous call to the <a href="tlskeypackenumbegin.html"><strong>TLSKeyPackEnumBegin</strong></a> function and returns the next key pack that is installed on a Remote Desktop license server that matches the search criteria.</p>
<!-- raw HTML omitted -->
<p><a href="tlslicenseenumbegin.html"><strong>TLSLicenseEnumBegin</strong></a></p>
<!-- raw HTML omitted -->
<p>Begins enumeration of licenses that are issued by the Remote Desktop license server based on search criteria.</p>
<!-- raw HTML omitted -->
<p><a href="tlslicenseenumend.html"><strong>TLSLicenseEnumEnd</strong></a></p>
<!-- raw HTML omitted -->
<p>Continues from a previous call to the <a href="tlslicenseenumbegin.html"><strong>TLSLicenseEnumBegin</strong></a> function and terminates the enumeration.</p>
<!-- raw HTML omitted -->
<p><a href="tlslicenseenumnext.html"><strong>TLSLicenseEnumNext</strong></a></p>
<!-- raw HTML omitted -->
<p>Continues from a previous call to the <a href="tlslicenseenumbegin.html"><strong>TLSLicenseEnumBegin</strong></a> function and returns the next license that is installed on a Remote Desktop license server that matches the search criteria.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelclose"><strong>VirtualChannelClose</strong></a></p>
<!-- raw HTML omitted -->
<p>Closes the client end of a virtual channel.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelentry"><strong>VirtualChannelEntry</strong></a></p>
<!-- raw HTML omitted -->
<p>An application-defined entry point for the client-side DLL of an application that uses Remote Desktop Services virtual channels.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelinit"><strong>VirtualChannelInit</strong></a></p>
<!-- raw HTML omitted -->
<p>Initializes a client DLL's access to Remote Desktop Services virtual channels.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Cchannel/nc-cchannel-channel_init_event_fn"><em>VirtualChannelInitEvent</em></a></p>
<!-- raw HTML omitted -->
<p>An application-defined callback function that Remote Desktop Services calls to notify the client DLL of virtual channel events.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelopen"><strong>VirtualChannelOpen</strong></a></p>
<!-- raw HTML omitted -->
<p>Opens the client end of a virtual channel.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn"><em>VirtualChannelOpenEvent</em></a></p>
<!-- raw HTML omitted -->
<p>An application-defined callback function that Remote Desktop Services calls to notify the client DLL of events for a specific virtual channel.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelwrite"><strong>VirtualChannelWrite</strong></a></p>
<!-- raw HTML omitted -->
<p>Sends data from the client end of a virtual channel to a partner application on the server end.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtscloseserver"><strong>WTSCloseServer</strong></a></p>
<!-- raw HTML omitted -->
<p>Closes an open handle to a Remote Desktop Session Host (RDÂ Session Host) server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsconnectsessiona"><strong>WTSConnectSession</strong></a></p>
<!-- raw HTML omitted -->
<p>Connects a Remote Desktop Services session to an existing session on the local computer.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtscreatelistenera"><strong>WTSCreateListener</strong></a></p>
<!-- raw HTML omitted -->
<p>Creates a new Remote Desktop Services listener or configures an existing listener.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsdisconnectsession"><strong>WTSDisconnectSession</strong></a></p>
<!-- raw HTML omitted -->
<p>Disconnects the logged-on user from the specified Remote Desktop Services session without closing the session.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsenablechildsessions"><strong>WTSEnableChildSessions</strong></a></p>
<!-- raw HTML omitted -->
<p>Enables or disables <a href="child-sessions.html">Child Sessions</a>.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsenumeratelistenersa"><strong>WTSEnumerateListeners</strong></a></p>
<!-- raw HTML omitted -->
<p>Enumerates all the Remote Desktop Services listeners on a RDÂ Session Host server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsenumerateprocessesa"><strong>WTSEnumerateProcesses</strong></a></p>
<!-- raw HTML omitted -->
<p>Retrieves information about the active processes on a specified RDÂ Session Host server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsenumerateprocessesexa"><strong>WTSEnumerateProcessesEx</strong></a></p>
<!-- raw HTML omitted -->
<p>Retrieves information about the active processes on the specified RDÂ Session Host server or Remote Desktop Virtualization Host (RDÂ Virtualization Host) server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsenumerateserversa"><strong>WTSEnumerateServers</strong></a></p>
<!-- raw HTML omitted -->
<p>Returns a list of all RDÂ Session Host servers within the specified domain.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsenumeratesessionsa"><strong>WTSEnumerateSessions</strong></a></p>
<!-- raw HTML omitted -->
<p>Retrieves a list of sessions on a RDÂ Session Host server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsenumeratesessionsexa"><strong>WTSEnumerateSessionsEx</strong></a></p>
<!-- raw HTML omitted -->
<p>Retrieves a list of sessions on a specified RDÂ Session Host server or RDÂ Virtualization Host server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsfreememory"><strong>WTSFreeMemory</strong></a></p>
<!-- raw HTML omitted -->
<p>Frees memory allocated by a Remote Desktop Services function.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsfreememoryexa"><strong>WTSFreeMemoryEx</strong></a></p>
<!-- raw HTML omitted -->
<p>Frees memory that contains <a href="/windows/desktop/api/Wtsapi32/ns-wtsapi32-wts_process_info_exa"><strong>WTS_PROCESS_INFO_EX</strong></a> or <a href="/windows/desktop/api/Wtsapi32/ns-wtsapi32-wts_session_info_1a"><strong>WTS_SESSION_INFO_1</strong></a> structures allocated by a Remote Desktop Services function.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Winbase/nf-winbase-wtsgetactiveconsolesessionid"><strong>WTSGetActiveConsoleSessionId</strong></a></p>
<!-- raw HTML omitted -->
<p>Retrieves the session identifier of the console session.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsgetchildsessionid"><strong>WTSGetChildSessionId</strong></a></p>
<!-- raw HTML omitted -->
<p>Retrieves the child session identifier, if present.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsgetlistenersecuritya"><strong>WTSGetListenerSecurity</strong></a></p>
<!-- raw HTML omitted -->
<p>Retrieves the security descriptor of a Remote Desktop Services listener.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsischildsessionsenabled"><strong>WTSIsChildSessionsEnabled</strong></a></p>
<!-- raw HTML omitted -->
<p>Determines whether child sessions are enabled.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtslogoffsession"><strong>WTSLogoffSession</strong></a></p>
<!-- raw HTML omitted -->
<p>Logs off a specified Remote Desktop Services session.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsopenservera"><strong>WTSOpenServer</strong></a></p>
<!-- raw HTML omitted -->
<p>Opens a handle to the specified RDÂ Session Host server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsopenserverexa"><strong>WTSOpenServerEx</strong></a></p>
<!-- raw HTML omitted -->
<p>Opens a handle to the specified RDÂ Session Host server or RDÂ Virtualization Host server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsquerylistenerconfiga"><strong>WTSQueryListenerConfig</strong></a></p>
<!-- raw HTML omitted -->
<p>Retrieves configuration information for a Remote Desktop Services listener.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsquerysessioninformationa"><strong>WTSQuerySessionInformation</strong></a></p>
<!-- raw HTML omitted -->
<p>Retrieves session information for the specified session on the specified RDÂ Session Host server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsqueryuserconfiga"><strong>WTSQueryUserConfig</strong></a></p>
<!-- raw HTML omitted -->
<p>Retrieves configuration information for the specified user on the specified domain controller or RDÂ Session Host server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsqueryusertoken"><strong>WTSQueryUserToken</strong></a></p>
<!-- raw HTML omitted -->
<p>Obtains the primary access token of the logged-on user specified by the session ID.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsregistersessionnotification"><strong>WTSRegisterSessionNotification</strong></a></p>
<!-- raw HTML omitted -->
<p>Registers the specified window to receive session change notifications.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsregistersessionnotificationex"><strong>WTSRegisterSessionNotificationEx</strong></a></p>
<!-- raw HTML omitted -->
<p>Registers the specified window to receive session change notifications.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssendmessagea"><strong>WTSSendMessage</strong></a></p>
<!-- raw HTML omitted -->
<p>Displays a message box on the client desktop of a specified Remote Desktop Services session.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssetlistenersecuritya"><strong>WTSSetListenerSecurity</strong></a></p>
<!-- raw HTML omitted -->
<p>Configures the security descriptor of a Remote Desktop Services listener.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssetuserconfiga"><strong>WTSSetUserConfig</strong></a></p>
<!-- raw HTML omitted -->
<p>Modifies configuration information for the specified user on the specified domain controller or RDÂ Session Host server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsshutdownsystem"><strong>WTSShutdownSystem</strong></a></p>
<!-- raw HTML omitted -->
<p>Shuts down (and optionally restarts) the specified RDÂ Session Host server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsstartremotecontrolsessiona"><strong>WTSStartRemoteControlSession</strong></a></p>
<!-- raw HTML omitted -->
<p>Starts the remote control of another Remote Desktop Services session. You must call this function from a remote session.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsstopremotecontrolsession"><strong>WTSStopRemoteControlSession</strong></a></p>
<!-- raw HTML omitted -->
<p>Stops a remote control session.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsterminateprocess"><strong>WTSTerminateProcess</strong></a></p>
<!-- raw HTML omitted -->
<p>Terminates the specified process on the specified RDÂ Session Host server.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsunregistersessionnotification"><strong>WTSUnRegisterSessionNotification</strong></a></p>
<!-- raw HTML omitted -->
<p>Unregisters the specified window so that it receives no further session change notifications.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsunregistersessionnotificationex"><strong>WTSUnRegisterSessionNotificationEx</strong></a></p>
<!-- raw HTML omitted -->
<p>Unregisters the specified window so that it receives no further session change notifications.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelclose"><strong>WTSVirtualChannelClose</strong></a></p>
<!-- raw HTML omitted -->
<p>Closes an open virtual channel handle.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelopen"><strong>WTSVirtualChannelOpen</strong></a></p>
<!-- raw HTML omitted -->
<p>Opens a handle to the server end of a specified virtual channel.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelopenex"><strong>WTSVirtualChannelOpenEx</strong></a></p>
<!-- raw HTML omitted -->
<p>Creates a virtual channel in a manner similar to <a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelopen"><strong>WTSVirtualChannelOpen</strong></a>.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelpurgeinput"><strong>WTSVirtualChannelPurgeInput</strong></a></p>
<!-- raw HTML omitted -->
<p>Deletes all queued input data sent from the client to the server on a specified virtual channel.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelpurgeoutput"><strong>WTSVirtualChannelPurgeOutput</strong></a></p>
<!-- raw HTML omitted -->
<p>Deletes all queued output data sent from the server to the client on a specified virtual channel.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelquery"><strong>WTSVirtualChannelQuery</strong></a></p>
<!-- raw HTML omitted -->
<p>Returns information about a specified virtual channel.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelread"><strong>WTSVirtualChannelRead</strong></a></p>
<!-- raw HTML omitted -->
<p>Reads data from the server end of a virtual channel.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelwrite"><strong>WTSVirtualChannelWrite</strong></a></p>
<!-- raw HTML omitted -->
<p>Writes data to the server end of a virtual channel.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtswaitsystemevent"><strong>WTSWaitSystemEvent</strong></a></p>
<!-- raw HTML omitted -->
<p>Waits for a Remote Desktop Services event before returning to the caller.</p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
