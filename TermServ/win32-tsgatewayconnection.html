<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Win32_TSGatewayConnection class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Win32_TSGatewayConnection class
description: Represents a connection from a client computer to a Remote Desktop Gateway (RD Gateway) server.
ms.assetid: 6e76ae25-409d-436a-8eef-8f047194c29c
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>Win32_TSGatewayConnection class Remote Desktop Services</li>
<li>Win32_TSGatewayConnection class Remote Desktop Services , described
topic_type:</li>
<li>apiref
api_name:</li>
<li>Win32_TSGatewayConnection</li>
<li>Win32_TSGatewayConnection.ConnectionKey</li>
<li>Win32_TSGatewayConnection.TunnelId</li>
<li>Win32_TSGatewayConnection.ChannelId</li>
<li>Win32_TSGatewayConnection.UserName</li>
<li>Win32_TSGatewayConnection.FullUserName</li>
<li>Win32_TSGatewayConnection.ClientAddress</li>
<li>Win32_TSGatewayConnection.ConnectedTime</li>
<li>Win32_TSGatewayConnection.IdleTime</li>
<li>Win32_TSGatewayConnection.ConnectedResource</li>
<li>Win32_TSGatewayConnection.ProtocolName</li>
<li>Win32_TSGatewayConnection.ConnectedPort</li>
<li>Win32_TSGatewayConnection.NumberOfKilobytesSent</li>
<li>Win32_TSGatewayConnection.NumberOfKilobytesReceived</li>
<li>Win32_TSGatewayConnection.ConnectionDuration</li>
<li>Win32_TSGatewayConnection.TransportProtocol
api_location:</li>
<li>AagWmi.dll
api_type:</li>
<li>DllExport
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Win32_TSGatewayConnection class</h1>
<p>Represents a connection from a client computer to a Remote Desktop Gateway (RD Gateway) server.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[dynamic, provider(&quot;AAGProvider&quot;), AMENDMENT]
class Win32_TSGatewayConnection
{
  string ConnectionKey;
  uint64 TunnelId;
  uint32 ChannelId;
  string UserName;
  string FullUserName;
  string ClientAddress;
  string ConnectedTime;
  string IdleTime;
  string ConnectedResource;
  string ProtocolName;
  uint32 ConnectedPort;
  uint64 NumberOfKilobytesSent;
  uint64 NumberOfKilobytesReceived;
  string ConnectionDuration;
  uint32 TransportProtocol;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>Win32_TSGatewayConnection</strong> class has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>Win32_TSGatewayConnection</strong> class has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="checkstatus-win32-tsgatewayconnection.html"><strong>CheckStatus</strong></a></td>
<td align="left">Checks the status of an RD Gateway server connection, and whether the target server is configured for load balancing.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="disconnect-win32-tsgatewayconnection.html"><strong>Disconnect</strong></a></td>
<td align="left">Ends the connection.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="disconnectprotocol-win32-tsgatewayconnection.html"><strong>DisconnectProtocol</strong></a></td>
<td align="left">Ends all connections that use the specified protocol.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="disconnectuser-win32-tsgatewayconnection.html"><strong>DisconnectUser</strong></a></td>
<td align="left">Ends all connections of the specified user.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<p>The <strong>Win32_TSGatewayConnection</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>ChannelId</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Channel identifier.</p>
<!-- raw HTML omitted -->
<p><strong>ClientAddress</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Client IP address.</p>
<!-- raw HTML omitted -->
<p><strong>ConnectedPort</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Port on the connected resource to which the user is connected.</p>
<!-- raw HTML omitted -->
<p><strong>ConnectedResource</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Name of the computer (or cluster) to which the client is connected.</p>
<!-- raw HTML omitted -->
<p><strong>ConnectedTime</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>The time stamp for when the connection was established. This time is reset when the connection is reset, even if it is automatically reconnected.</p>
<!-- raw HTML omitted -->
<p><strong>ConnectionDuration</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>The time that has elapsed since the connected time.</p>
<!-- raw HTML omitted -->
<p><strong>ConnectionKey</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="/windows/desktop/WmiSdk/key-qualifier"><strong>key</strong></a></p>
<!-- raw HTML omitted -->
<p>Connection identifier in the format &quot;tunnelId:channelID&quot;.</p>
<!-- raw HTML omitted -->
<p><strong>FullUserName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Full user name of the connected user.</p>
<!-- raw HTML omitted -->
<p><strong>IdleTime</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Idle time of the connection.</p>
<!-- raw HTML omitted -->
<p><strong>NumberOfKilobytesReceived</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint64</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Number of kilobytes received from the client computer by the RD Gateway server.</p>
<!-- raw HTML omitted -->
<p><strong>NumberOfKilobytesSent</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint64</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Number of kilobytes sent to the client computer by the RD Gateway server.</p>
<!-- raw HTML omitted -->
<p><strong>ProtocolName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Protocol that is used to connect to the RD Gateway server.</p>
<!-- raw HTML omitted -->
<p>&quot;RDP&quot;</p>
<!-- raw HTML omitted -->
<p>The protocol for the RD Gateway server.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>TransportProtocol</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Specifies the transport type for the connection. This must be one of the following values.</p>
<!-- raw HTML omitted -->
<p>0</p>
<!-- raw HTML omitted -->
<p>RPC over HTTP transport.</p>
<!-- raw HTML omitted -->
<p>1</p>
<!-- raw HTML omitted -->
<p>HTTP transport.</p>
<!-- raw HTML omitted -->
<p>2</p>
<!-- raw HTML omitted -->
<p>UDP transport.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>TunnelId</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint64</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Tunnel identifier.</p>
<!-- raw HTML omitted -->
<p><strong>UserName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>User name connected to the RD Gateway server.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>You must be a member of the Administrators group to use this class.</p>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Microsoft Windows Software Development Kit (SDK). They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="/windows/desktop/WmiSdk/managed-object-format--mof-">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMv2\TerminalServices<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->TSGateway.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->AagWmi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-tsgatewayconnectionauthorizationpolicy.html"><strong>Win32_TSGatewayConnectionAuthorizationPolicy</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="win32-tsgatewayloadbalancer.html"><strong>Win32_TSGatewayLoadBalancer</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="win32-tsgatewayradiusserver.html"><strong>Win32_TSGatewayRADIUSServer</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="win32-tsgatewayresourceauthorizationpolicy.html"><strong>Win32_TSGatewayResourceAuthorizationPolicy</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="win32-tsgatewayresourcegroup.html"><strong>Win32_TSGatewayResourceGroup</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="win32-tsgatewayserversettings.html"><strong>Win32_TSGatewayServerSettings</strong></a></p>
<!-- raw HTML omitted -->
</body>
