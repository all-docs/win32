<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ITsSbResourcePluginStoreEx interface</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: ITsSbResourcePluginStoreEx interface
description: Exposes methods that enable resource plug-ins to store objects such as sessions and targets.
ms.assetid: 768a5a4e-8221-417a-ad65-9a213a176eca
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>ITsSbResourcePluginStoreEx interface Remote Desktop Services</li>
<li>ITsSbResourcePluginStoreEx interface Remote Desktop Services , described
topic_type:</li>
<li>apiref
api_name:</li>
<li>ITsSbResourcePluginStoreEx
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018
api_location:</li>
</ul>
<hr />
<h1>ITsSbResourcePluginStoreEx interface</h1>
<p>Exposes methods that enable resource plug-ins to store objects such as sessions and targets. These methods add, delete, and query these objects.</p>
<p>This interface is only available on Windows Server 2012 R2 with <a href="https://support.microsoft.com/kb/3091411">KB3091411</a> installed. The <a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-acquiretargetlock"><strong>AcquireTargetLock</strong></a> and <a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-releasetargetlock"><strong>ReleaseTargetLock</strong></a> methods of the <a href="/windows/desktop/api/sbtsv/nn-sbtsv-itssbresourcepluginstore"><strong>ITsSbResourcePluginStore</strong></a> interface are available starting with Windows Server 2016.</p>
<h2>Members</h2>
<p>The <strong>ITsSbResourcePluginStoreEx</strong> interface inherits from <a href="/windows/desktop/api/sbtsv/nn-sbtsv-itssbresourcepluginstore"><strong>ITsSbResourcePluginStore</strong></a>. <strong>ITsSbResourcePluginStoreEx</strong> also has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>ITsSbResourcePluginStoreEx</strong> interface has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="itssbresourcepluginstoreex-acquiretargetlock.html"><strong>AcquireTargetLock</strong></a></td>
<td align="left">Locks a target.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-addenvironmenttostore"><strong>AddEnvironmentToStore</strong></a></td>
<td align="left">Adds an environment to the resource plug-in store.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-addsessiontostore"><strong>AddSessionToStore</strong></a></td>
<td align="left">Adds a new session to the resource plug-in store.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-addtargettostore"><strong>AddTargetToStore</strong></a></td>
<td align="left">Adds a target to the resource plug-in store.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-deletetarget"><strong>DeleteTarget</strong></a></td>
<td align="left">Deletes a target.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-enumerateenvironments"><strong>EnumerateEnvironments</strong></a></td>
<td align="left">Returns an array that contains the environments present in the resource plug-in store.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-enumeratefarms"><strong>EnumerateFarms</strong></a></td>
<td align="left">Enumerates all the farms that have been added to the resource plug-in store.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-enumeratesessions"><strong>EnumerateSessions</strong></a></td>
<td align="left">Enumerates a specified set of sessions.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-enumeratetargets"><strong>EnumerateTargets</strong></a></td>
<td align="left">Returns an array that contains the specified targets that are present in the resource plug-in store.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-getfarmproperty"><strong>GetFarmProperty</strong></a></td>
<td align="left">Retrieves a property of a farm.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-queryenvironment"><strong>QueryEnvironment</strong></a></td>
<td align="left">Returns the specified environment object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-querysessionbysessionid"><strong>QuerySessionBySessionId</strong></a></td>
<td align="left">Returns the session object that has the specified session ID.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-querytarget"><strong>QueryTarget</strong></a></td>
<td align="left">Returns the target that has the specified target name and farm name.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="itssbresourcepluginstoreex-releasetargetlock.html"><strong>ReleaseTargetLock</strong></a></td>
<td align="left">Releases a lock on a target.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-removeenvironmentfromstore"><strong>RemoveEnvironmentFromStore</strong></a></td>
<td align="left">Removes the specified environment from the resource plug-in store.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-saveenvironment"><strong>SaveEnvironment</strong></a></td>
<td align="left">Saves an environment.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-savesession"><strong>SaveSession</strong></a></td>
<td align="left">Saves a session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-savetarget"><strong>SaveTarget</strong></a></td>
<td align="left">Saves a target.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-setenvironmentproperty"><strong>SetEnvironmentProperty</strong></a></td>
<td align="left">Sets a property on an environment.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-setenvironmentpropertywithversioncheck"><strong>SetEnvironmentPropertyWithVersionCheck</strong></a></td>
<td align="left">Sets a property on an environment.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-setsessionstate"><strong>SetSessionState</strong></a></td>
<td align="left">Sets the state of a session.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-settargetproperty"><strong>SetTargetProperty</strong></a></td>
<td align="left">Sets a property on a target.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-settargetpropertywithversioncheck"><strong>SetTargetPropertyWithVersionCheck</strong></a></td>
<td align="left">Sets a property on a target.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-settargetstate"><strong>SetTargetState</strong></a></td>
<td align="left">Sets the state of a target.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 R2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of server support<!-- raw HTML omitted --></td>
<td>Windows Server 2012 R2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_ITsSbResourcePluginStoreEx is defined as 80b83ffd-625d-11e5-bea1-a0481c7e9064<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/sbtsv/nn-sbtsv-itssbresourcepluginstore"><strong>ITsSbResourcePluginStore</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="remote-desktop-virtualization-interfaces.html">Remote Desktop Virtualization Interfaces</a></p>
<!-- raw HTML omitted -->
</body>
