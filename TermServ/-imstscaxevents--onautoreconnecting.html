<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IMsTscAxEvents::OnAutoReconnecting method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IMsTscAxEvents OnAutoReconnecting method
description: Called when a client is in the process of automatically reconnecting a session with a Remote Desktop Session Host (RD Session Host) server. | IMsTscAxEvents OnAutoReconnecting method
ms.assetid: 9cb36052-8010-47df-bb46-f4ad81f47a73
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>OnAutoReconnecting method Remote Desktop Services</li>
<li>OnAutoReconnecting method Remote Desktop Services , IMsTscAxEvents interface</li>
<li>IMsTscAxEvents interface Remote Desktop Services , OnAutoReconnecting method
topic_type:</li>
<li>apiref
api_name:</li>
<li>IMsTscAxEvents.OnAutoReconnecting
api_location:</li>
<li>MsTscAx.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>IMsTscAxEvents::OnAutoReconnecting method</h1>
<p>Called when a client is in the process of automatically reconnecting a session with a Remote Desktop Session Host (RD Session Host) server.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>void OnAutoReconnecting(
  [in]  LONG                       disconnectReason,
  [in]  LONG                       attemptCount,
  [out] AutoReconnectContinueState *pArcContinueStatus
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>disconnectReason</em> [in]</p>
<!-- raw HTML omitted -->
<p>Code describing the reason for the last session disconnection.</p>
<!-- raw HTML omitted -->
<p><em>attemptCount</em> [in]</p>
<!-- raw HTML omitted -->
<p>Number of attempts that have been made in the current automatic reconnection process. This count increases by one for each attempt made.</p>
<!-- raw HTML omitted -->
<p><em>pArcContinueStatus</em> [out]</p>
<!-- raw HTML omitted -->
<p>Pointer to a returned code specifying the state of the automatic reconnection process. This code can be reset to change the state of the current automatic reconnection process.</p>
<p>For more information about resetting this code, refer to the Remarks section.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>autoReconnectContinueAutomatic</strong> (0)</p>
<!-- raw HTML omitted -->
<p>The reconnection process is occurring automatically. This is the default value.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>autoReconnectContinueStop</strong> (1)</p>
<!-- raw HTML omitted -->
<p>The reconnection process has been stopped.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>autoReconnectContinueManual</strong> (2)</p>
<!-- raw HTML omitted -->
<p>The reconnection process is occurring manually.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>Implement this method in your event sink to receive notification that the control is reestablishing a connection with an RD Session Host server.</p>
<p>When the state of the automatic reconnection process is changed by setting the value of the <em>pArcContinueStatus</em> parameter to <strong>autoReconnectContinueAutomatic</strong>, this method functions in a purely advisory mode. Containers can listen to this event for notifications that the automatic reconnection process is proceeding. The control will automatically keep trying to re-establish a connection based on its own internal timing and attempt counts. This method is called during each automatic reconnection attempt in order to notify the container.</p>
<p>When the state of the automatic reconnection process is changed by setting the value of the <em>pArcContinueStatus</em> parameter to <strong>autoReconnectContinueStop</strong>, the current automatic reconnection attempt will be terminated, a disconnect notification will be sent to the container, and no further automatic reconnect notifications will be issued.</p>
<blockquote>
<p>[!Note]<br />
Use the <a href="imsrdpclientadvancedsettings2-enableautoreconnect.html"><strong>EnableAutoReconnect</strong></a> property to enable or disable automatic reconnection.</p>
</blockquote>
<p>When the state of the automatic reconnection process is changed by setting the value of the <em>pArcContinueStatus</em> parameter to <strong>autoReconnectContinueManual</strong>, the container will manually control the automatic reconnection process by calling <a href="imstscax-connect.html"><strong>Connect</strong></a> to trigger a connection attempt or <a href="imstscax-disconnect.html"><strong>Disconnect</strong></a> to cancel the automatic reconnection process. Once set to this value, the control will stop making automatic reconnection attempts and it becomes the policy of the container to make <strong>Connect</strong> calls to trigger automatic reconnection attempts. This is done when the container provides customized UI behavior for automatic reconnection, such as restarting a dropped RAS or VPN connection before the automatic reconnection process.</p>
<p>For more information about Remote Desktop Web Connection, see <a href="requirements-for-remote-desktop-web-connection.html">Requirements for Remote Desktop Web Connection</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Type library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->MsTscAx.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->MsTscAx.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="imstscaxevents-interface.html"><strong>IMsTscAxEvents</strong></a></p>
<!-- raw HTML omitted -->
</body>
