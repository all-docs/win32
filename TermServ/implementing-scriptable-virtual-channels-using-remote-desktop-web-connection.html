<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Implementing scriptable virtual channels by using Remote Desktop Web Connection</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Implementing scriptable virtual channels by using Remote Desktop Web Connection
description: Code examples that show the steps for implementing scriptable virtual channels with Remote Desktop Web Connection.
ms.assetid: a482b84d-96b6-4f42-8841-7039a1882789
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Implementing scriptable virtual channels by using Remote Desktop Web Connection</h1>
<p>The following procedure and code examples show the steps for implementing scriptable virtual channels with Remote Desktop Web Connection. The examples were written in Visual Basic Scripting Edition and assume that the Remote Desktop ActiveX control is named &quot;MsRdpClient&quot;.</p>
<p><strong>To create and deploy scriptable virtual channels</strong></p>
<ol>
<li>
<p>Deploy the server side of the application and make sure it is running on the Remote Desktop Session Host (RDÂ Session Host) server. For information about deploying virtual channels applications on the server, see <a href="virtual-channel-server-application.html">Virtual Channel Server Application</a>.</p>
</li>
<li>
<p>In your client script, call <a href="imstscax-createvirtualchannels.html"><strong>IMsTscAx::CreateVirtualChannels</strong></a>, passing a string that contains a comma-separated list of virtual channel names.</p>
<pre lang="VB"><code>MsRdpClient.CreateVirtualChannels(&quot;mychan1,mychan2&quot;)
</code></pre>
<p>For information about virtual channel naming restrictions, see <a href="virtual-channel-client-registration.html">Virtual Channel Client Registration</a>.</p>
</li>
<li>
<p>Call <a href="imstscax-connect.html"><strong>IMsTscAx::Connect</strong></a> to create your Remote Desktop Services connection.</p>
<pre lang="VB"><code>MsRdpClient.connect
</code></pre>
</li>
<li>
<p>Use the <a href="imstscax-sendonvirtualchannel.html"><strong>IMsTscAx::SendOnVirtualChannel</strong></a> method to send data to the server, passing a string that contains the virtual channel name and a second string that contains the data to be passed.</p>
<pre lang="VB"><code>MsRdpClient.SendOnVirtualChannel(&quot;mychan1&quot;,&quot;hello from the client&quot;)
</code></pre>
</li>
<li>
<p>Receive data from the server on the <a href="imstscaxevents-onchannelreceiveddata.html"><strong>IMsTscAxEvents::OnChannelReceivedData</strong></a> event.</p>
<pre lang="VB"><code>Sub MsRdpClient.OnChannelReceivedData(chanName,data)
Msgbox(&quot;received data:&quot; &amp;data&amp; &quot;on virtual channel:&quot; &amp;chanName)
End sub
</code></pre>
</li>
</ol>
<p>Â </p>
<p>Â </p>
</body>
