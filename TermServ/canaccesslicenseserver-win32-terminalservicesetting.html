<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CanAccessLicenseServer method of the Win32_TerminalServiceSetting class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: CanAccessLicenseServer method of the Win32_TerminalServiceSetting class
description: CanAccessLicenseServer is no longer available.
ms.assetid: b09fa901-8ae1-431e-8d97-27ee84a84779
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>CanAccessLicenseServer method Remote Desktop Services</li>
<li>CanAccessLicenseServer method Remote Desktop Services , Win32_TerminalServiceSetting class</li>
<li>Win32_TerminalServiceSetting class Remote Desktop Services , CanAccessLicenseServer method
topic_type:</li>
<li>apiref
api_name:</li>
<li>Win32_TerminalServiceSetting.CanAccessLicenseServer
api_location:</li>
<li>TSCfgWmi.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>CanAccessLicenseServer method of the Win32_TerminalServiceSetting class</h1>
<p>[<strong>CanAccessLicenseServer</strong> is no longer available for use as of Windows Server 2008 R2.]</p>
<p>**Windows Server 2008:  **</p>
<p>Determines whether the Remote Desktop Session Host (RD Session Host) server is allowed to request Remote Desktop Services client access licenses (RDS CALs) from a Remote Desktop license server based on the following:</p>
<ul>
<li>The &quot;license server security group&quot; group policy setting on the Remote Desktop license server.</li>
<li>Membership in the Terminal Server Computers local group on the license server.</li>
</ul>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 CanAccessLicenseServer(
  [in]  string ServerName,
  [out] uint32 AccessAllowed
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>ServerName</em> [in]</p>
<!-- raw HTML omitted -->
<p>The name of the Remote Desktop license server.</p>
<!-- raw HTML omitted -->
<p><em>AccessAllowed</em> [out]</p>
<!-- raw HTML omitted -->
<p>Whether the RD Session Host server is allowed to request RDS CALs from the license server.</p>
<!-- raw HTML omitted -->
<p>0</p>
<!-- raw HTML omitted -->
<p>The request is allowed.</p>
<!-- raw HTML omitted -->
<p>1</p>
<!-- raw HTML omitted -->
<p>The request is not allowed.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns <strong>S_OK</strong> if the RD Session Host server has access to the license server. Returns <strong>S_FALSE</strong> if the RD Session Host server does not have access to the license server.</p>
<h2>Remarks</h2>
<p>The &quot;license server security group&quot; policy setting allows you to specify the RD Session Host servers that are permitted to contact the license server to obtain RDS CALs. If the policy setting is enabled on the license server, the license server will only respond to RDS CAL requests from RD Session Host servers whose computer accounts are members of the Terminal Server Computers local group on the license server.</p>
<p>To connect to the \root\CIMV2\TerminalServices namespace, the authentication level must include packet privacy. For C/C++ calls, this is an authentication level of <strong>RPC_C_AUTHN_LEVEL_PKT_PRIVACY</strong>. For Visual Basic and scripting calls, this is an authentication level of <strong>WbemAuthenticationLevelPktPrivacy</strong> or &quot;pktPrivacy&quot;, with a value of 6. The following Visual Basic Scripting Edition (VBScript) example shows how to connect to a remote computer with packet privacy.</p>
<pre lang="VB"><code>strComputer = &quot;RemoteServer1&quot; 
Set objServices = GetObject( _
    &quot;winmgmts:{authenticationLevel=pktPrivacy}!Root/CIMv2/TerminalServices&quot;)
</code></pre>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Microsoft Windows Software Development Kit (SDK). They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="/windows/desktop/WmiSdk/managed-object-format--mof-">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of client support<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of server support<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMv2\TerminalServices<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->TSCfgWmi.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->TSCfgWmi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-terminalservicesetting.html"><strong>Win32_TerminalServiceSetting</strong></a></p>
<!-- raw HTML omitted -->
</body>
