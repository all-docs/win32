<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ITsSbResourcePluginStoreEx::AcquireTargetLock method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: ITsSbResourcePluginStoreEx AcquireTargetLock method
description: Locks a target.
ms.assetid: 76707f1d-1f13-4d81-8954-2acf05cda2cd
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>AcquireTargetLock method Remote Desktop Services</li>
<li>AcquireTargetLock method Remote Desktop Services , ITsSbResourcePluginStoreEx interface</li>
<li>ITsSbResourcePluginStoreEx interface Remote Desktop Services , AcquireTargetLock method
topic_type:</li>
<li>apiref
api_name:</li>
<li>ITsSbResourcePluginStoreEx.AcquireTargetLock
api_location:</li>
<li>SbTsV.idl
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>ITsSbResourcePluginStoreEx::AcquireTargetLock method</h1>
<p>Locks a target.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT AcquireTargetLock(
  [in]  BSTR     targetName,
  [in]  DWORD    dwTimeout,
  [out] IUnknown **ppContext
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>targetName</em> [in]</p>
<!-- raw HTML omitted -->
<p>The name of the target to lock.</p>
<!-- raw HTML omitted -->
<p><em>dwTimeout</em> [in]</p>
<!-- raw HTML omitted -->
<p>The timeout for the operation, in milliseconds.</p>
<!-- raw HTML omitted -->
<p><em>ppContext</em> [out]</p>
<!-- raw HTML omitted -->
<p>Returns a pointer to the context of the lock. To release the lock, supply this pointer to the <a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-releasetargetlock"><strong>ReleaseTargetLock</strong></a> method.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If this method succeeds, it returns <strong>S_OK</strong>. Otherwise, it returns an <strong>HRESULT</strong> error code.</p>
<h2>Remarks</h2>
<p>After the lock is acquired, the calling thread is assumed to have exclusive access to the target object and therefore no other thread (within the same machine) can update it. Therefore the calling thread must call the <a href="/windows/desktop/api/sbtsv/nf-sbtsv-itssbresourcepluginstore-releasetargetlock"><strong>ReleaseTargetLock</strong></a> method as soon as it has made the necessary updates to the target object.</p>
<blockquote>
<p>[!IMPORTANT]
this lock does not completely prevent target objects from being modified externally if more than one Connection Broker exists in the deployment. The calling thread must be prepared to handle a failure gracefully and retry the target update.</p>
</blockquote>
<p>This method is available on Windows Server 2012 R2 with <a href="https://support.microsoft.com/kb/3091411">KB3091411</a> installed in the <a href="itssbresourcepluginstoreex.html"><strong>ITsSbResourcePluginStoreEx</strong></a> interface.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2012 R2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>End of server support<!-- raw HTML omitted --></td>
<td>Windows Server 2012 R2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IDL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->SbTsV.idl<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IID_ITsSbResourcePluginStoreEx is defined as 80b83ffd-625d-11e5-bea1-a0481c7e9064<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="itssbresourcepluginstoreex.html"><strong>ITsSbResourcePluginStoreEx</strong></a></p>
<!-- raw HTML omitted -->
</body>
