<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IMsTscAxEvents::OnConfirmClose method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IMsTscAxEvents OnConfirmClose method
description: Called when the client calls the IMsRdpClient RequestClose method.
ms.assetid: fb149fbc-9415-4c4c-8d4b-e22214ac38cb
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>OnConfirmClose method Remote Desktop Services</li>
<li>OnConfirmClose method Remote Desktop Services , IMsTscAxEvents interface</li>
<li>IMsTscAxEvents interface Remote Desktop Services , OnConfirmClose method
topic_type:</li>
<li>apiref
api_name:</li>
<li>IMsTscAxEvents.OnConfirmClose
api_location:</li>
<li>MsTscAx.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>IMsTscAxEvents::OnConfirmClose method</h1>
<p>Called when the client calls the <a href="imsrdpclient-requestclose.html"><strong>IMsRdpClient::RequestClose</strong></a> method. In response to this event, the user should be prompted to confirm closing the connection. For more information, see the following Remarks section.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>void OnConfirmClose(
  [out] VARIANT_BOOL *pfAllowClose
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>pfAllowClose</em> [out]</p>
<!-- raw HTML omitted -->
<p>If <strong>VARIANT_TRUE</strong>, the default, indicates that the user wants to close the connection. If <strong>VARIANT_FALSE</strong>, indicates that the user does not want to close the connection. For more information, see the following Remarks section.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method does not return a value.</p>
<h2>Remarks</h2>
<p>When a container application calls the <a href="imsrdpclient-requestclose.html"><strong>IMsRdpClient::RequestClose</strong></a> method, that method returns a value indicating whether the container should wait for an <strong>OnConfirmClose</strong> event to occur before closing the control connection. If <strong>RequestClose</strong> returns <strong>controlCloseWaitForEvents</strong>, and the user is connected and logged on to their Remote Desktop Services session, the <strong>OnConfirmClose</strong> event fires. At that point the container application can prompt the user, asking whether the user wants to close the connection. If the user wants to close the connection, the application should set the <em>pfAllowClose</em> parameter to <strong>VARIANT_TRUE</strong> and proceed with closing the connection. If the user does not want to close, the application should set <em>pfAllowClose</em> to <strong>VARIANT_FALSE</strong> and leave the connection open.</p>
<p>For more information about Remote Desktop Web Connection, see <a href="requirements-for-remote-desktop-web-connection.html">Requirements for Remote Desktop Web Connection</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Type library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->MsTscAx.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->MsTscAx.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IID<!-- raw HTML omitted --></td>
<td>IMsTscAxEvents is defined as 336d5562-efa8-482e-8cb3-c5c0fc7a7db6<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="imstscaxevents-interface.html"><strong>IMsTscAxEvents</strong></a></p>
<!-- raw HTML omitted -->
</body>
