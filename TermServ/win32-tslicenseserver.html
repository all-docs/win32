<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Win32_TSLicenseServer class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Win32_TSLicenseServer class
description: Provides methods and properties to view and configure Remote Desktop Licensing (RD Licensing) on a Remote Desktop license server.
ms.assetid: 699ddd9f-a91a-450c-b131-a7471252a4cc
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>Win32_TSLicenseServer class Remote Desktop Services</li>
<li>Win32_TSLicenseServer class Remote Desktop Services , described
topic_type:</li>
<li>apiref
api_name:</li>
<li>Win32_TSLicenseServer</li>
<li>Win32_TSLicenseServer.FirstName</li>
<li>Win32_TSLicenseServer.LastName</li>
<li>Win32_TSLicenseServer.Company</li>
<li>Win32_TSLicenseServer.CountryRegion</li>
<li>Win32_TSLicenseServer.eMail</li>
<li>Win32_TSLicenseServer.OrgUnit</li>
<li>Win32_TSLicenseServer.Address</li>
<li>Win32_TSLicenseServer.City</li>
<li>Win32_TSLicenseServer.State</li>
<li>Win32_TSLicenseServer.PostalCode</li>
<li>Win32_TSLicenseServer.ServerRole</li>
<li>Win32_TSLicenseServer.DatabasePath</li>
<li>Win32_TSLicenseServer.ProductId</li>
<li>Win32_TSLicenseServer.Version</li>
<li>Win32_TSLicenseServer.VersionNumber
api_location:</li>
<li>TlsWmiProv.dll
api_type:</li>
<li>DllExport
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Win32_TSLicenseServer class</h1>
<p>Provides methods and properties to view and configure Remote Desktop Licensing (RD Licensing) on a Remote Desktop license server.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[singleton, dynamic, provider(&quot;Win32_WIN32_TERMSERVLICENSING_Prov&quot;), AMENDMENT]
class Win32_TSLicenseServer
{
  string FirstName;
  string LastName;
  string Company;
  string CountryRegion;
  string eMail;
  string OrgUnit;
  string Address;
  string City;
  string State;
  string PostalCode;
  uint32 ServerRole;
  string DatabasePath;
  string ProductId;
  string Version;
  string VersionNumber;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>Win32_TSLicenseServer</strong> class has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>Win32_TSLicenseServer</strong> class has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="activateserver-win32-tslicenseserver.html"><strong>ActivateServer</strong></a></td>
<td align="left">Activates the Remote Desktop license server by using a Remote Desktop license server ID that is obtained over the phone or the Internet.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="activateserverautomatic-win32-tslicenseserver.html"><strong>ActivateServerAutomatic</strong></a></td>
<td align="left">Activates the Remote Desktop license server automatically over the Internet. The <strong>FirstName</strong>, <strong>LastName</strong>, <strong>Company</strong>, and <strong>CountryRegion</strong> properties must not be empty when this method is called, or the method will fail.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="addlstotslsgroup-win32-tslicenseserver.html"><strong>AddLStoTSLSGroup</strong></a></td>
<td align="left">Adds the Remote Desktop license server to the Remote Desktop License Servers group on a domain controller in the same domain as the license server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="changerole-win32-tslicenseserver.html"><strong>ChangeRole</strong></a></td>
<td align="left">Changes the discovery scope of the Remote Desktop license server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="createtscgroup-win32-tslicenseserver.html"><strong>CreateTSCGroup</strong></a></td>
<td align="left">This method is not supported.<!-- raw HTML omitted --> <strong>Windows Server 2008 R2 and Windows Server 2008:</strong> Creates the Terminal Server Computers local group on the Remote Desktop license server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="deactivateserver-win32-tslicenseserver.html"><strong>DeactivateServer</strong></a></td>
<td align="left">Deactivates the Remote Desktop license server by using a confirmation code that is received over the phone.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="deactivateserverautomatic-win32-tslicenseserver.html"><strong>DeactivateServerAutomatic</strong></a></td>
<td align="left">Deactivates the Remote Desktop license server over the Internet. The <strong>FirstName</strong> and <strong>LastName</strong> properties must not be empty when this method is called, or the method will fail.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="getactivationstatus-win32-tslicenseserver.html"><strong>GetActivationStatus</strong></a></td>
<td align="left">Retrieves the current activation status.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="getlicenseserverid-win32-tslicenseserver.html"><strong>GetLicenseServerId</strong></a></td>
<td align="left">Retrieves a Remote Desktop license server ID if the server is currently activated.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="islsintslsgroup-win32-tslicenseserver.html"><strong>IsLSinTSLSGroup</strong></a></td>
<td align="left">Retrieves whether the Remote Desktop license server is a member of the Remote Desktop License Servers group on a domain controller in a given domain.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="islsondc-win32-tslicenseserver.html"><strong>IsLSonDC</strong></a></td>
<td align="left">Retrieves whether RD Licensing is installed on a domain controller.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="islspreventupgradegpenabled-win32-tslicenseserver.html"><strong>IsLSPreventUpgradeGPEnabled</strong></a></td>
<td align="left">Retrieves whether the &quot;prevent license upgrade&quot; group policy setting is enabled on the Remote Desktop license server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="islspublished-win32-tslicenseserver.html"><strong>IsLSPublished</strong></a></td>
<td align="left">Retrieves whether the Remote Desktop license server is published in Active Directory Domain Services (AD DS).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="win32-tslicenseserver-islsregisteredtoscp.html"><strong>IsLSRegisteredToSCP</strong></a></td>
<td align="left">Retrieves whether the Remote Desktop license server is registered as a service connection point in Active Directory Domain Services.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="islssecgrpgpenabled-win32-tslicenseserver.html"><strong>IsLSSecGrpGPEnabled</strong></a></td>
<td align="left">Retrieves whether the &quot;license server security group&quot; group policy setting is enabled on the Remote Desktop license server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="issecureaccessallowed-win32-tslicenseserver.html"><strong>IsSecureAccessAllowed</strong></a></td>
<td align="left">Retrieves whether an RD Session Host server is allowed to request Remote Desktop Services client access licenses (RDS CALs) from the Remote Desktop license server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="istscgrouppresent-win32-tslicenseserver.html"><strong>IsTSCGroupPresent</strong></a></td>
<td align="left">This method is not supported.<!-- raw HTML omitted --> <strong>Windows Server 2008 R2 and Windows Server 2008:</strong> Retrieves whether the Terminal Server Computers local group exists on the Remote Desktop license server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="istsintscgroup-win32-tslicenseserver.html"><strong>IsTSinTSCGroup</strong></a></td>
<td align="left">Retrieves whether an RD Session Host server is a member of the Terminal Server Computers local group on the Remote Desktop license server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="publishls-win32-tslicenseserver.html"><strong>PublishLS</strong></a></td>
<td align="left">Publishes the Remote Desktop license server in AD DS.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="reactivateserver-win32-tslicenseserver.html"><strong>ReactivateServer</strong></a></td>
<td align="left">Reactivates the Remote Desktop license server by using a new Remote Desktop license server ID that is obtained over the phone or the Internet.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="reactivateserverautomatic-win32-tslicenseserver.html"><strong>ReactivateServerAutomatic</strong></a></td>
<td align="left">Reactivates the Remote Desktop license server over the Internet. The <strong>FirstName</strong> and <strong>LastName</strong> properties must not be empty when this method is called, or the method will fail.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="win32-tslicenseserver-registerlstoscp.html"><strong>RegisterLSToSCP</strong></a></td>
<td align="left">Registers the Remote Desktop license server as a service connection point in Active Directory Domain Services.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="removelsfromtslsgroup-win32-tslicenseserver.html"><strong>RemoveLSfromTSLSGroup</strong></a></td>
<td align="left">Removes the Remote Desktop license server from the Remote Desktop License Servers group on a domain controller in the same domain as the license server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="removetscgroup-win32-tslicenseserver.html"><strong>RemoveTSCGroup</strong></a></td>
<td align="left">This method is not supported.<!-- raw HTML omitted --> <strong>Windows Server 2008 R2 and Windows Server 2008:</strong> Removes the Terminal Server Computers local group from the Remote Desktop license server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="unpublishls-win32-tslicenseserver.html"><strong>UnpublishLS</strong></a></td>
<td align="left">Unpublishes a Remote Desktop license server from AD DS.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="win32-tslicenseserver-unregisterlsfromscp.html"><strong>UnRegisterLSFromSCP</strong></a></td>
<td align="left">Removes the Remote Desktop license server as a service connection point in Active Directory Domain Services.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<p>The <strong>Win32_TSLicenseServer</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>Address</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Street address of the contact for RD Licensing. This property is used when the <a href="activateserverautomatic-win32-tslicenseserver.html"><strong>ActivateServerAutomatic</strong></a> method is called. (This property is optional when using the <strong>ActivateServerAutomatic</strong> method.)</p>
<!-- raw HTML omitted -->
<p><strong>City</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>City of the contact for RD Licensing. This property is used when the <a href="activateserverautomatic-win32-tslicenseserver.html"><strong>ActivateServerAutomatic</strong></a> method is called. (This property is optional when using the <strong>ActivateServerAutomatic</strong> method.)</p>
<!-- raw HTML omitted -->
<p><strong>Company</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Company of the contact for RD Licensing. This property is used (and required) when the <a href="activateserverautomatic-win32-tslicenseserver.html"><strong>ActivateServerAutomatic</strong></a> method is called.</p>
<!-- raw HTML omitted -->
<p><strong>CountryRegion</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Country/region of the contact for RD Licensing. This property is used (and required) when the <a href="activateserverautomatic-win32-tslicenseserver.html"><strong>ActivateServerAutomatic</strong></a> method is called.</p>
<!-- raw HTML omitted -->
<p><strong>DatabasePath</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Path of the RDS Licensing database.</p>
<!-- raw HTML omitted -->
<p><strong>eMail</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Email address of the contact for RD Licensing. This property is used when the <a href="activateserverautomatic-win32-tslicenseserver.html"><strong>ActivateServerAutomatic</strong></a>, <a href="reactivateserverautomatic-win32-tslicenseserver.html"><strong>ReactivateServerAutomatic</strong></a>, or <a href="deactivateserverautomatic-win32-tslicenseserver.html"><strong>DeactivateServerAutomatic</strong></a> methods are called. (This property is optional for these method calls.)</p>
<!-- raw HTML omitted -->
<p><strong>FirstName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>First name of the contact for RD Licensing. This property is used (and required) when the <a href="activateserverautomatic-win32-tslicenseserver.html"><strong>ActivateServerAutomatic</strong></a>, <a href="reactivateserverautomatic-win32-tslicenseserver.html"><strong>ReactivateServerAutomatic</strong></a>, or <a href="deactivateserverautomatic-win32-tslicenseserver.html"><strong>DeactivateServerAutomatic</strong></a> methods are called.</p>
<!-- raw HTML omitted -->
<p><strong>LastName</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Last name of the contact for RD Licensing. This property is used (and required) when the <a href="activateserverautomatic-win32-tslicenseserver.html"><strong>ActivateServerAutomatic</strong></a>, <a href="reactivateserverautomatic-win32-tslicenseserver.html"><strong>ReactivateServerAutomatic</strong></a>, or <a href="deactivateserverautomatic-win32-tslicenseserver.html"><strong>DeactivateServerAutomatic</strong></a> methods are called.</p>
<!-- raw HTML omitted -->
<p><strong>OrgUnit</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Organizational unit of the contact for RD Licensing. This property is used when the <a href="activateserverautomatic-win32-tslicenseserver.html"><strong>ActivateServerAutomatic</strong></a> is called. (This property is optional when using the <strong>ActivateServerAutomatic</strong> method.)</p>
<!-- raw HTML omitted -->
<p><strong>PostalCode</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>Postal code of the contact for RD Licensing. This property is used when the <a href="activateserverautomatic-win32-tslicenseserver.html"><strong>ActivateServerAutomatic</strong></a> method is called. (This property is optional when using the <strong>ActivateServerAutomatic</strong> method.)</p>
<!-- raw HTML omitted -->
<p><strong>ProductId</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Product ID of the Remote Desktop license server.</p>
<!-- raw HTML omitted -->
<p><strong>ServerRole</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Describes the licensing scope for the Remote Desktop license server within the organization.</p>
<!-- raw HTML omitted -->
<p>0</p>
<!-- raw HTML omitted -->
<p>RD Session Host servers in the same workgroup can discover the license server.</p>
<!-- raw HTML omitted -->
<p>1</p>
<!-- raw HTML omitted -->
<p>RD Session Host servers in the same domain can discover the license server.</p>
<!-- raw HTML omitted -->
<p>2</p>
<!-- raw HTML omitted -->
<p>RD Session Host servers from multiple domains in the same forest can discover the license server.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>State</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<p>State of the contact for RD Licensing. This property is used when the <a href="activateserverautomatic-win32-tslicenseserver.html"><strong>ActivateServerAutomatic</strong></a> method is called. (This property is optional when using the <strong>ActivateServerAutomatic</strong> method.)</p>
<!-- raw HTML omitted -->
<p><strong>Version</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Version of the Remote Desktop license server.</p>
<!-- raw HTML omitted -->
<p><strong>VersionNumber</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Version number of the Remote Desktop license server.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>This class is a <a href="/windows/desktop/WmiSdk/standard-wmi-qualifiers">singleton</a> class and can have only one instance. All of the methods contained within this class are static.</p>
<p>You must be a member of the Administrators group to use this class. If the caller is not a member of the Administrators group, the properties returned will be empty.</p>
<p>Managed Object Format (MOF) files contain the definitions for Windows Management Instrumentation (WMI) classes. MOF files are not installed as part of the Microsoft Windows Software Development Kit (SDK). They are installed on the server when you add the associated role by using the Server Manager. For more information about MOF files, see <a href="/windows/desktop/WmiSdk/managed-object-format--mof-">Managed Object Format (MOF)</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMv2<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->TlsWmiProv.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->TlsWmiProv.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="win32-tsissuedlicense.html"><strong>Win32_TSIssuedLicense</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="win32-tslicensekeypack.html"><strong>Win32_TSLicenseKeyPack</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="win32-tslicensereport.html"><strong>Win32_TSLicenseReport</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="win32-tslicensereportentry.html"><strong>Win32_TSLicenseReportEntry</strong></a></p>
<!-- raw HTML omitted -->
</body>
