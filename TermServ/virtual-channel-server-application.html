<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Virtual Channel Server Application</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Virtual Channel Server Application
description: The server module of an application that uses virtual channels must be a user-mode application running in a client session on the Remote Desktop Session Host (RDÂ Session Host) server. Note that you must provide a method to start the server application.
ms.assetid: b593df5d-5e22-46c6-8f59-9e3fdfe765ad
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Virtual Channel Server Application</h1>
<p>The server module of an application that uses virtual channels must be a user-mode application running in a client session on the Remote Desktop Session Host (RDÂ Session Host) server. Note that you must provide a method to start the server application. You can accomplish this in multiple ways; for example, you can use a logon script, or a program or script in the Startup folder. Users could also launch the application.</p>
<p>You must store the name of the virtual channel server application in the registry by adding a subkey under the following location:</p>
<p><strong>HKEY_LOCAL_MACHINE</strong>\<strong>System</strong>\<strong>CurrentControlSet</strong>\<strong>Control</strong>\<strong>TerminalÂ Server</strong>\<strong>Addins</strong></p>
<p>For more information about the subkey, see <a href="monitoring-session-connections-and-disconnections.html">Monitoring Session Connections and Disconnections</a>.</p>
<p>The server application can call the <a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelopen"><strong>WTSVirtualChannelOpen</strong></a> function to open a handle to a virtual channel. The application can then use the handle in any of the following functions.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelclose"><strong>WTSVirtualChannelClose</strong></a></p>
<!-- raw HTML omitted -->
<p>Closes an open virtual channel handle.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelpurgeinput"><strong>WTSVirtualChannelPurgeInput</strong></a></p>
<!-- raw HTML omitted -->
<p>Deletes all queued input data sent from the client to the server on a specific virtual channel.</p>
<blockquote>
<p>[!Note]<br />
This function currently is not used by Remote Desktop Services.</p>
</blockquote>
<p>Â </p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelpurgeoutput"><strong>WTSVirtualChannelPurgeOutput</strong></a></p>
<!-- raw HTML omitted -->
<p>Deletes all queued output data sent from the server to the client on a specific virtual channel.</p>
<blockquote>
<p>[!Note]<br />
This function currently is not used by Remote Desktop Services.</p>
</blockquote>
<p>Â </p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelquery"><strong>WTSVirtualChannelQuery</strong></a></p>
<!-- raw HTML omitted -->
<p>Returns information about a specified virtual channel.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelread"><strong>WTSVirtualChannelRead</strong></a></p>
<!-- raw HTML omitted -->
<p>Reads data from the server end of a virtual channel.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelwrite"><strong>WTSVirtualChannelWrite</strong></a></p>
<!-- raw HTML omitted -->
<p>Writes data to the server end of a virtual channel.</p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
