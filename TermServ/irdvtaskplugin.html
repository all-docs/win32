<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IRDVTaskPlugin interface</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IRDVTaskPlugin interface
description: The IRDVTaskPlugin interface is implemented by a virtual machine update task agent to allow the task agent to manage system updates for a virtual machine.
ms.assetid: e06eb707-be78-4d1f-96d3-21526b167e61
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>IRDVTaskPlugin interface Remote Desktop Services</li>
<li>IRDVTaskPlugin interface Remote Desktop Services , described
topic_type:</li>
<li>apiref
api_name:</li>
<li>IRDVTaskPlugin
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018
api_location:</li>
</ul>
<hr />
<h1>IRDVTaskPlugin interface</h1>
<p>The <strong>IRDVTaskPlugin</strong> interface is implemented by a virtual machine update <em>task agent</em> to allow the task agent to manage system updates for a virtual machine. This interface is used by the <em>trigger agent</em>, which is implemented by the host system.</p>
<h2>Members</h2>
<p>The <strong>IRDVTaskPlugin</strong> interface inherits from the <a href="/windows/desktop/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> interface. <strong>IRDVTaskPlugin</strong> also has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>IRDVTaskPlugin</strong> interface has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="irdvtaskplugin-initialize.html"><strong>Initialize</strong></a></td>
<td align="left">Called to initialize the task agent.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="irdvtaskplugin-starttask.html"><strong>StartTask</strong></a></td>
<td align="left">Called to start the update task on the virtual machine.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="irdvtaskplugin-terminate.html"><strong>Terminate</strong></a></td>
<td align="left">Called when the task agent is being shut down.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<p>The <strong>IRDVTaskPlugin</strong> interface has these properties.</p>
<table>
<thead>
<tr>
<th align="left">Property</th>
<th align="left">Access type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="irdvtaskplugin-pluginname.html"><strong>PluginName</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Contains the display name of the task agent.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>The task agent is run on the virtual machine when that virtual machine is scheduled for a system update. The task agent updates the virtual machine when the <a href="irdvtaskplugin-starttask.html"><strong>StartTask</strong></a> method is called.</p>
<p>To register the task agent, add the following key to the registry of the virtual machine:</p>
<p><strong>HKEY_LOCAL_MACHINE</strong>\<strong>Software</strong>\<strong>Microsoft</strong>\<strong>Windows NT</strong>\<strong>CurrentVersion</strong>\<strong>Terminal Server</strong>\<strong>Task</strong>\<strong>Plugins</strong>\<strong>TaskAgentName</strong></p>
<p>Under this registry key, add the following values:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>CLSID</strong><!-- raw HTML omitted --></td>
<td><strong>REG_SZ</strong><!-- raw HTML omitted --></td>
<td>A string that represents the <strong>CLSID</strong> of the task agent.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>IsEnabled</strong><!-- raw HTML omitted --></td>
<td><strong>REG_DWORD</strong><!-- raw HTML omitted --></td>
<td>0 if the task agent is disabled or 1 if the task agent is enabled.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<blockquote>
<p>[!Note]<br />
More than one task agent can be registered, but only one task agent will be used. If more than one task agent is enabled, only the first one found will be used.</p>
</blockquote>
<p>Although this interface is supported on the operating systems identified in the Requirements below, it will only be used if the virtual machine is hosted on Windows Server 2012.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 7 Enterprise<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008 R2<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
