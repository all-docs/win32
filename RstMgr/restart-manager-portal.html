<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Restart Manager</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Restart Manager
description: Write custom installers to eliminate system restarts that are required to complete updating a file in use. Shut down and restart all but critical system services from programs.
ms.assetid: 44b7975a-0093-4c8f-9a14-2a6bfd7a68a5
keywords:</p>
<ul>
<li>Restart Manager Restart Mgr
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Restart Manager</h1>
<h2>Purpose</h2>
<p>The Restart Manager API can eliminate or reduce the number of system restarts that are required to complete an installation or update. The primary reason software updates require a system restart during an installation or update is that some of the files that are being updated are currently being used by a running application or service. The Restart Manager enables all but the <a href="critical-system-services.html">critical system services</a> to be shut down and restarted. This frees files that are in use and allows installation operations to complete.</p>
<h2>Where applicable</h2>
<p>The Restart Manager DLL exports a public C interface that can be loaded by standard or custom installers. The installer can use the Restart Manager to register files that should be replaced during the installation of an application or update. Then during a subsequent update or installation, the installer can use the Restart Manager to determine which files cannot be updated because they are currently in use. Restart Manager can shut down and restart the non-critical services or applications that are currently using those files. Installers can direct the Restart Manager to shut down and restart applications or services based on the file in use, the process ID (PID), or the short-name of a Windows service.</p>
<p>Restart Manager is intended for the development of desktop style applications.</p>
<h2>Developer audience</h2>
<p>This documentation is intended for developers of installation applications who want to take advantage of the installer capabilities in Windows Vista or Windows Server 2008. Applications that use the <a href="/windows/desktop/Msi/windows-installer-portal">Windows Installer</a> version 4.0 for installation and servicing automatically use the Restart Manager to reduce system restarts. Custom installers can also be designed to call the Restart Manager API to shut down and restart applications and services. In cases where a system restart is unavoidable, installers can use the Restart Manager API to schedule restarts in such a way that it minimizes the disruption of the user's work flow.</p>
<h2>Run-time requirements</h2>
<p>The Restart Manager API is available beginning with Windows Vista and Windows Server 2008. Restart Manager consists of a single DLL that applications can load to access the Restart Manager API.</p>
<h2>In this section</h2>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="about-restart-manager.html">About Restart Manager</a><!-- raw HTML omitted --></td>
<td>Overview topics that describe the Restart Manager.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="using-restart-manager.html">Using Restart Manager</a><!-- raw HTML omitted --></td>
<td>Overview topics about using the Restart Manager API.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="restart-manager-reference.html">Restart Manager Reference</a><!-- raw HTML omitted --></td>
<td>Reference topics for the Restart Manager API.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
