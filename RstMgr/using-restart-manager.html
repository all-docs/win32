<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Restart Manager</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Using Restart Manager
description: The following sections describe using the Restart Manager API.
ms.assetid: 78448d5e-20f6-45b6-b833-7d7791e5e4c6
keywords:</p>
<ul>
<li>Restart Manager Restart Mgr , using
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Using Restart Manager</h1>
<p>The following sections describe using the Restart Manager API. Your applications and services should also follow the <a href="guidelines-for-applications-and-services.html">Guidelines for Applications and Services</a>.</p>
<h2>Using the Microsoft Windows Installer</h2>
<p>The <a href="/windows/desktop/Msi/windows-installer-portal">Microsoft Windows Installer</a> Version 4.0 is the application installation service of WindowsÂ Vista or Windows ServerÂ 2008. Applications that use the Windows Installer version 4.0 for installation and servicing automatically use the Restart Manager to reduce system restarts. Custom installers can also be designed to call the Restart Manager API to shut down and restart applications and services directly to avoid requiring a system restart. In cases where a system restart is unavoidable, installers can use the <a href="/windows/desktop/api/winreg/nf-winreg-initiateshutdowna"><strong>InitiateShutdown</strong></a> or <a href="/windows/desktop/api/winuser/nf-winuser-exitwindowsex"><strong>ExitWindowsEx</strong></a> function to schedule it in such a way that it minimizes the disruption to the user. Interactive Windows Installer packages should implement a user interface that includes a <a href="/windows/desktop/Msi/msirmfilesinuse-dialog">MsiRMFilesInUse</a> dialog box. For more information, see <a href="/windows/desktop/Msi/using-windows-installer-with-restart-manager">Using Windows Installer with Restart Manager</a> in the Windows Installer SDK documentation.</p>
<h2>Using the Restart Manager API with Custom Installers</h2>
<p>Custom installers, or a Windows Installer package that contains custom actions that cause a system restart, can use the Restart Manager API to shut down and restart applications and services.</p>
<ul>
<li>All operations that are performed using the Restart Manager API must be associated with a session. A maximum of 64 Restart Manager sessions per user session can be open on the system at the same time. The primary installer starts and ends the Restart Manager session. For more information about using Restart Manager with a single installer, see <a href="using-restart-manager-with-a-primary-installer.html">Using Restart Manager with a Primary Installer</a>.</li>
<li>If necessary for the installation, one or more secondary installers can be joined to the Restart Manager session and can run either in-process or out-of-process of the primary installer. Secondary installers require that the session key be provided by the primary installer to join a session. For more information and an example of using secondary installers, see <a href="using-restart-manager-with-a-secondary-installer.html">Using Restart Manager with a Secondary Installer</a>.</li>
<li>Interactive installers should implement a user interface that includes an <a href="/windows/desktop/Msi/msirmfilesinuse-dialog">MsiRMFilesInUse</a> dialog box that can ask users to close applications and services. For more information, see <a href="/windows/desktop/Msi/using-windows-installer-with-restart-manager">Using Windows Installer with Restart Manager</a> in the Windows Installer SDK documentation.</li>
<li>Installers can call the Restart Manager API to change, cancel, and get the status of the current Restart Manager operation. For more information, see the following topics: <a href="getting-the-status-of-a-restart-manager-operation.html">Getting the Status of a Restart Manager Operation</a> and <a href="canceling-the-current-restart-manager-operation.html">Canceling the Current Restart Manager Operation</a>.</li>
<li>Installers should not disable file system redirection before calling the Restart Manager API. Some 32-bit installers run on 64-bit Windows may be unable to register a file in the %windir%\system32 directory.</li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
