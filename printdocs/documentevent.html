<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DocumentEvent function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The DocumentEvent function is an event handler for events associated with printing a document.
ms.assetid: 1250116e-55c7-470f-97f6-36f27a31a841
title: DocumentEvent function (Winspool.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>DocumentEvent</li>
<li>DocumentEventA</li>
<li>DocumentEventW
api_type:</li>
<li>HeaderDef
api_location:</li>
<li>Winspool.h</li>
</ul>
<hr />
<h1>DocumentEvent function</h1>
<p>The <strong>DocumentEvent</strong> function is an event handler for events associated with printing a document.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT DocumentEvent(
  _In_  HANDLE hPrinter,
  _In_  HDC    hdc,
        INT    iEsc,
        ULONG  cbIn,
  _In_  PVOID  pvIn,
        ULONG  cbOut,
  _Out_ PVOID  pvOut
);
</code></pre>
<h2>Parameters</h2>
<p><em>hPrinter</em> [in]</p>
<p>A handle to a printer object. Use the <a href="openprinter.html"><strong>OpenPrinter</strong></a> or <a href="addprinter.html"><strong>AddPrinter</strong></a> function to retrieve a printer handle.</p>
<p><em>hdc</em> [in]</p>
<p>A device context handle that is generated by a call of <a href="/windows/desktop/api/wingdi/nf-wingdi-createdca"><strong>CreateDC</strong></a>. This is zero if <em>iEsc</em> is set to DOCUMENTEVENT_CREATEDCPRE. For restrictions on printing from a 32-bit application on a 64-bit version of Windows, see Remarks.</p>
<p><em>iEsc</em></p>
<p>An escape code that identifies the event to be handled. This parameter can be one of the following integer constants.</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Event</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_ABORTDOC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI is about to process a call to its <a href="/windows/desktop/api/Wingdi/nf-wingdi-abortdoc"><strong>AbortDoc</strong></a> function.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_CREATEDCPOST</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI has just processed a call to its <a href="/windows/desktop/api/wingdi/nf-wingdi-createdca"><strong>CreateDC</strong></a> or <a href="/windows/desktop/api/wingdi/nf-wingdi-createica"><strong>CreateIC</strong></a> function.<!-- raw HTML omitted --> This escape code should not be used unless there has been a previous call to <strong>DocumentEvent</strong> with <em>iEsc</em> set to DOCUMENTEVENT_CREATEDCPRE.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_CREATEDCPRE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI is about to process a call to its <a href="/windows/desktop/api/wingdi/nf-wingdi-createdca"><strong>CreateDC</strong></a> or <a href="/windows/desktop/api/wingdi/nf-wingdi-createica"><strong>CreateIC</strong></a> function.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_DELETEDC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI is about to process a call to its <a href="/windows/desktop/api/wingdi/nf-wingdi-deletedc"><strong>DeleteDC</strong></a> function.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_ENDDOCPOST</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI has just processed a call to its <a href="/windows/desktop/api/Wingdi/nf-wingdi-enddoc"><strong>EndDoc</strong></a> function.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_ENDDOCPRE or DOCUMENTEVENT_ENDDOC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI is about to process a call to its <a href="/windows/desktop/api/Wingdi/nf-wingdi-enddoc"><strong>EndDoc</strong></a> function.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_ENDPAGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI is about to process a call to its <a href="/windows/desktop/api/Wingdi/nf-wingdi-endpage"><strong>EndPage</strong></a> function.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_ESCAPE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI is about to process a call to its <a href="/windows/desktop/api/Wingdi/nf-wingdi-extescape"><strong>ExtEscape</strong></a> function.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_QUERYFILTER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The DOCUMENTEVENT_QUERYFILTER event represents an opportunity for the spooler to query the driver for a list of the DOCUMENTEVENT_ <em>XXX</em> events to which the driver will respond. This event is issued just prior to a call to <strong>DocumentEvent</strong> that passes the DOCUMENTEVENT_CREATEDCPRE event.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_RESETDCPOST</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI has just processed a call to its <a href="/windows/desktop/api/wingdi/nf-wingdi-resetdca"><strong>ResetDC</strong></a> function.<!-- raw HTML omitted --> This escape code should not be used unless there has been a previous call to <strong>DocumentEvent</strong> with <em>iEsc</em> set to DOCUMENTEVENT_RESETDCPRE.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_RESETDCPRE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI is about to process a call to its <a href="/windows/desktop/api/wingdi/nf-wingdi-resetdca"><strong>ResetDC</strong></a> function.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_STARTDOCPOST</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI has just processed a call to its <a href="/windows/desktop/api/Wingdi/nf-wingdi-startdoca"><strong>StartDoc</strong></a> function.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_STARTDOCPRE or DOCUMENTEVENT_STARTDOC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI is about to process a call to its <a href="/windows/desktop/api/Wingdi/nf-wingdi-startdoca"><strong>StartDoc</strong></a> function.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_STARTPAGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>GDI is about to process a call to its <a href="/windows/desktop/api/Wingdi/nf-wingdi-startpage"><strong>StartPage</strong></a> function.</td>
</tr>
</tbody>
</table>
<p><em>cbIn</em></p>
<p>The size, in bytes, of the buffer pointed to by <em>pvIn</em>.</p>
<p><em>pvIn</em> [in]</p>
<p>A pointer to a buffer. What the buffer contains depends on the value of <em>iEsc</em>, as shown in the following table.</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>pvin Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_ABORTDOC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Not used.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_CREATEDCPOST</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><em>pvIn</em> contains the address of a pointer to the <a href="/windows/win32/api/wingdi/ns-wingdi-devmodea"><strong>DEVMODE</strong></a> structure specified in the <em>pvOut</em> parameter in a previous call to this function, for which the <em>iEsc</em> parameter was set to DOCUMENTEVENT_CREATEDCPRE.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_CREATEDCPRE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><em>pvIn</em> points to a DOCEVENT_CREATEDCPRE structure which is documented in the <a href="https://msdn.microsoft.com/windows/hardware/gg487428">Windows Driver Development Kit</a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_DELETEDC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Not used.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_ENDDOCPOST</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Not used.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_ENDDOCPRE or DOCUMENTEVENT_ENDDOC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Not used.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_ENDPAGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Not used.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_ESCAPE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><em>pvIn</em> points to a DOCEVENT_ESCAPE structure which is documented in the <a href="https://msdn.microsoft.com/windows/hardware/gg487428">Windows Driver Development Kit</a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_QUERYFILTER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Same as for DOCUMENTEVENT_CREATEDCPRE.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_RESETDCPOST</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><em>pvIn</em> contains the address of a pointer to the <a href="/windows/win32/api/wingdi/ns-wingdi-devmodea"><strong>DEVMODE</strong></a> structure specified in the <em>pvOut</em> parameter in a previous call to this function, for which the <em>iEsc</em> parameter was set to DOCUMENTEVENT_RESETDCPRE.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_RESETDCPRE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><em>pvIn</em> contains the address of a pointer to the <a href="/windows/win32/api/wingdi/ns-wingdi-devmodea"><strong>DEVMODE</strong></a> structure supplied by the caller of <a href="/windows/desktop/api/wingdi/nf-wingdi-resetdca"><strong>ResetDC</strong></a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_STARTDOCPOST</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><em>pvIn</em> points to a LONG that specifies the print job identifier returned by <a href="/windows/desktop/api/Wingdi/nf-wingdi-startdoca"><strong>StartDoc</strong></a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_STARTDOCPRE or DOCUMENTEVENT_STARTDOC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><em>pvIn</em> contains the address of a pointer to a <a href="/windows/desktop/api/Wingdi/ns-wingdi-docinfoa"><strong>DOCINFO</strong></a> structure supplied by the caller of <a href="/windows/desktop/api/Wingdi/nf-wingdi-startdoca"><strong>StartDoc</strong></a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_STARTPAGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Not used.</td>
</tr>
</tbody>
</table>
<p><em>cbOut</em></p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>IDOCUMENTEVENT_QUERYFILTER</td>
<td>The size, in bytes, of the buffer pointer to by <em>pvOut</em>.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_ESCAPE</td>
<td>A value that is used as the <em>cbOutput</em> parameter for <a href="/windows/desktop/api/Wingdi/nf-wingdi-extescape"><strong>ExtEscape</strong></a>.</td>
</tr>
<tr>
<td>For all other values</td>
<td><em>iEsc</em> is not used.</td>
</tr>
</tbody>
</table>
<p><em>pvOut</em> [out]</p>
<p>A pointer to a buffer. The contents of the buffer depend on the value supplied for <em>iEsc</em>, as shown in the following table.</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>pvOut Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_CREATEDCPRE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A pointer to a driver-supplied <a href="/windows/win32/api/wingdi/ns-wingdi-devmodea"><strong>DEVMODE</strong></a> structure, which GDI uses instead of the one supplied by the <a href="/windows/desktop/api/wingdi/nf-wingdi-createdca"><strong>CreateDC</strong></a> caller. (If <strong>NULL</strong>, GDI uses the caller-supplied structure.)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_ESCAPE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A pointer to a buffer that is used as the <em>lpszOutData</em> parameter for <a href="/windows/desktop/api/Wingdi/nf-wingdi-extescape"><strong>ExtEscape</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_QUERYFILTER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A pointer to buffer containing a DOCEVENT_FILTER structure which is documented in the <a href="https://msdn.microsoft.com/windows/hardware/gg487428">Windows Driver Development Kit</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DOCUMENTEVENT_RESETDCPRE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A pointer to a driver-supplied <a href="/windows/win32/api/wingdi/ns-wingdi-devmodea"><strong>DEVMODE</strong></a> structure, which GDI uses instead of the one supplied by the <a href="/windows/desktop/api/wingdi/nf-wingdi-resetdca"><strong>ResetDC</strong></a> caller. (If <strong>NULL</strong>, GDI uses the caller-supplied structure.)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Return value</h2>
<p>The function's return value is dependent on the escape supplied for <em>iEsc</em>. For some escape codes, the return value is not used (see below). If the function supplies a return value, it must be one of the following.</p>
<table>
<thead>
<tr>
<th>Return Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>DOCUMENTEVENT_FAILURE</td>
<td>The driver supports the escape code identified by <em>iEsc</em>, but a failure occurred.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_SUCCESS</td>
<td>The driver successfully handled the escape code identified by <em>iEsc</em>.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_UNSUPPORTED</td>
<td>The driver does not support the escape code identified by <em>iEsc</em>.</td>
</tr>
</tbody>
</table>
<p>The following list indicates which escape codes that require a return value and which do not, and explains the meaning of the DOCUMENTEVENT_SUCCESS, DOCUMENTEVENT_FAILURE, and DOCUMENTEVENT_UNSUPPORTED return codes.</p>
<table>
<thead>
<tr>
<th>Return Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>DOCUMENTEVENT_ABORTDOC</td>
<td>The return value is not used and should not be read.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_CREATEDCPOST</td>
<td>The return value is not used and should not be read.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_CREATEDCPRE</td>
<td>DOCUMENTEVENT_FAILURE - GDI does not create the device context or information context, and provides a return value of 0 for <a href="/windows/desktop/api/wingdi/nf-wingdi-createdca"><strong>CreateDC</strong></a> or <a href="/windows/desktop/api/wingdi/nf-wingdi-createica"><strong>CreateIC</strong></a>.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_DELETEDC</td>
<td>The return value is not used and should not be read.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_ENDDOCPOST</td>
<td>The return value is not used and should not be read.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_ENDDOCPRE or DOCUMENTEVENT_ENDDOC</td>
<td>The return value is not used and should not be read.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_ENDPAGE</td>
<td>The return value is not used and should not be read.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_ESCAPE</td>
<td>The return value is not used and should not be read.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_QUERYFILTER</td>
<td>See Remarks.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_RESETDCPOST</td>
<td>The return value is not used and should not be read.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_RESETDCPRE</td>
<td>DOCUMENTEVENT_FAILURE - GDI does not reset the device context, and provides a return value of 0 for <a href="/windows/desktop/api/wingdi/nf-wingdi-resetdca"><strong>ResetDC</strong></a>.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_STARTDOCPOST</td>
<td>DOCUMENTEVENT_FAILURE - GDI calls <a href="/windows/desktop/api/Wingdi/nf-wingdi-abortdoc"><strong>AbortDoc</strong></a> to stop the document, and then provides a return value of SP_ERROR for <a href="/windows/desktop/api/Wingdi/nf-wingdi-startdoca"><strong>StartDoc</strong></a>.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_STARTDOCPRE or DOCUMENTEVENT_STARTDOC</td>
<td>DOCUMENTEVENT_FAILURE - GDI does not start the document, and provides a return value of SP_ERROR for <a href="/windows/desktop/api/Wingdi/nf-wingdi-startdoca"><strong>StartDoc</strong></a>.</td>
</tr>
<tr>
<td>DOCUMENTEVENT_STARTPAGE</td>
<td>DOCUMENTEVENT_FAILURE - GDI does not start the page, and provides a return value of SP_ERROR for <a href="/windows/desktop/api/Wingdi/nf-wingdi-startpage"><strong>StartPage</strong></a>.</td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>For an <em>iEsc</em> value of DOCUMENTEVENT_QUERYFILTER, the spooler can interpret a DOCUMENTEVENT_SUCCESS value returned by <strong>DocumentEvent</strong> in two ways, depending on whether the driver modified certain members of the DOCEVENT_FILTER structure (which is documented in the <a href="https://msdn.microsoft.com/windows/hardware/gg487428">Windows Driver Development Kit</a> ). (The <em>pvOut</em> parameter points to this structure.) When the spooler allocates memory for a structure of this type, it initializes two members of this structure, <strong>cElementsReturned</strong> and <strong>cElementsNeeded</strong>, to known values. After <strong>DocumentEvent</strong> returns, the spooler determines whether the values of these members have changed, and uses that information to interpret the <strong>DocumentEvent</strong> return value. The following table summarizes this situation.</p>
<table>
<thead>
<tr>
<th>Return Value</th>
<th>Status of cElementsReturned and cElementsNeeded</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>DOCUMENTEVENT_SUCCESS<!-- raw HTML omitted --></td>
<td>Driver made no change to either member.<!-- raw HTML omitted --></td>
<td>The spooler interprets this return value as equivalent to DOCUMENTEVENT_UNSUPPORTED. The spooler is unable to retrieve the event filter from the driver, so it persists in calling <strong>DocumentEvent</strong> for all events.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DOCUMENTEVENT_SUCCESS<!-- raw HTML omitted --></td>
<td>Driver wrote to one or both members.<!-- raw HTML omitted --></td>
<td>The spooler accepts this return value without interpretation. If the driver wrote to only one of <strong>cElementsNeeded</strong> and <strong>cElementsReturned</strong>, the spooler considers the unchanged member to have a value of zero.<!-- raw HTML omitted --> The spooler filters out all events listed in the <strong>aDocEventCall</strong> member of DOCEVENT_FILTER (which is documented in the <a href="https://msdn.microsoft.com/windows/hardware/gg487428">Windows Driver Development Kit</a> ).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DOCUMENTEVENT_UNSUPPORTED<!-- raw HTML omitted --></td>
<td>Not applicable<!-- raw HTML omitted --></td>
<td>The driver does not support DOCUMENTEVENT_QUERYFILTER.<!-- raw HTML omitted --> The spooler is unable to retrieve the event filter from the driver, so it persists in calling <strong>DocumentEvent</strong> for all events.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DOCUMENTEVENT_FAILURE<!-- raw HTML omitted --></td>
<td>Not applicable<!-- raw HTML omitted --></td>
<td>The driver supports DOCUMENTEVENT_QUERYFILTER, but encountered an internal error.<!-- raw HTML omitted --> The spooler is unable to retrieve the event filter from the driver, so it persists in calling <strong>DocumentEvent</strong> for all events.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>If the escape code supplied in the <em>iEsc</em> parameter is DOCUMENTEVENT_CREATEDCPRE, the following rules apply:</p>
<ul>
<li>If the job is being sent directly to the printer without spooling, pvIn-&gt;pszDevice points to the printer name. (For more information, see the documentation for the DOCEVENT_CREATEDCPRE structure in the <a href="https://msdn.microsoft.com/windows/hardware/gg487428">Windows Driver Development Kit</a>.)</li>
<li>If the job is being spooled, pvIn-&gt;pszDevice points to the printer port name.</li>
</ul>
<blockquote>
<p>[!NOTE]<br />
The following restrictions apply when running a 32-bit application on a 64-bit version of Windows. The only GDI function that <strong>DocumentEvent</strong> should call is <a href="/windows/desktop/api/Wingdi/nf-wingdi-extescape"><strong>ExtEscape</strong></a>, and only private escapes should be used. <strong>DocumentEvent</strong> calls to other GDI functions may produce undefined behavior.</p>
</blockquote>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winspool.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Unicode and ANSI names<!-- raw HTML omitted --></td>
<td><strong>DocumentEventW</strong> (Unicode) and <strong>DocumentEventA</strong> (ANSI)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<ul>
<li><a href="printdocs-printing.html">Printing</a></li>
<li><a href="printing-and-print-spooler-functions.html">Print Spooler API Functions</a></li>
<li><a href="https://msdn.microsoft.com/windows/hardware/gg487428">Windows Driver Development Kit</a></li>
</ul>
</body>
