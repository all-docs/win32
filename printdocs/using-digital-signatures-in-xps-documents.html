<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using XPS Digital Signature API</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This topic lists considerations for using the XPS Digital Signature API to add digital signatures to an XPS document.
ms.assetid: 27c28313-d8db-4c40-9972-cb03bdaa125c
title: Using XPS Digital Signature API
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using XPS Digital Signature API</h1>
<p>This topic lists considerations for using the XPS Digital Signature API to add digital signatures to an XPS document.</p>
<p>The XPS Digital Signature API enables applications to request users to sign XPS documents and to verify signatures that are found in XPS documents. The XPS Digital Signature API can be applied to an XPS document without loading it into an XPS OM, and it can be used on XPS document streams that are serialized from an XPS OM.</p>
<p>The <a href="#xps-digital-signature-api-programming-tasks">XPS Digital Signature API Programming Tasks</a> section contains topics that describe how to program with the XPS Digital Signature API. This topic lists the following considerations for using the XPS Digital Signature API when adding digital signature support to an application.</p>
<ul>
<li><a href="#xps-digital-signature-api-programming-tasks">XPS Digital Signature API Programming Tasks</a></li>
<li><a href="#special-notes-about-xps-digital-signature-api-programming">Special Notes about XPS Digital Signature API Programming</a>
<ul>
<li><a href="#verifying-digital-signatures-in-an-xps-document">Verifying Digital Signatures in an XPS Document</a></li>
<li><a href="#digital-signature-signing-policy">Digital Signature Signing Policy</a></li>
<li><a href="#embedding-a-certificate-chain">Embedding a Certificate Chain</a></li>
<li><a href="#using-the-cert_context-structure">Using the CERT_CONTEXT Structure</a></li>
</ul>
</li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>XPS Digital Signature API Programming Tasks</h2>
<p>This section contains topics that describe how to perform programming tasks by using the XPS Digital Signature API.</p>
<ul>
<li><a href="basic-digital-signature-programming-tasks.html">Common Digital Signature Programming Tasks</a><!-- raw HTML omitted --></li>
</ul>
<p><a href="initialize-the-signature-manager.html">Initialize the Signature Manager</a><br />
<a href="sign-a-document.html">Sign a Document</a><br />
<a href="add-a-signature-request-to-a-document.html">Add a Signature Request to an XPS Document</a><br />
<a href="verify-document-signatures.html">Verify Document Signatures</a><br />
<!-- raw HTML omitted --></p>
<ul>
<li><a href="advanced-digital-signature-programming-tasks.html">Additional Digital Signature Programming Tasks</a><!-- raw HTML omitted --></li>
</ul>
<p><a href="load-a-certificate-from-a-file.html">Load a Certificate From a File</a><br />
<a href="verify-a-certificate-supports-a-signature-method.html">Verify That a Certificate Supports a Signature Method</a><br />
<a href="verify-a-certificate-supports-a-digest-method.html">Verify the System Supports a Digest Method</a><br />
<a href="embedding-certificate-trust-chains-in-a-document.html">Embed Certificate Chains in a Document</a><br />
<!-- raw HTML omitted --></p>
<h2>Special Notes about XPS Digital Signature API Programming</h2>
<p>The following topics require some special consideration when you use the XPS Digital Signature API.</p>
<ul>
<li><a href="#verifying-digital-signatures-in-an-xps-document">Verifying Digital Signatures in an XPS Document</a></li>
<li><a href="#digital-signature-signing-policy">Digital Signature Signing Policy</a></li>
<li><a href="#embedding-a-certificate-chain">Embedding a Certificate Chain</a></li>
<li><a href="#using-the-cert_context-structure">Using the CERT_CONTEXT Structure</a></li>
</ul>
<h3>Verifying Digital Signatures in an XPS Document</h3>
<p><a href="/windows/desktop/api/xpsdigitalsignature/nf-xpsdigitalsignature-ixpssignature-verify"><strong>IXpsSignature::Verify</strong></a> checks only the signed content to determine that it has not changed since it was signed. <strong>IXpsSignature::Verify</strong> does not verify any of the certificates that were used to sign the document content.</p>
<p>For more information about certificates and cryptography, see <a href="/windows/desktop/SecCrypto/about-cryptography">About Cryptography</a>.</p>
<p>For an example of how to verify document signatures in a program, see <a href="verify-document-signatures.html">Verify Document Signatures and Certificates</a>.</p>
<h3>Digital Signature Signing Policy</h3>
<p>The digital signature signing policy determines which parts of an XPS document are signed. One signing policy option is to sign the signature relationships that start from the signature origin part. Because the signature relationships change with each signature that is added, signatures that are made under this policy will break when new signatures are added. Make sure that you understand clearly the implications and effects of setting this policy; otherwise, unexpected or undesired behavior might result.</p>
<p>For more information about signing policies, see <a href="/windows/win32/api/xpsdigitalsignature/ne-xpsdigitalsignature-xps_sign_policy"><strong>XPS_SIGN_POLICY</strong></a>.</p>
<h3>Embedding a Certificate Chain</h3>
<p>The certificates that make up the trust chain of a specific certificate can be added to an XPS document. Embedding these certificates can make it easier, in off-line scenarios, for an application to verify the certificates that a digital signature uses.</p>
<p>For more information about how to embed certificates in an XPS document, see <a href="embedding-certificate-trust-chains-in-a-document.html">Embed Certificate Chains in a Document</a>.</p>
<h3>Using the CERT_CONTEXT Structure</h3>
<p>The <a href="/windows/desktop/api/wincrypt/ns-wincrypt-cert_context"><strong>CERT_CONTEXT</strong></a> and <a href="/windows/desktop/api/wincrypt/ns-wincrypt-cert_info"><strong>CERT_INFO</strong></a> structures are the main data structures that hold certificate information. For more information about using these structures, see <a href="/windows/desktop/SecCrypto/using-a-cert-info-data-structure">Using a CERT_INFO Data Structure</a>.</p>
<p><a href="/windows/desktop/api/wincrypt/ns-wincrypt-cert_context"><strong>CERT_CONTEXT</strong></a> structures that are returned by Crypto API functions must be released when they are no longer needed. To release a <strong>CERT_CONTEXT</strong> structure, call the <a href="/windows/desktop/api/wincrypt/nf-wincrypt-certfreecertificatecontext"><strong>CertFreeCertificateContext</strong></a> function.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="basic-digital-signature-programming-tasks.html">Common Digital Signature Programming Tasks</a></p>
<!-- raw HTML omitted -->
<p><a href="advanced-digital-signature-programming-tasks.html">Additional Digital Signature Programming Tasks</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/wincrypt/ns-wincrypt-cert_context"><strong>CERT_CONTEXT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/wincrypt/ns-wincrypt-cert_info"><strong>CERT_INFO</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/wincrypt/nf-wincrypt-certfreecertificatecontext"><strong>CertFreeCertificateContext</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/xpsdigitalsignature/ne-xpsdigitalsignature-xps_sign_policy"><strong>XPS_SIGN_POLICY</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="https://en.wikipedia.org/wiki/Open_XML_Paper_Specification">XML Paper Specification</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
