<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GetPrinterDriver2 function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The GetPrinterDriver2 function retrieves driver data for the specified printer. If the driver is not installed on the local computer, GetPrinterDriver2 installs it and displays any user interface to the specified window.
ms.assetid: 0d482d28-7668-4734-ba71-5b355c18ddec
title: GetPrinterDriver2 function (Winspool.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>GetPrinterDriver2</li>
<li>GetPrinterDriver2W
api_type:</li>
<li>DllExport
api_location:</li>
<li>Winspool.drv</li>
</ul>
<hr />
<h1>GetPrinterDriver2 function</h1>
<p>The <strong>GetPrinterDriver2</strong> function retrieves driver data for the specified printer. If the driver is not installed on the local computer, <strong>GetPrinterDriver2</strong> installs it and displays any user interface to the specified window.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>BOOL GetPrinterDriver2(
  _In_opt_ HWND    hWnd,
  _In_     HANDLE  hPrinter,
  _In_opt_ LPTSTR  pEnvironment,
  _In_     DWORD   Level,
  _Out_    LPBYTE  pDriverInfo,
  _In_     DWORD   cbBuf,
  _Out_    LPDWORD pcbNeeded
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hWnd</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A handle of the window that will be used as the parent window of any user interface, such as a dialog box, that the driver displays during installation. If the value of this parameter is <strong>NULL</strong>, the driver's user interface will still be displayed to the user during installation, but it will not have a parent window.</p>
<!-- raw HTML omitted -->
<p><em>hPrinter</em> [in]</p>
<!-- raw HTML omitted -->
<p>A handle to the printer for which the driver data should be retrieved. Use the <a href="openprinter.html"><strong>OpenPrinter</strong></a> or <a href="addprinter.html"><strong>AddPrinter</strong></a> function to retrieve a printer handle.</p>
<!-- raw HTML omitted -->
<p><em>pEnvironment</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a null-terminated string that specifies the environment (for example, Windows x86, Windows IA64, or Windows x64). If this parameter is <strong>NULL</strong>, the current environment of the calling application and client machine (not of the destination application and print server) is used.</p>
<!-- raw HTML omitted -->
<p><em>Level</em> [in]</p>
<!-- raw HTML omitted -->
<p>The printer driver structure returned in the <em>pDriverInfo</em> buffer. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>1</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="driver-info-1.html"><strong>DRIVER_INFO_1</strong></a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>2</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="driver-info-2.html"><strong>DRIVER_INFO_2</strong></a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>3</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="driver-info-3.html"><strong>DRIVER_INFO_3</strong></a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>4</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="driver-info-4.html"><strong>DRIVER_INFO_4</strong></a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>5</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="driver-info-5.html"><strong>DRIVER_INFO_5</strong></a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>6</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="driver-info-6.html"><strong>DRIVER_INFO_6</strong></a><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>8</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="driver-info-8.html"><strong>DRIVER_INFO_8</strong></a><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>pDriverInfo</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to a buffer that receives a structure containing information about the driver, as specified by <em>Level</em>. The buffer must be large enough to store the strings pointed to by the structure members.</p>
<p>To determine the required buffer size, call <strong>GetPrinterDriver2</strong> with <em>cbBuf</em> set to zero. <strong>GetPrinterDriver2</strong> fails, <a href="/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a> returns <strong>ERROR_INSUFFICIENT_BUFFER</strong>, and the <em>pcbNeeded</em> parameter returns the size, in bytes, of the buffer required to hold the array of structures and their data.</p>
<!-- raw HTML omitted -->
<p><em>cbBuf</em> [in]</p>
<!-- raw HTML omitted -->
<p>The size, in bytes, of the array at which <em>pDriverInfo</em> points.</p>
<!-- raw HTML omitted -->
<p><em>pcbNeeded</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to a value that receives the number of bytes copied if the function succeeds or the number of bytes required if <em>cbBuf</em> is too small.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, the return value is a nonzero value.</p>
<p>If the function fails, the return value is zero. To get the return status, call <a href="/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a>.</p>
<h2>Remarks</h2>
<p>The <a href="driver-info-2.html"><strong>DRIVER_INFO_2</strong></a>, <a href="driver-info-3.html"><strong>DRIVER_INFO_3</strong></a>, <a href="driver-info-4.html"><strong>DRIVER_INFO_4</strong></a>, <a href="driver-info-5.html"><strong>DRIVER_INFO_5</strong></a>, <a href="driver-info-6.html"><strong>DRIVER_INFO_6</strong></a>, and <a href="driver-info-8.html"><strong>DRIVER_INFO_8</strong></a> structures contain the file name or the full path and file name of the printer driver in the <strong>pDriverPath</strong> member. An application can use the path and file name to load a printer driver by calling the <a href="/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya"><strong>LoadLibrary</strong></a> function and supplying the path and file name as the single argument.</p>
<p>The ANSI version of this function, <strong>GetPrinterDriver2A</strong> is not supported and returns <strong>ERROR_NOT_SUPPORTED</strong>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winspool.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winspool.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winspool.drv<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Unicode and ANSI names<!-- raw HTML omitted --></td>
<td><strong>GetPrinterDriver2W</strong> (Unicode)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="printdocs-printing.html">Printing</a></p>
<!-- raw HTML omitted -->
<p><a href="printing-and-print-spooler-functions.html">Print Spooler API Functions</a></p>
<!-- raw HTML omitted -->
<p><a href="addprinterdriver.html"><strong>AddPrinterDriver</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="driver-info-1.html"><strong>DRIVER_INFO_1</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="driver-info-2.html"><strong>DRIVER_INFO_2</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="driver-info-3.html"><strong>DRIVER_INFO_3</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="driver-info-4.html"><strong>DRIVER_INFO_4</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="driver-info-5.html"><strong>DRIVER_INFO_5</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="driver-info-6.html"><strong>DRIVER_INFO_6</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="enumprinterdrivers.html"><strong>EnumPrinterDrivers</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="getprinterdriver.html"><strong>GetPrinterDriver</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="openprinter.html"><strong>OpenPrinter</strong></a></p>
<!-- raw HTML omitted -->
</body>
