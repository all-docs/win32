<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Initialize an XPS OM</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Describes how to initialize an XPS OM, which allows a program to create an XPS document.
ms.assetid: 920d940f-5ae2-4376-8c7b-0cef04f21df7
title: Initialize an XPS OM
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Initialize an XPS OM</h1>
<p>Describes how to initialize an XPS OM, which allows a program to create an XPS document.</p>
<p>The interfaces of the XPS Document API are created by an <a href="/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomobjectfactory"><strong>IXpsOMObjectFactory</strong></a> interface. To obtain a pointer to an <strong>IXpsOMObjectFactory</strong> that can be used in your program, call <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a>.</p>
<p>Before using the following code examples in your program, read the disclaimer in <a href="common-xps-document-tasks.html">Common XPS Document Programming Tasks</a>.</p>
<h2>Code Example</h2>
<p>The following example creates the object factory that will be used to create XPS OM interfaces in other examples.</p>
<pre lang="C++"><code>    IXpsOMObjectFactory *xpsFactory;

    HRESULT hr = S_OK;

    // Init COM for this thread if it hasn't 
    //  been initialized, yet.
    hr = CoInitializeEx(0, COINIT_MULTITHREADED);

    hr = CoCreateInstance(
        __uuidof(XpsOMObjectFactory),
        NULL, 
        CLSCTX_INPROC_SERVER,
        __uuidof(IXpsOMObjectFactory),
        reinterpret_cast&lt;LPVOID*&gt;(&amp;xpsFactory));

    if (SUCCEEDED(hr))
    {
        // Make sure that you got a pointer 
        //  to the interface.

        // Use object factory...

        // ... and release when done
        xpsFactory-&gt;Release();
    }

    // Uninitialize COM when finished
    CoUninitialize();
</code></pre>
<h2>Best Practices</h2>
<p>You can make your program more efficient by obtaining a pointer to an <a href="/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomobjectfactory"><strong>IXpsOMObjectFactory</strong></a> interface the first time that you need to call <strong>IXpsOMObjectFactory</strong> to create an interface, and then saving the pointer for use in other areas of the program. When the program no longer needs the object factory, or will not need it for a while, the pointer can be released.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><strong>Next Steps</strong></p>
<!-- raw HTML omitted -->
<p><a href="create-a-blank-xps-om.html">Create a Blank XPS OM</a></p>
<!-- raw HTML omitted -->
<p><strong>Used in This Section</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomobjectfactory"><strong>IXpsOMObjectFactory</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>For More Information</strong></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/opc/packaging">Packaging</a></p>
<!-- raw HTML omitted -->
<p><a href="xps-programming-reference.html">XPS Document API Reference</a></p>
<!-- raw HTML omitted -->
<p><a href="https://en.wikipedia.org/wiki/Open_XML_Paper_Specification">XML Paper Specification</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
