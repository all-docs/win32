<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GetPrinter function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The GetPrinter function retrieves information about a specified printer.
ms.assetid: f162edbb-83ee-40c3-8710-9c867301d652
title: GetPrinter function (Winspool.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>GetPrinter</li>
<li>GetPrinterA</li>
<li>GetPrinterW
api_type:</li>
<li>DllExport
api_location:</li>
<li>Winspool.drv</li>
<li>Ext-MS-Win-printer-Winspool-l1-1-0.dll</li>
<li>Ext-MS-Win-printer-Winspool-l1-1-1.dll</li>
<li>Ext-MS-Win-Printer-WinSpool-l1-1-2.dll</li>
<li>Ext-MS-Win-Printer-WinSpool-L1-1-3.dll</li>
</ul>
<hr />
<h1>GetPrinter function</h1>
<p>The <strong>GetPrinter</strong> function retrieves information about a specified printer.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>BOOL GetPrinter(
  _In_  HANDLE  hPrinter,
  _In_  DWORD   Level,
  _Out_ LPBYTE  pPrinter,
  _In_  DWORD   cbBuf,
  _Out_ LPDWORD pcbNeeded
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hPrinter</em> [in]</p>
<!-- raw HTML omitted -->
<p>A handle to the printer for which the function retrieves information. Use the <a href="openprinter.html"><strong>OpenPrinter</strong></a> or <a href="addprinter.html"><strong>AddPrinter</strong></a> function to retrieve a printer handle.</p>
<!-- raw HTML omitted -->
<p><em>Level</em> [in]</p>
<!-- raw HTML omitted -->
<p>The level or type of structure that the function stores into the buffer pointed to by <em>pPrinter</em>.</p>
<p>This value can be 1, 2, 3, 4, 5, 6, 7, 8 or 9.</p>
<!-- raw HTML omitted -->
<p><em>pPrinter</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to a buffer that receives a structure containing information about the specified printer. The buffer must be large enough to receive the structure and any strings or other data to which the structure members point. If the buffer is too small, the <em>pcbNeeded</em> parameter returns the required buffer size.</p>
<p>The type of structure is determined by the value of <em>Level</em>.</p>
<table>
<thead>
<tr>
<th>Level</th>
<th>Structure</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>1</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-1.html"><strong>PRINTER_INFO_1</strong></a> structure containing general printer information.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>2</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-2.html"><strong>PRINTER_INFO_2</strong></a> structure containing detailed information about the printer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>3</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-3.html"><strong>PRINTER_INFO_3</strong></a> structure containing the printer's security information.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>4</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-4.html"><strong>PRINTER_INFO_4</strong></a> structure containing minimal printer information, including the name of the printer, the name of the server, and whether the printer is remote or local.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>5</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-5.html"><strong>PRINTER_INFO_5</strong></a> structure containing printer information such as printer attributes and time-out settings.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>6</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-6.html"><strong>PRINTER_INFO_6</strong></a> structure specifying the status value of a printer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>7</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-7.html"><strong>PRINTER_INFO_7</strong></a> structure that indicates whether the printer is published in the directory service.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>8</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-8.html"><strong>PRINTER_INFO_8</strong></a> structure specifying the global default printer settings.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>9</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-9.html"><strong>PRINTER_INFO_9</strong></a> structure specifying the per-user default printer settings.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>cbBuf</em> [in]</p>
<!-- raw HTML omitted -->
<p>The size, in bytes, of the buffer pointed to by <em>pPrinter</em>.</p>
<!-- raw HTML omitted -->
<p><em>pcbNeeded</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that the function sets to the size, in bytes, of the printer information. If <em>cbBuf</em> is smaller than this value, <strong>GetPrinter</strong> fails, and the value represents the required buffer size. If <em>cbBuf</em> is equal to or greater than this value, <strong>GetPrinter</strong> succeeds, and the value represents the number of bytes stored in the buffer.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, the return value is a nonzero value.</p>
<p>If the function fails, the return value is zero.</p>
<h2>Remarks</h2>
<blockquote>
<p>[!Note]<br />
This is a blocking or synchronous function and might not return immediately. How quickly this function returns depends on run-time factors such as network status, print server configuration, and printer driver implementation factors that are difficult to predict when writing an application. Calling this function from a thread that manages interaction with the user interface could make the application appear to be unresponsive.</p>
</blockquote>
<p>The <strong>pDevMode</strong> member in the <a href="printer-info-2.html"><strong>PRINTER_INFO_2</strong></a>, <a href="printer-info-8.html"><strong>PRINTER_INFO_8</strong></a>, and <a href="printer-info-9.html"><strong>PRINTER_INFO_9</strong></a> structures can be <strong>NULL</strong>. When this happens, the printer is unusable until the driver is reinstalled successfully.</p>
<p>For the <a href="printer-info-2.html"><strong>PRINTER_INFO_2</strong></a> and <a href="printer-info-3.html"><strong>PRINTER_INFO_3</strong></a> structures that contain a pointer to a security descriptor, the function retrieves only those components of the security descriptor that the caller has permission to read. To retrieve particular security descriptor components, you must specify the necessary access rights when you call the <a href="openprinter.html"><strong>OpenPrinter</strong></a> function to retrieve a handle to the printer. The following table shows the access rights required to read the various security descriptor components.</p>
<table>
<thead>
<tr>
<th>Access Right</th>
<th>Security Descriptor Component</th>
</tr>
</thead>
<tbody>
<tr>
<td>READ_CONTROL<!-- raw HTML omitted --></td>
<td>Owner<!-- raw HTML omitted --> Primary group<!-- raw HTML omitted --> Discretionary access-control list (DACL)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>ACCESS_SYSTEM_SECURITY<!-- raw HTML omitted --></td>
<td>System access-control list (SACL)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>If you specify level 7, the <strong>dwAction</strong> member of <a href="printer-info-7.html"><strong>PRINTER_INFO_7</strong></a> returns one of the following values to indicate whether the printer is published in the directory service.</p>
<table>
<thead>
<tr>
<th>dwAction value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>DSPRINT_PUBLISH</td>
<td>The printer is published. The <strong>pszObjectGUID</strong> member contains the GUID of the directory services print queue object associated with the printer.</td>
</tr>
<tr>
<td>DSPRINT_UNPUBLISH</td>
<td>The printer is not published.</td>
</tr>
<tr>
<td>DSPRINT_PENDING</td>
<td>Indicates that the system is attempting to complete a publish or unpublish operation. If a <a href="setprinter.html"><strong>SetPrinter</strong></a> call fails to publish or unpublish a printer, the system makes further attempts to complete the operation in the background.</td>
</tr>
</tbody>
</table>
<p>Starting with Windows Vista, the printer data returned by <strong>GetPrinter</strong> is retrieved from a local cache when <em>hPrinter</em> refers to a printer hosted by a print server and there is at least one open connection to the print server. In all other configurations, the printer data is queried from the print server.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winspool.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winspool.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winspool.drv<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Unicode and ANSI names<!-- raw HTML omitted --></td>
<td><strong>GetPrinterW</strong> (Unicode) and <strong>GetPrinterA</strong> (ANSI)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="printdocs-printing.html">Printing</a></p>
<!-- raw HTML omitted -->
<p><a href="printing-and-print-spooler-functions.html">Print Spooler API Functions</a></p>
<!-- raw HTML omitted -->
<p><a href="abortprinter.html"><strong>AbortPrinter</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="addprinter.html"><strong>AddPrinter</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="closeprinter.html"><strong>ClosePrinter</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="deleteprinter.html"><strong>DeletePrinter</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="enumprinters.html"><strong>EnumPrinters</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-1.html"><strong>PRINTER_INFO_1</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-2.html"><strong>PRINTER_INFO_2</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-3.html"><strong>PRINTER_INFO_3</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-4.html"><strong>PRINTER_INFO_4</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-5.html"><strong>PRINTER_INFO_5</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-7.html"><strong>PRINTER_INFO_7</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-8.html"><strong>PRINTER_INFO_8</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-9.html"><strong>PRINTER_INFO_9</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="openprinter.html"><strong>OpenPrinter</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="setprinter.html"><strong>SetPrinter</strong></a></p>
<!-- raw HTML omitted -->
</body>
