<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Write an XPS OM to an XPS Document</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Describes how to write the contents of an XPS OM in a program to an XPS document file.
ms.assetid: 8bee8059-b901-4a99-a7e4-60dad831c239
title: Write an XPS OM to an XPS Document
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Write an XPS OM to an XPS Document</h1>
<p>Describes how to write the contents of an XPS OM in a program to an XPS document file.</p>
<p>If a program has an XPS OM that contains a complete document, the program can write the XPS OM to a file as an XPS document, by calling the <a href="/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetofile"><strong>WriteToFile</strong></a> method of the <a href="/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage"><strong>IXpsOMPackage</strong></a> interface.</p>
<p>Before using these code examples in a program, read the disclaimer in <a href="common-xps-document-tasks.html">Common XPS Document Programming Tasks</a>.</p>
<h2>Writing a complete XPS OM to an XPS document</h2>
<p>After you set the contents of an XPS OM, you can save the XPS OM to a file as an XPS document, by calling the <a href="/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetofile"><strong>WriteToFile</strong></a> method of the <a href="/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage"><strong>IXpsOMPackage</strong></a> interface.</p>
<pre lang="C++"><code>    HRESULT hr = S_OK;

    hr = xpsPackage-&gt;WriteToFile(
        fileName,
        NULL,                    // LPSECURITY_ATTRIBUTES
        FILE_ATTRIBUTE_NORMAL,
        FALSE                    // Optimize Markup Size
        );

</code></pre>
<blockquote>
<p>[!Note]<br />
Writing an XPS OM to a file or stream does not automatically create a thumbnail for the XPS document. To create a thumbnail of the XPS document, use the <a href="/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomthumbnailgenerator"><strong>IXpsOMThumbnailGenerator</strong></a> interface.</p>
</blockquote>
<p>Â </p>
<h2>Incrementally writing an XPS document</h2>
<p>The <a href="/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter"><strong>IXpsOMPackageWriter</strong></a> interface can be used to write the parts of an XPS document incrementally; for example, when the document parts are created or processed in sequence.</p>
<blockquote>
<p>[!Note]<br />
Writing an XPS OM to a file or stream does not automatically create a thumbnail for the XPS document. To create a thumbnail of the XPS document, use the <a href="/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomthumbnailgenerator"><strong>IXpsOMThumbnailGenerator</strong></a> interface.</p>
</blockquote>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><strong>Next Steps</strong></p>
<!-- raw HTML omitted -->
<p><a href="print-an-xps-om.html">Print an XPS OM</a></p>
<!-- raw HTML omitted -->
<p><strong>Used in This Section</strong></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/api/msopc/nn-msopc-iopcparturi"><strong>IOpcPartUri</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage"><strong>IXpsOMPackage</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomthumbnailgenerator"><strong>IXpsOMThumbnailGenerator</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>For More Information</strong></p>
<!-- raw HTML omitted -->
<p><a href="xps-object-model-initialization.html">Initialize an XPS OM</a></p>
<!-- raw HTML omitted -->
<p><a href="xps-programming-reference.html">XPS Document API Reference</a></p>
<!-- raw HTML omitted -->
<p><a href="https://en.wikipedia.org/wiki/Open_XML_Paper_Specification">XML Paper Specification</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
