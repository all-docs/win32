<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Read an XPS Document into an XPS OM</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Describes how to read an existing XPS document from a file into an XPS OM.
ms.assetid: 92a8d19f-1c9e-4e02-a3d4-f2869ec871df
title: Read an XPS Document into an XPS OM
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Read an XPS Document into an XPS OM</h1>
<p>Describes how to read an existing XPS document from a file into an XPS OM.</p>
<p>To create an XPS OM from an XPS document, call the <a href="/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagefromfile"><strong>IXpsOMObjectFactory::CreatePackageFromFile</strong></a> method.</p>
<p>Before using these code examples in your program, read the disclaimer in <a href="common-xps-document-tasks.html">Common XPS Document Programming Tasks</a>.</p>
<h2>Code Example</h2>
<p>The following code example assumes that the initialization described in <a href="xps-object-model-initialization.html">Initialize an XPS OM</a> has succeeded.</p>
<pre lang="C++"><code>    IXpsOMPackage *package = NULL;

    hr = xpsFactory-&gt;CreatePackageFromFile(
        xpsDocumentFilename,
        FALSE,
        &amp;package);

    // package now contains a pointer to the IXpsOMPackage
    // object that has been populated with the contents
    // of the XPS document in xpsDocumentFilename.

    // When finished with the package, release the object.
    if (NULL != package) package-&gt;Release();
</code></pre>
<p>To create an XPS OM from an XPS document that is stored as a stream, call <a href="/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagefromstream"><strong>IXpsOMObjectFactory::CreatePackageFromStream</strong></a>.</p>
<h2>Remarks</h2>
<p>If you write an XPS OM immediately after you have read an XPS package into it, some of the original content might be lost or changed.</p>
<p>Some of the changes that can occur in such case are listed in the table that follows:</p>
<table>
<thead>
<tr>
<th>Document feature</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>Digital signatures<!-- raw HTML omitted --></td>
<td>Removed from the document<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DiscardControl part<!-- raw HTML omitted --></td>
<td>Removed from the document<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Foreign document parts<!-- raw HTML omitted --></td>
<td>Removed from the document<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>FixedPage markup<!-- raw HTML omitted --></td>
<td>Modified from the original<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Resource dictionary markup<!-- raw HTML omitted --></td>
<td>Modified from the original, if Optimization flag is set<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><strong>Next Steps</strong></p>
<!-- raw HTML omitted -->
<p><a href="navigate-the-xps-om.html">Navigate the XPS OM</a></p>
<!-- raw HTML omitted -->
<p><a href="write-text-to-an-xps-om.html">Write Text to an XPS OM</a></p>
<!-- raw HTML omitted -->
<p><a href="draw-graphics-in-an-xps-om.html">Draw Graphics in an XPS OM</a></p>
<!-- raw HTML omitted -->
<p><a href="place-images-in-an-xps-om.html">Place Images in an XPS OM</a></p>
<!-- raw HTML omitted -->
<p><strong>Used in This Section</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomobjectfactory"><strong>IXpsOMObjectFactory</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage"><strong>IXpsOMPackage</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>For More Information</strong></p>
<!-- raw HTML omitted -->
<p><a href="xps-object-model-initialization.html">Initialize an XPS OM</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/opc/packaging">Packaging API</a></p>
<!-- raw HTML omitted -->
<p><a href="xps-programming-reference.html">XPS Document API Reference</a></p>
<!-- raw HTML omitted -->
<p><a href="https://en.wikipedia.org/wiki/Open_XML_Paper_Specification">XML Paper Specification</a></p>
<!-- raw HTML omitted -->
</body>
