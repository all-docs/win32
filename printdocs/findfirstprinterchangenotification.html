<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>FindFirstPrinterChangeNotification function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The FindFirstPrinterChangeNotification function creates a change notification object and returns a handle to the object. You can then use this handle in a call to one of the wait functions to monitor changes to the printer or print server.
ms.assetid: 4155ef5c-cd96-4960-919b-d9a495bb73a5
title: FindFirstPrinterChangeNotification function (Winspool.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>FindFirstPrinterChangeNotification
api_type:</li>
<li>DllExport
api_location:</li>
<li>Spoolss.dll</li>
</ul>
<hr />
<h1>FindFirstPrinterChangeNotification function</h1>
<p>The <strong>FindFirstPrinterChangeNotification</strong> function creates a change notification object and returns a handle to the object. You can then use this handle in a call to one of the wait functions to monitor changes to the printer or print server.</p>
<p>The <strong>FindFirstPrinterChangeNotification</strong> call specifies the type of changes to be monitored. You can specify a set of conditions to monitor for changes, a set of printer information fields to monitor, or both.</p>
<p>A wait operation on the change notification handle succeeds when one of the specified changes occurs in the specified printer or print server. You then call the <a href="findnextprinterchangenotification.html"><strong>FindNextPrinterChangeNotification</strong></a> function to retrieve information about the change, and to reset the change notification object for use in the next wait operation.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HANDLE FindFirstPrinterChangeNotification(
  _In_     HANDLE hPrinter,
           DWORD  fdwFilter,
           DWORD  fdwOptions,
  _In_opt_ LPVOID pPrinterNotifyOptions
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hPrinter</em> [in]</p>
<!-- raw HTML omitted -->
<p>A handle to the printer or print server that you want to monitor. Use the <a href="openprinter.html"><strong>OpenPrinter</strong></a> or <a href="addprinter.html"><strong>AddPrinter</strong></a> function to retrieve a printer handle.</p>
<!-- raw HTML omitted -->
<p><em>fdwFilter</em></p>
<!-- raw HTML omitted -->
<p>The conditions that will cause the change notification object to enter a signaled state. A change notification occurs when one or more of the specified conditions are met. The <em>fdwFilter</em> parameter can be zero if <em>pPrinterNotifyOptions</em> is non-<strong>NULL</strong>.</p>
<p>This parameter can be one or more of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_CHANGE_FORM</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Notify of any changes to a form. You can set this general flag or one or more of the following specific flags:<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_ADD_FORM<!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_SET_FORM<!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_DELETE_FORM<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_CHANGE_JOB</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Notify of any changes to a job. You can set this general flag or one or more of the following specific flags:<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_ADD_JOB<!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_SET_JOB<!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_DELETE_JOB<!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_WRITE_JOB<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_CHANGE_PORT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Notify of any changes to a port. You can set this general flag or one or more of the following specific flags:<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_ADD_PORT<!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_CONFIGURE_PORT <!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_DELETE_PORT<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_CHANGE_PRINT_PROCESSOR</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Notify of any changes to a print processor. You can set this general flag or one or more of the following specific flags: <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_ADD_PRINT_PROCESSOR <!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_DELETE_PRINT_PROCESSOR<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_CHANGE_PRINTER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Notify of any changes to a printer. You can set this general flag or one or more of the following specific flags:<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_ADD_PRINTER<!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_SET_PRINTER<!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_DELETE_PRINTER<!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_FAILED_CONNECTION_PRINTER<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_CHANGE_PRINTER_DRIVER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Notify of any changes to a printer driver. You can set this general flag or one or more of the following specific flags:<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_ADD_PRINTER_DRIVER<!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_SET_PRINTER_DRIVER<!-- raw HTML omitted --> <!-- raw HTML omitted -->PRINTER_CHANGE_DELETE_PRINTER_DRIVER<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_CHANGE_ALL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Notify if any of the preceding changes occur.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_CHANGE_SERVER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Windows 7: Notify of any changes to the server.<!-- raw HTML omitted --> This flag is not included in the changes monitored by setting the <strong>PRINTER_CHANGE_ALL</strong> value.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>For descriptions of the more specific flags in the preceding table, see the <a href="findnextprinterchangenotification.html"><strong>FindNextPrinterChangeNotification</strong></a> function.</p>
<!-- raw HTML omitted -->
<p><em>fdwOptions</em></p>
<!-- raw HTML omitted -->
<p>The flag that determines the category of printers for which notifications will work.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_NOTIFY_CATEGORY_ALL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x001000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="findnextprinterchangenotification.html"><strong>FindNextPrinterChangeNotification</strong></a> returns notifications for both 2D and 3D printers.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_NOTIFY_CATEGORY_3D</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x002000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="findnextprinterchangenotification.html"><strong>FindNextPrinterChangeNotification</strong></a> returns notifications only for 3D printers.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>When this flag is set to zero (0), <strong>FindFirstPrinterChangeNotification</strong> will only work for 2D printers. This is the default value.</p>
<!-- raw HTML omitted -->
<p><em>pPrinterNotifyOptions</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>A pointer to a <a href="printer-notify-options.html"><strong>PRINTER_NOTIFY_OPTIONS</strong></a> structure. The <strong>pTypes</strong> member of this structure is an array of one or more <a href="printer-notify-options-type.html"><strong>PRINTER_NOTIFY_OPTIONS_TYPE</strong></a> structures, each of which specifies a printer information field to monitor. A change notification occurs when one or more of the specified fields changes. When a change occurs, the <a href="findnextprinterchangenotification.html"><strong>FindNextPrinterChangeNotification</strong></a> function can retrieve the new printer information. This parameter can be <strong>NULL</strong> if <em>fdwFilter</em> is nonzero.</p>
<p>For a list of fields that can be monitored, see <a href="printer-notify-options-type.html"><strong>PRINTER_NOTIFY_OPTIONS_TYPE</strong></a>.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, the return value is a handle to a change notification object associated with the specified printer or print server.</p>
<p>If the function fails, the return value is INVALID_HANDLE_VALUE.</p>
<h2>Remarks</h2>
<blockquote>
<p>[!Note]<br />
This is a blocking or synchronous function and might not return immediately. How quickly this function returns depends on run-time factors such as network status, print server configuration, and printer driver implementation factors that are difficult to predict when writing an application. Calling this function from a thread that manages interaction with the user interface could make the application appear to be unresponsive.</p>
</blockquote>
<p>To monitor a printer or print server, call the <strong>FindFirstPrinterChangeNotification</strong> function, then use the returned change notification object handle in a call to one of the <a href="/windows/desktop/Sync/wait-functions">wait functions</a>. A wait operation on a change notification object is satisfied when the change notification object enters the signaled state. The system signals the object when one or more of the changes specified by <em>fdwFilter</em> or <em>pPrinterNotifyOptions</em> occurs in the monitored printer or print server.</p>
<p>When you call <strong>FindFirstPrinterChangeNotification</strong>, either <em>fdwFilter</em> must be nonzero or <em>pPrinterNotifyOptions</em> must be non-<strong>NULL</strong>. If both are specified, notifications will occur for both.</p>
<p>When a wait operation on a printer change notification object is satisfied, call the <a href="findnextprinterchangenotification.html"><strong>FindNextPrinterChangeNotification</strong></a> function to determine the cause of the notification. For a condition specified by <em>fdwFilter</em>, <strong>FindNextPrinterChangeNotification</strong> reports the condition or conditions that changed. For a printer information field specified by <em>pPrinterNotifyOptions</em>, <strong>FindNextPrinterChangeNotification</strong> reports the field or fields that changed as well as the new information for these fields. <strong>FindNextPrinterChangeNotification</strong> also resets the change notification object to the nonsignaled state so you can use it in another wait operation to continue monitoring the printer or print server.</p>
<p>With one exception, do not call the <a href="findnextprinterchangenotification.html"><strong>FindNextPrinterChangeNotification</strong></a> function if the change notification object is not in the signaled state. If the wait function returns the value WAIT_TIMEOUT, the change object is not in the signaled state. Call the <strong>FindNextPrinterChangeNotification</strong> function only if the wait function succeeds without timing out. The exception is when <strong>FindNextPrinterChangeNotification</strong> is called with the PRINTER_NOTIFY_OPTIONS_REFRESH bit set in the <em>pPrinterNotifyOptions</em> parameter.</p>
<p>When you no longer need the change notification object, close it by calling the <a href="findcloseprinterchangenotification.html"><strong>FindClosePrinterChangeNotification</strong></a> function.</p>
<p>Callers of <strong>FindFirstPrinterChangeNotification</strong> must ensure that the printer handle passed into <strong>FindFirstPrinterChangeNotification</strong> remains valid until <a href="findcloseprinterchangenotification.html"><strong>FindClosePrinterChangeNotification</strong></a> is called. If the printer handle is closed before the printer change notification handle, further notifications will fail to be delivered.</p>
<p><strong>FindFirstPrinterChangeNotification</strong> will not send change notifications for 3D printers to server handles.</p>
<blockquote>
<p>[!Note]<br />
In Windows XP with Service Pack 2 (SP2) and later, the Internet Connection Firewall (ICF) blocks printer ports by default, but an exception for File and Print Sharing can be enabled. If a user makes a printer connection to another machine, and the exception is not enabled, then the user will not receive printer change notifications from the server. A machine admin will have to enable exception.</p>
</blockquote>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winspool.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winspool.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Spoolss.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="printdocs-printing.html">Printing</a></p>
<!-- raw HTML omitted -->
<p><a href="printing-and-print-spooler-functions.html">Print Spooler API Functions</a></p>
<!-- raw HTML omitted -->
<p><a href="findcloseprinterchangenotification.html"><strong>FindClosePrinterChangeNotification</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="findnextprinterchangenotification.html"><strong>FindNextPrinterChangeNotification</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="openprinter.html"><strong>OpenPrinter</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-notify-options.html"><strong>PRINTER_NOTIFY_OPTIONS</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-notify-options-type.html"><strong>PRINTER_NOTIFY_OPTIONS_TYPE</strong></a></p>
<!-- raw HTML omitted -->
</body>
