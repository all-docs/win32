<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CommitSpoolData function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The CommitSpoolData function notifies the print spooler that a specified amount of data has been written to a specified spool file and is ready to be rendered.
ms.assetid: cb8899e0-2fdf-4928-adff-17ef5af39f63
title: CommitSpoolData function (Winspool.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>CommitSpoolData
api_type:</li>
<li>DllExport
api_location:</li>
<li>WinSpool.drv</li>
</ul>
<hr />
<h1>CommitSpoolData function</h1>
<p>The <strong>CommitSpoolData</strong> function notifies the print spooler that a specified amount of data has been written to a specified spool file and is ready to be rendered.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HANDLE CommitSpoolData(
  _In_ HANDLE hPrinter,
  _In_ HANDLE hSpoolFile,
       DWORD  cbCommit
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hPrinter</em> [in]</p>
<!-- raw HTML omitted -->
<p>A handle to the printer to which the job was submitted. This should be the same handle that was used to obtain <em>hSpoolFile</em> with <a href="getspoolfilehandle.html"><strong>GetSpoolFileHandle</strong></a>.</p>
<!-- raw HTML omitted -->
<p><em>hSpoolFile</em> [in]</p>
<!-- raw HTML omitted -->
<p>A handle to the spool file being changed. On the first call of <strong>CommitSpoolData</strong>, this should be the same handle that was returned by <a href="getspoolfilehandle.html"><strong>GetSpoolFileHandle</strong></a>. Subsequent calls to <strong>CommitSpoolData</strong> should pass the handle returned by the preceding call. See Remarks.</p>
<!-- raw HTML omitted -->
<p><em>cbCommit</em></p>
<!-- raw HTML omitted -->
<p>The number of bytes committed to the print spooler.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, it returns a handle to the spool file.</p>
<p>If the function fails, it returns INVALID_HANDLE_VALUE.</p>
<h2>Remarks</h2>
<p>Applications submitting a spooler print job can call <a href="getspoolfilehandle.html"><strong>GetSpoolFileHandle</strong></a> and then directly write data to the spool file handle by calling <a href="/windows/desktop/api/fileapi/nf-fileapi-writefile"><strong>WriteFile</strong></a>. To notify the print spooler that the file contains data which is ready to be rendered, the application must call <strong>CommitSpoolData</strong> and provide the number of available bytes.</p>
<p>If <strong>CommitSpoolData</strong> is called multiple times, each call must use the spool file handle returned by the previous call. When no more data will be written to the spool file, <a href="closespoolfilehandle.html"><strong>CloseSpoolFileHandle</strong></a> should be called for the file handle returned by the last call to <strong>CommitSpoolData</strong>.</p>
<p>Before calling <strong>CommitSpoolData</strong>, applications must set the file pointer to the position it had before it wrote data to the file. In the process of rendering the data in the spooler file, the print spooler will move the spool file pointer <em>cbCommit</em> bytes from the current value of file pointer.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winspool.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winspool.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WinSpool.drv<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="printdocs-printing.html">Printing</a></p>
<!-- raw HTML omitted -->
<p><a href="printing-and-print-spooler-functions.html">Print Spooler API Functions</a></p>
<!-- raw HTML omitted -->
<p><a href="getspoolfilehandle.html"><strong>GetSpoolFileHandle</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="closespoolfilehandle.html"><strong>CloseSpoolFileHandle</strong></a></p>
<!-- raw HTML omitted -->
</body>
