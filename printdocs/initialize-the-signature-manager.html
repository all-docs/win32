<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Initialize the Signature Manager</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This topic describes how to initialize the signature manager for use with an XPS document.
ms.assetid: 4c4c6e8f-4ee0-4089-a283-1082baee5054
title: Initialize the Signature Manager
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Initialize the Signature Manager</h1>
<p>This topic describes how to initialize the signature manager for use with an XPS document.</p>
<p>Before using the following code examples in your program, read the disclaimer in <a href="basic-digital-signature-programming-tasks.html">Common Digital Signature Programming Tasks</a>.</p>
<p>To use the WindowsÂ 7 features of the Crypto API, define the <strong>CRYPT_OID_INFO_HAS_EXTRA_FIELDS</strong> symbol as follows:</p>
<pre lang="C++"><code>#define CRYPT_OID_INFO_HAS_EXTRA_FIELDS
</code></pre>
<p>Next, instantiate an <a href="/windows/desktop/api/xpsdigitalsignature/nn-xpsdigitalsignature-ixpssignaturemanager"><strong>IXpsSignatureManager</strong></a> interface by calling <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a>, as shown in the following code example.</p>
<pre lang="C++"><code>IXpsSignatureManager    *newInterface;

// Note the implicit requirement that CoInitializeEx 
//  has previously been called from this thread.

hr = CoCreateInstance(
    __uuidof(XpsSignatureManager),
    NULL, 
    CLSCTX_INPROC_SERVER,
    __uuidof(IXpsSignatureManager),
    reinterpret_cast&lt;LPVOID*&gt;(&amp;newInterface));

// make sure that you got a pointer 
// to the interface
if (SUCCEEDED(hr)) {
    // Load document into signature manager from file.
    //  xpsDocument is initialized with the file name
    //  of the document to load outside of this example.
    hr = newInterface-&gt;LoadPackageFile (xpsDocument);

    // Use newInterface

    // Release interface pointers when finished with them 
    newInterface-&gt;Release();
}    
</code></pre>
<p>The interface instantiated by <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> can be used by only one XPS document, which must be loaded by calling <a href="/windows/desktop/api/xpsdigitalsignature/nf-xpsdigitalsignature-ixpssignaturemanager-loadpackagefile"><strong>LoadPackageFile</strong></a> or <a href="/windows/desktop/api/xpsdigitalsignature/nf-xpsdigitalsignature-ixpssignaturemanager-loadpackagestream"><strong>LoadPackageStream</strong></a> before calling any other method.</p>
<p>After the <a href="/windows/desktop/api/xpsdigitalsignature/nn-xpsdigitalsignature-ixpssignaturemanager"><strong>IXpsSignatureManager</strong></a> interface has been instantiated and an XPS document has been loaded, the signature manager is ready for use.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><strong>Next Steps</strong></p>
<!-- raw HTML omitted -->
<p><a href="sign-a-document.html">Sign a Document</a></p>
<!-- raw HTML omitted -->
<p><a href="add-a-signature-request-to-a-document.html">Add a Signature Request to an XPS Document</a></p>
<!-- raw HTML omitted -->
<p><a href="verify-document-signatures.html">Verify Document Signatures</a></p>
<!-- raw HTML omitted -->
<p><strong>Used in This Section</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/xpsdigitalsignature/nn-xpsdigitalsignature-ixpssignaturemanager"><strong>IXpsSignatureManager</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>For More Information</strong></p>
<!-- raw HTML omitted -->
<p><a href="xps-digital-signatures-errors.html">XPS Digital Signature API Errors</a></p>
<!-- raw HTML omitted -->
<p><a href="xps-document-errors.html">XPS Document Errors</a></p>
<!-- raw HTML omitted -->
<p><a href="https://en.wikipedia.org/wiki/Open_XML_Paper_Specification">XML Paper Specification</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
