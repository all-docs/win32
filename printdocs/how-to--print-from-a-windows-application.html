<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How To: Print from a Windows Program</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This section describes how to print from a native Windows program.
ms.assetid: D0AE8FF8-D02D-43D3-80CA-E13EAA894F87
title: 'How To: Print from a Windows Program'
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How To: Print from a Windows Program</h1>
<p>This section describes how to print from a native Windows program.</p>
<h2>Overview</h2>
<p>Printing is usually an integral part of a native Windows program. Therefore, it is not a feature that you can add easily after you have written the program. That being said, if the program is designed to use XPS documents it will not need much, if any, additional code to render the document content for printing. The XPS documents of the application can be sent directly to a printer that has an XPSDrv printer driver.</p>
<p>Use the <a href="/previous-versions/windows/desktop/dd316976(v=vs.85)">XPS Document API</a> to create the document content and the <a href="xps-printing.html">XPS Print API</a> to send the document content to the printer. The XPS Print API processes the document content for the destination printer. If the selected printer has an XPSDrv printer driver, the document will be sent to the printer without any additional conversion. If the selected printer has a GDI-based printer driver, the program can also send the content to the printer, and the XPS Print API converts the document content so that it will be compatible with the GDI-based printer driver. In either case, the processing that the application performs is the same.</p>
<h2>Printing tasks</h2>
<p>The following topics describe the basic steps of printing program content.</p>
<ol>
<li>
<p><strong>Collect print job information from user.</strong></p>
<p>Typically, a user initiates a print job when they select the print option from a menu and the program displays a print dialog box to collect the details of the print job. The user typically selects the printer, the number of copies, and printer configuration details such as two-sided printing and stapling.</p>
<p>For information about how to do this, see <a href="preparing-to-print.html">How To: Collect Print Job Information from the User</a>.</p>
</li>
<li>
<p><strong>Create progress indicator.</strong></p>
<p>A progress indicator provides the user with feedback about how the print job is progressing. The progress indicator can be a progress bar that is part of a dialog box that includes the <strong>Cancel</strong> button for the job, or it can be a progress bar in the status bar at the bottom of the main window.</p>
<p>For information about the progress indicator works, see <a href="cancel-dialog-box.html">How To: Display the Print Job Progress</a>.</p>
<p>For more ideas about how to display the progress of the print job, see the information in the <a href="/windows/desktop/windows-application-ui-development">Windows Application UI Development</a> guidelines.</p>
</li>
<li>
<p><strong>Start the printing thread.</strong></p>
<p>After the program has collected the print job information from the user, it can start the printing thread to perform the actual processing of the document for printing.</p>
<p>For information about the printing thread, see <a href="how-to--start-and-stop-a-printing-thread.html">How To: Start and Stop a Printing Thread</a>.</p>
</li>
<li>
<p><strong>Render print job data.</strong></p>
<p>The printing thread renders the document data for printing. You should break down this processing into discrete processing steps so that the user can interrupt the processing and cancel the job as well as to not allow the processing thread to block other threads and processes.</p>
<p>For information about how the renders the print job data, see <a href="how-to--render-the-print-job-data.html">How To: Render Print Job Data</a>.</p>
</li>
<li>
<p><strong>Monitor print job progress.</strong></p>
<p>As each processing step is performed, update the progress bar to inform the use. Compute the processing steps to complete the requested job and then updates the progress bar as those steps are performed.</p>
</li>
<li>
<p><strong>Close print job and terminate printing thread.</strong></p>
<p>After the program has sent the print job to the printer, or if the user has cancelled the print job, you must close the print job and release the resources used by the print job.</p>
</li>
</ol>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="preparing-to-print.html">How To: Collect Print Job Information from the User</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
