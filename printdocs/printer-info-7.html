<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PRINTER_INFO_7 structure</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The PRINTER_INFO_7 structure specifies directory services printer information.
ms.assetid: 9443855e-df7d-41a1-a0df-5649a97b2915
title: PRINTER_INFO_7 structure (Winspool.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>PRINTER_INFO_7</li>
<li>_PRINTER_INFO_7A</li>
<li>_PRINTER_INFO_7W
api_type:</li>
<li>HeaderDef
api_location:</li>
<li>Winspool.h</li>
</ul>
<hr />
<h1>PRINTER_INFO_7 structure</h1>
<p>The <strong>PRINTER_INFO_7</strong> structure specifies directory services printer information. Use this structure with the <a href="setprinter.html"><strong>SetPrinter</strong></a> function to publish a printer's data in the directory service (DS), or to update or remove a printer's published data from the DS. Use this structure with the <a href="getprinter.html"><strong>GetPrinter</strong></a> function to determine whether a printer is published in the DS.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>typedef struct _PRINTER_INFO_7 {
  LPTSTR pszObjectGUID;
  DWORD  dwAction;
} PRINTER_INFO_7, *PPRINTER_INFO_7;
</code></pre>
<h2>Members</h2>
<!-- raw HTML omitted -->
<p><strong>pszObjectGUID</strong></p>
<!-- raw HTML omitted -->
<p>A pointer to a null-terminated string containing the GUID of the directory service print queue object associated with a published printer. Use the <a href="getprinter.html"><strong>GetPrinter</strong></a> function to retrieve this GUID.</p>
<p>Before calling <a href="setprinter.html"><strong>SetPrinter</strong></a>, set <strong>pszObjectGUID</strong> to <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><strong>dwAction</strong></p>
<!-- raw HTML omitted -->
<p>Indicates the action for the <a href="setprinter.html"><strong>SetPrinter</strong></a> function to perform. For the <a href="getprinter.html"><strong>GetPrinter</strong></a> function, this member indicates whether the specified printer is published. This member can be a combination of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DSPRINT_PENDING</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x80000000<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="getprinter.html"><strong>GetPrinter</strong></a>: Indicates that the system is attempting to complete a publish or unpublish operation started by a <a href="setprinter.html"><strong>SetPrinter</strong></a> call.<!-- raw HTML omitted --> <a href="setprinter.html"><strong>SetPrinter</strong></a>: This value is not valid. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DSPRINT_PUBLISH</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000001<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="setprinter.html"><strong>SetPrinter</strong></a>: Publishes the printer's data in the DS.<!-- raw HTML omitted --> <a href="getprinter.html"><strong>GetPrinter</strong></a>: Indicates the printer is published. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DSPRINT_REPUBLISH</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000008<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="setprinter.html"><strong>SetPrinter</strong></a>: The DS data for the printer is unpublished and then published again, refreshing all properties in the published printer. Re-publishing also changes the GUID of the published printer.<!-- raw HTML omitted --> <a href="getprinter.html"><strong>GetPrinter</strong></a>: Never returns this value. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DSPRINT_UNPUBLISH</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000004<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="setprinter.html"><strong>SetPrinter</strong></a>: Removes the printer's published data from the DS.<!-- raw HTML omitted --> <a href="getprinter.html"><strong>GetPrinter</strong></a>: Indicates the printer is not published. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DSPRINT_UPDATE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000002<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="setprinter.html"><strong>SetPrinter</strong></a>: Updates the printer's published data in the DS.<!-- raw HTML omitted --> <a href="getprinter.html"><strong>GetPrinter</strong></a>: Never returns this value. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>The <strong>PRINTER_INFO_7</strong> structure is used in a <a href="setprinter.html"><strong>SetPrinter</strong></a> call to publish printer information to the directory service. The published data includes all values and data for the specified printer found under the SPLDS_SPOOLER_KEY, SPLDS_DRIVER_KEY, or SPLDS_USER_KEY keys created by <a href="setprinterdataex.html"><strong>SetPrinterDataEx</strong></a>.</p>
<p>For <a href="setprinter.html"><strong>SetPrinter</strong></a>, <em>pszObjectGUID</em> should be set to <strong>NULL</strong>. For <a href="getprinter.html"><strong>GetPrinter</strong></a>, <em>pszObjectGUID</em> returns the GUID of the directory services print queue object associated with a published printer. You can use this GUID with Active Directory Services Interface (ADSI) methods to retrieve published data for the printer. However, the recommended method for retrieving published data is to call the <a href="getprinterdataex.html"><strong>GetPrinterDataEx</strong></a> function.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winspool.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Unicode and ANSI names<!-- raw HTML omitted --></td>
<td><strong>_PRINTER_INFO_7W</strong> (Unicode) and <strong>_PRINTER_INFO_7A</strong> (ANSI)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="printdocs-printing.html">Printing</a></p>
<!-- raw HTML omitted -->
<p><a href="printing-and-print-spooler-structures.html">Print Spooler API Structures</a></p>
<!-- raw HTML omitted -->
</body>
