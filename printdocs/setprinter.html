<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SetPrinter function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The SetPrinter function sets the data for a specified printer or sets the state of the specified printer by pausing printing, resuming printing, or clearing all print jobs.
ms.assetid: 'ade367c5-20d6-4da9-bb52-ce6768cf7537'
title: SetPrinter function (WinSpool.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>SetPrinter</li>
<li>SetPrinterA</li>
<li>SetPrinterW
api_type:</li>
<li>DllExport
api_location:</li>
<li>WinSpool.drv</li>
<li>Ext-MS-Win-printer-WinSpool-l1-1-0.dll</li>
<li>Ext-MS-Win-printer-WinSpool-l1-1-1.dll</li>
<li>Ext-MS-Win-Printer-WinSpool-l1-1-2.dll</li>
<li>Ext-MS-Win-Printer-WinSpool-L1-1-3.dll</li>
</ul>
<hr />
<h1>SetPrinter function</h1>
<p>The <strong>SetPrinter</strong> function sets the data for a specified printer or sets the state of the specified printer by pausing printing, resuming printing, or clearing all print jobs.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>BOOL SetPrinter(
  _In_ HANDLE hPrinter,
  _In_ DWORD  Level,
  _In_ LPBYTE pPrinter,
  _In_ DWORD  Command
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hPrinter</em> [in]</p>
<!-- raw HTML omitted -->
<p>A handle to the printer. Use the <a href="openprinter.html"><strong>OpenPrinter</strong></a>, <a href="openprinter2.html"><strong>OpenPrinter2</strong></a>, or <a href="addprinter.html"><strong>AddPrinter</strong></a> function to retrieve a printer handle.</p>
<!-- raw HTML omitted -->
<p><em>Level</em> [in]</p>
<!-- raw HTML omitted -->
<p>The type of data that the function stores into the buffer pointed to by <em>pPrinter</em>. If the <em>Command</em> parameter is not equal to zero, the <em>Level</em> parameter must be zero.</p>
<p>This value can be 0, 2, 3, 4, 5, 6, 7, 8, or 9.</p>
<!-- raw HTML omitted -->
<p><em>pPrinter</em> [in]</p>
<!-- raw HTML omitted -->
<p>A pointer to a buffer containing data to set for the printer, or containing information for the command specified by the <em>Command</em> parameter. The type of data in the buffer is determined by the value of <em>Level</em>.</p>
<table>
<thead>
<tr>
<th>Level</th>
<th>Structure</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>0</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If the <em>Command</em> parameter is <strong>PRINTER_CONTROL_SET_STATUS</strong>, <em>pPrinter</em> must contain a <strong>DWORD</strong> value that specifies the new printer status to set. For a list of the possible status values, see the <strong>Status</strong> member of the <a href="printer-info-2.html"><strong>PRINTER_INFO_2</strong></a> structure. Note that <strong>PRINTER_STATUS_PAUSED</strong> and <strong>PRINTER_STATUS_PENDING_DELETION</strong> are not valid status values to set.<!-- raw HTML omitted --> If <em>Level</em> is 0, but the <em>Command</em> parameter is not <strong>PRINTER_CONTROL_SET_STATUS</strong>, <em>pPrinter</em> must be <strong>NULL</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>2</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-2.html"><strong>PRINTER_INFO_2</strong></a> structure containing detailed information about the printer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>3</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-3.html"><strong>PRINTER_INFO_3</strong></a> structure containing the printer's security information.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>4</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-4.html"><strong>PRINTER_INFO_4</strong></a> structure containing minimal printer information, including the name of the printer, the name of the server, and whether the printer is remote or local.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>5</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-5.html"><strong>PRINTER_INFO_5</strong></a> structure containing printer information such as printer attributes and time-out settings.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>6</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-6.html"><strong>PRINTER_INFO_6</strong></a> structure specifying the status value of a printer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>7</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-7.html"><strong>PRINTER_INFO_7</strong></a> structure. The <em>dwAction</em> member of this structure indicates whether <strong>SetPrinter</strong> should publish, unpublish, re-publish, or update the printer's data in the directory service.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>8</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-8.html"><strong>PRINTER_INFO_8</strong></a> structure specifying the global default printer settings.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>9</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A <a href="printer-info-9.html"><strong>PRINTER_INFO_9</strong></a> structure specifying the per-user default printer settings.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>Command</em> [in]</p>
<!-- raw HTML omitted -->
<p>The action to perform.</p>
<p>If the <em>Level</em> parameter is nonzero, set the value of this parameter to zero. In this case, the printer retains its current state and the function reconfigures the printer data as specified by the <em>Level</em> and <em>pPrinter</em> parameters.</p>
<p>If the <em>Level</em> parameter is zero, set the value of this parameter to one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_CONTROL_PAUSE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Pause the printer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_CONTROL_PURGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Delete all print jobs in the printer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_CONTROL_RESUME</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Resume a paused printer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PRINTER_CONTROL_SET_STATUS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Set the printer status.<!-- raw HTML omitted --> Set the <em>pPrinter</em> parameter to a pointer to a <strong>DWORD</strong> value that specifies the new printer status.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, the return value is a nonzero value.</p>
<p>If the function fails, the return value is zero.</p>
<p>If <em>Level</em> is 7 and the publish action failed, <strong>SetPrinter</strong> returns <strong>ERROR_IO_PENDING</strong> and attempts to complete the action in the background. If <em>Level</em> is 7 and the update action failed, <strong>SetPrinter</strong> returns <strong>ERROR_FILE_NOT_FOUND</strong>.</p>
<h2>Remarks</h2>
<blockquote>
<p>[!Note]<br />
This is a blocking or synchronous function and might not return immediately. How quickly this function returns depends on run-time factors such as network status, print server configuration, and printer driver implementation factors that are difficult to predict when writing an application. Calling this function from a thread that manages interaction with the user interface could make the application appear to be unresponsive.</p>
</blockquote>
<p>You cannot use <strong>SetPrinter</strong> to change the default printer.</p>
<p>To modify the current printer settings, call the <a href="getprinter.html"><strong>GetPrinter</strong></a> function to retrieve the current settings into a <a href="printer-info-2.html"><strong>PRINTER_INFO_2</strong></a> structure, modify the members of that structure as necessary, and then call <strong>SetPrinter</strong>.</p>
<p>The <strong>SetPrinter</strong> function ignores the <strong>pServerName</strong>, <strong>AveragePPM</strong>, <strong>Status</strong>, and <strong>cJobs</strong> members of a <a href="printer-info-2.html"><strong>PRINTER_INFO_2</strong></a> structure.</p>
<p>Pausing a printer suspends scheduling of all print jobs for that printer, except for the one print job that may be currently printing. Print jobs can be submitted to a paused printer, but no jobs will be scheduled to print on that printer until printing is resumed. If a printer is cleared, all print jobs for that printer are deleted, except for the current print job.</p>
<p>If you use <strong>SetPrinter</strong> to modify the default <a href="/windows/win32/api/wingdi/ns-wingdi-devmodea"><strong>DEVMODE</strong></a> structure for a printer (globally setting the printer defaults), you must first call the <a href="documentproperties.html"><strong>DocumentProperties</strong></a> function to validate the <strong>DEVMODE</strong> structure.</p>
<p>For the <a href="printer-info-2.html"><strong>PRINTER_INFO_2</strong></a> and <a href="printer-info-3.html"><strong>PRINTER_INFO_3</strong></a> structures that contain a pointer to a security descriptor, the function can set only those components of the security descriptor that the caller has permission to modify. To set particular security descriptor components, you must specify the necessary access rights when you call the <a href="openprinter.html"><strong>OpenPrinter</strong></a> or <a href="openprinter2.html"><strong>OpenPrinter2</strong></a> function to retrieve a handle to the printer. The following table shows the access rights required to modify the various security descriptor components.</p>
<table>
<thead>
<tr>
<th>Access permission</th>
<th>Security descriptor component</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>WRITE_OWNER</strong></td>
<td>Owner<!-- raw HTML omitted --> Primary group<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>WRITE_DAC</strong></td>
<td>Discretionary access-control list (DACL)</td>
</tr>
<tr>
<td><strong>ACCESS_SYSTEM_SECURITY</strong></td>
<td>System access-control list (SACL)</td>
</tr>
</tbody>
</table>
<p>If the security descriptor contains a component that the caller does not have the access right to modify, <strong>SetPrinter</strong> fails. Those components of a security descriptor that you don't want to modify should be <strong>NULL</strong> or not be present, as appropriate. If you do not want to modify the security descriptor, and are calling <strong>SetPrinter</strong> with a <a href="printer-info-2.html"><strong>PRINTER_INFO_2</strong></a> structure, set the <strong>pSecurityDescriptor</strong> member of that structure to <strong>NULL</strong>.</p>
<p>The Internet Connection Firewall (ICF) blocks printer ports by default, but an exception for File and Print Sharing can be enabled. If <strong>SetPrinter</strong> is called by a machine admin, it enables the exception. If it is called by a non-admin and the exception has not already been enabled, the call fails.</p>
<p>You can use level 7 with the <a href="printer-info-7.html"><strong>PRINTER_INFO_7</strong></a> structure to publish, unpublish, or update directory service data for the printer. The directory service data for a printer includes all the data stored under the SPLDS_* keys by calls to the <a href="setprinterdataex.html"><strong>SetPrinterDataEx</strong></a> function for the printer. Before calling <strong>SetPrinter</strong>, set the <strong>pszObjectGUID</strong> member of <strong>PRINTER_INFO_7</strong> to <strong>NULL</strong> and set the <em>dwAction</em> member to one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DSPRINT_PUBLISH</strong><!-- raw HTML omitted --></td>
<td>Publishes the directory service data.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>DSPRINT_REPUBLISH</strong><!-- raw HTML omitted --></td>
<td>The directory service data for the printer is unpublished and then published again, refreshing all properties in the published printer. Re-publishing also changes the GUID of the published printer. Use this value if you suspect the printer's published data has been corrupted.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>DSPRINT_UNPUBLISH</strong><!-- raw HTML omitted --></td>
<td>Unpublishes the directory service data.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>DSPRINT_UPDATE</strong><!-- raw HTML omitted --></td>
<td>Updates the directory service data. This is the same as <strong>DSPRINT_PUBLISH</strong>, except that <strong>SetPrinter</strong> fails with <strong>ERROR_FILE_NOT_FOUND</strong> if the printer is not already published.<!-- raw HTML omitted --> Use <strong>DSPRINT_UPDATE</strong> to update published properties but not force publishing. Printer drivers should always use <strong>DSPRINT_UPDATE</strong> rather than <strong>DSPRINT_PUBLISH</strong>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p><strong>DSPRINT_PENDING</strong> is not a valid <em>dwAction</em> value for <strong>SetPrinter</strong>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WinSpool.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WinSpool.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WinSpool.drv<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Unicode and ANSI names<!-- raw HTML omitted --></td>
<td><strong>SetPrinterW</strong> (Unicode) and <strong>SetPrinterA</strong> (ANSI)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="printdocs-printing.html">Printing</a></p>
<!-- raw HTML omitted -->
<p><a href="printing-and-print-spooler-functions.html">Print Spooler API Functions</a></p>
<!-- raw HTML omitted -->
<p><a href="addprinter.html"><strong>AddPrinter</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="getprinter.html"><strong>GetPrinter</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="openprinter.html"><strong>OpenPrinter</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="openprinter2.html"><strong>OpenPrinter2</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-2.html"><strong>PRINTER_INFO_2</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-3.html"><strong>PRINTER_INFO_3</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-4.html"><strong>PRINTER_INFO_4</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-5.html"><strong>PRINTER_INFO_5</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-6.html"><strong>PRINTER_INFO_6</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-7.html"><strong>PRINTER_INFO_7</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-8.html"><strong>PRINTER_INFO_8</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="printer-info-9.html"><strong>PRINTER_INFO_9</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="setprinterdataex.html"><strong>SetPrinterDataEx</strong></a></p>
<!-- raw HTML omitted -->
</body>
