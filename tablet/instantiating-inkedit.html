<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Instantiating InkEdit</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This topic describes the various ways that you can instantiate an InkEdit control.
ms.assetid: 3ab0f10e-1a0d-4d0b-b5b2-69dc96570b33
title: Instantiating InkEdit
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Instantiating InkEdit</h1>
<p>This topic describes the various ways that you can instantiate an <a href="inkedit-control.html">InkEdit</a> control.</p>
<h2>Visual Basic .NET and C#</h2>
<p>If you are working with Microsoft Visual Basic .NET or C#, drag the <a href="./inkedit-control.html">InkEdit</a> control from the Toolbox in Visual Studio to the form or page where you want the control to appear.</p>
<h2>Win32/C++</h2>
<p>The <a href="inkedit-control-reference.html">InkEdit</a> control is a superclass of the Rich Edit 4.5 Win32 OLE embeddable control.</p>
<p>Win32 applications instantiate the <a href="inkedit-control-reference.html">InkEdit</a> control by calling <a href="/windows/win32/api/winuser/nf-winuser-createwindowa">CreateWindow()</a> and passing INKEDIT as the window class. INKEDIT is defined in InkEd.h. After the control is created, you can &quot;talk&quot; to the control with messages. Rich Edit messages (EM_*) are passed from InkEdit to Rich Edit unaltered; all of the existing Rich Edit functionality is available.</p>
<p>To create an <a href="inkedit-control-reference.html">InkEdit</a> control, call the <a href="/windows/win32/api/winuser/nf-winuser-createwindowa">CreateWindow()</a> function, specifying the InkEdit window class. Use <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya">LoadLibrary()</a> to register InkEd.dll. Specify the INKEDIT_CLASS defined constant for the window class parameter and use the window styles as specified in the following examples.</p>
<h3>Instantiating a Multiline InkEdit Control</h3>
<pre lang="C++"><code>//...
HMODULE s_hlib;    
s_hlib= LoadLibrary(&quot;InkEd.dll&quot;);
//...
m_hwndInkEdit = CreateWindowW(INKEDIT_CLASS, NULL,
WS_CHILD|WS_VISIBLE|WS_BORDER|ES_MULTILINE,
rt.left, rt.top, rt.right, rt.bottom,
m_hWnd, NULL, hInst, NULL);
</code></pre>
<h3>Instantiating a Single-Line InkEdit Control</h3>
<pre lang="C++"><code>//...
HMODULE s_hlib;    
s_hlib= LoadLibrary(&quot;InkEd.dll&quot;);
//...
m_hwndInkEdit = CreateWindowW(INKEDIT_CLASS, NULL,
WS_CHILD|WS_VISIBLE|WS_BORDER,
rt.left, rt.top, rt.right, rt.bottom,
m_hWnd, NULL, hInst, NULL);
</code></pre>
<blockquote>
<p>[!Note]<br />
Unlike with RichEdit, you must be sure to call <a href="/windows/win32/api/objbase/nf-objbase-coinitialize">CoInitialize()</a> before creating the <a href="inkedit-control-reference.html">InkEdit</a> control. Call <a href="/windows/win32/api/combaseapi/nf-combaseapi-couninitialize">CoUninitialize()</a> when your application shuts down. After calling CoUninitialize(), you must call <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary">FreeLibrary(s_hlib)</a> to decrement the reference count on the InkEdit.dll file.</p>
</blockquote>
<p>Â </p>
<p>If you use the <a href="../controls/rich-edit-control-styles.html">ES_NOIME</a> window style, the built-in correction support is not available. If you don't specify a parent window, the control is created as a top-level window and the WS_SYSMENU style is added; this also disables the built-in correction support.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="adding-ink-controls-to-a-project.html">Adding Ink Controls to a Project</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
