<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ITablet::CreateContext method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Creates a context object that describes the specified tablet device.
ms.assetid: 76f48485-a958-4457-9b87-73de73fa671e
title: ITablet::CreateContext method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>ITablet.CreateContext
api_type:</li>
<li>COM
api_location:</li>
<li>wisptis.exe</li>
<li>wisptis.exe.dll</li>
</ul>
<hr />
<h1>ITablet::CreateContext method</h1>
<p>Creates a context object that describes the specified tablet device.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT CreateContext(
  [in]      HWND                    hWnd,
  [in]      RECT                    *prcInput,
  [in]      DWORD                   dwOptions,
  [in]      TABLET_CONTEXT_SETTINGS *pTCS,
  [in]      CONTEXT_ENABLE_TYPE     cet,
  [out]     ITabletContext          **ppCtx,
  [in, out] TABLET_CONTEXT_ID       *pTcid,
  [in, out] PACKET_DESCRIPTION      **ppPD,
  [in]      ITabletEventSink        *pSink
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hWnd</em> [in]</p>
<!-- raw HTML omitted -->
<p>The window to which the tablet context will be attached.</p>
<!-- raw HTML omitted -->
<p><em>prcInput</em> [in]</p>
<!-- raw HTML omitted -->
<p>[in, unique]</p>
<p>The ink input rectangle.</p>
<!-- raw HTML omitted -->
<p><em>dwOptions</em> [in]</p>
<!-- raw HTML omitted -->
<p>Flags that set tablet context options.</p>
<!-- raw HTML omitted -->
<p><em>pTCS</em> [in]</p>
<!-- raw HTML omitted -->
<p>[in, unique]</p>
<p>Detailed information about the tablet context to create.</p>
<!-- raw HTML omitted -->
<p><em>cet</em> [in]</p>
<!-- raw HTML omitted -->
<p>Value that enables or disables context messages being sent to the window.</p>
<!-- raw HTML omitted -->
<p><em>ppCtx</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to the newly create tablet context.</p>
<!-- raw HTML omitted -->
<p><em>pTcid</em> [in, out]</p>
<!-- raw HTML omitted -->
<p>Value that uniquely identifies the tablet.</p>
<!-- raw HTML omitted -->
<p><em>ppPD</em> [in, out]</p>
<!-- raw HTML omitted -->
<p>Pointer to information about what data is contained in each packet.</p>
<!-- raw HTML omitted -->
<p><em>pSink</em> [in]</p>
<!-- raw HTML omitted -->
<p>The <a href="itableteventsink.html"><strong>ITabletEventSink</strong></a> object where notification messages will be sent.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This method can return one of these values.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Success.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_FAIL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An unspecified error occurred.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>Typically, an application obtains the default values from the <a href="itablet-getdefaultcontextsettings.html"><strong>ITablet::GetDefaultContextSettings Method</strong></a>, modifies values to suit their needs, and then passes the modified settings structure to the <strong>ITablet::CreateContext Method</strong>.</p>
<blockquote>
<p>[!Note]<br />
You must implement the <a href="itableteventsink.html"><strong>ITabletEventSink Interface</strong></a> when calling the <strong>ITablet::CreateContext Method</strong>.</p>
</blockquote>
<p>The <em>dwOptions</em> parameter is a set of bit flags that describe context options. The following table describes these flags.</p>
<table>
<thead>
<tr>
<th>Flag Name</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>TCXO_MARGIN<!-- raw HTML omitted --></td>
<td>0x00000001<!-- raw HTML omitted --></td>
<td>Specifies that the input context on the tablet will have a margin. The margin is an area outside the specified input area where events will be mapped to the edge of the input area. This feature makes it easier to input points at the edge of the context.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TCXO_PREHOOK<!-- raw HTML omitted --></td>
<td>0x00000002<!-- raw HTML omitted --></td>
<td>Prehook gets packets before regular contexts and posthooks. They get packets in the order of their creation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TCXO_CURSOR_STATE<!-- raw HTML omitted --></td>
<td>0x00000004<!-- raw HTML omitted --></td>
<td>The TC will return packets even if the cursor is up. By default, a TC will only return packets when the cursor is down.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TCXO_NO_CURSOR_DOWN<!-- raw HTML omitted --></td>
<td>0x00000008<!-- raw HTML omitted --></td>
<td>The TC will not return packets when the cursor is down.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TCXO_NON_INTEGRATED<!-- raw HTML omitted --></td>
<td>0x00000010<!-- raw HTML omitted --></td>
<td>The context will be non-integrated.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TCXO_POSTHOOK<!-- raw HTML omitted --></td>
<td>0x00000020<!-- raw HTML omitted --></td>
<td>Posthooks get packets after regular tablet contexts but before the system context. They get packets in the reverse order of their creation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TCXO_DONT_SHOW_CURSOR<!-- raw HTML omitted --></td>
<td>0x00000080<!-- raw HTML omitted --></td>
<td>The TC will not set the cursor position.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TCXO_DONT_VALIDATE_TCS<!-- raw HTML omitted --></td>
<td>0x00000100<!-- raw HTML omitted --></td>
<td>The TC will not validate the GUIDS passed in the tablet context settings against the supported properties of the device.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TCXO_ALLOW_FLICKS<!-- raw HTML omitted --></td>
<td>0x00000400<!-- raw HTML omitted --></td>
<td>The TC will allow flick detection to take place (by default this is only allowed on system contexts), and the client will get SE_FLICK events.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TCXO_ALLOW_FEEDBACK_TAPS<!-- raw HTML omitted --></td>
<td>0x00000800<!-- raw HTML omitted --></td>
<td>The TC will allow pen feedback to be shown. By default, this is only allowed on system contexts.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TCXO_ALLOW_FEEDBACK_BARREL<!-- raw HTML omitted --></td>
<td>0x00001000<!-- raw HTML omitted --></td>
<td>The TC will allow pen feedback to be shown. By default, this is only allowed on system contexts.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TCXO_ALL<!-- raw HTML omitted --></td>
<td>TCXO_MARGIN | TCXO_PREHOOK | TCXO_CURSOR_STATE | TCXO_NO_CURSOR_DOWN | TCXO_NON_INTEGRATED | TCXO_POSTHOOK | TCXO_DONT_SHOW_CURSOR | TCXO_DONT_VALIDATE_TCS<!-- raw HTML omitted --></td>
<td>All defined tablet context options.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>TCXO_HOOK<!-- raw HTML omitted --></td>
<td>TCXO_PREHOOK | TCXO_POSTHOOK<!-- raw HTML omitted --></td>
<td>Combines pre-hook and post-hook functionality.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP Tablet PC Edition [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wisptis.exe<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="itablet.html"><strong>ITablet Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="context-enable-type.html"><strong>CONTEXT_ENABLE_TYPE Enumeration</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="tablet-context-settings.html"><strong>TABLET_CONTEXT_SETTINGS Structure</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/tpcshrd/ns-tpcshrd-packet_description"><strong>PACKET_DESCRIPTION Structure</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="itabletcontextp.html"><strong>ITabletContextP Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="itableteventsink.html"><strong>ITabletEventSink Interface</strong></a></p>
<!-- raw HTML omitted -->
</body>
