<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Ink-Collection Plug-ins</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The RealTimeStylus object does not inherently collect ink. To use the RealTimeStylus to collect ink, create an ink-collector plug-in.
ms.assetid: 9a29525d-714a-431e-bb6f-4705d658537b
title: Ink-Collection Plug-ins
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Ink-Collection Plug-ins</h1>
<p>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object does not inherently collect ink. To use the <strong>RealTimeStylus</strong> to collect ink, create an ink-collector plug-in.</p>
<p>The following is a minimal scenario for using the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object on a form that collects ink.</p>
<ol>
<li>Create a form that implements the <a href="/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin"><strong>IStylusAsyncPlugin</strong></a> interface.</li>
<li>Create a <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object, and attach it to a control on the form.</li>
<li>Set interest in the StylusDown, Packets, and StylusUp notifications in the form's <a href="/previous-versions/ms574886(v=vs.100)">DataInterest</a> property.</li>
<li>In the form's <a href="/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-stylusdown"><strong>StylusDown</strong></a>, <a href="/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-packets"><strong>Packets</strong></a>, and <a href="/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-stylusup"><strong>StylusUp</strong></a> methods, add code to handle the stylus down, packets, and stylus up notifications that are sent from the form's <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object. This code should store the pen data, and create and store the strokes.</li>
</ol>
<p>For a sample of such an application, see the <a href="realtimestylus-ink-collection-sample.html">RealTimeStylus Ink Collection Sample</a> sample.</p>
<blockquote>
<p>[!Note]<br />
When a <a href="/dotnet/api/microsoft.win32.systemevents.displaysettingschanged?view=dotnet-plat-ext-3.1&amp;preserve-view=true">DisplaySettingsChanged</a> event occurs, call the <a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkstrokes-modifydrawingattributes"><strong>ModifyDrawingAttributes</strong></a> method of the collected strokes in a DisplaySettingsChanged event handler to recalculate the <a href="/previous-versions/ms582112(v=vs.100)">Width</a> and <a href="/previous-versions/ms582106(v=vs.100)">Height</a> properties. This is necessary to account for possible dots per inch (dpi) changes that result from the DisplaySettingsChanged event.</p>
</blockquote>
<p>Â </p>
<h2>Ink Collection and Recognizers</h2>
<p>Neither ink analysis nor handwriting recognition is a function of the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object. As the ink-collector plug-in collects ink-or as you want to recognize the ink-you can copy the ink to a <a href="/previous-versions/ms552546(v=vs.100)">RecognizerContext</a> or <a href="/previous-versions/ms583616(v=vs.100)">Divider</a> object. For more information about recognition and ink analysis, see <a href="about-handwriting-recognition.html">About Handwriting Recognition</a> or <a href="the-divider-object.html">The Divider Object</a>.</p>
<h2>Static Rendering</h2>
<p>To render ink as it is being collected, attach a <a href="/previous-versions/ms575176(v=vs.100)">DynamicRenderer</a> object to the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object. To render ink after it has been collected, use a <a href="/previous-versions/ms552630(v=vs.100)">Renderer</a> object to draw the strokes to the appropriate <a href="/dotnet/api/system.drawing.graphics?view=dotnet-plat-ext-3.1&amp;preserve-view=true">Graphics</a> object. For more information about the DynamicRenderer object, see <a href="dynamic-renderer-plug-ins.html">Dynamic-Renderer Plug-ins</a>. For a sample of both static and dynamic rendering, see <a href="realtimestylus-ink-collection-sample.html">RealTimeStylus Ink Collection Sample</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
