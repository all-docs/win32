<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>InkPicture.NewInAirPackets event</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: InkPicture.NewInAirPackets event - Occurs when an in-air packet is seen.
ms.assetid: 30bc423d-0642-4515-9e51-a8b8b36aecad
title: InkPicture.NewInAirPackets event (Msinkaut.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>InkPicture.NewInAirPackets event</h1>
<p>Occurs when an in-air packet is seen.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>void NewInAirPackets(
  [in]      IInkCursor *Cursor,
  [in]      long       PacketCount,
  [in, out] VARIANT    *PacketData
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Cursor</em> [in]</p>
<!-- raw HTML omitted -->
<p>The <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinkcursor"><strong>IInkCursor</strong></a> object that generated the <strong>NewInAirPackets</strong> event.</p>
<!-- raw HTML omitted -->
<p><em>PacketCount</em> [in]</p>
<!-- raw HTML omitted -->
<p>The number of in-air packets received.</p>
<!-- raw HTML omitted -->
<p><em>PacketData</em> [in, out]</p>
<!-- raw HTML omitted -->
<p>An array that contains the selected data for the packet.</p>
<p>For more information about the VARIANT structure, see <a href="using-the-com-library.html">Using the COM Library</a>.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This event does not return a value.</p>
<h2>Remarks</h2>
<p>An in-air packet is created when a user moves a pen near the tablet and the cursor is within the ink collector object's window or the user moves a mouse within the ink collector object's associated window. <strong>NewInAirPackets</strong> events are generated rapidly, and the event handler must be fast or performance suffers.</p>
<p>This event method is defined in the <strong>_IInkCollectorEvents</strong>, <strong>_IInkOverlayEvents</strong>, and <strong>_IInkPictureEvents</strong> dispatch-only interfaces (dispinterfaces) with an ID of DISPID_ICENewInAirPackets.</p>
<p>The <strong>NewInAirPackets</strong> event is fired even when in select or erase mode, not just when inserting ink. This requires that you monitor the editing mode (which you are responsible for setting) and be aware of the mode before interpreting the event. The advantage of this requirement is greater freedom to innovate on the platform through greater awareness of platform events.</p>
<p>To set which properties are contained in this array, use the <a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkpicture-get_desiredpacketdescription"><strong>DesiredPacketDescription</strong></a> property of the ink collector object. The array that the <em>PacketData</em> parameter returns contains the data for those properties.</p>
<blockquote>
<p>[!Note]<br />
Although you can modify the packet data, these modifications are not persisted or used.</p>
</blockquote>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP Tablet PC Edition [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msinkaut.h (also requires Msinkaut_i.c)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->InkObj.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="inkpicture-control-reference.html">InkPicture</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkpicture-get_desiredpacketdescription"><strong>DesiredPacketDescription Property</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="inkpicture-newpackets.html"><strong>NewPackets Event</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinkcursor"><strong>IInkCursor Interface</strong></a></p>
<!-- raw HTML omitted -->
</body>
