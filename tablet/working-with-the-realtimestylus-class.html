<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Working with the RealTimeStylus Class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The RealTimeStylus class is part of the StylusInput application programming interfaces (APIs). The following sections describe key elements of the RealTimeStylus class and the StylusInput APIs.
ms.assetid: 6385c387-5b11-4719-a6ec-e0bebe875348
title: Working with the RealTimeStylus Class
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Working with the RealTimeStylus Class</h1>
<p>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> class is part of the StylusInput application programming interfaces (APIs). The following sections describe key elements of the <strong>RealTimeStylus</strong> class and the StylusInput APIs.</p>
<h2>Instantiating the RealTimeStylus Class</h2>
<p>When you create a <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object, you have the option of attaching it to a window handle or to a control. Attaching the <strong>RealTimeStylus</strong> object to a window handle requires additional permissions. For more information about these permissions, see <a href="partial-trust-considerations-for-the-stylusinput-apis.html">Partial Trust Considerations for the StylusInput APIs</a>.</p>
<blockquote>
<p>[!Note]<br />
You cannot attach the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object to a window or control in a different process.</p>
</blockquote>
<p>Â </p>
<p>If you use the default constructor, you create a <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object that can only accept input from another <strong>RealTimeStylus</strong> object. For more information about connecting two <strong>RealTimeStylus</strong> objects, see <a href="the-cascaded-realtimestylus-model.html">The Cascaded RealTimeStylus Model</a>.</p>
<p>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object implements the <a href="/dotnet/api/system.idisposable">IDisposable</a> interface.</p>
<h2>Extending the RealTimeStylus Class</h2>
<p>To allow your plug-ins to interact with the data stream from the tablet pen, the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object maintains two plug-in collections, which are accessible by the <a href="/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstylussyncplugin"><strong>GetStylusSyncPlugin</strong></a> and the <a href="/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstylusasyncplugin"><strong>GetStylusAsyncPlugin</strong></a> methods in C++ and by the <a href="/previous-versions/ms824833(v=msdn.10)">SyncPluginCollection</a> and <a href="/previous-versions/ms824831(v=msdn.10)">AsyncPluginCollection</a> properties in managed code. You can add a plug-in by calling either the <a href="/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-addstylussyncplugin"><strong>AddStylusSyncPlugin</strong></a> or the <a href="/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-addstylusasyncplugin"><strong>AddStylusAsyncPlugin</strong></a> method of the collection within the appropriate property. For more information about creating and using plug-ins, see <a href="plug-ins-and-the-realtimestylus-class.html">Plug-ins and the RealTimeStylus Class</a>. For information about deciding whether to create a synchronous or asynchronous plug-in for a particular task, see <a href="threading-considerations-for-the-stylusinput-apis.html">Threading Considerations for the StylusInput APIs</a> and <a href="performance-considerations-for-the-stylusinput-apis.html">Performance Considerations for the StylusInput APIs</a>.</p>
<p>Synchronous plug-ins must implement the <a href="/windows/win32/api/rtscom/nn-rtscom-istylussyncplugin"><strong>IStylusSyncPlugin</strong></a> interface, and asynchronous plug-ins must implement the <a href="/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin"><strong>IStylusAsyncPlugin</strong></a> interface. Each plug-in has a <a href="/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest"><strong>IStylusSyncPlugin.DataInterest</strong></a> or <a href="/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest"><strong>IStylusAsyncPlugin.DataInterest</strong></a> property. The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object calls only the notification methods of the plug-in for methods in which the plug-in has subscribed. For more information about the notification methods, see <a href="plug-in-data-and-the-realtimestylus-class.html">Plug-in Data and the RealTimeStylus Class</a>.</p>
<p>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object implements the <a href="/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin"><strong>IStylusAsyncPlugin</strong></a> interface. The only way to instantiate a <strong>RealTimeStylus</strong> object that accepts input from another <strong>RealTimeStylus</strong> object is to use the default constructor and implement the cascaded <strong>RealTimeStylus</strong> model. For more information about connecting two <strong>RealTimeStylus</strong> objects see <a href="the-cascaded-realtimestylus-model.html">The Cascaded RealTimeStylus Model</a>.</p>
<p>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object has two internal queues that carry the tablet pen data, the input queue and the output queue. The pen data is converted into instances of the classes in the <a href="/previous-versions/ms574862(v=vs.100)">Microsoft.StylusInput.PluginData</a> namespace. The following list describes how the <strong>RealTimeStylus</strong> object handles the tablet pen data.</p>
<ol>
<li>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object checks for plug-in data objects first on its input queue and then from the tablet pen data stream.</li>
<li>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object sends one plug-in data object to the objects in its synchronous plug-in collection. Each synchronous plug-in can add data to either the input or output queue.</li>
<li>Once the plug-in data object has been sent to all members of the synchronous plug-in collection, the plug-in data object is placed on the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's output queue.</li>
<li>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object then checks for the next plug-in data object to process.</li>
<li>While the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's output queue contains data, the <strong>RealTimeStylus</strong> object sends one plug-in data object from its output queue to the objects in its asynchronous plug-in collection. Each asynchronous plug-in can add data to either the input or output queue, but since the asynchronous plug-ins run on the user interface (UI) thread, the data is added to the queue in relation to the current pen data the <strong>RealTimeStylus</strong> object is processing, and not in relation to the data that the asynchronous plug-in is processing.</li>
</ol>
<p>The following diagram illustrates the flow of tablet pen data through the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object and its plug-in collections.</p>
<p><img src="images/5a698bc9-833b-4b24-9fa2-70be0ca61032.gif" alt="illustratiom showing tablet pc pen data flow" /></p>
<p>In this diagram the circles lettered &quot;A&quot; and &quot;B&quot; represent tablet pen data that has already been added to the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's output queue and that has not yet been sent to the asynchronous plug-in collection. The circle lettered &quot;C&quot; represents the tablet pen data that the <strong>RealTimeStylus</strong> object is currently processing. It is sent to the synchronous plug-in collection and placed on the output queue. The empty circle represents the position in the output queue where future tablet pen data is added.</p>
<p>For more information about how specific data is added to the queue and processed, see <a href="plug-in-data-and-the-realtimestylus-class.html">Plug-in Data and the RealTimeStylus Class</a>.</p>
<p>The following is a minimal scenario for using the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object on a form that collects ink.</p>
<ol>
<li>Create a form that implements the <a href="/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin"><strong>IStylusAsyncPlugin</strong></a> interface.</li>
<li>Create a <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object attached to a control on the form.</li>
<li>Set interest in the StylusDown, Packets, and StylusUp notifications in the form's <a href="/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest"><strong>IStylusAsyncPlugin.DataInterest</strong></a> property.</li>
<li>In the form's <a href="/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-stylusdown"><strong>StylusDown</strong></a>, <a href="/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-packets"><strong>Packets</strong></a>, and <a href="/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-stylusup"><strong>StylusUp</strong></a> methods, add code to handle the stylus down, packets, and stylus up notifications that are sent from the form's <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object.</li>
</ol>
<p>For a sample of such an application, see the <a href="realtimestylus-ink-collection-sample.html">RealTimeStylus Ink Collection Sample</a>.</p>
<h2>Working with Tablet Objects</h2>
<p>Each enabled <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object maintains a list of unique identifiers for the <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet"><strong>Tablet</strong></a> objects it can interact with. The <strong>RealTimeStylus</strong> object exposes two methods for translating between the unique identifier and the <strong>Tablet</strong> object: the <a href="/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-gettabletcontextidfromtablet"><strong>GetTabletContextIdFromTablet</strong></a> and <a href="/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-gettabletfromtabletcontextid"><strong>GetTabletFromTabletContextId</strong></a> methods.</p>
<p>The <a href="/previous-versions/ms827769(v=msdn.10)">TabletPropertyDescription</a> object (in managed code) contains a <a href="/previous-versions/ms827780(v=msdn.10)">PacketPropertyId</a> property and a <a href="/previous-versions/ms827781(v=msdn.10)">TabletPropertyMetrics</a> structure that describes the range, resolution, and units of the property for a specific <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet"><strong>Tablet</strong></a> object. The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's <a href="/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getdesiredpacketdescription"><strong>GetDesiredPacketDescription</strong></a> method returns an array of globally unique identifiers (GUIDs) for the packet properties that the <strong>RealTimeStylus</strong> object forwards to its plug-ins when those packet properties are available. To modify the set of packet properties the <strong>RealTimeStylus</strong> object passes to its plug-ins, call the <strong>RealTimeStylus</strong> object's <a href="/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-setdesiredpacketdescription"><strong>SetDesiredPacketDescription</strong></a> method. The <a href="/previous-versions/ms825935(v=msdn.10)">GetTabletPropertyDescriptionCollection</a> method (in managed code) of the <strong>RealTimeStylus</strong> object takes a unique tablet identifier and returns a collection of <a href="/previous-versions/ms827760(v=msdn.10)">TabletPropertyDescription</a> objects. These packet properties represent the subset of properties supported by the tablet that are returned by the <strong>GetDesiredPacketDescription</strong> method.</p>
<p>For a list of the standard packet property GUIDs, see the <a href="packetpropertyguids-constants.html">PacketPropertyGuids Constants</a> class.</p>
<h2>Special Considerations</h2>
<p>The following list describes other points to take into consideration when using the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object with a <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet"><strong>Tablet</strong></a> object.</p>
<ul>
<li>The <a href="/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-setdesiredpacketdescription"><strong>SetDesiredPacketDescription</strong></a> method can only be called while the <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet"><strong>Tablet</strong></a> object is disabled. The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object may modify the list of desired packet properties; therefore, call the <a href="/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getdesiredpacketdescription"><strong>GetDesiredPacketDescription</strong></a> method after the call to the <strong>SetDesiredPacketDescription</strong> method to determine which packet properties the <strong>RealTimeStylus</strong> object can forward to its plug-ins. A tablet is only guaranteed to support the <strong>X</strong>, <strong>Y</strong>, and <strong>PacketStatus</strong> values for the <a href="packetproperty-guids.html">PacketProperty</a>. Therefore, your plug-in design may need to account for receiving fewer packet properties than desired.</li>
<li>The <a href="/previous-versions/ms825935(v=msdn.10)">GetTabletPropertyDescriptionCollection</a> method (for managed code) can only be called while the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object is enabled. Because notification can be sent to the async plug-ins after the <strong>RealTimeStylus</strong> object has been disabled, you may need to cache the information for each <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet"><strong>Tablet</strong></a> object. The GetTabletPropertyDescriptionCollection method returns a list of the desired packet properties that are supported by the specified tablet.</li>
<li>When the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object is enabled, each plug-in receives a call to its <a href="/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-realtimestylusenabled"><strong>RealTimeStylusEnabled</strong></a> method. The <a href="/previous-versions/ms824229(v=msdn.10)">RealTimeStylusEnabledData</a> object passed in the notification contains a collection of the context identifiers for the available tablets at the time the <strong>RealTimeStylus</strong> object is enabled.</li>
<li>When a tablet that the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object can use is added to or removed from the Tablet PC while the <strong>RealTimeStylus</strong> object is enabled, the <strong>RealTimeStylus</strong> object notifies its plug-ins that a <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet"><strong>Tablet</strong></a> object has been added or removed. For more information, see <a href="plug-in-data-and-the-realtimestylus-class.html">Plug-in Data and the RealTimeStylus Class</a>.</li>
</ul>
<h2>Working with Tablet Pens</h2>
<p>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object passes information about the tablet pen to its plug-ins in a number of the notification methods. Information about the tablet pen is represented by a <a href="/previous-versions/ms824824(v=msdn.10)">Stylus</a> object, gotten through the <a href="/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstyluses"><strong>GetStyluses</strong></a> method. This object is a representation of the tablet pen at the time the data was gathered. Because plug-ins receive the tablet pen data as part of the tablet pen data stream, the plug-ins should use the information in the Stylus object instead of checking for the current state of a particular tablet pen through the <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinkcursor"><strong>Cursor</strong></a> class. For information about how tablet pen and tablet pen button data is passed to plug-ins, see <a href="plug-in-data-and-the-realtimestylus-class.html">Plug-in Data and the RealTimeStylus Class</a>.</p>
<p>To get an array of the <a href="/previous-versions/ms824824(v=msdn.10)">Stylus</a> objects that the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object has encountered since it was last enabled, use the <strong>RealTimeStylus</strong> object's <a href="/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstyluses"><strong>GetStyluses</strong></a> method.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/ms827783(v=msdn.10)">Microsoft.Ink.Tablet</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/ms585724(v=vs.100)">Microsoft.StylusInput.RealTimeStylus</a></p>
<!-- raw HTML omitted -->
<p><a href="the-cascaded-realtimestylus-model.html">The Cascaded RealTimeStylus Model</a></p>
<!-- raw HTML omitted -->
<p><a href="partial-trust-considerations-for-the-stylusinput-apis.html">Partial Trust Considerations for the StylusInput APIs</a></p>
<!-- raw HTML omitted -->
<p><a href="plug-in-data-and-the-realtimestylus-class.html">Plug-in Data and the RealTimeStylus Class</a></p>
<!-- raw HTML omitted -->
<p><a href="threading-considerations-for-the-stylusinput-apis.html">Threading Considerations for the StylusInput APIs</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
