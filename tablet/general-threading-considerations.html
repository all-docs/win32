<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>General Threading Considerations</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Overview of general threading considerations.
ms.assetid: cf35724f-5f80-4b3e-992a-a9d5ea99aae9
title: General Threading Considerations
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>General Threading Considerations</h1>
<p>The following are general threading considerations when developing for Tablet PC.</p>
<ul>
<li><a href="#application-and-non-application-threads">Application and Non-Application Threads</a></li>
<li><a href="#performance-considerations">Performance Considerations</a>
<ul>
<li><a href="#event-handlers">Event Handlers</a></li>
<li><a href="#autoredraw-property">AutoRedraw Property</a></li>
<li><a href="#dynamicrendering-property">DynamicRendering Property</a></li>
</ul>
</li>
<li><a href="#event-threading-considerations">Event Threading Considerations</a>
<ul>
<li><a href="#inkcollector-and-inkoverlay-objects-events">InkCollector and InkOverlay Objects Events</a></li>
<li><a href="#ink-object-and-strokes-collection-events">Ink Object and Strokes Collection Events</a></li>
<li><a href="#recognition-events">Recognition Events</a></li>
<li><a href="#pen-input-panel-events">Pen Input Panel Events</a></li>
</ul>
</li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Application and Non-Application Threads</h2>
<p>All ink events are generated on a separate, high-priority ink thread. This allows ink to flow smoothly even when an application is running slowly. However, event handlers can slow down or block the rendering of ink.</p>
<p>All recognition events generated by background recognition method calls are handled on a separate, normal-priority background recognition thread.</p>
<p>All mouse events are generated on the application's main user interface (UI) thread.</p>
<h2>Performance Considerations</h2>
<h3>Event Handlers</h3>
<p>The Tablet PC Platform application programming interface (API) has an interactive model for events rather than a notification model. Keep code in event handlers short to reduce the time that ink rendering is blocked. The collection of ink by the Tablet PC is not blocked, but your application does not receive the ink while your application is blocked.</p>
<h3>AutoRedraw Property</h3>
<p>When your application is performing custom rendering or when your application is sensitive to painting issues, you can handle the repainting yourself and set the <a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_autoredraw"><strong>AutoRedraw</strong></a> property to <strong>false</strong> for the <a href="inkcollector-class.html"><strong>InkCollector</strong></a> object, the <a href="inkoverlay-class.html"><strong>InkOverlay</strong></a> object, or the <a href="inkpicture-control.html">InkPicture</a> control. Use the events in the following table to handle the repainting.</p>
<table>
<thead>
<tr>
<th>Object or Control</th>
<th>Event</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="inkcollector-class.html"><strong>InkCollector</strong></a> Object<!-- raw HTML omitted --></td>
<td>The underlying control's <a href="/dotnet/api/system.windows.forms.control.invalidated?view=netcore-3.1&amp;preserve-view=true">Control.Invalidated</a> and <a href="/dotnet/api/system.windows.forms.control.paint?view=netcore-3.1&amp;preserve-view=true">Control.Paint</a> events.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="inkoverlay-class.html"><strong>InkOverlay</strong></a> Object<!-- raw HTML omitted --></td>
<td>The underlying control's <a href="/dotnet/api/system.windows.forms.control.invalidated?view=netcore-3.1&amp;preserve-view=true">Control.Invalidated</a> and <a href="/dotnet/api/system.windows.forms.control.paint?view=netcore-3.1&amp;preserve-view=true">Control.Paint</a> events.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="inkpicture-control.html">InkPicture</a> Control<!-- raw HTML omitted --></td>
<td><a href="inkpicture-control.html">InkPicture</a> control's inherited <a href="/dotnet/api/system.windows.forms.control.invalidated?view=netcore-3.1&amp;preserve-view=true">Control.Invalidated</a> and <a href="/dotnet/api/system.windows.forms.control.paint?view=netcore-3.1&amp;preserve-view=true">Control.Paint</a> events.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>DynamicRendering Property</h3>
<p>When your application is performing custom rendering or when you want the information, but not the ink, you can handle the laying down of ink yourself and turn off real-time rendering of ink by setting the <a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_dynamicrendering"><strong>DynamicRendering</strong></a> property to <strong>false</strong> for the <a href="inkcollector-class.html"><strong>InkCollector</strong></a> object, the <a href="inkoverlay-class.html"><strong>InkOverlay</strong></a> object, or the <a href="inkpicture-control.html">InkPicture</a> control.</p>
<h2>Event Threading Considerations</h2>
<p>Tablet PC Platform API events are raised on various threads.</p>
<h3>InkCollector and InkOverlay Objects Events</h3>
<p>Most <a href="inkcollector-class.html"><strong>InkCollector</strong></a> and <a href="inkoverlay-class.html"><strong>InkOverlay</strong></a> object events are raised on the ink thread. Only the mouse events for these objects are raised on the UI thread. For example, for the <strong>InkCollector</strong> object, the <a href="inkcollector-mousedown.html"><strong>MouseDown</strong></a> event is raised on the UI thread, and the <a href="inkcollector-cursordown.html"><strong>CursorDown</strong></a> event is raised on the ink thread.</p>
<h3>Ink Object and Strokes Collection Events</h3>
<p>The <a href="inkdisp-class.html"><strong>Ink</strong></a> object and <a href="/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)"><strong>Strokes</strong></a> collection events may come from the ink thread or the UI thread. When your application manipulates the <strong>Ink</strong> object or <strong>Strokes</strong> collection, the event is generated in the UI thread. When the <a href="inkcollector-class.html"><strong>InkCollector</strong></a> or the <a href="inkoverlay-class.html"><strong>InkOverlay</strong></a> object updates the <strong>Ink</strong> object or <strong>Strokes</strong> collection, the event is generated in the ink thread.</p>
<p>The <a href="inkpicture-control-reference.html">InkPicture</a> and <a href="inkedit-control-reference.html">InkEdit</a> controls operate in a single-threaded apartment (STA). When the InkPicture or InkEdit control updates the <a href="inkdisp-class.html"><strong>Ink</strong></a> object or <a href="/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)"><strong>Strokes</strong></a> collection, the event is raised on the UI thread.</p>
<h3>Recognition Events</h3>
<p>Recognition events are raised on the UI thread or the background recognition thread.</p>
<ul>
<li>The <a href="inkedit-control-reference.html">InkEdit</a> control's <a href="/windows/desktop/api/inked/nf-inked-iinkedit-recognize"><strong>Recognize</strong></a> method raises the <a href="/previous-versions/ms836436(v=msdn.10)">Recognition</a> (Managed Library only) or <a href="inkedit-recognitionresult.html"><strong>RecognitionResult</strong></a> (Automation only) event on the UI thread.</li>
<li>The <a href="inkrecognizercontext-class.html"><strong>RecognizerContext</strong></a> object's <a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognize"><strong>BackgroundRecognize</strong></a> and <a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates"><strong>BackgroundRecognizeWithAlternates</strong></a> methods raise the <a href="inkrecognizercontext-recognition.html"><strong>Recognition</strong></a> and <a href="inkrecognizercontext-recognitionwithalternates.html"><strong>RecognitionWithAlternates</strong></a> events on the background recognition thread.</li>
</ul>
<h3>Pen Input Panel Events</h3>
<p><a href="peninputpanel-class.html"><strong>PenInputPanel</strong></a> events are raised on the thread in which the <strong>PenInputPanel</strong> object is created.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/ms836502(v=msdn.10)">Microsoft.Ink.InkCollector.DynamicRendering</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/ms833104(v=msdn.10)">Microsoft.Ink.InkOverlay.DynamicRendering</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/ms582188(v=vs.100)">Microsoft.Ink.InkPicture.DynamicRendering</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/ms836495(v=msdn.10)">Microsoft.Ink.InkCollector.AutoRedraw</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/ms833082(v=msdn.10)">Microsoft.Ink.InkOverlay.AutoRedraw</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/ms582180(v=vs.100)">Microsoft.Ink.InkPicture.AutoRedraw</a></p>
<!-- raw HTML omitted -->
</body>
