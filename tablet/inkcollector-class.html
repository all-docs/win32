<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>InkCollector class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Represents the object that is used to capture ink from available tablet devices.
ms.assetid: 189f430e-9d00-4e29-bb8c-8ac195896793
title: InkCollector class (Msinkaut.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>InkCollector</li>
<li>InkCollector.IInkCollector
api_type:</li>
<li>COM
api_location:</li>
<li>InkObj.dll</li>
<li>InkObj.dll.dll</li>
</ul>
<hr />
<h1>InkCollector class</h1>
<p>Represents the object that is used to capture ink from available tablet devices.</p>
<p>Creating the <strong>InkCollector</strong> control behind a transparent control (such as a GroupBox with the <strong>WS_EX_TRANSPARENT</strong> property set) will prevent <strong>InkCollector</strong> from collecting ink.</p>
<p><strong>InkCollector</strong> has these types of members:</p>
<ul>
<li><a href="#events">Events</a></li>
<li><a href="#interfaces">Interfaces</a></li>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Events</h3>
<p>The <strong>InkCollector</strong> class has these events.</p>
<table>
<thead>
<tr>
<th align="left">Event</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="inkcollector-cursorbuttondown.html"><strong>CursorButtonDown</strong></a></td>
<td align="left">Occurs when the <strong>InkCollector</strong> detects a cursor button that is down.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-cursorbuttonup.html"><strong>CursorButtonUp</strong></a></td>
<td align="left">Occurs when the <strong>InkCollector</strong> detects a cursor button that is up.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-cursordown.html"><strong>CursorDown</strong></a></td>
<td align="left">Occurs when the cursor tip contacts the digitizing tablet surface.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-cursorinrange.html"><strong>CursorInRange</strong></a></td>
<td align="left">Occurs when a cursor enters the physical detection range (proximity) of the tablet context.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-cursoroutofrange.html"><strong>CursorOutOfRange</strong></a></td>
<td align="left">Occurs when the cursor leaves the physical detection range (proximity) of the tablet context.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-doubleclick.html"><strong>DoubleClick</strong></a></td>
<td align="left">Occurs when the <strong>InkCollector</strong> object is double-clicked.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-gesture.html"><strong>Gesture</strong></a></td>
<td align="left">Occurs when an application-specific gesture is recognized.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-mousedown.html"><strong>MouseDown</strong></a></td>
<td align="left">Occurs when the mouse pointer is over the <strong>InkCollector</strong> object and a mouse button is pressed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-mousemove.html"><strong>MouseMove</strong></a></td>
<td align="left">Occurs when the mouse pointer is moved over the <strong>InkCollector</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-mouseup.html"><strong>MouseUp</strong></a></td>
<td align="left">Occurs when the mouse pointer is over the <strong>InkCollector</strong> object and a mouse button is released.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-mousewheel.html"><strong>MouseWheel</strong></a></td>
<td align="left">Occurs when the mouse wheel moves while the <strong>InkCollector</strong> object has focus.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-newinairpackets.html"><strong>NewInAirPackets</strong></a></td>
<td align="left">Occurs when an in-air packet is seen, which happens when a user moves a pen near the tablet and the cursor is within the <strong>InkCollector</strong> object's window or the user moves a mouse within the <strong>InkCollector</strong> object object's associated window.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-newpackets.html"><strong>NewPackets</strong></a></td>
<td align="left">Occurs when the <strong>InkCollector</strong> object receives packets.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-stroke.html"><strong>Stroke</strong></a></td>
<td align="left">Occurs when the user finishes drawing a new stroke on any tablet.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-systemgesture.html"><strong>SystemGesture</strong></a></td>
<td align="left">Occurs when a system gesture is recognized.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-tabletadded.html"><strong>TabletAdded</strong></a></td>
<td align="left">Occurs when a <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet"><strong>Tablet</strong></a> is added to the system.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="inkcollector-tabletremoved.html"><strong>TabletRemoved</strong></a></td>
<td align="left">Occurs when a <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet"><strong>Tablet</strong></a> is removed from the system.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Interfaces</h3>
<p>The <strong>InkCollector</strong> class defines these interfaces.</p>
<table>
<thead>
<tr>
<th align="left">Interface</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>IInkCollector</strong></td>
<td align="left">This object implements the <strong>IInkCollector</strong> COM interface.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Methods</h3>
<p>The <strong>InkCollector</strong> class has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-geteventinterest"><strong>GetEventInterest</strong></a></td>
<td align="left">Retrieves the current state of a particular <strong>InkCollector</strong> object event, that is, whether the event is being listened for or used.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-getgesturestatus"><strong>GetGestureStatus</strong></a></td>
<td align="left">Retrieves whether the <strong>InkCollector</strong> object is interested in a particular gesture.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-getwindowinputrectangle"><strong>GetWindowInputRectangle</strong></a></td>
<td align="left">Retrieves the window rectangle, in pixels, within which ink is drawn.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-setalltabletsmode"><strong>SetAllTabletsMode</strong></a></td>
<td align="left">This mode allows the <strong>InkCollector</strong> object to collect ink from any tablet attached to the Tablet PC.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-seteventinterest"><strong>SetEventInterest</strong></a></td>
<td align="left">Modifies a value that indicates whether a specific event should be listened for or used.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-setgesturestatus"><strong>SetGestureStatus</strong></a></td>
<td align="left">Modifies the interest of the <strong>InkCollector</strong> object in a known gesture.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-setsingletabletintegratedmode"><strong>SetSingleTabletIntegratedMode</strong></a></td>
<td align="left">This mode allows the <strong>InkCollector</strong> object to collect ink from only one tablet. Ink from other tablets is ignored by the <strong>InkCollector</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-setwindowinputrectangle"><strong>SetWindowInputRectangle</strong></a></td>
<td align="left">Modifies the window rectangle, in pixels, to use to map drawn ink to the window.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<p>The <strong>InkCollector</strong> class has these properties.</p>
<table>
<thead>
<tr>
<th align="left">Property</th>
<th align="left">Access type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_autoredraw"><strong>AutoRedraw</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets a value that specifies whether the <strong>InkCollector</strong> repaints the ink when the window is invalidated.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_collectingink"><strong>CollectingInk</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets a value that specifies whether ink is currently being drawn on an <strong>InkCollector</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_collectionmode"><strong>CollectionMode</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets the collection mode that determines whether ink, gestures, or both are recognized as the user writes.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_cursors"><strong>Cursors</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets the <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinkcursors"><strong>Cursors</strong></a> collection that is available for use in the inking region.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_defaultdrawingattributes"><strong>DefaultDrawingAttributes</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets the default <a href="inkdrawingattributes-class.html"><strong>InkDrawingAttributes</strong></a> object, which specifies the drawing attributes that are used when drawing and displaying ink.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_desiredpacketdescription"><strong>DesiredPacketDescription</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets interest in aspects of the packet associated with ink drawn on the <strong>InkCollector</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkoverlay-get_dynamicrendering"><strong>DynamicRendering</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets a value that indicates whether ink is rendered as it is drawn.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_enabled"><strong>Enabled</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets a value that specifies whether the <strong>InkCollector</strong> object collects pen input.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_hwnd"><strong>Handle</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets the handle of the window to which the <strong>InkCollector</strong> object is attached.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_ink"><strong>Ink</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets the <a href="inkdisp-class.html"><strong>InkDisp</strong></a> object that is associated with the <strong>InkCollector</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_marginx"><strong>MarginX</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets the margins along the x-axis, in pixels.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_marginy"><strong>MarginY</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets the margins along the y-axis, in pixels.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_mouseicon"><strong>MouseIcon</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets the current custom mouse icon.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_mousepointer"><strong>MousePointer</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets a value that indicates the type of mouse pointer that appears when the mouse is over a particular part of the object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_renderer"><strong>Renderer</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets the <a href="inkrenderer-class.html"><strong>InkRenderer</strong></a> object that is used to draw ink.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_supporthighcontrastink"><strong>SupportHighContrastInk</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets or sets a value that specifies whether ink is rendered as just one color when the system is in High Contrast mode.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcursor-get_tablet"><strong>Tablet</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets the tablet device that the <strong>InkCollector</strong> object is currently using to collect input.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>This object can be instantiated by calling the <a href="/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> method in C++.</p>
<p>The <strong>InkCollector</strong> object collects only ink and gestures that are input into the specific window with which it is associated. The sole purpose of the <strong>InkCollector</strong> is to collect ink from the hardware (for example, through an <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinkcursor"><strong>IInkCursor</strong></a> and <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet"><strong>IInkTablet</strong></a> object) and deliver it to an application. It essentially acts as the source that distributes ink into one or many different <a href="inkdisp-class.html"><strong>InkDisp</strong></a> objects, which act as container that hold the distributed ink.</p>
<p>To use an <strong>InkCollector</strong>, you create it, tell it on which window to collect drawn ink, and enable it. After it is enabled, it can be set to collect in only one of three modes (the mode is specified in the <a href="/windows/desktop/api/msinkaut/ne-msinkaut-inkcollectionmode"><strong>InkCollectionMode</strong></a> enumeration):</p>
<ul>
<li>InkOnly, in which an <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinkstrokedisp"><strong>IInkStrokeDisp</strong></a> object is created.</li>
<li>GestureOnly, in which an <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinkgesture"><strong>IInkGesture</strong></a> object is created.</li>
<li>InkAndGesture, in which a stroke, a gesture, or potentially both are created, depending on how the application handles events.</li>
</ul>
<p>This means that, for every movement of a cursor that is within range of a tablet, the <strong>InkCollector</strong> always collects either a stroke or a gesture and sometimes both. Gesture support is built in using the Microsoft gesture recognizer.</p>
<p>An <strong>InkCollector</strong> handles all tablet input. Ink can be collected from all attached tablets (including the mouse) simultaneously. Changes in the <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinkcursor"><strong>IInkCursor</strong></a> and <a href="/windows/desktop/api/msinkaut/nn-msinkaut-iinkcursorbutton"><strong>IInkCursorButton</strong></a> objects can cause <strong>InkCollector</strong> object to fire an event.</p>
<p>An <strong>InkCollector</strong> also manages the list of cursors that it encounters during its existence. When the <strong>InkCollector</strong> encounters a new cursor, the <a href="inkcollector-cursorinrange.html"><strong>CursorInRange</strong></a> event fires with the <em>newCursor</em> parameter set to <strong>VARIANT_TRUE</strong>. Applications use the <strong>InkCollector</strong> to manage new cursors.</p>
<p>More than one <strong>InkCollector</strong> can be associated with a particular window handle, even if their collection areas, set in the constructor or with the <a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-setwindowinputrectangle"><strong>SetWindowInputRectangle</strong></a> method, overlap. However, the only way this scenario works is if each <strong>InkCollector</strong> calls <a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-setsingletabletintegratedmode"><strong>SetSingleTabletIntegratedMode</strong></a> and uses a unique tablet. This behavior makes it easy to store ink in a separate object for each tablet.</p>
<p>An error occurs if the window input rectangle of one enabled <strong>InkCollectors</strong> (set with the <a href="/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_enabled"><strong>Enabled</strong></a> property) overlaps the window input rectangle of another enabled <strong>InkCollector</strong>.</p>
<blockquote>
<p>[!Note]<br />
Overlap can occur without an error as long as only one of the input rectangles is enabled at any known time.</p>
</blockquote>
<p>The <a href="inkcollector-mousedown.html"><strong>MouseDown</strong></a>, <a href="inkcollector-mousemove.html"><strong>MouseMove</strong></a>, <a href="inkcollector-mouseup.html"><strong>MouseUp</strong></a>, and <a href="inkcollector-mousewheel.html"><strong>MouseWheel</strong></a> events return x and y-coordinates in pixels, and not the HIMETRIC units that are associated with the ink space. This is because these events replace the mouse events of pen-unaware applications and these applications understand only pixels.</p>
<blockquote>
<p>[!Note]<br />
The <strong>InkCollector</strong> object cannot be safely released on a non-UI thread.</p>
</blockquote>
<p>To improve your application's performance, dispose of your <strong>InkCollector</strong> object when it is no longer needed.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP Tablet PC Edition [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msinkaut.h (also requires Msinkaut_i.c)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->InkObj.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="inkedit-control-reference.html">InkEdit Control Reference</a></p>
<!-- raw HTML omitted -->
<p><a href="inkdisp-class.html"><strong>InkDisp Class</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="inkoverlay-class.html"><strong>InkOverlay Class</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="inkpicture-control-reference.html">InkPicture Control Reference</a></p>
<!-- raw HTML omitted -->
</body>
