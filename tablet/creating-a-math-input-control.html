<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Creating a Math Input Control</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Explains how to create a math input control.
ms.assetid: 59976b01-9032-4226-a160-e9b2d4b8b23b
title: Creating a Math Input Control
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Creating a Math Input Control</h1>
<p>To create the math input control, you must:</p>
<ul>
<li><a href="#include-headers-and-libraries-for-the-math-input-control">Include Headers and Libraries for the Math Input Control</a></li>
<li><a href="#declare-the-control-pointer-and-call-coinitialize-on-the-control-pointer">Declare the Control Pointer and Call CoInitialize on the Control Pointer</a></li>
<li><a href="#show-the-control">Show the Control</a></li>
</ul>
<h2>Include Headers and Libraries for the Math Input Control</h2>
<p>The following code should be placed at the top of your code where you will be using the math input control.</p>
<pre><code>   // includes for implementation
   #include &quot;micaut.h&quot;
   #include &quot;micaut_i.c&quot;
   
</code></pre>
<p>This code will add support for the math input control to your application.</p>
<h2>Declare the Control Pointer and Call CoInitialize on the Control Pointer</h2>
<p>After you have included the headers for your control, you can declare the control pointer and can call CoInitialize on it to create a handle to the math input control interface. The following code can be placed in a class or as a global variable in your application's implementation:</p>
<pre><code>   CComPtr&lt;IMathInputControl&gt; g_spMIC; // Math Input Control
   
</code></pre>
<p>The following code shows how you can call CoInitialize on the control pointer.</p>
<pre><code>   HRESULT hr = CoInitialize(NULL);
   hr = g_spMIC.CoCreateInstance(CLSID_MathInputControl);
   
</code></pre>
<p>After calling CoInitialize on the control pointer, you have a reference to the control and can access the control's methods. For example, you could enable the extended set of controls as shown in the following example.</p>
<pre><code>   hr = g_spMIC-&gt;EnableExtendedButtons(VARIANT_TRUE);
   
</code></pre>
<h2>Show the Control</h2>
<p>The control will not automatically appear after you create it. To show the control, call the <a href="/windows/desktop/api/micaut/nf-micaut-imathinputcontrol-show"><strong>Show</strong></a> method on the control reference that you created in the previous step. The following code demonstrates how the <a href="/windows/win32/api/peninputpanel/nf-peninputpanel-ipeninputpanel-get_autoshow"><strong>Show</strong></a> method can be called.</p>
<pre><code>   hr = g_spMIC-&gt;Show();
   
</code></pre>
<p>After the control shows, it will look something like the following illustration.</p>
<p><img src="images/mic.png" alt="screen shot showing math input control" /></p>
<p>Note that I have enabled the extended set of buttons so that <strong>Redo</strong> and <strong>Undo</strong> are available.</p>
<p>Â </p>
<p>Â </p>
</body>
