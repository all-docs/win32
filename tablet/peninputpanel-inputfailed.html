<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PenInputPanel.InputFailed event</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Deprecated. The PenInputPanel has been replaced by the Text Input Panel (TIP).Occurs when input focus changes before the PenInputPanel object was able to insert user input into the attached control.
ms.assetid: a5928f78-29d6-40e8-8f87-17c188e51ba9
title: PenInputPanel.InputFailed event (Msinkaut.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>PenInputPanel.InputFailed event</h1>
<p>Deprecated. The <a href="peninputpanel-class.html"><strong>PenInputPanel</strong></a> has been replaced by the <a href="text-input-panel-reference.html">Text Input Panel (TIP)</a>.</p>
<p>Occurs when input focus changes before the <a href="peninputpanel-class.html"><strong>PenInputPanel</strong></a> object was able to insert user input into the attached control.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT InputFailed(
  [in]Â long Â hWnd,
  [in]Â long Â Key,
  [in]Â BSTR Â Text,
  [in]Â short ShiftKey
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hWnd</em> [in]</p>
<!-- raw HTML omitted -->
<p>The window handle of the control that invoked the <a href="peninputpanel-class.html"><strong>PenInputPanel</strong></a> object.</p>
<!-- raw HTML omitted -->
<p><em>Key</em> [in]</p>
<!-- raw HTML omitted -->
<p>The virtual key corresponding to the key pressed.</p>
<!-- raw HTML omitted -->
<p><em>Text</em> [in]</p>
<!-- raw HTML omitted -->
<p>The string that was to be inserted into the control represented by the <em>hWnd</em> parameter when the <strong>InputFailed</strong> event was raised.</p>
<p>For more information about the BSTR data type, see <a href="using-the-com-library.html">Using the COM Library</a>.</p>
<!-- raw HTML omitted -->
<p><em>ShiftKey</em> [in]</p>
<!-- raw HTML omitted -->
<p>The state of the keyboard modifiers, including SHIFT, CAPS, CTRL, and ALT.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If this event succeeds, it returns <strong>S_OK</strong>. Otherwise, it returns an <strong>HRESULT</strong> error code.</p>
<h2>Remarks</h2>
<p>The <strong>InputFailed</strong> event occurs when input focus changes before user input was inserted into the attached control. For example, if the user enters ink into the writing pad, then taps on another edit control before the recognizer has had a chance to finish, this event fires.</p>
<p>Using the window handle passed into this event, you can choose to insert the text yourself when this event occurs.</p>
<blockquote>
<p>[!Note]<br />
Starting with Microsoft Windows XP Tablet PC Edition 2005, the <strong>InputFailed</strong> event no longer applies. Text is always inserted before focus changes.</p>
</blockquote>
<p>Â </p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ XP Tablet PC Edition [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Msinkaut.h (also requires Msinkaut_i.c)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->InkObj.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="peninputpanel-class.html"><strong>PenInputPanel</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
