<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IContextNode interface</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Represents a node in a tree of objects that are created as part of ink analysis.
ms.assetid: 44ef4401-cb14-4348-9ed8-b11a40d04940
title: IContextNode interface (IACom.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>IContextNode
api_type:</li>
<li>COM
api_location:</li>
<li>IACom.dll</li>
</ul>
<hr />
<h1>IContextNode interface</h1>
<p>Represents a node in a tree of objects that are created as part of ink analysis.</p>
<h2>Members</h2>
<p>The <strong>IContextNode</strong> interface inherits from the <a href="/windows/desktop/api/unknwn/nn-unknwn-iunknown"><strong>IUnknown</strong></a> interface. <strong>IContextNode</strong> also has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>IContextNode</strong> interface has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="icontextnode-addcontextlink.html"><strong>AddContextLink</strong></a></td>
<td align="left">Adds a new <a href="icontextlink.html"><strong>IContextLink</strong></a> to the <strong>IContextNode</strong> object's context link collection.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-addpropertydata.html"><strong>AddPropertyData</strong></a></td>
<td align="left">Adds a piece of application-specific data.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-confirm.html"><strong>Confirm</strong></a></td>
<td align="left">Modifies the confirmation type, which controls what the <a href="iinkanalyzer.html"><strong>IInkAnalyzer</strong></a> object can change about the <strong>IContextNode</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-containspropertydata.html"><strong>ContainsPropertyData</strong></a></td>
<td align="left">Determines whether the <strong>IContextNode</strong> object contains data stored under the specified identifier.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-createpartiallypopulatedsubnode.html"><strong>CreatePartiallyPopulatedSubNode</strong></a></td>
<td align="left">Creates a child <strong>IContextNode</strong> object that contains only information on type, identifier, and location.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-createsubnode.html"><strong>CreateSubNode</strong></a></td>
<td align="left">Creates a new child <strong>IContextNode</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-deletecontextlink.html"><strong>DeleteContextLink</strong></a></td>
<td align="left">Deletes an <a href="icontextlink.html"><strong>IContextLink</strong></a> object from the <strong>IContextNode</strong> object's link collection.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-deletesubnode.html"><strong>DeleteSubNode</strong></a></td>
<td align="left">Removes a child <strong>IContextNode</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getcontextlinks.html"><strong>GetContextLinks</strong></a></td>
<td align="left">Retrieves a collection of <a href="icontextlink.html"><strong>IContextLink</strong></a> objects that represents relationships with other <strong>IContextNode</strong> objects.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getid.html"><strong>GetId</strong></a></td>
<td align="left">Retrieves the identifier for the <strong>IContextNode</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getlocation.html"><strong>GetLocation</strong></a></td>
<td align="left">Retrieves the position and size of the <strong>IContextNode</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getparentnode.html"><strong>GetParentNode</strong></a></td>
<td align="left">Retrieves the parent node of this <strong>IContextNode</strong> in the context node tree.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getpartiallypopulated.html"><strong>GetPartiallyPopulated</strong></a></td>
<td align="left">Retrieves the value that indicates whether an <strong>IContextNode</strong> object is partially populated or fully populated.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getpropertydata.html"><strong>GetPropertyData</strong></a></td>
<td align="left">Retrieves application-specific data or other property data given the specified identifier.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getpropertydataids.html"><strong>GetPropertyDataIds</strong></a></td>
<td align="left">Retrieves the identifiers for which there is property data.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getstrokecount.html"><strong>GetStrokeCount</strong></a></td>
<td align="left">Retrieves the number of strokes associated with the <strong>IContextNode</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getstrokeid.html"><strong>GetStrokeId</strong></a></td>
<td align="left">Retrieves the stroke identifier for the stroke referenced by an index value within the <strong>IContextNode</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getstrokeids.html"><strong>GetStrokeIds</strong></a></td>
<td align="left">Retrieves an array of identifiers for the strokes within the <strong>IContextNode</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getstrokepacketdatabyid.html"><strong>GetStrokePacketDataById</strong></a></td>
<td align="left">Retrieves an array containing the packet property data for the specified stroke.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getstrokepacketdescriptionbyid.html"><strong>GetStrokePacketDescriptionById</strong></a></td>
<td align="left">Retrieves an array containing the packet property identifiers for the specified stroke.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-getsubnodes.html"><strong>GetSubNodes</strong></a></td>
<td align="left">Retrieves the direct child nodes of the <strong>IContextNode</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-gettype.html"><strong>GetType</strong></a></td>
<td align="left">Retrieves the type of the <strong>IContextNode</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-gettypename.html"><strong>GetTypeName</strong></a></td>
<td align="left">Retrieves a human-readable type name of this <strong>IContextNode</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-isconfirmed.html"><strong>IsConfirmed</strong></a></td>
<td align="left">Retrieves a value that indicates whether the <strong>IContextNode</strong> object is confirmed. <a href="iinkanalyzer.html"><strong>IInkAnalyzer</strong></a> cannot change the node type and associated strokes for confirmed <strong>IContextNode</strong> objects.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-loadpropertiesdata.html"><strong>LoadPropertiesData</strong></a></td>
<td align="left">Recreates the application-specific and internal property data for an array of bytes that was previously created with <a href="icontextnode-savepropertiesdata.html"><strong>IContextNode::SavePropertiesData</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-movesubnodetoposition.html"><strong>MoveSubNodeToPosition</strong></a></td>
<td align="left">Reorders a specified child <strong>IContextNode</strong> object to the specified index.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-removepropertydata.html"><strong>RemovePropertyData</strong></a></td>
<td align="left">Removes a piece of application-specific data.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-reparent.html"><strong>Reparent</strong></a></td>
<td align="left">Moves this <strong>IContextNode</strong> object from its parent context node's subnodes collection to the specified context node's subnodes collection.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-reparentstrokebyidtonode.html"><strong>ReparentStrokeByIdToNode</strong></a></td>
<td align="left">Moves stroke data from this <strong>IContextNode</strong> to the specified <strong>IContextNode</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-savepropertiesdata.html"><strong>SavePropertiesData</strong></a></td>
<td align="left">Retrieves an array of bytes that contains the application-specific and internal property data for this <strong>IContextNode</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-setlocation.html"><strong>SetLocation</strong></a></td>
<td align="left">Updates the position and size of this <strong>IContextNode</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-setpartiallypopulated.html"><strong>SetPartiallyPopulated</strong></a></td>
<td align="left">Modifies the value that indicates whether this <strong>IContextNode</strong> is partially or fully populated.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="icontextnode-setstrokes.html"><strong>SetStrokes</strong></a></td>
<td align="left">Associates the specified strokes with this <strong>IContextNode</strong>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>The types of nodes are described in the <a href="context-node-types.html">Context Node Types</a> constants.</p>
<h2>Examples</h2>
<p>The following example shows a method that examines an <strong>IContextNode</strong>; the method does the following:</p>
<ul>
<li>Gets the context node's type. If the context node is an unclassified ink, analysis hint, or custom recognizer node, it calls a helper method to examine specific properties of the node type.</li>
<li>If the node has subnodes, it examines each subnode by calling itself.</li>
<li>If the node is an ink leaf node, it examines the stroke data for the node by calling a helper method.</li>
</ul>
<p>Ihe InkAnalysis API allows you to create a line node that contains ink words and text words. However, the parser will ignore these mixed nodes and will treat them like foreign nodes. This will have impact the parsing accuracy of detecting ink annotations when the end user writes on or around this mixed node.</p>
<pre lang="C++"><code>HRESULT CMyClass::ExploreContextNode(
    IContextNode *pContextNode)
{
    // Check for certain types of context nodes.
    GUID ContextNodeType;
    HRESULT hr = pContextNode-&gt;GetType(&amp;ContextNodeType);

    if (SUCCEEDED(hr))
    {
        if (IsEqualGUID(GUID_CNT_UNCLASSIFIEDINK, ContextNodeType))
        {
            // Call a helper method that explores unclassified ink nodes.
            hr = this-&gt;ExploreUnclassifiedInkNode(pContextNode);
        }
        else if (IsEqualGUID(GUID_CNT_ANALYSISHINT, ContextNodeType))
        {
            // Call a helper method that explores analysis hint nodes.
            hr = this-&gt;ExploreAnalysisHintNode(pContextNode);
        }
        else if (IsEqualGUID(GUID_CNT_CUSTOMRECOGNIZER, ContextNodeType))
        {
            // Call a helper method that explores custom recognizer nodes.
            hr = this-&gt;ExploreCustomRecognizerNode(pContextNode);
        }

        if (SUCCEEDED(hr))
        {
            // Check if this node is a branch or a leaf node.
            IContextNodes *pSubNodes = NULL;
            hr = pContextNode-&gt;GetSubNodes(&amp;pSubNodes);

            if (SUCCEEDED(hr))
            {
                ULONG ulSubNodeCount;
                hr = pSubNodes-&gt;GetCount(&amp;ulSubNodeCount);

                if (SUCCEEDED(hr))
                {
                    if (ulSubNodeCount &gt; 0)
                    {
                        // This node has child nodes; explore each child node.
                        IContextNode *pSubNode = NULL;
                        for (ULONG index=0; index&lt;ulSubNodeCount; index++)
                        {
                            hr = pSubNodes-&gt;GetContextNode(index, &amp;pSubNode);

                            if (SUCCEEDED(hr))
                            {
                                // Recursive call to explore the child node of this
                                // context node.
                                hr = this-&gt;ExploreContextNode(pSubNode);
                            }

                            // Release this reference to the child context node.
                            if (pSubNode != NULL)
                            {
                                pSubNode-&gt;Release();
                                pSubNode = NULL;
                            }

                            if (FAILED(hr))
                            {
                                break;
                            }
                        }
                    }
                    else
                    {
                        // This is a leaf node. Check if it contains stroke data.
                        ULONG ulStrokeCount;
                        hr = pContextNode-&gt;GetStrokeCount(&amp;ulStrokeCount);

                        if (SUCCEEDED(hr))
                        {
                            if (ulStrokeCount &gt; 0)
                            {
                                // This node is an ink leaf node; call helper
                                // method that explores available stroke data.
                                hr = this-&gt;ExploreNodeStrokeData(pContextNode);
                            }
                        }
                    }
                }
            }

            // Release this reference to the subnodes collection.
            if (pSubNodes != NULL)
            {
                pSubNodes-&gt;Release();
                pSubNodes = NULL;
            }
        }
    }

    return hr;
}
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP Tablet PC Edition [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->IACom.h (also requires IACom_i.c)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->IACom.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="icontextnodes.html"><strong>IContextNodes</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="context-node-types.html">Context Node Types</a></p>
<!-- raw HTML omitted -->
<p><a href="iinkanalyzer.html"><strong>IInkAnalyzer</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="ink-analysis-reference.html">Ink Analysis Reference</a></p>
<!-- raw HTML omitted -->
</body>
