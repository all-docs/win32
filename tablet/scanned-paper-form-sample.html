<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Scanned Paper Form Sample</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: In this C# sample, a paper form has been scanned as a Portable Network Graphics (PNG) file and specified as the background image at run time for a InkPicture control. The sample uses a message box to display handwriting recognition results.
ms.assetid: fc9a39c2-9e4b-4d22-a118-3d24544897dd
title: Scanned Paper Form Sample
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Scanned Paper Form Sample</h1>
<p>In this C# sample, a paper form has been scanned as a Portable Network Graphics (PNG) file and specified as the background image at run time for a <a href="/previous-versions/aa514604(v=msdn.10)">InkPicture</a> control. The sample uses a message box to display handwriting recognition results.</p>
<p>The sample includes an Extensible Markup Language (XML) file, Formdata.xml. The XML file contains the name of the PNG file. It also contains <code>FieldInfo</code> elements that define rectangular regions on the form where a user can enter ink. The information in the <code>FieldInfo</code> element is shown in the following example:</p>
<pre lang="C++"><code>    &lt;FieldInfo&gt;
        &lt;Name&gt;first name&lt;/Name&gt;
        &lt;Left&gt;88&lt;/Left&gt;
        &lt;Top&gt;65&lt;/Top&gt;
        &lt;Right&gt;332&lt;/Right&gt;
        &lt;Bottom&gt;94&lt;/Bottom&gt;
    &lt;/FieldInfo&gt;
</code></pre>
<p>The Left, Top, Right, and Bottom elements are definitions of pixel coordinates for each field.</p>
<p>The sample initializes a new <a href="/dotnet/api/system.data.dataset?view=netcore-3.1&amp;preserve-view=true">DataSet</a> with the data contained in Formdata.xml:</p>
<pre lang="C++"><code>    formData = new DataSet(&quot;FormData&quot;);
    formData.ReadXml(&quot;formdata.xml&quot;); 
</code></pre>
<p>The form image specified in Formdata.xml is loaded as the background of the <a href="/previous-versions/aa514604(v=msdn.10)">InkPicture</a> control:</p>
<pre lang="C++"><code>    inkPicture1.BackgroundImage = 
        System.Drawing.Image.FromFile(
        (string) formData.Tables[&quot;FormData&quot;].Rows[0][&quot;Image&quot;]);
</code></pre>
<p>Ink collection is then enabled for the <a href="/previous-versions/aa514604(v=msdn.10)">InkPicture</a> control:</p>
<pre lang="C++"><code>    inkPicture1.InkEnabled = true;
</code></pre>
<h2>Menu Event Handlers</h2>
<p>The application includes click event handlers for all of the menus displayed along the top of the form.</p>
<h3>Recognize Menu Item</h3>
<p>The Recognize menu click event handler disables ink collection for the control and checks for a handwriting recognizer. If no recognizer is installed, a dialog box is displayed. A user must then click the Ink or Pen menu option to re-enable the control for ink input.</p>
<p>If a recognizer is installed, the <code>Recognize</code> function retrieves the XML data that specifies pixel coordinates for each form field. The coordinates are converted to ink space coordinates, and a rectangle is defined for each form field. After rectangles are defined, the function finds the strokes that intersect and lie within each rectangle. Finally, it performs recognition on the ink and displays the results in a message box.</p>
<h3>Ink Menu Item</h3>
<p>The Ink menu click event handler enables the <a href="/previous-versions/aa514604(v=msdn.10)">InkPicture</a> control.</p>
<h3>Pen Menu Item</h3>
<p>The Pen menu click event handler performs the following tasks:</p>
<ul>
<li>Disables ink collection for the <a href="/previous-versions/aa514604(v=msdn.10)">InkPicture</a> control (which is necessary before changing the <a href="/previous-versions/ms582189(v=vs.100)">EditingMode</a> property).</li>
<li>Sets the <a href="/previous-versions/ms582189(v=vs.100)">EditingMode</a> property to collect ink.</li>
<li>Re-enables ink collection for the <a href="/previous-versions/aa514604(v=msdn.10)">InkPicture</a> control and toggles the Pen, Select, and Eraser menus to indicate the active mode.</li>
</ul>
<h3>Edit Menu Item</h3>
<p>The Edit menu click event handler is similar to the Pen menu event handler. It performs the following tasks:</p>
<ul>
<li>Disables ink collection.</li>
<li>Sets the <a href="/previous-versions/ms582189(v=vs.100)">EditingMode</a> property to <strong>Select</strong>, which enables the user to perform ink selection.</li>
<li>Re-enables ink collection and toggles the Pen, Edit, and Eraser menus to indicate the active mode.</li>
</ul>
<h3>Eraser Menu Item</h3>
<p>The Eraser menu click event handler sets the <a href="/previous-versions/aa514604(v=msdn.10)">InkPicture</a> control <a href="/previous-versions/ms582189(v=vs.100)">EditingMode</a> to <strong>Delete</strong>, which enables a user to erase ink. It also toggles the Pen, Edit, and Eraser menu items.</p>
<h3>Clear Menu Item</h3>
<p>The Clear menu click event handler deletes the current <a href="/previous-versions/ms552701(v=vs.100)">Strokes</a> collection for the <a href="/previous-versions/aa514604(v=msdn.10)">InkPicture</a> control, thereby erasing all of the ink on the form.</p>
<h2>Closing the Form</h2>
<p>In the Windows Form Designer generated code, the <a href="/previous-versions/aa514604(v=msdn.10)">InkPicture</a> control is added to the form's component list when the form is initialized. When the form closes, the InkPicture control is disposed, as well as the other components of the form, by the form's <a href="/dotnet/api/system.windows.forms.form.dispose?view=netcore-3.1&amp;preserve-view=true">Dispose</a> method.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="inkedit-control.html">InkEdit Control</a></p>
<!-- raw HTML omitted -->
<p><a href="inkpicture-control.html">InkPicture Control</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
