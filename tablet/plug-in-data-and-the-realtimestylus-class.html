<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Plug-in Data and the RealTimeStylus Class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Plug-ins for the RealTimeStylus class must implement the IStylusSyncPlugin or IStylusAsyncPlugin interface, or both.
ms.assetid: 827ac817-e0e6-4750-9d48-b939ccd5e679
title: Plug-in Data and the RealTimeStylus Class
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Plug-in Data and the RealTimeStylus Class</h1>
<p>Plug-ins for the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> class must implement the <a href="/windows/win32/api/rtscom/nn-rtscom-istylussyncplugin"><strong>IStylusSyncPlugin</strong></a> or <a href="/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin"><strong>IStylusAsyncPlugin</strong></a> interface, or both. While you have to implement all of the plug-in interface methods, your plug-in only receives calls on methods flagged in the plug-ins <a href="/previous-versions/ms574887(v=vs.100)">Microsoft.StylusInput.IStylusSyncPlugin.DataInterest</a> or <a href="/previous-versions/ms574886(v=vs.100)">Microsoft.StylusInput.IStylusAsyncPlugin.DataInterest</a> property.</p>
<p>The methods defined on the interfaces use objects in the <a href="/previous-versions/ms823992(v=msdn.10)">Microsoft.StylusInput.PluginData</a> namespace to pass the pen data to the plug-ins. The following table describes the data objects that are parameters in the notification methods and lists the <a href="/previous-versions/ms824787(v=msdn.10)">DataInterestMask</a> value associated with the notification.</p>
<table>
<thead>
<tr>
<th>Plug-in Data</th>
<th>DataInterestMask Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/previous-versions/ms824747(v=msdn.10)">CustomStylusData</a></td>
<td><strong>CustomStylusDataAdded</strong></td>
<td>Custom application data that a plug-in adds.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms824740(v=msdn.10)">ErrorData</a></td>
<td><strong>Error</strong></td>
<td>Error information that the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object adds in response to an unhandled exception in one of its plug-ins.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms824592(v=msdn.10)">InAirPacketsData</a></td>
<td><strong>InAirPackets</strong></td>
<td>Packet information for stylus motion while the stylus is in-air above the digitizer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms824590(v=msdn.10)">PacketsData</a></td>
<td><strong>Packets</strong></td>
<td>Packet information for stylus motion while the stylus is touching the digitizer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms824576(v=msdn.10)">RealTimeStylusDisabledData</a></td>
<td><strong>RealTimeStylusDisabled</strong></td>
<td>Information the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object adds when it is being disabled.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms824229(v=msdn.10)">RealTimeStylusEnabledData</a></td>
<td><strong>RealTimeStylusEnabled</strong></td>
<td>Information the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object adds when it is being enabled.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms824181(v=msdn.10)">StylusButtonDownData</a></td>
<td><strong>StylusButtonDown</strong></td>
<td>Information about the particular stylus button that is being pressed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms824172(v=msdn.10)">StylusButtonUpData</a></td>
<td><strong>StylusButtonUp</strong></td>
<td>Information about the particular stylus button that is being released.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms585582(v=vs.100)">StylusDownData</a></td>
<td><strong>StylusDown</strong></td>
<td>Packet information for a stylus as the stylus is brought in contact with the digitizer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms824090(v=msdn.10)">StylusInRangeData</a></td>
<td><strong>StylusInRange</strong></td>
<td>Information about the particular stylus that is entering the input area of the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object or entering the detection range of the digitizer above the input area of the <strong>RealTimeStylus</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms824072(v=msdn.10)">StylusOutOfRangeData</a></td>
<td><strong>StylusOutOfRange</strong></td>
<td>Information about the particular stylus that is leaving the input area of the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object or leaving the detection range of the digitizer above the input area of the <strong>RealTimeStylus</strong> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms824057(v=msdn.10)">StylusUpData</a></td>
<td><strong>StylusUp</strong></td>
<td>Packet information for a stylus as the stylus is lifted from the digitizer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms824019(v=msdn.10)">SystemGestureData</a></td>
<td><strong>SystemGesture</strong></td>
<td>Information the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object adds when it detects a system gesture.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms824010(v=msdn.10)">TabletAddedData</a></td>
<td><strong>TabletAdded</strong></td>
<td>Information about the <a href="/previous-versions/ms827783(v=msdn.10)">Tablet</a> object that is being added.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/ms823997(v=msdn.10)">TabletRemovedData</a></td>
<td><strong>TabletRemoved</strong></td>
<td>Information about the <a href="/previous-versions/ms827783(v=msdn.10)">Tablet</a> object that is being removed.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>For information about how the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object handles the tablet pen data stream, see <a href="working-with-the-realtimestylus-class.html">Working with the RealTimeStylus Class</a>.</p>
<h2>Data Interest</h2>
<p>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object checks the <a href="/previous-versions/ms574887(v=vs.100)">Microsoft.StylusInput.IStylusSyncPlugin.DataInterest</a> or <a href="/previous-versions/ms574886(v=vs.100)">Microsoft.StylusInput.IStylusAsyncPlugin.DataInterest</a> property of a plug-in when the plug-in is added to the <strong>RealTimeStylus</strong> object's synchronous or asynchronous plug-in collection. Therefore, you should use the DataInterest property to subscribe to all of the notifications this instance of your plug-in uses, however infrequently, but not to any of the notifications this instance of your plug-in never uses. For notifications that your plug-in only uses occasionally check the state of your plug-in in the notification method first and return if the notification is not used by your plug-in in its current state.</p>
<p>A plug-in only receives calls on methods flagged in the plug-in's <a href="/previous-versions/ms574887(v=vs.100)">Microsoft.StylusInput.IStylusSyncPlugin.DataInterest</a> or <a href="/previous-versions/ms574886(v=vs.100)">Microsoft.StylusInput.IStylusAsyncPlugin.DataInterest</a> property. For more information about the possible values of a plug-in's <strong>DataInterest</strong> property, see the <a href="/previous-versions/ms824787(v=msdn.10)">DataInterestMask</a> enumeration.</p>
<h2>Timing</h2>
<p>Data is queued in the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object before it is passed to the plug-ins in the asynchronous plug-in collection. The following list describes some situations that you may need to account for when designing an asynchronous plug-in.</p>
<ul>
<li>When the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object is disabled, the asynchronous plug-in may receive other queued notifications before its <a href="/previous-versions/ms824774(v=msdn.10)">RealTimeStylusDisabled</a> method is called. In this situation, calls from the plug-in to some of the <strong>RealTimeStylus</strong> object's methods and properties throw an exception. Information relevant to your plug-in should be cached when the <strong>RealTimeStylus</strong> object is enabled.</li>
<li>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's <a href="/previous-versions/ms825781(v=msdn.10)">ClearStylusQueues</a> method may remove information from the output queue. Therefore, asynchronous plug-ins cannot rely on receiving all relevant notifications.</li>
<li>When a <a href="/previous-versions/ms827783(v=msdn.10)">Tablet</a> object that is available to the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object is removed, the asynchronous plug-in may receive queued stylus notification for the tablet before its <a href="/previous-versions/bb361092(v=vs.100)">TabletRemoved</a> method is called. In this situation, calling the <strong>RealTimeStylus</strong> object's <a href="/previous-versions/ms825935(v=msdn.10)">GetTabletPropertyDescriptionCollection</a> method does not work. Information relevant to your plug-in should be cached when the <strong>RealTimeStylus</strong> object is enabled or when a new tablet is added.</li>
</ul>
<p>Depending on your application, you can improve performance when disabling a <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object. When the <strong>RealTimeStylus</strong> object's <a href="/previous-versions/ms824832(v=msdn.10)">Enabled</a> property is set to <strong>FALSE</strong>, data on the input and output queues are processed until the queues are empty. You can call the <strong>RealTimeStylus</strong> object's <a href="/previous-versions/ms825781(v=msdn.10)">ClearStylusQueues</a> method to clear the queues before disabling the <strong>RealTimeStylus</strong> object.</p>
<h2>Enabled and Disabled Data</h2>
<p>When the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object is enabled, each plug-in receives a call to its <a href="/previous-versions/ms824758(v=msdn.10)">Microsoft.StylusInput.IStylusSyncPlugin.RealTimeStylusEnabled</a> or <a href="/previous-versions/ms824775(v=msdn.10)">Microsoft.StylusInput.IStylusAsyncPlugin.RealTimeStylusEnabled</a> method. The <strong>RealTimeStylusEnabledData</strong> object passed in the notification contains a collection of the context identifiers for the available tablets at the time the <strong>RealTimeStylus</strong> object is enabled.</p>
<blockquote>
<p>[!Note]<br />
Because the plug-in data for the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's asynchronous plug-in collection is queued, asynchronous plug-ins may receive data prior to receiving a call to its <a href="/previous-versions/ms824774(v=msdn.10)">RealTimeStylusDisabled</a> method but after the <strong>RealTimeStylus</strong> object is disabled. Note that some of the <strong>RealTimeStylus</strong> object's methods and properties throw an exception if the <strong>RealTimeStylus</strong> object is disabled.</p>
</blockquote>
<p>Â </p>
<p>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object calls the <a href="/previous-versions/ms824758(v=msdn.10)">Microsoft.StylusInput.IStylusSyncPlugin.RealTimeStylusEnabled</a> and <a href="/previous-versions/ms824757(v=msdn.10)">Microsoft.StylusInput.IStylusSyncPlugin.RealTimeStylusDisabled</a> methods on the thread from which the <strong>RealTimeStylus</strong> object is enabled or from which the synchronous plug-in is added.</p>
<p>Generally, add or remove plug-ins while the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object is disabled. For more information about adding and removing plug-ins to the <strong>RealTimeStylus</strong> object, see <a href="plug-ins-and-the-realtimestylus-class.html">Plug-ins and the RealTimeStylus Class</a>.</p>
<h2>Tablet Data</h2>
<p>When a tablet that the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object can use is added to or removed from the Tablet PC while the <strong>RealTimeStylus</strong> object is enabled, the <strong>RealTimeStylus</strong> object notifies its plug-ins that a <a href="/previous-versions/ms827783(v=msdn.10)">Tablet</a> object has been added or removed. Each <strong>RealTimeStylus</strong> object maintains a list of unique identifiers for the Tablet objects it can interact with. The <strong>RealTimeStylus</strong> object has two methods for translating between the unique identifier and the Tablet object, the <a href="/previous-versions/ms825922(v=msdn.10)">GetTabletContextIdFromTablet</a> and <a href="/previous-versions/ms825929(v=msdn.10)">GetTabletFromTabletContextId</a> methods.</p>
<blockquote>
<p>[!Note]<br />
Information about a tablet is no longer available from the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object after the tablet is removed from the Tablet PC.</p>
</blockquote>
<p>Â </p>
<h2>Tablet Pen Data</h2>
<p>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object passes information about the tablet pen to its plug-ins in a number of the notification methods. Information about the tablet pen is represented by a <a href="/previous-versions/ms824824(v=msdn.10)">Stylus</a> object. This object is a snapshot of the state of the tablet pen at the time the data was gathered. Because plug-ins receive the tablet pen data as part of the tablet pen data stream, the plug-ins should use the information in the Stylus object instead of checking for the current state of a particular tablet pen through the <a href="/previous-versions/ms839521(v=msdn.10)">Cursor</a> class.</p>
<p>Each <a href="/previous-versions/ms824824(v=msdn.10)">Stylus</a> object contains the tablet context identifier for the tablet that generated the data.</p>
<h2>System Gesture Data</h2>
<p>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object receives data about system gestures as they are recognized by the Tablet PC. The following table describes the order in which the <a href="/previous-versions/ms824019(v=msdn.10)">SystemGestureData</a> objects occur in the tablet pen data stream in relation to other tablet pen data.</p>
<table>
<thead>
<tr>
<th><!-- raw HTML omitted -->SystemGesture<!-- raw HTML omitted --></th>
<th>Objects that precede the <!-- raw HTML omitted -->SystemGestureData<!-- raw HTML omitted --> object</th>
<th>Objects that come after the <!-- raw HTML omitted -->SystemGestureData<!-- raw HTML omitted --> object</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->Tap<!-- raw HTML omitted --></td>
<td>The <!-- raw HTML omitted -->StylusDownData<!-- raw HTML omitted --> object.<!-- raw HTML omitted --></td>
<td>The <a href="/previous-versions/ms824057(v=msdn.10)">StylusUpData</a> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->DoubleTap<!-- raw HTML omitted --></td>
<td>The <!-- raw HTML omitted -->StylusDownData<!-- raw HTML omitted --> object, the <!-- raw HTML omitted -->SystemGestureData<!-- raw HTML omitted --> object for the <!-- raw HTML omitted -->Tap<!-- raw HTML omitted --> system gesture and the <a href="/previous-versions/ms824057(v=msdn.10)">StylusUpData</a> objects.<!-- raw HTML omitted --></td>
<td>The second <!-- raw HTML omitted -->StylusDownData<!-- raw HTML omitted --> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->RightTap<!-- raw HTML omitted --></td>
<td>The <!-- raw HTML omitted -->StylusDownData<!-- raw HTML omitted --> object and the <!-- raw HTML omitted -->SystemGestureData<!-- raw HTML omitted --> object for the <!-- raw HTML omitted -->HoldEnter<!-- raw HTML omitted --> member of the <!-- raw HTML omitted -->SystemGesure<!-- raw HTML omitted --> enumeration.<!-- raw HTML omitted --></td>
<td>The <a href="/previous-versions/ms824057(v=msdn.10)">StylusUpData</a> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->Drag<!-- raw HTML omitted --></td>
<td>The <!-- raw HTML omitted -->StylusDownData<!-- raw HTML omitted --> object.<!-- raw HTML omitted --></td>
<td>The <a href="/previous-versions/ms824057(v=msdn.10)">StylusUpData</a> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->RightDrag<!-- raw HTML omitted --></td>
<td>The <!-- raw HTML omitted -->StylusDownData<!-- raw HTML omitted --> object.<!-- raw HTML omitted --></td>
<td>The <a href="/previous-versions/ms824057(v=msdn.10)">StylusUpData</a> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>HoldEnter</strong></td>
<td>The <a href="/previous-versions/ms824107(v=msdn.10)">StylusDownData</a> object.<!-- raw HTML omitted --></td>
<td>The <a href="/previous-versions/ms824057(v=msdn.10)">StylusUpData</a> object.<!-- raw HTML omitted --> <strong>Note:</strong> This system gesture isn't recognized if the user begins a <strong>Drag</strong> or <strong>RightDrag</strong> system gesture.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->HoldLeave<!-- raw HTML omitted --></td>
<td>Not implemented.<!-- raw HTML omitted --></td>
<td>Not implemented.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>HoverEnter</strong></td>
<td>Several <a href="/previous-versions/ms824592(v=msdn.10)">InAirPacketsData</a> objects of low average velocity.<!-- raw HTML omitted --></td>
<td><strong>Note:</strong> There may be noticeable delay before receiving the <strong>HoverEnter</strong> system gesture. The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object only receives this data if the <strong>RealTimeStylus</strong> object is attached to the window or control that is directly under the pen at the time of the system gesture.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>HoverLeave</strong></td>
<td>The <a href="/previous-versions/ms824019(v=msdn.10)">SystemGestureData</a> object for the <strong>HoverEnter</strong> system gesture and several <a href="/previous-versions/ms824592(v=msdn.10)">InAirPacketsData</a> objects of sufficient average velocity.<!-- raw HTML omitted --></td>
<td><strong>Note:</strong> There may be noticeable delay before receiving the <strong>HoverLeave</strong> system gesture. The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object only receives this data if the <strong>RealTimeStylus</strong> object is attached to the window or control that is directly under the pen at the time of the system gesture.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Custom Stylus Data</h2>
<p>Custom stylus data can be added to the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object by calling the <a href="/previous-versions/ms825761(v=msdn.10)">AddCustomStylusDataToQueue</a> method. Custom stylus data can be added to the <strong>RealTimeStylus</strong> object's queues in one of three places.</p>
<ul>
<li>When the <em>queue</em> parameter is set to <strong>Output</strong>, the custom data is added to the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's output queue after the data currently being processed by the synchronous plug-in collection.</li>
<li>When the <em>queue</em> parameter is set to <strong>OutputImmediate</strong>, the custom data is added to the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's output queue before the data currently being processed by the synchronous plug-in collection.</li>
<li>When the <em>queue</em> parameter is set to <strong>Input</strong>, the custom data is added to the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's input queue and is sent to the synchronous plug-in collection before new data from the tablet pen's data stream.</li>
</ul>
<p>In each of the previous cases, data added by subsequent plug-ins in the synchronous plug-in collection is added after data added by preceding plug-ins.</p>
<blockquote>
<p>[!Note]<br />
If the call to the <a href="/previous-versions/ms825761(v=msdn.10)">AddCustomStylusDataToQueue</a> method is made from a synchronous plug-in in response to a call to one of its <a href="/windows/win32/api/rtscom/nn-rtscom-istylussyncplugin"><strong>IStylusSyncPlugin</strong></a> methods, then the custom stylus data is added to the tablet pen data stream in a predictable manner; otherwise, it is added to the queue in relation to the current pen data the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object is processing, and not in relation to the data that the asynchronous plug-in is processing. The AddCustomStylusDataToQueue method throws an exception if the <strong>RealTimeStylus</strong> object is disabled.</p>
</blockquote>
<p>Â </p>
<p>Custom stylus data is added to the queue as a <a href="/previous-versions/ms824747(v=msdn.10)">CustomStylusData</a> object and plug-ins receive this data through their <a href="/previous-versions/ms824753(v=msdn.10)">Microsoft.StylusInput.IStylusSyncPlugin.CustomStylusDataAdded</a> or <a href="/previous-versions/ms824770(v=msdn.10)">Microsoft.StylusInput.IStylusAsyncPlugin.CustomStylusDataAdded</a> method.</p>
<p>The <a href="/previous-versions/windows/desktop/legacy/ms701168(v=vs.85)"><strong>DynamicRenderer</strong></a> and the <a href="gesturerecognizer-class.html"><strong>GestureRecognizer</strong></a> objects may add custom stylus data to the queue. For more information about the <strong>DynamicRenderer</strong> and the <strong>GestureRecognizer</strong> objects see <a href="dynamic-renderer-plug-ins.html">Dynamic-Renderer Plug-ins</a> and <a href="recognizer-plug-ins.html">Recognizer Plug-ins</a>.</p>
<p>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object calls the <a href="/previous-versions/ms824753(v=msdn.10)">Microsoft.StylusInput.IStylusSyncPlugin.CustomStylusDataAdded</a> method on the thread from which it receives the call to its <a href="/previous-versions/ms825761(v=msdn.10)">AddCustomStylusDataToQueue</a> method.</p>
<p>The following diagram illustrates the addition of custom stylus data to the output queue with the <em>queue</em> parameter set to <strong>Output</strong>.</p>
<p><img src="images/27bc3672-41bc-432e-bf41-18e4ccec78f5.gif" alt="illustration showing custom stylus data flow to the output queue " /></p>
<p>In this diagram, the circles lettered &quot;A&quot; and &quot;B&quot; represent tablet pen data that has already been added to the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's output queue and that has not yet been sent to the asynchronous plug-in collection. The circle lettered &quot;C&quot; represents the tablet pen data that the <strong>RealTimeStylus</strong> object is currently processing. It is sent to the synchronous plug-in collection and placed on the output queue. The circles numbered &quot;1&quot;, &quot;2&quot;, and &quot;3&quot; represent custom stylus data that has been added to the output queue by the first, second, and third synchronous plug-ins respectively in response to the tablet pen data represented by &quot;C&quot;. The plug-ins have added the custom stylus data with the <em>queue</em> parameter set to <strong>StylusQueues</strong>. The empty circle represents the position in the output queue where future tablet pen data is added.</p>
<p>The following diagram illustrates the addition of custom stylus data to the output queue with the <em>queue</em> parameter set to <strong>OutputImmediate</strong>.</p>
<p><img src="images/bcf45325-5557-47a2-af43-142c7684e482.gif" alt="Diagram that shows the custom stylus data flow to the output queue." /></p>
<p>In this diagram, the circles lettered &quot;A&quot; and &quot;B&quot; represent tablet pen data that has already been added to the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's output queue and that has not yet been sent to the asynchronous plug-in collection. The circle lettered &quot;C&quot; represents the tablet pen data that the <strong>RealTimeStylus</strong> object is currently processing. It is sent to the synchronous plug-in collection and placed on the output queue. The circles numbered &quot;1&quot;, &quot;2&quot;, and &quot;3&quot; represent custom stylus data that has been added to the output queue by the first, second, and third synchronous plug-ins respectively in response to the tablet pen data represented by &quot;C&quot;. The plug-ins have added the custom stylus data with the <em>queue</em> parameter set to <strong>OutputImmediate</strong>. The empty circle represents the position in the output queue where future tablet pen data is added.</p>
<p>The following diagram illustrates the addition of custom stylus data to the input queue.</p>
<p><img src="images/5dd2cfcc-1086-49b0-a0d5-9276c13c7f61.gif" alt="illustration showing custom stylus data flow to the output queue" /></p>
<p>In this diagram, the circles lettered &quot;A&quot; and &quot;B&quot; represent tablet pen data that has already been added to the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's output queue and that has not yet been sent to the asynchronous plug-in collection. The circle lettered &quot;C&quot; represents the tablet pen data that the <strong>RealTimeStylus</strong> object is currently processing. It is sent to the synchronous plug-in collection and placed on the output queue. The circles numbered &quot;1&quot;, &quot;2&quot;, and &quot;3&quot; represent custom stylus data that has been added to the input queue by the first, second, and third synchronous plug-ins respectively in response to the tablet pen data represented by &quot;C&quot;. The plug-ins have added the custom stylus data with the <em>queue</em> parameter set to <strong>Input</strong>. The custom stylus data numbered &quot;1&quot; is then passed to the synchronous plug-ins and then to the output queue before the custom stylus data numbered &quot;2&quot; and &quot;3&quot;, both of which are processed before the next tablet pen data is processed. The empty circle represents the position in the output queue where future tablet pen data is added.</p>
<h2>Error Data</h2>
<p>When a plug-in throws an exception, the normal flow of data is interrupted. The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object generates an <a href="/previous-versions/ms824740(v=msdn.10)">ErrorData</a> object and calls:</p>
<ul>
<li>The <a href="/previous-versions/ms824754(v=msdn.10)">Microsoft.StylusInput.IStylusSyncPlugin.Error</a> or <a href="/previous-versions/ms824771(v=msdn.10)">Microsoft.StylusInput.IStylusAsyncPlugin.Error</a> method of the plug-in that threw the exception.</li>
<li>The <a href="/previous-versions/ms824754(v=msdn.10)">Microsoft.StylusInput.IStylusSyncPlugin.Error</a> or <a href="/previous-versions/ms824771(v=msdn.10)">Microsoft.StylusInput.IStylusAsyncPlugin.Error</a> method of the remaining plug-ins in that collection.</li>
</ul>
<p>If the plug-in that threw the exception is a synchronous plug-in, the <a href="/previous-versions/ms824740(v=msdn.10)">ErrorData</a> object is added to the output queue. Then the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object resumes normal processing of the original data.</p>
<p>The following diagram illustrates the addition of error data to the tablet pen data.</p>
<p><img src="images/c2f79abe-aeb5-498f-b389-1fad9bf01a13.gif" alt="custom stylus data flow to the output queue with the addition of error data" /></p>
<p>In this diagram, the circles lettered &quot;A&quot; and &quot;B&quot; represent tablet pen data that has already been added to the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's output queue and that has not yet been sent to the asynchronous plug-in collection. The circle lettered &quot;C&quot; represents the tablet pen data that the <strong>RealTimeStylus</strong> object is currently processing. The circle lettered &quot;e&quot; represents a <a href="/previous-versions/ms824740(v=msdn.10)">ErrorData</a> object generated by the <strong>RealTimeStylus</strong> object when the second synchronous plug-in, Synchronous Plug-in 2, throws an exception while it is processing &quot;C&quot;. The <strong>RealTimeStylus</strong> object then pauses its processing of &quot;C&quot; and passes &quot;e&quot; to the plug-in that generated the exception and all subsequent plug-ins. The <strong>RealTimeStylus</strong> object then puts &quot;e&quot; on the output queue and resumes its processing of &quot;C&quot;, which is passed to the remaining plug-ins in the synchronous plug-in collection and placed on the output queue after &quot;e&quot;. The empty circle represents the position in the output queue where future tablet pen data is added.</p>
<p>If a plug-in throws an exception from its Error method, the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object catches the exception but does not generate a new <a href="/previous-versions/ms824740(v=msdn.10)">ErrorData</a> object. This is to prevent recursion.</p>
<p>The error data is added to the output queue after any custom stylus data that is added at the <strong>OutputImmediate</strong> position prior to the exception that created the error data and before any custom stylus data that is added at the <strong>OutputImmediate</strong> position by subsequent plug-ins in the synchronous plug-in collection.</p>
<p>The following diagram illustrates how the error data is added to the output queue in relation to custom data that is added to the <strong>OutputImmediate</strong> queue.</p>
<p><img src="images/b00320c4-6fe7-439d-9855-e5f131feeb69.gif" alt="error data added to the output queue in relation to custom data added to the outputimmediate queue." /></p>
<p>In this diagram, the circles lettered &quot;A&quot; and &quot;B&quot; represent tablet pen data that has already been added to the <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object's output queue and that has not yet been sent to the asynchronous plug-in collection. The circle lettered &quot;C&quot; represents the tablet pen data that the <strong>RealTimeStylus</strong> object is currently processing. The circles numbered &quot;1&quot;, &quot;2&quot;, and &quot;3&quot; are added by the first, second, and third synchronous plug-ins respectively to the <strong>OutputImmediate</strong> queue in response to the data represented by the circle lettered &quot;C&quot;. The circle lettered &quot;e&quot; represents error data generated in response to an exception thrown by the second plug-in after the second plug-in added custom data to the output queue at the <strong>OutputImmediate</strong> position.</p>
<p>If any synchronous plug-in adds custom stylus data to the input queue in response to the error data, the data is added immediately before the error data. If any of the synchronous plug-ins adds custom stylus data to the output queue at the <strong>Output</strong> position in response to the error data, the data is added immediately after the error data.</p>
<p>The <a href="realtimestylus-class.html"><strong>RealTimeStylus</strong></a> object calls the <a href="/previous-versions/ms824754(v=msdn.10)">Microsoft.StylusInput.IStylusSyncPlugin.Error</a> method on the thread from which the exception is thrown.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/ms827783(v=msdn.10)">Microsoft.Ink.Tablet</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/ms823992(v=msdn.10)">Microsoft.StylusInput.PluginData</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/ms575174(v=vs.100)">Microsoft.StylusInput.DataInterestMask</a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/ms824830(v=msdn.10)">Microsoft.StylusInput.RealTimeStylus</a></p>
<!-- raw HTML omitted -->
<p><a href="working-with-the-realtimestylus-class.html">Working with the RealTimeStylus Class</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
