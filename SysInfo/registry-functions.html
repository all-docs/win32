<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Registry Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The following are the registry functions.
ms.assetid: a490b748-42e8-462b-9a7f-a8b21438ea79
title: Registry Functions
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Registry Functions</h1>
<p>The following are the registry functions.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-getsystemregistryquota"><strong>GetSystemRegistryQuota</strong></a></td>
<td>Retrieves the current size of the registry and the maximum size that the registry is allowed to attain on the system.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regclosekey"><strong>RegCloseKey</strong></a></td>
<td>Closes a handle to the specified registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regconnectregistrya"><strong>RegConnectRegistry</strong></a></td>
<td>Establishes a connection to a predefined registry handle on another computer.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regcopytreea"><strong>RegCopyTree</strong></a></td>
<td>Copies the specified registry key, along with its values and subkeys, to the specified destination key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regcreatekeyexa"><strong>RegCreateKeyEx</strong></a></td>
<td>Creates the specified registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regcreatekeytransacteda"><strong>RegCreateKeyTransacted</strong></a></td>
<td>Creates the specified registry key and associates it with a transaction.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regdeletekeya"><strong>RegDeleteKey</strong></a></td>
<td>Deletes a subkey and its values.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regdeletekeyexa"><strong>RegDeleteKeyEx</strong></a></td>
<td>Deletes a subkey and its values from the specified platform-specific view of the registry.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regdeletekeytransacteda"><strong>RegDeleteKeyTransacted</strong></a></td>
<td>Deletes a subkey and its values from the specified platform-specific view of the registry as a transacted operation.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regdeletekeyvaluea"><strong>RegDeleteKeyValue</strong></a></td>
<td>Removes the specified value from the specified registry key and subkey.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regdeletetreea"><strong>RegDeleteTree</strong></a></td>
<td>Deletes the subkeys and values of the specified key recursively.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regdeletevaluea"><strong>RegDeleteValue</strong></a></td>
<td>Removes a named value from the specified registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regdisablepredefinedcache"><strong>RegDisablePredefinedCache</strong></a></td>
<td>Disables handle caching for the predefined registry handle for <strong>HKEY_CURRENT_USER</strong> for the current process.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regdisablepredefinedcacheex"><strong>RegDisablePredefinedCacheEx</strong></a></td>
<td>Disables handle caching for all predefined registry handles for the current process.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regdisablereflectionkey"><strong>RegDisableReflectionKey</strong></a></td>
<td>Disables registry reflection for the specified key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regenablereflectionkey"><strong>RegEnableReflectionKey</strong></a></td>
<td>Enables registry reflection for the specified disabled key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regenumkeyexa"><strong>RegEnumKeyEx</strong></a></td>
<td>Enumerates the subkeys of the specified open registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regenumvaluea"><strong>RegEnumValue</strong></a></td>
<td>Enumerates the values for the specified open registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regflushkey"><strong>RegFlushKey</strong></a></td>
<td>Writes all attributes of the specified open registry key into the registry.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/winreg/nf-winreg-reggetkeysecurity"><strong>RegGetKeySecurity</strong></a></td>
<td>Retrieves a copy of the security descriptor protecting the specified open registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-reggetvaluea"><strong>RegGetValue</strong></a></td>
<td>Retrieves the type and data for the specified registry value.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regloadkeya"><strong>RegLoadKey</strong></a></td>
<td>Creates a subkey under <strong>HKEY_USERS</strong> or <strong>HKEY_LOCAL_MACHINE</strong> and stores registration information from a specified file into that subkey.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regloadmuistringa"><strong>RegLoadMUIString</strong></a></td>
<td>Loads the specified string from the specified key and subkey.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regnotifychangekeyvalue"><strong>RegNotifyChangeKeyValue</strong></a></td>
<td>Notifies the caller about changes to the attributes or contents of a specified registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regopencurrentuser"><strong>RegOpenCurrentUser</strong></a></td>
<td>Retrieves a handle to the <strong>HKEY_CURRENT_USER</strong> key for the user the current thread is impersonating.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regopenkeyexa"><strong>RegOpenKeyEx</strong></a></td>
<td>Opens the specified registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regopenkeytransacteda"><strong>RegOpenKeyTransacted</strong></a></td>
<td>Opens the specified registry key and associates it with a transaction.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regopenuserclassesroot"><strong>RegOpenUserClassesRoot</strong></a></td>
<td>Retrieves a handle to the <strong>HKEY_CLASSES_ROOT</strong> key for the specified user.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regoverridepredefkey"><strong>RegOverridePredefKey</strong></a></td>
<td>Maps a predefined registry key to a specified registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regqueryinfokeya"><strong>RegQueryInfoKey</strong></a></td>
<td>Retrieves information about the specified registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regquerymultiplevaluesa"><strong>RegQueryMultipleValues</strong></a></td>
<td>Retrieves the type and data for a list of value names associated with an open registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/WinReg/nf-winreg-regqueryreflectionkey"><strong>RegQueryReflectionKey</strong></a></td>
<td>Determines whether reflection has been disabled or enabled for the specified key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regqueryvalueexa"><strong>RegQueryValueEx</strong></a></td>
<td>Retrieves the type and data for a specified value name associated with an open registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regrenamekey"><strong>RegRenameKey</strong></a></td>
<td>Changes the name of the specified registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regreplacekeya"><strong>RegReplaceKey</strong></a></td>
<td>Replaces the file backing a registry key and all its subkeys with another file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regrestorekeya"><strong>RegRestoreKey</strong></a></td>
<td>Reads the registry information in a specified file and copies it over the specified key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regsavekeya"><strong>RegSaveKey</strong></a></td>
<td>Saves the specified key and all of its subkeys and values to a new file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regsavekeyexa"><strong>RegSaveKeyEx</strong></a></td>
<td>Saves the specified key and all of its subkeys and values to a new file. You can specify the format for the saved key or hive.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regsetkeyvaluea"><strong>RegSetKeyValue</strong></a></td>
<td>Sets the data for the specified value in the specified registry key and subkey.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/winreg/nf-winreg-regsetkeysecurity"><strong>RegSetKeySecurity</strong></a></td>
<td>Sets the security of an open registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regsetvalueexa"><strong>RegSetValueEx</strong></a></td>
<td>Sets the data and type of a specified value under a registry key.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winreg/nf-winreg-regunloadkeya"><strong>RegUnLoadKey</strong></a></td>
<td>Unloads the specified registry key and its subkeys from the registry.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The following shell functions can be used with the registry:</p>
<ul>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-assoccreate"><strong>AssocCreate</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-assocquerykeya"><strong>AssocQueryKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-assocquerystringa"><strong>AssocQueryString</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-assocquerystringbykeya"><strong>AssocQueryStringByKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shcopykeya"><strong>SHCopyKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shdeleteemptykeya"><strong>SHDeleteEmptyKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shdeletekeya"><strong>SHDeleteKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shdeletevaluea"><strong>SHDeleteValue</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shenumkeyexa"><strong>SHEnumKeyEx</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shenumvaluea"><strong>SHEnumValue</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shgetvaluea"><strong>SHGetValue</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shqueryinfokeya"><strong>SHQueryInfoKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shqueryvalueexa"><strong>SHQueryValueEx</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregcloseuskey"><strong>SHRegCloseUSKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregcreateuskeya"><strong>SHRegCreateUSKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregdeleteemptyuskeya"><strong>SHRegDeleteEmptyUSKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregdeleteusvaluea"><strong>SHRegDeleteUSValue</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregduplicatehkey"><strong>SHRegDuplicateHKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregenumuskeya"><strong>SHRegEnumUSKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregenumusvaluea"><strong>SHRegEnumUSValue</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shreggetboolusvaluea"><strong>SHRegGetBoolUSValue</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shreggetintw"><strong>SHRegGetIntW</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shreggetpatha"><strong>SHRegGetPath</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shreggetusvaluea"><strong>SHRegGetUSValue</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregopenuskeya"><strong>SHRegOpenUSKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregqueryinfouskeya"><strong>SHRegQueryInfoUSKey</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregqueryusvaluea"><strong>SHRegQueryUSValue</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregsetpatha"><strong>SHRegSetPath</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregsetusvaluea"><strong>SHRegSetUSValue</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregwriteusvaluea"><strong>SHRegWriteUSValue</strong></a></li>
<li><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shsetvaluea"><strong>SHSetValue</strong></a></li>
</ul>
<p>The following are the initialization-file functions. They retrieve information from and copy information to a system- or application-defined initialization file. These functions are provided only for compatibility with 16-bit versions of Windows. New applications should use the registry.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-getprivateprofileint"><strong>GetPrivateProfileInt</strong></a></td>
<td>Retrieves an integer associated with a key in the specified section of an initialization file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-getprivateprofilesection"><strong>GetPrivateProfileSection</strong></a></td>
<td>Retrieves all the keys and values for the specified section of an initialization file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-getprivateprofilesectionnames"><strong>GetPrivateProfileSectionNames</strong></a></td>
<td>Retrieves the names of all sections in an initialization file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-getprivateprofilestring"><strong>GetPrivateProfileString</strong></a></td>
<td>Retrieves a string from the specified section in an initialization file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-getprivateprofilestruct"><strong>GetPrivateProfileStruct</strong></a></td>
<td>Retrieves the data associated with a key in the specified section of an initialization file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-getprofileinta"><strong>GetProfileInt</strong></a></td>
<td>Retrieves an integer from a key in the specified section of the Win.ini file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-getprofilesectiona"><strong>GetProfileSection</strong></a></td>
<td>Retrieves all the keys and values for the specified section of the Win.ini file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-getprofilestringa"><strong>GetProfileString</strong></a></td>
<td>Retrieves the string associated with a key in the specified section of the Win.ini file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-writeprivateprofilesectiona"><strong>WritePrivateProfileSection</strong></a></td>
<td>Replaces the keys and values for the specified section in an initialization file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-writeprivateprofilestringa"><strong>WritePrivateProfileString</strong></a></td>
<td>Copies a string into the specified section of an initialization file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-writeprivateprofilestructa"><strong>WritePrivateProfileStruct</strong></a></td>
<td>Copies data into a key in the specified section of an initialization file.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-writeprofilesectiona"><strong>WriteProfileSection</strong></a></td>
<td>Replaces the contents of the specified section in the Win.ini file with specified keys and values.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winbase/nf-winbase-writeprofilestringa"><strong>WriteProfileString</strong></a></td>
<td>Copies a string into the specified section of the Win.ini file.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Obsolete Functions</h2>
<p>These functions are provided only for compatibility with 16-bit versions of Windows:</p>
<ul>
<li><a href="/windows/desktop/api/Winreg/nf-winreg-regcreatekeya"><strong>RegCreateKey</strong></a></li>
<li><a href="/windows/desktop/api/Winreg/nf-winreg-regenumkeya"><strong>RegEnumKey</strong></a></li>
<li><a href="/windows/desktop/api/Winreg/nf-winreg-regopenkeya"><strong>RegOpenKey</strong></a></li>
<li><a href="/windows/desktop/api/Winreg/nf-winreg-regqueryvaluea"><strong>RegQueryValue</strong></a></li>
<li><a href="/windows/desktop/api/Winreg/nf-winreg-regsetvaluea"><strong>RegSetValue</strong></a></li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
