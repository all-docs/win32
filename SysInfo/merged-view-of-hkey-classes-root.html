<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Merged View of HKEY_CLASSES_ROOT</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The RegOpenUserClassesRoot function provides a merged view for processes, such as services, that are dealing with clients other than the interactive user.
ms.assetid: 3815d487-2d58-4ba8-85d2-cae6a642a791
title: Merged View of HKEY_CLASSES_ROOT
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Merged View of HKEY_CLASSES_ROOT</h1>
<p>The <a href="/windows/desktop/api/Winreg/nf-winreg-regopenuserclassesroot"><strong>RegOpenUserClassesRoot</strong></a> function provides a merged view for processes, such as services, that are dealing with clients other than the interactive user. In this case, the <strong>HKEY_CLASSES_ROOT</strong> key provides a view of the registry that merges the information from <strong>HKEY_LOCAL_MACHINE\Software\Classes</strong> with the information from <strong>HKEY_CURRENT_USER\Software\Classes</strong>.</p>
<p>The system uses the following rules to merge information from the two sources:</p>
<ul>
<li>The merged view includes all subkeys of the <strong>HKEY_CURRENT_USER\Software\Classes</strong> key.</li>
<li>The merged view includes all immediate subkeys of the <strong>HKEY_LOCAL_MACHINE\Software\Classes</strong> key that do not duplicate the subkeys of <strong>HKEY_CURRENT_USER\Software\Classes</strong>.</li>
<li>At the end of this topic is a list of subkeys that are found in both <strong>HKEY_LOCAL_MACHINE\Software\Classes</strong> and <strong>HKEY_CURRENT_USER\Software\Classes</strong>. The immediate subkeys of these keys from the <strong>HKEY_LOCAL_MACHINE</strong> tree are included in the merged view only if they are not duplicates of immediate subkeys from the <strong>HKEY_CURRENT_USER</strong> tree. The merged view does not include the <strong>HKEY_LOCAL_MACHINE</strong> contents of duplicate subkeys.</li>
</ul>
<p>If an application is run with administrator rights and User Account Control is disabled, the COM runtime ignores per-user COM configuration and accesses only per-machine COM configuration. Applications that require administrator rights should register dependent COM objects during installation to the per-machine COM configuration store (<strong>HKEY_LOCAL_MACHINE\Software\Classes</strong>). For more information, see <a href="/previous-versions/bb756926(v=msdn.10)">AC: UAC: COM Per-User Configuration</a>.</p>
<p><strong>Windows ServerÂ 2003 and WindowsÂ XP/2000:</strong> Applications can register dependent COM objects to either the per-machine or per-user COM configuration store (<strong>HKEY_LOCAL_MACHINE\Software\Classes</strong> or <strong>HKEY_CURRENT_USER\Software\Classes</strong>).</p>
<p>The following example shows a set of subkeys under the <strong>HKEY_LOCAL_MACHINE</strong> and <strong>HKEY_CURRENT_USER</strong> keys and the resulting merged view of <strong>HKEY_CLASSES_ROOT</strong>.</p>
<p><strong>HKEY_LOCAL_MACHINE\SOFTWARE\Classes</strong> Â Â Â <strong>CLSID</strong> Â Â Â Â Â Â <em>2</em> Â Â Â Â Â Â <em>4</em> Â Â Â Â Â Â Â Â Â <strong>inprocserver32</strong> Â Â Â Â Â Â Â Â Â <strong>localserver32</strong> Â Â Â Â Â Â <em>7</em></p>
<p><strong>HKEY_CURRENT_USER\Software\Classes</strong> Â Â Â <strong>CLSID</strong> Â Â Â Â Â Â <em>1</em> Â Â Â Â Â Â <em>4</em> Â Â Â Â Â Â Â Â Â <strong>localserver</strong> Â Â Â Â Â Â <em>6</em> Â Â Â Â Â Â <em>10</em> Â Â Â Â Â Â Â Â Â <strong>localserver</strong></p>
<p><strong>HKEY_CLASSES_ROOT</strong> Â Â Â <strong>CLSID</strong> Â Â Â Â Â Â <em>1</em> Â Â Â Â Â Â <em>2</em> Â Â Â Â Â Â <em>4</em> Â Â Â Â Â Â Â Â Â <strong>inprocserver32</strong> Â Â Â Â Â Â Â Â Â <strong>localserver</strong> Â Â Â Â Â Â Â Â Â <strong>localserver32</strong> Â Â Â Â Â Â <em>6</em> Â Â Â Â Â Â <em>7</em> Â Â Â Â Â Â <em>10</em> Â Â Â Â Â Â Â Â Â <strong>localserver</strong></p>
<p>The following subkeys are found in both <strong>HKEY_LOCAL_MACHINE\Software\Classes</strong> and <strong>HKEY_CURRENT_USER\Software\Classes</strong>. From the <strong>HKEY_LOCAL_MACHINE</strong> tree, the immediate subkeys of these keys are included in the merged view only if they are not duplicates of immediate subkeys from the <strong>HKEY_CURRENT_USER</strong> tree. The merged view does not include the <strong>HKEY_LOCAL_MACHINE</strong> contents of duplicate subkeys.</p>
<p><strong>*</strong><br />
<strong>*\shellex</strong><br />
<strong>*\shellex\ContextMenuHandlers</strong><br />
<strong>*\shellex\PropertySheetHandlers</strong><br />
<strong>AppID</strong><br />
<strong>ClsID</strong><br />
<strong>Component Categories</strong><br />
<strong>Drive</strong><br />
<strong>Drive\shellex</strong><br />
<strong>Drive\shellex\ContextMenuHandlers</strong><br />
<strong>Drive\shellex\PropertySheetHandlers</strong><br />
<strong>FileType</strong><br />
<strong>Folder</strong><br />
<strong>Folder\shellex</strong><br />
<strong>Folder\shellex\ColumnHandler</strong><br />
<strong>Folder\shellex\ContextMenuHandlers</strong><br />
<strong>Folder\shellex\ExtShellFolderViews</strong><br />
<strong>Folder\shellex\PropertySheetHandlers</strong><br />
<strong>Installer\Components</strong><br />
<strong>Installer\Features</strong><br />
<strong>Installer\Products</strong><br />
<strong>Interface</strong><br />
<strong>Mime</strong><br />
<strong>Mime\Database</strong><br />
<strong>Mime\Database\Charset</strong><br />
<strong>Mime\Database\Codepage</strong><br />
<strong>Mime\Database\Content Type</strong><br />
<strong>Typelib</strong></p>
<p>Â </p>
<p>Â </p>
</body>
