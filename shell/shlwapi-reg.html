<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Shell Registry Handling Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: This section describes the Windows Shell registry handling functions. The programming elements explained in this documentation are exported by Shlwapi.dll and defined in Shlwapi.h and Shlwapi.lib.
title: Shell Registry Handling Functions
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 12182f56-5bb3-4f70-ae6a-2ef7366287b9
api_name:
api_type:
api_location:
topic_type:</p>
<ul>
<li>kbArticle</li>
</ul>
<hr />
<h1>Shell Registry Handling Functions</h1>
<p>This section describes the Windows Shell registry handling functions. The programming elements explained in this documentation are exported by Shlwapi.dll and defined in Shlwapi.h and Shlwapi.lib.</p>
<h2>In this section</h2>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-assoccreate"><strong>AssocCreate</strong></a><!-- raw HTML omitted --></td>
<td>Returns a pointer to an <a href="/windows/win32/api/shlwapi/nn-shlwapi-iqueryassociations"><strong>IQueryAssociations</strong></a> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-assocgetperceivedtype"><strong>AssocGetPerceivedType</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves a file's perceived type based on its extension.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-associsdangerous"><strong>AssocIsDangerous</strong></a><!-- raw HTML omitted --></td>
<td>Determines whether a file type is considered a potential security risk.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-assocquerykeya"><strong>AssocQueryKey</strong></a><!-- raw HTML omitted --></td>
<td>Searches for and retrieves a key related to a file or protocol association from the registry.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-assocquerystringa"><strong>AssocQueryString</strong></a><!-- raw HTML omitted --></td>
<td>Searches for and retrieves a file or protocol association-related string from the registry.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-assocquerystringbykeya"><strong>AssocQueryStringByKey</strong></a><!-- raw HTML omitted --></td>
<td>Searches for and retrieves a file association-related string from the registry starting from a specified key.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shcopykeya"><strong>SHCopyKey</strong></a><!-- raw HTML omitted --></td>
<td>Recursively copies the subkeys and values of the source subkey to the destination key. <a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shcopykeya"><strong>SHCopyKey</strong></a> does not copy the security attributes of the keys.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shdeleteemptykeya"><strong>SHDeleteEmptyKey</strong></a><!-- raw HTML omitted --></td>
<td>Deletes an empty key.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shdeletekeya"><strong>SHDeleteKey</strong></a><!-- raw HTML omitted --></td>
<td>Deletes a subkey and all its descendants. This function removes the key and all the key's values from the registry.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shdeletevaluea"><strong>SHDeleteValue</strong></a><!-- raw HTML omitted --></td>
<td>Deletes a named value from the specified registry key.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shenumkeyexa"><strong>SHEnumKeyEx</strong></a><!-- raw HTML omitted --></td>
<td>Enumerates the subkeys of the specified open registry key.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shenumvaluea"><strong>SHEnumValue</strong></a><!-- raw HTML omitted --></td>
<td>Enumerates the values of the specified open registry key.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shgetassockeys"><strong>SHGetAssocKeys</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves an array of class subkeys associated with an <a href="/windows/win32/api/shlwapi/nn-shlwapi-iqueryassociations"><strong>IQueryAssociations</strong></a> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shgetvaluea"><strong>SHGetValue</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves a registry value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shopenregstream2a"><strong>SHOpenRegStream2</strong></a><!-- raw HTML omitted --></td>
<td>Opens a registry value and supplies a stream that can be used to read from or write to the value. This function supersedes <a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shopenregstreama"><strong>SHOpenRegStream</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shqueryinfokeya"><strong>SHQueryInfoKey</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves information about a specified registry key.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shqueryvalueexa"><strong>SHQueryValueEx</strong></a><!-- raw HTML omitted --></td>
<td>Opens a registry key and queries it for a specific value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregcloseuskey"><strong>SHRegCloseUSKey</strong></a><!-- raw HTML omitted --></td>
<td>Closes a handle to a user-specific registry subkey in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregcreateuskeya"><strong>SHRegCreateUSKey</strong></a><!-- raw HTML omitted --></td>
<td>Creates or opens a registry subkey in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregdeleteemptyuskeya"><strong>SHRegDeleteEmptyUSKey</strong></a><!-- raw HTML omitted --></td>
<td>Deletes an empty registry subkey in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregdeleteusvaluea"><strong>SHRegDeleteUSValue</strong></a><!-- raw HTML omitted --></td>
<td>Deletes a registry subkey value in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregduplicatehkey"><strong>SHRegDuplicateHKey</strong></a><!-- raw HTML omitted --></td>
<td>Duplicates a registry key's HKEY handle.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregenumuskeya"><strong>SHRegEnumUSKey</strong></a><!-- raw HTML omitted --></td>
<td>Enumerates the subkeys of a registry subkey in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregenumusvaluea"><strong>SHRegEnumUSValue</strong></a><!-- raw HTML omitted --></td>
<td>Enumerates the values of the specified registry subkey in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shreggetboolusvaluea"><strong>SHRegGetBoolUSValue</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves a Boolean value from a registry subkey in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shreggetintw"><strong>SHRegGetIntW</strong></a><!-- raw HTML omitted --></td>
<td>Reads a numeric string value from the registry and converts it to an integer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shreggetpatha"><strong>SHRegGetPath</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves a file path from the registry, expanding environment variables as needed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shreggetusvaluea"><strong>SHRegGetUSValue</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves a value from a registry subkey in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregopenuskeya"><strong>SHRegOpenUSKey</strong></a><!-- raw HTML omitted --></td>
<td>Opens a registry subkey in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregqueryinfouskeya"><strong>SHRegQueryInfoUSKey</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves information about a specified registry subkey in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregqueryusvaluea"><strong>SHRegQueryUSValue</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves the type and data for a specified name associated with an open registry subkey in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregsetpatha"><strong>SHRegSetPath</strong></a><!-- raw HTML omitted --></td>
<td>Takes a file path, replaces folder names with environment strings, and places the resulting string in the registry.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregsetusvaluea"><strong>SHRegSetUSValue</strong></a><!-- raw HTML omitted --></td>
<td>Sets a registry subkey value in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shregsetvalue"><strong>SHRegSetValue</strong></a><!-- raw HTML omitted --></td>
<td>Sets a registry value.<!-- raw HTML omitted --> Use <a href="/windows/win32/api/winreg/nf-winreg-regsetvaluea"><strong>RegSetValue</strong></a> in its place.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shregwriteusvaluea"><strong>SHRegWriteUSValue</strong></a><!-- raw HTML omitted --></td>
<td>Writes a value to a registry subkey in a user-specific subtree (HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shsetvaluea"><strong>SHSetValue</strong></a><!-- raw HTML omitted --></td>
<td>Sets the value of a registry key.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
