<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Shell String Handling Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: This section describes the Windows Shell string handling functions. The programming elements explained in this documentation are exported by Shlwapi.dll and defined in Shlwapi.h and Shlwapi.lib.
title: Shell String Handling Functions
ms.topic: article
ms.date: 05/31/2018
ms.assetid: c7329e22-c9bf-4845-bc0a-a155d1bd2005
api_name:
api_type:
api_location:
topic_type:</p>
<ul>
<li>kbArticle</li>
</ul>
<hr />
<h1>Shell String Handling Functions</h1>
<p>This section describes the Windows Shell string handling functions. The programming elements explained in this documentation are exported by Shlwapi.dll and defined in Shlwapi.h and Shlwapi.lib.</p>
<h2>In this section</h2>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->ChrCmpI<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Performs a comparison between two characters. The comparison is not case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->GetAcceptLanguages<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Retrieves a string used with websites when specifying language preferences.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->IntlStrEqN<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Performs a case-sensitive comparison of a specified number of characters from the beginning of two localized strings.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->IntlStrEqNI<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Performs a case-insensitive comparison of a specified number of characters from the beginning of two localized strings.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->IntlStrEqWorker<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares a specified number of characters from the beginning of two localized strings.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->IsCharSpace<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Determines whether a character represents a space.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->SHLoadIndirectString<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Extracts a specified text resource when given that resource in the form of an indirect string (a string that begins with the '@' symbol).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->SHStrDup<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Makes a copy of a string in newly allocated memory.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-strcatw"><strong>StrCat</strong></a><!-- raw HTML omitted --></td>
<td>Appends one string to another. <!-- raw HTML omitted --> <strong>Note:</strong> Do not use. See Remarks for alternative functions.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-strcatbuffa"><strong>StrCatBuff</strong></a><!-- raw HTML omitted --></td>
<td>Copies and appends characters from one string to the end of another. <!-- raw HTML omitted --> <strong>Note:</strong> Do not use. See Remarks for alternative functions.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrCatChainW<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Concatenates two Unicode strings. Used when repeated concatenations to the same buffer are required.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrChr<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Searches a string for the first occurrence of a character that matches the specified character. The comparison is case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrChrI<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Searches a string for the first occurrence of a character that matches the specified character. The comparison is not case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrChrNIW<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Searches a string for the first occurrence of a specified character. The comparison is not case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrChrNW<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Searches a string for the first occurrence of a specified character. The comparison is case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrCmp<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares two strings to determine if they are the same. The comparison is case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrCmpC<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares strings using C run-time (ASCII) collation rules. The comparison is case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrCmpI<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares two strings to determine if they are the same. The comparison is not case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrCmpIC<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares two strings using C run-time (ASCII) collation rules. The comparison is not case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrCmpLogicalW<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares two Unicode strings. Digits in the strings are considered as numerical content rather than text. This test is not case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrCmpN<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares a specified number of characters from the beginning of two strings to determine if they are the same. The comparison is case-sensitive. The <!-- raw HTML omitted -->StrNCmp<!-- raw HTML omitted --> macro differs from this function in name only.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrCmpNC<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares a specified number of characters from the beginning of two strings using C run-time (ASCII) collation rules. The comparison is case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrCmpNI<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares a specified number of characters from the beginning of two strings to determine if they are the same. The comparison is not case-sensitive. The <!-- raw HTML omitted -->StrNCmpI<!-- raw HTML omitted --> macro differs from this function in name only.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrCmpNIC<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares a specified number of characters from the beginning of two strings using C run-time (ASCII) collation rules. The comparison is not case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-strcpyw"><strong>StrCpy</strong></a><!-- raw HTML omitted --></td>
<td>Copies one string to another. <!-- raw HTML omitted --> <strong>Note:</strong> Do not use. See Remarks for alternative functions.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-strcpynw"><strong>StrCpyN</strong></a><!-- raw HTML omitted --></td>
<td>Copies a specified number of characters from the beginning of one string to another.<!-- raw HTML omitted --> <strong>Note:</strong> Do not use this function or the <strong>StrNCpy</strong> macro. See Remarks for alternative functions.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrCSpn<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Searches a string for the first occurrence of any of a group of characters. The search method is case-sensitive, and the terminating <!-- raw HTML omitted -->NULL<!-- raw HTML omitted --> character is included within the search pattern match.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrCSpnI<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Searches a string for the first occurrence of any of a group of characters. The search method is not case-sensitive, and the terminating <!-- raw HTML omitted -->NULL<!-- raw HTML omitted --> character is included within the search pattern match.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrDup<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Duplicates a string.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrFormatByteSize64<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Converts a numeric value into a string that represents the number expressed as a size value in bytes, kilobytes, megabytes, or gigabytes, depending on the size.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrFormatByteSizeA<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Converts a numeric value into a string that represents the number expressed as a size value in bytes, kilobytes, megabytes, or gigabytes, depending on the size. Differs from <!-- raw HTML omitted --><!-- raw HTML omitted -->StrFormatByteSizeW<!-- raw HTML omitted --><!-- raw HTML omitted --> in one parameter type.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrFormatByteSizeEx<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Converts a numeric value into a string that represents the number in bytes, kilobytes, megabytes, or gigabytes, depending on the size. Extends <!-- raw HTML omitted --><!-- raw HTML omitted -->StrFormatByteSizeW<!-- raw HTML omitted --><!-- raw HTML omitted --> by offering the option to round to the nearest displayed digit or to discard undisplayed digits.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrFormatByteSizeW<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Converts a numeric value into a string that represents the number expressed as a size value in bytes, kilobytes, megabytes, or gigabytes, depending on the size. Differs from <!-- raw HTML omitted --><!-- raw HTML omitted -->StrFormatByteSizeA<!-- raw HTML omitted --><!-- raw HTML omitted --> in one parameter type.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrFormatKBSize<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Converts a numeric value into a string that represents the number expressed as a size value in kilobytes.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrFromTimeInterval<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Converts a time interval, specified in milliseconds, to a string.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrIsIntlEqual<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Compares a specified number of characters from the beginning of two strings to determine if they are equal.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-strncata"><strong>StrNCat</strong></a><!-- raw HTML omitted --></td>
<td>Appends a specified number of characters from the beginning of one string to the end of another. <!-- raw HTML omitted --> <strong>Note:</strong> Do not use this function or the <strong>StrCatN</strong> macro. See Remarks for alternative functions.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrPBrk<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Searches a string for the first occurrence of a character contained in a specified buffer. This search does not include the terminating null character.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrRChr<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Searches a string for the last occurrence of a specified character. The comparison is case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrRChrI<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Searches a string for the last occurrence of a specified character. The comparison is not case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrRetToBSTR<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Accepts a <!-- raw HTML omitted --><!-- raw HTML omitted -->STRRET<!-- raw HTML omitted --><!-- raw HTML omitted --> structure returned by <!-- raw HTML omitted --><!-- raw HTML omitted -->IShellFolder::GetDisplayNameOf<!-- raw HTML omitted --><!-- raw HTML omitted --> that contains or points to a string, and returns that string as a <!-- raw HTML omitted --><!-- raw HTML omitted -->BSTR<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrRetToBuf<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Converts an <!-- raw HTML omitted --><!-- raw HTML omitted -->STRRET<!-- raw HTML omitted --><!-- raw HTML omitted --> structure returned by <!-- raw HTML omitted --><!-- raw HTML omitted -->IShellFolder::GetDisplayNameOf<!-- raw HTML omitted --><!-- raw HTML omitted --> to a string, and places the result in a buffer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrRetToStr<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Takes an <!-- raw HTML omitted --><!-- raw HTML omitted -->STRRET<!-- raw HTML omitted --><!-- raw HTML omitted --> structure returned by <!-- raw HTML omitted --><!-- raw HTML omitted -->IShellFolder::GetDisplayNameOf<!-- raw HTML omitted --><!-- raw HTML omitted --> and returns a pointer to an allocated string containing the display name.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrRetToStrN<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Takes an <!-- raw HTML omitted --><!-- raw HTML omitted -->STRRET<!-- raw HTML omitted --><!-- raw HTML omitted --> structure returned by <!-- raw HTML omitted --><!-- raw HTML omitted -->IShellFolder::GetDisplayNameOf<!-- raw HTML omitted --><!-- raw HTML omitted -->, converts it to a string, and places the result in a buffer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrRStrI<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Searches for the last occurrence of a specified substring within a string. The comparison is not case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrSpn<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Obtains the length of a substring within a string that consists entirely of characters contained in a specified buffer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrStr<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Finds the first occurrence of a substring within a string. The comparison is case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrStrI<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Finds the first occurrence of a substring within a string. The comparison is not case-sensitive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrToInt<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Converts a string that represents a decimal value to an integer. The <!-- raw HTML omitted -->StrToLong<!-- raw HTML omitted --> macro is identical to this function.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrToInt64Ex<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Converts a string representing a decimal or hexadecimal value to a 64-bit integer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrToIntEx<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Converts a string representing a decimal or hexadecimal number to an integer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->StrTrim<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Removes specified leading and trailing characters from a string.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-wnsprintfa"><strong>wnsprintf</strong></a><!-- raw HTML omitted --></td>
<td>Takes a variable-length argument list and returns the values of the arguments as a <a href="https://www.microsoft.com/download/details.aspx?id=55979"><strong>printf</strong></a>-style formatted string. <!-- raw HTML omitted --> <strong>Note:</strong> Do not use this function. See Remarks for alternative functions.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-wvnsprintfa"><strong>wvnsprintf</strong></a><!-- raw HTML omitted --></td>
<td>Takes a list of arguments and returns the values of the arguments as a <a href="https://www.microsoft.com/download/details.aspx?id=55979"><strong>printf</strong></a>-style formatted string. <!-- raw HTML omitted --> <strong>Note:</strong> Do not use this function. See Remarks for alternative functions.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
