<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ABM_GETSTATE message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Retrieves the autohide and always-on-top states of the Windows taskbar.
title: ABM_GETSTATE message (Shellapi.h)
ms.topic: reference
ms.date: 05/31/2018
ms.assetid: 18e16752-16be-492b-a4fa-c951e18dc86c
api_name:</p>
<ul>
<li>ABM_GETSTATE
api_type:</li>
<li>HeaderDef
api_location:</li>
<li>Shellapi.h
topic_type:</li>
<li>APIRef</li>
<li>kbSyntax</li>
</ul>
<hr />
<h1>ABM_GETSTATE message</h1>
<p>Retrieves the autohide and always-on-top states of the Windows taskbar.</p>
<pre lang="C++"><code>uState = (UINT) SHAppBarMessage(ABM_GETSTATE, pabd);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>pabd</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <a href="/windows/desktop/api/Shellapi/ns-shellapi-appbardata"><strong>APPBARDATA</strong></a> structure. You must specify the <strong>cbSize</strong> member when sending this message; all other members are ignored.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns zero if the taskbar is neither in the autohide nor always-on-top state. Otherwise, the return value is one or both of the following:</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ABS_ALWAYSONTOP</strong><!-- raw HTML omitted --></td>
<td>The taskbar is in the always-on-top state. <!-- raw HTML omitted --> <strong>Note:</strong> As of Windows 7, ABS_ALWAYSONTOP is no longer returned because the taskbar is always in that state. Older code should be updated to ignore the absence of this value in not assume that return value to mean that the taskbar is not in the always-on-top state.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ABS_AUTOHIDE<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>The taskbar is in the autohide state.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Shellapi.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
