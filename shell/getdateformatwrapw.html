<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GetDateFormatWrapW function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Formats a date as a date string for a specified locale.
ms.assetid: e45f6d1c-2890-44f6-8406-022c99c59e02
title: GetDateFormatWrapW function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>GetDateFormatWrapW
api_type:</li>
<li>DllExport
api_location:</li>
<li>Shlwapi.dll</li>
</ul>
<hr />
<h1>GetDateFormatWrapW function</h1>
<p>[<strong>GetDateFormatWrapW</strong> is available for use in WindowsÂ XP. It will not be available in subsequent versions. You should use <a href="/windows/win32/api/datetimeapi/nf-datetimeapi-getdateformata"><strong>GetDateFormatW</strong></a> in its place.]</p>
<p>Formats a date as a date string for a specified locale. The function formats either a specified date or the local system date.</p>
<blockquote>
<p>[!Note]<br />
<strong>GetDateFormatWrapW</strong> is a wrapper for the <strong>GetDateFormatW</strong> function. See the <a href="/windows/win32/api/datetimeapi/nf-datetimeapi-getdateformata"><strong>GetDateFormat</strong></a> page for further usage notes.</p>
</blockquote>
<p>Â </p>
<h2>Syntax</h2>
<pre lang="C++"><code>int GetDateFormatWrapW(
  _In_Â Â Â Â Â Â Â Â LCID Â Â Â Â Â Â Locale,
  _In_Â Â Â Â Â Â Â Â DWORD Â Â Â Â Â dwFlags,
  _In_Â Â const SYSTEMTIME *lpDate,
  _In_Â Â Â Â Â Â Â Â LPCWSTR Â Â Â pwzFormat,
  _Out_Â Â Â Â Â Â Â LPWSTR Â Â Â Â pwzDateStr,
  _In_Â Â Â Â Â Â Â Â int Â Â Â Â Â Â Â cchDate
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Locale</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LCID</strong></p>
<p>The locale for which the date string is to be formatted. If <em>pwzFormat</em> is <strong>NULL</strong>, the function formats the string according to the date format for this locale. If <em>pwzFormat</em> is not <strong>NULL</strong>, the function uses the locale only for information not specified in the format picture string (for example, the locale's day and month names).</p>
<p>This parameter can be a locale identifier created by the <a href="/windows/win32/api/winnt/nf-winnt-makelcid"><strong>MAKELCID</strong></a> macro, or one of the following predefined values.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>LOCALE_SYSTEM_DEFAULT</strong></p>
<!-- raw HTML omitted -->
<p>Default system locale.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>LOCALE_USER_DEFAULT</strong></p>
<!-- raw HTML omitted -->
<p>Default user locale.</p>
<!-- raw HTML omitted -->
<p><em>dwFlags</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<p>Specifies various function options. If <em>pwzFormat</em> is not <strong>NULL</strong>, this parameter must be zero. If <em>pwzFormat</em> is <strong>NULL</strong>, you can specify a combination of the following values. If you do not specify either DATE_YEARMONTH, DATE_SHORTDATE, or DATE_LONGDATE, and <em>pwzFormat</em> is <strong>NULL</strong>, then DATE_SHORTDATE is used as the default.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>LOCALE_NOUSEROVERRIDE</strong></p>
<!-- raw HTML omitted -->
<p>If set, the function formats the string using the system default date format for the specified locale. If not set, the function formats the string using any user overrides to the locale's default date format.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>LOCALE_USE_CP_ACP</strong></p>
<!-- raw HTML omitted -->
<p>Uses the system ANSI code page for string translation instead of the locale's code page.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>DATE_SHORTDATE</strong></p>
<!-- raw HTML omitted -->
<p>Uses the short date format. This value cannot be used with DATE_LONGDATE or DATE_YEARMONTH.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>DATE_LONGDATE</strong></p>
<!-- raw HTML omitted -->
<p>Uses the long date format. This value cannot be used with DATE_SHORTDATE or DATE_YEARMONTH.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>DATE_YEARMONTH</strong></p>
<!-- raw HTML omitted -->
<p>Uses the year/month format. This value cannot be used with DATE_SHORTDATE or DATE_LONGDATE.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>DATE_USE_ALT_CALENDAR</strong></p>
<!-- raw HTML omitted -->
<p>Uses the alternate calendar, if one exists, to format the date string. If this flag is set, the function uses the default format for that alternate calendar, rather than using any user overrides. The user overrides will be used only in the event that there is no default format for the specified alternate calendar.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>DATE_LTRREADING</strong></p>
<!-- raw HTML omitted -->
<p>Adds marks for left-to-right reading layout. This value cannot be used with DATE_RTLREADING.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>DATE_RTLREADING</strong></p>
<!-- raw HTML omitted -->
<p>Adds marks for right-to-left reading layout. This value cannot be used with DATE_LTRREADING.</p>
<!-- raw HTML omitted -->
<p><em>lpDate</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>const <a href="/windows/win32/api/minwinbase/ns-minwinbase-systemtime"><strong>SYSTEMTIME</strong></a>*</strong></p>
<p>A pointer to a <a href="/windows/win32/api/minwinbase/ns-minwinbase-systemtime"><strong>SYSTEMTIME</strong></a> structure that contains the date information to be formatted. If this pointer is <strong>NULL</strong>, the function uses the current local system date.</p>
<!-- raw HTML omitted -->
<p><em>pwzFormat</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPCWSTR</strong></p>
<p>A pointer to a format picture to use to form the date string. If <em>pwzFormat</em> is <strong>NULL</strong>, the function uses the date format of the specified locale. See <a href="/windows/win32/api/datetimeapi/nf-datetimeapi-getdateformata"><strong>GetDateFormat</strong></a> for more details.</p>
<!-- raw HTML omitted -->
<p><em>pwzDateStr</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPWSTR</strong></p>
<p>A pointer to a buffer that receives the formatted date string.</p>
<!-- raw HTML omitted -->
<p><em>cchDate</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>int</strong></p>
<p>Specifies the size, in characters, of the <em>pwzDateStr</em> buffer. If <em>cchDate</em> is zero, the function returns the number of characters required to hold the formatted date string, and the buffer pointed to by <em>pwzDateStr</em> is not used.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>int</strong></p>
<p>If the function succeeds, the return value is the number of characters written to the buffer pointed to by <em>pwzDateStr</em>. If the <em>cchDate</em> parameter is zero, the return value is the number of characters required to hold the formatted date string. The count includes the terminating null character.</p>
<p>If the function fails, the return value is zero. To get extended error information, call <a href="/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a>. <strong>GetLastError</strong> may return one of the following error codes.</p>
<!-- raw HTML omitted -->
<p><strong>ERROR_INSUFFICIENT_BUFFER</strong></p>
<!-- raw HTML omitted -->
<p><strong>ERROR_INVALID_FLAGS</strong></p>
<!-- raw HTML omitted -->
<p><strong>ERROR_INVALID_PARAMETER</strong></p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p><strong>GetDateFormatWrapW</strong> provides the ability to use Unicode strings in operating systems earlier than WindowsÂ XP. The preferred method is to use <a href="/windows/win32/api/datetimeapi/nf-datetimeapi-getdateformata"><strong>GetDateFormatW</strong></a> in conjunction with the Microsoft Layer for Unicode (MSLU).</p>
<p><strong>GetDateFormatWrapW</strong> must be called directly from Shlwapi.dll, using ordinal 311.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Professional, WindowsÂ XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Shlwapi.dll (version 5.0 or later)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/datetimeapi/nf-datetimeapi-getdateformata"><strong>GetDateFormat</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
