<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DIDiskQuotaUser object</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Allows a client to manage an NTFS volume's global disk quota settings. This object makes the essential functionality of the DIDiskQuotaUser interface available to scripting and Microsoft Visual Basic-based applications.
title: DIDiskQuotaUser object
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>DIDiskQuotaUser
api_type:</li>
<li>COM
api_location:</li>
<li>Shell32.dll
ms.assetid: 0cdf3293-3dcf-44e7-a80d-4eacf9d09fbf</li>
</ul>
<hr />
<h1>DIDiskQuotaUser object</h1>
<p>Allows a client to manage an NTFS volume's global disk quota settings. This object makes the essential functionality of the <strong>DIDiskQuotaUser</strong> interface available to scripting and Microsoft Visual Basic-based applications.</p>
<h2>Members</h2>
<p>The <strong>DIDiskQuotaUser</strong> object has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>DIDiskQuotaUser</strong> object has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="didiskquotauser-invalidate.html"><strong>Invalidate</strong></a></td>
<td align="left">Clears the object's cached user information.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Properties</h3>
<p>The <strong>DIDiskQuotaUser</strong> object has these properties.</p>
<table>
<thead>
<tr>
<th align="left">Property</th>
<th align="left">Access type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="didiskquotauser-accountcontainername.html"><strong>AccountContainerName</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets the name of the user's account container.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="didiskquotauser-accountstatus.html"><strong>AccountStatus</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets the status of the user's account.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="didiskquotauser-displayname.html"><strong>DisplayName</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets the user's display name.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="didiskquotauser-id.html"><strong>ID</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets an ID that uniquely identifies the user.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="didiskquotauser-logonname.html"><strong>LogonName</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets the user's logon account name.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="didiskquotauser-quotalimit.html"><strong>QuotaLimit</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Sets or gets the user's current <a href="diskquotacontrol-object.html"><strong>quota limit</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="didiskquotauser-quotalimittext.html"><strong>QuotaLimitText</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets the user's current <a href="diskquotacontrol-object.html"><strong>quota limit</strong></a> as a text string. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="didiskquotauser-quotathreshold.html"><strong>QuotaThreshold</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Sets or gets the user's warning threshold, in bytes.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="didiskquotauser-quotathresholdtext.html"><strong>QuotaThresholdText</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets the user's warning threshold as a text string.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="didiskquotauser-quotaused.html"><strong>QuotaUsed</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets the user's current disk usage, in bytes.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="didiskquotauser-quotausedtext.html"><strong>QuotaUsedText</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets the user's current disk usage as a text string.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>Each user on the volume that is managed by the <a href="diskquotacontrol-object.html"><strong>DiskQuotaControl</strong></a> object has a <strong>DIDiskQuotaUser</strong> object associated with it. This object allows a client to manage an individual user's settings. There are several ways to obtain a user's <strong>DIDiskQuotaUser</strong> object:</p>
<ul>
<li>The <strong>DIDiskQuotaUser</strong> objects for all users with quotas on the volume are exposed as a collection and can be enumerated. A discussion of how to enumerate <strong>DIDiskQuotaUser</strong> objects is found below.</li>
<li>When you add a new user, the <a href="diskquotacontrol-adduser.html"><strong>AddUser</strong></a> method returns the user's <strong>DIDiskQuotaUser</strong> object.</li>
<li>If you have the user's name, the <a href="diskquotacontrol-finduser.html"><strong>FindUser</strong></a> method returns the user's <strong>DIDiskQuotaUser</strong> object.</li>
</ul>
<h3>Enumerating Disk Quota Users</h3>
<p>The <strong>DIDiskQuotaUser</strong> objects for all users with a quota on the volume are exposed as a collection. The <a href="diskquotacontrol-object.html"><strong>DiskQuotaControl</strong></a> object exports a standard enumerator method that allows you to enumerate the collection of <strong>DIDiskQuotaUser</strong> objects. The following procedure illustrates how to perform the enumeration with Microsoft JScript (compatible with ECMA 262 language specification). You can use a similar procedure with Visual Basic or Microsoft Visual Basic Scripting Edition (VBScript).</p>
<ol>
<li>Create a new <a href="diskquotacontrol-object.html"><strong>DiskQuotaControl</strong></a> object.</li>
<li>Initialize it with <a href="diskquotacontrol-initialize.html"><strong>Initialize</strong></a>.</li>
<li>Create a new JScript <strong>Enumerator</strong> object.</li>
<li>Use a <strong>for</strong> loop to enumerate the <strong>DIDiskQuotaUser</strong> objects. There is no need to set a starting value. The enumerator object's <strong>moveNext</strong> method notifies the <strong>item</strong> method to return the next <strong>DIDiskQuotaUser</strong> object. The <strong>atEnd</strong> method returns <strong>false</strong> when you reach the end of the list.</li>
<li>As needed, use the <strong>DIDiskQuotaUser</strong> object returned by the enumerator's <strong>item</strong> method to retrieve or set one or more of the associated user's disk quota properties.</li>
</ol>
<p>The following code fragment illustrates how to enumerate <strong>DIDiskQuotaUser</strong> objects with JScript. The <strong>Volume_Label</strong> argument that is passed to the <strong>EnumUsers</strong> function is a string value containing a volume label such as &quot;C:\\&quot;.</p>
<pre><code>function EnumUsers(Volume_Label)
{
    var Volume;
    var QuotaUsers;
    var QuotaUser;

    Volume = new ActiveXObject(&quot;Microsoft.DiskQuota.1&quot;);
    Volume.Initialize(Volume_Label, 1);

    QuotaUsers = new Enumerator(Volume);
    for (;!Users.atEnd(); Users.moveNext())
    {
       QuotaUser = QuotaUsers.item();

     //Use the QuotaUser object to retrieve or set one or more
     //of the user's disk quota properties
     ...
    }
}
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Shell32.dll (version 5.0 or later)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="shell.html"><strong>Shell Object</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
