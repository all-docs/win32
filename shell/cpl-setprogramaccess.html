<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Set Program Access and Computer Defaults (SPAD)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This topic discusses the Set Program Access and Computer Defaults (SPAD) feature found in Control Panel.
ms.assetid: 0d706857-5a84-4d68-99dc-bb9aab4197b9
title: Set Program Access and Computer Defaults (SPAD)
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Set Program Access and Computer Defaults (SPAD)</h1>
<p>This topic discusses the <strong>Set Program Access and Computer Defaults (SPAD)</strong> feature found in Control Panel. SPAD is located under the <a href="default-programs.html">Default Programs</a> Control Panel item in WindowsÂ Vista and later versions of Windows. In WindowsÂ XP, it is located in the <strong>Add or Remove Programs</strong> item and titled <strong>Set Program Access and Defaults</strong>.</p>
<blockquote>
<p>[!IMPORTANT]
This topic does not apply for WindowsÂ 10. The way that default file associations work changed in WindowsÂ 10. For more information, see the section on <strong>Changes to how Windows 10 handles default apps</strong> in <a href="https://blogs.windows.com/windows-insider/2015/05/20/announcing-windows-10-insider-preview-build-10122-for-pcs/">this post</a>.</p>
</blockquote>
<p>Â </p>
<ul>
<li><a href="#using-the-set-program-access-and-computer-defaults-tool">Using the Set Program Access and Computer Defaults Tool</a>
<ul>
<li><a href="#an-overview-of-set-program-access-and-computer-defaults">An Overview of Set Program Access and Computer Defaults</a></li>
<li><a href="#the-lastuserinitiateddefaultchange-registry-value">The LastUserInitiatedDefaultChange Registry Value</a></li>
</ul>
</li>
<li><a href="#filtering-the-add-or-remove-programs-list">Filtering the Add or Remove Programs List</a></li>
<li><a href="#filtering-the-add-or-remove-programs-list">Additional Resources</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Using the Set Program Access and Computer Defaults Tool</h2>
<blockquote>
<p>[!Note]<br />
As of WindowsÂ 8, SPAD configures defaults on a per-user basis for the current user. Prior to WindowsÂ 8, SPAD set per-computer defaults. When a per-user default has not yet been configured by the user, the system will prompt them to set a per-user default rather than falling back on a per-machine default. It's possible that the per-machine defaults were never seen by users in WindowsÂ Vista and WindowsÂ 7 if they had previously set per-user defaults, because per-user defaults override per-computer defaults in those operating systems.</p>
</blockquote>
<p>Â </p>
<p>In WindowsÂ XP, <strong>Set Program Access and Defaults</strong> is a tool found as an option in Control Panel's <strong>Add or Remove Programs</strong> item. In WindowsÂ Vista and later, it is located under the <a href="default-programs.html">Default Programs</a> Control Panel item. For <a href="reg-middleware-apps.html">registered</a> programs, it performs the following functions:</p>
<ul>
<li>Enables the choice of default programs for each client type (up to WindowsÂ 7 only).</li>
<li>Enables control of the display of the program's icons, shortcuts, and menu entries.</li>
<li>Provides a set of preset default program choices. (WindowsÂ XP Service PackÂ 1 (SP1) only)</li>
</ul>
<p>This tool is used for the following five client types.</p>
<ul>
<li>Browser</li>
<li>Email</li>
<li>Instant messaging program</li>
<li>Media player</li>
<li>Virtual machine for Java</li>
</ul>
<h3>An Overview of Set Program Access and Computer Defaults</h3>
<p>The WindowsÂ 8 <strong>Set Program Access and Computer Defaults</strong> page is shown in the following screen shot.</p>
<p><img src="images/spad-initial.png" alt="screen shot of the set program access and computer defaults entry view" /></p>
<p>Three possible configuration options are presented to the user, with the option for OEMs to present a fourth option titled &quot;Computer Manufacturer&quot;.</p>
<ul>
<li><a href="#microsoft-windows">Microsoft Windows</a></li>
<li><a href="#non-microsoft">Non-Microsoft</a></li>
<li><a href="#custom">Custom</a></li>
<li><a href="#computer-manufacturer">Computer Manufacturer</a></li>
</ul>
<h3>Microsoft Windows</h3>
<p>The <strong>Microsoft Windows</strong> configuration consists of a set of default programs provided with Windows, as shown in the following screen shot.</p>
<p><img src="images/mspage.png" alt="screen shot of the set program access and defaults microsoft options" /></p>
<p>Selecting the <strong>Microsoft Windows</strong> configuration also enables the display of the icons, shortcuts, or menu entries for each program registered for any of the five client types. Those icons, shortcuts, and menu entries are available to the user in the <strong>Start</strong> menu or Start screen, on the desktop, and in all other locations to which they were added.</p>
<h3>Non-Microsoft</h3>
<p>The <strong>Non-Microsoft</strong> configuration, shown in the following screen shot, is used for registered applications on the user's system that are not produced by Microsoft. These applications can be preinstalled on the user's system, or they can be non-Microsoft applications that the user has installed.</p>
<blockquote>
<p>[!Note]<br />
Applications must register to appear on this page. For instructions on registering an application, see <a href="reg-middleware-apps.html">Registering Programs with Client Types</a>.</p>
</blockquote>
<p>Â </p>
<p><img src="images/nonmspage.png" alt="screen shot of the set program access and defaults non-microsoft options" /></p>
<p>Selecting the <strong>Non-Microsoft</strong> option also removes access to the icons, shortcuts, and menu entries of the Microsoft programs listed in the <a href="#microsoft-windows">Microsoft Windows</a> configuration for all client types that have them. These Microsoft icons, shortcuts, and menu entries are removed from the <strong>Start</strong> menu, the desktop, and other locations to which they were added.</p>
<h3>Custom</h3>
<p>The <strong>Custom</strong> configuration, shown in the following screen shot, enables users to customize their systems with any combination of Microsoft and non-Microsoft programs registered as default possibilities for the five client types. This is the only one of the four options available in WindowsÂ 2000 Service PackÂ 3 (SP3).</p>
<p><img src="images/custompage.png" alt="screen shot of the set program access and defaults custom options" /></p>
<p>All options presented in the <a href="#microsoft-windows">Microsoft Windows</a> and <a href="#non-microsoft">Non-Microsoft</a> configurations are available to the user in the <strong>Custom</strong> section, as well as any additionally installed Microsoft applications that are not part of Windows. The <strong>Use my current web browser</strong> radio button is preselected, as shown in the preceding screen shot. There is no way to determine the current default browser from the UI. Invoking web links or files in Windows is the only way to discover the current default browser.</p>
<p>When a user selects the <strong>Enable access to this program</strong> check box for a program, that program's icons, shortcuts, and menu entries are displayed in the Start menu or Start screen, on the desktop, or in any other location where they were installed. Clearing this option should remove those icons, shortcuts, and menu entries, however, how these options behave is entirely up to the application vendor. Windows does not control how access is enabled or removed throughout the UI. It is also important to understand that applications are not required to register for <strong>Set Program Access and Computer Defaults</strong>.</p>
<h3>Computer Manufacturer</h3>
<p>A fourth category titled &quot;Computer Manufacturer&quot; can appear in the SPAD window on some systems. Computer manufacturers can choose to preconfigure their computers with a custom set of defaults, choosing from the same selections available in the <a href="#custom">Custom</a> configuration. (For illustrative purposes, a fictional set of applications called LitWare is registered for use with all client types.) A user can return to the computer manufacturer's default configuration at any time by choosing the <strong>Computer Manufacturer</strong> option, as shown in the following WindowsÂ XP screen shot.</p>
<blockquote>
<p>[!Note]<br />
This configuration does not appear on all systems. For details, refer to the OEM Preinstallation Kit (OPK).</p>
</blockquote>
<p>Â </p>
<p><img src="images/oempage.jpg" alt="screen shot of the set program access and defaults computer manufacturer options" /></p>
<h3>The LastUserInitiatedDefaultChange Registry Value</h3>
<p>The LastUserInitiatedDefaultChange value has been added to the registry to assist applications in recognizing and respecting the user's default choices. The value holds REG_BINARY data in the form of a <a href="/windows/win32/api/minwinbase/ns-minwinbase-filetime"><strong>FILETIME</strong></a> structure that contains the date and time (in Coordinated Universal Time (UTC)) of the last time the user changed a default choice through the <strong>Set Program Access and Computer Defaults</strong> tool. This value is found under the following subkey.</p>
<pre><code>HKEY_LOCAL_MACHINE
Â Â Â SOFTWARE
Â Â Â Â Â Â Clients
Â Â Â Â Â Â Â Â Â ClientTypeName
Â Â Â Â Â Â Â Â Â Â Â Â LastUserInitiatedDefaultChange = FILETIME
</code></pre>
<p>The following scenario uses this value for an application that monitors file associations.</p>
<ol>
<li>An application internally records the time when it was last set as the default program for its client type (either at installation or at a later time).</li>
<li>The application detects that the default program for its client type has been changed to a program other than itself or the application it represents (in the case of background helper programs). Not supported in WindowsÂ 8.</li>
<li>The application reads the value of LastUserInitiatedDefaultChange (the time stamp of the last user-initiated default change) and compares it to the time stamp value it has stored for its own choice as default.</li>
<li>If LastUserInitiatedDefaultChange is later than the application's stored value, then no action should be taken by that application because the change was explicitly requested by the user through the <strong>Set Program Access and Defaults</strong> tool.</li>
<li>The application no longer monitors that file association until it is again chosen as the default. Not supported in WindowsÂ 8.</li>
</ol>
<p>By adhering to such a scheme, the user's wishes are respected and their ultimate ownership of their systems is maintained.</p>
<h2>Filtering the Add or Remove Programs List</h2>
<blockquote>
<p>[!Note]<br />
This section applies to WindowsÂ XP Service PackÂ 2 (SP2) and later and Windows ServerÂ 2003 and later.</p>
</blockquote>
<p>Â </p>
<p>In WindowsÂ XP and Windows ServerÂ 2003, the list of applications displayed in the <strong>Change or Remove Programs</strong> tab under <strong>Add or Remove Programs</strong> can be filtered by the user to exclude entries for application updates. In these versions of Windows, this is accomplished through a <strong>Show updates</strong> check box at the top of the window. The <strong>Show updates</strong> option is not selected by default, so updates are <em>not</em> shown unless the user chooses to show them. Changes to the check box state persist when <strong>Add or Remove Programs</strong> is closed; if a user chooses to show the updates, they continue to be shown until the user clears the check box.</p>
<blockquote>
<p>[!Note]<br />
The WindowsÂ XPÂ SP2 update itself is an exception to the filtering. It is always displayed regardless of the check box state.</p>
</blockquote>
<p>Â </p>
<p>In WindowsÂ Vista and later, application updates are displayed on a separate page in Control Panel dedicated to updates alone. This page is shown when the user clicks the <strong>View installed updates</strong> task link. There is no user-selectable option to show updates on the same page as installed programs. Despite the change in UI, the mechanism for registering as an update to an installed program remains the same as in earlier versions of Windows.</p>
<p>Microsoft and non-Microsoft applications that use the Windows Installer do not need to do anything further for their updates to be recognized as updates. Non-Microsoft applications that do not use Windows Installer must declare certain values in the registry as part of their installation to be recognized as an update to an existing program.</p>
<p>The following example illustrates which registry values to declare for an installation to be recognized as an update to an existing program.</p>
<ol>
<li>The parent application must add its uninstall information in a subkey under the <strong>HKEY_LOCAL_MACHINE</strong>\<strong>Software</strong>\<strong>Microsoft</strong>\<strong>Windows</strong>\<strong>CurrentVersion</strong>\<strong>Uninstall</strong> subkey. See the <a href="/previous-versions/ms997548(v=msdn.10)">Installation</a> topic for more information on using the <strong>Uninstall</strong> subkey.</li>
<li>Each update to that parent application also must add its information as a subkey of the <strong>Uninstall</strong> subkey. It should use a particular naming convention of its choice, attempting to avoid potential conflicts with other programs. The following conventions are reserved as subkey names by Microsoft for use with Windows updates.
<ul>
<li>IEUpdate</li>
<li>OEUpdate</li>
<li>&quot;KB&quot; followed by six digits, for example &quot;KB123456&quot;</li>
<li>&quot;Q&quot; followed by six digits, for example &quot;Q123456&quot;</li>
<li>Six digits, for example &quot;123456&quot;</li>
</ul>
</li>
<li>In addition to the standard uninstall information added for the parent application, the subkeys for each update additionally must include two of the following three entries. Their values are of type REG_SZ.
<ul>
<li><strong>ParentKeyName</strong>. This value is required. This is the name of the parent's subkey declared in step 1. This associates the update with the program.</li>
<li><strong>ParentDisplayName</strong>. This value is required. If no subkey matches that named in ParentKeyName, this value is used as a placeholder parent program to be displayed in <strong>Add or Remove Programs</strong>.</li>
<li><strong>InstallDate</strong>. This value is optional. It should use the form <code>yyyymmdd</code> to specify the date. This date is used for the <strong>Installed On</strong> information displayed next to the update's entry in the UI. If there is no <strong>InstallDate</strong> entry or if it is present but has no value assigned to it, the following occurs:
<ul>
<li>Operating system versions other than WindowsÂ Vista and WindowsÂ 7: No <strong>Installed On</strong> information is shown.</li>
<li>WindowsÂ Vista and later: A default date is used. This is the &quot;last modified&quot; date for any of the entries under that update's subkey. This is normally the day that the update was added to the registry. However, because it is a &quot;last modified&quot; date, any subsequent change to any of the subkey's entries causes the InstallDate value to be changed to the date of that change.</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>The following example shows the pertinent registry entries for an update to the LitWare Deluxe application.</p>
<pre><code>HKEY_LOCAL_MACHINE
Â Â Â Software
Â Â Â Â Â Â Microsoft
Â Â Â Â Â Â Â Â Â Windows
Â Â Â Â Â Â Â Â Â Â Â Â CurrentVersion
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Uninstall
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â LitWare
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â DisplayName = LitWare Deluxe
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â UninstallString = &quot;C:\Program Files\LitWare\LitWare Deluxe\litware.exe&quot; /uninstall
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â LitWare_Update123456
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â DisplayName = LitWare Deluxe Update 123456. Fixes printing problems.
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â UninstallString = &quot;C:\Program Files\LitWare\LitWare Deluxe\Updates\123456.exe&quot; /uninstall
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ParentKeyName = LitWare
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ParentDisplayName = LitWare Deluxe
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â InstallDate = 20050513
</code></pre>
<p>Non-Microsoft applications that do not supply the appropriate registry information, such as updates produced before this option was available, continue to be displayed normally in the list of installed programs and are not filtered out.</p>
<p>Update filtering in operating system versions other than WindowsÂ Vista and WindowsÂ 7 is normally a user-controlled setting and should be respected as such by applications. However, in an enterprise environment, administrators can control whether users are given the option to filter updates through the DontGroupPatches registry value, as shown in the following example.</p>
<pre><code>HKEY_LOCAL_MACHINE
Â Â Â Software
Â Â Â Â Â Â Microsoft
Â Â Â Â Â Â Â Â Â Windows
Â Â Â Â Â Â Â Â Â Â Â Â CurrentVersion
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â policies
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Uninstall
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â DontGroupPatches = 0 or 1
</code></pre>
<p>This value is of type REG_DWORD and is interpreted as follows.</p>
<table>
<thead>
<tr>
<th>DontGroupPatches value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>The <strong>Show updates</strong> check box is displayed to the user. Filtering depends on whether the user has checked this box or not.</td>
</tr>
<tr>
<td>1</td>
<td>The <strong>Show updates</strong> check box is removed from the UI. Updates are not filtered from the list. This value essentially reverts to WindowsÂ XP SP1 behavior, before the <strong>Show updates</strong> functionality was introduced.</td>
</tr>
<tr>
<td>DontGroupPatches entry not present</td>
<td>This is equivalent to setting the value to 0.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>DontGroupPatches has no effect in WindowsÂ Vista and WindowsÂ 7, where the UI contains no check box and registered updates are always filtered.</p>
<blockquote>
<p>[!Note]<br />
Policies are set only by administrators. Applications should not alter this value. For more information on how to set a registry-based Group Policy, see <a href="/previous-versions/windows/desktop/Policy/group-policy-start-page">Group Policy</a> or <a href="/windows/deployment/deploy-whats-new">Windows Server Group Policy</a>.</p>
</blockquote>
<p>Â </p>
<h2>Additional Resources</h2>
<ul>
<li><a href="reg-middleware-apps.html">Registering Programs with Client Types</a></li>
<li><a href="/previous-versions/ms997548(v=msdn.10)">Installation</a></li>
<li><a href="../msi/configuring-add-remove-programs-with-windows-installer.html">Configuring Add/Remove Programs with Windows Installer</a></li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="fa-best-practices.html">Best Practices for File Associations</a></p>
<!-- raw HTML omitted -->
<p><a href="fa-sample-scenarios.html">File Association Sample Scenario</a></p>
<!-- raw HTML omitted -->
<p><a href="vista-managing-defaults.html">Guidelines for Managing Default Applications in Windows Vista and Later</a></p>
<!-- raw HTML omitted -->
<p><a href="default-programs.html">Default Programs</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
