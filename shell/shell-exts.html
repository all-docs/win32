<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Working with Shell Extensions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This set of topics discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.
ms.assetid: '794b6369-665f-49a9-a263-7c736c5ce8ac'
title: Working with Shell Extensions
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Working with Shell Extensions</h1>
<p>The capabilities of the Shell can be extended with registry entries and .ini files. While this approach to extending the Shell is simple, and adequate for many purposes, it is limited. For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type. Extending the Shell with the registry does not allow you to vary the icon for different members of the file type. Other aspects of the Shell, such as the <strong>Properties</strong> property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</p>
<p>A more powerful and flexible approach to extending the Shell is to implement <em>shell extension handlers</em>. These handlers can be implemented for a variety of actions that the Shell can take. Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action. A common example is a shortcut menu extension handler. If one is implemented for a file type, it will be queried every time one of the files is right-clicked. The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for all files of that file type.</p>
<p>This set of topics discusses how to implement the extension handlers that allow you to modify a variety of Shell actions. The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis.</p>
<table>
<thead>
<tr>
<th>Handler</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="context-menu-handlers.html">Shortcut menu handler</a></td>
<td>Called before a file's shortcut menu is displayed. It enables you to add items to the shortcut menu on a file-by-file basis.</td>
</tr>
<tr>
<td><a href="how-to-create-data-handlers.html">Data handler</a></td>
<td>Called when a drag-and-drop operation is performed on Shell objects. It enables you to provide additional clipboard formats to the drop target.</td>
</tr>
<tr>
<td><a href="how-to-create-drop-handlers.html">Drop handler</a></td>
<td>Called when a data object is dragged over or dropped on a file. It enables you to make a file into a drop target.</td>
</tr>
<tr>
<td><a href="how-to-create-icon-handlers.html">Icon handler</a></td>
<td>Called before a file's icon is displayed. It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</td>
</tr>
<tr>
<td><a href="propsheet-handlers.html">Property sheet handler</a></td>
<td>Called before an object's <strong>Properties</strong> property sheet is displayed. It enables you to add or replace pages.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider"><strong>Thumbnail Image handler</strong></a></td>
<td>Provides an image to represent the item.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo"><strong>Infotip handler</strong></a></td>
<td>Provides pop-up text when the user hovers the mouse pointer over the object.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/propidl/nn-propidl-ipropertysetstorage"><strong>Metadata handler</strong></a></td>
<td>Provides read and write access to metadata (properties) stored in a file. This can be used to extend the Details view, infotips, the property page, and grouping features.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Others are not associated with a particular file type but are called before some Shell operations.</p>
<table>
<thead>
<tr>
<th>Handler</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="../lwef/column-handlers.html">Column handler</a></td>
<td>Called by Windows Explorer before it displays the Details view of a folder. It enables you to add custom columns to the Details view.</td>
</tr>
<tr>
<td><a href="how-to-create-copy-hook-handlers.html">Copy hook handler</a></td>
<td>Called when a folder or printer object is about to be moved, copied, deleted, or renamed. It enables you to approve or veto the operation.</td>
</tr>
<tr>
<td><a href="context-menu-handlers.html">Drag-and-drop handler</a></td>
<td>Called when a file is dragged with the right mouse button. It enables you to modify the shortcut menu that is displayed.</td>
</tr>
<tr>
<td><a href="how-to-implement-icon-overlay-handlers.html">Icon Overlay handler</a></td>
<td>Called before a file's icon is displayed. It enables you to specify an overlay for the file's icon.</td>
</tr>
<tr>
<td><a href="../lwef/search-handlers.html">Search handler</a></td>
<td>Called to launch a search engine. It enables you to implement a custom search engine accessible from the <strong>Start</strong> menu or Windows Explorer.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The details of how to implement specific extension handlers are covered in the sections listed above. For discussions of implementation issues that are common to all Shell extension handlers, see these topics:</p>
<ul>
<li><a href="int-shell-exts.html">Initializing Shell Extension Handlers</a></li>
<li><a href="reg-shell-exts.html">Registering Shell Extension Handlers</a></li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
