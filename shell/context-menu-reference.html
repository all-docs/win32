<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Shortcut Menu Reference</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This topic lists the main programming elements used with shortcut (context) menus, and shortcut menu handlers. Shortcut menu handlers, which also known as context menu handlers or verb handlers, are a type of file type handler.
ms.assetid: efd96a52-6455-40bc-9c21-65f89728e771
title: Shortcut Menu Reference
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Shortcut Menu Reference</h1>
<p>This topic lists the main programming elements used with shortcut (context) menus, and shortcut menu handlers. Shortcut menu handlers, which also known as context menu handlers or verb handlers, are a type of file type handler.</p>
<h2>About Shortcut Menu Implementation</h2>
<p>It is strongly encouraged that you implement a shortcut menu using one of the static verb methods. Please review the following instructions:</p>
<ul>
<li>To use a static verb method to implement a shortcut menu, see the &quot;Customizing a Shortcut Menu using Static Verbs&quot; section of <a href="context-menu-handlers.html">Creating Shortcut Menu Handlers</a>.</li>
<li>To get dynamic behavior for static verbs in WindowsÂ 7 and later, see &quot;Getting Dynamic Behavior for Static Verbs&quot; in <a href="context-menu-handlers.html">Creating Shortcut Menu Handlers</a>.</li>
<li>For details on static verb implementation, and which dynamic verbs to avoid, see <a href="shortcut-choose-method.html">Choosing a Static or Dynamic Verb for your Shortcut Menu</a>.</li>
<li>If you must extend the shortcut menu for a file type by registering a dynamic verb for the file type, then follow the instructions provided in <a href="shortcut-menu-using-dynamic-verbs.html">Customizing a Shortcut Menu Using Dynamic Verbs</a>.</li>
</ul>
<h3>Interfaces</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu"><strong>IContextMenu</strong></a></td>
<td>Exposes methods that either create or merge a shortcut menu associated with a Shell object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2"><strong>IContextMenu2</strong></a></td>
<td>Exposes methods that either create or merge a shortcut (context) menu associated with a Shell object. Extends <a href="/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu"><strong>IContextMenu</strong></a> by adding a method that allows client objects to handle messages associated with owner-drawn menu items.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu3"><strong>IContextMenu3</strong></a></td>
<td>Exposes methods that either create or merge a shortcut menu associated with a Shell object. Allows client objects to handle messages associated with owner-drawn menu items and extends <a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2"><strong>IContextMenu2</strong></a> by accepting a return value from that message handling.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenucb"><strong>IContextMenuCB</strong></a></td>
<td>Exposes a method that enables the callback of a context menu. For example, to add a shield icon to a <strong>menuItem</strong> that requires elevation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenusite"><strong>IContextMenuSite</strong></a></td>
<td>Implemented by the default folder view created using <a href="/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview"><strong>SHCreateShellFolderView</strong></a>. An implementation of <a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenusite"><strong>IContextMenuSite</strong></a> supports <a href="/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu"><strong>IContextMenu::QueryContextMenu</strong></a>, <a href="/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand"><strong>IContextMenu::InvokeCommand</strong></a>, and <a href="/windows/win32/api/winuser/nf-winuser-trackpopupmenu"><strong>TrackPopupMenu</strong></a> and any message forwarding necessary for that function. <strong>IContextMenuSite</strong> typically updates the status bar as well.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Functions</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/shlobj_core/nf-shlobj_core-cdeffoldermenu_create2"><strong>CDefFolderMenu_Create2</strong></a></td>
<td>Creates a context menu for a selected group of file folder objects.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/shlobj_core/nc-shlobj_core-lpfndfmcallback"><strong>LPFNDFMCALLBACK</strong></a></td>
<td>Defines the prototype for the callback function that receives messages from the Shell's default context menu implementation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreatedefaultcontextmenu"><strong>SHCreateDefaultContextMenu</strong></a></td>
<td>Creates an object that represents the Shell's default context menu implementation.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Structures</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfo"><strong>CMINVOKECOMMANDINFO</strong></a></td>
<td>Contains information needed by <a href="/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand"><strong>IContextMenu::InvokeCommand</strong></a> to invoke a shortcut menu command.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfoex"><strong>CMINVOKECOMMANDINFOEX</strong></a></td>
<td>Contains extended information about a shortcut menu command. This structure is an extended version of <a href="/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfo"><strong>CMINVOKECOMMANDINFO</strong></a> that allows the use of Unicode values.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/shlobj_core/ns-shlobj_core-defcontextmenu"><strong>DEFCONTEXTMENU</strong></a></td>
<td>Contains context menu information used by <a href="/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreatedefaultcontextmenu"><strong>SHCreateDefaultContextMenu</strong></a>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="context-menu.html">Shortcut (Context) Menus and Shortcut Menu Handlers</a></p>
<!-- raw HTML omitted -->
<p><a href="shortcut-choose-method.html">Choosing a Static or Dynamic Verb for your Shortcut Menu</a></p>
<!-- raw HTML omitted -->
<p><a href="fa-verbs.html">Verbs and File Associations</a></p>
<!-- raw HTML omitted -->
<p><a href="verbs-best-practices.html">Best Practices for Shortcut Menu Handlers and Multiple Selection Verbs</a></p>
<!-- raw HTML omitted -->
<p><a href="context-menu-handlers.html">Creating Shortcut Menu Handlers</a></p>
<!-- raw HTML omitted -->
<p><a href="shortcut-menu-using-dynamic-verbs.html">Customizing a Shortcut Menu Using Dynamic Verbs</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
