<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Shell.BrowseForFolder method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Shell.BrowseForFolder method - Creates a dialog box that enables the user to select a folder and then returns the selected folder's Folder object.
title: Shell.BrowseForFolder method (Shldisp.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>Shell.BrowseForFolder
api_type:</li>
<li>COM
api_location:</li>
<li>Shell32.dll
ms.assetid: 4cc44e5a-3578-448b-9b19-1b71e1ae2cb9</li>
</ul>
<hr />
<h1>Shell.BrowseForFolder method</h1>
<p>Creates a dialog box that enables the user to select a folder and then returns the selected folder's <a href="folder.html"><strong>Folder</strong></a> object.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>retVal = Shell.BrowseForFolder(
  Hwnd,
  sTitle,
  iOptions,
  [ vRootFolder ]
)
</code></pre>
<pre lang="VB"><code>
Shell.BrowseForFolder( _
  ByVal Hwnd As Integer, _
  ByVal sTitle As BSTR, _
  ByVal iOptions As Integer, _
  [ ByVal vRootFolder As Variant ] _
) As FOLDER
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Hwnd</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>Integer</strong></p>
<p>The handle to the parent window of the dialog box. This value can be zero.</p>
<!-- raw HTML omitted -->
<p><em>sTitle</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="/previous-versions/windows/desktop/automat/bstr"><strong>BSTR</strong></a></strong></p>
<p>A <strong>String</strong> value that represents the title displayed inside the <strong>Browse</strong> dialog box.</p>
<!-- raw HTML omitted -->
<p><em>iOptions</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>Integer</strong></p>
<p>An <strong>Integer</strong> value that contains the options for the method. This can be zero or a combination of the values listed under the <strong>ulFlags</strong> member of the <a href="/windows/desktop/api/shlobj_core/ns-shlobj_core-browseinfoa"><strong>BROWSEINFO</strong></a> structure.</p>
<!-- raw HTML omitted -->
<p><em>vRootFolder</em> [in, optional]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>Variant</strong></p>
<p>The root folder to use in the dialog box. The user cannot browse higher in the tree than this folder. If this value is not specified, the root folder used in the dialog box is the desktop. This value can be a string that specifies the path of the folder or one of the <a href="/windows/desktop/api/Shldisp/ne-shldisp-shellspecialfolderconstants"><strong>ShellSpecialFolderConstants</strong></a> values. Note that the constant names found in <strong>ShellSpecialFolderConstants</strong> are available in Visual Basic, but not in VBScript or JScript. In those cases, the numeric values must be used in their place.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<h3>JScript</h3>
<p>Type: <strong>FOLDER**</strong></p>
<p>An object reference to the selected folder's <a href="folder.html"><strong>Folder</strong></a> object.</p>
<h3>VB</h3>
<p>Type: <strong>FOLDER**</strong></p>
<p>An object reference to the selected folder's <a href="folder.html"><strong>Folder</strong></a> object.</p>
<h2>Examples</h2>
<p>The following example uses <strong>BrowseForFolder</strong> to display a browse window titled &quot;Example&quot; rooted at the Windows folder. Proper usage is shown for JScript, VBScript, and Visual Basic.</p>
<p>JScript:</p>
<pre lang="JScript"><code>&lt;script language=&quot;JScript&quot;&gt;
    function fnShellBrowseForFolderJ()
    {
        var objShell = new ActiveXObject(&quot;shell.application&quot;);
        var ssfWINDOWS = 36;
        var objFolder;
        
        objFolder = objShell.BrowseForFolder(0, &quot;Example&quot;, 0, ssfWINDOWS);
        if (objFolder != null)
        {
            // Add code here.
        }
    }
&lt;/script&gt;
</code></pre>
<p>VBScript:</p>
<pre lang="VB"><code>&lt;script language=&quot;VBScript&quot;&gt;
    function fnShellBrowseForFolderVB()
        dim objShell
        dim ssfWINDOWS
        dim objFolder
        
        ssfWINDOWS = 36
        set objShell = CreateObject(&quot;shell.application&quot;)
            set objFolder = objShell.BrowseForFolder(0, &quot;Example&quot;, 0, ssfWINDOWS)
                if (not objFolder is nothing) then
                    'Add code here.
                end if
            set objFolder = nothing
        set objShell = nothing
    end function
 &lt;/script&gt;
</code></pre>
<p>Visual Basic:</p>
<pre lang="VB"><code>Private Sub fnShellBrowseForFolderVB()
    Dim objShell   As Shell
    Dim ssfWINDOWS As Long
    Dim objFolder  As Folder
    
    ssfWINDOWS = 36
    Set objShell = New Shell
        Set objFolder = objShell.BrowseForFolder(0, &quot;Example&quot;, 0, ssfWINDOWS)
            If (Not objFolder Is Nothing) Then
                'Add code here
            End If
        Set objFolder = Nothing
    Set objShell = Nothing
End Sub
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Professional, WindowsÂ XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Shldisp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IDL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Shldisp.idl<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Shell32.dll (version 4.71 or later)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
