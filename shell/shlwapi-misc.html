<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Shell Miscellaneous Utility Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: This section describes those Windows Shell functions exported by Shlwapi.dll and defined in Shlwapi.h and Shlwapi.lib that do not fall under one of the other utility function categories.
title: Shell Miscellaneous Utility Functions
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 11787717-6370-408d-9a86-e208b33521c7
api_name:
api_type:
api_location:
topic_type:</p>
<ul>
<li>kbArticle</li>
</ul>
<hr />
<h1>Shell Miscellaneous Utility Functions</h1>
<p>This section describes those Windows Shell functions exported by Shlwapi.dll and defined in Shlwapi.h and Shlwapi.lib that do not fall under one of the other utility function categories.</p>
<h2>In this section</h2>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-dllinstall"><strong>DllInstall</strong></a><!-- raw HTML omitted --></td>
<td>Handles installation and setup for a DLL.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-getprocessreference"><strong>GetProcessReference</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves the process-specific object supplied by <a href="/windows/desktop/api/Shlwapi/nf-shlwapi-setprocessreference"><strong>SetProcessReference</strong></a>, incrementing the reference count to keep the process alive.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-hashdata"><strong>HashData</strong></a><!-- raw HTML omitted --></td>
<td>Hashes an array of data.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-isinternetescenabled"><strong>IsInternetESCEnabled</strong></a><!-- raw HTML omitted --></td>
<td>Determines whether Windows Internet Explorer is in the Enhanced Security Configuration.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-isos"><strong>IsOS</strong></a><!-- raw HTML omitted --></td>
<td>Checks for specified operating systems and operating system features.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-istream_copy"><strong>IStream_Copy</strong></a><!-- raw HTML omitted --></td>
<td>Copies a stream to another stream.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-istream_read"><strong>IStream_Read</strong></a><!-- raw HTML omitted --></td>
<td>Reads bytes from a specified stream and returns a value that indicates whether all bytes were successfully read.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-istream_readpidl"><strong>IStream_ReadPidl</strong></a><!-- raw HTML omitted --></td>
<td>Reads a pointer to an item identifier list (PIDL) from an <a href="/windows/win32/api/objidl/nn-objidl-istream"><strong>IStream</strong></a> object into a PIDLIST_RELATIVE object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-istream_readstr"><strong>IStream_ReadStr</strong></a><!-- raw HTML omitted --></td>
<td>Reads from a stream and writes into a string.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-istream_reset"><strong>IStream_Reset</strong></a><!-- raw HTML omitted --></td>
<td>Moves the seek position in a specified stream to the beginning of the stream.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-istream_size"><strong>IStream_Size</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves the size, in bytes, of a specified stream.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-istream_write"><strong>IStream_Write</strong></a><!-- raw HTML omitted --></td>
<td>Writes data of unknown format from a buffer to a specified stream.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-istream_writepidl"><strong>IStream_WritePidl</strong></a><!-- raw HTML omitted --></td>
<td>Writes a PIDL from a PCUIDLIST_RELATIVE object into an <a href="/windows/win32/api/objidl/nn-objidl-istream"><strong>IStream</strong></a> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-istream_writestr"><strong>IStream_WriteStr</strong></a><!-- raw HTML omitted --></td>
<td>Reads from a string and writes into a stream.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-iunknown_atomicrelease"><strong>IUnknown_AtomicRelease</strong></a><!-- raw HTML omitted --></td>
<td>Releases a Component Object Model (COM) pointer and sets it to <strong>NULL</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-iunknown_getsite"><strong>IUnknown_GetSite</strong></a><!-- raw HTML omitted --></td>
<td>Calls the specified object's <a href="/windows/win32/api/ocidl/nf-ocidl-iobjectwithsite-getsite"><strong>IObjectWithSite::GetSite</strong></a> method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-iunknown_getwindow"><strong>IUnknown_GetWindow</strong></a><!-- raw HTML omitted --></td>
<td>Attempts to retrieve a window handle from a COM object by querying for various interfaces that have a <strong>GetWindow</strong> method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-iunknown_queryservice"><strong>IUnknown_QueryService</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves an interface for a service from a specified object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-iunknown_set"><strong>IUnknown_Set</strong></a><!-- raw HTML omitted --></td>
<td>Changes the value of a COM interface pointer and releases the previous interface.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-iunknown_setsite"><strong>IUnknown_SetSite</strong></a><!-- raw HTML omitted --></td>
<td>Sets the specified object's site by calling its <a href="/windows/win32/api/ocidl/nf-ocidl-iobjectwithsite-setsite"><strong>IObjectWithSite::SetSite</strong></a> method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-parseurla"><strong>ParseURL</strong></a><!-- raw HTML omitted --></td>
<td>Performs rudimentary parsing of a URL.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-qisearch"><strong>QISearch</strong></a><!-- raw HTML omitted --></td>
<td>A table-driven implementation of the <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)"><strong>IUnknown::QueryInterface</strong></a> method.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-setprocessreference"><strong>SetProcessReference</strong></a><!-- raw HTML omitted --></td>
<td>Provides a COM object that allows hosted Shell extensions and other components to prevent their host process from closing prematurely. The host process is typically Windows Explorer or Internet Explorer, but this function can also be used by other applications.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/shlwapi/nf-shlwapi-shautocomplete"><strong>SHAutoComplete</strong></a><!-- raw HTML omitted --></td>
<td>Instructs system edit controls to use AutoComplete to help complete URLs or file system paths.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatememstream"><strong>SHCreateMemStream</strong></a><!-- raw HTML omitted --></td>
<td>Creates a memory stream using a similar process to <a href="/windows/win32/api/combaseapi/nf-combaseapi-createstreamonhglobal"><strong>CreateStreamOnHGlobal</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatestreamonfileex"><strong>SHCreateStreamOnFileEx</strong></a><!-- raw HTML omitted --></td>
<td>Opens or creates a file and retrieves a stream to read or write to that file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethread"><strong>SHCreateThread</strong></a><!-- raw HTML omitted --></td>
<td>Creates a thread.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethreadref"><strong>SHCreateThreadRef</strong></a><!-- raw HTML omitted --></td>
<td>Creates a per-thread reference to a COM object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethreadwithhandle"><strong>SHCreateThreadWithHandle</strong></a><!-- raw HTML omitted --></td>
<td>Creates a new thread and retrieves its handle.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shgetthreadref"><strong>SHGetThreadRef</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves the per-thread object reference set by <a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref"><strong>SHSetThreadRef</strong></a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shglobalcounterdecrement"><strong>SHGlobalCounterDecrement</strong></a><!-- raw HTML omitted --></td>
<td>Decrements a global counter.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shglobalcountergetvalue"><strong>SHGlobalCounterGetValue</strong></a><!-- raw HTML omitted --></td>
<td>Gets the current value of a global counter.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shglobalcounterincrement"><strong>SHGlobalCounterIncrement</strong></a><!-- raw HTML omitted --></td>
<td>Increments a global counter.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/shlwapi/nf-shlwapi-shislowmemorymachine"><strong>SHIsLowMemoryMachine</strong></a><!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shreleasethreadref"><strong>SHReleaseThreadRef</strong></a><!-- raw HTML omitted --></td>
<td>Releases a thread reference before the thread procedure returns.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref"><strong>SHSetThreadRef</strong></a><!-- raw HTML omitted --></td>
<td>Stores a per-thread reference to a COM object. This allows the caller to control the thread's lifetime so that it can ensure that Windows won't shut down the thread before the caller is ready.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
