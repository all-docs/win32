<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Implement Custom Verbs for Folders through Desktop.ini</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: In WindowsÂ 7 and later, you can add verbs to a folder by using Desktop.ini. For more information about Desktop.ini files, see How to Customize Folders with Desktop.ini.
ms.assetid: F03AB35D-FBFE-46C2-A37F-F70C18219B9A
title: How to Implement Custom Verbs for Folders through Desktop.ini
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Implement Custom Verbs for Folders through Desktop.ini</h1>
<p>In WindowsÂ 7 and later, you can add verbs to a folder by using Desktop.ini. For more information about Desktop.ini files, see <a href="how-to-customize-folders-with-desktop-ini.html">How to Customize Folders with Desktop.ini</a>.</p>
<blockquote>
<p>[!Note]<br />
Desktop.ini files should always be marked <strong>System</strong> + <strong>Hidden</strong> so they won't be displayed to users.</p>
</blockquote>
<p>Â </p>
<p>To add custom verbs for folders through a Desktop.ini file, perform the following steps.</p>
<h2>Instructions</h2>
<h3>Step 1:</h3>
<p>Create a folder that is marked <strong>Read-only</strong> or <strong>System</strong>.</p>
<h3>Step 2:</h3>
<p>Create a Desktop.ini file that includes a [.ShellClassInfo] DirectoryClass=Folder ProgID.</p>
<h3>Step 3:</h3>
<p>In the registry, create <strong>HKEY_CLASSES_ROOT</strong>\<strong>Folder ProgID</strong> with a value of CanUseForDirectory. The CanUseForDirectory value avoids the misuse of ProgIDs that are set not to participate in implementing custom verbs for folders through Desktop.ini.</p>
<h3>Step 4:</h3>
<p>Add verbs under the <strong>Folder</strong> ProgID subkey, for example:</p>
<pre><code>HKEY_CLASSES_ROOT
Â Â Â CustomFolderType
Â Â Â Â Â Â Shell
Â Â Â Â Â Â Â Â Â MyVerb
Â Â Â Â Â Â Â Â Â Â Â Â command
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (Default) = %SystemRoot%\system32\notepad.exe %1\desktop.ini
</code></pre>
<h2>Remarks</h2>
<blockquote>
<p>[!Note]<br />
These verbs can be the default verbs, in which case double-clicking the folder activates the verb.</p>
</blockquote>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
