<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EstimateFileRiskLevel function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Estimates the risk of executing unknown code when a handler is called on a given file. This risk is based on an understanding of the handler and the code content of the file.
title: EstimateFileRiskLevel function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>EstimateFileRiskLevel
api_type:</li>
<li>DllExport
api_location:</li>
<li>Winshfhc.dll
ms.assetid: 33a5589a-201b-4d94-afbf-5965a39e2748</li>
</ul>
<hr />
<h1>EstimateFileRiskLevel function</h1>
<p>[This function is available on WindowsÂ XP with Service PackÂ 2 (SP2) through WindowsÂ Vista. It might be altered or unavailable in subsequent versions of Windows. Client applications instead should use <a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iattachmentexecute"><strong>IAttachmentExecute</strong></a> to present a user environment that provides safe download and exchange of files through email and messaging attachments.]</p>
<p>Estimates the risk of executing unknown code when a handler is called on a given file. This risk is based on an understanding of the handler and the code content of the file.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT EstimateFileRiskLevel(
  _In_Â Â LPCWSTR Â Â Â Â Â Â Â Â pszFilePath,
  _In_Â Â LPCWSTR Â Â Â Â Â Â Â Â pszExt,
  _In_Â Â LPCWSTR Â Â Â Â Â Â Â Â pszHandler,
  _Out_Â FILE_RISK_LEVEL *pfrlEstimate
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>pszFilePath</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPCWSTR</strong></p>
<p>A pointer to a null-terminated string that contains the path of the file that is being checked against the handler.</p>
<!-- raw HTML omitted -->
<p><em>pszExt</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPCWSTR</strong></p>
<p>A pointer to a null-terminated string that contains the extension of the file that is being checked, either with or without its leading period. For instance, &quot;.txt&quot; or &quot;txt&quot;.</p>
<!-- raw HTML omitted -->
<p><em>pszHandler</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPCWSTR</strong></p>
<p>A pointer to a null-terminated string that contains the path of the handler for the file.</p>
<!-- raw HTML omitted -->
<p><em>pfrlEstimate</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>FILE_RISK_LEVEL*</strong></p>
<p>When this function returns successfully, contains a pointer to one of the following values that state the estimated risk.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FRL_NO_OPINION</strong> (0)</p>
<!-- raw HTML omitted -->
<p>The format of the file is not identified or the handler is not identified. Insufficient information available for a meaningful answer.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FRL_LOW</strong> (1)</p>
<!-- raw HTML omitted -->
<p>The format of the file is completely understood, the handler is known, and there is high confidence that no extraneous code will be executed.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FRL_MODERATE</strong> (2)</p>
<!-- raw HTML omitted -->
<p>The format of the file is identified, but it is not sufficiently understood to label as either a high or low risk.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FRL_HIGH</strong> (3)</p>
<!-- raw HTML omitted -->
<p>The file format is understood and elevated risk factors have been identified.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FRL_BLOCK</strong> (4)</p>
<!-- raw HTML omitted -->
<p>The file format is specifically blocked for this handler.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>HRESULT</strong></p>
<p>If this function succeeds, it returns <strong>S_OK</strong>. Otherwise, it returns an <strong>HRESULT</strong> error code.</p>
<h2>Remarks</h2>
<p>This function is not declared in a public header or included in a library file. To use it you must load it directly from Winshfhc.dll by ordinal 101.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ XP with SP2 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winshfhc.dll (version 5.1 or later)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
