<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SHExtractIconsW function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Creates an array of handles to icons extracted from a specified file.
title: SHExtractIconsW function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>SHExtractIconsW</li>
<li>SHExtractIconsW
api_type:</li>
<li>DllExport
api_location:</li>
<li>Shell32.dll
ms.assetid: 9f138b4e-6a84-4c7e-9521-5f8ffe0eaebf</li>
</ul>
<hr />
<h1>SHExtractIconsW function</h1>
<p>Creates an array of handles to icons extracted from a specified file.</p>
<blockquote>
<p>[!NOTE]
This function is available through WindowsÂ XP Service PackÂ 2 (SP2). It might be altered or unavailable in subsequent versions. Use <!-- raw HTML omitted -->SHDefExtractIcon<!-- raw HTML omitted --> function instead.</p>
</blockquote>
<h2>Syntax</h2>
<pre lang="C++"><code>UINT SHExtractIconsW(
  _In_Â Â LPCWSTR pszFileName,
  _In_Â Â int Â Â Â Â nIconIndex,
  _In_Â Â int Â Â Â Â cxIcon,
  _In_Â Â int Â Â Â Â cyIcon,
  _Out_Â HICON Â Â *phIcon,
  _Out_Â UINT Â Â Â *pIconId,
  _In_Â Â UINT Â Â Â nIcons,
  _In_Â Â UINT Â Â Â flags
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>pszFileName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPCWSTR</strong></p>
<p>A pointer to the file name from which to extract the icons.</p>
<!-- raw HTML omitted -->
<p><em>nIconIndex</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>int</strong></p>
<p>The index of the first icon to extract from the resource named in <em>pszFileName</em>.</p>
<!-- raw HTML omitted -->
<p><em>cxIcon</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>int</strong></p>
<p>The desired width of the icon. See Remarks.</p>
<!-- raw HTML omitted -->
<p><em>cyIcon</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>int</strong></p>
<p>The desired height of the icon. See Remarks.</p>
<!-- raw HTML omitted -->
<p><em>phIcon</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>HICON*</strong></p>
<p>When this function returns, contains a pointer to the array of icon handles.</p>
<!-- raw HTML omitted -->
<p><em>pIconId</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>UINT*</strong></p>
<p>When this function returns, contains a pointer to the resource identifier of the extracted icon that best fits the current display device. If there is no identifier available for this format, it contains 0xFFFFFFFF. If no identifier can be obtained for any other reason, returns zero.</p>
<!-- raw HTML omitted -->
<p><em>nIcons</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>UINT</strong></p>
<p>The number of icons to extract from the resource named in <em>pszFileName</em>. This parameter is valid only when the resource is a .exe or .dll file.</p>
<!-- raw HTML omitted -->
<p><em>flags</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>UINT</strong></p>
<p>The flags that control this function. For possible values, see the <em>fuLoad</em> parameter of the <a href="/windows/win32/api/winuser/nf-winuser-loadimagea"><strong>LoadImage</strong></a> function.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>UINT</strong></p>
<p>A nonzero value if successful; otherwise, zero.</p>
<h2>Remarks</h2>
<p><strong>SHExtractIconsW</strong> extracts from the following file types.</p>
<ul>
<li>Executable (.exe)</li>
<li>DLL (.dll)</li>
<li>Icon (.ico)</li>
<li>Cursor (.cur)</li>
<li>Animated cursor (.ani)</li>
<li>Bitmap (.bmp)</li>
</ul>
<p>Extractions from Windows 3.<em>x</em> 16-bit executable files (.exe or .dll) are also supported.</p>
<p>The <em>cxIcon</em> and <em>cyIcon</em> parameters specify the size of the icons to extract. Two sizes can be extracted through each parameter by splitting the value between its LOWORD and HIWORD. Put the first desired size in the LOWORD of the parameter and the second size in the HIWORD. For example, <a href="../winmsg/makelong.html"><strong>MAKELONG</strong></a>(24, 48) for both <em>cxIcon</em> and <em>cyIcon</em> extracts both 24 and 48 sized icons.</p>
<p>The calling process is responsible for destroying all icons extracted through this function by calling the <a href="/windows/win32/api/winuser/nf-winuser-destroyicon"><strong>DestroyIcon</strong></a> function.</p>
<p><strong>SHExtractIconsW</strong> is not exported by name or declared in a public header file. To use it, you must declare a matching prototype and use <a href="/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress"><strong>GetProcAddress</strong></a> to request a function pointer from Shell32.dll that can be used to call this function.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Professional, WindowsÂ XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Shell32.dll (version 5.0 or later)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Unicode and ANSI names<!-- raw HTML omitted --></td>
<td><strong>SHExtractIconsW</strong> (Unicode)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
