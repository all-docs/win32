<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>WOWShellExecute function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Performs an operation on a specified file.
ms.assetid: ce652565-40b6-4f69-bd2a-9e05e3f360ac
title: WOWShellExecute function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>WOWShellExecute
api_type:</li>
<li>DllExport
api_location:</li>
<li>Shell32.dll</li>
</ul>
<hr />
<h1>WOWShellExecute function</h1>
<p>[This function is available through WindowsÂ XP with Service PackÂ 2 (SP2) and Windows ServerÂ 2003. It might be altered or unavailable in subsequent versions of Windows.]</p>
<p>Performs an operation on a specified file. <strong>WOWShellExecute</strong> exists only for use with the Microsoft WindowsÂ NT Virtual DOS Machine (Ntvdm.exe), which allows disk operating system (DOS) and 16-bit software to run on a Windows system, and should not be used by anyone else. Use <a href="/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea"><strong>ShellExecute</strong></a> instead.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HINSTANCE WOWShellExecute(
  _In_Â HWND Â Â Â hwnd,
  _In_Â LPCTSTR lpOperation,
  _In_Â LPCTSTR lpFile,
  _In_Â LPCTSTR lpParameters,
  _In_Â LPCTSTR lpDirectory,
  _In_Â INT Â Â Â Â nShowCmd,
  Â Â Â Â Â void Â Â Â *lpfnCBWinExec
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hwnd</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>HWND</strong></p>
<p>A handle to the owner window used for displaying a UI or error messages. This value can be <strong>NULL</strong> if the operation is not associated with a window.</p>
<!-- raw HTML omitted -->
<p><em>lpOperation</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPCTSTR</strong></p>
<p>A pointer to a <strong>null</strong>-terminated string, referred to in this case as a <em>verb</em>, that specifies the action to be performed. The set of available verbs depends on the particular file or folder. Generally, the actions available from an object's shortcut menu are available verbs. For more information about verbs and their availability, see the <em>Object Verbs</em> section of <a href="launch.html">Launching Applications</a>. See <a href="context.html">Extending Shortcut Menus</a> for further discussion of shortcut menus. The following verbs are commonly used.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>edit</strong></p>
<!-- raw HTML omitted -->
<p>Launches an editor and opens the document for editing. If <em>lpFile</em> is not a document file, the function will fail.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>explore</strong></p>
<!-- raw HTML omitted -->
<p>Explores the folder specified by <em>lpFile</em>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>find</strong></p>
<!-- raw HTML omitted -->
<p>Initiates a search starting from the specified directory.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>open</strong></p>
<!-- raw HTML omitted -->
<p>Opens the file specified by the <em>lpFile</em> parameter. The file can be an executable file, a document file, or a folder.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>print</strong></p>
<!-- raw HTML omitted -->
<p>Prints the document file specified by <em>lpFile</em>. If <em>lpFile</em> is not a document file, the function will fail.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NULL</strong></p>
<!-- raw HTML omitted -->
<p>For systems prior to WindowsÂ 2000, the default verb is used if it is valid and available in the registry. If not, the &quot;open&quot; verb is used.</p>
<p>For WindowsÂ 2000 and later systems, the default verb is used if available. If not, the &quot;open&quot; verb is used. If neither verb is available, the system uses the first verb listed in the registry.</p>
<!-- raw HTML omitted -->
<p><em>lpFile</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPCTSTR</strong></p>
<p>A pointer to a <strong>null</strong>-terminated string that specifies the file or object on which to execute the specified verb. To specify a Shell namespace object, pass the fully qualified parse name. Note that not all verbs are supported on all objects. For example, not all document types support the &quot;print&quot; verb.</p>
<!-- raw HTML omitted -->
<p><em>lpParameters</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPCTSTR</strong></p>
<p>If the <em>lpFile</em> parameter specifies an executable file, <em>lpParameters</em> is a pointer to a <strong>null</strong>-terminated string that specifies the parameters to be passed to the application. The format of this string is determined by the verb that is to be invoked. If <em>lpFile</em> specifies a document file, <em>lpParameters</em> should be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpDirectory</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPCTSTR</strong></p>
<p>A pointer to a <strong>null</strong>-terminated string that specifies the default directory.</p>
<!-- raw HTML omitted -->
<p><em>nShowCmd</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>INT</strong></p>
<p>The flags that specify how an application is to be displayed when it is opened. If <em>lpFile</em> specifies a document file, the flag is simply passed to the associated application. It is up to the application to decide how to handle it. It can be any of the values that can be specified in the <em>nCmdShow</em> parameter for the <a href="/windows/desktop/api/winuser/nf-winuser-showwindow">ShowWindow</a> function.</p>
<!-- raw HTML omitted -->
<p><em>lpfnCBWinExec</em></p>
<!-- raw HTML omitted -->
<p>Type: <strong>void*</strong></p>
<p>Callback function used to call <a href="/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa"><strong>CreateProcess</strong></a> in the 16-bit kernel.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>HINSTANCE</strong></p>
<p>Returns a value greater than 32 if successful, or an error value that is less than or equal to 32 otherwise. The following table lists the error values. The return value is cast as an HINSTANCE for backward compatibility with 16-bit Windows applications. It is not a true HINSTANCE, however. The only thing that can be done with the returned HINSTANCE is to cast it to an <strong>int</strong> and compare it with the value 32 or one of the error codes below.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>0</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The operating system is out of memory or resources.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>ERROR_FILE_NOT_FOUND</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The specified file was not found.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>ERROR_PATH_NOT_FOUND</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The specified path was not found.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>ERROR_BAD_FORMAT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The .exe file is invalid (non-Win32 .exe or error in .exe image).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SE_ERR_ACCESSDENIED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The operating system denied access to the specified file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SE_ERR_ASSOCINCOMPLETE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The file name association is incomplete or invalid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SE_ERR_DDEBUSY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The DDE transaction could not be completed because other DDE transactions were being processed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SE_ERR_DDEFAIL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The DDE transaction failed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SE_ERR_DDETIMEOUT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The DDE transaction could not be completed because the request timed out.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SE_ERR_DLLNOTFOUND</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The specified DLL was not found.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SE_ERR_FNF</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The specified file was not found.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SE_ERR_NOASSOC</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>There is no application associated with the given file name extension. This error will also be returned if you attempt to print a file that is not printable.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SE_ERR_OOM</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>There was not enough memory to complete the operation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SE_ERR_PNF</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The specified path was not found.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SE_ERR_SHARE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A sharing violation occurred.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p><strong>WOWShellExecute</strong> is not included in a header or .lib file. It is exported from Shell32.dll by name.</p>
<p>This method allows you to execute any commands in a folder's shortcut menu or stored in the registry.</p>
<p>If <em>lpOperation</em> is <strong>NULL</strong>, the function opens the file specified by <em>lpFile</em>. If <em>lpOperation</em> is &quot;open&quot; or &quot;explore&quot;, the function attempts to open or explore the folder.</p>
<p>To obtain information about the application that is launched as a result of calling <strong>WOWShellExecute</strong>, use <a href="/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa"><strong>ShellExecuteEx</strong></a>.</p>
<blockquote>
<p>[!Note]<br />
The <strong>Launch folder windows in a separate process</strong> setting in Folder Options affects <strong>WOWShellExecute</strong>. If that option is disabled (the default setting), <strong>WOWShellExecute</strong> uses an open Explorer window rather than launch a new one. If no Explorer window is open, <strong>WOWShellExecute</strong> launches a new one.</p>
</blockquote>
<p>Â </p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Shell32.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea"><strong>ShellExecute</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
