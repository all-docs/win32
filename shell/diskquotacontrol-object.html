<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DiskQuotaControl object</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Allows an administrator to manage a volume's disk quota properties.
title: DiskQuotaControl object
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>DiskQuotaControl
api_type:</li>
<li>COM
api_location:</li>
<li>Shell32.dll
ms.assetid: 846297f2-b826-45de-8617-228790e87a63</li>
</ul>
<hr />
<h1>DiskQuotaControl object</h1>
<p>Allows an administrator to manage a volume's disk quota properties. The NTFS file system allows an administrator to manage disk usage on a shared volume by allocating a specified amount of disk space, or <em>quota limit</em>, to each user. You can use this object to set the default quota limit that will be automatically assigned to all new users.</p>
<h2>Members</h2>
<p>The <strong>DiskQuotaControl</strong> object has these types of members:</p>
<ul>
<li><a href="#events">Events</a></li>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Events</h3>
<p>The <strong>DiskQuotaControl</strong> object has these events.</p>
<table>
<thead>
<tr>
<th align="left">Event</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="diskquotacontrol-onusernamechanged.html"><strong>OnUserNameChanged</strong></a></td>
<td align="left">Occurs when the name information for a <a href="didiskquotauser-object.html"><strong>DIDiskQuotaUser</strong></a> object has been resolved.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Methods</h3>
<p>The <strong>DiskQuotaControl</strong> object has these methods.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="diskquotacontrol-adduser.html"><strong>AddUser</strong></a></td>
<td align="left">Assigns a nondefault disk quota to a new user.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-deleteuser.html"><strong>DeleteUser</strong></a></td>
<td align="left">Deletes a user from the volume.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-finduser.html"><strong>FindUser</strong></a></td>
<td align="left">Finds a user's entry, by name, in the volume's quota file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-giveusernameresolutionpriority.html"><strong>GiveUserNameResolutionPriority</strong></a></td>
<td align="left">Places the specified user object next in line for name resolution.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-initialize.html"><strong>Initialize</strong></a></td>
<td align="left">Opens a specified volume and initializes its quota control object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-invalidatesidnamecache.html"><strong>InvalidateSidNameCache</strong></a></td>
<td align="left">Invalidates the security ID user name cache.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-shutdownnameresolution.html"><strong>ShutdownNameResolution</strong></a></td>
<td align="left">Shuts down the user name resolution thread.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-translatelogonnametosid.html"><strong>TranslateLogonNameToSID</strong></a></td>
<td align="left">Translates a logon name to the corresponding user security ID in string format.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h3>Properties</h3>
<p>The <strong>DiskQuotaControl</strong> object has these properties.</p>
<table>
<thead>
<tr>
<th align="left">Property</th>
<th align="left">Access type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="diskquotacontrol-defaultquotalimit.html"><strong>DefaultQuotaLimit</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Sets or gets the default quota limit.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-defaultquotalimittext.html"><strong>DefaultQuotaLimitText</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets the default quota limit as a text string.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-defaultquotathreshold.html"><strong>DefaultQuotaThreshold</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Sets or gets the default quota threshold.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-defaultquotathresholdtext.html"><strong>DefaultQuotaThresholdText</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets the default quota threshold as a text string.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-logquotalimit.html"><strong>LogQuotaLimit</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Sets or gets a Boolean value that indicates whether a system event log entry will be made when a user exceeds his or her assigned quota limit.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-logquotathreshold.html"><strong>LogQuotaThreshold</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Sets or gets a Boolean value that indicates whether a system event log entry will be made when a user exceeds his or her assigned quota threshold.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-quotafileincomplete.html"><strong>QuotaFileIncomplete</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets a Boolean value that indicates whether the quota file for the volume is complete.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-quotafilerebuilding.html"><strong>QuotaFileRebuilding</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read-only<!-- raw HTML omitted --></td>
<td align="left">Gets a Boolean value that indicates whether the quota file for the volume is currently being rebuilt.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-quotastate.html"><strong>QuotaState</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Sets or gets the state of the volume's disk quotas.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="diskquotacontrol-usernameresolution.html"><strong>UserNameResolution</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Sets or gets a value that controls how user SID are resolved to user names.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>An administrator can use the <strong>DiskQuotaControl</strong> object to do a number of tasks, including the following:</p>
<ul>
<li>Enabling and disabling the volume's disk quota system.</li>
<li>Obtaining the status of the quota system on the volume.</li>
<li>Denying disk space to users exceeding their quota limit.</li>
<li>Specifying the default warning threshold and quota limit values that will be assigned to new users.</li>
<li>Adding and removing users.</li>
</ul>
<p>The <strong>DiskQuotaControl</strong> object allows you to set global default values for the volume for properties such as quota limits. However, each user is represented by a <a href="didiskquotauser-object.html"><strong>DIDiskQuotaUser</strong></a> object that can be used to specify individual quota settings.</p>
<p>There are several ways to obtain a user's <a href="didiskquotauser-object.html"><strong>DIDiskQuotaUser</strong></a> object:</p>
<ul>
<li>The <a href="didiskquotauser-object.html"><strong>DIDiskQuotaUser</strong></a> objects for all users with quotas on the volume are exposed as a collection, and can be enumerated. For a discussion of how to enumerate <strong>DIDiskQuotaUser</strong> objects, see <strong>Enumerating Disk Quota Users</strong> in the Remarks section of <strong>DIDiskQuotaUser</strong>.</li>
<li>When you add a new user, the <a href="diskquotacontrol-adduser.html"><strong>AddUser</strong></a> method returns the user's <a href="didiskquotauser-object.html"><strong>DIDiskQuotaUser</strong></a> object.</li>
<li>If you have the user's name, the <a href="diskquotacontrol-finduser.html"><strong>FindUser</strong></a> method returns the user's <a href="didiskquotauser-object.html"><strong>DIDiskQuotaUser</strong></a> object.</li>
</ul>
<p>This object makes the essential functionality of the IDiskQuotaControl interface available to scripting and Microsoft Visual Basic-based applications.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Shell32.dll (version 5.0 or later)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="shell.html"><strong>Shell Object</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
