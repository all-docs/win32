<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>User Profiles Reference</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The following API elements are used with user profiles.
title: User Profiles Reference
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 86871866-bb90-4287-9640-0a6cd136a800
api_name:
api_type:
api_location:
topic_type:</p>
<ul>
<li>kbArticle</li>
</ul>
<hr />
<h1>User Profiles Reference</h1>
<p>The following API elements are used with user profiles.</p>
<h2>Functions</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Userenv/nf-userenv-createenvironmentblock"><strong>CreateEnvironmentBlock</strong></a></td>
<td>Retrieves the environment variables for the specified user.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Userenv/nf-userenv-createprofile"><strong>CreateProfile</strong></a></td>
<td>Creates a new user profile. (WindowsÂ Vista and later only.)</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Userenv/nf-userenv-deleteprofilea"><strong>DeleteProfile</strong></a></td>
<td>Deletes the user profile and all user-related settings from the specified computer.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Userenv/nf-userenv-destroyenvironmentblock"><strong>DestroyEnvironmentBlock</strong></a></td>
<td>Frees environment variables created by the <a href="/windows/desktop/api/Userenv/nf-userenv-createenvironmentblock"><strong>CreateEnvironmentBlock</strong></a> function.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Userenv/nf-userenv-expandenvironmentstringsforusera"><strong>ExpandEnvironmentStringsForUser</strong></a></td>
<td>Expands the source string by using the environment block established for the specified user.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Userenv/nf-userenv-getallusersprofiledirectorya"><strong>GetAllUsersProfileDirectory</strong></a></td>
<td>Retrieves the path to the root of the All Users profile.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Userenv/nf-userenv-getdefaultuserprofiledirectorya"><strong>GetDefaultUserProfileDirectory</strong></a></td>
<td>Retrieves the path to the root of the Default User profile.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Userenv/nf-userenv-getprofilesdirectorya"><strong>GetProfilesDirectory</strong></a></td>
<td>Retrieves the path to the root directory where all user profiles are stored.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Userenv/nf-userenv-getprofiletype"><strong>GetProfileType</strong></a></td>
<td>Retrieves the type of profile loaded for the current user.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Userenv/nf-userenv-getuserprofiledirectorya"><strong>GetUserProfileDirectory</strong></a></td>
<td>Retrieves the path to the root directory of the specified user's profile.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Userenv/nf-userenv-loaduserprofilea"><strong>LoadUserProfile</strong></a></td>
<td>Loads the specified user's profile.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Userenv/nf-userenv-unloaduserprofile"><strong>UnloadUserProfile</strong></a></td>
<td>Unloads a user's profile that was loaded by the <a href="/windows/desktop/api/Userenv/nf-userenv-loaduserprofilea"><strong>LoadUserProfile</strong></a> function.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>The <a href="createuserprofileex.html"><strong>CreateUserProfileEx</strong></a> function is not supported.</p>
<h2>Structures</h2>
<table>
<thead>
<tr>
<th>Structure</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Profinfo/ns-profinfo-profileinfoa"><strong>PROFILEINFO</strong></a></td>
<td>Contains information about a user profile.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
