<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ShellUIHelper.AddChannel method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Adds a new channel to the list of channels in the Windows Internet Explorer Favorites menu and to the Channel bar on the desktop.
title: ShellUIHelper.AddChannel method (Exdisp.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>ShellUIHelper.AddChannel
api_type:</li>
<li>COM
api_location:</li>
<li>Shell32.dll
ms.assetid: b62e6e82-429a-4d41-96d4-cba639b611f5</li>
</ul>
<hr />
<h1>ShellUIHelper.AddChannel method</h1>
<p>Adds a new channel to the list of channels in the Windows Internet Explorer <strong>Favorites</strong> menu and to the <strong>Channel</strong> bar on the desktop.</p>
<blockquote>
<p>[!Note]<br />
This method is no longer supported under WindowsÂ Vista. Under that operating system, it returns E_NOTIMPL.</p>
</blockquote>
<p>Â </p>
<h2>Syntax</h2>
<pre lang="JScript"><code>iRetVal = ShellUIHelper.AddChannel(
  sURL
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>sURL</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="/previous-versions/windows/desktop/automat/bstr"><strong>BSTR</strong></a></strong></p>
<p>A <strong>String</strong> value that specifies the URL of the CDF file.</p>
<blockquote>
<p>[!Note]<br />
The links in the CDF file must use HTTP, HTTPS, or FTP protocols. If the CDF file contains any other protocol, the addition of the channel fails and no dialog box appears.</p>
</blockquote>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Examples</h2>
<p>The following example shows the proper usage of this method for JScript embedded in HTML and Visual Basic.</p>
<p>JScript:</p>
<pre lang="JScript"><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;&lt;/title&gt;

&lt;object id=&quot;ShellUIHelper&quot;
        classid=&quot;CLSID:64AB4BB7-111E-11d1-8F79-00C04FC2FBE1&quot;
        width=0
        height=0
        VIEWASTEXT&gt;
&lt;/object&gt;

&lt;script language=&quot;JavaScript&quot;&gt;
    function fnShellUIHelperAddChannelJ()
    {
        ShellUIHelper.AddChannel(&quot;https://www.microsoft.com/windows/cdf/g_stock.cdf&quot;);
    }
&lt;/script&gt;

&lt;/head&gt;
&lt;body onload=fnShellUIHelperAddChannelJ()&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Visual Basic:</p>
<pre lang="VB"><code>Private Sub fnShellUIHelperAddChannelVB()
    Dim objShellUIHelper As ShellUIHelper
    
    Set objShellUIHelper = New ShellUIHelper
        objShellUIHelper.AddChannel (&quot;https://www.microsoft.com/windows/cdf/g_stock.cdf&quot;)
    Set objShellUIHelper = Nothing
End Sub
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Professional, WindowsÂ XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Exdisp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Shell32.dll (version 4.71 or later)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
