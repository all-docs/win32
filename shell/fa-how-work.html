<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How File Associations Work</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: File associations define how the Shell treats a file type on the system.
ms.assetid: A1C05857-26F8-4d4a-977B-4782E8AFA317
title: How File Associations Work
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How File Associations Work</h1>
<p>File associations define how the Shell treats a <a href="fa-file-types.html">file type</a> on the system.</p>
<p>This topic is organized as follows:</p>
<ul>
<li><a href="#about-file-associations">About File Associations</a></li>
<li><a href="#when-you-should-implement-or-modify-file-associations">When You Should Implement or Modify File Associations</a></li>
<li><a href="#how-file-associations-work">How File Associations Work</a></li>
<li><a href="#additional-resources">Additional Resources</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>About File Associations</h2>
<p>File associations control the following functionality:</p>
<ul>
<li>Which application launches when a user double-clicks a file.</li>
<li>Which icon appears for a file by default.</li>
<li>How the file type appears when viewed in Windows Explorer.</li>
<li>Which commands appear in a file's shortcut menu.</li>
<li>Other UI features, such as tooltips, tile info, and the details pane.</li>
</ul>
<p>Application developers can use file associations to control how the Shell treats custom file types, or to associate an application with existing file types. For example, when an application is installed, the application can check for the presence of existing file associations, and either create or override those file associations.</p>
<p>Users can control some aspects of file associations to customize how the Shell treats a file type either by using the <strong>Open With</strong> UI, or editing the registry.</p>
<p>In the Windows Explorer window shown in the screen shot below, the Shell displays different icons for each file, based on the icon associated with the file type. If the user double-clicks the file <strong>Sample Bitmap Image</strong>, the Shell launches Paint and uses it to open the file because on this system, Paint is associated with .bmp files. People can control these actions using file associations.</p>
<p><img src="images/file-assoc/fileassoc-icons.png" alt="illustration of how file associations work in practice" /></p>
<h2>When You Should Implement or Modify File Associations</h2>
<p>Applications can use files for various purposes: some files are used exclusively by the application, and are not typically accessed by users, while other files are created by the user and are often opened, searched for, and viewed from the Shell.</p>
<p>Unless your custom file type is used exclusively by the application, you should implement file associations for it. As a general rule, implement file associations for your custom file type if you expect the user to interact directly with these files in any way. That includes using the Shell to browse and open the files, searching the content or properties of the files, and previewing the files.</p>
<p>If your application is handling an existing file type, do not modify the file association unless you want to modify the way the Shell handles all files of this type.</p>
<h2>How File Associations Work</h2>
<p>Files are exposed in the Shell as Shell items. To control file associations, application developers can register a mapping between the file type and the handlers (COM objects that provide functionality for the file type's Shell items). When the Shell needs to query for the file associations of a file type, it creates an array of registry keys containing the associations for the file type, and checks these keys for the appropriate file associations to use.</p>
<h2>Additional Resources</h2>
<ul>
<li>For conceptual background on file associations, see <a href="fa-verbs.html">Overview of Verbs and File Associations</a>.</li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="app-registration.html">Application Registration</a></p>
<!-- raw HTML omitted -->
<p><a href="fa-file-types.html">File Types</a></p>
<!-- raw HTML omitted -->
<p><a href="prophand-content-view.html">Content View By File Type or Kind</a></p>
<!-- raw HTML omitted -->
<p><a href="file-type-verifier.html">File Type Verifier</a></p>
<!-- raw HTML omitted -->
<p><a href="fa-file-extensions.html">File Type Handlers</a></p>
<!-- raw HTML omitted -->
<p><a href="fa-progids.html">Programmatic Identifiers</a></p>
<!-- raw HTML omitted -->
<p><a href="fa-perceivedtypes.html">Perceived Types</a></p>
<!-- raw HTML omitted -->
<p><a href="fa-associationarray.html">Association Arrays</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
