<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CompareStringWrapW function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Compares two Unicode character strings, using a specified locale.
ms.assetid: dff16c1b-d329-40de-b8d7-91edb36ce198
title: CompareStringWrapW function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>CompareStringWrapW
api_type:</li>
<li>DllExport
api_location:</li>
<li>Shlwapi.dll</li>
</ul>
<hr />
<h1>CompareStringWrapW function</h1>
<p>[<strong>CompareStringWrapW</strong> is available for use in WindowsÂ XP. It will not be available in subsequent versions. You should use <a href="/windows/win32/api/stringapiset/nf-stringapiset-comparestringw"><strong>CompareStringW</strong></a> in its place.]</p>
<p>Compares two Unicode character strings, using a specified locale.</p>
<blockquote>
<p>[!Note]<br />
<strong>CompareStringWrapW</strong> is a wrapper for the <strong>CompareStringW</strong> function. See the <a href="/windows/win32/api/stringapiset/nf-stringapiset-comparestringw"><strong>CompareString</strong></a> page for further usage notes.</p>
</blockquote>
<p>Â </p>
<h2>Syntax</h2>
<pre lang="C++"><code>int CompareStringWrapW(
  _In_Â LCID Â Â Â Locale,
  _In_Â DWORD Â Â dwCmpFlags,
  _In_Â LPCWSTR lpString1,
  _In_Â int Â Â Â Â cchCount1,
  _In_Â LPCWSTR lpString2,
  _In_Â int Â Â Â Â cchCount2
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Locale</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LCID</strong></p>
<p>A locale identifier used for the comparison. This parameter can be one of the following predefined locale identifiers or a locale identifier created by the <a href="/windows/win32/api/winnt/nf-winnt-makelcid"><strong>MAKELCID</strong></a> macro.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>LOCALE_SYSTEM_DEFAULT</strong></p>
<!-- raw HTML omitted -->
<p>The system's default locale.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>LOCALE_USER_DEFAULT</strong></p>
<!-- raw HTML omitted -->
<p>The current user's default locale.</p>
<!-- raw HTML omitted -->
<p><em>dwCmpFlags</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<p>The flags that indicate how the function compares the two strings. By default, these flags are not set. Set to zero to get the default behavior or to any combination of the following values.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NORM_IGNORECASE</strong></p>
<!-- raw HTML omitted -->
<p>Ignore case.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NORM_IGNOREKANATYPE</strong></p>
<!-- raw HTML omitted -->
<p>Do not differentiate between Hiragana and Katakana characters. Corresponding Hiragana and Katakana characters compare as equal.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NORM_IGNORENONSPACE</strong></p>
<!-- raw HTML omitted -->
<p>Ignore nonspacing characters.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NORM_IGNORESYMBOLS</strong></p>
<!-- raw HTML omitted -->
<p>Ignore symbols.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>NORM_IGNOREWIDTH</strong></p>
<!-- raw HTML omitted -->
<p>Do not differentiate between a single-byte character and the same character as a double-byte character.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>SORT_STRINGSORT</strong></p>
<!-- raw HTML omitted -->
<p>Treat punctuation the same as symbols.</p>
<!-- raw HTML omitted -->
<p><em>lpString1</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPCWSTR</strong></p>
<p>A pointer to the first Unicode string to be compared.</p>
<!-- raw HTML omitted -->
<p><em>cchCount1</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>int</strong></p>
<p>The number of characters in the string pointed to by the <em>lpString1</em> parameter. The count does not include the terminating null character. If this parameter is a negative value, the string is assumed to be null-terminated and the length is calculated automatically.</p>
<!-- raw HTML omitted -->
<p><em>lpString2</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LPCWSTR</strong></p>
<p>A pointer to the second Unicode string to be compared.</p>
<!-- raw HTML omitted -->
<p><em>cchCount2</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>int</strong></p>
<p>The number of characters in the string pointed to by the <em>lpString2</em> parameter. The count does not include the terminating null character. If this parameter is a negative value, the string is assumed to be null-terminated and the length is calculated automatically.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>int</strong></p>
<p>If the function fails, the return value is zero. To get extended error information, call <a href="/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a>. <strong>GetLastError</strong> may return one of the following error codes.</p>
<ul>
<li>ERROR_INVALID_FLAGS</li>
<li>ERROR_INVALID_PARAMETER</li>
</ul>
<p>If the function succeeds, the return value is one of the following values.</p>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>CSTR_LESS_THAN</td>
<td>The string pointed to by the <em>lpString1</em> parameter is less in lexical value than the string pointed to by the <em>lpString2</em> parameter.</td>
</tr>
<tr>
<td>CSTR_EQUAL</td>
<td>The string pointed to by <em>lpString1</em> is equal in lexical value to the string pointed to by <em>lpString2</em>.</td>
</tr>
<tr>
<td>CSTR_GREATER_THAN</td>
<td>The string pointed to by <em>lpString1</em> is greater in lexical value than the string pointed to by <em>lpString2</em></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p><strong>Security Warning:</strong> Using this function incorrectly can compromise the security of your application. Strings that are not compared correctly can produce invalid input. Test strings to make sure they are valid before using them and provide error handlers. For more information, see <a href="../intl/security-considerations--international-features.html">Security Considerations: International Features</a></p>
<p>The preferred method is to use <a href="/windows/win32/api/stringapiset/nf-stringapiset-comparestringw"><strong>CompareStringW</strong></a> in conjunction with the Microsoft Layer for Unicode (MSLU).</p>
<p><strong>CompareStringWrapW</strong> must be called directly from Shlwapi.dll, using ordinal 45.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Professional, WindowsÂ XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->None<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Shlwapi.dll (version 5.0 or later)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/stringapiset/nf-stringapiset-comparestringw"><strong>CompareString</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
