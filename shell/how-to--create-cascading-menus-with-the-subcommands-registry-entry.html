<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Create Cascading Menus with the SubCommands Registry Entry</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: In WindowsÂ 7 and later, you can use the SubCommands entry in the registry to create cascading menus by using the procedure given in this topic.
title: Create Cascading Menus with the SubCommands Registry Entry
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Create Cascading Menus with the SubCommands Registry Entry</h1>
<p>In WindowsÂ 7 and later, you can use the SubCommands entry in the registry to create cascading menus by using the procedure given in this topic.</p>
<h2>Instructions</h2>
<h3>Step 1:</h3>
<p>Create a new subkey under <strong>HKEY_CLASSES_ROOT</strong>\<em>ProgID</em>\<strong>shell</strong>, where <em>ProgID</em> is the file type for which you want to add a cascading menu. You can name this new subkey anything you'd like. For the remainder of this topic, we'll call it <em>CascadeMenu</em>, as shown in the following example.</p>
<pre><code>HKEY_CLASSES_ROOT
Â Â Â ProgID
Â Â Â Â Â Â shell
Â Â Â Â Â Â Â Â Â CascadeMenu
</code></pre>
<h3>Step 2:</h3>
<p>Add an entry named &quot;MUIVerb&quot;, of type <strong>REG_SZ</strong> or <strong>REG_EXPAND_SZ</strong>, to the <em>CascadeMenu</em> subkey. Assign this entry a string value such as &quot;Test Cascade Menu&quot;. Normally, this string is provided as a resource reference in the form &quot;@file, resource&quot;. The (Default) value for the <em>CascadeMenu</em> subkey should not be set.</p>
<pre><code>HKEY_CLASSES_ROOT
Â Â Â ProgID
Â Â Â Â Â Â shell
Â Â Â Â Â Â Â Â Â CascadeMenu
Â Â Â Â Â Â Â Â Â Â Â Â (Default)
Â Â Â Â Â Â Â Â Â Â Â Â MUIVerb = Test Cascade Menu
</code></pre>
<h3>Step 3:</h3>
<p>Add an entry named &quot;SubCommands&quot;, of type <strong>REG_SZ</strong> or <strong>REG_EXPAND_SZ</strong>, to the <em>CascadeMenu</em> subkey. Assign this entry a semicolon-delimited list of the verbs that should appear on the menu, in their desired order of appearance.</p>
<pre><code>HKEY_CLASSES_ROOT
Â Â Â ProgID
Â Â Â Â Â Â Shell
Â Â Â Â Â Â Â Â Â CascadeMenu
Â Â Â Â Â Â Â Â Â Â Â Â SubCommands = Windows.delete;Windows.properties;Windows.rename;Windows.cut;Windows.copy;Windows.paste
</code></pre>
<h3>Step 4:</h3>
<p>Populate the <strong>CommandStore</strong> subkey with verb implementations for any custom static verb implementation methods that you've used in your SubCommands entry; for example:</p>
<pre><code>HKEY_LOCAL_MACHINE
Â Â Â Software
Â Â Â Â Â Â Microsoft
Â Â Â Â Â Â Â Â Â Windows
Â Â Â Â Â Â Â Â Â Â Â Â CurrentVersion
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Explorer
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CommandStore
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Shell
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â VerbName
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â command
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (Default) = notepad.exe %1
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="creating-static-cascading-menus.html">Creating Static Cascading Menus</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
