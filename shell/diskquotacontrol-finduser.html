<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DiskQuotaControl.FindUser method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Finds a user's entry, by name, in the volume's quota file.
title: DiskQuotaControl.FindUser method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>DiskQuotaControl.FindUser
api_type:</li>
<li>COM
api_location:</li>
<li>Shell32.dll
ms.assetid: e5767d28-4c0a-49bc-a1d3-ba809411456d</li>
</ul>
<hr />
<h1>DiskQuotaControl.FindUser method</h1>
<p>Finds a user's entry, by name, in the volume's quota file.</p>
<h2>Syntax</h2>
<pre lang="JScript"><code>DiskQuotaControl.FindUser(
  sLogonName
)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>sLogonName</em></p>
<!-- raw HTML omitted -->
<p>Type: <strong>String</strong></p>
<p>A string value that contains the user's logon name.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns an object expression that evaluates to the user's <a href="didiskquotauser-object.html"><strong>DIDiskQuotaUser</strong></a> object.</p>
<h2>Remarks</h2>
<p>This method returns a <a href="didiskquotauser-object.html"><strong>DIDiskQuotaUser</strong></a> object even if there is no entry for the user in the quota file. The returned user object has warning threshold and hard quota limits set to the volume's default values.</p>
<p>The string returned from <a href="diskquotacontrol-translatelogonnametosid.html"><strong>TranslateLogonNameToSID</strong></a> may be passed in place of the <em>sLogonName</em> parameter. When <strong>FindUser</strong> receives a SID string it uses the corresponding SID for direct lookup of the user's quota record on the volume. This bypasses the SID-name cache. In cases where <strong>FindUser</strong> fails due to a mismatch in format (for example, SAM-compatible and UPN) of the logon name provided and the logon name cached, the logon name can be translated to a SID string using <strong>TranslateLogonNameToSID</strong> then passed again to <strong>FindUser</strong>. The following VBScript code illustrates this technique.</p>
<pre><code>Function Find(dqc, name)
    On Error Resume Next
    SET Find = dqc.FindUser(name)

    If Err.Number &lt;&gt; 0 Then
        Err.Clear
        SET Find = dqc.FindUser(dqc.TranslateLogonNameToSID(name))
    End If    

End Function
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Shell32.dll (version 5.0 or later)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="diskquotacontrol-object.html"><strong>DiskQuotaControl Object</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
