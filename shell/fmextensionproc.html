<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>FMExtensionProc callback function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Specifies an application-defined callback function called by File Manager to communicate with a File Manager extension.
title: FMExtensionProc callback function (Wfext.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>FMExtensionProc</li>
<li>FMExtensionProcW
api_type:</li>
<li>UserDefined
api_location:</li>
<li>Wfext.h
ms.assetid: 6e02d655-f7d8-460a-97d2-5b369493e941</li>
</ul>
<hr />
<h1>FMExtensionProc callback function</h1>
<p>Specifies an application-defined callback function called by File Manager to communicate with a File Manager extension.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>LONG CALLBACK FMExtensionProc(
  Â HWND hwnd,
  Â WORD wMsg,
  Â LONG lParam
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hwnd</em></p>
<!-- raw HTML omitted -->
<p>Type: <strong>HWND</strong></p>
<p>A window handle to File Manager. An extension uses this handle to specify the parent window for any dialog box or message box it must display, and to send query messages to File Manager.</p>
<!-- raw HTML omitted -->
<p><em>wMsg</em></p>
<!-- raw HTML omitted -->
<p>Type: <strong>WORD</strong></p>
<p>One of the following File Manager messages.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>1 through 99</strong></p>
<!-- raw HTML omitted -->
<p>User selected an item from the extension-supplied menu. The value is the identifier of the selected menu item.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FMEVENT_HELPMENUITEM</strong></p>
<!-- raw HTML omitted -->
<p>User pressed F1 while selecting an extension menu or toolbar command item. Indicates that the extension should call <strong>WinHelp</strong> appropriately for the command item.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FMEVENT_HELPSTRING</strong></p>
<!-- raw HTML omitted -->
<p>User selected an extension menu or toolbar command item. Indicates that the extension should supply a Help string.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FMEVENT_INITMENU</strong></p>
<!-- raw HTML omitted -->
<p>User selected the extension's menu. The extension should initialize items in the menu.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FMEVENT_LOAD</strong></p>
<!-- raw HTML omitted -->
<p>File Manager is loading the extension DLL and prompts the DLL for information about the menu that the DLL supplies.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FMEVENT_SELCHANGE</strong></p>
<!-- raw HTML omitted -->
<p>Selection in the <strong>File Manager</strong> directory window or <strong>Search Results</strong> window has changed.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FMEVENT_TOOLBARLOAD</strong></p>
<!-- raw HTML omitted -->
<p>File Manager is creating the toolbar and prompts the extension DLL for information about any buttons the DLL adds to the toolbar.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FMEVENT_UNLOAD</strong></p>
<!-- raw HTML omitted -->
<p>File Manager is unloading the extension DLL.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>FMEVENT_USER_REFRESH</strong></p>
<!-- raw HTML omitted -->
<p>User selected the <strong>Refresh</strong> command from the <strong>Window</strong> menu. The extension should update items in the menu, if necessary.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>Type: <strong>LONG</strong></p>
<p>Message-specific value.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>LONG</strong></p>
<p>Returns a value dependent upon the <em>wMsg</em> parameter message.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>WindowsÂ 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wfext.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Unicode and ANSI names<!-- raw HTML omitted --></td>
<td><strong>FMExtensionProcW</strong> (Unicode)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
