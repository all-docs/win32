<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Microsoft Message Queuing (MSMQ) - Improved Queue Handling</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Microsoft Message Queuing (MSMQ) - Improved Queue Handling
ms.assetid: 49bdfdfa-c77e-4a57-8079-bf4ff6b5010b
title: Microsoft Message Queuing (MSMQ) - Improved Queue Handling
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Microsoft Message Queuing (MSMQ) - Improved Queue Handling</h1>
<h2>Platforms</h2>
<p><strong>Clients</strong> - Windows 7<br />
<strong>Servers</strong> - Windows Server 2008 R2</p>
<h2>Feature Impact</h2>
<p><strong>Severity</strong> - Low<br />
<strong>Frequency</strong> - Low</p>
<h2>Description</h2>
<p>MSMQ Service does not put a hard limit on the number of queues that can be created on a system. However, the performance of the system is impacted when a large number of queues is created. Specifically, when there are more than a few thousand queues, the start-up time of the MSMQ Service increases exponentially resulting in a visible impact.</p>
<p>Microsoft has optimized the MSMQ Service start-up in Windows 7 to reduce the lookup overhead for loading the queues into memory. This optimization has led to a dramatic improvement of the start-up time of the MSMQ Service even when several thousand queues are created in the system.</p>
<h2>Manifestation of Impact</h2>
<p>This performance improvement does not impact the functionality of any existing application.</p>
<h2>Leveraging the Changed Feature</h2>
<p>Application developers using MSMQ on Windows 7 can now architect their solutions without limiting the number of queues. Note that the number of queues still affects overall performance of the MSMQ Server, but the performance impact is now on a linear rather than exponential scale.</p>
<h2>Compatibility, Performance, Reliability, and Usability Tests</h2>
<p>If you use a large number of queues, simulate the production environment on a test bed, monitor performance, and analyze the service start-up time and the message throughput with a large number of queues and messages present in the test system.</p>
<p>Â </p>
<p>Â </p>
</body>
