<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Removal of Windows Mail</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Removal of Windows Mail
ms.assetid: 356f0d79-12dd-49f0-b756-a46f20177efa
title: Removal of Windows Mail
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Removal of Windows Mail</h1>
<h2>Affected Platforms</h2>
<p><strong>Clients</strong> - Windows 7<br />
<strong>Servers</strong> - Windows Server 2008 R2</p>
<h2>Feature Impact</h2>
<p><strong>Severity</strong> - High<br />
<strong>Frequency</strong> - High</p>
<h2>Description</h2>
<p>Microsoft is deprecating the Windows Mail utility and disabling the API CoStartOutlookExpress. The other mail APIs have been marked as deprecated and are slated for removal in a later Windows version. However, the publicly documented APIs that are not marked as deprecated or obsolete will continue to function in Windows 7. Binaries will remain on the users' systems and will continue to be accessible via the APIs, specifically in the cases mentioned above. In addition, the users' email (.eml) and news (.nws) files will remain on the system.</p>
<h2>Manifestation of Impact</h2>
<p>Removal of Windows Mail results in the following:</p>
<ul>
<li>All entry points to Windows Mail and Contacts (for example, Start Menu, user-created Shortcuts, Start -&gt; Run, and so on) are removed or disabled. Some of these are completely removed, others will fail when trying to launch.</li>
<li>All DLLs ship in the box</li>
<li>Publicly documented APIs continue to work as they did in Windows Vista</li>
<li>Any APIs that attempt to launch the main browser UI have been modified to create a silent failure. The function will return success, but will not show the UI to the user. APIs that call other dialog boxes (for example, the Spooler or the Accounts dialog) continue to show that UI</li>
<li>Protocol (mailto, ldap, news, snews, nntp) handlers will not be associated with Windows Mail or Contacts. When attempting to launch these, customers will see an error dialog pointing them to the location where they can set these associations to another program</li>
<li>File associations (.eml, .nws, .contact, .group, .wab, .p7c, .vfc) are broken or disabled. When attempting to open a file with these extensions, customers will get a dialog box offering them other apps that are installed that they can use and point them to a webpage that offers solutions</li>
<li>Any user files (for example, contact files or messages) remain on the system in the upgrade scenario</li>
<li>The Contacts folder is hidden by default so customers will not see it</li>
<li>APIs are marked as deprecated in MSDN</li>
<li>The file preview function is removed</li>
<li>Shell hooks in the right-click menu are removed</li>
<li>The file search function is removed</li>
</ul>
<h2>Mitigation</h2>
<p>Users should install Windows Live Mail or any other mail product that is able to read .eml and .nws files.</p>
<h2>Solution</h2>
<p>Detect if there is a default mail handler installed. If not, advise user to install Windows Live Mail or any other product that is able to read .eml and .nws files.</p>
<p>Do not design code that calls the Windows Mail UI API, since it will not work. You must find other ways to access the .eml and .nws files. In addition, as soon as is feasible, discontinue your reliance on all other Windows Mail APIs.</p>
<h2>Compatibility, Performance, Reliability, and Usability Testing</h2>
<ul>
<li>Exercise your application in a Windows 7 environment to ensure that the application does not try to call the UI API.</li>
<li>Alternatively, you can run the Application Compatibility Toolkit (ACT) using the Windows Compatibility Evaluator (WCE) to locate any potential issues due to the deprecation of this functionality.</li>
</ul>
<h2>Links to Other Resources</h2>
<!-- raw HTML omitted -->
<p><a href="/windows-hardware/get-started/adk-install">Application Compatibility Toolkit Download</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
