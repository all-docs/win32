<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Remote Desktop Services (Windows 7 and Windows Server 2008 R2 Application Quality Cookbook)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Remote Desktop Services (Windows 7 and Windows Server 2008 R2 Application Quality Cookbook)
ms.assetid: 94ac6a91-1e00-45f3-9374-3ac48ac63765
title: Remote Desktop Services (Windows 7 and Windows Server 2008 R2 Application Quality Cookbook)
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Remote Desktop Services (Windows 7 and Windows Server 2008 R2 Application Quality Cookbook)</h1>
<h2>Affected Platforms</h2>
<p><strong>Servers</strong> â€“ Windows Server 2008 | Windows Server 2008 R2</p>
<h2>Description</h2>
<p>Remote Desktop Services (formerly known as Terminal Services) allows multiple concurrent users to access Windows Server in order to provide application and data hosting services using Microsoft &quot;Presentation Virtualization&quot; technology.</p>
<p>While most 32-bit and 64-bit applications run as is on Windows Remote Desktop Services, several others do not perform as expected due to the difference in the platform (multi-user environment, concurrent access by multiple users, and so on).</p>
<p>For further information regarding application quality, please read the <em>Application Readiness for Terminal Services</em> white paper. Visit the Remote Desktop Services product page and the TS TechNet websites learn more about Remote Desktop Services. To learn more about developing applications for Remote Desktop Services, review the <em>Terminal Services Programming Guidelines</em>. (These resources may not be available in some languages and countries/regions.)</p>
<h2>Manifestation of Impacts and Their Mitigations</h2>
<p>Three changes in Windows 7 affect applications on Remote Desktop Services:</p>
<ul>
<li>Windows Server 2008 R2 is 64-bit only</li>
<li>Per-session IP Virtualization</li>
<li>MSI-based deployments â€“ User-specific keys</li>
</ul>
<p><strong>64-bit Only Windows Server 2008 R2</strong></p>
<p>Applications written for 32-bit server will run in WoW mode and not natively on the Windows Server 2008 R2 or, hence, on Remote Desktop Services. See the Windows 7 64-Bit Only topic for details.</p>
<p><em>Mitigations for 64-bit only Windows Server 2008 R2</em></p>
<p>Most applications written for 32-bit will continue to work as normal in WoW mode. Any new applications written for Windows 7 Remote Desktop Services should be developed and tested for deployment on 64-bit platforms.</p>
<p><strong>IP Virtualization</strong></p>
<p>Remote Desktop IP Virtualization allows the user to assign IP addresses to remote desktop connections on a per-session or per-program basis:</p>
<ul>
<li>If you assign IP addresses on a per-session basis, all of the applications will use the session IP address.</li>
<li>If you assign IP addresses on a per-program basis, only the specified applications will use the session IP address and the remaining applications in the session will not be affected.</li>
<li>If you assign IP addresses for multiple programs, they will share a session IP address.</li>
<li>If you have more than one network adapter on the computer, you must also choose one of them for Remote Desktop IP Virtualization.</li>
</ul>
<p><em>Mitigations for IP Virtualization</em></p>
<p>Some programs require a unique IP address for each instance of the application. Prior to Windows Server 2008 R2, every session on a remote desktop server shared the same IP address, resulting in compatibility issues for these applications. Remote Desktop IP Virtualization allows these applications to run on a Remote Desktop Server.</p>
<p><strong>MSI-based Deployments</strong></p>
<p>Microsoft Installer RDS Compatibility is a new feature included with Remote Desktop Services in Windows Server 2008 R2. With Remote Desktop Services in Windows Server 2008 R2, per-user application installations are queued by the Remote Desktop Server and then handled by the Microsoft Installer.</p>
<p>In Windows Server 2008 R2, you can install a program on the Remote Desktop Server just as you would install the program on a local desktop. Ensure, however, that you install the program for all users and install all components of the program locally on the Remote Desktop Server.</p>
<p><em>Mitigations for MSI based Deployments</em></p>
<p>Prior to the Windows Server 2008 R2 version of Remote Desktop Services, Windows supported only one Windows Installer installation at a time. For applications that required per-user configurations, such as Microsoft Office Word, an administrator needed to pre-install the application, and application developers needed to test these applications on both the remote desktop client and the Remote Desktop Session Host. Windows Installer RDS Compatibility feature allows identifying and installing missing per-user configurations for multiple users simultaneously and makes the application installation experience on Remote Desktop Server similar to that on a local desktop.</p>
<p><strong>Windows ServerÂ 2008Â R2 with the <a href="../termserv/terminal-services-portal.html">Remote Desktop Services</a> role enabled:</strong> Not supported. A multiple package installation using the <a href="../msi/msiembeddedchainer-table.html">MsiEmbeddedChainer table</a> fails if the <a href="../termserv/terminal-services-portal.html">Remote Desktop Services</a> role is enabled.</p>
<h2>Links to Other Resources</h2>
<ul>
<li><a href="../termserv/terminal-services-programming-guidelines.html">Terminal Services Programming Guidelines</a></li>
<li><a href="https://www.microsoft.com/windowsserver2008/en/us/rds-product-home.aspx">Terminal Services product home page</a></li>
<li><a href="/collaborate/connect-redirect">Application Readiness for Terminal Services white paper</a></li>
</ul>
<blockquote>
<p>[!Note]<br />
These resources may not be available in some languages and countries/regions.</p>
</blockquote>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
