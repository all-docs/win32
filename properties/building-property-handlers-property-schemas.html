<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Creating Custom Properties</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Properties used in the property system of WindowsÂ Vista and later are declared in property schemas.
ms.assetid: 4e301210-df3a-41db-a58e-015ee8d41714
title: Creating Custom Properties
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Creating Custom Properties</h1>
<p>Properties used in the property system of WindowsÂ Vista and later are declared in property schemas. These property schemas are defined in XML files and describe various aspects of a property including its type (including information on its primitive type and whether it is multi-valued), how it can be displayed in the WindowsÂ UI, what kind of labels (user-friendly editing strings) are to be used with it, and how it is cached in the search store for faster access. Properties are identified by their Canonical Name or their Property Key (PKEY).</p>
<p>A canonical name is the reader-friendly name of the property and uses a namespace convention similar to that used in Microsoft .NET. For system-defined properties (those that are included with Windows), the convention is <code>System.GroupName.PropertyName</code>. Note that the Pascal casing scheme, which capitalizes letters at the beginning of each word, is used in these names. Canonical names are used in various places including property lists and column names in the property cache. They are therefore used in Structured Query Language (SQL) queries to retrieve a property value.</p>
<p>A PKEY is a pair of values consisting of a GUID and a <strong>DWORD</strong>, referred to as a <em>formatID</em> and <em>propID</em> respectively. It is represented by a <a href="/windows/win32/api/wtypes/ns-wtypes-propertykey"><strong>PROPERTYKEY</strong></a> structure. Most of the property system APIs accept these property keys. The Windows Software Development Kit (SDK) includes the header file Propkey.h that includes a macro definition of each of the <code>System</code> property keys with the convention of <code>PKEY_GroupName_PropertyName</code>. For example, <code>PKEY_Photo_DateTaken</code> is the property key for the property with canonical name <code>System.Photo.DateTaken</code>. Property values are stored in the form of a <a href="/windows/win32/api/propidlbase/ns-propidlbase-propvariant"><strong>PROPVARIANT</strong></a> structure, which is an extension of the OLE VARIANT types.</p>
<p>This section contains the following topic, which is integral to creating custom properties:</p>
<ul>
<li><a href="./propdesc-schema-entry.html">Understanding the Property Description Schema</a></li>
</ul>
<blockquote>
<p>[!Note]<br />
Due to potential difficulties that the indexer may have when consuming the property system's schema, it is critical that you define attributes carefully and strategically for the first release of the schema. Any changes to attributes (type, column width, whether indexable) will not be reflected in the database after a schema has been registered. The only ways to have these changes recognized after the schema has been registered once on a system would be either to rebuild the index and then register the new schema, or to register the schema and then create a new property for each subsequent release; for example <code>PKEY_GroupName_PropertyNameV2</code>, <code>PKEY_GroupName_PropertyNameV3</code>, and so forth). We do not recommend creating new properties in this manner, because multiple extraneous columns may impact system performance.</p>
</blockquote>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="./building-property-handlers.html">Implementing Property Handlers</a></p>
<!-- raw HTML omitted -->
<p><a href="./propdesc-schema-entry.html">Property Description Schema</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
