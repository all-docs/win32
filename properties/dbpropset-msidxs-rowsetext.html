<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DBPROPSET_MSIDXS_ROWSETEXT</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Extends properties defined for the Rowset APIs.
ms.assetid: C1A2DF19-C68D-42CC-9CB2-190F22CB4158
title: DBPROPSET_MSIDXS_ROWSETEXT
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>DBPROPSET_MSIDXS_ROWSETEXT</h1>
<p>Extends properties defined for the Rowset APIs.</p>
<pre lang="syntax"><code>#define DBPROPSET_MSIDXS_ROWSETEXT \
    { 0xaa6ee6b0, 0xe828, 0x11d0, \
        { 0xb2, 0x3e, 0x00, 0xaa, 0x00, 0x47, 0xfc, 0x01 } }
</code></pre>
<p>The DBPROPSET_MSIDXS_ROWSETEXT property set contains the following property constants:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_ROWSETQUERYSTATUS</p>
<!-- raw HTML omitted -->
<p>Property ID 2. Query status for the rowset. The STAT_* constants indicate the execution and reliability status.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_COMMAND_LOCALE_STRING</p>
<!-- raw HTML omitted -->
<p>Property ID 3. Locale string that represents the language and locale setting to use for this rowset.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_QUERY_RESTRICTION</p>
<!-- raw HTML omitted -->
<p>Property ID 4. The query string associated with this rowset.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_PARSE_TREE</p>
<!-- raw HTML omitted -->
<p>Property ID 5.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_MAX_RANK</p>
<!-- raw HTML omitted -->
<p>Property ID 6.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_RESULTS_FOUND</p>
<!-- raw HTML omitted -->
<p>Property ID 7.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_WHEREID</p>
<!-- raw HTML omitted -->
<p>Property ID 8.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_SERVER_VERSION</p>
<!-- raw HTML omitted -->
<p>New for WindowsÂ 7. Property ID 9. The server version.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_SERVER_WINVER_MAJOR</p>
<!-- raw HTML omitted -->
<p>Property ID 10.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_SERVER_WINVER_MINOR</p>
<!-- raw HTML omitted -->
<p>Property ID 11.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_SERVER_NLSVERSION</p>
<!-- raw HTML omitted -->
<p>Property ID 12.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_SERVER_NLSVER_DEFINED</p>
<!-- raw HTML omitted -->
<p>Property ID 13.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->MSIDXSPROP_SAME_SORTORDER_USED</p>
<!-- raw HTML omitted -->
<p>Property ID 14.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>To query MSIDXSPROP_SERVER_VERSION, it is necessary to issue the dummy query to server, such as the following example.</p>
<p><code>SELECT top 1 workid from servername.systemindex</code></p>
<p>After the rowset has been returned, call <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)"><strong>IUnknown::QueryInterface</strong></a> for the capabilities of the rowset and then call <a href="/previous-versions/windows/desktop/ms719611(v=vs.85)">IRowsetInfo::GetProperties</a> for the new property (MSIDXSPROP_SERVER_VERSION). The property has a type of <strong>VT_I4</strong> and can be one of the following values:</p>
<p>#define CI_VERSION_WDS30 0x102 // 258</p>
<p>#define CI_VERSION_WDS40 0x109 // 265</p>
<p>#define CI_VERSION_WIN70 0x700 // 1792</p>
<p>Once the value is known, the client can form a query which is supported by the server and issue a real query.</p>
<p>DBPROPSET_MSIDXS_ROWSETEXT is declared in ntquery.h.</p>
<p>Â </p>
<p>Â </p>
</body>
