<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TraceRay function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Sends a ray into a search for hits in an acceleration structure.
ms.assetid:
title: TraceRay function
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>TraceRay
api_type:</li>
<li>NA</li>
</ul>
<hr />
<h1>TraceRay function</h1>
<p>Sends a ray into a search for hits in an acceleration structure.</p>
<h2>Syntax</h2>
<p>This intrinsic function definition is equivalent to the following function template:</p>
<pre><code>Template&lt;payload_t&gt;
void TraceRay(RaytracingAccelerationStructure AccelerationStructure,
              uint RayFlags,
              uint InstanceInclusionMask,
              uint RayContributionToHitGroupIndex,
              uint MultiplierForGeometryContributionToHitGroupIndex,
              uint MissShaderIndex,
              RayDesc Ray,
              inout payload_t Payload);

</code></pre>
<h2>Parameters</h2>
<p><code>AccelerationStructure</code></p>
<p>The top-level acceleration structure to use. Specifying a NULL acceleration structure forces a miss.</p>
<p><code>RayFlags</code></p>
<p>Valid combination of <a href="ray_flag.html">ray_flag</a> values. Only defined ray flags are propagated by the system, i.e. are visible to the <a href="rayflags.html">RayFlags</a> shader intrinsic.</p>
<p><code>InstanceInclusionMask</code></p>
<p>An unsigned integer, the bottom 8 bits of which are used to include or reject geometry instances based on the InstanceMask in each instance. For example:</p>
<pre><code>if(!((InstanceInclusionMask &amp; InstanceMask) &amp; 0xff)) { //ignore intersection }
</code></pre>
<p><code>RayContributionToHitGroupIndex</code></p>
<p>An unsigned integer specifying the offset to add into addressing calculations within shader tables for hit group indexing.  Only the bottom 4 bits of this value are used.</p>
<p><code>MultiplierForGeometryContributionToHitGroupIndex</code></p>
<p>An unsigned integer specifying the stride to multiply by <em>GeometryContributionToHitGroupIndex</em>, which is just the 0 based index the geometry was supplied by the app into its bottom-level acceleration structure. Only the bottom 16 bits of this multiplier value are used.</p>
<p><code>MissShaderIndex</code></p>
<p>An unsigned integer specifying the index of the miss shader within a shader table.</p>
<p><code>Ray</code></p>
<p>A <a href="raydesc.html"><strong>RayDesc</strong></a> representing the ray to be traced.</p>
<p><code>Payload</code></p>
<p>A user defined ray payload accessed both for both input and output by shaders invoked during raytracing.  After <a href="traceray-function.html"><strong>TraceRay</strong></a> completes, the caller can access the payload as well.</p>
<h2>Return Value</h2>
<p><strong>void</strong></p>
<h2>Remarks</h2>
<p>This function can be called from the following raytracing shader types:</p>
<ul>
<li><a href="closest-hit-shader.html"><strong>Closest Hit Shader</strong></a></li>
<li><a href="miss-shader.html"><strong>Miss Shader</strong></a></li>
<li><a href="ray-generation-shader.html"><strong>Ray Generation Shader</strong></a></li>
</ul>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="direct3d-12-raytracing-hlsl-reference.html">Direct3D 12 Raytracing HLSL Reference</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
