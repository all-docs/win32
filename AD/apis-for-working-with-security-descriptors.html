<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>APIs for Working with Security Descriptors</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: APIs for Working with Security Descriptors
description: APIs for Working with Security Descriptors
ms.assetid: eb5ee183-949c-41f5-9f74-f9c418fdf0a2
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>security descriptors AD
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>APIs for Working with Security Descriptors</h1>
<p>Each object in Active Directory Domain Services has an <strong>nTSecurityDescriptor</strong> attribute that contains the object security descriptor. There are two primary ways to read and manipulate a directory object security descriptor:</p>
<ul>
<li>Use the <a href="/windows/desktop/api/iads/nf-iads-iads-get"><strong>IADs::Get</strong></a> method to retrieve the security descriptor as an ADSI COM object with an <a href="/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor"><strong>IADsSecurityDescriptor</strong></a> interface. The <strong>IADsSecurityDescriptor</strong>, <a href="/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist"><strong>IADsAccessControlList</strong></a>, and <a href="/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry"><strong>IADsAccessControlEntry</strong></a> interfaces can be used to handle the security descriptor and its components (ACLs, ACEs, and so on). For more information and a code example, see <a href="using-iads-to-get-a-security-descriptor.html">Using IADs to Get a Security Descriptor</a>.</li>
<li>Use the <a href="/windows/desktop/api/iads/nf-iads-idirectoryobject-getobjectattributes"><strong>IDirectoryObject::GetObjectAttributes</strong></a> method to retrieve an object security descriptor as a pointer to a <a href="/windows/desktop/api/winnt/ns-winnt-security_descriptor"><strong>SECURITY_DESCRIPTOR</strong></a> structure. Use this pointer with a Win32 access-control function, such as <a href="/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheck"><strong>AccessCheck</strong></a> or <a href="/windows/desktop/api/aclapi/nf-aclapi-buildsecuritydescriptora"><strong>BuildSecurityDescriptor</strong></a>. For more information and a code example, see <a href="using-idirectoryobject-to-get-a-security-descriptor.html">Using IDirectoryObject to Get a Security Descriptor</a>.</li>
</ul>
<p>The recommended technique, and the one used by most of the code examples in this guide, is to use the <strong>IADs*</strong> interfaces because they simplify handling security descriptors, ACLs, and ACEs. For Visual Basic programmers, the <strong>IADs*</strong> interfaces are the most efficient way to handle security descriptors.</p>
<p>The <a href="/windows/desktop/api/iads/nn-iads-idirectoryobject"><strong>IDirectoryObject</strong></a> technique is useful when a <a href="/windows/desktop/api/winnt/ns-winnt-security_descriptor"><strong>SECURITY_DESCRIPTOR</strong></a> structure is required. For example, the code example in <a href="checking-a-control-access-right-in-an-objectampaposs-acl.html">Checking a Control Access Right in an Object's ACL</a> uses this method to retrieve a security descriptor to pass to the <a href="/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist"><strong>AccessCheckByTypeResultList</strong></a> function.</p>
<p>For more information, see:</p>
<ul>
<li><a href="using-iads-to-get-a-security-descriptor.html">Using IADs to Get a Security Descriptor</a></li>
<li><a href="using-idirectoryobject-to-get-a-security-descriptor.html">Using IDirectoryObject to Get a Security Descriptor</a></li>
<li><a href="security-descriptor-components.html">Security Descriptor Components</a></li>
<li><a href="retrieving-an-objectampaposs-dacl.html">Retrieving an Object's DACL</a></li>
<li><a href="retrieving-an-objectampaposs-sacl.html">Retrieving an Object's SACL</a></li>
<li><a href="reading-an-objectampaposs-security-descriptor.html">Reading an Object's Security Descriptor</a></li>
<li><a href="example-code-for-creating-a-security-descriptor.html">Example Code for Creating a Security Descriptor</a></li>
<li><a href="example-code-for-enumerating-the-acl-of-an-active-directory-object.html">Example Code for Enumerating the ACL of an Object in Active Directory Domain Services</a></li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
