<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Context Menus for Use with Display Specifiers</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Context Menus for Use with Display Specifiers
description: The Active Directory administrative MMC snap-ins and WindowsÂ 2000 shell provide a mechanism to add an item to the context menu displayed for objects in Active Directory Domain Services.
ms.assetid: 0b0691f5-321d-4f22-b39c-bc528db9e707
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>display specifiers AD ,context menus for
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Context Menus for Use with Display Specifiers</h1>
<p>The Active Directory administrative MMC snap-ins and WindowsÂ 2000 shell provide a mechanism to add an item to the context menu displayed for objects in Active Directory Domain Services. A context menu item can be added by implementing an COM in-proc server known as a <em>context menu extension</em>. A context menu item can also be added that invokes any file started with the <a href="/windows/win32/api/shellapi/nf-shellapi-shellexecutea"><strong>ShellExecute</strong></a> API, such as an application or webpage URL. This is known as a <em>static context menu item</em>.</p>
<h2>Developer Audience</h2>
<p>This documentation assumes that the reader is familiar with COM operation and component development using C++. It is not currently possible to create an Active Directory Domain Services context menu extension using Microsoft Visual Basic.</p>
<h2>Extending the Context Menu With a Context Menu Extension</h2>
<p>A context menu extension is a COM in-proc server that implements certain interfaces and is registered with Active Directory Domain Services.</p>
<p><strong>To create and install a context menu extension</strong></p>
<ol>
<li>Create the context menu extension DLL. A context menu extension is a COM in-proc server that, at a minimum, implements the <a href="/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit"><strong>IShellExtInit</strong></a> and <a href="/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu"><strong>IContextMenu</strong></a> interfaces. For more information, see <a href="implementing-the-context-menu-com-object.html">Implementing the Context Menu COM Object</a>.</li>
<li>Install the context menu sheet extension on computers where the context menu extension is used. This is accomplished by creating a Microsoft Windows Installer package for the context menu extension DLL and deploying the package appropriately using the group policy. For more information, see <a href="distributing-user-interface-components.html">Distributing User Interface Components</a>.</li>
<li>Register the context menu extension in the Windows registry and with Active Directory Domain Services. For more information, see <a href="registering-the-context-menu-com-object-in-a-display-specifier.html">Registering the Context Menu COM Object in a Display Specifier</a>.</li>
</ol>
<h2>Extending the Context Menu With a Static Context Menu Item</h2>
<p>A static context menu item can be used to invoke any file started with the <a href="/windows/win32/api/shellapi/nf-shellapi-shellexecutea"><strong>ShellExecute</strong></a> API, such as an application or webpage URL. To accomplished this, the static context menu item for a particular object class must be registered so that the static context menu item is added to the context menu of objects of that class. For more information, see <a href="registering-a-static-context-menu-item.html">Registering a Static Context Menu Item</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
