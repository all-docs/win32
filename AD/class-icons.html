<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Class Icons</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Class Icons
description: The icon used to represent a class object can be specified in the iconPath attribute in the DisplaySpecifiers container.
ms.assetid: 0ff8da8a-d3d3-4a15-8103-4fe6ec307427
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>class display names AD ,icons
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Class Icons</h1>
<p>The icon used to represent a class object can be specified in the <strong>iconPath</strong> attribute in the DisplaySpecifiers container. Moreover, each class can store multiple icon states. For example, a folder class can have icons for the open, closed, and disabled states. The current implementation accepts a maximum of sixteen different icon states per class.</p>
<p>The <strong>iconPath</strong> attribute can be specified in one of two ways.</p>
<pre lang="C++"><code>&lt;state&gt;,&lt;icon file name&gt;
</code></pre>
<p>or</p>
<pre lang="C++"><code>&lt;state&gt;,&lt;module file name&gt;,&lt;resource ID&gt;
</code></pre>
<p>In these examples, the &quot;&lt;state&gt;&quot; is an integer with a value between 0 and 15. The value 0 is defined to be the default or closed state of the icon. The value 1 is defined to be the open state of the icon. The value 2 is the disabled state. All other values are application-defined.</p>
<p>The &quot;&lt;icon file name&gt;&quot; is the path and file name of an icon file that contains the icon image.</p>
<p>The &quot;&lt;module file name&gt;&quot; is the path and file name of a module, such as an EXE or DLL, that contains the icon image in a resource. The &quot;&lt;resource ID&gt;&quot; is an integer that specifies the resource identifier of the icon resource within the module.</p>
<h2>Adding a Value to the <strong>iconPath</strong> Attribute</h2>
<p>To add a value to the <strong>iconPath</strong> attribute, perform the following steps.</p>
<ol>
<li>Determine if the value for the attribute exists. If a value is to be replaced, first, delete the existing value using the <a href="/windows/desktop/api/iads/nf-iads-iads-putex"><strong>IADs::PutEx</strong></a> method with the <em>lnControlCode</em> parameter set to <strong>ADS_PROPERTY_DELETE</strong> and the <em>vProp</em> parameter set to the value to be removed. Do not use <strong>ADS_PROPERTY_CLEAR</strong> or <strong>ADS_PROPERTY_UPDATE</strong> for <em>lnControlCode</em>.</li>
<li>Create the string that represents the attribute icon data. For an example, see the format above.</li>
<li>To add the new value, use the <a href="/windows/desktop/api/iads/nf-iads-iads-putex"><strong>IADs::PutEx</strong></a> method with the <em>lnControlCode</em> parameter set to <strong>ADS_PROPERTY_APPEND</strong>.</li>
<li>To commit changes to the directory, call <a href="/windows/desktop/api/iads/nf-iads-iads-setinfo"><strong>IADs::SetInfo</strong></a>.</li>
</ol>
<p>Â </p>
<p>Â </p>
</body>
