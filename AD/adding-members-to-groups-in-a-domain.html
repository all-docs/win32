<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Adding Members to Groups in a Domain</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Adding Members to Groups in a Domain
description: This topic shows how to add members to groups in a domain.
ms.assetid: be65cd4e-df3e-416b-a673-774b71ab6996
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>Adding Members to Groups in a Domain AD</li>
<li>Groups AD , Adding Members to Groups in a Domain
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Adding Members to Groups in a Domain</h1>
<p>A group can contain any number of users, contacts, or other groups as members. The following list lists the attributes of the group object that control group membership.</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/ADSchema/a-member"><strong>member</strong></a><!-- raw HTML omitted --></td>
<td>The <a href="/windows/desktop/ADSchema/a-member"><strong>member</strong></a> attribute contains the distinguished names for the objects that are members of the group.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/ADSchema/a-memberof"><strong>memberOf</strong></a><!-- raw HTML omitted --></td>
<td>The <a href="/windows/desktop/ADSchema/a-memberof"><strong>memberOf</strong></a> attribute contains the distinguished names of groups that contain the group as a direct member. The <strong>memberOf</strong> attribute does not contain any inherited group membership data. For example, if GroupA is a member of GroupB and GroupB is a member of GroupC, the <strong>memberOf</strong> attribute for GroupA will contain GroupB, but not GroupC.<!-- raw HTML omitted --> The Active Directory server maintains this property. When a distinguished name is added to the <a href="/windows/desktop/ADSchema/a-member"><strong>member</strong></a> property of another group, that other group's distinguished name is added to this group's <a href="/windows/desktop/ADSchema/a-memberof"><strong>memberOf</strong></a> property.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Each of the following methods can be used to add a member to a group. You can add a member by using the distinguished name of the member or binding to the member object and then adding the member object to the group object.</p>
<p>To add a member that belongs to a downlevel domain to a group in an uplevel domain, use the bindable form of the SID string for the distinguished name. For more information and a code example that shows how to convert an <strong>objectSid</strong> into a bindable string, see the <strong>GetLDAPSidBindStringFromVariantSID</strong> example function in <a href="example-code-for-converting-an-objectsid-into-a-bindable-string-.html">Example Code for Converting an objectSid into a Bindable String</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Adding Members to a Group by Using IADsGroup</p>
<!-- raw HTML omitted -->
<p>The <a href="/windows/desktop/api/iads/nn-iads-iadsgroup"><strong>IADsGroup</strong></a> interface can be used to add members to a group by using the <a href="/windows/desktop/api/iads/nf-iads-iadsgroup-add"><strong>IADsGroup.Add</strong></a> method. Bind to and obtain the <strong>IADsGroup</strong> interface for the group object. Then the <strong>IADsGroup.Add</strong> method can be used to add members to the group.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Adding Members to a Group by Using IDirectoryObject</p>
<!-- raw HTML omitted -->
<p>The <a href="/windows/desktop/api/iads/nn-iads-idirectoryobject"><strong>IDirectoryObject</strong></a> interface can be used to add members to a group by using the <a href="/windows/desktop/api/iads/nf-iads-idirectoryobject-setobjectattributes"><strong>IDirectoryObject::SetObjectAttributes</strong></a> method to modify the <a href="/windows/desktop/ADSchema/a-member"><strong>member</strong></a> attribute for the group. Bind to and obtain the <strong>IDirectoryObject</strong> interface for the group object. Then use the <strong>IDirectoryObject::SetObjectAttributes</strong> method to modify the <strong>member</strong> attribute.</p>
<blockquote>
<p>[!Note]<br />
Because the <a href="/windows/desktop/ADSchema/a-member"><strong>member</strong></a> attribute has multiple values, ensure that you use the <strong>ADS_ATTR_APPEND</strong> control code to add a distinguished name to the <strong>member</strong> attribute. Using the <strong>ADS_ATTR_UPDATE</strong> control code will cause the existing <strong>member</strong> values to be overwritten.</p>
</blockquote>
<p>The <a href="/windows/desktop/api/iads/nn-iads-idirectoryobject"><strong>IDirectoryObject</strong></a> interface can also be used to add members to a group when the group is created by specifying the members in the <em>pAttributeEntries</em> parameter of the <a href="/windows/desktop/api/iads/nf-iads-idirectoryobject-createdsobject"><strong>IDirectoryObject::CreateDSObject</strong></a> method.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Adding Members to a Group by Using System.DirectoryServices</p>
<!-- raw HTML omitted -->
<p>You can use the <a href="/dotnet/api/system.directoryservices">System.DirectoryServices</a> namespace to add members to a group by using the <strong>PropertyValueCollection.Add</strong> method on the <strong>member</strong> property of the group object. For more information, see <a href="/previous-versions/ms180860(v=vs.90)">Setting Properties on Directory Objects</a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Adding Members to a Group by Using the LDAP API</p>
<!-- raw HTML omitted -->
<p>You can use the <a href="/previous-versions/windows/desktop/ldap/lightweight-directory-access-protocol-ldap-api">Lightweight Directory Access Protocol</a> API to add members to a group by using one of the <a href="/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_modify_s"><strong>ldap_modify*</strong></a> functions. For more information, see <a href="/previous-versions/windows/desktop/ldap/modifying-a-directory-entry">Modifying a Directory Entry</a>.</p>
<!-- raw HTML omitted -->
</body>
