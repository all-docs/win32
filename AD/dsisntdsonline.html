<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DsIsNTDSOnline function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: DsIsNTDSOnline function (Ntdsbcli.h)
description: Determines if Active Directory Domain Services are online on the specified server.
ms.assetid: 8f46e4d8-6d05-402c-a5b4-291fd2d6609b
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>DsIsNTDSOnline function Active Directory
topic_type:</li>
<li>apiref
api_name:</li>
<li>DsIsNTDSOnline</li>
<li>DsIsNTDSOnlineA</li>
<li>DsIsNTDSOnlineW
api_location:</li>
<li>Ntdsbcli.dll
api_type:</li>
<li>DllExport
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>DsIsNTDSOnline function</h1>
<p>[This function is available for use in the operating systems specified in the Requirements section. It may be altered or unavailable in subsequent versions. Beginning with Windows Vista, use <a href="../vss/volume-shadow-copy-service-overview.html">Volume Shadow Copy Service (VSS)</a> instead.]</p>
<p>The <strong>DsIsNTDSOnline</strong> function determines if Active Directory Domain Services are online on the specified server.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT DsIsNTDSOnline(
  _In_  LPCTSTR szServerName,
  _Out_ BOOL    *pfNTDSOnline
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>szServerName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Pointer to a null-terminated string that contains the name of the server to test. Preceding backslashes are optional. The server must be the same computer that this function is called from. The server name cannot contain any underscore (_) characters. An example of a server name is &quot;\\server1&quot;.</p>
<!-- raw HTML omitted -->
<p><em>pfNTDSOnline</em> [out]</p>
<!-- raw HTML omitted -->
<p>Pointer to <strong>BOOL</strong> value that receives the result. Receives <strong>TRUE</strong> if the directory service is online or <strong>FALSE</strong> if the directory service is offline.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns <strong>S_OK</strong> if the function is successful or an error code otherwise. The following list lists possible error codes.</p>
<!-- raw HTML omitted -->
<p><strong>ERROR_ACCESS_DENIED</strong></p>
<!-- raw HTML omitted -->
<p>The caller does not have the proper access privileges to call this function. The <a href="dssetauthidentity.html"><strong>DsSetAuthIdentity</strong></a> function can be used to set the credentials to use for the backup and restore functions.</p>
<!-- raw HTML omitted -->
<p><strong>hrCouldNotConnect</strong></p>
<!-- raw HTML omitted -->
<p>The server in <em>szServerName</em> cannot be found, is not a domain controller, or <em>szServerName</em> is not formatted correctly. This value is defined in Ntdsbmsg.h.</p>
<!-- raw HTML omitted -->
<p><strong>RPC_S_INVALID_BINDING</strong></p>
<!-- raw HTML omitted -->
<p>The <a href="dsisntdsonline.html"><strong>DsIsNTDSOnline</strong></a> function is being called remotely or the server in <em>szServerName</em> is not a domain controller.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>Call this function before calling any of the directory backup or restore functions. The directory must be online in order to perform a backup. The directory must by offline to perform a restore.</p>
<p>This function can only be called from a domain controller that is also the target server specified in <em>szServerName</em>. This function cannot be called remotely.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Ntdsbcli.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Ntdsbcli.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Ntdsbcli.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Unicode and ANSI names<!-- raw HTML omitted --></td>
<td><strong>DsIsNTDSOnlineW</strong> (Unicode) and <strong>DsIsNTDSOnlineA</strong> (ANSI)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="dssetauthidentity.html"><strong>DsSetAuthIdentity</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="directory-backup-functions.html">Directory Backup Functions</a></p>
<!-- raw HTML omitted -->
<p><a href="backing-up-and-restoring-an-active-directory-server.html">Backing Up and Restoring an Active Directory Server</a></p>
<!-- raw HTML omitted -->
</body>
