<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DsSetCurrentBackupLog function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: DsSetCurrentBackupLog function (Ntdsbcli.h)
description: Sets the current backup log number after a successful restore.
ms.assetid: 903bddea-c5a7-4b3f-819c-0467a9c5ae1b
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>DsSetCurrentBackupLog function Active Directory
topic_type:</li>
<li>apiref
api_name:</li>
<li>DsSetCurrentBackupLog</li>
<li>DsSetCurrentBackupLogA</li>
<li>DsSetCurrentBackupLogW
api_location:</li>
<li>Ntdsbcli.dll
api_type:</li>
<li>DllExport
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>DsSetCurrentBackupLog function</h1>
<p>[This function is available for use in the operating systems specified in the Requirements section. It may be altered or unavailable in subsequent versions. Beginning with Windows Vista, use <a href="../vss/volume-shadow-copy-service-overview.html">Volume Shadow Copy Service (VSS)</a> instead.]</p>
<p>The <strong>DsSetCurrentBackupLog</strong> function sets the current backup log number after a successful restore. Because Active Directory Domain Services only support circular logging, this function is not normally used.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT DsSetCurrentBackupLog(
  _In_ LPCWSTR szServerName,
  _In_ DWORD   dwCurrentLog
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>szServerName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Pointer to a null-terminated string that contains the name of the server to set the backup log number for. Preceding backslashes are optional. The server must be the same computer that this function is called from. The server name cannot contain any underscore (_) characters. An example of a server name is &quot;\\server1&quot;.</p>
<!-- raw HTML omitted -->
<p><em>dwCurrentLog</em> [in]</p>
<!-- raw HTML omitted -->
<p>Contains the backup log number to set.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns <strong>S_OK</strong> if the function is successful or a Win32 or RPC error code otherwise. The following list lists possible error codes.</p>
<!-- raw HTML omitted -->
<p><strong>ERROR_INVALID_PARAMETER</strong></p>
<!-- raw HTML omitted -->
<p>One or more parameters are invalid.</p>
<!-- raw HTML omitted -->
<p><strong>ERROR_NOT_ENOUGH_MEMORY</strong></p>
<!-- raw HTML omitted -->
<p>A memory allocation failure occurred.</p>
<!-- raw HTML omitted -->
<h2>Remarks</h2>
<p>It is not normally required to call the <strong>DsSetCurrentBackupLog</strong> function. The backup functions automatically determine and set the last log number backed up. Use <strong>DsSetCurrentBackupLog</strong> to prevent another incremental backup from succeeding until a full backup is performed.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Ntdsbcli.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Ntdsbcli.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Ntdsbcli.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Unicode and ANSI names<!-- raw HTML omitted --></td>
<td><strong>DsSetCurrentBackupLogW</strong> (Unicode) and <strong>DsSetCurrentBackupLogA</strong> (ANSI)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="backing-up-and-restoring-an-active-directory-server.html">Backing Up and Restoring an Active Directory Server</a></p>
<!-- raw HTML omitted -->
<p><a href="directory-backup-functions.html">Directory Backup Functions</a></p>
<!-- raw HTML omitted -->
</body>
