<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Reading the defaultSecurityDescriptor for an Object Class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Reading the defaultSecurityDescriptor for an Object Class
description: Using ADSI, you can obtain the defaultSecurityDescriptor attribute for an object class with the IADs interface.
ms.assetid: 12d1e77a-bd70-4c64-9b4f-ac5caaf5fe40
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>Active Directory examples Active Directory , reading the defaultSecurityDescriptor for an Object Class
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Reading the defaultSecurityDescriptor for an Object Class</h1>
<p>Using ADSI, you can obtain the <strong>defaultSecurityDescriptor</strong> attribute for an object class with the <a href="/windows/desktop/api/iads/nn-iads-iads"><strong>IADs</strong></a> interface. To obtain the <strong>defaultSecurityDescriptor</strong> attribute for an object class, perform the following steps.</p>
<ol>
<li>Get an <a href="/windows/desktop/api/iads/nn-iads-iads"><strong>IADs</strong></a> interface pointer to the <strong>classSchema</strong> object for the object class.</li>
<li>Use the <a href="/windows/desktop/api/iads/nf-iads-iads-get"><strong>IADs.Get</strong></a> method to get the default security descriptor of the object. The name of the property that contains the security descriptor is &quot;defaultSecurityDescriptor&quot;. The property will be returned as a <a href="/windows/win32/api/oaidl/ns-oaidl-variant"><strong>VARIANT</strong></a> containing a BSTR with the default security descriptor in SDDL string format.</li>
<li>Use the <a href="/windows/desktop/api/sddl/nf-sddl-convertstringsecuritydescriptortosecuritydescriptora"><strong>ConvertStringSecurityDescriptorToSecurityDescriptor</strong></a> function to convert the SDDL string form to a security descriptor.</li>
<li>Use the <a href="/windows/desktop/api/securitybaseapi/nf-securitybaseapi-getsecuritydescriptordacl"><strong>GetSecurityDescriptorDacl</strong></a>, <a href="/windows/desktop/api/securitybaseapi/nf-securitybaseapi-getsecuritydescriptorsacl"><strong>GetSecurityDescriptorSacl</strong></a>, <a href="/windows/desktop/api/securitybaseapi/nf-securitybaseapi-getsecuritydescriptorowner"><strong>GetSecurityDescriptorOwner</strong></a>, and <a href="/windows/desktop/api/securitybaseapi/nf-securitybaseapi-getsecuritydescriptorcontrol"><strong>GetSecurityDescriptorControl</strong></a> Security APIs to read the parts of the security descriptor.</li>
</ol>
<p>For a code example that demonstrates how to do this, see <a href="example-code-for-reading-defaultsecuritydescriptor.html">Example Code for Reading defaultSecurityDescriptor</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
