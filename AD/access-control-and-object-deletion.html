<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Access Control and Object Deletion</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Access Control and Object Deletion
description: Active Directory enables you to delete an object if you have DELETE access to the object or ADS_RIGHT_DS_DELETE_CHILD access to the object type on the parent container.
ms.assetid: 87027c25-e3c9-4bad-8df3-cb6205e40ef6
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>Access Control and Object Deletion AD
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Access Control and Object Deletion</h1>
<p>Active Directory Domain Services enable you to delete an object if you have one of the following access rights:</p>
<ul>
<li>DELETE access to the object itself</li>
<li>ADS_RIGHT_DS_DELETE_CHILD access for that object type on the parent container</li>
</ul>
<p>Be aware that the system verifies the security descriptor for both the object and its parent before denying the deletion. This means that an ACE that explicitly denies DELETE access to a user has no effect if the user has DELETE_CHILD access on the parent. Similarly, an ACE that denies DELETE_CHILD access on the parent can be overridden if DELETE access is allowed on the object itself.</p>
<p>To perform a tree-delete operation, for example using the <a href="/windows/desktop/api/iads/nf-iads-iadsdeleteops-deleteobject"><strong>IADsDeleteOps::DeleteObject</strong></a> method, you must have ADS_RIGHT_DS_DELETE_TREE access to the object. If you have this access right, you can delete the object and any child objects regardless of the protections on the child objects. To delete a tree if you do not have ADS_RIGHT_DS_DELETE_TREE access, you must recursively traverse the tree, deleting each object individually. In this case, you must have the necessary DELETE or DELETE_CHILD access for each object in the tree.</p>
<blockquote>
<p>[!WARNING]
If users have ADS_RIGHT_DS_DELETE_TREE access for an object, this gives them the ability to delete a whole subtree, including all child objects. For this reason, you may consider revoking &quot;Delete Subtree&quot; access permission for all users on a parent container.</p>
</blockquote>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
