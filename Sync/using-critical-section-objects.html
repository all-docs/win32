<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Critical Section Objects</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The following example shows how a thread initializes, enters, and releases a critical section. It uses the InitializeCriticalSectionAndSpinCount, EnterCriticalSection, LeaveCriticalSection, and DeleteCriticalSection functions.
ms.assetid: 3c96414b-97e7-4ebb-a629-bfdb7a77c576
title: Using Critical Section Objects
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using Critical Section Objects</h1>
<p>The following example shows how a thread initializes, enters, and releases a <a href="critical-section-objects.html">critical section</a>. It uses the <a href="/windows/win32/api/synchapi/nf-synchapi-initializecriticalsectionandspincount"><strong>InitializeCriticalSectionAndSpinCount</strong></a>, <a href="/windows/win32/api/synchapi/nf-synchapi-entercriticalsection"><strong>EnterCriticalSection</strong></a>, <a href="/windows/win32/api/synchapi/nf-synchapi-leavecriticalsection"><strong>LeaveCriticalSection</strong></a>, and <a href="/windows/win32/api/synchapi/nf-synchapi-deletecriticalsection"><strong>DeleteCriticalSection</strong></a> functions.</p>
<pre lang="syntax"><code>// Global variable
CRITICAL_SECTION CriticalSection; 

int main( void )
{
    ...

    // Initialize the critical section one time only.
    if (!InitializeCriticalSectionAndSpinCount(&amp;CriticalSection, 
        0x00000400) ) 
        return;
    ...

    // Release resources used by the critical section object.
    DeleteCriticalSection(&amp;CriticalSection);
}

DWORD WINAPI ThreadProc( LPVOID lpParameter )
{
    ...

    // Request ownership of the critical section.
    EnterCriticalSection(&amp;CriticalSection); 

    // Access the shared resource.

    // Release ownership of the critical section.
    LeaveCriticalSection(&amp;CriticalSection);

    ...
return 1;
}
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
