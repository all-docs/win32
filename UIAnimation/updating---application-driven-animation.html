<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Read the Animation Variable Values</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Read the Animation Variable Values
description: Each time your application paints, it should read the current values of the animation variables that represent the visual characteristics to be animated.
ms.assetid: 7abf084a-31f5-4e32-bfd1-e88fbc2bf63d
keywords:</p>
<ul>
<li>animation variables Windows Animation ,reading
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Read the Animation Variable Values</h1>
<p>Each time your application paints, it should read the current values of the animation variables that represent the visual characteristics to be animated.</p>
<h2>Overview</h2>
<p>When drawing a frame, an application can use the <a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariable-getvalue"><strong>IUIAnimationVariable::GetValue</strong></a> or <a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariable-getintegervalue"><strong>IUIAnimationVariable::GetIntegerValue</strong></a> method to request the values of any animation variables that will affect visuals within the frame. It is possible to clip an animation variable to a range of values (<a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariable-setlowerbound"><strong>SetLowerBound</strong></a> and <a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariable-setupperbound"><strong>SetUpperBound</strong></a>), and to request its value be rounded to an integer using a specified rounding scheme (<a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariable-setroundingmode"><strong>SetRoundingMode</strong></a>).</p>
<p>Instead of reading the values of all variables for every frame, an application can use the <a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariable-setvariablechangehandler"><strong>IUIAnimationVariable::SetVariableChangeHandler</strong></a> or <a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariable-setvariableintegerchangehandler"><strong>IUIAnimationVariable::SetVariableIntegerChangeHandler</strong></a> method to register one or more variable change handlers to receive notifications only when there is a change to the variables' value (<a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariablechangehandler-onvaluechanged"><strong>IUIAnimationVariableChangeHandler::OnValueChanged</strong></a>) or rounded value (<a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariableintegerchangehandler-onintegervaluechanged"><strong>IUIAnimationVariableIntegerChangeHandler::OnIntegerValueChanged</strong></a>). To identify the variables passed to variable change handlers, an application can apply tags to variables using the <a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariable-settag"><strong>IUIAnimationVariable::SetTag</strong></a> method. These are object (IUnknown*), integer pairs that are interpreted by the application.</p>
<h2>Example Code</h2>
<p>The following example code is taken from Thumbnail.cpp in the Windows Animation sample <a href="/windows/desktop/UIAnimation/grid-layout-sample">Grid Layout</a>; see the CMainWindow::Render method. It uses the <a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariable-getvalue"><strong>GetValue</strong></a> method to read the values as floating-point values.</p>
<pre lang="C++"><code>// Get the x-coordinate and y-coordinate animation variable values

DOUBLE x=0;
hr = m_pAnimationVariableX-&gt;GetValue(&amp;x);
if (SUCCEEDED(hr))
{
    DOUBLE y=0;
    hr = m_pAnimationVariableY-&gt;GetValue(&amp;y);
    if (SUCCEEDED(hr))
    {
        // Draw the object

        ...

    }
}
</code></pre>
<p>The following example code is taken from MainWindow.cpp in the Windows Animation sample <a href="timer-driven-animation-sample.html">Timer-Driven Animation</a>; see the CMainWindow::DrawBackground method. It uses the <a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariable-getintegervalue"><strong>GetIntegerValue</strong></a> method to read the values as integer values.</p>
<pre lang="C++"><code>// Get the RGB animation variable values

INT32 red;
HRESULT hr = m_pAnimationVariableRed-&gt;GetIntegerValue(
    &amp;red
    );
if (SUCCEEDED(hr))
{
    INT32 green;
    hr = m_pAnimationVariableGreen-&gt;GetIntegerValue(
        &amp;green
        );
    if (SUCCEEDED(hr))
    {
        INT32 blue;
        hr = m_pAnimationVariableBlue-&gt;GetIntegerValue(
            &amp;blue
            );
        if (SUCCEEDED(hr))
        {
            // Set the RGB of the background brush to the new animated value

            ...
                
            // Paint the background

            ...

        }
    }

    ...

}
</code></pre>
<h2>Previous Step</h2>
<p>Before starting this step, you should have completed this step: <a href="introducing-windows-animation-manager.html">Update the Animation Manager and Draw Frames</a>.</p>
<h2>Next Step</h2>
<p>After completing this step, the next step is: <a href="updating---timer-driven-animation.html">Create a Storyboard and Add Transitions</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariable-getintegervalue"><strong>IUIAnimationVariable::GetIntegerValue</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/UIAnimation/nf-uianimation-iuianimationvariable-getvalue"><strong>IUIAnimationVariable::GetValue</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="scenic-animation-api-overview.html">Windows Animation Overview</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
