<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>XTYP_ADVREQ transaction</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: XTYP_ADVREQ transaction (Ddeml.h)
description: The XTYP_ADVREQ transaction informs the server that an advise transaction is outstanding on the specified topic name and item name pair and that data corresponding to the topic name and item name pair has changed.
ms.assetid: 9bd43e61-cbd6-4d53-bab3-90e85819b16b
keywords:</p>
<ul>
<li>XTYP_ADVREQ transaction Data Exchange
topic_type:</li>
<li>apiref
api_name:</li>
<li>XTYP_ADVREQ
api_location:</li>
<li>Ddeml.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>XTYP_ADVREQ transaction</h1>
<p>The <strong>XTYP_ADVREQ</strong> transaction informs the server that an advise transaction is outstanding on the specified topic name and item name pair and that data corresponding to the topic name and item name pair has changed. The system sends this transaction to the Dynamic Data Exchange (DDE) callback function, <a href="/windows/win32/api/ddeml/nc-ddeml-pfncallback"><em>DdeCallback</em></a>, after the server calls the <a href="/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise"><strong>DdePostAdvise</strong></a> function.</p>
<pre lang="C++"><code>#define     XCLASS_DATA              0x2000
#define     XTYPF_NOBLOCK            0x0002
#define     XTYP_ADVREQ             (0x0020 | XCLASS_DATA | XTYPF_NOBLOCK )
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>uType</em></p>
<!-- raw HTML omitted -->
<p>The transaction type.</p>
<!-- raw HTML omitted -->
<p><em>uFmt</em></p>
<!-- raw HTML omitted -->
<p>The format in which the data should be submitted to the client.</p>
<!-- raw HTML omitted -->
<p><em>hconv</em></p>
<!-- raw HTML omitted -->
<p>A handle to the conversation.</p>
<!-- raw HTML omitted -->
<p><em>hsz1</em></p>
<!-- raw HTML omitted -->
<p>A handle to the topic name.</p>
<!-- raw HTML omitted -->
<p><em>hsz2</em></p>
<!-- raw HTML omitted -->
<p>A handle to the item name that has changed.</p>
<!-- raw HTML omitted -->
<p><em>hdata</em></p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><em>dwData1</em></p>
<!-- raw HTML omitted -->
<p>The count, in the low-order word, of <strong>XTYP_ADVREQ</strong> transactions that remain to be processed on the same topic, item, and format name set within the context of the current call to the <a href="/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise"><strong>DdePostAdvise</strong></a> function. The count is zero if the current <strong>XTYP_ADVREQ</strong> transaction is the last one. A server can use this count to determine whether to create an <strong>HDATA_APPOWNED</strong> data handle to the advise data.</p>
<p>The low-order word is set to <strong>CADV_LATEACK</strong> if the DDEML issued the <strong>XTYP_ADVREQ</strong> transaction because of a late-arriving DDE_ACK message from a client being outrun by the server.</p>
<p>The high-order word is not used.</p>
<!-- raw HTML omitted -->
<p><em>dwData2</em></p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>The server should first call the <a href="/windows/desktop/api/Ddeml/nf-ddeml-ddecreatedatahandle"><strong>DdeCreateDataHandle</strong></a> function to create a data handle that identifies the changed data and then return the handle. The server should return <strong>NULL</strong> if it is unable to complete the transaction.</p>
<h2>Remarks</h2>
<p>A server cannot block this transaction type; the <strong>CBR_BLOCK</strong> return code is ignored.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Ddeml.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Ddeml/nf-ddeml-ddecreatedatahandle"><strong>DdeCreateDataHandle</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea"><strong>DdeInitialize</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise"><strong>DdePostAdvise</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="dynamic-data-exchange-management-library.html">Dynamic Data Exchange Management Library</a></p>
<!-- raw HTML omitted -->
</body>
