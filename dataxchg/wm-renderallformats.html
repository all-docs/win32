<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>WM_RENDERALLFORMATS message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: WM_RENDERALLFORMATS message (Winuser.h)
description: Sent to the clipboard owner before it is destroyed, if the clipboard owner has delayed rendering one or more clipboard formats.
ms.assetid: dff9100f-2dba-467d-be74-a9a9c2b2122b
keywords:</p>
<ul>
<li>WM_RENDERALLFORMATS message Data Exchange
topic_type:</li>
<li>apiref
api_name:</li>
<li>WM_RENDERALLFORMATS
api_location:</li>
<li>Winuser.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>WM_RENDERALLFORMATS message</h1>
<p>Sent to the clipboard owner before it is destroyed, if the clipboard owner has delayed rendering one or more clipboard formats. For the content of the clipboard to remain available to other applications, the clipboard owner must render data in all the formats it is capable of generating, and place the data on the clipboard by calling the <a href="/windows/win32/api/winuser/nf-winuser-setclipboarddata"><strong>SetClipboardData</strong></a> function.</p>
<p>A window receives this message through its <a href="/windows/win32/api/winuser/nc-winuser-wndproc"><strong>WindowProc</strong></a> function.</p>
<pre lang="C++"><code>#define WM_RENDERALLFORMATS             0x0306
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>This parameter is not used and must be zero.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>This parameter is not used and must be zero.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If an application processes this message, it should return zero.</p>
<h2>Remarks</h2>
<p>When responding to a <strong>WM_RENDERALLFORMATS</strong> message, the application must call the <a href="/windows/win32/api/winuser/nf-winuser-openclipboard"><strong>OpenClipboard</strong></a> function and then check that it is still the clipboard owner by calling the <a href="/windows/win32/api/winuser/nf-winuser-getclipboardowner"><strong>GetClipboardOwner</strong></a> function before calling <a href="/windows/win32/api/winuser/nf-winuser-setclipboarddata"><strong>SetClipboardData</strong></a>.</p>
<p>The application needs to check that it is still the clipboard owner after opening the clipboard because after it receives the <strong>WM_RENDERALLFORMATS</strong> message, but before it opens the clipboard, another application may have opened and taken ownership of the clipboard, and that application's data should not be overwritten.</p>
<p>In most cases, the application should not call the <a href="/windows/win32/api/winuser/nf-winuser-emptyclipboard"><strong>EmptyClipboard</strong></a> function before calling <a href="/windows/win32/api/winuser/nf-winuser-setclipboarddata"><strong>SetClipboardData</strong></a>, since doing so will erase the clipboard formats that the application has already rendered.</p>
<p>When the application returns, the system removes any unrendered formats from the list of available clipboard formats. For information about delayed rendering, see <a href="clipboard-operations.md#delayed-rendering">Delayed Rendering</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winuser.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Winuser/nf-winuser-emptyclipboard"><strong>EmptyClipboard</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Winuser/nf-winuser-openclipboard"><strong>OpenClipboard</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/winuser/nf-winuser-setclipboarddata"><strong>SetClipboardData</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="wm-renderformat.html"><strong>WM_RENDERFORMAT</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="clipboard.html">Clipboard</a></p>
<!-- raw HTML omitted -->
</body>
