<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>XTYP_CONNECT transaction</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: XTYP_CONNECT transaction (Ddeml.h)
description: A client uses the XTYP_CONNECT transaction to establish a conversation.
ms.assetid: 74f43b10-f7ac-4370-9caa-7b9ddf3413ed
keywords:</p>
<ul>
<li>XTYP_CONNECT transaction Data Exchange
topic_type:</li>
<li>apiref
api_name:</li>
<li>XTYP_CONNECT
api_location:</li>
<li>Ddeml.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>XTYP_CONNECT transaction</h1>
<p>A client uses the <strong>XTYP_CONNECT</strong> transaction to establish a conversation. A Dynamic Data Exchange (DDE) server callback function, <a href="/windows/win32/api/ddeml/nc-ddeml-pfncallback"><em>DdeCallback</em></a>, receives this transaction when a client specifies a service name that the server supports (and a topic name that is not <strong>NULL</strong>) in a call to the <a href="/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect"><strong>DdeConnect</strong></a> function.</p>
<pre lang="C++"><code>#define     XCLASS_BOOL              0x1000
#define     XTYPF_NOBLOCK            0x0002
#define     XTYP_CONNECT            (0x0060 | XCLASS_BOOL | XTYPF_NOBLOCK)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>uType</em></p>
<!-- raw HTML omitted -->
<p>The transaction type.</p>
<!-- raw HTML omitted -->
<p><em>uFmt</em></p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><em>hconv</em></p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><em>hsz1</em></p>
<!-- raw HTML omitted -->
<p>A handle to the topic name.</p>
<!-- raw HTML omitted -->
<p><em>hsz2</em></p>
<!-- raw HTML omitted -->
<p>A handle to the service name.</p>
<!-- raw HTML omitted -->
<p><em>hdata</em></p>
<!-- raw HTML omitted -->
<p>Not used.</p>
<!-- raw HTML omitted -->
<p><em>dwData1</em></p>
<!-- raw HTML omitted -->
<p>A pointer to a <a href="/windows/win32/api/ddeml/ns-ddeml-convcontext"><strong>CONVCONTEXT</strong></a> structure that contains context information for the conversation. If the client is not a DDEML application, this parameter is 0.</p>
<!-- raw HTML omitted -->
<p><em>dwData2</em></p>
<!-- raw HTML omitted -->
<p>Specifies whether the client is the same application instance as the server. If the parameter is 1, the client is the same instance. If the parameter is 0, the client is a different instance.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>A server callback function should return <strong>TRUE</strong> to allow the client to establish a conversation on the specified service name and topic name pair, or the function should return <strong>FALSE</strong> to deny the conversation. If the callback function returns <strong>TRUE</strong> and a conversation is successfully established, the system passes the conversation handle to the server by issuing an <a href="xtyp-connect-confirm.html"><strong>XTYP_CONNECT_CONFIRM</strong></a> transaction to the server's callback function (unless the server specified the <strong>CBF_SKIP_CONNECT_CONFIRMS</strong> flag in the <a href="/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea"><strong>DdeInitialize</strong></a> function).</p>
<h2>Remarks</h2>
<p>This transaction is filtered if the server application specified the <strong>CBF_FAIL_CONNECTIONS</strong> flag in the <a href="/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea"><strong>DdeInitialize</strong></a> function.</p>
<p>A server cannot block this transaction type; the <strong>CBR_BLOCK</strong> return code is ignored.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Ddeml.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/ddeml/ns-ddeml-convcontext"><strong>CONVCONTEXT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect"><strong>DdeConnect</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea"><strong>DdeInitialize</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="dynamic-data-exchange-management-library.html">Dynamic Data Exchange Management Library</a></p>
<!-- raw HTML omitted -->
</body>
