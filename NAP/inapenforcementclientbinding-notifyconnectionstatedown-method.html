<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>INapEnforcementClientBinding::NotifyConnectionStateDown method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: INapEnforcementClientBinding NotifyConnectionStateDown method (NapEnforcementClient.h)
description: Is used to inform the NapAgent that a connection to an enforcement client has gone down.
ms.assetid: 504c61c1-c8f9-46b8-87cd-c1f04846f0b3
keywords:</p>
<ul>
<li>NotifyConnectionStateDown method NAP</li>
<li>NotifyConnectionStateDown method NAP , INapEnforcementClientBinding interface</li>
<li>INapEnforcementClientBinding interface NAP , NotifyConnectionStateDown method
topic_type:</li>
<li>apiref
api_name:</li>
<li>INapEnforcementClientBinding.NotifyConnectionStateDown
api_location:</li>
<li>qagent.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>INapEnforcementClientBinding::NotifyConnectionStateDown method</h1>
<blockquote>
<p>[!Note]<br />
The Network Access Protection platform is not available starting with Windows 10</p>
</blockquote>
<p>The <strong>INapEnforcementClientBinding::NotifyConnectionStateDown</strong> method is used to inform the NapAgent that a connection to an enforcement client has gone down.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT NotifyConnectionStateDown(
  [in] INapEnforcementClientConnection *downCxn
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>downCxn</em> [in]</p>
<!-- raw HTML omitted -->
<p>A COM pointer to the <a href="inapenforcementclientconnection.html"><strong>INapEnforcementClientConnection</strong></a> interface of the down connection.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Other COM-specific error codes also may be returned.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong> <!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The operation is successful.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_ACCESSDENIED</strong> <!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Permissions error, access denied.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_OUTOFMEMORY</strong> <!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>System resource limit, could not perform the operation.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>NAP_E_NOT_INITIALIZED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The enforcer has not been previously initialized.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>When any of the connections established by an enforcement client go down, the enforcement client should remove the connection from its active list and inform the NapAgent using this method. As soon as this call returns, the connection object can be released and freed. The NapAgent will not hold references to the connection object.</p>
<p>As a result of this notification, the NapAgent updates its system NAP state as appropriate.</p>
<p>The enforcement client must call the <a href="inapenforcementclientbinding-initialize-method.html"><strong>INapEnforcementClientBinding::Initialize</strong></a> method before calling this or any other method of the <a href="inapenforcementclientbinding.html"><strong>INapEnforcementClientBinding</strong></a> interface.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->NapEnforcementClient.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IDL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->NapEnforcementClient.idl<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Qagent.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><a href="inapenforcementclientbinding.html"><strong>INapEnforcementClientBinding</strong></a></p>
<!-- raw HTML omitted -->
</body>
