<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Properties and Property Sets</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Properties and Property Sets
description: While the kinds of run-time properties that Automation and Microsoft ActiveX Controls offer are important, they do not directly address the need to store information with objects persistently stored in the file system.
ms.assetid: 350cfb84-2f8e-46e7-a70d-09beb14a8eee
keywords:</p>
<ul>
<li>Structured Storage Strctd Stg ,fundamentals,properties and property sets
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Properties and Property Sets</h1>
<p>While the kinds of run-time properties that Automation and Microsoft ActiveX Controls offer are important, they do not directly address the need to store information with objects persistently stored in the file system. These entities could include files (structured, compound, and so forth), directories, and summary catalogs. COM provides both a standard serialized format for these persistent properties, and a set of interfaces and functions that allow you to create and manipulate the property sets and their properties.</p>
<p>Persistent properties are stored as sets, and one or more sets may be associated with a file system entity. These persistent property sets are intended to be used to store data that is suited to being represented as a collection of fine-grained values. They are not intended to be used as a large data base. They can be used to store summary information about an object on the system, which can then be accessed by any other object that understands how to interpret that property set.</p>
<p>Previous versions of COM specified very little with respect to properties and their usage, but did define a serialized format that allowed developers to store properties and property sets in an <a href="/windows/desktop/api/Objidl/nn-objidl-istorage"><strong>IStorage</strong></a> instance. The property identifiers and semantics of a single property set, used for summary information about a document, were also defined. At that time, it was necessary to create and manipulate that structure directly as a data stream. See <a href="structured-storage-serialized-property-set-format.html">Structured Storage Serialized Property Set Format</a>.</p>
<p>Now, however, COM defines two primary interfaces to manage property sets:</p>
<ul>
<li><a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a></li>
<li><a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a></li>
</ul>
<p>It is no longer necessary to deal with the serialized format directly when these interfaces are implemented on an object that supports the <a href="/windows/desktop/api/Objidl/nn-objidl-istorage"><strong>IStorage</strong></a> interface (such as compound files). Writing properties through <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> and <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a> creates data that exactly conforms to the COM property set format, as viewed through <strong>IStorage</strong> methods. The converse is also true â€” properties written to the COM property set format using <strong>IStorage</strong> are visible through <strong>IPropertySetStorage</strong> and <strong>IPropertyStorage</strong> (although you cannot expect to write to <a href="/windows/desktop/api/Objidl/nn-objidl-istream"><strong>IStream</strong></a> and have the properties through <strong>IPropertyStorage</strong> immediately available, or vice versa).</p>
<p>The <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> interface defines methods that create and manage property sets. The <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a> interface directly manipulates the properties within a property set. By calling the methods of these interfaces, an application developer can manage whatever property sets are appropriate for a given file system entity. Use of these interfaces provides one tuned reading and writing implementation for properties, rather than having an implementation in each application, where there could be performance bottlenecks such as incessant seeking. You can implement the interfaces to enhance performance, so properties can be read and written more quickly by, for example, more efficient caching. Furthermore, <strong>IPropertyStorage</strong> and <strong>IPropertySetStorage</strong> make it possible to manipulate properties on entities that do not support <a href="/windows/desktop/api/Objidl/nn-objidl-istorage"><strong>IStorage</strong></a>, although in general, most applications will not do so.</p>
<p>This section contains the following topics:</p>
<ul>
<li><a href="the-summary-information-property-set.html">The Summary Information Property Set</a></li>
<li><a href="predefined-property-set-format-identifiers.html">Predefined Property Set Format Identifiers</a></li>
<li><a href="the-documentsummaryinformation-and-userdefined-property-sets.html">The DocumentSummaryInformation and UserDefined Property Sets</a></li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="property-set-implementations-in-com.html">Property Set Implementations in COM</a></p>
<!-- raw HTML omitted -->
<p><a href="property-set-considerations.html">Property Set Considerations</a></p>
<!-- raw HTML omitted -->
<p><a href="managing-properties.html">Managing Properties</a></p>
<!-- raw HTML omitted -->
<p><a href="managing-property-sets.html">Managing Property Sets</a></p>
<!-- raw HTML omitted -->
<p><a href="storing-property-sets.html">Storing Property Sets</a></p>
<!-- raw HTML omitted -->
<p><a href="performance-characteristics.html">Performance Characteristics</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
