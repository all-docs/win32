<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PaintWin Method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: PaintWin Method
description: PaintWin Method
ms.assetid: e89794e6-c059-4531-a1e3-3a4972e0218d
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>PaintWin Method</h1>
<p>The following is CGuiPaper's <strong>PaintWin</strong> method from GUIPAPER.CPP.</p>
<pre lang="C++"><code>HRESULT CGuiPaper::PaintWin(void)
  {
    HRESULT hr = E_FAIL;
    COLORREF crInkColor;
    SHORT nInkWidth;

    if (m_pIPaper &amp;&amp; !m_bPainting &amp;&amp; !m_bInking)
    {
      m_bPainting = TRUE;
      // Save and restore ink color and width since redraw otherwise
      // ends up changing these values in CGuiPaper.
      crInkColor = m_crInkColor;
      nInkWidth = m_nInkWidth;
      hr = m_pIPaper-&gt;Redraw(m_nLockKey);
      m_nInkWidth = nInkWidth;
      m_crInkColor = crInkColor;
      m_bPainting = FALSE;
    }

    return hr;
  }
</code></pre>
<p><strong>PaintWin</strong> essentially calls COPaper's <strong>Redraw</strong> method. In the <a href="structured-storage-server-sample--stoserve-.html">StoServe</a> sample, the <strong>Redraw</strong> method was shown to broadcast COPaper's entire ink data array to all connected sinks. <strong>PaintWin</strong> calls an object on the server side to send back the drawing data to the client.</p>
<p>Â </p>
<p>Â </p>
</body>
