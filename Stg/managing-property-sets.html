<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Managing Property Sets</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Managing Property Sets
description: A persistent property set contains related data as properties.
ms.assetid: 19ff2751-87f3-43d8-9307-ce2dd399f694
keywords:</p>
<ul>
<li>Managing Property Sets
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Managing Property Sets</h1>
<p>A persistent property set contains related data as properties. Each property set is identified with an FMTID, and a globally unique identifier (GUID) that enables applications, accessing the property set, to identify the property set. Through this identification, the application interprets the properties that the set contains.</p>
<p>For example, the character-formatting properties in a word processor or the rendering attributes of an element in a drawing program are property sets.</p>
<p>COM defines the <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> interface to facilitate management of property sets. Through the methods of this interface, you can create a new property set, or open or delete an existing property set. In addition, it provides a method that creates an enumerator and supplies a pointer to its <a href="/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg"><strong>IEnumSTATPROPSETSTG</strong></a> interface. You can call the methods of this interface to enumerate <a href="/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg"><strong>STATPROPSETSTG</strong></a> structures on your object, which will provide information about all of the property sets on the object.</p>
<p>When you create or open an instance of <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a>, it is similar to opening an object that supports <a href="/windows/desktop/api/Objidl/nn-objidl-istorage"><strong>IStorage</strong></a> or <a href="/windows/desktop/api/Objidl/nn-objidl-istream"><strong>IStream</strong></a>, because you need to specify the storage mode in which you are opening the interface. For <strong>IStorage</strong>, these include the transaction mode, the read/write mode, and the sharing mode.</p>
<p>When you create a property set with a call to <a href="/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create"><strong>IPropertySetStorage::Create</strong></a>, specify whether the property set is to be simple or nonsimple. A simple property set contains types that can be written fully within the property set stream, which is intended to be limited in size, and can be no larger than 256 KB in WindowsÂ NTÂ 4.0 and earlier, or 1 MB in WindowsÂ 2000, WindowsÂ XP, and Windows ServerÂ 2003. However, when you need to store a larger amount of information in the property set, you can specify that the property set be nonsimple. This allows you to use one or more of the types that specify only a pointer to a storage or stream object. These types are VT_STREAM, VT_STREAMED OBJECT, VT_STORAGE and VT_STORED_OBJECT.</p>
<p>Data stored in these properties is not counted against the 256 KB property-set size limit in WindowsÂ NTÂ 4.0 or earlier, or the 1 MB limit in WindowsÂ 2000, WindowsÂ XP, and Windows ServerÂ 2003. However, data about the property, such as its name, does apply. Also, if you need a transacted update, the property set must be nonsimple. There is, of course, a certain performance penalty for opening these types, because it requires opening the stream or storage object to which you have the pointer.</p>
<p>If your application uses compound files, you can use the COM-provided implementation of these interfaces, which are implemented on the COM compound file storage object.</p>
<p>Each property set consists primarily of a logically connected group of properties, as described in <a href="managing-properties.html">Managing Properties</a>.</p>
<p>For more information about property sets in COM, see:</p>
<ul>
<li><a href="property-set-implementations-in-com.html">Property Set Implementations in COM</a></li>
<li><a href="property-set-considerations.html">Property Set Considerations</a></li>
<li><a href="ipropertysetstorage-implementation-considerations.html">IPropertySetStorage Implementation Considerations</a></li>
<li><a href="storing-property-sets.html">Storing Property Sets</a></li>
<li><a href="performance-characteristics.html">Performance Characteristics</a></li>
<li><a href="implementing-the-summary-information-property-set.html">Implementing the Summary Information Property Set</a></li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
