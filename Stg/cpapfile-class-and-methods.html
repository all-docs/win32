<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CPapFile Class and Methods</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: CPapFile Class and Methods
description: StoClien encapsulates its compound file operations in a CPapFile C++ object.
ms.assetid: 21a3e170-0a73-4744-8cfc-3a04e0571792
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>CPapFile Class and Methods</h1>
<p><strong>StoClien</strong> encapsulates its compound file operations in a CPapFile C++ object.</p>
<p>The following is the <strong>CPapFile</strong> class declaration from Papfile.h.</p>
<pre lang="C++"><code>class CPapFile
  {
    public:
      CPapFile(void);
      ~CPapFile(void);
      HRESULT Init(TCHAR* pszFileName, IPaper* pIPaper);
      HRESULT Load(SHORT nLockKey, TCHAR* pszFileName);
      HRESULT Save(SHORT nLockKey, TCHAR* pszFileName);

    private:
      TCHAR          m_szCurFileName[MAX_PATH];
      IPaper*        m_pIPaper;
      IStorage*      m_pIStorage;
  };
  
</code></pre>
<p>The CPapFile object keeps a current file name in member <strong>m_szCurFileName</strong>. This file name is used as a default in the <a href="load-method---cpapfile.html"><strong>Load</strong></a> and <a href="save-method---cpapfile.html"><strong>Save</strong></a> methods when they do not explicitly receive a file name.</p>
<p>Member <strong>m_pIPaper</strong> keeps an interface pointer to the COPaper <a href="ipaper-methods.html"><strong>IPaper</strong></a> interface. Member <strong>m_pIStorage</strong> keeps a pointer to the <a href="/windows/desktop/api/Objidl/nn-objidl-istorage"><strong>IStorage</strong></a> interface for the current compound file that <strong>StoClien</strong> is using for structured storage.</p>
<p>The following is a summary of CPapFile's methods.</p>
<pre lang="C++"><code>HRESULT Init(TCHAR* pszFileName, IPaper* pIPaper);
    // Initializes CPapFile.

  HRESULT Load(SHORT nLockKey, TCHAR* pszFileName);
    // Loads default or specified paper data file.

  HRESULT Save(SHORT nLockKey, TCHAR* pszFileName);
    // Saves drawing data to the current paper data file or
    // to a specified paper data file.
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
