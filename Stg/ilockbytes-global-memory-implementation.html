<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ILockBytes - Global Memory Implementation</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: ILockBytes - Global Memory Implementation
description: The ILockBytes global memory implementation is implemented on a byte array object underlying a COM compound file storage object, and designed to read and write directly to global memory.
ms.assetid: 6ab019b0-34d7-4b6e-ba77-6b6881fabd29
keywords:</p>
<ul>
<li>ILockBytes Strctd Stg , implementations, global memory</li>
<li>ILockBytes Strctd Stg , implementations
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>ILockBytes - Global Memory Implementation</h1>
<p>The ILockBytes global memory implementation is implemented on a byte array object underlying a COM compound file storage object, and designed to read and write directly to global memory.</p>
<h2>When to Use</h2>
<p>Methods of <a href="/windows/desktop/api/Objidl/nn-objidl-ilockbytes"><strong>ILockBytes</strong></a> are called from the compound file implementations of <a href="/windows/desktop/api/Objidl/nn-objidl-istorage"><strong>IStorage</strong></a> and <a href="/windows/desktop/api/Objidl/nn-objidl-istream"><strong>IStream</strong></a> on the compound file storage object created through a call to <a href="/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile"><strong>StgCreateDocfile</strong></a>.</p>
<h2>Remarks</h2>
<p>The following are the methods of the <a href="/windows/desktop/api/Objidl/nn-objidl-ilockbytes"><strong>ILockBytes</strong></a> Global Memory Implementation.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::ReadAt</strong></p>
<!-- raw HTML omitted -->
<p>Reads a block of bytes from a specified offset at the beginning of the byte array.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::WriteAt</strong></p>
<!-- raw HTML omitted -->
<p>Writes the block of bytes from a specified offset at the beginning of the byte array.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::Flush</strong></p>
<!-- raw HTML omitted -->
<p>Unlike file-based implementation, calling this method in global memory implementation has no effect.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::SetSize</strong></p>
<!-- raw HTML omitted -->
<p>Sets the size of the byte array.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::LockRegion</strong></p>
<!-- raw HTML omitted -->
<p>This implementation does not support locking, so <em>dwLocksType</em> is set to zero. The caller must ensure accesses are valid and mutually exclusive.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::UnlockRegion</strong></p>
<!-- raw HTML omitted -->
<p>This implementation does not support locking.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::Stat</strong></p>
<!-- raw HTML omitted -->
<p>The COM-provided <a href="/windows/desktop/api/Objidl/nf-objidl-istorage-stat"><strong>IStorage::Stat</strong></a> implementation calls the <a href="/windows/desktop/api/Objidl/nf-objidl-ilockbytes-stat"><strong>ILockBytes::Stat</strong></a> method to retrieve data about the byte array object. If there is no reasonable name for the byte array, the COM-provided <strong>ILockBytes::Stat</strong> method returns <strong>NULL</strong> in the <strong>pwcsName</strong> member of the <a href="/windows/win32/api/objidl/ns-objidl-statstg"><strong>STATSTG</strong></a> structure.</p>
<!-- raw HTML omitted -->
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Objidl/nn-objidl-ilockbytes"><strong>ILockBytes</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Objidl/nn-objidl-istorage"><strong>IStorage</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Objidl/nn-objidl-istream"><strong>IStream</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
