<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Property Set Implementations in COM</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Property Set Implementations in COM
description: Property Set Implementations in COM
ms.assetid: 52d7b534-f81a-4cc9-b5ea-9538bfff056c
keywords:</p>
<ul>
<li>Structured Storage Strctd Stg ,using,property set uses in COM
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Property Set Implementations in COM</h1>
<p>While the potential for uses of persistent property sets is not fully tapped, there are currently two primary uses:</p>
<ul>
<li>Storing summary information with an object such as a document</li>
<li>Transferring property data between objects</li>
</ul>
<p>COM property sets were designed to store data that is suited to representation as a moderately sized collection of fine-grained values. Data sets that are too large for this to be feasible should be broken into separate streams, storages, and/or property sets. The COM property set data format was not meant to provide a substitute for a database of many tiny objects.</p>
<p>COM provides implementations of the property set interfaces for various objects, along with three helper functions. The following section describes some performance characteristics of these implementations. For more information on specific interfaces and how to get a pointer to these interfaces, refer to the following in the COM reference section:</p>
<ul>
<li>
<p><a href="ipropertysetstorage-compound-file-implementation.html">IPropertySetStorageâ€“Compound File Implementation</a></p>
<p>The compound file implementation, which provides the <a href="/windows/desktop/api/Objidl/nn-objidl-istorage"><strong>IStorage</strong></a> and <a href="/windows/desktop/api/Objidl/nn-objidl-istream"><strong>IStream</strong></a> interfaces, also provides the <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> and <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a> interfaces. Given a compound file implementation of <strong>IStorage</strong>, the <strong>IPropertySetStorage</strong> interface can be obtained by calling <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)"><strong>IUnknown::QueryInterface</strong></a>.</p>
</li>
<li>
<p><a href="ipropertysetstorage-ntfs-file-system-implementation.html">IPropertySetStorageâ€“NTFS File System Implementation</a></p>
<p>The <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> and <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a> interfaces can also be obtained for NTFS files that are not compound files. Therefore, it is possible to obtain these interfaces for all files on an NTFS volume.</p>
</li>
<li>
<p><a href="ipropertysetstorage-stand-alone-implementation.html">IPropertySetStorageâ€“Stand-alone Implementation</a></p>
<p>When this implementation of <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> and <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a> is instantiated, it is given a pointer to an object that supports the <a href="/windows/desktop/api/Objidl/nn-objidl-istorage"><strong>IStorage</strong></a> interface. It then manipulates property set storages within that storage object. Thus, it is possible to access and manipulate property sets on any object that supports .</p>
</li>
<li>
<p><a href="ipropertysetstorage-implementation-considerations.html">IPropertySetStorage Implementation Considerations</a></p>
<p>There are several issues to consider in providing an implementation of the <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> interface. Please refer to these <em>Implementation Considerations</em> in the COM Reference section.</p>
</li>
</ul>
<p>In addition, there are four helper functions, designed to aid in dealing with properties that have been read from a property set into memory (into a <a href="/windows/win32/api/propidlbase/ns-propidlbase-propvariant"><strong>PROPVARIANT</strong></a> structure):</p>
<ul>
<li><a href="/windows/desktop/api/PropIdl/nf-propidl-propvariantinit"><strong>PropVariantInit</strong></a></li>
<li><a href="/windows/win32/api/combaseapi/nf-combaseapi-propvariantclear"><strong>PropVariantClear</strong></a></li>
<li><a href="/windows/win32/api/combaseapi/nf-combaseapi-freepropvariantarray"><strong>FreePropVariantArray</strong></a></li>
<li><a href="/windows/win32/api/combaseapi/nf-combaseapi-propvariantcopy"><strong>PropVariantCopy</strong></a></li>
</ul>
<p>The following sections discuss property set implementations in COM in greater detail:</p>
<ul>
<li><a href="managing-property-sets.html">Managing Property Sets</a></li>
<li><a href="property-set-considerations.html">Property Set Considerations</a></li>
<li><a href="storing-property-sets.html">Storing Property Sets</a></li>
<li><a href="performance-characteristics.html">Performance Characteristics</a></li>
<li><a href="implementing-the-summary-information-property-set.html">Implementing the Summary Information Property Set</a></li>
<li><a href="ipropertysetstorage-implementation-considerations.html">IPropertySetStorage Implementation Considerations</a></li>
</ul>
<p>Â </p>
<p>Â </p>
</body>
