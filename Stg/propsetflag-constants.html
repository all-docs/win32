<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PROPSETFLAG Constants</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: PROPSETFLAG Constants (Propidl.h)
description: Define characteristics of a property set.
ms.assetid: 6f865c8f-bbca-4122-b076-14f2bc56f292
topic_type:</p>
<ul>
<li>apiref
api_name:</li>
<li>PROPSETFLAG_DEFAULT</li>
<li>PROPSETFLAG_NONSIMPLE</li>
<li>PROPSETFLAG_ANSI</li>
<li>PROPSETFLAG_UNBUFFERED</li>
<li>PROPSETFLAG_CASE_SENSITIVE
api_location:</li>
<li>Propidl.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>PROPSETFLAG Constants</h1>
<p>The PROPSETFLAG constants define characteristics of a property set. The values, listed in the following table, are used in the <em>grfFlags</em> parameter of <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> methods, the <a href="/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg"><strong>StgCreatePropStg</strong></a> function, and the <a href="/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg"><strong>StgOpenPropStg</strong></a> function.</p>
<table>
<thead>
<tr>
<th align="left">Constant/value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PROPSETFLAG_DEFAULT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">If left unspecified, by default only simple property values may be written to the property set. Using simple property values prevents property sets from being transacted in the compound file and stand-alone implementations of <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a>. Non-e property values must be used for this purpose.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PROPSETFLAG_NONSIMPLE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">If specified, nonsimple property values can be written to the property set and the property set is saved in a storage object. Non-simple property values include those with a VARTYPE of VT_STORAGE, VT_STREAM, VT_STORED_OBJECT, or VT_STREAMED_OBJECT. If this flag is not specified, non-simple types cannot be written into the property set. In the compound file and stand-alone implementations, property sets may be transacted only if <strong>PROPSETFLAG_NONSIMPLE</strong> is specified.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PROPSETFLAG_ANSI</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->2<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">If specified, all string values in the property set that are not explicitly Unicode, that is, those other than VT_LPWSTR, are stored with the current system ANSI code page. For more information, see <a href="/windows/desktop/api/winnls/nf-winnls-getacp"><strong>GetACP</strong></a>. Use of this value is not recommended. For more information, see Remarks.<!-- raw HTML omitted --> If this value is absent, string values in the new property set are stored in Unicode. The degree of control that this value provides is necessary so that clients using the property-related interfaces can interoperate with standard property sets such as the OLE2 summary information, which may exist in the ANSI code page.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PROPSETFLAG_UNBUFFERED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->4<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">Used only with the <a href="/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg"><strong>StgCreatePropStg</strong></a> and <a href="/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg"><strong>StgOpenPropStg</strong></a> functions; that is, in the stand-alone implementations of property set interfaces. If specified in these functions, changes to the property set are not buffered. Instead, changes are always written directly to the property set. Calls to a property set <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a> methods will change it. However, by default, changes are buffered in an internal property set cache and are subsequently written to the property set when the <a href="/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit"><strong>IPropertyStorage::Commit</strong></a> method is called. <!-- raw HTML omitted --> Setting <strong>PROPSETFLAG_UNBUFFERED</strong> decreases performance because the property set internal buffer is automatically flushed after every change to the property set. However, writing changes directly will prevent coordination problems. For example, if the storage object is opened in transacted mode, and the property set is buffered. Then, if you call the <a href="/windows/desktop/api/Objidl/nf-objidl-istorage-commit"><strong>IStorage::Commit</strong></a> method on the storage object, the property set changes will not be picked up as part of the transaction, because they are in a buffer that has not been flushed yet. You must call <a href="/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit"><strong>IPropertyStorage::Commit</strong></a> prior to calling <strong>IStorage::Commit</strong> to flush the property set buffer before committing changes to the storage. As an alternative to making two calls, you can set <strong>PROPSETFLAG_UNBUFFERED</strong> so that changes are always written directly to the property set and are never buffered in the property set's internal cache. Then, the changes will be picked up when the transacted storage is committed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>PROPSETFLAG_CASE_SENSITIVE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->8<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">If specified, property names are case sensitive. Case-sensitive property names are only possible in the version 1 property set serialization format. For more information, see <a href="version-0-vs--version-1-property-set-serialization.html">Property Set Serialization</a>.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>These values can be set and checked using bitwise operations that determine how property sets are created and opened. Property sets are created using the <a href="/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create"><strong>IPropertySetStorage::Create</strong></a> method or the <a href="/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg"><strong>StgCreatePropStg</strong></a> function. They are opened using the <a href="/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open"><strong>IPropertySetStorage::Open</strong></a> method or the <a href="/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg"><strong>StgOpenPropStg</strong></a> function.</p>
<p>It is recommended that property sets be created as Unicode by not setting the <strong>PROPSETFLAG_ANSI</strong> flag in the <em>grfFlags</em> parameter. It is also recommended that you avoid using VT_LPSTR values, and use VT_LPWSTR values instead. When the property set code page is Unicode, VT_LPSTR string values are converted to Unicode when stored, and converted back to multibyte string values when retrieved. When the code page of the property set is not Unicode, property names, VT_BSTR strings, and nonsimple property values are converted to multibyte strings when stored, and converted back to Unicode when retrieved, all using the current system ANSI code page.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Propidl.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/coml2api/nf-coml2api-fmtidtopropstgname"><strong>FmtIdToPropStgName</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create"><strong>IPropertySetStorage::Create</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open"><strong>IPropertySetStorage::Open</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/coml2api/nf-coml2api-propstgnametofmtid"><strong>PropStgNameToFmtId</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropsetstg"><strong>StgCreatePropSetStg</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg"><strong>StgCreatePropStg</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg"><strong>StgOpenPropStg</strong></a></p>
<!-- raw HTML omitted -->
</body>
