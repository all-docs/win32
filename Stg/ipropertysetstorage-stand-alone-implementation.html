<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IPropertySetStorage-Stand-alone Implementation</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: IPropertySetStorage-Stand-alone Implementation
description: The system-provided, stand-alone implementation of IPropertySetStorage includes an implementation of both IPropertyStorage and IPropertySetStorage.
ms.assetid: 0ea5aadf-0b3f-44ac-9bb7-a7e8292f04c2
keywords:</p>
<ul>
<li>IPropertySetStorage Strctd Stg , implementations</li>
<li>IPropertySetStorage Strctd Stg , implementations, stand-alone
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>IPropertySetStorage-Stand-alone Implementation</h1>
<p>The system-provided, stand-alone implementation of <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> includes an implementation of both <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a> and <strong>IPropertySetStorage</strong>.<a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a> is the interface that reads and writes properties in a property set storage. <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> is the interface that creates and opens property sets in a storage. The <a href="/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg"><strong>IEnumSTATPROPSTG</strong></a> and <a href="/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg"><strong>IEnumSTATPROPSETSTG</strong></a> interfaces are also provided in the stand-alone implementation.</p>
<p>To use the stand-alone implementation of <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a>, first obtain a pointer to the system-provided, stand-alone implementation and associate the system-provided implementation with your storage object. To get a pointer to the stand-alone implementation of <strong>IPropertySetStorage</strong>, call the <a href="/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropsetstg"><strong>StgCreatePropSetStg</strong></a> function and provide the <em>pStorage</em> parameter specifying the storage object that will contain the property set. This function provides a pointer to the new <strong>IPropertySetStorage</strong> interface for the specified storage object.</p>
<p>The stand-alone implementation of <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> creates property sets on any storage object, not just on compound file storages. The stand-alone implementation does not depend on compound files and can be used with any implementation of structured storages. Any restrictions on the caller-provided structured storages apply to this implementation of property sets. For example, if you provide a simple-mode storage to <a href="/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg"><strong>StgOpenPropStg</strong></a>, the resulting <strong>IPropertySetStorage</strong> will be restricted by the supplied <a href="/windows/desktop/api/Objidl/nn-objidl-istorage"><strong>IStorage</strong></a>.</p>
<p>For more information about the compound file implementation of this interface, see the section <a href="ipropertysetstorage-compound-file-implementation.html">IPropertySetStorage-Compound File Implementation</a>.</p>
<h2>When to Use</h2>
<p>Call the methods of <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> to create, open, and delete property sets in any structured storage. There is also a method that supplies a pointer to the <a href="/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg"><strong>IEnumSTATPROPSETSTG</strong></a> enumerator that can be used to enumerate the property sets in the storage.</p>
<p>The stand-alone implementation also provides the <a href="/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg"><strong>StgCreatePropStg</strong></a> and <a href="/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg"><strong>StgOpenPropStg</strong></a> helper functions, in addition to the <a href="/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create"><strong>Create</strong></a> and <a href="/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open"><strong>Open</strong></a> methods, to create and open property sets. These two functions add support for the PROPSETFLAG_UNBUFFERED value so you can write changes directly to the property set instead of buffering them in a cache. For more information, see <a href="propsetflag-constants.html"><strong>PROPSETFLAG Constants</strong></a>.</p>
<h2>Methods</h2>
<p>The stand-alone implementation of <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a> supports the following methods.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create"><strong>IPropertySetStorage::Create</strong></a></p>
<!-- raw HTML omitted -->
<p>Creates a new property set in the storage and returns a pointer to the <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a> interface on the property set.</p>
<p>If you plan to use the PROPSETFLAG_UNBUFFERED value, use the <a href="/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg"><strong>StgCreatePropStg</strong></a> function instead to create and open the new property set and to obtain a pointer to the stand-alone implementation for the <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a> interface on the property set.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open"><strong>IPropertySetStorage::Open</strong></a></p>
<!-- raw HTML omitted -->
<p>Opens an existing property set in the storage and returns a pointer to the <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a> interface on the property set.</p>
<p>If you plan to use the PROPSETFLAG_UNBUFFERED value, use the <a href="/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg"><strong>StgOpenPropStg</strong></a> function instead to obtain a pointer to the stand-alone implementation of <a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a> on the specified property set.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-delete"><strong>IPropertySetStorage::Delete</strong></a></p>
<!-- raw HTML omitted -->
<p>Deletes a property set in this property set storage.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum"><strong>IPropertySetStorage::Enum</strong></a></p>
<!-- raw HTML omitted -->
<p>Creates an object that can be used to enumerate <a href="/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg"><strong>STATPROPSETSTG</strong></a> structures. Each <strong>STATPROPSETSTG</strong> structure provides data about a single property set.</p>
<blockquote>
<p>[!Note]<br />
The DocumentSummaryInformation and UserDefined property set is unique in that it may have two property set sections in a single underlying stream. For more information, see <a href="the-documentsummaryinformation-and-userdefined-property-sets.html">The DocumentSummaryInformation and UserDefined Property Sets</a> .</p>
</blockquote>
<p>Â </p>
<!-- raw HTML omitted -->
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="ipropertystorage-stand-alone-implementation.html">IPropertyStorage-Stand-alone Implementation</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage"><strong>IPropertySetStorage</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Propidl/nn-propidl-ipropertystorage"><strong>IPropertyStorage</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Objidl/nf-objidl-istorage-enumelements"><strong>IStorage::EnumElements</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="propsetflag-constants.html"><strong>PROPSETFLAG Constants</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg"><strong>STATPROPSETSTG</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropsetstg"><strong>StgCreatePropSetStg</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg"><strong>StgCreatePropStg</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg"><strong>StgOpenPropStg</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="stgm-constants.html"><strong>STGM Constants</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
