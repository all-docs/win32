<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ILockBytes - File-Based Implementation</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: ILockBytes - File-Based Implementation
description: Implemented on a byte array object underlying a COM compound file storage object, and designed to read and write directly to a disk file.
ms.assetid: 700b6a3c-1046-4c21-8887-16f344c23510
keywords:</p>
<ul>
<li>ILockBytes Strctd Stg , implementations,file-based
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>ILockBytes - File-Based Implementation</h1>
<p>Implemented on a byte array object underlying a COM compound file storage object, and designed to read and write directly to a disk file.</p>
<h2>When to Use</h2>
<p>Methods of <a href="/windows/desktop/api/Objidl/nn-objidl-ilockbytes"><strong>ILockBytes</strong></a> are called from the compound file implementations of <a href="/windows/desktop/api/Objidl/nn-objidl-istorage"><strong>IStorage</strong></a> and <a href="/windows/desktop/api/Objidl/nn-objidl-istream"><strong>IStream</strong></a> on the compound file storage object created through a call to <a href="/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile"><strong>StgCreateDocfile</strong></a>, so you do not need to call them directly.</p>
<h2>Remarks</h2>
<p>The following are the methods of the <a href="/windows/desktop/api/Objidl/nn-objidl-ilockbytes"><strong>ILockBytes</strong></a> File-Based Implementation.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::ReadAt</strong></p>
<!-- raw HTML omitted -->
<p>Reads a block of bytes from a specified offset at the beginning of the byte-array.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::WriteAt</strong></p>
<!-- raw HTML omitted -->
<p>Writes a block of bytes from a specified offset at the beginning of the byte array.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::Flush</strong></p>
<!-- raw HTML omitted -->
<p>Ensures that any internal buffers maintained by the <a href="/windows/desktop/api/Objidl/nn-objidl-ilockbytes"><strong>ILockBytes</strong></a> implementation are written out to the underlying physical storage.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::SetSize</strong></p>
<!-- raw HTML omitted -->
<p>Sets the size of the byte array.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::LockRegion</strong></p>
<!-- raw HTML omitted -->
<p>The <em>dwLockTypes</em> parameter is set to LOCK_ONLYONCE or LOCK_EXCLUSIVE, which will allow or restrict access to locked regions.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::UnlockRegion</strong></p>
<!-- raw HTML omitted -->
<p>This method unlocks the region locked by <a href="/windows/desktop/api/Objidl/nf-objidl-ilockbytes-lockregion"><strong>ILockBytes::LockRegion</strong></a>.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><strong>ILockBytes::Stat</strong></p>
<!-- raw HTML omitted -->
<p>The COM-provided <a href="/windows/desktop/api/Objidl/nf-objidl-istorage-stat"><strong>IStorage::Stat</strong></a> implementation calls the <a href="/windows/desktop/api/Objidl/nf-objidl-ilockbytes-stat"><strong>ILockBytes::Stat</strong></a> method to retrieve information about the byte array object. If there is no reasonable name for the byte array, the COM-provided <strong>ILockBytes::Stat</strong> method returns <strong>NULL</strong> in the <strong>pwcsName</strong> member of the <a href="/windows/win32/api/objidl/ns-objidl-statstg"><strong>STATSTG</strong></a> structure.</p>
<!-- raw HTML omitted -->
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Objidl/nn-objidl-ilockbytes"><strong>ILockBytes</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Objidl/nn-objidl-istorage"><strong>IStorage</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Objidl/nn-objidl-istream"><strong>IStream</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
