<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>About Strsafe.h</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: About Strsafe.h
description: Poor buffer handling is implicated in many security issues that involve buffer overruns.
ms.assetid: a104a260-1edb-441a-acf8-e2bd3a7d8235
keywords:</p>
<ul>
<li>string functions</li>
<li>Strsafe.h</li>
<li>Strsafe functions
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>About Strsafe.h</h1>
<p>Poor buffer handling is implicated in many security issues that involve buffer overruns. The functions defined in Strsafe.h provide additional processing for proper buffer handling in your code. For this reason, they are intended to replace their built-in C/C++ counterparts as well as specific Windows implementations. Strsafe.h is available in the Windows SDK starting with WindowsÂ XP with Service PackÂ 2 (SP2).</p>
<p>The advantages of the Strsafe functions include:</p>
<ul>
<li>
<p>The size of the destination buffer is always provided to the function to ensure that the function does not write past the end of the buffer.</p>
</li>
<li>
<p>Buffers are guaranteed to be null-terminated, even if the operation truncates the intended result.</p>
</li>
<li>
<p>All functions return an <strong>HRESULT</strong> value, with only one possible success code (<strong>S_OK</strong>).</p>
</li>
<li>
<p>Each function is available in a corresponding character count (&quot;cch&quot;) or byte count (&quot;cb&quot;) version.</p>
</li>
<li>
<p>Most functions have an extended (&quot;Ex&quot;) version available for advanced functionality.</p>
</li>
</ul>
<p>See the following sections for details.</p>
<ul>
<li><a href="#character-count-functions">Character Count Functions</a></li>
<li><a href="#byte-count-functions">Byte Count Functions</a></li>
<li><a href="#using-strsafeh">Using Strsafe.h</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Character Count Functions</h2>
<p>The following functions use a character count rather than a byte count.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Replaces</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchcata"><strong>StringCchCat</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchcatexa"><strong>StringCchCatEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/strcat-wcscat-mbscat">strcat, wcscat, _tcscat</a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Winbase/nf-winbase-lstrcata"><strong>lstrcat</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/shlwapi/nf-shlwapi-strcatw"><strong>StrCat</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/shlwapi/nf-shlwapi-strcatbuffa"><strong>StrCatBuff</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchcatna"><strong>StringCchCatN</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchcatnexa"><strong>StringCchCatNEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/strncat-strncat-l-wcsncat-wcsncat-l-mbsncat-mbsncat-l">strncat</a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/shlwapi/nf-shlwapi-strncata"><strong>StrNCat</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchcopya"><strong>StringCchCopy</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchcopyexa"><strong>StringCchCopyEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/strcpy-wcscpy-mbscpy">strcpy, wcscpy, _tcscpy</a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Winbase/nf-winbase-lstrcpya"><strong>lstrcpy</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/shlwapi/nf-shlwapi-strcpyw"><strong>StrCpy</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchcopyna"><strong>StringCchCopyN</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchcopynexa"><strong>StringCchCopyNEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/strncpy-strncpy-l-wcsncpy-wcsncpy-l-mbsncpy-mbsncpy-l">strncpy, wcsncpy, _tcsncpy</a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchgetsa"><strong>StringCchGets</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchgetsexa"><strong>StringCchGetsEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/gets-getws">gets, _getws, _getts</a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchprintfa"><strong>StringCchPrintf</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchprintfexa"><strong>StringCchPrintfEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/sprintf-sprintf-l-swprintf-swprintf-l-swprintf-l">sprintf, swprintf, _stprintf</a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Winuser/nf-winuser-wsprintfa"><strong>wsprintf</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/shlwapi/nf-shlwapi-wnsprintfa"><strong>wnsprintf</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/snprintf-snprintf-snprintf-l-snwprintf-snwprintf-l">_snprintf, _snwprintf, _sntprintf</a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchvprintfa"><strong>StringCchVPrintf</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchvprintfexa"><strong>StringCchVPrintfEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/vsprintf-vsprintf-l-vswprintf-vswprintf-l-vswprintf-l">vsprintf, vswprintf, _vstprintf</a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/vsnprintf-vsnprintf-vsnprintf-l-vsnwprintf-vsnwprintf-l">vsnprintf, _vsnwprintf, _vsntprintf</a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Winuser/nf-winuser-wvsprintfa"><strong>wvsprintf</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/shlwapi/nf-shlwapi-wvnsprintfa"><strong>wvnsprintf</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted -->,</td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchlengtha"><strong>StringCchLength</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/strlen-wcslen-mbslen-mbslen-l-mbstrlen-mbstrlen-l">strlen, wcslen, _tcslen</a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Byte Count Functions</h2>
<p>The following functions use a byte count rather than a character count.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Replaces</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbcata"><strong>StringCbCat</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbcatexa"><strong>StringCbCatEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/strcat-wcscat-mbscat">strcat, wcscat, _tcscat</a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Winbase/nf-winbase-lstrcata"><strong>lstrcat</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/shlwapi/nf-shlwapi-strcatw"><strong>StrCat</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/shlwapi/nf-shlwapi-strcatbuffa"><strong>StrCatBuff</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbcatna"><strong>StringCbCatN</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbcatnexa"><strong>StringCbCatNEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/strncat-strncat-l-wcsncat-wcsncat-l-mbsncat-mbsncat-l">strncat</a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/shlwapi/nf-shlwapi-strncata"><strong>StrNCat</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbcopya"><strong>StringCbCopy</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbcopyexa"><strong>StringCbCopyEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/strcpy-wcscpy-mbscpy">strcpy, wcscpy, _tcscpy</a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Winbase/nf-winbase-lstrcpya"><strong>lstrcpy</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/shlwapi/nf-shlwapi-strcpyw"><strong>StrCpy</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbcopyna"><strong>StringCbCopyN</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbcopynexa"><strong>StringCbCopyNEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/strncpy-strncpy-l-wcsncpy-wcsncpy-l-mbsncpy-mbsncpy-l">strncpy, wcsncpy, _tcsncpy</a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbgetsa"><strong>StringCbGets</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbgetsexa"><strong>StringCbGetsEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/gets-getws">gets, _getws, _getts</a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbprintfa"><strong>StringCbPrintf</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbprintfexa"><strong>StringCbPrintfEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/sprintf-sprintf-l-swprintf-swprintf-l-swprintf-l">sprintf, swprintf, _stprintf</a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Winuser/nf-winuser-wsprintfa"><strong>wsprintf</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/shlwapi/nf-shlwapi-wnsprintfa"><strong>wnsprintf</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/snprintf-snprintf-snprintf-l-snwprintf-snwprintf-l">_snprintf, _snwprintf, _sntprintf</a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbvprintfa"><strong>StringCbVPrintf</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbvprintfexa"><strong>StringCbVPrintfEx</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/vsprintf-vsprintf-l-vswprintf-vswprintf-l-vswprintf-l">vsprintf, vswprintf, _vstprintf</a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/vsnprintf-vsnprintf-vsnprintf-l-vsnwprintf-vsnwprintf-l">vsnprintf, _vsnwprintf, _vsntprintf</a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Winuser/nf-winuser-wvsprintfa"><strong>wvsprintf</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/shlwapi/nf-shlwapi-wvnsprintfa"><strong>wvnsprintf</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcblengtha"><strong>StringCbLength</strong></a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="/cpp/c-runtime-library/reference/strlen-wcslen-mbslen-mbslen-l-mbstrlen-mbstrlen-l">strlen, wcslen, _tcslen</a><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Using Strsafe.h</h2>
<ul>
<li>
<p>To use the Strsafe functions inline, include the header file as shown here, following the <strong>#include</strong> statements for all other header files.</p>
<p><code>#include &lt;strsafe.h&gt;</code></p>
</li>
<li>
<p>To use the functions in library form, include the following statement before including Strsafe.h. However, it is recommended that you use the inline functions.</p>
<p><code>#define STRSAFE_LIB</code></p>
<blockquote>
<p>[!Note]<br />
: The following functions must be used as inline functions: <a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbgetsa"><strong>StringCbGets</strong></a>, <a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcbgetsexa"><strong>StringCbGetsEx</strong></a>, <a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchgetsa"><strong>StringCchGets</strong></a>, and <a href="/windows/desktop/api/Strsafe/nf-strsafe-stringcchgetsexa"><strong>StringCchGetsEx</strong></a>.</p>
</blockquote>
<p>Â </p>
</li>
<li>
<p>When you include Strsafe.h in your file, the older functions replaced by the Strsafe.h functions will be deprecated. Attempts to use these older functions will result in a compiler error telling you to use the newer functions. If you want to override this behavior, include the following statement before including Strsafe.h.</p>
<p><code>#define STRSAFE_NO_DEPRECATE</code></p>
</li>
<li>
<p>To allow only character count functions, include the following statement before including Strsafe.h.</p>
<p><code>#define STRSAFE_NO_CB_FUNCTIONS</code></p>
</li>
<li>
<p>To allow only byte count functions, include the following statement before including Strsafe.h.</p>
<p><code>#define STRSAFE_NO_CCH_FUNCTIONS</code></p>
<blockquote>
<p>[!Note]<br />
You can define <strong>STRSAFE_NO_CB_FUNCTIONS</strong> or <strong>STRSAFE_NO_CCH_FUNCTIONS</strong>, but not both.</p>
</blockquote>
<p>Â </p>
</li>
<li>
<p>Some Strsafe functions have locale-aware versions. By default, the header does not declare these functions. To enable these declarations, include the following macro statement before including Strsafe.h.</p>
<p><code>#define STRSAFE_LOCALE_FUNCTIONS</code></p>
</li>
<li>
<p>The maximum supported string length is 2,147,483,647 (<strong>STRSAFE_MAX_CCH</strong>) characters, either ANSI or Unicode.</p>
</li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="string-overviews.html">Strsafe Functions</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
