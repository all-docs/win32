<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>FINDMSGSTRING message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: FINDMSGSTRING message (Commdlg.h)
description: A Find or Replace dialog box sends the FINDMSGSTRING registered message to the window procedure of its owner window when the user clicks the Find Next, Replace, or Replace All button, or closes the dialog box.
ms.assetid: ed0b256a-96df-4588-b8f3-f7d1f89ffe74
keywords:</p>
<ul>
<li>FINDMSGSTRING message Dialog Boxes
topic_type:</li>
<li>apiref
api_name:</li>
<li>FINDMSGSTRING</li>
<li>FINDMSGSTRINGA</li>
<li>FINDMSGSTRINGW
api_location:</li>
<li>Commdlg.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>FINDMSGSTRING message</h1>
<p>A <strong>Find</strong> or <strong>Replace</strong> dialog box sends the <strong>FINDMSGSTRING</strong> registered message to the window procedure of its owner window when the user clicks the <strong>Find Next</strong>, <strong>Replace</strong>, or <strong>Replace All</strong> button, or closes the dialog box.</p>
<pre lang="C++"><code>#define FINDMSGSTRING TEXT(&quot;commdlg_FindReplace&quot;)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>This parameter is not used.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>A pointer to a <a href="/windows/win32/api/commdlg/ns-commdlg-findreplacea"><strong>FINDREPLACE</strong></a> structure. The members of this structure contain the latest user input, including the string to search for, the replacement string (if any) and the search-and-replacement options.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This message has no return value.</p>
<h2>Remarks</h2>
<p>You must specify the <strong>FINDMSGSTRING</strong> constant in a call to the <a href="/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea"><strong>RegisterWindowMessage</strong></a> function to get the identifier for the message sent by the dialog box.</p>
<p>When you create the dialog box, use the <strong>hwndOwner</strong> member of the <a href="/windows/win32/api/commdlg/ns-commdlg-findreplacea"><strong>FINDREPLACE</strong></a> structure to identify the window to receive <strong>FINDMSGSTRING</strong> messages.</p>
<p>The <strong>Flags</strong> member of the <a href="/windows/win32/api/commdlg/ns-commdlg-findreplacea"><strong>FINDREPLACE</strong></a> structure includes one of the following flags to indicate the event that caused the message.</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>FR_DIALOGTERM</strong> (0x00000040)</td>
<td>The dialog box is closing. After the owner window processes this message, a handle to the dialog box is no longer valid.</td>
</tr>
<tr>
<td><strong>FR_FINDNEXT</strong> (0x00000008)</td>
<td>The user clicked the <strong>Find Next</strong> button in a <strong>Find</strong> or <strong>Replace</strong> dialog box. The <strong>lpstrFindWhat</strong> member specifies the string to search for.</td>
</tr>
<tr>
<td><strong>FR_REPLACE</strong> (0x00000010)</td>
<td>The user clicked the <strong>Replace</strong> button in a <strong>Replace</strong> dialog box. The <strong>lpstrFindWhat</strong> member specifies the string to replace and the <strong>lpstrReplaceWith</strong> member specifies the replacement string.</td>
</tr>
<tr>
<td><strong>FR_REPLACEALL</strong> (0x00000020)</td>
<td>The user clicked the <strong>Replace All</strong> button in a <strong>Replace</strong> dialog box. The <strong>lpstrFindWhat</strong> member specifies the string to replace and the <strong>lpstrReplaceWith</strong> member specifies the replacement string.</td>
</tr>
</tbody>
</table>
<p>For a <strong>Find Next</strong> or <strong>Replace All</strong> message, the <strong>Flags</strong> member can include one or more of the following flags to indicate the search options.</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>FR_DOWN</strong> (0x00000001)</td>
<td>If set, the <strong>Down</strong> button of the direction radio buttons is selected indicating that user wants to search from the current location to the end of the document. If <strong>FR_DOWN</strong> is not set, the <strong>Up</strong> button is selected so the user wants to search to the beginning of the document.</td>
</tr>
<tr>
<td><strong>FR_MATCHCASE</strong> (0x00000004)</td>
<td>If set, the <strong>Match Case</strong> check box is selected indicating that the user wants the search to be case-sensitive. If <strong>FR_MATCHCASE</strong> is not set, the check box is unselected so the search should be case-insensitive.</td>
</tr>
<tr>
<td><strong>FR_WHOLEWORD</strong> (0x00000002)</td>
<td>If set, the <strong>Match Whole Word Only</strong> check box is selected indicating that the user wants to search only for whole words that match the search string. If <strong>FR_WHOLEWORD</strong> is not set, the check box is unselected so you should also search for word fragments that match the search string.</td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Commdlg.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Unicode and ANSI names<!-- raw HTML omitted --></td>
<td><strong>FINDMSGSTRINGW</strong> (Unicode) and <strong>FINDMSGSTRINGA</strong> (ANSI)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/commdlg/ns-commdlg-findreplacea"><strong>FINDREPLACE</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea"><strong>RegisterWindowMessage</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="common-dialog-box-library.html">Common Dialog Box Library</a></p>
<!-- raw HTML omitted -->
</body>
