<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>WM_PSD_PAGESETUPDLG message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: WM_PSD_PAGESETUPDLG message (Commdlg.h)
description: Notifies a PagePaintHook hook procedure that the Page Setup dialog box is about to draw the contents of the sample page. The hook procedure can use this message to carry out initialization tasks related to drawing the contents of the sample page.
ms.assetid: 0d95240b-7d77-4819-8e5c-cc25cd1b30f2
keywords:</p>
<ul>
<li>WM_PSD_PAGESETUPDLG message Dialog Boxes
topic_type:</li>
<li>apiref
api_name:</li>
<li>WM_PSD_PAGESETUPDLG
api_location:</li>
<li>Commdlg.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>WM_PSD_PAGESETUPDLG message</h1>
<p>Notifies a <a href="/windows/win32/api/commdlg/nc-commdlg-lppagepainthook"><strong>PagePaintHook</strong></a> hook procedure that the <strong>Page Setup</strong> dialog box is about to draw the contents of the sample page. The hook procedure can use this message to carry out initialization tasks related to drawing the contents of the sample page.</p>
<pre lang="C++"><code>#define WM_USER                  0x0400
#define WM_PSD_PAGESETUPDLG     (WM_USER  )
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>The low-order word specifies a value that indicates the paper size. This value can be one of the <strong>DMPAPER_</strong> values listed in the description of the structure. The high-order word specifies the orientation of the paper or envelope, and whether the printer is a dot matrix or HPPCL (Hewlett Packard Printer Control Language) device. This parameter can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0001<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Paper in landscape mode (dot matrix)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0003<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Paper in landscape mode (HPPCL)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0005<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Paper in portrait mode (dot matrix)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0007<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Paper in portrait mode (HPPCL)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x000b<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Envelope in landscape mode (HPPCL)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x000d<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Envelope in portrait mode (dot matrix)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0019<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Envelope in landscape mode (dot matrix)<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x001f<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Envelope in portrait mode (HPPCL)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>A pointer to a <a href="/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga"><strong>PAGESETUPDLG</strong></a> structure that contains information used to initialize the <strong>Page Setup</strong> dialog box.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the hook procedure returns <strong>TRUE</strong>, the dialog box sends no more messages and does not draw in the sample page until the next time the system needs to redraw the sample page.</p>
<p>If the hook procedure returns <strong>FALSE</strong>, the dialog box sends the remaining messages of the drawing sequence.</p>
<h2>Remarks</h2>
<p>The <strong>Page Setup</strong> dialog box includes an image of a sample page that shows how the user's selections affect the appearance of the printed output. When you call the <a href="/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)"><strong>PageSetupDlg</strong></a> function, you can provide a <a href="/windows/win32/api/commdlg/nc-commdlg-lppagepainthook"><em>PagePaintHook</em></a> hook procedure to customize the appearance of the sample page. Whenever the dialog box is about to draw the contents of the sample page, the dialog box sends a sequence of messages to the hook procedure.</p>
<p>The first three messages of a drawing sequence (<strong>WM_PSD_PAGESETUPDLG</strong>, <a href="wm-psd-fullpagerect.html"><strong>WM_PSD_FULLPAGERECT</strong></a>, or <a href="wm-psd-minmarginrect.html"><strong>WM_PSD_MINMARGINRECT</strong></a>) provide information that the hook procedure can use to draw the contents of the sample page. The remaining messages (<a href="wm-psd-marginrect.html"><strong>WM_PSD_MARGINRECT</strong></a>, <a href="wm-psd-greektextrect.html"><strong>WM_PSD_GREEKTEXTRECT</strong></a>, <a href="wm-psd-envstamprect.html"><strong>WM_PSD_ENVSTAMPRECT</strong></a>, <a href="wm-psd-yafullpagerect.html"><strong>WM_PSD_YAFULLPAGERECT</strong></a>) notify the hook procedure that the dialog box is about to draw a specific portion of the sample page. This allows the hook procedure to selectively draw portions of the sample page.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Commdlg.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/commdlg/nc-commdlg-lppagepainthook"><em>PagePaintHook</em></a></p>
<!-- raw HTML omitted -->
<p><a href="/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)"><strong>PageSetupDlg</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga"><strong>PAGESETUPDLG</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="wm-psd-envstamprect.html"><strong>WM_PSD_ENVSTAMPRECT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="wm-psd-fullpagerect.html"><strong>WM_PSD_FULLPAGERECT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="wm-psd-greektextrect.html"><strong>WM_PSD_GREEKTEXTRECT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="wm-psd-marginrect.html"><strong>WM_PSD_MARGINRECT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="wm-psd-minmarginrect.html"><strong>WM_PSD_MINMARGINRECT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="wm-psd-yafullpagerect.html"><strong>WM_PSD_YAFULLPAGERECT</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="common-dialog-box-library.html">Common Dialog Box Library</a></p>
<!-- raw HTML omitted -->
</body>
