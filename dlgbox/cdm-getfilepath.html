<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CDM_GETFILEPATH message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: CDM_GETFILEPATH message (Commdlg.h)
description: Retrieves the path and file name of the selected file in an Explorer-style Open or Save As dialog box.
ms.assetid: fad8c5e2-9838-45a8-8c51-4326c989d939
keywords:</p>
<ul>
<li>CDM_GETFILEPATH message Dialog Boxes
topic_type:</li>
<li>apiref
api_name:</li>
<li>CDM_GETFILEPATH
api_location:</li>
<li>Commdlg.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>CDM_GETFILEPATH message</h1>
<p>[Starting with Windows Vista, the <strong>Open</strong> and <strong>Save As</strong> common dialog boxes have been superseded by the <a href="../shell/common-file-dialog.html">Common Item Dialog</a>. We recommended that you use the Common Item Dialog API instead of these dialog boxes from the Common Dialog Box Library.]</p>
<p>Retrieves the path and file name of the selected file in an Explorer-style <strong>Open</strong> or <strong>Save As</strong> dialog box. The dialog box must have been created with the <strong>OFN_EXPLORER</strong> flag; otherwise, the message fails.</p>
<pre lang="C++"><code>#define WM_USER                  0x0400
#define CDM_FIRST               (WM_USER + 100)
#define CDM_GETFILEPATH         (CDM_FIRST + 0x0001)
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>The size, in characters, of the <em>lParam</em> buffer. For the ANSI version, this is the number of bytes; for the Unicode version, this is the number of characters.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>A pointer to the buffer that receives the file name and path.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the message succeeds, the return value is the size, in characters, of the file name and path string, including the terminating NULL character. This is either the number of bytes or characters copied to the buffer, or the required buffer size if the buffer is too small.</p>
<p>If an error occurs, the return value is less than zero.</p>
<h2>Remarks</h2>
<p>The corresponding macro is as follows:</p>
<pre lang="syntax"><code>int CommDlg_OpenSave_GetFilePath(hwnd, lparam, wparam); 
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Commdlg.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea"><strong>GetOpenFileName</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea"><strong>GetSaveFileName</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/commdlg/ns-commdlg-openfilenamea"><strong>OPENFILENAME</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="common-dialog-box-library.html">Common Dialog Box Library</a></p>
<!-- raw HTML omitted -->
</body>
