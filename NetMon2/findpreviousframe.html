<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>FindPreviousFrame function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The FindPreviousFrame function finds the previous frame in the current capture context that matches the filter.
ms.assetid: 16c5b981-a9f4-41e5-bb97-2caa3e9d8512
title: FindPreviousFrame function (Netmon.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>FindPreviousFrame
api_type:</li>
<li>DllExport
api_location:</li>
<li>Nmapi.dll</li>
</ul>
<hr />
<h1>FindPreviousFrame function</h1>
<p>The <strong>FindPreviousFrame</strong> function finds the previous frame in the current capture context that matches the filter.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HFRAME WINAPI FindPreviousFrame(
   HFRAME    hCurrentFrame,
   LPSTR     ProtocolName,
   LPADDRESS DestinationAddress,
   LPADDRESS SourceAddress,
   LPWORD    ProtocolOffset,
   DWORD     OriginalFrameNumber,
   DWORD     LowestFrame
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hCurrentFrame</em></p>
<!-- raw HTML omitted -->
<p>Handle to the frame.</p>
<!-- raw HTML omitted -->
<p><em>ProtocolName</em></p>
<!-- raw HTML omitted -->
<p>Protocol name, such as TCP.</p>
<!-- raw HTML omitted -->
<p><em>DestinationAddress</em></p>
<!-- raw HTML omitted -->
<p>Destination address of the frame that is searched for.</p>
<!-- raw HTML omitted -->
<p><em>SourceAddress</em></p>
<!-- raw HTML omitted -->
<p>Source address of the frame that is searched for.</p>
<!-- raw HTML omitted -->
<p><em>ProtocolOffset</em></p>
<!-- raw HTML omitted -->
<p>Pointer to a <strong>WORD</strong> that receives the protocol offset.</p>
<!-- raw HTML omitted -->
<p><em>OriginalFrameNumber</em></p>
<!-- raw HTML omitted -->
<p>Starting point of the search. By default, this function searches backward 1,000 frames from <em>OriginalFrameNumber</em> starting point. You can change the search-back distance by adding this line to the Nmapi.ini file, which is located in the \Network Monitor directory.</p>
<p>MAXLOOKBACK=&lt;new lookback distance&gt;</p>
<!-- raw HTML omitted -->
<p><em>LowestFrame</em></p>
<!-- raw HTML omitted -->
<p>Lowest frame number in the capture that is searched.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function is successful, the return value is a handle to the previous frame.</p>
<p>If the function is not successful, the return value is <strong>NULL</strong>.</p>
<h2>Remarks</h2>
<p>The capture filter is defined primarily by <em>ProtocolName</em>, which is the only required filter input; you can add <em>DestinationAddress</em> and <em>SourceAddress</em> information to increase the capture speed.</p>
<p><em>ProtocolOffset</em> is returned to the calling parser, which adds this <strong>DWORD</strong> to the pointer returned by locking the frame (with <a href="parsertemporarylockframe.html">ParserTemporaryLockFrame</a>) to get the LPBYTE of the protocol that is being searched for. On return, the HFRAME that passed the filter is given to the parser. If the parser finds that the frame is not the one that is being sought, the parser can hand this HFRAME back to the <strong>FindPreviousFrame</strong> function to retrieve the next frame. The source and destination addresses, which are not required, can be passed in as <strong>NULL</strong>. When used, these addresses can be of type ADDRESS_TYPE_IP, and so on, not just MAC types.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Netmon.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Nmapi.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Nmapi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
