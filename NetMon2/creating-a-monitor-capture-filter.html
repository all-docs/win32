<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Creating a Monitor Capture Filter</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Creating a capture filter that works with Network Monitor is a five-step process.
ms.assetid: 04be791c-43c5-44c2-8ab0-799a99974bf6
title: Creating a Monitor Capture Filter
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Creating a Monitor Capture Filter</h1>
<p>Creating a capture filter that works with Network Monitor is a five-step process:</p>
<ul>
<li><a href="writing-etypesap-filter-portion.html">Setting the Etype or SAP Filter</a></li>
<li><a href="writing-addresstable-filter-portion.html">Writing ADDRESSTABLE Filter</a></li>
<li><a href="writing-the-patternmatch-filter.html">Writing the PATTERNMATCH Filter</a></li>
<li><a href="clipping-a-frame.html">Clipping a Frame</a></li>
<li><a href="implementing-the-capture-filter-code.html">Implementing the Capture Filter Code</a></li>
</ul>
<p>A <a href="c.html"><em>capture filter</em></a> is a series of additions to the NPP BLOB that selects which frames are passed back to the monitor. If a monitor does not alter the NPP BLOB, then the NPP will go into promiscuous mode and send all network traffic to the monitor. The NPP is most efficient if it can reduce the data handed up to a driver, so a monitor should create a capture filter. A monitor sets its capture filter by writing to the NPP BLOB in the call to the <a href="imonitor-doconfigure.html">DoConfigure</a> function. The MCSVC then calls the NPP with the NPP BLOB. See <a href="capture-filters.html">Capture Filters</a> for more details on the capture filter, <a href="network-packet-providers.html">Network Packet Providers</a> on NPPs, and <a href="network-monitor-blobs.html">Network Monitor Blobs</a> on BLOB functions.</p>
<p>Â </p>
<p>Â </p>
</body>
