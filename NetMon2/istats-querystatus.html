<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IStats::QueryStatus method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: IStats::QueryStatus method - The QueryStatus method retrieves the status of the NPP.
ms.assetid: 86b1c1ee-3a35-4603-9e93-fe09f886c32f
title: IStats::QueryStatus method (Netmon.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>IStats.QueryStatus
api_type:</li>
<li>COM
api_location:</li>
<li>Ndisnpp.dll</li>
<li>Rmtnpp.dll</li>
</ul>
<hr />
<h1>IStats::QueryStatus method</h1>
<p>The <strong>QueryStatus</strong> method retrieves the status of the NPP.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT STDMETHODCALLTYPE QueryStatus(
  [out] NETWORKSTATUS *pNetworkStatus
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>pNetworkStatus</em> [out]</p>
<!-- raw HTML omitted -->
<p>Pointer to a returned <a href="networkstatus.html">NETWORKSTATUS</a> structure that indicates the current state (capturing, paused, stopped, and so on) of the NPP. It is the application's responsibility to allocate and free the memory for the <strong>NETWORKSTATUS</strong> structure.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the method is successful, the return value is NMERR_SUCCESS.</p>
<p>If the method is unsuccessful, the return value is the following error code:</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>NMERR_INVALID_PARAMETER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <em>pNetworkStatus</em> parameter is not pointing to a valid <a href="networkstatus.html">NETWORKSTATUS</a> structure. Allocate memory for this structure and call the <strong>IStats::QueryStatus</strong> method again.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>This method can be called at any time after the <a href="createnppinterface.html">CreateNPPInterface</a> method is called. It can be called to see if the NPP is connected to the network, to find out the status of the current capture, and to see if any triggers are pending. Before calling this method, however, you must allocate the memory needed for the <a href="networkstatus.html">NETWORKSTATUS</a> structure and free that memory when the structure is no longer needed.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Netmon.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Ndisnpp.dll; <!-- raw HTML omitted --> <!-- raw HTML omitted -->Rmtnpp.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="istats.html">IStats</a></p>
<!-- raw HTML omitted -->
<p><a href="createnppinterface.html">CreateNPPInterface</a></p>
<!-- raw HTML omitted -->
<p><a href="networkstatus.html">NETWORKSTATUS</a></p>
<!-- raw HTML omitted -->
</body>
