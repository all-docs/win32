<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DllMain Parser callback function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The DllMain export function for the parser identifies the existence of the parser, and releases resources that Network Monitor uses for the parser. DllMain must be implemented in all parser DLLs.
ms.assetid: 2ce79d49-3aad-461f-99cf-cf632680efcc
title: DllMain Parser callback function (Process.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>DllMain
api_type:</li>
<li>UserDefined
api_location:</li>
<li>process.h</li>
</ul>
<hr />
<h1>DllMain Parser callback function</h1>
<p>The <strong>DllMain</strong> export function for the parser identifies the existence of the parser, and releases resources that Network Monitor uses for the parser. <strong>DllMain</strong> must be implemented in all parser DLLs.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>BOOL WINAPI DllMain(
  _In_ HANDLE hInstance,
  _In_ ULONG  Command,
       LPVOID Reserved
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hInstance</em> [in]</p>
<!-- raw HTML omitted -->
<p>Handle to an instance of the parser.</p>
<!-- raw HTML omitted -->
<p><em>Command</em> [in]</p>
<!-- raw HTML omitted -->
<p>Indicator to determine why the function is called. For a list of all possible flags, see <a href="/windows/desktop/Dlls/dllmain">DllMain</a>. The parser implementation must process the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DLL_PROCESS_ATTACH</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>When <strong>DllMain</strong> is called for the first time, the DLL must call <a href="createprotocol.html">CreateProtocol</a> to provide information to Network Monitor. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DLL_PROCESS_DETACH</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>When <strong>DllMain</strong> is called for the last time, the DLL must call <a href="destroyprotocol.html">DestroyProtocol</a> to release the resources that the DLL uses. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>Reserved</em></p>
<!-- raw HTML omitted -->
<p>Not used now.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>The parser DLL always returns <strong>TRUE</strong>.</p>
<h2>Remarks</h2>
<p>The operating system calls <strong>DllMain</strong> to load and unload the parser DLL. This function is based on the dynamic-link library <a href="/windows/desktop/Dlls/dllmain">DllMain</a> function.</p>
<p>You can also use the implementation of <strong>DllMain</strong> to store an instance of a parser for use in the future. For example, you can store a parser DLL instance, and then use it for a system call in the future.</p>
<table>
<thead>
<tr>
<th>For information on</th>
<th>See</th>
</tr>
</thead>
<tbody>
<tr>
<td>What parsers are, and how they work with Network Monitor.</td>
<td><a href="parsers.html">Parsers</a></td>
</tr>
<tr>
<td>Which entry points are included in the parser DLL.</td>
<td><a href="parser-dll-architecture.html">Parser DLL Architecture</a></td>
</tr>
<tr>
<td>How to implement <strong>DllMain</strong>  includes an example.</td>
<td><a href="implementing-dllmain-parser.html">Implementing DllMain</a></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Process.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="createprotocol.html">CreateProtocol</a></p>
<!-- raw HTML omitted -->
<p><a href="destroyprotocol.html">DestroyProtocol</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/Dlls/dllmain">DllMain</a></p>
<!-- raw HTML omitted -->
</body>
