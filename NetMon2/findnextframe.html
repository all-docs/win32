<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>FindNextFrame function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Finds the next frame in the current capture context that matches the filter.
ms.assetid: cc99b4a0-b6b0-43b4-8121-0e402d024009
title: FindNextFrame function (Netmon.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>FindNextFrame
api_type:</li>
<li>DllExport
api_location:</li>
<li>Nmapi.dll</li>
</ul>
<hr />
<h1>FindNextFrame function</h1>
<p>The <strong>FindNextFrame</strong> function finds the next frame in the current capture context that matches the filter.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HFRAME WINAPI FindNextFrame(
   HFRAME    hCurrentFrame,
   LPSTR     ProtocolName,
   LPADDRESS DestinationAddress,
   LPADDRESS SourceAddress,
   LPWORD    ProtocolOffset,
   DWORD     OriginalFrameNumber,
   DWORD     HighestFrame
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hCurrentFrame</em></p>
<!-- raw HTML omitted -->
<p>A handle to the frame.</p>
<!-- raw HTML omitted -->
<p><em>ProtocolName</em></p>
<!-- raw HTML omitted -->
<p>The protocol name, such as TCP.</p>
<!-- raw HTML omitted -->
<p><em>DestinationAddress</em></p>
<!-- raw HTML omitted -->
<p>The destination address.</p>
<!-- raw HTML omitted -->
<p><em>SourceAddress</em></p>
<!-- raw HTML omitted -->
<p>The source address.</p>
<!-- raw HTML omitted -->
<p><em>ProtocolOffset</em></p>
<!-- raw HTML omitted -->
<p>A pointer to a <strong>WORD</strong> that will receive the protocol offset.</p>
<!-- raw HTML omitted -->
<p><em>OriginalFrameNumber</em></p>
<!-- raw HTML omitted -->
<p>The starting point of the search. By default, this function searches forward 1,000 frames from the <em>OriginalFrameNumber</em> starting point. To change the search-forward distance, add this line to the Nmapi.ini file, located in the \Network Monitor directory.</p>
<p>MAXLOOKBACK=&lt;new lookforward distance&gt;</p>
<!-- raw HTML omitted -->
<p><em>HighestFrame</em></p>
<!-- raw HTML omitted -->
<p>The highest frame number in the capture that is searched.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function is successful, the return value is a handle to the next frame.</p>
<p>If the function is not successful, the return value is <strong>NULL</strong>.</p>
<h2>Remarks</h2>
<p>The capture filter is defined primarily by the <em>ProtocolName</em> parameter, which is the only required filter input; you can add <em>DestinationAddress</em> and <em>SourceAddress</em> data to increase the capture speed.</p>
<p>The <em>ProtocolOffset</em> pointer is returned to the calling parser, which adds the <strong>WORD</strong> to the pointer returned by locking the frame (with <a href="parsertemporarylockframe.html">ParserTemporaryLockFrame</a>) to get the <strong>LPBYTE</strong> of the protocol searched for. On return, the HFRAME that passed the filter is given to the parser. If the parser finds that this frame is not the one sought, the parser can hand the HFRAME back to the <strong>FindNextFrame</strong> function to get the next frame. The source and destination addresses are not required and can be passed as <strong>NULL</strong>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Netmon.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Nmapi.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Nmapi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
