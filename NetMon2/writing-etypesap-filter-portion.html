<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Writing Etype/SAP Filter Portion</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The Etype/SAP portion of the capture filter notifies the Network Monitor driver to accept frames that have a specific combination of Etypes and service access points (SAPs).
ms.assetid: 57dcf1cd-f27f-4bd3-a5a8-9e978a2d213e
title: Writing Etype/SAP Filter Portion
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Writing Etype/SAP Filter Portion</h1>
<p>The Etype/SAP portion of the capture filter notifies the Network Monitor driver to accept frames that have a specific combination of Etypes and <a href="s.html"><em>service access points</em></a> (SAPs). Etypes and SAPs are both ways that low-level protocols such as Ethernet, LLC, and Snap indicate which protocol follows them. Specifically:</p>
<ul>
<li>Ethernet specifies an Etype</li>
<li>LLC specifies a SAP</li>
<li>Snap specifies an Etype</li>
</ul>
<h2>Etype/SAP Capture Filter Flags</h2>
<p>Use the following information to set the flags in the <strong>FilterFlags</strong> member of the <a href="capturefilter.html"><strong>CAPTUREFILTER</strong></a> structure.</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>CAPTUREFILTER_ FLAGS_INCLUDE_ ALL_SAPS</td>
<td>Passes all SAP values and notifies the driver that all SAP values are valid. If combined with any values in the <strong>lpSapTable</strong> member, this flag notifies the driver that all SAP values except those in the <strong>lpSapTable</strong> are valid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>CAPTUREFILTER_ FLAGS_INCLUDE_ ALL_ETYPES</td>
<td>Passes all Etype values and notifies the driver that all Etype values are valid. If combined with any values in the <strong>lpEtypeTable</strong> member, this flag notifies the driver that all Etype values except those in the <strong>lpEtypeTable</strong> are valid.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>CAPTUREFILTER_ FLAGS_LOCAL_ONLY</td>
<td>Setting this flag will not set a NIC to P-Mode. You will only see local traffic (any frames to the local machine).</td>
</tr>
<tr>
<td>CAPTUREFILTER_ FLAGS_KEEP_RAW</td>
<td>Keeps SMT and Token Ring MAC frames.</td>
</tr>
</tbody>
</table>
<h2>Etype/SAP Capture Filter Settings</h2>
<p>Use the following information to set the <strong>lpSapTable</strong> and <strong>lpEtypeTable</strong> members of the <a href="capturefilter.html"><strong>CAPTUREFILTER</strong></a> structure.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>lpSapTable</strong></td>
<td>Lists the SAP values that you want the driver to pass. This list tells the Network Monitor driver to validate any frame that contains a match. If CAPTUREFILTER_FLAGS_INCLUDE_ALL_SAPS is set, this becomes an exception list (if found, do not pass).</td>
</tr>
<tr>
<td><strong>lpEtypeTable</strong></td>
<td>Lists the Etype values that you want the Network Monitor driver to pass. This list alone tells the driver to validate any frame that contains a match. If CAPTUREFILTER_FLAGS_INCLUDE_ALL_ETYPES is set, this becomes an exception list (if found, do not pass).</td>
</tr>
</tbody>
</table>
</body>
