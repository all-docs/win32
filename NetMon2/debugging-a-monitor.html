<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Debugging a Monitor</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The following procedure demonstrates how to debug a monitor.
ms.assetid: 499f409c-e25a-4ab3-b0aa-e6b308fc7169
title: Debugging a Monitor
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Debugging a Monitor</h1>
<p>The following procedure demonstrates how to debug a monitor.</p>
<p><strong>To debug a monitor</strong></p>
<ol>
<li>
<p>Install the monitor DLL and the program database (.pdb) file generated when you compiled the monitor in the correct location. See <a href="installing-a-monitor-to-network-monitor.html">Installing a Monitor to Network Monitor</a> for further details.</p>
</li>
<li>
<p>Verify that the Monitor Control Service is configured as a server instead of a service by selecting Control Panel, Services.</p>
</li>
<li>
<p>Open a command prompt and go to the Network Monitor directory. Type:</p>
<p><strong>Mcsvc.exe /RegServer</strong></p>
<p>After the monitor debugging session is complete, you can return the MCSVC to its default condition by typing:</p>
<p><strong>Mcsvc.exe /Service</strong></p>
</li>
<li>
<p>In Microsoft Visual Studio, launch Microsoft Visual C++.</p>
</li>
<li>
<p>From the <strong>File</strong>, <strong>Open</strong> menu option, select the name of your monitor DLL.</p>
</li>
<li>
<p>After Microsoft Visual C++ loads, click <strong>Project</strong>, <strong>Settings</strong>.</p>
</li>
<li>
<p>Click the <strong>Debug</strong> tab under <strong>Executable</strong> for debug session and type the full path of Mcsvc.exe. For example, C:\Program files\Netmon2\Mcsvc.exe.</p>
</li>
<li>
<p>Set the breakpoints in the code.</p>
</li>
</ol>
<blockquote>
<p>[!Note]<br />
Do not use a message box for monitor debugging. If the MCSVC is running as a service, you will not see the popup, and MCSVC will appear to hang.</p>
</blockquote>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
