<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Guidelines for porting Mobile Broadband Win32 APIs to Windows Runtime APIs</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This section contains the reference material on porting the deprecated Mobile Broadband Win32 APIs to the equivalent Windows Runtime APIs.
title: Guidelines for porting Mobile Broadband Win32 APIs to Windows Runtime APIs
ms.topic: reference
ms.date: 08/23/2021</h2>
<h1>Guidelines for porting Mobile Broadband Win32 APIs to Windows Runtime APIs</h1>
<p>This table lists equivalent Windows Runtime functionality for the deprecated Mobile Broadband Win32 APIs.</p>
<table>
<thead>
<tr>
<th><strong>IMbnConnection</strong></th>
<th>Equivalent Windows Runtime functionality</th>
</tr>
</thead>
<tbody>
<tr>
<td>Connect</td>
<td>ConnectivityManager.AcquireConnectionAsync</td>
</tr>
<tr>
<td>Disconnect</td>
<td>ConnectionSession.Close</td>
</tr>
<tr>
<td>get_InterfaceID</td>
<td>MobileBroadbandAccount.NetworkAccountId</td>
</tr>
<tr>
<td>GetActivationNetworkError</td>
<td>MobileBroadbandNetwork.ActivationNetworkError</td>
</tr>
<tr>
<td>GetConnectionState</td>
<td>WwanConnectionProfileDetails.GetNetworkRegistrationState</td>
</tr>
<tr>
<td>GetVoiceCallState</td>
<td>MobileBroadbandNetwork.GetVoiceCallSupport, PhoneCallManager.IsCallActive</td>
</tr>
<tr>
<td><strong>IMbnConnectionEvents</strong></td>
<td></td>
</tr>
<tr>
<td>OnConnectComplete</td>
<td>NetworkStateChangeEventDetails.HasNewWwanRegistrationState â€“ After notification, the current registration state can be retrieved from WwanConnectionProfileDetails.GetNetworkRegistrationState.</td>
</tr>
<tr>
<td>OnConnectStateChange</td>
<td>NetworkStateChangeEventDetails.HasNewWwanRegistrationState â€“ After notification, the current registration state can be retrieved from WwanConnectionProfileDetails.GetNetworkRegistrationState.</td>
</tr>
<tr>
<td>OnDisconnectComplete</td>
<td>NetworkStateChangeEventDetails.HasNewWwanRegistrationState â€“ After notification, the current registration state can be retrieved from WwanConnectionProfileDetails.GetNetworkRegistrationState.</td>
</tr>
<tr>
<td>OnVoiceCallStateChange</td>
<td>PhoneCallManager.CallStateChanged</td>
</tr>
<tr>
<td><strong>IMbnConnectionProfile</strong></td>
<td></td>
</tr>
<tr>
<td>Delete</td>
<td>ConnectionProfile.TryDeleteAsync</td>
</tr>
<tr>
<td>GetConnectionProfile</td>
<td>NetworkAdapter.GetConnectedProfileAsync</td>
</tr>
<tr>
<td>GetConnectionProfiles</td>
<td>NetworkInformation.GetConnectionProfiles</td>
</tr>
<tr>
<td><strong>IMbnDeviceService</strong></td>
<td></td>
</tr>
<tr>
<td>CloseCommandSession</td>
<td>MobileBroadbandDeviceServiceCommandSession.CloseSession</td>
</tr>
<tr>
<td>CloseDataSession</td>
<td>MobileBroadbandDeviceServiceDataSession.CloseSession</td>
</tr>
<tr>
<td>get_DeviceServiceID</td>
<td>MobileBroadbandDeviceService.DeviceServiceId</td>
</tr>
<tr>
<td>OpenCommandSession</td>
<td>MobileBroadbandDeviceService.OpenCommandSession</td>
</tr>
<tr>
<td>OpenDataSession</td>
<td>MobileBroadbandDeviceService.OpenDataSession</td>
</tr>
<tr>
<td>QueryCommand</td>
<td>MobileBroadbandDeviceServiceCommandSession.SendQueryCommandAsync</td>
</tr>
<tr>
<td>QuerySupportedCommands</td>
<td>MobileBroadbandDeviceService.SupportedCommands</td>
</tr>
<tr>
<td>SetCommand</td>
<td>MobileBroadbandDeviceServiceCommandSession.SendSetCommandAsync</td>
</tr>
<tr>
<td>WriteData</td>
<td>MobileBroadbandDeviceServiceDataSession.WriteDataAsync</td>
</tr>
<tr>
<td><strong>IMbnDeviceServicesContext</strong></td>
<td></td>
</tr>
<tr>
<td>EnumerateDeviceServices</td>
<td>MobileBroadbandDeviceService.SupportedCommands</td>
</tr>
<tr>
<td>get_MaxCommandSize</td>
<td>MobileBroadbandModem.MaxDeviceServiceCommandSizeInBytes</td>
</tr>
<tr>
<td>get_MaxDataSize</td>
<td>MobileBroadbandModem.MaxDeviceServiceDataSizeInByte</td>
</tr>
<tr>
<td>GetDeviceService</td>
<td>MobileBroadbandModem.GetDeviceService</td>
</tr>
<tr>
<td><strong>IMbnDeviceServicesEvents</strong></td>
<td></td>
</tr>
<tr>
<td>OnReadData</td>
<td>MobileBroadbandDeviceServiceDataSession.DataReceived</td>
</tr>
<tr>
<td><strong>IMbnInterface</strong></td>
<td></td>
</tr>
<tr>
<td>get_InterfaceID</td>
<td>MobileBroadbandAccount.NetworkAccountId</td>
</tr>
<tr>
<td>GetConnection</td>
<td>ConnectionSession obtained from AcquireConnectionAsync</td>
</tr>
<tr>
<td>GetHomeProvider</td>
<td>MobileBroadbandModem.GetCurrentConfigurationAsync</td>
</tr>
<tr>
<td>GetInterfaceCapability</td>
<td>MobileBroadbandAccount.CurrentDeviceInformation</td>
</tr>
<tr>
<td>GetReadyState</td>
<td>MobileBroadbandDeviceInformation.NetworkDeviceStatus</td>
</tr>
<tr>
<td>GetSubscriberInformation</td>
<td>MobileBroadbandAccount.CurrentDeviceInformation</td>
</tr>
<tr>
<td>InEmergencyMode</td>
<td>MobileBroadbandModem.IsInEmergencyCallMode</td>
</tr>
<tr>
<td><strong>IMbnInterfaceEvents</strong></td>
<td></td>
</tr>
<tr>
<td>OnEmergencyModeChange</td>
<td>MobileBroadbandModem.IsInEmergencyCallModeChanged</td>
</tr>
<tr>
<td>OnReadyStateChange</td>
<td>MobileBroadbandNetworkRegistrationStateChange</td>
</tr>
<tr>
<td>OnSubscriberInformationChange</td>
<td>MobileBroadbandAccountUpdatedEventArgs.HasDeviceInformationChanged</td>
</tr>
<tr>
<td><strong>IMbnInterfaceManager</strong></td>
<td></td>
</tr>
<tr>
<td>GetInterface</td>
<td>MobileBroadbandModem.CurrentAccount</td>
</tr>
<tr>
<td><strong>IMbnInterfaceManagerEvents</strong></td>
<td></td>
</tr>
<tr>
<td>OnInterfaceArrival</td>
<td>MobileBroadbandAccountWatcher.AccountAdded</td>
</tr>
<tr>
<td>OnInterfaceRemoval</td>
<td>MobileBroadbandAccountWatcher.Account</td>
</tr>
<tr>
<td><strong>IMbnMultiCarrier</strong></td>
<td></td>
</tr>
<tr>
<td>GetCurrentCellularClass</td>
<td>MobileBroadbandDeviceInformation.CellularClass</td>
</tr>
<tr>
<td><strong>IMbnMultiCarrierEvents</strong></td>
<td></td>
</tr>
<tr>
<td>OnCurrentCellularClassChange</td>
<td>MobileBroadbandAccountUpdatedEventArgs.HasDeviceInformationChanged</td>
</tr>
<tr>
<td><strong>IMbnPin</strong></td>
<td></td>
</tr>
<tr>
<td>Change</td>
<td>MobileBroadbandPin.ChangeAsync</td>
</tr>
<tr>
<td>Disable</td>
<td>MobileBroadbandPin.DisableAsync</td>
</tr>
<tr>
<td>Enable</td>
<td>MobileBroadbandPin.EnableAsync</td>
</tr>
<tr>
<td>Enter</td>
<td>MobileBroadbandPin.EnterAsync</td>
</tr>
<tr>
<td>get_PinFormat</td>
<td>MobileBroadbandPin.Format</td>
</tr>
<tr>
<td>get_PinLengthMax</td>
<td>MobileBroadbandPin.MaxLength</td>
</tr>
<tr>
<td>get_PinLengthMin</td>
<td>MobileBroadbandPin.MaxLength</td>
</tr>
<tr>
<td>get_PinMode</td>
<td>MobileBroadbandPin.Enabled</td>
</tr>
<tr>
<td>get_PinType</td>
<td>MobileBroadbandPin.Type</td>
</tr>
<tr>
<td>GetPinManager</td>
<td>MobileBroadbandDeviceInformation.PinManager</td>
</tr>
<tr>
<td>Unblock</td>
<td>MobileBroadbandPin.UnblockAsync</td>
</tr>
<tr>
<td><strong>IMbnPinManager</strong></td>
<td></td>
</tr>
<tr>
<td>GetPin</td>
<td>MobileBroadbandPinManager.GetPin</td>
</tr>
<tr>
<td>GetPinList</td>
<td>MobileBroadbandPinManager.SupportedPins</td>
</tr>
<tr>
<td>GetPinState</td>
<td>MobileBroadbandPin.LockState</td>
</tr>
<tr>
<td><strong>IMbnPinManagerEvents</strong></td>
<td></td>
</tr>
<tr>
<td><strong>IMbnRadio</strong></td>
<td></td>
</tr>
<tr>
<td>get_SoftwareRadioState</td>
<td>Radio.GetRadiosAsync â€“ Radio. State</td>
</tr>
<tr>
<td>SetSoftwareRadioState</td>
<td>Radio.SetStateAsync</td>
</tr>
<tr>
<td><strong>IMbnRadioEvents</strong></td>
<td></td>
</tr>
<tr>
<td>OnRadioStateChange</td>
<td>Radio.StateChanged</td>
</tr>
<tr>
<td><strong>IMbnRegistration</strong></td>
<td></td>
</tr>
<tr>
<td>GetAvailableDataClasses</td>
<td>MobileBroadbandDeviceInformation.DataClasses</td>
</tr>
<tr>
<td>GetCurrentDataClass</td>
<td>MobileBroadbandNetwork.RegisteredDataClass</td>
</tr>
<tr>
<td>GetPacketAttachNetworkError</td>
<td>MobileBroadbandNetwork.PacketAttachNetworkError</td>
</tr>
<tr>
<td>GetProviderID</td>
<td>MobileBroadbandNetwork.RegisteredProviderId</td>
</tr>
<tr>
<td>GetProviderName</td>
<td>MobileBroadbandNetwork.RegisteredProviderName</td>
</tr>
<tr>
<td>GetRegisterState</td>
<td>MobileBroadbandNetwork.NetworkRegistrationState</td>
</tr>
<tr>
<td>GetRegistrationNetworkError</td>
<td>MobileBroadbandNetwork.ActivationNetworkError</td>
</tr>
<tr>
<td><strong>IMbnRegistrationEvents</strong></td>
<td></td>
</tr>
<tr>
<td>OnPacketServiceStateChange</td>
<td>MobileBroadbandNetworkRegistrationStateChange</td>
</tr>
<tr>
<td>OnRegisterStateChange</td>
<td>MobileBroadbandNetworkRegistrationStateChange</td>
</tr>
<tr>
<td>GetSignalStrength</td>
<td>ConnectionProfile.GetSignalBar / MobileBroadbandCellLte.ReferenceSignalReceivedPowerInDBm / MobileBroadbandCellGsm.ReceivedSignalStrengthInDBm</td>
</tr>
<tr>
<td><strong>IMbnSignalEvents</strong></td>
<td></td>
</tr>
<tr>
<td><strong>IMbnSms</strong></td>
<td></td>
</tr>
<tr>
<td>GetSmsConfiguration</td>
<td>SmsDevice2.SmscAddress, SmsDevice2.CellularClass, None for CDMAShortMessageSize and MaxMessageIndex which is not required as public API.</td>
</tr>
<tr>
<td>SetSmsConfiguration</td>
<td>SmsDevice2.SmscAddress, none of the other parameters are supported</td>
</tr>
<tr>
<td>SmsSendCdma</td>
<td>SendMessageAndGetResultAsync using CellularClass in ISmsMessageBase</td>
</tr>
<tr>
<td>SmsSendCdmaPdu</td>
<td>SendMessageAndGetResultAsync using Messagetype and CellularClass in ISmsMessageBase</td>
</tr>
<tr>
<td>SmsSendPdu</td>
<td>SendMessageAndGetResultAsync using MessageType in ISmsMessageBase</td>
</tr>
<tr>
<td><strong>IMbnSmsConfiguration</strong></td>
<td></td>
</tr>
<tr>
<td>get_ServiceCenterAddress</td>
<td>SmsDevice2.SmscAddress</td>
</tr>
<tr>
<td>get_SmsFormat</td>
<td>SmsDevice2.CellularClass</td>
</tr>
<tr>
<td>put_ServiceCenterAddress</td>
<td>SmsDevice2.SmscAddress</td>
</tr>
<tr>
<td><strong>IMbnSmsEvents</strong></td>
<td></td>
</tr>
<tr>
<td>OnSmsNewClass0Message</td>
<td>SmsMessageRegistration.MessageReceived</td>
</tr>
<tr>
<td>OnSmsSendComplete</td>
<td>SmsSendMessageResult</td>
</tr>
<tr>
<td><strong>IMbnSmsReadMsgPdu</strong></td>
<td></td>
</tr>
<tr>
<td>get_Message</td>
<td>SmsTextMessage2.Body</td>
</tr>
<tr>
<td>get_PduData</td>
<td>SmsTextmessage2.Body</td>
</tr>
<tr>
<td><strong>IMbnSmsReadMsgTextCdma</strong></td>
<td></td>
</tr>
<tr>
<td>get_Address</td>
<td>SmsTextMessage2.From</td>
</tr>
<tr>
<td>get_EncodingID</td>
<td>SmsTextMessage2.Encoding</td>
</tr>
<tr>
<td>get_Message</td>
<td>SmsTextMessage2.Body</td>
</tr>
<tr>
<td>get_Timestamp</td>
<td>SmsTextMessage.2Timestamp</td>
</tr>
<tr>
<td><strong>IMbnSubscriberInformation</strong></td>
<td></td>
</tr>
<tr>
<td>get_SimIccID</td>
<td>MobileBroadbandDeviceInformation.SimIccId</td>
</tr>
<tr>
<td>get_SubscriberID</td>
<td>MobileBroadbandDeviceInformation.SubscriberId</td>
</tr>
<tr>
<td>get_TelephoneNumbers</td>
<td>MobileBroadbandDeviceInformation.TelephoneNumbers</td>
</tr>
</tbody>
</table>
</body>
