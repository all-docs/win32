<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Dynamically Label Toolbar Buttons</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Dynamically Label Toolbar Buttons
description: You can assign text to an existing button by using the TB_SETBUTTONINFO message.
ms.assetid: 571C7FB9-2806-47AF-8933-0D3541AE6ACF
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Dynamically Label Toolbar Buttons</h1>
<p>You can assign text to an existing button by using the <a href="tb-setbuttoninfo.html"><strong>TB_SETBUTTONINFO</strong></a> message.</p>
<h2>What you need to know</h2>
<h3>Technologies</h3>
<ul>
<li><a href="window-controls.html">Windows Controls</a></li>
</ul>
<h3>Prerequisites</h3>
<ul>
<li>C/C++</li>
<li>Windows User Interface Programming</li>
</ul>
<h2>Instructions</h2>
<h3>Dynamically Label a Toolbar Button</h3>
<p>The following example demonstrates how to change the text of the third button in the previous examples from <strong>Save</strong> to <strong>Save As</strong>.</p>
<pre lang="C++"><code>LRESULT RelabelButton(HWND hWndToolbar)
{
    TBBUTTONINFO tbInfo;
    
    tbInfo.cbSize  = sizeof(TBBUTTONINFO);
    tbInfo.dwMask  = TBIF_TEXT;
    tbInfo.pszText = L&quot;Save As&quot;;
    
    return SendMessage(hWndToolbar, TB_SETBUTTONINFO, (WPARAM)IDM_SAVE, (LPARAM)&amp;tbInfo);
}
</code></pre>
<h2>Remarks</h2>
<p>Changing a button's text by using <a href="tb-setbuttoninfo.html"><strong>TB_SETBUTTONINFO</strong></a> does not affect the string that is assigned to that button in the internal string list.</p>
<p>If you add a toolbar button string to the internal text list, you cannot retrieve the index of that string by calling <a href="tbn-getbuttoninfo.html">TBN_GETBUTTONINFO</a>â€”you must use the <a href="tb-getbutton.html"><strong>TB_GETBUTTON</strong></a> message instead.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="using-toolbar-controls.html">Using Toolbar Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls">Windows common controls demo (CppWindowsCommonControls)</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
