<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Support Callback Items</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Support Callback Items
description: This topic demonstrates how to provide support for callback items.
ms.assetid: BD32666F-9445-4871-AE21-5DC9F5FC9C1B
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Support Callback Items</h1>
<p>This topic demonstrates how to provide support for callback items.</p>
<h2>What you need to know</h2>
<h3>Technologies</h3>
<ul>
<li><a href="window-controls.html">Windows Controls</a></li>
</ul>
<h3>Prerequisites</h3>
<ul>
<li>C/C++</li>
<li>Windows User Interface Programming</li>
</ul>
<h2>Instructions</h2>
<p>If your application is going to use callback items in a ComboBoxEx control, it must be prepared to handle the <a href="cben-getdispinfo.html">CBEN_GETDISPINFO</a> notification code. A ComboBoxEx control sends this notification whenever it needs the owner to provide specific item information. For more information about callback items, see <a href="comboboxex-controls.html">Callback Items</a>.</p>
<p>The following application-defined function processes <a href="cben-getdispinfo.html">CBEN_GETDISPINFO</a> by providing attributes for a given item. Note that it sets the <strong>mask</strong> member of the incoming <a href="/windows/win32/api/commctrl/ns-commctrl-comboboxexitema"><strong>COMBOBOXEXITEM</strong></a> structure to CBEIF_DI_SETITEM. Setting <strong>mask</strong> to this value makes the control retain the item information so that it will not need to request the information again.</p>
<h2>Complete example</h2>
<pre lang="C++"><code>// DoItemCallback - Processes CBEN_GETDISPINFO by providing item
// attributes for a given callback item.

void WINAPI DoItemCallback(PNMCOMBOBOXEX pNMCBex)
{
    DWORD dwMask = pNMCBex-&gt;ceItem.mask;

    if(dwMask &amp; CBEIF_TEXT)
    {
            // Insert code to provide item text.
    }

    if(dwMask &amp; CBEIF_IMAGE) 
    {
        // Insert code to provide an item image index.
    }

    // Insert code to provide other callback information as desired.

    // Make the ComboBoxEx control hold onto the item information.
    pNMCBex-&gt;ceItem.mask = CBEIF_DI_SETITEM;
}
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="comboboxex-controls.html">About ComboBoxEx Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="bumper-comboboxex-comboboxex-control-reference.html">ComboBoxEx Control Reference</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/Controls/using-comboboxex">Using ComboBoxEx Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="comboboxex-control-reference.html">ComboBoxEx</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
