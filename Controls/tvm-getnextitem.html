<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TVM_GETNEXTITEM message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: TVM_GETNEXTITEM message (Commctrl.h)
description: Retrieves the tree-view item that bears the specified relationship to a specified item. You can send this message explicitly, by using the TreeView_GetNextItem macro.
ms.assetid: 505c713c-7728-4119-bc0e-482fe7e73193
keywords:</p>
<ul>
<li>TVM_GETNEXTITEM message Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>TVM_GETNEXTITEM
api_location:</li>
<li>Commctrl.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>TVM_GETNEXTITEM message</h1>
<p>Retrieves the tree-view item that bears the specified relationship to a specified item. You can send this message explicitly, by using the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getnextitem"><strong>TreeView_GetNextItem</strong></a> macro.</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>Flag specifying the item to retrieve. This parameter can be one of the following values:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TVGN_CARET</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Retrieves the currently selected item. You can use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getselection"><strong>TreeView_GetSelection</strong></a> macro to send this message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TVGN_CHILD</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Retrieves the first child item of the item specified by the <em>hitem</em> parameter. You can use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getchild"><strong>TreeView_GetChild</strong></a> macro to send this message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TVGN_DROPHILITE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Retrieves the item that is the target of a drag-and-drop operation. You can use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getdrophilight"><strong>TreeView_GetDropHilight</strong></a> macro to send this message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TVGN_FIRSTVISIBLE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Retrieves the first item that is visible in the tree-view window. You can use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getfirstvisible"><strong>TreeView_GetFirstVisible</strong></a> macro to send this message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TVGN_LASTVISIBLE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><a href="common-control-versions.html">Version 4.71</a>. Retrieves the last expanded item in the tree. This does not retrieve the last item visible in the tree-view window. You can use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getlastvisible"><strong>TreeView_GetLastVisible</strong></a> macro to send this message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TVGN_NEXT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Retrieves the next sibling item. You can use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getnextsibling"><strong>TreeView_GetNextSibling</strong></a> macro to send this message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TVGN_NEXTSELECTED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>Windows Vista and later.</strong> Retrieves the next selected item. You can use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getnextselected"><strong>TreeView_GetNextSelected</strong></a> macro to send this message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TVGN_NEXTVISIBLE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Retrieves the next visible item that follows the specified item. The specified item must be visible. Use the <a href="tvm-getitemrect.html"><strong>TVM_GETITEMRECT</strong></a> message to determine whether an item is visible. You can use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getnextvisible"><strong>TreeView_GetNextVisible</strong></a> macro to send this message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TVGN_PARENT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Retrieves the parent of the specified item. You can use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getparent"><strong>TreeView_GetParent</strong></a> macro to send this message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TVGN_PREVIOUS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Retrieves the previous sibling item. You can use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getprevsibling"><strong>TreeView_GetPrevSibling</strong></a> macro to send this message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TVGN_PREVIOUSVISIBLE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Retrieves the first visible item that precedes the specified item. The specified item must be visible. Use the <a href="tvm-getitemrect.html"><strong>TVM_GETITEMRECT</strong></a> message to determine whether an item is visible. You can use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getprevvisible"><strong>TreeView_GetPrevVisible</strong></a> macro to send this message.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>TVGN_ROOT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Retrieves the topmost or very first item of the tree-view control. You can use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getroot"><strong>TreeView_GetRoot</strong></a> macro to send this message. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>Handle to an item.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns the handle to the item if successful. For most cases, the message returns a <strong>NULL</strong> value to indicate an error. See the Remarks section for details.</p>
<h2>Remarks</h2>
<p>This message will return <strong>NULL</strong> if the item being retrieved is the root node of the tree. For example, if you use this message with the TVGN_PARENT flag on a first-level child of the tree view's root node, the message will return <strong>NULL</strong>.</p>
<p>You can also use one of these related macros:</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getchild"><strong>TreeView_GetChild</strong></a></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getdrophilight"><strong>TreeView_GetDropHilight</strong></a></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getfirstvisible"><strong>TreeView_GetFirstVisible</strong></a></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getlastvisible"><strong>TreeView_GetLastVisible</strong></a></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getnextsibling"><strong>TreeView_GetNextSibling</strong></a></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getnextvisible"><strong>TreeView_GetNextVisible</strong></a></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getparent"><strong>TreeView_GetParent</strong></a></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getprevsibling"><strong>TreeView_GetPrevSibling</strong></a></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getprevvisible"><strong>TreeView_GetPrevVisible</strong></a></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getroot"><strong>TreeView_GetRoot</strong></a></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getselection"><strong>TreeView_GetSelection</strong></a></td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Commctrl.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
