<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Date and Time Picker</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Date and Time Picker
description: This section contains information about the API elements used with date and time picker controls.
ms.assetid: 'vs|controls|~\controls\datetime\reflist.htm'
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Date and Time Picker</h1>
<p>This section contains information about the API elements used with date and time picker controls.</p>
<h3>Overviews</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="date-and-time-picker-controls.html">About Date and Time Picker Controls</a></td>
<td>A <em>date and time picker (DTP) control</em> provides a simple and intuitive interface through which to exchange date and time information with a user.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="using-date-and-time-picker.html">Using Date and Time Picker Controls</a></td>
<td>This section provides information and sample code for implementing date and time picker controls. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Macros</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_closemonthcal"><strong>DateTime_CloseMonthCal</strong></a></td>
<td>Closes the date and time picker (DTP) control. Use this macro or send the <a href="dtm-closemonthcal.html"><strong>DTM_CLOSEMONTHCAL</strong></a> message explicitly.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getdatetimepickerinfo"><strong>DateTime_GetDateTimePickerInfo</strong></a></td>
<td>Gets information for a specified date and time picker (DTP) control.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getidealsize"><strong>DateTime_GetIdealSize</strong></a></td>
<td>Gets the size needed to display the control without clipping. Use this macro or send the <a href="dtm-getidealsize.html"><strong>DTM_GETIDEALSIZE</strong></a> message explicitly.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcal"><strong>DateTime_GetMonthCal</strong></a></td>
<td>Gets the handle to a date and time picker's (DTP) child month calendar control. You can use this macro or send the <a href="dtm-getmonthcal.html"><strong>DTM_GETMONTHCAL</strong></a> message explicitly. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalcolor"><strong>DateTime_GetMonthCalColor</strong></a></td>
<td>Gets the color for a given portion of the month calendar within a date and time picker (DTP) control. You can use this macro or send the <a href="dtm-getmccolor.html"><strong>DTM_GETMCCOLOR</strong></a> message explicitly. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalfont"><strong>DateTime_GetMonthCalFont</strong></a></td>
<td>Gets the font that the date and time picker (DTP) control's child month calendar control is currently using. You can use this macro or send the <a href="dtm-getmcfont.html"><strong>DTM_GETMCFONT</strong></a> message explicitly. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalstyle"><strong>DateTime_GetMonthCalStyle</strong></a></td>
<td>Gets the style of a specified DTP control. Use this macro or send the <a href="dtm-getmcstyle.html"><strong>DTM_GETMCSTYLE</strong></a> message explicitly.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getrange"><strong>DateTime_GetRange</strong></a></td>
<td>Gets the current minimum and maximum allowable system times for a date and time picker (DTP) control. You can use this macro, or send the <a href="dtm-getrange.html"><strong>DTM_GETRANGE</strong></a> message explicitly. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getsystemtime"><strong>DateTime_GetSystemtime</strong></a></td>
<td>Gets the currently selected time from a date and time picker (DTP) control and places it in a specified <a href="/windows/desktop/api/minwinbase/ns-minwinbase-systemtime"><strong>SYSTEMTIME</strong></a> structure. You can use this macro, or send the <a href="dtm-getsystemtime.html"><strong>DTM_GETSYSTEMTIME</strong></a> message explicitly. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_setformat"><strong>DateTime_SetFormat</strong></a></td>
<td>Sets the display of a date and time picker (DTP) control based on a given format string. You can use this macro or send the <a href="dtm-setformat.html"><strong>DTM_SETFORMAT</strong></a> message explicitly. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalcolor"><strong>DateTime_SetMonthCalColor</strong></a></td>
<td>Sets the color for a given portion of the month calendar within a date and time picker (DTP) control. You can use this macro or send the <a href="dtm-setmccolor.html"><strong>DTM_SETMCCOLOR</strong></a> message explicitly. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalfont"><strong>DateTime_SetMonthCalFont</strong></a></td>
<td>Sets the font to be used by the date and time picker (DTP) control's child month calendar control. You can use this macro or explicitly send the <a href="dtm-setmcfont.html"><strong>DTM_SETMCFONT</strong></a> message. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalstyle"><strong>DateTime_SetMonthCalStyle</strong></a></td>
<td>Sets the style for a specified DTP control. Use this macro or send the <a href="dtm-setmcstyle.html"><strong>DTM_SETMCSTYLE</strong></a> message explicitly.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_setrange"><strong>DateTime_SetRange</strong></a></td>
<td>Sets the minimum and maximum allowable system times for a date and time picker (DTP) control. You can use this macro or send the <a href="dtm-setrange.html"><strong>DTM_SETRANGE</strong></a> message explicitly. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_setsystemtime"><strong>DateTime_SetSystemtime</strong></a></td>
<td>Sets a date and time picker (DTP) control to a given date and time. You can use this macro or send the <a href="dtm-setsystemtime.html"><strong>DTM_SETSYSTEMTIME</strong></a> message explicitly. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Messages</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="dtm-closemonthcal.html"><strong>DTM_CLOSEMONTHCAL</strong></a></td>
<td>Closes a DTP control. Send this message explicitly or by using the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_closemonthcal"><strong>DateTime_CloseMonthCal</strong></a> macro.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-getdatetimepickerinfo.html"><strong>DTM_GETDATETIMEPICKERINFO</strong></a></td>
<td>Gets information on a date and time picker (DTP) control.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-getidealsize.html"><strong>DTM_GETIDEALSIZE</strong></a></td>
<td>Gets the size needed to display the control without clipping. Send this message explicitly or by using the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getidealsize"><strong>DateTime_GetIdealSize</strong></a> macro.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-getmccolor.html"><strong>DTM_GETMCCOLOR</strong></a></td>
<td>Gets the color for a given portion of the month calendar within a date and time picker (DTP) control. You can send this message explicitly or use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalcolor"><strong>DateTime_GetMonthCalColor</strong></a> macro. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-getmcfont.html"><strong>DTM_GETMCFONT</strong></a></td>
<td>Gets the font that the date and time picker (DTP) control's child month calendar control is currently using. You can send this message explicitly or use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalfont"><strong>DateTime_GetMonthCalFont</strong></a> macro. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-getmcstyle.html"><strong>DTM_GETMCSTYLE</strong></a></td>
<td>Gets the style of a DTP control. Send this message explicitly or by using the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalstyle"><strong>DateTime_GetMonthCalStyle</strong></a> macro.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-getmonthcal.html"><strong>DTM_GETMONTHCAL</strong></a></td>
<td>Gets the handle to a date and time picker's (DTP) child month calendar control. You can send this message explicitly or use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcal"><strong>DateTime_GetMonthCal</strong></a> macro. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-getrange.html"><strong>DTM_GETRANGE</strong></a></td>
<td>Gets the current minimum and maximum allowable system times for a date and time picker (DTP) control. You can send this message explicitly or use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getrange"><strong>DateTime_GetRange</strong></a> macro. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-getsystemtime.html"><strong>DTM_GETSYSTEMTIME</strong></a></td>
<td>Gets the currently selected time from a date and time picker (DTP) control and places it in a specified <a href="/windows/desktop/api/minwinbase/ns-minwinbase-systemtime"><strong>SYSTEMTIME</strong></a> structure. You can send this message explicitly or use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_getsystemtime"><strong>DateTime_GetSystemtime</strong></a> macro. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-setformat.html"><strong>DTM_SETFORMAT</strong></a></td>
<td>Sets the display of a date and time picker (DTP) control based on a given format string. You can send this message explicitly or use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_setformat"><strong>DateTime_SetFormat</strong></a> macro. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-setmccolor.html"><strong>DTM_SETMCCOLOR</strong></a></td>
<td>Sets the color for a given portion of the month calendar within a date and time picker (DTP) control. You can send this message explicitly or use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalcolor"><strong>DateTime_SetMonthCalColor</strong></a> macro. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-setmcfont.html"><strong>DTM_SETMCFONT</strong></a></td>
<td>Sets the font to be used by the date and time picker (DTP) control's child month calendar control. You can send this message explicitly or use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalfont"><strong>DateTime_SetMonthCalFont</strong></a> macro.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-setmcstyle.html"><strong>DTM_SETMCSTYLE</strong></a></td>
<td>Sets the style of a DTP control. Send this message explicitly or by using the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalstyle"><strong>DateTime_SetMonthCalStyle</strong></a> macro.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-setrange.html"><strong>DTM_SETRANGE</strong></a></td>
<td>Sets the minimum and maximum allowable system times for a date and time picker (DTP) control. You can send this message explicitly or use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_setrange"><strong>DateTime_SetRange</strong></a> macro. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtm-setsystemtime.html"><strong>DTM_SETSYSTEMTIME</strong></a></td>
<td>Sets the time in a date and time picker (DTP) control. You can send this message explicitly or use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-datetime_setsystemtime"><strong>DateTime_SetSystemtime</strong></a> macro. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Notifications</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="dtn-closeup.html">DTN_CLOSEUP</a></td>
<td>Sent by a date and time picker (DTP) control when the user closes the drop-down month calendar. The month calendar is closed when the user chooses a date from the month calendar or clicks the drop-down arrow while the calendar is open. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtn-datetimechange.html">DTN_DATETIMECHANGE</a></td>
<td>Sent by a date and time picker (DTP) control whenever a change occurs. This notification code is sent in the form of a <a href="wm-notify.html"><strong>WM_NOTIFY</strong></a> message. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtn-dropdown.html">DTN_DROPDOWN</a></td>
<td>Sent by a date and time picker (DTP) control when the user activates the drop-down month calendar. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtn-format.html">DTN_FORMAT</a></td>
<td>Sent by a date and time picker (DTP) control to request text to be displayed in a callback field. This notification code is sent in the form of a <a href="wm-notify.html"><strong>WM_NOTIFY</strong></a> message. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtn-formatquery.html">DTN_FORMATQUERY</a></td>
<td>Sent by a date and time picker (DTP) control to retrieve the maximum allowable size of the string that will be displayed in a callback field. This notification code is sent in the form of a <a href="wm-notify.html"><strong>WM_NOTIFY</strong></a> message. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtn-userstring.html">DTN_USERSTRING</a></td>
<td>Sent by a date and time picker (DTP) control when a user finishes editing a string in the control. This notification code is only sent by DTP controls that are set to the <a href="date-and-time-picker-control-styles.html"><strong>DTS_APPCANPARSE</strong></a> style. This message is sent in the form of a <a href="wm-notify.html"><strong>WM_NOTIFY</strong></a> message. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dtn-wmkeydown.html">DTN_WMKEYDOWN</a></td>
<td>Sent by a date and time picker (DTP) control when the user types in a callback field. This message is sent in the form of a <a href="wm-notify.html"><strong>WM_NOTIFY</strong></a> message. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="nm-killfocus-date-time.html">NM_KILLFOCUS (date time)</a></td>
<td>Notifies a date and time picker control's parent window that the control has lost the input focus. <a href="nm-killfocus-date-time.html"><strong>NM_KILLFOCUS (date time)</strong></a> is sent in the form of a <a href="wm-notify.html"><strong>WM_NOTIFY</strong></a> message. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="nm-setfocus-date-time-.html">NM_SETFOCUS (date time)</a></td>
<td>Notifies a date and time picker control's parent window that the control has received the input focus. <a href="nm-setfocus-date-time-.html">NM_SETFOCUS (date time)</a> is sent in the form of a <a href="wm-notify.html"><strong>WM_NOTIFY</strong></a> message. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Structures</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/commctrl/ns-commctrl-datetimepickerinfo"><strong>DATETIMEPICKERINFO</strong></a></td>
<td>Contains information about a DTP control. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/commctrl/ns-commctrl-nmdatetimechange"><strong>NMDATETIMECHANGE</strong></a></td>
<td>Contains information about a change that has taken place in a date and time picker (DTP) control. This structure is used with the <a href="dtn-datetimechange.html">DTN_DATETIMECHANGE</a> notification code. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/commctrl/ns-commctrl-nmdatetimeformata"><strong>NMDATETIMEFORMAT</strong></a></td>
<td>Contains information about a portion of the format string that defines a callback field within a date and time picker (DTP) control. It carries the substring that defines the callback field and contains a buffer to receive the string that will be displayed in the callback field. This structure is used with the <a href="dtn-format.html">DTN_FORMAT</a> notification code. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/commctrl/ns-commctrl-nmdatetimeformatquerya"><strong>NMDATETIMEFORMATQUERY</strong></a></td>
<td>Contains information about a date and time picker (DTP) control callback field. It contains a substring (taken from the control's format string) that defines a callback field. The structure receives the maximum allowable size of the text that will be displayed in the callback field. This structure is used with the <a href="dtn-formatquery.html">DTN_FORMATQUERY</a> notification code. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/commctrl/ns-commctrl-nmdatetimestringa"><strong>NMDATETIMESTRING</strong></a></td>
<td>Contains information specific to an edit operation that has taken place in a date and time picker (DTP) control. This message is used with the <a href="dtn-userstring.html">DTN_USERSTRING</a> notification code. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/commctrl/ns-commctrl-nmdatetimewmkeydowna"><strong>NMDATETIMEWMKEYDOWN</strong></a></td>
<td>Carries information used to describe and handle a <a href="dtn-wmkeydown.html">DTN_WMKEYDOWN</a> notification code. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Constants</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="date-and-time-picker-control-styles.html">Date and Time Picker Control Styles</a></td>
<td>The window styles listed here are specific to date and time picker controls.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
