<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EM_GETTEXTEX message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: EM_GETTEXTEX message (Richedit.h)
description: Gets the text from a rich edit control.
ms.assetid: 46431563-fde1-4407-ab7a-b2248c0e12b8
keywords:</p>
<ul>
<li>EM_GETTEXTEX message Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>EM_GETTEXTEX
api_location:</li>
<li>Richedit.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 08/23/2022</li>
</ul>
<hr />
<h1>EM_GETTEXTEX message</h1>
<p>Gets the text from a rich edit control.</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>Pointer to a <a href="/windows/desktop/api/Richedit/ns-richedit-gettextex"><strong>GETTEXTEX</strong></a> structure, which indicates how to translate the text before putting it into the output buffer.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>Pointer to the buffer to receive the text. The size of this buffer, in bytes, is specified by the <strong>cb</strong> member of the <a href="/windows/desktop/api/Richedit/ns-richedit-gettextex"><strong>GETTEXTEX</strong></a> structure. Use the <a href="em-gettextlengthex.html"><strong>EM_GETTEXTLENGTHEX</strong></a> message to get the required size of the buffer.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>The return value is the number of <strong>TCHAR</strong>s copied into the output buffer, not including the null terminator.</p>
<h2>Remarks</h2>
<p>If the size of the output buffer is less than the size of the text in the control, the edit control will copy text from its beginning and place it in the buffer until the buffer is full. A terminating null character will still be placed at the end of the buffer.</p>
<p>If ANSI text is requested, <strong>EM_GETTEXTEX</strong> uses the <a href="/windows/desktop/api/stringapiset/nf-stringapiset-widechartomultibyte"><strong>WideCharToMultiByte</strong></a> function to translate the Unicode characters to ANSI. It allows you to go from Unicode to ANSI using a particular code page. The <a href="/windows/desktop/api/Richedit/ns-richedit-gettextex"><strong>GETTEXTEX</strong></a> structure contains members (<strong>lpDefaultChar</strong> and <strong>lpUsedDefChar</strong>) that are used in the translation from Unicode to ANSI.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Richedit.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="em-settextex.html"><strong>EM_SETTEXTEX</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Richedit/ns-richedit-gettextex"><strong>GETTEXTEX</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>Other Resources</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/stringapiset/nf-stringapiset-widechartomultibyte"><strong>WideCharToMultiByte</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/winmsg/wm-settext"><strong>WM_SETTEXT</strong></a></p>
<!-- raw HTML omitted -->
</body>
