<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Control the AVI Clip</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Control the AVI Clip
description: This topic demonstrates how to use the animation control macros to play, stop, and close an associated Audio-Video Interleaved (AVI) clip.
ms.assetid: 4B19F929-B306-4EBF-B82F-6539FAA42BA6
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Control the AVI Clip</h1>
<p>This topic demonstrates how to use the animation control macros to play, stop, and close an associated Audio-Video Interleaved (AVI) clip.</p>
<h2>What you need to know</h2>
<h3>Technologies</h3>
<ul>
<li><a href="window-controls.html">Windows Controls</a></li>
</ul>
<h3>Prerequisites</h3>
<ul>
<li>C/C++</li>
<li>Windows User Interface Programming</li>
<li>AVI files</li>
</ul>
<h2>Instructions</h2>
<p>Create a function that takes as parameters a handle to the animation control and a flag that indicates the action to be performed on the associated AVI clip.</p>
<p>The function in the following C++ example calls one of three animation control macros (<a href="/windows/desktop/api/Commctrl/nf-commctrl-animate_play"><strong>Animate_Play</strong></a>, <a href="/windows/desktop/api/Commctrl/nf-commctrl-animate_stop"><strong>Animate_Stop</strong></a>, <a href="/windows/desktop/api/Commctrl/nf-commctrl-animate_close"><strong>Animate_Close</strong></a>) based on the value of the <em>nAction</em> parameter. The handle to the animation control that is associated with the AVI clip is passed via the <em>hwndAnim</em> parameter.</p>
<pre lang="C++"><code>// DoAnimation - plays, stops, or closes an animation control's 
//               AVI clip, depending on the value of an action flag. 
// hwndAnim    - handle to an animation control. 
// nAction     - flag that determines whether to play, stop, or close 
//               the AVI clip. 

void DoAnimation(HWND hwndAnim, int nAction) 
{ 
    int const PLAYIT = 1, STOPIT = 2, CLOSEIT = 3; 
    switch (nAction) { 
        case PLAYIT: 
         // Play the clip continuously starting with the 
         // first frame. 
            Animate_Play(hwndAnim, 0, -1, -1); 
            break; 

        case STOPIT: 
            Animate_Stop(hwndAnim); 
            break; 

        case CLOSEIT: 
            Animate_Close(hwndAnim); 
            break; 

        default: 
            break; 
    }
    
    return; 
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="animation-control-overview.html">About Animation Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="bumper-animation-animation-control-reference.html">Animation Control Reference</a></p>
<!-- raw HTML omitted -->
<p><a href="using-animation-control.html">Using Animation Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="animation-control-reference.html">Animation Control</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
