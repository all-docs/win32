<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Use a Font Duplicate</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Use a Font Duplicate
description: This section explains how to use a font duplicate to apply a number of changes to a text range, all at once.
ms.assetid: CF0123E5-313F-4583-872F-6FE954F1C9E8
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Use a Font Duplicate</h1>
<p>This section explains how to use a font duplicate to apply a number of changes to a text range, all at once.</p>
<h2>What you need to know</h2>
<h3>Technologies</h3>
<ul>
<li><a href="window-controls.html">Windows Controls</a></li>
</ul>
<h3>Prerequisites</h3>
<ul>
<li>C/C++</li>
<li>Windows User Interface Programming</li>
</ul>
<h2>Instructions</h2>
<h3>Use a Font Duplicate</h3>
<p>The following example shows how a font duplicate can be used to apply a number of changes to a range at once.</p>
<pre lang="C++"><code>void ChangeFontNameSizeBold(ITextSelection *pSel)
{
    ITextFont *pFontSel      = NULL
    ITextFont *FontDuplicate = NULL;
    
    // Get ITextFont version of non-duplicated font.
    if (FAILED(pSel-&gt;GetFont( &amp;pFontSel))
        return;

    // Duplicate the font.
    pFontSel-&gt;GetValue(&amp;pFontDuplicate);
    pFontSel-&gt;Release();
    
    if(!pFontDuplicate)
        return;

   // Changes here happen only to the underlying data structure, 
   // such as a CHARFORMAT, in the duplicate - NOT to the actual story text.

    BSTR bstrTemp = UnicodeBstrFromAnsi(&quot;Times New Roman&quot;);   // Font name
    
    pFontDuplicate-&gt;SetName(bstrTemp);
    SysFreeString(bstrTemp);
    
    pFontDuplicate-&gt;SetBold(tomTrue);                        // Bold
    pFontDuplicate-&gt;SetSize(10.5);                           // 10.5 point font.
    pFontDuplicate-&gt;SetAnimation(tomBlackMarchingAnts);

    // Apply the change to text as one change: one screen update, one undo. 
    // You can also apply the font object to different ranges before you free it.
    
    pSel-&gt;SetFont(pFontDuplicate);
    
    pFontDuplicate-&gt;Release();
    
}
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="using-the-text-object-model.html">Using The Text Object Model</a></p>
<!-- raw HTML omitted -->
<p><a href="using-rich-edit-controls.html">Using Rich Edit Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls">Windows common controls demo (CppWindowsCommonControls)</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
