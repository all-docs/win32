<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Implement Tooltips for Status Bar Icons</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Implement Tooltips for Status Bar Icons
description: A nonintrusive way to display an explanatory message for a status bar icon is to implement a tooltip. The tooltip disappears when clicked, but you can also specify a time-out value.
ms.assetid: AA7F17F2-63A4-4954-9DAB-788B73984628
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Implement Tooltips for Status Bar Icons</h1>
<p>A nonintrusive way to display an explanatory message for a status bar icon is to implement a tooltip. The tooltip disappears when clicked, but you can also specify a time-out value.</p>
<h2>What you need to know</h2>
<h3>Technologies</h3>
<ul>
<li><a href="window-controls.html">Windows Controls</a></li>
</ul>
<h3>Prerequisites</h3>
<ul>
<li>C/C++</li>
<li>Windows User Interface Programming</li>
</ul>
<h2>Instructions</h2>
<h3>Implement Tooltips for Status Bar Icons</h3>
<p>The following code fragment illustrates how to add a balloon tooltip to a status bar icon.</p>
<pre lang="C++"><code>#define ARRAYSIZE(a) (sizeof(a)/sizeof(a[0]))

NOTIFYICONDATA IconData = {0};

IconData.cbSize = sizeof(IconData);
IconData.hWnd   = hwndNI;
IconData.uFlags = NIF_INFO;

HRESULT hr = StringCchCopy(IconData.szInfo, 
                           ARRAYSIZE(IconData.szInfo), 
                           TEXT(&quot;Your message text goes here.&quot;));

if(FAILED(hr))
{
  // TODO: Write an error handler in case the call to StringCchCopy fails.
}
IconData.uTimeout = 15000; // in milliseconds

Shell_NotifyIcon(NIM_MODIFY, &amp;IconData);
            
</code></pre>
<h2>Remarks</h2>
<p>For a detailed discussion of the status bar, see <a href="/windows/desktop/shell/taskbar">The Taskbar</a>.</p>
<p>To display a balloon tooltip, you need to set the NIF_INFO flag in the <a href="/windows/desktop/api/shellapi/ns-shellapi-notifyicondataa"><strong>NOTIFYICONDATA</strong></a> structure, and use the <strong>szInfo</strong> and <strong>uTimeout</strong> members to specify the tooltip text and time-out duration.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="using-tooltip-contro.html">Using Tooltip Controls</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
