<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Create Rich Edit Controls</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Create Rich Edit Controls
description: To create a rich edit control, call the CreateWindowEx function, specifying the rich edit window class.
ms.assetid: E0F3E458-7907-42BD-841A-CB3D12628AA8
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Create Rich Edit Controls</h1>
<p>To create a rich edit control, call the <a href="/windows/desktop/api/winuser/nf-winuser-createwindowexa"><strong>CreateWindowEx</strong></a> function, specifying the rich edit window class. For Microsoft Rich EditÂ 4.1 (Msftedit.dll), specify MSFTEDIT_CLASS as the window class. For all previous versions, specify RICHEDIT_CLASS. For more information, see <a href="about-rich-edit-controls.html">Versions of Rich Edit</a>.</p>
<p>Rich edit controls support most of the window styles used with edit controls as well as additional styles. You should specify the <a href="edit-control-styles.html"><strong>ES_MULTILINE</strong></a> window style if you want to allow more than one line of text in the control. For more information, see <a href="rich-edit-control-styles.html">Rich Edit Control Styles</a>.</p>
<h2>What you need to know</h2>
<h3>Technologies</h3>
<ul>
<li><a href="window-controls.html">Windows Controls</a></li>
</ul>
<h3>Prerequisites</h3>
<ul>
<li>C/C++</li>
<li>Windows User Interface Programming</li>
</ul>
<h2>Instructions</h2>
<h3>Create a Rich Edit Control</h3>
<p>The following example function creates a rich edit control and initializes it with some text.</p>
<pre lang="C++"><code>HWND CreateRichEdit(HWND hwndOwner,        // Dialog box handle.
                    int x, int y,          // Location.
                    int width, int height, // Dimensions.
                    HINSTANCE hinst)       // Application or DLL instance.
{
    LoadLibrary(TEXT(&quot;Msftedit.dll&quot;));
    
    HWND hwndEdit= CreateWindowEx(0, MSFTEDIT_CLASS, TEXT(&quot;Type here&quot;),
        ES_MULTILINE | WS_VISIBLE | WS_CHILD | WS_BORDER | WS_TABSTOP, 
        x, y, width, height, 
        hwndOwner, NULL, hinst, NULL);
        
    return hwndEdit;
}
</code></pre>
<p>In Microsoft Visual StudioÂ 2005 and later, it is possible to add a rich edit control into a dialog template by dragging the control from the toolbox. However, doing this in the dialog editor does not ensure that the required library will be loaded before the control is created. It is necessary to call the <a href="/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya"><strong>LoadLibrary</strong></a> function to load Riched32.dll, Riched20.dll, or Msftedit.dll before the dialog is created.</p>
<h2>Remarks</h2>
<p>To use visual styles with these controls, an application must include a manifest and must call the <a href="/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols"><strong>InitCommonControls</strong></a> function at the beginning of the program. For information on visual styles, see <a href="themes-overview.html">Visual Styles</a>. For information on manifests, see <a href="cookbook-overview.html">Enabling Visual Styles</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="using-rich-edit-controls.html">Using Rich Edit Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls">Windows common controls demo (CppWindowsCommonControls)</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
