<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TBN_RESTORE notification code</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: TBN_RESTORE notification code (Commctrl.h)
description: Notifies a toolbar's parent window that a toolbar is in the process of being restored. This notification code is sent in the form of a WM_NOTIFY message.
ms.assetid: b1f0c801-d56b-4e93-b9ba-b572aaa38647
keywords:</p>
<ul>
<li>TBN_RESTORE notification code Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>TBN_RESTORE
api_location:</li>
<li>Commctrl.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>TBN_RESTORE notification code</h1>
<p>Notifies a toolbar's parent window that a toolbar is in the process of being restored. This notification code is sent in the form of a <a href="wm-notify.html"><strong>WM_NOTIFY</strong></a> message.</p>
<pre lang="C++"><code>TBN_RESTORE 

    lpnmtb = (LPNMTBRESTORE) lParam; 
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <a href="/windows/win32/api/commctrl/ns-commctrl-nmtbrestore"><strong>NMTBRESTORE</strong></a> structure.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>The application should return zero in response to the first <strong>TBN_RESTORE</strong> notification code received at the start of the restore process to continue restoring the button information. If the application returns a nonzero value, the restore process is canceled.</p>
<h2>Remarks</h2>
<p>The application will receive this notification code once at the start of the restore process and once for each button. This notification code gives you an opportunity to extract the information from the data stream that you saved previously. If you haven't saved any information, ignore the notification code. See <a href="toolbar-controls-overview.html">Toolbar Customization</a> for a more detailed discussion of how to handle <strong>TBN_RESTORE</strong>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Commctrl.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
