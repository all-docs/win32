<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Retrieve and Set a Hot Key</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Retrieve and Set a Hot Key
description: This topic demonstrates how to retrieve or set the key combination for a hot key control.
ms.assetid: F3643196-F847-4EE4-97ED-75AF52D4FF8D
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Retrieve and Set a Hot Key</h1>
<p>This topic demonstrates how to retrieve or set the key combination for a hot key control. The <a href="hkm-sethotkey.html"><strong>HKM_SETHOTKEY</strong></a> message allows an application to set the hot key combination for a hot key control. Applications use the <a href="hkm-gethotkey.html"><strong>HKM_GETHOTKEY</strong></a> message to retrieve the virtual key code and modifier flags of the hot key that is chosen by the user.</p>
<h2>What you need to know</h2>
<h3>Technologies</h3>
<ul>
<li><a href="window-controls.html">Windows Controls</a></li>
</ul>
<h3>Prerequisites</h3>
<ul>
<li>C/C++</li>
<li>Windows User Interface Programming</li>
</ul>
<h2>Instructions</h2>
<p>Use the <a href="hkm-gethotkey.html"><strong>HKM_GETHOTKEY</strong></a> message to retrieve the virtual key code and modifier keys that describe a hot key chosen by the user. Use the <a href="hkm-sethotkey.html"><strong>HKM_SETHOTKEY</strong></a> message to set those values for a hot key.</p>
<p>In the following C++ code example, the application-defined function uses the <a href="hkm-gethotkey.html"><strong>HKM_GETHOTKEY</strong></a> message to retrieve a key combination from a hot key control and then uses the <a href="/windows/desktop/inputdev/wm-sethotkey"><strong>WM_SETHOTKEY</strong></a> message to set a global hot key. Note that you cannot set a global hot key for a window that has the <a href="/windows/desktop/winmsg/window-styles"><strong>WS_CHILD</strong></a> window style.</p>
<pre lang="C++"><code>// Retrieves the hot key from the hot key control and sets it as
// the hot key for the application's main window. 
//
// Parameters 
//     hwndHot  - Handle of the hot key control. 
//     hwndMain - Handle of the main window. 

BOOL WINAPI ProcessHotkey(HWND hwndHot, HWND hwndMain) 
{ 
    WORD wHotkey;  

    // Retrieve the hot key (virtual key code and modifiers). 
    wHotkey = (WORD) SendMessage(hwndHot, HKM_GETHOTKEY, 0, 0); 
    
    // Use the result as wParam for WM_SETHOTKEY. 
    SendMessage(hwndMain, WM_SETHOTKEY, wHotkey, 0); 
    return TRUE;
}
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="bumper-hot-key-hot-key-control-reference.html">Hot Key Control Reference</a></p>
<!-- raw HTML omitted -->
<p><a href="hot-key-controls.html">About Hot Key Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="using-hot-key-controls.html">Using Hot Key Controls</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
