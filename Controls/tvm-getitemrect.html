<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TVM_GETITEMRECT message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: TVM_GETITEMRECT message (Commctrl.h)
description: Retrieves the bounding rectangle for a tree-view item and indicates whether the item is visible. You can send this message explicitly or by using the TreeView_GetItemRect macro.
ms.assetid: f2d7d7b1-cfe7-4361-bd90-e3e99dbcd99c
keywords:</p>
<ul>
<li>TVM_GETITEMRECT message Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>TVM_GETITEMRECT
api_location:</li>
<li>Commctrl.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>TVM_GETITEMRECT message</h1>
<p>Retrieves the bounding rectangle for a tree-view item and indicates whether the item is visible. You can send this message explicitly or by using the <a href="/windows/desktop/api/Commctrl/nf-commctrl-treeview_getitemrect"><strong>TreeView_GetItemRect</strong></a> macro.</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>Value specifying the portion of the item for which to retrieve the bounding rectangle. If this parameter is <strong>TRUE</strong>, the bounding rectangle includes only the text of the item. Otherwise, it includes the entire line that the item occupies in the tree-view control.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>Pointer to a <a href="/windows/win32/api/windef/ns-windef-rect"><strong>RECT</strong></a> structure that, when sending the message, contains the handle of the item to retrieve the rectangle for. See the example below for more information on how to place the item handle in this parameter. After returning from the message, this parameter contains the bounding rectangle. The coordinates are relative to the upper-left corner of the tree-view control.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the item is visible and the bounding rectangle was successfully retrieved, the return value is <strong>TRUE</strong>. Otherwise, the message returns <strong>FALSE</strong> and does not retrieve the bounding rectangle.</p>
<h2>Remarks</h2>
<p>When sending this message, the <em>lParam</em> parameter contains the handle of the item that the rectangle is being retrieved for. The handle is placed in <em>lParam</em> as shown in the following example:</p>
<pre><code>RECT rc;

*(HTREEITEM*)&amp;rc = hTreeItem;

SendMessage(hwndTreeView, TVM_GETITEMRECT, FALSE, (LPARAM)&amp;rc);
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Commctrl.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
