<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EM_SETTEXTMODE message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: EM_SETTEXTMODE message (Richedit.h)
description: Sets the text mode or undo level of a rich edit control. The message fails if the control contains any text.
ms.assetid: d6741234-0ef3-4cd2-8817-6c852f1b500d
keywords:</p>
<ul>
<li>EM_SETTEXTMODE message Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>EM_SETTEXTMODE
api_location:</li>
<li>Richedit.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>EM_SETTEXTMODE message</h1>
<p>Sets the text mode or undo level of a rich edit control. The message fails if the control contains any text.</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>One or more values from the <a href="/windows/win32/api/richedit/ne-richedit-textmode"><strong>TEXTMODE</strong></a> enumeration type. The values specify the new settings for the control's text mode and undo level parameters.</p>
<p>Specify one of the following values to set the text mode parameter. If you do not specify a text mode value, the text mode remains at its current setting.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/richedit/ne-richedit-textmode"><strong>TM_PLAINTEXT</strong></a></td>
<td>Indicates plain text mode, in which the control is similar to a standard edit control. For more information about plain text mode, see the following Remarks section.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/richedit/ne-richedit-textmode"><strong>TM_RICHTEXT</strong></a></td>
<td>Indicates rich text mode, in which the control has standard rich edit functionality. Rich text mode is the default setting.</td>
</tr>
</tbody>
</table>
<p>Specify one of the following values to set the undo level parameter. If you do not specify an undo level value, the undo level remains at its current setting.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/richedit/ne-richedit-textmode"><strong>TM_SINGLELEVELUNDO</strong></a></td>
<td>The control allows the user to undo only the last action that can be undone.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/richedit/ne-richedit-textmode"><strong>TM_MULTILEVELUNDO</strong></a></td>
<td>The control supports multiple undo operations. This is the default setting. Use the <a href="em-setundolimit.html"><strong>EM_SETUNDOLIMIT</strong></a> message to set the maximum number of undo actions.</td>
</tr>
</tbody>
</table>
<p>Specify one of the following values to set the code page parameter. If you do not specify an code page value, the code page remains at its current setting.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/richedit/ne-richedit-textmode"><strong>TM_SINGLECODEPAGE</strong></a></td>
<td>The control only allows the English keyboard and a keyboard corresponding to the default character set. For example, you could have Greek and English. Note that this prevents Unicode text from entering the control. For example, use this value if a Rich Edit control must be restricted to ANSI text.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/richedit/ne-richedit-textmode"><strong>TM_MULTICODEPAGE</strong></a></td>
<td>The control allows multiple code pages and Unicode text into the control. This is the default setting.</td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>This parameter is not used; it must be zero.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the message succeeds, the return value is zero.</p>
<p>If the message fails, the return value is a nonzero value.</p>
<h2>Remarks</h2>
<p>In rich text mode, a rich edit control has standard rich edit functionality. However, in plain text mode, the control is similar to a standard edit control:</p>
<ul>
<li>The text in a plain text control can have only one format (such as Bold, 10pt Arial).</li>
<li>The user cannot paste rich text formats, such as Rich Text Format (RTF) or embedded objects into a plain text control.</li>
<li>Rich text mode controls always have a default end-of-document marker or carriage return, to format paragraphs. Plain text controls, on the other hand, do not need the default, end-of-document marker, so it is omitted.</li>
</ul>
<p>The control must contain no text when it receives the <strong>EM_SETTEXTMODE</strong> message. To ensure there is no text, send a <a href="/windows/desktop/winmsg/wm-settext"><strong>WM_SETTEXT</strong></a> message with an empty string (&quot;&quot;).</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Richedit.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="em-gettextmode.html"><strong>EM_GETTEXTMODE</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="em-setundolimit.html"><strong>EM_SETUNDOLIMIT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/richedit/ne-richedit-textmode"><strong>TEXTMODE</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/winmsg/wm-settext"><strong>WM_SETTEXT</strong></a></p>
<!-- raw HTML omitted -->
</body>
