<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ImageList_SetColorTable function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: ImageList_SetColorTable function
description: Sets the color table for an image list.
ms.assetid: 1b62f468-cbc4-479b-b9f8-5553c2bd8c79
keywords:</p>
<ul>
<li>ImageList_SetColorTable function Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>ImageList_SetColorTable
api_location:</li>
<li>Comctl32.dll
api_type:</li>
<li>DllExport
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>ImageList_SetColorTable function</h1>
<p>Sets the color table for an image list.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>int ImageList_SetColorTable(
  _In_ HIMAGELIST himl,
  _In_ int        start,
  _In_ int        len,
  _In_ RGBQUAD    *prgb
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>himl</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>HIMAGELIST</strong></p>
<p>A handle to the image list.</p>
<!-- raw HTML omitted -->
<p><em>start</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>int</strong></p>
<p>A zero-based color table index that specifies the first color table entry to set.</p>
<!-- raw HTML omitted -->
<p><em>len</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>int</strong></p>
<p>The number of color table entries to set.</p>
<!-- raw HTML omitted -->
<p><em>prgb</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="/windows/win32/api/wingdi/ns-wingdi-rgbquad"><strong>RGBQUAD</strong></a>*</strong></p>
<p>A pointer to an array of <em>len</em> <a href="/windows/win32/api/wingdi/ns-wingdi-rgbquad"><strong>RGBQUAD</strong></a> structures containing new color information for the color table of the DIB.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>int</strong></p>
<p>If the function succeeds, it returns the number of color table entries set by the function. If the function fails, the return value is less than or equal to zero.</p>
<h2>Remarks</h2>
<p>Only image lists created with the <a href="/windows/desktop/api/Commctrl/nf-commctrl-imagelist_create"><strong>ILC_COLOR4</strong></a> or <a href="/windows/desktop/api/Commctrl/nf-commctrl-imagelist_create"><strong>ILC_COLOR8</strong></a> flag have color tables. The color table of such an image list is typically set automatically by copying the color table of the first image added to the list (for example, through the <a href="/windows/desktop/api/Commctrl/nf-commctrl-imagelist_add"><strong>ImageList_Add</strong></a> function) if that image is a DIB. If the first image added to the image list is not a DIB, then the color table of the halftone palette is used for <strong>ILC_COLOR8</strong> image lists and the VGA color table is used for <strong>ILC_COLOR4</strong>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Comctl32.dll (version 3.51 or later)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="https://msdn.microsoft.com/library/ms531197(v=VS.85).aspx">Color Table</a></p>
<!-- raw HTML omitted -->
</body>
