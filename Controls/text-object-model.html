<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Text Object Model</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Text Object Model
description: This section contains information about the programming elements used with the Text Object Model (TOM).
ms.assetid: 'vs|controls|~\controls\richedit\textobjectmodel.htm'
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Text Object Model</h1>
<p>This section contains information about the programming elements used with the Text Object Model (TOM).</p>
<p>The TOM defines a substantial set of text manipulation interfaces. Text solutions such as Microsoft Word and rich edit controls support the TOM feature set. TOM was greatly influenced by WordBasic (the programming language used for Word) and it is easy to use from Microsoft Visual Basic for Applications (VBA). This compatibility has several advantages:</p>
<ul>
<li>Code can migrate fairly easily from one solution to another.</li>
<li>One language can be used to share text information between different text engines.</li>
<li>It reduces the need for documentation and code compared to the separate low-level Component Object Model (COM) and VBA interfaces.</li>
</ul>
<p>However, it can be less efficient for C/C++ purposes than the use of more general lower level COM interfaces.</p>
<p>TOM is a straightforward set of interfaces to implement for its primary text solutions, Word and rich edit controls. However, for applications that place minor emphasis on text, it is better to provide TOM interfaces by transferring the text to an edit control that supports TOM. Since rich edit controls ship with Microsoft operating systems, they are the standard means of obtaining TOM functionality.</p>
<h3>Overviews</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="about-text-object-model.html">About Text Object Model</a></td>
<td>The top-level Text Object Model (TOM) object is defined by the <a href="/windows/desktop/api/Tom/nn-tom-itextdocument"><strong>ITextDocument</strong></a> interface, which has methods for creating and retrieving objects lower in the object hierarchy.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="using-the-text-object-model.html">Using The Text Object Model</a></td>
<td>The code samples in this document show various aspects of using the Text Object Model (TOM).<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Interfaces</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->ITextDocument<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>The <!-- raw HTML omitted --><!-- raw HTML omitted -->ITextDocument<!-- raw HTML omitted --><!-- raw HTML omitted --> interface is the TOM top-level interface, which retrieves the active selection and range objects for any story in the document whether active or not. It enables the application to:<!-- raw HTML omitted --><!-- raw HTML omitted -->Open and save documents.<!-- raw HTML omitted --><!-- raw HTML omitted -->Control undo behavior and screen updating.<!-- raw HTML omitted --><!-- raw HTML omitted -->Find a range from a screen position.<!-- raw HTML omitted --><!-- raw HTML omitted -->Get an <!-- raw HTML omitted --><!-- raw HTML omitted -->ITextStoryRanges<!-- raw HTML omitted --><!-- raw HTML omitted --> story enumerator.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->When to Implement<!-- raw HTML omitted --><!-- raw HTML omitted --> Applications typically do not implement the <!-- raw HTML omitted --><!-- raw HTML omitted -->ITextDocument<!-- raw HTML omitted --><!-- raw HTML omitted --> interface. Microsoft text solutions, such as rich edit controls, implement <!-- raw HTML omitted -->ITextDocument<!-- raw HTML omitted --> as part of their TOM implementation. <!-- raw HTML omitted --><!-- raw HTML omitted -->When to Use<!-- raw HTML omitted --><!-- raw HTML omitted --> Applications can retrieve an <!-- raw HTML omitted --><!-- raw HTML omitted -->ITextDocument<!-- raw HTML omitted --><!-- raw HTML omitted --> pointer from a rich edit control. To do this, send an <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_GETOLEINTERFACE<!-- raw HTML omitted --><!-- raw HTML omitted --> message to retrieve an <!-- raw HTML omitted --><!-- raw HTML omitted -->IRichEditOle<!-- raw HTML omitted --><!-- raw HTML omitted --> object from a rich edit control. Then, call the object's <!-- raw HTML omitted --><!-- raw HTML omitted -->IUnknown::QueryInterface<!-- raw HTML omitted --><!-- raw HTML omitted --> method to retrieve an <!-- raw HTML omitted -->ITextDocument<!-- raw HTML omitted --> pointer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->ITextFont<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>TOM rich text-range attributes are accessed through a pair of dual interfaces, <!-- raw HTML omitted --><!-- raw HTML omitted -->ITextFont<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->ITextPara<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->ITextPara<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>TOM rich text-range attributes are accessed through a pair of dual interfaces, <!-- raw HTML omitted --><!-- raw HTML omitted -->ITextFont<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->ITextPara<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->ITextRange<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>The <!-- raw HTML omitted --><!-- raw HTML omitted -->ITextRange<!-- raw HTML omitted --><!-- raw HTML omitted --> objects are powerful editing and data-binding tools that allow a program to select text in a story and then examine or change that text.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->ITextSelection<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>A text selection is a text range with selection highlighting.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->ITextStoryRanges<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>The purpose of the <!-- raw HTML omitted --><!-- raw HTML omitted -->ITextStoryRanges<!-- raw HTML omitted --><!-- raw HTML omitted --> interface is to enumerate the stories in an <!-- raw HTML omitted --><!-- raw HTML omitted -->ITextDocument<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
