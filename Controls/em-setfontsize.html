<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EM_SETFONTSIZE message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: EM_SETFONTSIZE message (Richedit.h)
description: Sets the font size for the selected text in a rich edit control.
ms.assetid: 18d91370-12c0-4e5f-a0e9-ffde02abc966
keywords:</p>
<ul>
<li>EM_SETFONTSIZE message Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>EM_SETFONTSIZE
api_location:</li>
<li>Richedit.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>EM_SETFONTSIZE message</h1>
<p>Sets the font size for the selected text in a rich edit control.</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>Change in point size of the selected text. The result will be rounded according to values shown in the following table. This parameter should be in the range of -1637 to 1638. The resulting font size will be within the range of 1 to 1638.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>This parameter is not used; it must be zero.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If no error occurred, the return value is <strong>TRUE</strong>.</p>
<p>If an error occurred, the return value is <strong>FALSE</strong>.</p>
<h2>Remarks</h2>
<p>You can easily get the font size by sending the <a href="em-getcharformat.html"><strong>EM_GETCHARFORMAT</strong></a> message.</p>
<p>Rich Edit first adds <em>wParam</em> to the current font size and then uses the resulting size and the following table to determine the rounding value.</p>
<table>
<thead>
<tr>
<th>Band</th>
<th>Rounding value</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;=12</td>
<td>1</td>
</tr>
<tr>
<td>28</td>
<td>2</td>
</tr>
<tr>
<td>36</td>
<td>0</td>
</tr>
<tr>
<td>48</td>
<td>0</td>
</tr>
<tr>
<td>72</td>
<td>0</td>
</tr>
<tr>
<td>80</td>
<td>0</td>
</tr>
<tr>
<td>&gt; 80</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>If the resulting font size is not evenly divisible by the rounding value, the font size is then rounded to a number evenly divisible by the rounding value. So if the font size is less than or equal to 12, the rounding value will be 1. Similarly, if the font size is less than or equal to 28, the rounding value is 2. For values greater than 28, font sizes are rounded to the next band. So, the font size jumps to 36, 48, 72, 80. After 80, all rounding is done in increments of ten points.</p>
<p>The font size is rounded up or down depending on the sign of <em>wParam</em>. If <em>wParam</em> is positive, the rounding is always up. Otherwise, rounding is always down. So, if the current font size is 10 and <em>wParam</em> is 3, the resulting font size would be 14 (10 + 3 = 13, which is not divisible by 2, so the size rounds up to 14). Conversely, if the current font size is 14 and <em>wParam</em> is -3, the resulting font size would be 10 (14 - 3 = 11, which is not divisible by 2, so the size rounds down to 10).</p>
<p>The change is applied to each part of the selection. So, if some of the text is 10pt and some 20pt, after a call with <em>wParam</em> set to 1, the font sizes become 11pt and 22pt, respectively.</p>
<p>Additional examples are shown in the following table.</p>
<table>
<thead>
<tr>
<th>Original font size</th>
<th><em>wParam</em></th>
<th>Resulting font size</th>
</tr>
</thead>
<tbody>
<tr>
<td>7</td>
<td>1</td>
<td>8</td>
</tr>
<tr>
<td>7</td>
<td>3</td>
<td>10</td>
</tr>
<tr>
<td>10</td>
<td>3</td>
<td>14</td>
</tr>
<tr>
<td>14</td>
<td>-3</td>
<td>10</td>
</tr>
<tr>
<td>28</td>
<td>1</td>
<td>36</td>
</tr>
<tr>
<td>28</td>
<td>3</td>
<td>36</td>
</tr>
<tr>
<td>80</td>
<td>1</td>
<td>90</td>
</tr>
<tr>
<td>80</td>
<td>-1</td>
<td>72</td>
</tr>
</tbody>
</table>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>Rich Edit 3.0<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Richedit.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="em-getcharformat.html"><strong>EM_GETCHARFORMAT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Richedit/ns-richedit-charformat2a"><strong>CHARFORMAT2</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="about-rich-edit-controls.html">About Rich Edit Controls</a></p>
<!-- raw HTML omitted -->
</body>
