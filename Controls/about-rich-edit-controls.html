<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>About Rich Edit Controls</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: About Rich Edit Controls
description: This section introduces rich edit controls.
ms.assetid: ab9dcdf4-a311-4159-8f37-e67e144f31f6
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>About Rich Edit Controls</h1>
<p>The following topics are discussed in this section.</p>
<ul>
<li><a href="#versions-of-rich-edit">Versions of Rich Edit</a>
<ul>
<li><a href="#rich-edit-version-10">Rich Edit Version 1.0</a></li>
<li><a href="#rich-edit-version-20">Rich Edit Version 2.0</a></li>
<li><a href="#rich-edit-version-30">Rich Edit Version 3.0</a></li>
<li><a href="#rich-edit-version-41">Rich Edit Version 4.1</a></li>
</ul>
</li>
<li><a href="#unsupported-edit-control-functionality">Unsupported Edit Control Functionality</a></li>
<li><a href="#rich-edit-shortcut-keys">Rich Edit Shortcut Keys</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Versions of Rich Edit</h2>
<p>The original specification for rich edit controls is Microsoft Rich Edit 1.0; the current specification is Microsoft Rich Edit 4.1. Each version of rich edit is a superset of the preceding one, except that only Asian builds of Microsoft Rich Edit 1.0 have a vertical text option. Before creating a rich edit control, you should call the <a href="/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya"><strong>LoadLibrary</strong></a> function to verify which version of Microsoft Rich Edit is installed.</p>
<p>The following table shows which DLL corresponds with which version of Rich Edit. Note that the name of the file did not change from version 2.0 to version 3.0. This allows version 2.0 to be upgraded to version 3.0 without breaking existing code.</p>
<table>
<thead>
<tr>
<th>Rich Edit version</th>
<th>DLL</th>
<th>Window Class</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.0</td>
<td>Riched32.dll</td>
<td>RICHEDIT_CLASS</td>
</tr>
<tr>
<td>2.0</td>
<td>Riched20.dll</td>
<td>RICHEDIT_CLASS</td>
</tr>
<tr>
<td>3.0</td>
<td>Riched20.dll</td>
<td>RICHEDIT_CLASS</td>
</tr>
<tr>
<td>4.1</td>
<td>Msftedit.dll</td>
<td>MSFTEDIT_CLASS</td>
</tr>
</tbody>
</table>
<h3>Rich Edit Version 1.0</h3>
<p>Microsoft Rich Edit 1.0 includes the following features.</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Text entry and selection</td>
<td>Mostly standard (system-edit control) selection and entry of text. Selection bar support (the selection bar is an unmarked area to the left of each paragraph that when clicked, selects the line). Word-wrap and auto-word-select options. Single-, double-, and triple-click selection.</td>
</tr>
<tr>
<td>ANSI (single-byte character set (SBCS) and multibyte character set (MBCS)) editing</td>
<td>However, there is no Unicode editing.</td>
</tr>
<tr>
<td>Basic set of character/paragraph formatting properties</td>
<td>See <a href="/windows/win32/api/richedit/ns-richedit-charformata"><strong>CHARFORMAT</strong></a> and <a href="/windows/desktop/api/Richedit/ns-richedit-paraformat"><strong>PARAFORMAT</strong></a>.</td>
</tr>
<tr>
<td>Character formatting properties</td>
<td>Font name and size, bold, italic, solid underline, strike-out, protected, link, offset, and text color.</td>
</tr>
<tr>
<td>Paragraph formatting properties</td>
<td>Start indent, right indent, subsequent line offset, bullet, alignment (left, center, right), and tabs.</td>
</tr>
<tr>
<td>Find forward</td>
<td>Includes case-insensitive and match-whole-word options.</td>
</tr>
<tr>
<td>Message-based interface</td>
<td>Almost a superset of the system edit-control message set plus two interfaces, <a href="/windows/desktop/api/Richole/nn-richole-iricheditole"><strong>IRichEditOle</strong></a> and <a href="/windows/desktop/api/Richole/nn-richole-iricheditolecallback"><strong>IRichEditOleCallback</strong></a>.</td>
</tr>
<tr>
<td>Embedded objects</td>
<td>Requires client collaboration based on <a href="/windows/desktop/api/Richole/nn-richole-iricheditole"><strong>IRichEditOle</strong></a> and <a href="/windows/desktop/api/Richole/nn-richole-iricheditolecallback"><strong>IRichEditOleCallback</strong></a> interfaces.</td>
</tr>
<tr>
<td>Right-button menu support</td>
<td>Uses <a href="/windows/desktop/api/Richole/nn-richole-iricheditolecallback"><strong>IRichEditOleCallback</strong></a> interface.</td>
</tr>
<tr>
<td>Drag-and-drop editing</td>
<td>Drag-and-drop editing is supported.</td>
</tr>
<tr>
<td>Notifications</td>
<td><a href="/windows/desktop/menurc/wm-command"><strong>WM_COMMAND</strong></a> messages sent to client plus a number of others. This is a superset of common-control notifications.</td>
</tr>
<tr>
<td>Single-level undo/redo</td>
<td>Behaves similarly to the system edit control. Selecting <strong>Undo</strong> reverses the last action, and that action then becomes the new <strong>Redo</strong> action.</td>
</tr>
<tr>
<td>Simple vertical text</td>
<td>(Asian builds only).</td>
</tr>
<tr>
<td>Input Method Editor (IME) support</td>
<td>(Asian builds only).</td>
</tr>
<tr>
<td>WYSIWYG editing using printer metrics</td>
<td>This feature is needed for Microsoft WordPad, in particular.</td>
</tr>
<tr>
<td>Cut/Copy/Paste/StreamIn/StreamOut</td>
<td>With plain text (<strong>CF_TEXT</strong>) or Rich Text Format (RTF) with and without objects.</td>
</tr>
<tr>
<td>C code base</td>
<td>The code is written in C, which provides a solid and versatile foundation.</td>
</tr>
<tr>
<td>Different builds for different scripts</td>
<td>Microsoft Rich Edit 1.0 addresses localization issues with different builds.</td>
</tr>
</tbody>
</table>
<h3>Rich Edit Version 2.0</h3>
<p>Microsoft Rich Edit 2.0 incorporated several additional features, such as support for Unicode and Asian languages, multilevel Undo, Component Object Model (COM) interfaces, and numerous UI enhancements.</p>
<p>Microsoft Rich Edit 2.0 includes the following features in addition to the features provided by <a href="#rich-edit-version-10">Microsoft Rich Edit 1.0</a>.</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Unicode</td>
<td>Unicode eases the effort in handling international text. However effort is needed to maintain compatibility with existing non-Unicode documents that is, the ability to convert to/from non-Unicode plain and rich text.</td>
</tr>
<tr>
<td>General international support</td>
<td>General line breaking algorithm (extension of Kinsoku rules), simple font linking, keyboard font switching.</td>
</tr>
<tr>
<td>Asian support</td>
<td>Level 2 (dialog box) and 3 (inline) is supported in IMEs.</td>
</tr>
<tr>
<td>Find Up/Find Down support</td>
<td>Searching forward and backward is supported.</td>
</tr>
<tr>
<td>Bidirectional support</td>
<td>This is included in Microsoft Rich Edit 2.1</td>
</tr>
<tr>
<td>Multilevel undo</td>
<td>An extensible Undo architecture allows client to participate in application-wide Undo model.</td>
</tr>
<tr>
<td>Magellan mouse support</td>
<td>This is the mouse with a roller for scrolling.</td>
</tr>
<tr>
<td>Dual-font support</td>
<td>The keyboard can automatically switch fonts when the active font is inappropriate for current keyboard, for example, Kanji characters in Times New Roman.</td>
</tr>
<tr>
<td>Smart font apply</td>
<td>Font change request does not apply Western fonts to Asian characters.</td>
</tr>
<tr>
<td>Improved display</td>
<td>An off-screen bitmap is used when multiple fonts occur on the same line. This allows, for example, the last letter of the word cool not to be chopped off.</td>
</tr>
<tr>
<td>Transparency support</td>
<td>Also in windowless mode.</td>
</tr>
<tr>
<td>System selection colors</td>
<td>Used for selecting text.</td>
</tr>
<tr>
<td>Automatic URL recognition</td>
<td>Can check for a number of URL formats (for example, http:)</td>
</tr>
<tr>
<td>Microsoft Word edit UI compatibility</td>
<td>Selection, cursor-keypad semantics.</td>
</tr>
<tr>
<td>Word standard EOP</td>
<td>The end-of-paragraph mark (CR) can also handle carriage return/line feed (CR/LF) (carriage return, line feed).</td>
</tr>
<tr>
<td>Plain-text as well as rich-text functionality</td>
<td>Single-character format and single-paragraph format.</td>
</tr>
<tr>
<td>Single-line and multiline controls</td>
<td>Truncate at first end-of-paragraph and no wordwrap.</td>
</tr>
<tr>
<td>Accelerator keys</td>
<td>Accelerator keys are supported.</td>
</tr>
<tr>
<td>Password window style</td>
<td>Password edit controls are supplied through <a href="em-getpasswordchar.html"><strong>EM_GETPASSWORDCHAR</strong></a> and <a href="em-setpasswordchar.html"><strong>EM_SETPASSWORDCHAR</strong></a>.</td>
</tr>
<tr>
<td>Scalable architecture</td>
<td>To reduce instance size.</td>
</tr>
<tr>
<td>Windowless operation and interfaces</td>
<td>This is provided through the <a href="/windows/desktop/api/Textserv/nl-textserv-itexthost"><strong>ITextHost</strong></a> and <a href="/windows/desktop/api/Textserv/nl-textserv-itextservices"><strong>ITextServices</strong></a> interfaces.</td>
</tr>
<tr>
<td>COM dual interfaces</td>
<td>Text Object Model (TOM) interfaces.</td>
</tr>
<tr>
<td>CHARFORMAT2</td>
<td>Added font weight, background color, locale identifier, underline type, superscript and subscript (in addition to offset), disabled effect. For RTF roundtripping only, added amount to space between letters, twip size above which to kern character pair, animated-text type, various effects: font shadow/outline, all caps, small caps, hidden, embossed, imprint, and revised.</td>
</tr>
<tr>
<td>PARAFORMAT2</td>
<td>Added space before and after and Word line spacing. For RTF roundtripping only, added shading weight/style, numbering start/style/tab, border space/width/sides, tab alignment/leaders, various Word paragraph effects: RTL paragraph, keep, keep-next, page-break-before, no-line-number, no-widow-control, do-not-hyphenate, side-by-side.</td>
</tr>
<tr>
<td>More RTF roundtripping</td>
<td>All of the Word FormatFont and FormatParagraph properties.</td>
</tr>
<tr>
<td>Code stability and stabilization</td>
<td>Examples: parameter and object validation, function invariants, reentrancy guards, object stabilization.</td>
</tr>
<tr>
<td>Strong testing infrastructure</td>
<td>Including extensive regressions tests.</td>
</tr>
<tr>
<td>Improved performance</td>
<td>Smaller working set, faster load and redisplay times, and so on.</td>
</tr>
<tr>
<td>C++ code base</td>
<td>The code is written in C++, which provides a solid foundation on which to build Microsoft Rich Edit 3.0.</td>
</tr>
</tbody>
</table>
<p>With a few exceptions, Microsoft Rich Edit 2.0 uses the same functions, structures, and messages as Microsoft Rich Edit 1.0. Note, however, the following differences:</p>
<ul>
<li>
<p>The name of the Microsoft Rich Edit 1.0 window class is <strong>RichEdit</strong>. Microsoft Rich Edit 2.0 has both ANSI and Unicode window classes <strong>RichEdit20A</strong> and <strong>RichEdit20W,</strong> respectively. To specify the appropriate rich edit window class, use the RICHEDIT_CLASS constant, which the Richedit.h file defines depending on the definition of the UNICODE compile flag.</p>
</li>
<li>
<p>In Microsoft Rich Edit 2.0, if you create a Unicode rich edit control (one that expects Unicode text messages), you must specify only Unicode data in any window messages sent to the control. Similarly, if you create an ANSI rich edit control, send only ANSI or double-byte character set (DBCS) data. You can use the <a href="/windows/desktop/api/winuser/nf-winuser-iswindowunicode"><strong>IsWindowUnicode</strong></a> function to determine whether a rich edit control uses Unicode text messages. Note that the rich edit COM interfaces use Unicode text unless they encounter a code page argument.</p>
</li>
<li>
<p>Microsoft Rich Edit 1.0 used CR/LF character combinations for paragraph markers. Microsoft Rich Edit 2.0 used only a carriage return character ('\r'). Microsoft Rich Edit 3.0 uses only a carriage return character but can emulate Microsoft Rich Edit 1.0 in this regard.</p>
</li>
<li>
<p>Microsoft Rich Edit 2.0 introduced the following new messages.</p>
<table>
<thead>
<tr>
<th>Message</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="em-autourldetect.html"><strong>EM_AUTOURLDETECT</strong></a></td>
<td>Enables or disables automatic URL detection.</td>
</tr>
<tr>
<td><a href="em-canredo.html"><strong>EM_CANREDO</strong></a></td>
<td>Determines whether there are any actions in the redo queue.</td>
</tr>
<tr>
<td><a href="em-getimecompmode.html"><strong>EM_GETIMECOMPMODE</strong></a></td>
<td>Retrieves the current input method editor (IME) mode.</td>
</tr>
<tr>
<td><a href="em-getlangoptions.html"><strong>EM_GETLANGOPTIONS</strong></a></td>
<td>Retrieves options for IME and Asian language support.</td>
</tr>
<tr>
<td><a href="em-getredoname.html"><strong>EM_GETREDONAME</strong></a></td>
<td>Retrieves the type name of the next action in the redo queue.</td>
</tr>
<tr>
<td><a href="em-gettextmode.html"><strong>EM_GETTEXTMODE</strong></a></td>
<td>Retrieves the text mode or undo level.</td>
</tr>
<tr>
<td><a href="em-getundoname.html"><strong>EM_GETUNDONAME</strong></a></td>
<td>Retrieves the type name of the next action in the undo queue.</td>
</tr>
<tr>
<td><a href="em-redo.html"><strong>EM_REDO</strong></a></td>
<td>Redoes the next action in the redo queue.</td>
</tr>
<tr>
<td><a href="em-setlangoptions.html"><strong>EM_SETLANGOPTIONS</strong></a></td>
<td>Sets options for IME and Asian language support.</td>
</tr>
<tr>
<td><a href="em-settextmode.html"><strong>EM_SETTEXTMODE</strong></a></td>
<td>Sets the text mode or undo level.</td>
</tr>
<tr>
<td><a href="em-setundolimit.html"><strong>EM_SETUNDOLIMIT</strong></a></td>
<td>Sets the maximum number of actions in the undo queue.</td>
</tr>
<tr>
<td><a href="em-stopgrouptyping.html"><strong>EM_STOPGROUPTYPING</strong></a></td>
<td>Stops grouping consecutive typing actions into the current undo action.</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Microsoft Rich Edit 2.0 introduced the following new structures.</p>
<table>
<thead>
<tr>
<th>Structure</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Richedit/ns-richedit-charformat2a"><strong>CHARFORMAT2</strong></a></td>
<td>Contains information about character formatting.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Richedit/ns-richedit-paraformat2"><strong>PARAFORMAT2</strong></a></td>
<td>Contains information about paragraph formatting.</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>The following messages are supported only in Asian-language versions of Microsoft Rich Edit 1.0. They are not supported in any later versions of Rich Edit.</p>
<p><a href="em-convposition.html"><strong>EM_CONVPOSITION</strong></a></p>
<p><a href="em-getimecolor.html"><strong>EM_GETIMECOLOR</strong></a></p>
<p><a href="em-getimeoptions.html"><strong>EM_GETIMEOPTIONS</strong></a></p>
<p><a href="em-getpunctuation.html"><strong>EM_GETPUNCTUATION</strong></a></p>
<p><a href="em-getwordwrapmode.html"><strong>EM_GETWORDWRAPMODE</strong></a></p>
<p><a href="em-setimecolor.html"><strong>EM_SETIMECOLOR</strong></a></p>
<p><a href="em-setimeoptions.html"><strong>EM_SETIMEOPTIONS</strong></a></p>
<p><a href="em-setpunctuation.html"><strong>EM_SETPUNCTUATION</strong></a></p>
<p><a href="em-setwordwrapmode.html"><strong>EM_SETWORDWRAPMODE</strong></a></p>
</li>
</ul>
<h3>Rich Edit Version 3.0</h3>
<p>Microsoft Rich Edit 3.0 is a single, scalable, world-wide DLL that offers high performance and compatibility with Word in a small package. New features for Microsoft Rich Edit 3.0 include richer text, zoom, font binding, more powerful IME support, and rich complex script support (bidirectional, Indic, and Thai).</p>
<p>Microsoft Rich Edit 3.0 includes the following features in addition to the features provided by <a href="#rich-edit-version-20">Rich Edit Version 2.0</a>.</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Zoom</td>
<td>The zoom factor is given by a ratio.</td>
</tr>
<tr>
<td>Paragraph numbering (single-level)</td>
<td>Numeric, upper and lower alphabetic, or Roman numeral.</td>
</tr>
<tr>
<td>Simple tables</td>
<td>Deleting and inserting rows is possible, but not resizing nor wrapping inside cells. With advanced typography turned on (see <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_GETTYPOGRAPHYOPTIONS<!-- raw HTML omitted --><!-- raw HTML omitted -->), Microsoft Rich Edit 3.0 can align columns centered or flush right, and include decimals. Cells are simulated by tabs, so text tabs and carriage returns are replaced by blanks.</td>
</tr>
<tr>
<td>Normal and heading styles</td>
<td>Built-in normal style and heading styles 1 through 9 are supported by the <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_SETPARAFORMAT<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted -->Text Object Model<!-- raw HTML omitted --> (TOM) interfaces.</td>
</tr>
<tr>
<td>More underline types</td>
<td>Dashed, dash-dot, dash-dot-dot, and dot underlining has been added.</td>
</tr>
<tr>
<td>Underline coloring</td>
<td>Underlined text can be tagged with one of 15 document choices for underline colors.</td>
</tr>
<tr>
<td>Hidden text</td>
<td>Marked by CHARFORMAT2 attribute. Handy for roundtripping (writing out to a file what was read in) of information that ordinarily should not be displayed.</td>
</tr>
<tr>
<td>More default hot keys</td>
<td>These hot keys function the same as those in Word. For example, European accent dead keys (U.S. keyboards only). Number hot key (CTRL+L) cycles through numbering options available, starting with bullet.</td>
</tr>
<tr>
<td>HexToUnicode IME</td>
<td>Allows a user to convert between hexadecimal and Unicode by using hot keys.</td>
</tr>
<tr>
<td>Smart quotes</td>
<td>This feature is toggled on and off by CTRL+ALT+' for U.S. keyboards.</td>
</tr>
<tr>
<td>Soft hyphens</td>
<td>For plain text, use 0xAD. For RTF, use -.</td>
</tr>
<tr>
<td>Italics cursor</td>
<td>In addition, the mouse cursor changes to a hand when over URLs.</td>
</tr>
<tr>
<td>Advanced typography option</td>
<td>Microsoft Rich Edit 3.0 can use an advanced typography option for line breaking and display (see <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_GETTYPOGRAPHYOPTIONS<!-- raw HTML omitted --><!-- raw HTML omitted -->). This elegant option was added primarily to facilitate handling complex scripts (bidirectional, Indic, and Thai). In addition, a number of improvements occur for simple scripts. Examples are:<!-- raw HTML omitted --><!-- raw HTML omitted -->Center, right, decimal tabs<!-- raw HTML omitted --><!-- raw HTML omitted -->Fully justified text<!-- raw HTML omitted --><!-- raw HTML omitted -->Underline averaging, which provides a uniform underline even when adjacent text runs have different font sizes.<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Complex script support</td>
<td>Microsoft Rich Edit 3.0 supports bidirectional (text with Arabic and/or Hebrew mixed with other scripts), Indic (Indian scripts like Devangari), and Thai text. For support of these complex scripts, the advanced typography and Uniscribe components are used.</td>
</tr>
<tr>
<td>Font binding</td>
<td>Microsoft Rich Edit 3.0 will automatically choose an appropriate font for characters that clearly do not belong to the current character set stamp. This is done by assigning character sets to text runs and associating fonts with those character sets. For more information, see <!-- raw HTML omitted -->Font Binding<!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td>Plain-text read/write options specific to character sets</td>
<td>This allows reading a file using one character set, and writing with a different character set.</td>
</tr>
<tr>
<td>UTF-8 RTF</td>
<td>This is recommended for cutting, copying, and pasting operations. This file format is more compact than ordinary RTF, faster, and compatible with Unicode.</td>
</tr>
<tr>
<td>Microsoft Office 9 IME support (IME98)</td>
<td>This more powerful IME capability has been separated into an independent module. Features include:<!-- raw HTML omitted --><!-- raw HTML omitted -->Reconversion In the earlier versions, the user needed to delete the final string first and then type in a new string to get to the correct candidate. This new feature enables the user to convert the final string back to composition mode, thereby allowing easy selection of a different candidate string.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Document feed This feature provides IME98 with the text for the current paragraph, which helps IME98 perform more accurate conversion during typing.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Mouse operation This feature provides better control over the candidate and UI windows during typing.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Caret position This feature provides the current caret and line information, which IME98 uses to position UI windows (for example, a candidate list).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Active Input Method Manager (IMM) support</td>
<td>Users can invoke the Active IMM object, which enables users to enter Asian characters on U.S. systems.</td>
</tr>
<tr>
<td>HexToUnicode support</td>
<td>Users can convert between hexadecimal notation and Unicode by using hot keys.</td>
</tr>
<tr>
<td>More RTF roundtripping</td>
<td>RTF text that is read in from a file will be written back out intact.</td>
</tr>
<tr>
<td>Improved 1.0 compatibility mode</td>
<td>Microsoft Rich Edit 3.0 can emulate Microsoft Rich Edit 1.0 behavior. For example, it is possible to change between MBCS and Unicode character-position (cp) mappings.</td>
</tr>
<tr>
<td>Increased freeze control</td>
<td>The display can be frozen over multiple API calls and then unfrozen to display the updates.</td>
</tr>
<tr>
<td>Increased undo control</td>
<td>Undo can be suspended and resumed (an IME requirement).</td>
</tr>
<tr>
<td>Increase/decrease font size</td>
<td>Increases or decreases font size to one of six standard values (12, 28, 36, 48, 72, and 80 points).</td>
</tr>
</tbody>
</table>
<h3>Rich Edit Version 4.1</h3>
<p>The window class for Microsoft Rich Edit 4.1 is MSFTEDIT_CLASS. New features for Microsoft Rich Edit 4.1 include hyphenation, page rotation, and Text Services Framework (TSF) support.</p>
<p>Microsoft Rich Edit 4.1 includes the following features in addition to the features provided by <a href="#rich-edit-version-30">Rich Edit Version 3.0</a>.</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hyphenation</td>
<td>Hyphenation is supported through the following APIs: <!-- raw HTML omitted --><!-- raw HTML omitted -->HyphenateProc<!-- raw HTML omitted --><!-- raw HTML omitted -->, <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_SETHYPHENATEINFO<!-- raw HTML omitted --><!-- raw HTML omitted -->, and <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_GETHYPHENATEINFO<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td>Page rotation</td>
<td>Top-to-bottom and bottom-to-top layout is supported through <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_SETPAGEROTATE<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_GETPAGEROTATE<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td>Text Services Framework support</td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->To turn on TSF and certain TSF features, use the following styles in <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_SETEDITSTYLE<!-- raw HTML omitted --><!-- raw HTML omitted -->: SES_USECTF, SES_CTFALLOWEMBED, SES_CTFALLOWPROOFING, and SES_CTFALLOWSMARTTAG.<!-- raw HTML omitted --><!-- raw HTML omitted -->To set and get the TSF mode bias, use <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_SETCTFMODEBIAS<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_GETCTFMODEBIAS<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted -->To set and get the TSF keyboard status, use <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_SETCTFOPENSTATUS<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_GETCTFOPENSTATUS<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Additional IME support</td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->To set and get the IME mode bias, use <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_SETIMEMODEBIAS<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_GETIMEMODEBIAS<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted -->To get the properties and capabilities of the IME, use <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_GETIMEPROPERTY<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted -->To get the IME composition text, use <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_GETIMECOMPTEXT<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted -->To determine whether the locale is an East Asian locale, use <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_ISIME<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Additional <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_SETEDITSTYLE<!-- raw HTML omitted --><!-- raw HTML omitted --> settings</td>
<td>Besides the TSF settings, there are new settings that exclude IMEs, set bidirectional text flow, use draftmode fonts, and more.</td>
</tr>
<tr>
<td>Additional <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_SETCHARFORMAT<!-- raw HTML omitted --><!-- raw HTML omitted --> settings</td>
<td>New flags allow the client to set the default font and font sizes for a given LCID or character set, to set the default font for the control, to prevent keyboard switching to match the font, and more.</td>
</tr>
<tr>
<td>Restricting input to ANSI text</td>
<td>Using <!-- raw HTML omitted --><!-- raw HTML omitted -->TM_SINGLECODEPAGE<!-- raw HTML omitted --><!-- raw HTML omitted --> in <!-- raw HTML omitted --><!-- raw HTML omitted -->EM_SETTEXTMODE<!-- raw HTML omitted --><!-- raw HTML omitted --> prevents Unicode input from entering a Rich Edit control.</td>
</tr>
<tr>
<td>Unsupported RTF keyword notification</td>
<td><!-- raw HTML omitted -->EN_LOWFIRTF<!-- raw HTML omitted --> warns an application when there is an unsupported RTF keyword.</td>
</tr>
<tr>
<td>Additional language support</td>
<td>Additional languages include Armenian, Divehi, Telugu, and others.</td>
</tr>
<tr>
<td>Improved table support</td>
<td>Features include: wrapping within cells, improved handling via RTF, and improved navigation.</td>
</tr>
<tr>
<td>ES_VERTICAL</td>
<td>The <!-- raw HTML omitted --><!-- raw HTML omitted -->ES_VERTICAL<!-- raw HTML omitted --><!-- raw HTML omitted --> window style is supported.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->WM_UNICHAR<!-- raw HTML omitted --><!-- raw HTML omitted --> support</td>
<td>To send or post Unicode characters to ANSI windows, use <!-- raw HTML omitted --><!-- raw HTML omitted -->WM_UNICHAR<!-- raw HTML omitted --><!-- raw HTML omitted -->. It is equivalent to <!-- raw HTML omitted --><!-- raw HTML omitted -->WM_CHAR<!-- raw HTML omitted --><!-- raw HTML omitted -->, but it uses (UTF)-32.</td>
</tr>
</tbody>
</table>
<h2>Unsupported Edit Control Functionality</h2>
<p>Rich edit controls support most but not all functionality for multiline edit controls. This section lists the edit control messages and window styles that are <em>not</em> supported by rich edit controls.</p>
<p>The following messages are processed by edit controls but <em>not</em> by rich edit controls.</p>
<table>
<thead>
<tr>
<th>Unsupported message</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="em-fmtlines.html"><strong>EM_FMTLINES</strong></a></td>
<td>Not supported.</td>
</tr>
<tr>
<td><a href="em-gethandle.html"><strong>EM_GETHANDLE</strong></a></td>
<td>Rich edit controls do not store text as a simple array of characters.</td>
</tr>
<tr>
<td><a href="em-getimestatus.html"><strong>EM_GETIMESTATUS</strong></a></td>
<td>Not supported.</td>
</tr>
<tr>
<td><a href="em-getmargins.html"><strong>EM_GETMARGINS</strong></a></td>
<td>Not supported.</td>
</tr>
<tr>
<td><a href="em-sethandle.html"><strong>EM_SETHANDLE</strong></a></td>
<td>Rich edit controls do not store text as a simple array of characters.</td>
</tr>
<tr>
<td><a href="em-setimestatus.html"><strong>EM_SETIMESTATUS</strong></a></td>
<td>Not supported.</td>
</tr>
<tr>
<td><a href="em-setmargins.html"><strong>EM_SETMARGINS</strong></a></td>
<td>Supported in Microsoft Rich Edit 3.0.</td>
</tr>
<tr>
<td><a href="em-setrectnp.html"><strong>EM_SETRECTNP</strong></a></td>
<td>Not supported.</td>
</tr>
<tr>
<td><a href="em-settabstops.html"><strong>EM_SETTABSTOPS</strong></a></td>
<td>The <a href="em-setparaformat.html"><strong>EM_SETPARAFORMAT</strong></a> message is used instead. Supported in Microsoft Rich Edit 3.0.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/DevNotes/wm-ctlcolor-"><strong>WM_CTLCOLOR</strong></a></td>
<td>The <a href="em-setbkgndcolor.html"><strong>EM_SETBKGNDCOLOR</strong></a> message is used instead.</td>
</tr>
<tr>
<td><a href="/windows/desktop/winmsg/wm-getfont"><strong>WM_GETFONT</strong></a></td>
<td>The <a href="em-getcharformat.html"><strong>EM_GETCHARFORMAT</strong></a> message is used instead.</td>
</tr>
</tbody>
</table>
<p>The following window styles are used with multiline edit controls but not with rich edit controls: <a href="edit-control-styles.html"><strong>ES_LOWERCASE</strong></a>, <a href="edit-control-styles.html"><strong>ES_UPPERCASE</strong></a>, and <a href="edit-control-styles.html"><strong>ES_OEMCONVERT</strong></a>.</p>
<h2>Rich Edit Shortcut Keys</h2>
<p>Rich edit controls support the following shortcut keys.</p>
<table>
<thead>
<tr>
<th>Keys</th>
<th>Operations</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td>Shift+Backspace</td>
<td>Generate a LRM/LRM on a bidi keyboard</td>
<td>BiDi specific</td>
</tr>
<tr>
<td>Ctrl+Tab</td>
<td>Tab</td>
<td></td>
</tr>
<tr>
<td>Ctrl+Clear</td>
<td>Select all</td>
<td></td>
</tr>
<tr>
<td>Ctrl+Number Pad 5</td>
<td>Select all</td>
<td></td>
</tr>
<tr>
<td>Ctrl+A</td>
<td>Select all</td>
<td></td>
</tr>
<tr>
<td>Ctrl+E</td>
<td>Center alignment</td>
<td></td>
</tr>
<tr>
<td>Ctrl+J</td>
<td>Justify alignment</td>
<td></td>
</tr>
<tr>
<td>Ctrl+R</td>
<td>Right alignment</td>
<td></td>
</tr>
<tr>
<td>Ctrl+L</td>
<td>Left alignment</td>
<td></td>
</tr>
<tr>
<td>Ctrl+C</td>
<td>Copy</td>
<td></td>
</tr>
<tr>
<td>Ctrl+V</td>
<td>Paste</td>
<td></td>
</tr>
<tr>
<td>Ctrl+X</td>
<td>Cut</td>
<td></td>
</tr>
<tr>
<td>Ctrl+Z</td>
<td>Undo</td>
<td></td>
</tr>
<tr>
<td>Ctrl+Y</td>
<td>Redo</td>
<td></td>
</tr>
<tr>
<td>Ctrl+'+' (Ctrl+Shift+'=')</td>
<td>Superscript</td>
<td></td>
</tr>
<tr>
<td>Ctrl+'='</td>
<td>Subscript</td>
<td></td>
</tr>
<tr>
<td>Ctrl+1</td>
<td>Line spacing = 1 line.</td>
<td></td>
</tr>
<tr>
<td>Ctrl+2</td>
<td>Line spacing = 2 lines.</td>
<td></td>
</tr>
<tr>
<td>Ctrl+5</td>
<td>Line spacing = 1.5 lines.</td>
<td></td>
</tr>
<tr>
<td>Ctrl+' (apostrophe)</td>
<td>Accent acute</td>
<td>After pressing the short cut key, press the appropriate letter (for example a, e, or u). This applies to English, French, German, Italian, and Spanish keyboards only.</td>
</tr>
<tr>
<td>Ctrl+` (grave)</td>
<td>Accent grave</td>
<td>See Ctrl+' comments.</td>
</tr>
<tr>
<td>Ctrl+~ (tilde)</td>
<td>Accent tilde</td>
<td>See Ctrl+' comments.</td>
</tr>
<tr>
<td>Ctrl+; (semicolon)</td>
<td>Accent umlaut</td>
<td>See Ctrl+' comments.</td>
</tr>
<tr>
<td>Ctrl+Shift+6</td>
<td>Accent caret (circumflex)</td>
<td>See Ctrl+' comments.</td>
</tr>
<tr>
<td>Ctrl+, (comma)</td>
<td>Accent cedilla</td>
<td>See Ctrl+' comments.</td>
</tr>
<tr>
<td>Ctrl+Shift+' (apostrophe)</td>
<td>Activate smart quotes</td>
<td></td>
</tr>
<tr>
<td>Backspace</td>
<td>If text is protected, beep and do not delete it. Otherwise, delete previous character.</td>
<td></td>
</tr>
<tr>
<td>Ctrl+Backspace</td>
<td>Delete previous word. This generates a VK_F16 code.</td>
<td></td>
</tr>
<tr>
<td>F16</td>
<td>Same as Backspace.</td>
<td></td>
</tr>
<tr>
<td>Ctrl+Insert</td>
<td>Copy</td>
<td></td>
</tr>
<tr>
<td>Shift+Insert</td>
<td>Paste</td>
<td></td>
</tr>
<tr>
<td>Insert</td>
<td>Overwrite</td>
<td>DBCS does not overwrite.</td>
</tr>
<tr>
<td>Ctrl+Left Arrow</td>
<td>Move cursor one word to the left.</td>
<td>On bidi keyboard, this depends on the direction of the text.</td>
</tr>
<tr>
<td>Ctrl+Right Arrow</td>
<td>Move cursor one word to the right.</td>
<td>See Ctrl+Left Arrow comments.</td>
</tr>
<tr>
<td>Ctrl+Left Shift</td>
<td>Left alignment</td>
<td>In BiDi documents, this is for left-to-right reading order.</td>
</tr>
<tr>
<td>Ctrl+Right Shift</td>
<td>Right alignment</td>
<td>In BiDi documents, this is for right-to-left reading order.</td>
</tr>
<tr>
<td>Ctrl+Up Arrow</td>
<td>Move to the line above.</td>
<td></td>
</tr>
<tr>
<td>Ctrl+Down Arrow</td>
<td>Move to the line below.</td>
<td></td>
</tr>
<tr>
<td>Ctrl+Home</td>
<td>Move to the beginning of the document.</td>
<td></td>
</tr>
<tr>
<td>Ctrl+End</td>
<td>Move to the end of the document.</td>
<td></td>
</tr>
<tr>
<td>Ctrl+Page Up</td>
<td>Move one page up.</td>
<td>If in SystemEditMode and Single Line control, do nothing.</td>
</tr>
<tr>
<td>Ctrl+Page Down</td>
<td>Move one page down.</td>
<td>See Ctrl+Page Up comments.</td>
</tr>
<tr>
<td>Ctrl+Delete</td>
<td>Delete the next word or selected characters.</td>
<td></td>
</tr>
<tr>
<td>Shift+Delete</td>
<td>Cut the selected characters.</td>
<td></td>
</tr>
<tr>
<td>Esc</td>
<td>Stop drag-drop.</td>
<td>While doing a drag-drop of text.</td>
</tr>
<tr>
<td>Alt+Esc</td>
<td>Change the active application.</td>
<td></td>
</tr>
<tr>
<td>Alt+X</td>
<td>Converts the Unicode hexadecimal value preceding the insertion point to the corresponding Unicode character.</td>
<td></td>
</tr>
<tr>
<td>Alt+Shift+X</td>
<td>Converts the Unicode character preceding the insertion point to the corresponding Unicode hexadecimal value.</td>
<td></td>
</tr>
<tr>
<td>Alt+0xxx (Number Pad)</td>
<td>Inserts Unicode values if xxx is greater than 255. When xxx is less than 256, ASCI range text is inserted based on the current keyboard.</td>
<td>Must enter decimal values.</td>
</tr>
<tr>
<td>Alt+Shift+Ctrl+F12</td>
<td>Hex to Unicode.</td>
<td>In case Alt+X is already taken for another use.</td>
</tr>
<tr>
<td>Alt+Shift+Ctrl+F11</td>
<td>Selected text will be output to the debugger window and saved to %temp%\DumpFontInfo.txt.</td>
<td>For Debug only (need to set Flag=8 in Win.ini)</td>
</tr>
<tr>
<td>Ctrl+Shift+A</td>
<td>Set all caps.</td>
<td></td>
</tr>
<tr>
<td>Ctrl+Shift+L</td>
<td>Fiddle bullet style.</td>
<td></td>
</tr>
<tr>
<td>Ctrl+Shift+Right Arrow</td>
<td>Increase font size.</td>
<td>Font size changes by 1 point in the range 4pt-11pt; by 2points for 12pt-28pt; it changes from 28pt -&gt; 36pt -&gt; 48pt -&gt; 72pt -&gt; 80pt; it changes by 10 points in the range 80pt - 1630pt; the maximum value is 1638.</td>
</tr>
<tr>
<td>Ctrl+Shift+Left Arrow</td>
<td>Decrease font size.</td>
<td>See Ctrl+Shift+Right Arrow comments.</td>
</tr>
</tbody>
</table>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><strong>Conceptual</strong></p>
<!-- raw HTML omitted -->
<p><a href="using-rich-edit-controls.html">Using Rich Edit Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="windowless-rich-edit-controls.html">Windowless Rich Edit Controls</a></p>
<!-- raw HTML omitted -->
</body>
