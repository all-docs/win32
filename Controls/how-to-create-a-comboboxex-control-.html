<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Create a ComboBoxEx Control</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Create a ComboBoxEx Control
description: This topic demonstrates how to create a ComboBoxEx control.
ms.assetid: E3D577AF-3290-431E-AA6C-1E9A9ED6448C
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Create a ComboBoxEx Control</h1>
<p>This topic demonstrates how to create a ComboBoxEx control.</p>
<h2>What you need to know</h2>
<h3>Technologies</h3>
<ul>
<li><a href="window-controls.html">Windows Controls</a></li>
</ul>
<h3>Prerequisites</h3>
<ul>
<li>C/C++</li>
<li>Windows User Interface Programming</li>
</ul>
<h2>Instructions</h2>
<p>To create a ComboBoxEx control, call the <a href="/windows/desktop/api/winuser/nf-winuser-createwindowexa"><strong>CreateWindowEx</strong></a> function, using <a href="common-control-window-classes.html"><strong>WC_COMBOBOXEX</strong></a> as the window class. You must first register the window class by calling the <a href="/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrolsex"><strong>InitCommonControlsEx</strong></a> function, while specifying the ICC_USEREX_CLASSES bit in the accompanying <a href="/windows/win32/api/commctrl/ns-commctrl-initcommoncontrolsex"><strong>INITCOMMONCONTROLSEX</strong></a> structure.</p>
<h2>Complete example</h2>
<p>The following application-defined function creates a ComboBoxEx control with the <a href="combo-box-styles.html"><strong>CBS_DROPDOWN</strong></a> style in the main window.</p>
<pre lang="C++"><code>// CreateComboEx - Registers the ComboBoxEx window class and creates
// a ComboBoxEx control in the client area of the main window.
//
// g_hwndMain - A handle to the main window.
// g_hinst    - A handle to the program instance.
HWND WINAPI CreateComboEx(void)
{
    HWND hwnd;
    INITCOMMONCONTROLSEX icex;

    icex.dwSize = sizeof(INITCOMMONCONTROLSEX);
    icex.dwICC = ICC_USEREX_CLASSES;

    InitCommonControlsEx(&amp;icex);

    hwnd = CreateWindowEx(0, WC_COMBOBOXEX, NULL,
                    WS_BORDER | WS_VISIBLE |
                    WS_CHILD | CBS_DROPDOWN,
                    // No size yet--resize after setting image list.
                    0,      // Vertical position of Combobox
                    0,      // Horizontal position of Combobox
                    0,      // Sets the width of Combobox
                    100,    // Sets the height of Combobox
                    g_hwndMain,
                    NULL,
                    g_hinst,
                    NULL);

    return (hwnd);
}
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="comboboxex-controls.html">About ComboBoxEx Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="bumper-comboboxex-comboboxex-control-reference.html">ComboBoxEx Control Reference</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/Controls/using-comboboxex">Using ComboBoxEx Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="comboboxex-control-reference.html">ComboBoxEx</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
