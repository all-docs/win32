<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Add an Item to a Header Control</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Add an Item to a Header Control
description: This topic demonstrates how to add an item to a header control.
ms.assetid: DF71EF92-1726-46E1-A10F-57D3B07FB936
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Add an Item to a Header Control</h1>
<p>This topic demonstrates how to add an item to a header control. A header control typically has several header items that define the columns of the control. You can add an item to a header control by sending the <a href="hdm-insertitem.html"><strong>HDM_INSERTITEM</strong></a> message to the control.</p>
<h2>What you need to know</h2>
<h3>Technologies</h3>
<ul>
<li><a href="window-controls.html">Windows Controls</a></li>
</ul>
<h3>Prerequisites</h3>
<ul>
<li>C/C++</li>
<li>Windows User Interface Programming</li>
</ul>
<h2>Instructions</h2>
<p>Use the <a href="hdm-insertitem.html"><strong>HDM_INSERTITEM</strong></a> message to add an item to the header control. The message must include the address of an <a href="/windows/win32/api/commctrl/ns-commctrl-hditema"><strong>HDITEM</strong></a> structure. This structure defines the properties of the header item, which can include a string, a bitmapped image, an initial size, and an application-defined 32-bit value.</p>
<p>The following example illustrates how to use the <a href="hdm-insertitem.html"><strong>HDM_INSERTITEM</strong></a> message and the <a href="/windows/win32/api/commctrl/ns-commctrl-hditema"><strong>HDITEM</strong></a> structure to add an item to a header control. The new item consists of a string that is left-justified within the item rectangle.</p>
<pre lang="C++"><code>// DoInsertItem - inserts an item into a header control. 
// Returns the index of the new item. 
// hwndHeader - handle to the header control. 
// iInsertAfter - index of the previous item. 
// nWidth - width of the new item. 
// lpsz - address of the item string. 
int DoInsertItem(HWND hwndHeader, int iInsertAfter, 
    int nWidth, LPTSTR lpsz) 
{ 
    HDITEM hdi; 
    int index; 
 
    hdi.mask = HDI_TEXT | HDI_FORMAT | HDI_WIDTH; 
    hdi.cxy = nWidth; 
    hdi.pszText = lpsz; 
    hdi.cchTextMax = sizeof(hdi.pszText)/sizeof(hdi.pszText[0]); 
    hdi.fmt = HDF_LEFT | HDF_STRING; 
 
    index = SendMessage(hwndHeader, HDM_INSERTITEM, 
        (WPARAM) iInsertAfter, (LPARAM) &amp;hdi); 
 
    return index; 
}
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="header-controls.html">About Header Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="bumper-header-control-header-control-reference.html">Header Control Reference</a></p>
<!-- raw HTML omitted -->
<p><a href="using-header-controls.html">Using Header Controls</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
