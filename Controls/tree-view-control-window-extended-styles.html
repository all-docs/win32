<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Tree-View Control Extended Styles</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Tree-View Control Extended Styles (CommCtrl.h)
description: This section lists extended styles used when creating tree-view controls. The value of extended styles is a bitwise combination of these styles.
ms.assetid: b45e7b7c-2c7b-49fa-8679-57c478b2f796
topic_type:</p>
<ul>
<li>apiref
api_name:</li>
<li>TVS_EX_AUTOHSCROLL</li>
<li>TVS_EX_DIMMEDCHECKBOXES</li>
<li>TVS_EX_DOUBLEBUFFER</li>
<li>TVS_EX_DRAWIMAGEASYNC</li>
<li>TVS_EX_EXCLUSIONCHECKBOXES</li>
<li>TVS_EX_FADEINOUTEXPANDOS</li>
<li>TVS_EX_MULTISELECT</li>
<li>TVS_EX_NOINDENTSTATE</li>
<li>TVS_EX_NOSINGLECOLLAPSE</li>
<li>TVS_EX_PARTIALCHECKBOXES</li>
<li>TVS_EX_RICHTOOLTIP
api_location:</li>
<li>CommCtrl.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Tree-View Control Extended Styles</h1>
<p>This section lists extended styles used when creating tree-view controls. The value of extended styles is a bitwise combination of these styles.</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_EX_AUTOHSCROLL<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Windows Vista<!-- raw HTML omitted -->. Remove the horizontal scroll bar and auto-scroll depending on mouse position.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_EX_DIMMEDCHECKBOXES<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Windows Vista<!-- raw HTML omitted -->. Adds a checkbox on the leftmost side of a given item that contains an icon of a dimmed check mark, that can indicate that a node is selected because its parent is selected. This includes a dimmed checkbox state in addition to 2 normal checkbox states. Do not use it at the same time as the <!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_CHECKBOXES<!-- raw HTML omitted --><!-- raw HTML omitted --> style. See note below.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_EX_DOUBLEBUFFER<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Windows Vista<!-- raw HTML omitted -->. Specifies how the background is erased or filled.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_EX_DRAWIMAGEASYNC<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Windows Vista<!-- raw HTML omitted -->. Retrieves calendar grid information.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_EX_EXCLUSIONCHECKBOXES<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Windows Vista<!-- raw HTML omitted -->. Adds a checkbox icon on the leftmost side of a given item that contains a red X. This includes an exclusion checkbox state in addition to 2 normal checkbox states. Do not use it at the same time as the <!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_CHECKBOXES<!-- raw HTML omitted --><!-- raw HTML omitted --> style. See note below.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_EX_FADEINOUTEXPANDOS<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Windows Vista<!-- raw HTML omitted -->. Fade expando buttons in or out when the mouse moves away or into a state of hovering over the control.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_EX_MULTISELECT<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Not supported. Do not use.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_EX_NOINDENTSTATE<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Windows Vista<!-- raw HTML omitted -->. Do not indent the tree view for the expando buttons.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><strong>TVS_EX_NOSINGLECOLLAPSE</strong><!-- raw HTML omitted --></td>
<td><a href="common-control-versions.html">Windows Vista</a>. <strong>Intended for internal use; not recommended for use in applications.</strong> Do not collapse the previously selected tree-view item unless it has the same parent as the new selection. This style must be used with the <a href="tree-view-control-window-styles.html"><strong>TVS_SINGLEEXPAND</strong></a> style. <!-- raw HTML omitted --> <strong>Note:</strong> This style may not be supported in future versions of Comctl32.dll. Also, this style is not defined in commctrl.h. Add the following definition to the source files of your application to use this style: <!-- raw HTML omitted -->#define TVS_EX_NOSINGLECOLLAPSE 0x0001<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_EX_PARTIALCHECKBOXES<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Windows Vista<!-- raw HTML omitted -->. Adds a checkbox icon on the leftmost side of a given item with a square in the center, that can indicate that the node is partially selected. This includes a partial checkbox state in addition to 2 normal checkbox states. Do not use it at the same time as the <!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_CHECKBOXES<!-- raw HTML omitted --><!-- raw HTML omitted --> style. See note below.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_EX_RICHTOOLTIP<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted -->Windows Vista<!-- raw HTML omitted -->. Allow rich tooltips in the tree view (custom drawn with icon and text).<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Note on using extended checkbox styles</h2>
<p>The tree-view control has a very specific behavior for the checkbox styles. When a specific style or 'EX'-style combination is activated, the control keeps it to the end of its life (which means that you cannot modify the first checkbox style during the life of tree-view control).</p>
<p>To create a tree-view control with any extended checkbox styles, you must initially create the control window without the <!-- raw HTML omitted --><!-- raw HTML omitted -->TVS_CHECKBOXES<!-- raw HTML omitted --><!-- raw HTML omitted --> style and add (after creation) the chosen extended checkbox style by sending the <!-- raw HTML omitted -->TVM_SETEXTENDEDSTYLE<!-- raw HTML omitted --> message or by using the <!-- raw HTML omitted -->TreeView_SetExtendedStyle<!-- raw HTML omitted --> macro. The extended checkbox style can be any OR combination of <!-- raw HTML omitted -->TVS_EX_DIMMEDCHECKBOXES<!-- raw HTML omitted -->, <!-- raw HTML omitted -->TVS_EX_EXCLUSIONCHECKBOXES<!-- raw HTML omitted -->, or <!-- raw HTML omitted -->TVS_EX_PARTIALCHECKBOXES<!-- raw HTML omitted --> style.</p>
<p>The new tree-view control will provide the 2 normal checkbox states (checked and unchecked) plus 1 to 3 additional states (function of the chosen extended style). The normal states are always coded as 0x1000 and 0x2000, and any additional states are coded with the next values (0x3000, 0x4000, 0x5000). Use <!-- raw HTML omitted -->TVIS_STATEIMAGEMASK<!-- raw HTML omitted --> constant (0xF000) as the mask to get or set these states to/from the <!-- raw HTML omitted -->TVITEM<!-- raw HTML omitted --> structure.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->CommCtrl.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
