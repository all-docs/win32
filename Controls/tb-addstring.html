<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TB_ADDSTRING message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: TB_ADDSTRING message (Commctrl.h)
description: Adds a new string to the toolbar's string pool.
ms.assetid: e22ee2cc-6443-49d3-aea6-a4ab256d4538
keywords:</p>
<ul>
<li>TB_ADDSTRING message Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>TB_ADDSTRING</li>
<li>TB_ADDSTRINGA</li>
<li>TB_ADDSTRINGW
api_location:</li>
<li>Commctrl.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>TB_ADDSTRING message</h1>
<p>Adds a new string to the toolbar's string pool.</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>Handle to the module instance with an executable file that contains the string resource. If <em>lParam</em> instead points to a character array with one or more strings, set this parameter to <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>Resource identifier for the string resource, or a pointer to a TCHAR array. See Remarks.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns the index of the first new string if successful, or -1 otherwise.</p>
<h2>Remarks</h2>
<p>If <em>wParam</em> is <strong>NULL</strong>, <em>lParam</em> points to a character array with one or more null-terminated strings. The last string in the array must be terminated with two null characters.</p>
<p>If <em>wParam</em> is the HINSTANCE of the application or of another module containing a string resource, <em>lParam</em> is the resource identifier of the string. Each item in the string must begin with an arbitrary separator character, and the string must end with two such characters. For example, the text for three buttons might appear in the string table as &quot;/New/Open/Save//&quot;. The message returns the index of &quot;New&quot; in the toolbar's string pool, and the other items are in consecutive positions.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Commctrl.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Unicode and ANSI names<!-- raw HTML omitted --></td>
<td><strong>TB_ADDSTRINGW</strong> (Unicode) and <strong>TB_ADDSTRINGA</strong> (ANSI)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
