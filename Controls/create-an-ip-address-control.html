<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How to Create an IP Address Control</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: How to Create an IP Address Control
description: This topic demonstrates how to create an instance of an IP address control.
ms.assetid: E4DBECA6-B3F2-405F-8D95-32FA2334114D
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>How to Create an IP Address Control</h1>
<p>This topic demonstrates how to create an instance of an IP address control.</p>
<h2>What you need to know</h2>
<h3>Technologies</h3>
<ul>
<li><a href="window-controls.html">Windows Controls</a></li>
</ul>
<h3>Prerequisites</h3>
<ul>
<li>C/C++</li>
<li>Windows User Interface Programming</li>
</ul>
<h2>Instructions</h2>
<p>Before creating an IP address control, load the common controls DLL by calling <a href="/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrolsex"><strong>InitCommonControlsEx</strong></a>. Then use the <a href="/windows/desktop/api/winuser/nf-winuser-createwindowa"><strong>CreateWindow</strong></a> or the <a href="/windows/desktop/api/winuser/nf-winuser-createwindowexa"><strong>CreateWindowEx</strong></a> function to create an instance IP address control. The class name for the control is <a href="common-control-window-classes.html"><strong>WC_IPADDRESS</strong></a>. Use the <a href="/windows/desktop/winmsg/window-styles"><strong>WS_CHILD</strong></a> style, because there is no specific style constant associated with the IP address control.</p>
<p>In the following C++ code example, the application-defined function first calls <a href="/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrolsex"><strong>InitCommonControlsEx</strong></a> and sets the <strong>dwICC</strong> member of the <a href="/windows/win32/api/commctrl/ns-commctrl-initcommoncontrolsex"><strong>INITCOMMONCONTROLSEX</strong></a> structure to <a href="/windows/win32/api/commctrl/ns-commctrl-initcommoncontrolsex"><strong>ICC_INTERNET_CLASSES</strong></a>, which specifies the IP address class. It then calls <a href="/windows/desktop/api/winuser/nf-winuser-createwindowexa"><strong>CreateWindowEx</strong></a> to create an instance of the IP address control.</p>
<pre lang="C++"><code>// CreateIPAdressFld - creates a IPAddress control.
// Returns the handle to the new control
// TO DO:  calling procedure needs to check whether the handle is NULL, in case 
// of an error in creation.
// int xcoord, ycoord the coordinates of location of the control in the parent window
// HINST hInst is the global handle to the application instance.
// HWND  hWndParent is the handle to the control's parent window. 
//
//
HWND CreateIPAddressFld (HWND hwndParent, int xcoord, int ycoord) 
{     
     
    INITCOMMONCONTROLSEX icex;
    
    // Ensure that the common control DLL is loaded. 
    icex.dwSize = sizeof(INITCOMMONCONTROLSEX);
    icex.dwICC  = ICC_INTERNET_CLASSES ;
    InitCommonControlsEx(&amp;icex); 
    
    // Create the IPAddress control.        
    HWND hWndIPAddressFld = CreateWindow(WC_IPADDRESS, 
                                L&quot;&quot;, 
                                WS_CHILD | WS_OVERLAPPED | WS_VISIBLE, 
                                xcoord, 
                                ycoord,
                                150, 
                                20,  
                                hwndParent, 
                                NULL, 
                                hInst, 
                                NULL); 
                                
    return (hWndIPAddressFld);
}
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="bumper-ip-address-control-ip-address-control-reference.html">IP Address Control Reference</a></p>
<!-- raw HTML omitted -->
<p><a href="ip-address-controls.html">About IP Address Controls</a></p>
<!-- raw HTML omitted -->
<p><a href="using-ip-address-controls.html">Using IP Address Controls</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
