<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CB_GETLBTEXTLEN message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: CB_GETLBTEXTLEN message (Winuser.h)
description: Gets the length, in characters, of a string in the list of a combo box.
ms.assetid: f0fe0eef-f9db-4d9f-9a42-5bb2aeae30a0
keywords:</p>
<ul>
<li>CB_GETLBTEXTLEN message Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>CB_GETLBTEXTLEN
api_location:</li>
<li>Winuser.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>CB_GETLBTEXTLEN message</h1>
<p>Gets the length, in characters, of a string in the list of a combo box.</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>The zero-based index of the string.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>This parameter is not used.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>The return value is the length of the string, in <strong>TCHAR</strong>s, excluding the terminating null character. If an ANSI string this is the number of bytes, and if it is a Unicode string this is the number of characters. Under certain conditions, this value may actually be greater than the length of the text. For more information, see the Remarks section.</p>
<p>If the <em>wParam</em> parameter does not specify a valid index, the return value is CB_ERR.</p>
<h2>Remarks</h2>
<p>Under certain conditions, the return value is larger than the actual length of the text. This occurs with certain mixtures of ANSI and Unicode, and is due to the operating system allowing for the possible existence of double-byte character set (DBCS) characters within the text. The return value, however, will always be at least as large as the actual length of the text; so you can always use it to guide buffer allocation. This behavior can occur when an application uses both ANSI functions and common dialogs, which use Unicode.</p>
<p>To obtain the exact length of the text, use the <a href="/windows/desktop/winmsg/wm-gettext"><strong>WM_GETTEXT</strong></a>, <a href="lb-gettext.html"><strong>LB_GETTEXT</strong></a>, or <a href="cb-getlbtext.html"><strong>CB_GETLBTEXT</strong></a> messages, or the <a href="/windows/desktop/api/winuser/nf-winuser-getwindowtexta"><strong>GetWindowText</strong></a> function.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winuser.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="cb-getlbtext.html"><strong>CB_GETLBTEXT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="lb-gettext.html"><strong>LB_GETTEXT</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>Other Resources</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/winuser/nf-winuser-getwindowtexta"><strong>GetWindowText</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/winmsg/wm-gettext"><strong>WM_GETTEXT</strong></a></p>
<!-- raw HTML omitted -->
</body>
