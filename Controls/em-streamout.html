<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EM_STREAMOUT message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: EM_STREAMOUT message (Richedit.h)
description: Causes a rich edit control to pass its contents to an application \ 8211;defined EditStreamCallback callback function. The callback function can then write the stream of data to a file or any other location that it chooses.
ms.assetid: 3f14aaac-4b17-47af-8f2b-503390631a88
keywords:</p>
<ul>
<li>EM_STREAMOUT message Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>EM_STREAMOUT
api_location:</li>
<li>Richedit.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>EM_STREAMOUT message</h1>
<p>Causes a rich edit control to pass its contents to an application defined <a href="/windows/desktop/api/Richedit/nc-richedit-editstreamcallback"><em>EditStreamCallback</em></a> callback function. The callback function can then write the stream of data to a file or any other location that it chooses.</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>Specifies the data format and replacement options.</p>
<p>This value must be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SF_RTF</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>RTF.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SF_RTFNOOBJS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>RTF with spaces in place of COM objects.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SF_TEXT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Text with spaces in place of COM objects.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SF_TEXTIZED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Text with a text representation of COM objects.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>The <strong>SF_RTFNOOBJS</strong> option is useful if an application stores COM objects itself, as RTF representation of COM objects is not very compact. The control word, \objattph, followed by a space denotes the object position.</p>
<p>In addition, you can specify the following flags.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SFF_PLAINRTF</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If specified, the rich edit control streams out only the keywords common to all languages, ignoring language-specific keywords. If not specified, the rich edit control streams out all keywords. You can combine this flag with the <strong>SF_RTF</strong> or <strong>SF_RTFNOOBJS</strong> flag.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SFF_SELECTION</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If specified, the rich edit control streams out only the contents of the current selection. If not specified, the control streams out the entire contents. You can combine this flag with any of data format values.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SF_UNICODE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>Microsoft Rich Edit 2.0 and later:</strong> Indicates Unicode text. You can combine this flag with the <strong>SF_TEXT</strong> flag.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SF_USECODEPAGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>Rich Edit 3.0 and later:</strong> Generates UTF-8 RTF and text using other code pages. The code page is set in the high word of <em>wParam</em>. For example, for UTF-8 RTF, set <em>wParam</em> to (CP_UTF8 <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>Pointer to an <a href="/windows/desktop/api/Richedit/ns-richedit-editstream"><strong>EDITSTREAM</strong></a> structure. On input, the <strong>pfnCallback</strong> member of this structure must point to an application defined <a href="/windows/desktop/api/Richedit/nc-richedit-editstreamcallback"><em>EditStreamCallback</em></a> function. On output, the <strong>dwError</strong> member can contain a nonzero error code if an error occurred.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>This message returns the number of characters written to the data stream.</p>
<h2>Remarks</h2>
<p>When you send an <strong>EM_STREAMOUT</strong> message, the rich edit control makes repeated calls to the <a href="/windows/desktop/api/Richedit/nc-richedit-editstreamcallback"><em>EditStreamCallback</em></a> function specified by the <strong>pfnCallback</strong> member of the <a href="/windows/desktop/api/Richedit/ns-richedit-editstream"><strong>EDITSTREAM</strong></a> structure. Each time it calls the callback function, the control passes a buffer containing a portion of the contents of the control. This process continues until the control has passed all its contents to the callback function, or until an error occurs.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Richedit.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Richedit/ns-richedit-editstream"><strong>EDITSTREAM</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Richedit/nc-richedit-editstreamcallback"><em>EditStreamCallback</em></a></p>
<!-- raw HTML omitted -->
<p><a href="em-streamin.html"><strong>EM_STREAMIN</strong></a></p>
<!-- raw HTML omitted -->
</body>
