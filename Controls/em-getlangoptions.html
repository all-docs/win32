<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EM_GETLANGOPTIONS message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: EM_GETLANGOPTIONS message (Richedit.h)
description: Gets a rich edit control's option settings for Input Method Editor (IME) and Asian language support.
ms.assetid: 9fd9d27c-7713-454e-b49f-8ecdba848d2e
keywords:</p>
<ul>
<li>EM_GETLANGOPTIONS message Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>EM_GETLANGOPTIONS
api_location:</li>
<li>Richedit.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>EM_GETLANGOPTIONS message</h1>
<p>Gets a rich edit control's option settings for Input Method Editor (IME) and Asian language support.</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>Not used; must be zero.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>Not used; must be zero.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns the IME and Asian language settings, which can be zero or more of the following values.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_AUTOFONT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set, the control automatically changes fonts when the user explicitly changes to a different keyboard layout. It is useful to turn off <strong>IMF_AUTOFONT</strong> for universal Unicode fonts. This option is turned on by default (1).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_AUTOFONTSIZEADJUST</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set, the control scales font-bound font sizes from insertion point size according to script. For example, Asian fonts are slightly larger than Western ones. This option is turned on by default (1).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_AUTOKEYBOARD</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set, the control automatically changes the keyboard layout when the user explicitly changes to a different font, or when the user explicitly changes the insertion point to a new location in the text. Will be turned on automatically for bidirectional controls. For all other controls, it is turned off by default. This option is turned off by default (0).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_DISABLEAUTOBIDIAUTOKEYBOARD</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>Windows 8</strong>: If this flag is set, the control uses language neutral logic for automatic keyboard switching. This option is turned off by default (0).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_DUALFONT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>If this flag is set, the control uses dual-font mode. Used for Asian language support. The control uses an English font for ASCII text and a Asian font for Asian text. This option is turned on by default (1).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_IMEALWAYSSENDNOTIFY</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>This flag controls how the rich edit control notifies the client during IME composition: <!-- raw HTML omitted --> 0: No <a href="en-change.html">EN_CHANGE</a> or <a href="en-selchange.html">EN_SELCHANGE</a> notifications during undetermined state. Send notification when the final string comes in. This is the default.<!-- raw HTML omitted --> 1: Send <a href="en-change.html">EN_CHANGE</a> and <a href="en-selchange.html">EN_SELCHANGE</a> events during undetermined state.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_IMECANCELCOMPLETE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>This flag determines how the control uses the composition string of an IME if the user cancels it. If this flag is set, the control discards the composition string. If this flag is not set, the control uses the composition string as the result string. This option is turned off by default (0).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_NOIMPLICITLANG</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>Windows 8</strong>: If this flag is set, disable stamping keyboard input with the keyboard language and ensuring that non-East Asian language IDss are compatible with the character repertoire. This option is turned off by default (0). <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_NOKBDLIDFIXUP</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>Windows 8</strong>: If this flag is set, the rich edit control disables stamping keyboard language on an empty control. This option is turned off by default (0).<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_SPELLCHECKING</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>Windows 8</strong>: If this flag is set, the rich edit control turns on spell checking. This option is turned off by default (0). <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_TKBAUTOCORRECTION</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>Windows 8</strong>: If this flag is set, enable touch keyboard autocorrect. This option is turned off by default (0). <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_TKBPREDICTION</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>Windows 10</strong>: Ignored.<!-- raw HTML omitted --> <strong>Windows 8</strong>: If this flag is set, the rich edit control enables touch keyboard prediction. This option is turned off by default (0). <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>IMF_UIFONTS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Use user-interface default fonts. This option is turned off by default (0).<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>The <strong>IMF_AUTOFONT</strong> flag is set by default. The <strong>IMF_AUTOKEYBOARD</strong> and <strong>IMF_IMECANCELCOMPLETE</strong> flags are cleared by default.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Richedit.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="em-setlangoptions.html"><strong>EM_SETLANGOPTIONS</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="em-setlimittext.html"><strong>EM_SETLIMITTEXT</strong></a></p>
<!-- raw HTML omitted -->
</body>
