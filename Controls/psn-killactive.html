<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PSN_KILLACTIVE notification code</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: PSN_KILLACTIVE notification code (Prsht.h)
description: Notifies a page that it is about to lose activation either because another page is being activated or the user has clicked the OK button. This notification code is sent in the form of a WM_NOTIFY message.
ms.assetid: 470cd6ff-73ad-451a-a861-4d3324a8a8db
keywords:</p>
<ul>
<li>PSN_KILLACTIVE notification code Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>PSN_KILLACTIVE
api_location:</li>
<li>Prsht.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>PSN_KILLACTIVE notification code</h1>
<p>Notifies a page that it is about to lose activation either because another page is being activated or the user has clicked the OK button. This notification code is sent in the form of a <a href="wm-notify.html"><strong>WM_NOTIFY</strong></a> message.</p>
<pre lang="C++"><code>PSN_KILLACTIVE 

    lppsn = (LPPSHNOTIFY) lParam; 
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>Pointer to a <a href="/windows/desktop/api/Prsht/ns-prsht-pshnotify"><strong>PSHNOTIFY</strong></a> structure that contains information about the notification code. This structure contains an <a href="/windows/desktop/api/richedit/ns-richedit-nmhdr"><strong>NMHDR</strong></a> structure as its first member, <strong>hdr</strong>. The <strong>hwndFrom</strong> member of this <strong>NMHDR</strong> structure contains the handle to the property sheet. The <strong>lParam</strong> member of the <strong>PSHNOTIFY</strong> structure does not contain any information.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Returns <strong>TRUE</strong> to prevent the page from losing the activation, or <strong>FALSE</strong> to allow it.</p>
<h2>Remarks</h2>
<p>An application handles this notification code to validate the information the user has entered.</p>
<blockquote>
<p>[!Note]<br />
The property sheet is in the process of manipulating the list of pages when the PSN_KILLACTIVE notification code is sent. Do not attempt to add, remove, or insert pages while handling this notification code. Doing so will have unpredictable results.</p>
</blockquote>
<p>To set a return value, the dialog box procedure for the page must call the <a href="/windows/desktop/api/winuser/nf-winuser-setwindowlonga"><strong>SetWindowLong</strong></a> function with a DWL_MSGRESULT value set to the return value. The dialog box procedure must return <strong>TRUE</strong>.</p>
<p>If the dialog box procedure sets DWL_MSGRESULT to <strong>TRUE</strong>, it should display a message box to explain the problem to the user.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Prsht.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
