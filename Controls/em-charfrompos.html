<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EM_CHARFROMPOS message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: EM_CHARFROMPOS message (Winuser.h)
description: Gets information about the character closest to a specified point in the client area of an edit control. You can send this message to either an edit control or a rich edit control.
ms.assetid: fe9f96f2-5b3c-4039-befd-5e9a456ba32d
keywords:</p>
<ul>
<li>EM_CHARFROMPOS message Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>EM_CHARFROMPOS
api_location:</li>
<li>Winuser.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>EM_CHARFROMPOS message</h1>
<p>Gets information about the character closest to a specified point in the client area of an edit control. You can send this message to either an edit control or a rich edit control.</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>This parameter is not used.</p>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>The coordinates of a point in the control's client area. The coordinates are in screen units and are relative to the upper-left corner of the control's client area.</p>
<p><strong>Rich edit controls:</strong> A pointer to a <a href="/windows/win32/api/windef/ns-windef-pointl"><strong>POINTL</strong></a> structure that contains the horizontal and vertical coordinates.</p>
<p><strong>Edit controls:</strong> The <a href="../winmsg/loword.html"><strong>LOWORD</strong></a> contains the horizontal coordinate. The <a href="../winmsg/hiword.html"><strong>HIWORD</strong></a> contains the vertical coordinate.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p><strong>Rich edit controls:</strong> The return value specifies the zero-based character index of the character nearest the specified point. The return value indicates the last character in the edit control if the specified point is beyond the last character in the control.</p>
<p><strong>Edit controls:</strong> The <a href="../winmsg/loword.html"><strong>LOWORD</strong></a> specifies the zero-based index of the character nearest the specified point. This index is relative to the beginning of the control, not the beginning of the line. If the specified point is beyond the last character in the edit control, the return value indicates the last character in the control. The <a href="../winmsg/hiword.html"><strong>HIWORD</strong></a> specifies the zero-based index of the line that contains the character. For single-line edit controls, this value is zero. The index indicates the line delimiter if the specified point is beyond the last visible character in a line.</p>
<h2>Remarks</h2>
<p><strong>Rich Edit:</strong> Supported in Microsoft Rich Edit 1.0 and later. For information about the compatibility of rich edit versions with the various system versions, see <a href="about-rich-edit-controls.html">About Rich Edit Controls</a>.</p>
<p>If a point is passed to <strong>EM_CHARFROMPOS</strong> as the <em>lParam</em> and the point is outside the bounds of the edit control, then the <em>lResult</em> is (65535, 65535).</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Winuser.h (include Windows.h)<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="em-posfromchar.html"><strong>EM_POSFROMCHAR</strong></a></p>
<!-- raw HTML omitted -->
<p><strong>Other Resources</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/winuser/nf-winuser-makelparam"><strong>MAKELPARAM</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/windef/ns-windef-pointl"><strong>POINTL</strong></a></p>
<!-- raw HTML omitted -->
</body>
