<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PSN_QUERYINITIALFOCUS notification code</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: PSN_QUERYINITIALFOCUS notification code (Prsht.h)
description: Sent by a property sheet to provide a property sheet page an opportunity to specify which dialog box control should receive the initial focus. This notification code is sent in the form of a WM_NOTIFY message.
ms.assetid: 29b5e598-75b2-4b6f-acdb-171b1f7a1850
keywords:</p>
<ul>
<li>PSN_QUERYINITIALFOCUS notification code Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>PSN_QUERYINITIALFOCUS
api_location:</li>
<li>Prsht.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>PSN_QUERYINITIALFOCUS notification code</h1>
<p>Sent by a property sheet to provide a property sheet page an opportunity to specify which dialog box control should receive the initial focus. This notification code is sent in the form of a <a href="wm-notify.html"><strong>WM_NOTIFY</strong></a> message.</p>
<pre lang="C++"><code>PSN_QUERYINITIALFOCUS

    lppsn = (LPPSHNOTIFY) lParam; 
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>Pointer to a <a href="/windows/desktop/api/Prsht/ns-prsht-pshnotify"><strong>PSHNOTIFY</strong></a> structure. Cast the <strong>lParam</strong> member of this structure to an <strong>HWND</strong> type, to retrieve the handle of the control that will be given focus by default. The structure contains an <a href="/windows/desktop/api/richedit/ns-richedit-nmhdr"><strong>NMHDR</strong></a> structure as its first member, <strong>hdr</strong>. The <strong>hwndFrom</strong> member of this <strong>NMHDR</strong> structure contains the handle to the property sheet.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>To specify which control should receive focus, return the control's handle. Otherwise, return zero and focus will go to the default control. To set the return value, the dialog box procedure must call the <a href="/windows/desktop/api/winuser/nf-winuser-setwindowlonga"><strong>SetWindowLong</strong></a> function with a <strong>DWL_MSGRESULT</strong> value and return <strong>TRUE</strong>.</p>
<h2>Remarks</h2>
<p>An application must not call the <a href="/windows/desktop/api/winuser/nf-winuser-setfocus"><strong>SetFocus</strong></a> function while handling this notification code. Return the handle of the control that should receive focus, and the property sheet manager will handle the focus change.</p>
<p>The PSN_QUERYINITIALFOCUS notification code is not sent if the property sheet manager determines that no control on the page should receive focus.</p>
<p>This code fragment implements a simple handler for PSN_QUERYINITIALFOCUS. It requests that initial focus be given to the Location control (<strong>IDC_LOCATION</strong>).</p>
<pre lang="syntax"><code>case PSN_QUERYINITIALFOCUS :
    SetWindowLong(hDlg,DWL_MSGRESULT, (LPARAM)GetDlgItem(hDlg, IDC_LOCATION));
    return TRUE;
...
</code></pre>
<blockquote>
<p>[!Note]<br />
This notification code is not supported when using the Aero wizard style (<a href="/windows/desktop/api/Prsht/ns-prsht-propsheetheadera_v2"><strong>PSH_AEROWIZARD</strong></a>).</p>
</blockquote>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Prsht.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
