<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using Tree-View Controls</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Using Tree-View Controls
description: This section contains implementation details and example code for working with tree-view controls.
ms.assetid: 37736770-5030-4f8a-a020-6897ed5f4e96
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using Tree-View Controls</h1>
<p>This section contains implementation details and example code for working with tree-view controls.</p>
<h2>In this section</h2>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="create-a-tree-view-control.html">How to Create a Tree-View Control</a><!-- raw HTML omitted --></td>
<td>To create a tree-view control, use the <a href="/windows/desktop/api/winuser/nf-winuser-createwindowexa"><strong>CreateWindowEx</strong></a> function, specifying the <a href="common-control-window-classes.html"><strong>WC_TREEVIEW</strong></a> value for the window class. The tree-view window class is registered in the application's address space when the common control DLL is loaded. To ensure that the DLL is loaded, use the <a href="/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols"><strong>InitCommonControls</strong></a> function. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="initialize-the-image-list.html">How to Initialize the Image List</a><!-- raw HTML omitted --></td>
<td>Every item in a tree-view control can have two images associated with it. An item displays one image when it is selected and the other when it is not. To include images with tree-view items, first use the <a href="image-lists.html">Image Lists</a> functions to create an image list and add images to it. Then associate the image list with the tree-view control by using the <a href="tvm-setimagelist.html"><strong>TVM_SETIMAGELIST</strong></a> message. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="add-tree-view-items.html">How to Add Tree-View Items</a><!-- raw HTML omitted --></td>
<td>You add an item to a tree-view control by sending the <a href="tvm-insertitem.html"><strong>TVM_INSERTITEM</strong></a> message to the control. The message includes the address of a <a href="/windows/win32/api/commctrl/ns-commctrl-tvinsertstructa"><strong>TVINSERTSTRUCT</strong></a> structure, specifying the parent item, the item after which the new item is inserted, and a <a href="/windows/win32/api/commctrl/ns-commctrl-tvitema"><strong>TVITEM</strong></a> structure that defines the attributes of the item. The attributes include the item's label, its selected and nonselected images, and a 32-bit application-defined value. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="drag-a-tree-view-item.html">How to Drag a Tree-View Item</a><!-- raw HTML omitted --></td>
<td>This topic demonstrates code for handling dragging and dropping of tree-view items. The sample code consists of three functions. The first function begins the drag operation, the second function drags the image, and the third function ends the drag operation. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="work-with-state-image-indexes.html">How to Work With State Image Indexes</a><!-- raw HTML omitted --></td>
<td>There is often confusion about how to set and retrieve the state image index in a tree-view control. The following examples demonstrate the proper method for setting and retrieving the state image index. The examples assume that there are only two state image indexes in the tree-view control, unchecked and checked. If your application contains more than two, these functions will need to be modified to handle that case. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="use-tree-view-infotips.html">How to Use Tree-View Infotips</a><!-- raw HTML omitted --></td>
<td>When you apply the <a href="tree-view-control-window-styles.html"><strong>TVS_INFOTIP</strong></a> style to a tree-view control, it generates <a href="tvn-getinfotip.html">TVN_GETINFOTIP</a> notifications when the cursor is over an item in the tree view. By responding to this notification, you can set the text that appears in the infotip. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
