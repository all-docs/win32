<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>List Box</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: List Box
description: This section contains information about the programming elements used with list boxes. A list box is a control window that contains a simple list of items from which the user can choose.
ms.assetid: 'vs|controls|~\controls\listboxes\listboxes.htm'
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>List Box</h1>
<p>This section contains information about the programming elements used with list boxes. A list box is a control window that contains a simple list of items from which the user can choose. For more complex lists, use the <a href="list-view-control-reference.html">List View</a> instead.</p>
<h3>Overviews</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="about-list-boxes.html">About List Boxes</a></td>
<td>Describes list box features.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="using-list-boxes.html">Using List Boxes</a></td>
<td>Explains how to perform tasks associated with list boxes. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Functions</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Winuser/nf-winuser-dlgdirlista"><strong>DlgDirList</strong></a></td>
<td>Replaces the contents of a list box with the names of the subdirectories and files in a specified directory.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winuser/nf-winuser-dlgdirselectexa"><strong>DlgDirSelectEx</strong></a></td>
<td>Retrieves the current selection from a single-selection list box.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-drawinsert"><strong>DrawInsert</strong></a></td>
<td>Draws the insert icon in the parent window of the specified drag list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Winuser/nf-winuser-getlistboxinfo"><strong>GetListBoxInfo</strong></a></td>
<td>Retrieves information about the specified list box.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-lbitemfrompt"><strong>LBItemFromPt</strong></a></td>
<td>Retrieves the index of the item at the specified point in a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Commctrl/nf-commctrl-makedraglist"><strong>MakeDragList</strong></a></td>
<td>Changes the specified single-selection list box to a drag list box. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Messages</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="lb-addfile.html"><strong>LB_ADDFILE</strong></a></td>
<td>Adds the specified file name to a list box that contains a directory listing. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-addstring.html"><strong>LB_ADDSTRING</strong></a></td>
<td>Adds a string to a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-deletestring.html"><strong>LB_DELETESTRING</strong></a></td>
<td>Deletes a string in a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-dir.html"><strong>LB_DIR</strong></a></td>
<td>Adds names to the list displayed by a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-findstring.html"><strong>LB_FINDSTRING</strong></a></td>
<td>Finds the first string in a list box that begins with the specified string. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-findstringexact.html"><strong>LB_FINDSTRINGEXACT</strong></a></td>
<td>Finds the first list box string that exactly matches the specified string, except that the search is not case sensitive. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-getanchorindex.html"><strong>LB_GETANCHORINDEX</strong></a></td>
<td>Gets the index of the anchor item that is, the item from which a multiple selection starts. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-getcaretindex.html"><strong>LB_GETCARETINDEX</strong></a></td>
<td>Retrieves the index of the item that has the focus rectangle in a multiple-selection list box. The item may or may not be selected. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-getcount.html"><strong>LB_GETCOUNT</strong></a></td>
<td>Gets the number of items in a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-getcursel.html"><strong>LB_GETCURSEL</strong></a></td>
<td>Gets the index of the currently selected item, if any, in a single-selection list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-gethorizontalextent.html"><strong>LB_GETHORIZONTALEXTENT</strong></a></td>
<td>Gets the width, in pixels, that a list box can be scrolled horizontally (the scrollable width) if the list box has a horizontal scroll bar. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-getitemdata.html"><strong>LB_GETITEMDATA</strong></a></td>
<td>Gets the application-defined value associated with the specified list box item. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-getitemheight.html"><strong>LB_GETITEMHEIGHT</strong></a></td>
<td>Gets the height of items in a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-getitemrect.html"><strong>LB_GETITEMRECT</strong></a></td>
<td>Gets the dimensions of the rectangle that bounds a list box item as it is currently displayed in the list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-getlistboxinfo.html"><strong>LB_GETLISTBOXINFO</strong></a></td>
<td>Gets the number of items per column in a specified list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-getlocale.html"><strong>LB_GETLOCALE</strong></a></td>
<td>Gets the current locale of the list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-getsel.html"><strong>LB_GETSEL</strong></a></td>
<td>Gets the selection state of an item. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-getselcount.html"><strong>LB_GETSELCOUNT</strong></a></td>
<td>Gets the total number of selected items in a multiple-selection list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-getselitems.html"><strong>LB_GETSELITEMS</strong></a></td>
<td>Fills a buffer with an array of integers that specify the item numbers of selected items in a multiple-selection list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-gettext.html"><strong>LB_GETTEXT</strong></a></td>
<td>Gets a string from a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-gettextlen.html"><strong>LB_GETTEXTLEN</strong></a></td>
<td>Gets the length of a string in a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-gettopindex.html"><strong>LB_GETTOPINDEX</strong></a></td>
<td>Gets the index of the first visible item in a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-initstorage.html"><strong>LB_INITSTORAGE</strong></a></td>
<td>Allocates memory for storing list box items. This message is used before an application adds a large number of items to a list box.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-insertstring.html"><strong>LB_INSERTSTRING</strong></a></td>
<td>Inserts a string or item data into a list box. Unlike the <a href="lb-addstring.html"><strong>LB_ADDSTRING</strong></a> message, the <a href="lb-insertstring.html"><strong>LB_INSERTSTRING</strong></a> message does not cause a list with the <a href="list-box-styles.html"><strong>LBS_SORT</strong></a> style to be sorted. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-itemfrompoint.html"><strong>LB_ITEMFROMPOINT</strong></a></td>
<td>Gets the zero-based index of the item nearest the specified point in a list box.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-resetcontent.html"><strong>LB_RESETCONTENT</strong></a></td>
<td>Removes all items from a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-selectstring.html"><strong>LB_SELECTSTRING</strong></a></td>
<td>Searches a list box for an item that begins with the characters in a specified string. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-selitemrange.html"><strong>LB_SELITEMRANGE</strong></a></td>
<td>Selects or deselects one or more consecutive items in a multiple-selection list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-selitemrangeex.html"><strong>LB_SELITEMRANGEEX</strong></a></td>
<td>Selects one or more consecutive items in a multiple-selection list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-setanchorindex.html"><strong>LB_SETANCHORINDEX</strong></a></td>
<td>Sets the anchor item that is, the item from which a multiple selection starts. A multiple selection spans all items from the anchor item to the caret item.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-setcaretindex.html"><strong>LB_SETCARETINDEX</strong></a></td>
<td>Sets the focus rectangle to the item at the specified index in a multiple-selection list box. If the item is not visible, it is scrolled into view. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-setcolumnwidth.html"><strong>LB_SETCOLUMNWIDTH</strong></a></td>
<td>Sets the width, in pixels, of all columns in a multiple-column list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-setcount.html"><strong>LB_SETCOUNT</strong></a></td>
<td>Sets the count of items in a list box created with the <a href="list-box-styles.html"><strong>LBS_NODATA</strong></a> style and not created with the <a href="list-box-styles.html"><strong>LBS_HASSTRINGS</strong></a> style. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-setcursel.html"><strong>LB_SETCURSEL</strong></a></td>
<td>Selects a string and scrolls it into view, if necessary. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-sethorizontalextent.html"><strong>LB_SETHORIZONTALEXTENT</strong></a></td>
<td>Sets the width, in pixels, by which a list box can be scrolled horizontally (the scrollable width). <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-setitemdata.html"><strong>LB_SETITEMDATA</strong></a></td>
<td>Sets a value that is associated with the specified item in a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-setitemheight.html"><strong>LB_SETITEMHEIGHT</strong></a></td>
<td>Sets the height, in pixels, of items in a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-setlocale.html"><strong>LB_SETLOCALE</strong></a></td>
<td>Sets the current locale of the list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-setsel.html"><strong>LB_SETSEL</strong></a></td>
<td>Selects a string in a multiple-selection list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-settabstops.html"><strong>LB_SETTABSTOPS</strong></a></td>
<td>Sets the tab-stop positions in a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lb-settopindex.html"><strong>LB_SETTOPINDEX</strong></a></td>
<td>Ensures that the specified item in a list box is visible. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Notifications</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="lbn-dblclk.html">LBN_DBLCLK</a></td>
<td>Notifies the application that the user has double-clicked an item in a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lbn-errspace.html">LBN_ERRSPACE</a></td>
<td>Notifies the application that the list box cannot allocate enough memory to meet a specific request. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lbn-killfocus.html">LBN_KILLFOCUS</a></td>
<td>Notifies the application that the list box has lost the keyboard focus. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lbn-selcancel.html">LBN_SELCANCEL</a></td>
<td>Notifies the application that the user has canceled the selection in a list box. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lbn-selchange.html">LBN_SELCHANGE</a></td>
<td>Notifies the application that the selection in a list box has changed. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="lbn-setfocus.html">LBN_SETFOCUS</a></td>
<td>Notifies the application that the list box has received the keyboard focus. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-chartoitem.html"><strong>WM_CHARTOITEM</strong></a></td>
<td>Sent by a list box with the <a href="list-box-styles.html"><strong>LBS_WANTKEYBOARDINPUT</strong></a> style to its owner in response to a <a href="/windows/desktop/inputdev/wm-char"><strong>WM_CHAR</strong></a> message. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-ctlcolorlistbox.html"><strong>WM_CTLCOLORLISTBOX</strong></a></td>
<td>Sent to the parent window of a list box before the system draws the list box. By responding to this message, the parent window can set the text and background colors of the list box by using the specified display device context handle. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-deleteitem.html"><strong>WM_DELETEITEM</strong></a></td>
<td>Sent to the owner of a list box or combo box when the list box or combo box is destroyed or when items are removed by the <a href="lb-deletestring.html"><strong>LB_DELETESTRING</strong></a>, <a href="lb-resetcontent.html"><strong>LB_RESETCONTENT</strong></a>, <a href="cb-deletestring.html"><strong>CB_DELETESTRING</strong></a>, or <a href="cb-resetcontent.html"><strong>CB_RESETCONTENT</strong></a> message. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-vkeytoitem.html"><strong>WM_VKEYTOITEM</strong></a></td>
<td>Sent by a list box with the <a href="list-box-styles.html"><strong>LBS_WANTKEYBOARDINPUT</strong></a> style to its owner in response to a <a href="/windows/desktop/inputdev/wm-keydown"><strong>WM_KEYDOWN</strong></a> message. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dl-begindrag.html">DL_BEGINDRAG</a></td>
<td>Notifies the drag list box's parent window that the user has clicked the left mouse button on an item. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dl-canceldrag.html">DL_CANCELDRAG</a></td>
<td>Signals that the user has canceled a drag operation by clicking the right mouse button or pressing the ESC key. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dl-dragging.html">DL_DRAGGING</a></td>
<td>Signals that the user has moved the mouse while dragging an item. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="dl-dropped.html">DL_DROPPED</a></td>
<td>Signals that the user has completed a drag operation by releasing the left mouse button. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Structures</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/winuser/ns-winuser-deleteitemstruct"><strong>DELETEITEMSTRUCT</strong></a></td>
<td>Contains information about a deleted list box or combo box item.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/commctrl/ns-commctrl-draglistinfo"><strong>DRAGLISTINFO</strong></a></td>
<td>Contains information about a drag event. The pointer to <a href="/windows/win32/api/commctrl/ns-commctrl-draglistinfo"><strong>DRAGLISTINFO</strong></a> is passed as the <em>lParam</em> parameter of the drag list message. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Constants</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="list-box-styles.html">List Box Styles</a></td>
<td>Describes the window styles that define a list box control. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
