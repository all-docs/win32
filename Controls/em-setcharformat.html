<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EM_SETCHARFORMAT message</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: EM_SETCHARFORMAT message (Richedit.h)
description: Sets character formatting in a rich edit control.
ms.assetid: 5e7a545d-4ca4-4dc6-badb-584c11194982
keywords:</p>
<ul>
<li>EM_SETCHARFORMAT message Windows Controls
topic_type:</li>
<li>apiref
api_name:</li>
<li>EM_SETCHARFORMAT
api_location:</li>
<li>Richedit.h
api_type:</li>
<li>HeaderDef
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>EM_SETCHARFORMAT message</h1>
<p>Sets character formatting in a rich edit control.</p>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>wParam</em></p>
<!-- raw HTML omitted -->
<p>Character formatting that applies to the control. If this parameter is zero, the default character format is set. Otherwise, it can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SCF_ALL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Applies the formatting to all text in the control. Not valid with <strong>SCF_SELECTION</strong> or <strong>SCF_WORD</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SCF_ASSOCIATEFONT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>RichEdit 4.1:</strong> Associates a font to a given script, thus changing the default font for that script. To specify the font, use the following members of <a href="/windows/desktop/api/Richedit/ns-richedit-charformat2a"><strong>CHARFORMAT2</strong></a>: <strong>yHeight</strong>, <strong>bCharSet</strong>, <strong>bPitchAndFamily</strong>, <strong>szFaceName</strong>, and <strong>lcid</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SCF_ASSOCIATEFONT2</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>RichEdit 4.1:</strong> Associates a surrogate (plane-2) font to a given script, thus changing the default font for that script. To specify the font, use the following members of <a href="/windows/desktop/api/Richedit/ns-richedit-charformat2a"><strong>CHARFORMAT2</strong></a>: <strong>yHeight</strong>, <strong>bCharSet</strong>, <strong>bPitchAndFamily</strong>, <strong>szFaceName</strong>, and <strong>lcid</strong>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SCF_CHARREPFROMLCID</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Gets the character repertoire from the LCID.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SCF_DEFAULT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>RichEdit 4.1:</strong> Sets the default font for the control. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SPF_DONTSETDEFAULT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Prevents setting the default paragraph format when the rich edit control is empty.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SCF_NOKBUPDATE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>RichEdit 4.1:</strong> Prevents keyboard switching to match the font. For example, if an Arabic font is set, normally the automatic keyboard feature for Bidi languages changes the keyboard to an Arabic keyboard.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SCF_SELECTION</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Applies the formatting to the current selection. If the selection is empty, the character formatting is applied to the insertion point, and the new character format is in effect only until the insertion point changes.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SPF_SETDEFAULT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Sets the default paragraph formatting attributes.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SCF_SMARTFONT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Apply the font only if it can handle script.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SCF_USEUIRULES</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td><strong>RichEdit 4.1:</strong> Used with <strong>SCF_SELECTION</strong>. Indicates that format came from a toolbar or other UI tool, so UI formatting rules should be used instead of literal formatting.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>SCF_WORD</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Applies the formatting to the selected word or words. If the selection is empty but the insertion point is inside a word, the formatting is applied to the word. The <strong>SCF_WORD</strong> value must be used in conjunction with the <strong>SCF_SELECTION</strong> value.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>lParam</em></p>
<!-- raw HTML omitted -->
<p>Pointer to a <a href="/windows/win32/api/richedit/ns-richedit-charformata"><strong>CHARFORMAT</strong></a> structure specifying the character formatting to use. Only the formatting attributes specified by the <strong>dwMask</strong> member are changed.</p>
<p>Microsoft Rich Edit 2.0 and later: This parameter can be a pointer to a <a href="/windows/desktop/api/Richedit/ns-richedit-charformat2a"><strong>CHARFORMAT2</strong></a> structure, which is an extension of the <a href="/windows/win32/api/richedit/ns-richedit-charformata"><strong>CHARFORMAT</strong></a> structure. Before sending the <strong>EM_SETCHARFORMAT</strong> message, set the structure's <strong>cbSize</strong> member to <code>sizeof(CHARFORMAT)</code> or <code>sizeof(CHARFORMAT2)</code> indicate which version of the structure is being used.</p>
<p>The <strong>szFaceName</strong> and <strong>bCharSet</strong> members may be overruled when invalid for characters, for example: Arial on kanji characters.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the operation succeeds, the return value is a nonzero value.</p>
<p>If the operation fails, the return value is zero.</p>
<h2>Remarks</h2>
<p>If this message is sent more than once with the same parameters, the effect on the text is toggled. That is, sending the message once produces the effect, sending the message twice cancels the effect, and so forth.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Richedit.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/richedit/ns-richedit-charformata"><strong>CHARFORMAT</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Richedit/ns-richedit-charformat2a"><strong>CHARFORMAT2</strong></a></p>
<!-- raw HTML omitted -->
</body>
