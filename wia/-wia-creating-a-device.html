<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Creating a Device</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Once an application has the device ID of a given device, it can call the IWiaDevMgr::CreateDevice or IWiaDevMgr2::CreateDevicemethod, which creates a hierarchical tree of IWiaItem or IWiaItem2 objects that represent an imaging device and the image scanning beds, and folders contained on that device.
ms.assetid: 807695c2-4c42-4318-9a5d-d34ac9014f0f
title: Creating a Device
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Creating a Device</h1>
<p>Once an application has the device ID of a given device, it can call the <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-createdevice"><strong>IWiaDevMgr::CreateDevice</strong></a> or <a href="-wia-iwiadevmgr2-createdevice.html"><strong>IWiaDevMgr2::CreateDevice</strong></a>method, which creates a hierarchical tree of <a href="/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem"><strong>IWiaItem</strong></a> or <a href="-wia-iwiaitem2.html"><strong>IWiaItem2</strong></a> objects that represent an imaging device and the image scanning beds, and folders contained on that device.</p>
<p>The following example from the sample application WiaSSamp implements a function that takes a device ID as a parameter. For information about how to obtain a device ID for a particular device, see <a href="-wia-reading-device-properties.html">Reading Device Properties</a>.</p>
<pre><code>    //XP or earlier:
    HRESULT CreateWiaDevice( IWiaDevMgr *pWiaDevMgr, BSTR bstrDeviceID, IWiaItem **ppWiaDevice ) 
    //Vista or later:
    HRESULT CreateWiaDevice( IWiaDevMgr2 *pWiaDevMgr, BSTR bstrDeviceID, IWiaItem2 **ppWiaDevice ) 
    {
        //
        // Validate arguments
        //
        if (NULL == pWiaDevMgr || NULL == bstrDeviceID || NULL == ppWiaDevice)
        {
            return E_INVALIDARG;
        }

        //
        // Initialize out variables
        //
        *ppWiaDevice = NULL;

        //
        // Create the WIA Device
        //
        HRESULT hr = pWiaDevMgr-&gt;CreateDevice( bstrDeviceID, ppWiaDevice );

        //
        // Return the result of creating the device
        //
        return hr;
    }
</code></pre>
<p>In this example, <strong>pWiaDevMgr</strong> is a pointer to the <a href="/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr"><strong>IWiaDevMgr</strong></a> or <a href="-wia-iwiadevmgr2.html"><strong>IWiaDevMgr2</strong></a> interface, and <strong>ppWiaDevice</strong> is a variable that, after the call to <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-createdevice"><strong>IWiaDevMgr::CreateDevice</strong></a> (or to <a href="-wia-iwiadevmgr2-createdevice.html"><strong>IWiaDevMgr2::CreateDevice</strong></a>), contains the address of a pointer to the root item of the tree that represents the newly created device.</p>
<p>Â </p>
<p>Â </p>
</body>
