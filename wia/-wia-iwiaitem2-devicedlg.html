<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IWiaItem2::DeviceDlg method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Displays a dialog box to the user to prepare for image acquisition.
ms.assetid: 2d7246ec-fb90-4538-b717-b9e3813c1696
title: IWiaItem2::DeviceDlg method (Wia.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>IWiaItem2.DeviceDlg
api_type:</li>
<li>COM
api_location:</li>
<li>Wia.h</li>
</ul>
<hr />
<h1>IWiaItem2::DeviceDlg method</h1>
<p>Displays a dialog box to the user to prepare for image acquisition.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT DeviceDlg(
  [in]Â Â Â Â Â Â LONG Â Â Â Â Â lFlags,
  [in]Â Â Â Â Â Â HWND Â Â Â Â Â hwndParent,
  [in]Â Â Â Â Â Â BSTR Â Â Â Â Â bstrFolderName,
  [in]Â Â Â Â Â Â BSTR Â Â Â Â Â bstrFilename,
  [in]Â Â Â Â Â Â LONG Â Â Â Â Â *plNumFiles,
  [in, out]Â BSTR Â Â Â Â Â **ppbstrFilePaths,
  [in, out]Â IWiaItem2 **ppIWiaItem2
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>lFlags</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LONG</strong></p>
<p>Specifies a set of flags that control the dialog box's operation. The value can be either 0 to represent the default behavior or any of the WIA_DEVICE_DIALOG flags described in <a href="-wia-wiaflag.html"><strong>WiaFlag</strong></a>.</p>
<!-- raw HTML omitted -->
<p><em>hwndParent</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>HWND</strong></p>
<p>A handle to the parent window.</p>
<!-- raw HTML omitted -->
<p><em>bstrFolderName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>BSTR</strong></p>
<p>Specifies the folder name where the files are to be transferred.</p>
<!-- raw HTML omitted -->
<p><em>bstrFilename</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>BSTR</strong></p>
<p>Specifies the template file name.</p>
<!-- raw HTML omitted -->
<p><em>plNumFiles</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LONG*</strong></p>
<p>A pointer to the number of items in the <em>ppbstrFilePaths</em> array.</p>
<!-- raw HTML omitted -->
<p><em>ppbstrFilePaths</em> [in, out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>BSTR**</strong></p>
<p>The address of a pointer to an array of paths for the scanned files. Initialize the pointer to point to an array of size zero (0) before <strong>IWiaItem2::DeviceDlg</strong> is called.</p>
<!-- raw HTML omitted -->
<p><em>ppIWiaItem2</em> [in, out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="-wia-iwiaitem2.html"><strong>IWiaItem2</strong></a>**</strong></p>
<p>The address of an array of pointers to <a href="-wia-iwiaitem2.html"><strong>IWiaItem2</strong></a> interfaces.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>HRESULT</strong></p>
<p>If this method succeeds, it returns <strong>S_OK</strong>. Otherwise, it returns an <strong>HRESULT</strong> error code.</p>
<h2>Remarks</h2>
<p>This method displays a dialog box to the user that an application uses to gather all the information required for image acquisition. It is also used to specify image scan properties such as brightness and contrast.</p>
<p>After this method returns, the application can use the <a href="-wia-iwiatransfer.html"><strong>IWiaTransfer</strong></a> interface to acquire the image.</p>
<p>Applications must call the <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-release">IUnknown::Release</a> method for each element in the array of interface pointers they receive through the <em>ppIWiaItem2</em> parameter. Applications must also free the array using <a href="/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree">CoTaskMemFree</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wia.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IDL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wia.idl<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
