<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IWiaErrorHandler::ReportStatus method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Handles status and error messages during image data transfers and displays them to the user.
ms.assetid: 23e85c63-80b9-4510-854d-289c8d23be2d
title: IWiaErrorHandler::ReportStatus method (Wia.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>IWiaErrorHandler.ReportStatus
api_type:</li>
<li>COM
api_location:</li>
<li>Wiaguid.lib</li>
<li>Wiaguid.dll</li>
</ul>
<hr />
<h1>IWiaErrorHandler::ReportStatus method</h1>
<p>Handles status and error messages during image data transfers and displays them to the user.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT ReportStatus(
  [in]Â HWND Â Â Â Â hwndParent,
  [in]Â IUnknown *punkItem,
  [in]Â HRESULT Â hrStatus,
  [in]Â LONG Â Â Â Â cbResLength,
  [in]Â BYTE Â Â Â Â *pbData
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>hwndParent</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>HWND</strong></p>
<p><strong>HWND</strong> that is the parent window for the message window.</p>
<!-- raw HTML omitted -->
<p><em>punkItem</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="/windows/win32/api/unknwn/nn-unknwn-iunknown">IUnknown</a>*</strong></p>
<p>Pointer to the <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown">IUnknown</a> interface of the item being transferred. This object minimally implements <a href="-wia-iwiaitem2.html"><strong>IWiaItem2</strong></a> and <a href="/windows/desktop/api/wia_xp/nn-wia_xp-iwiadatatransfer"><strong>IWiaDataTransfer</strong></a>.</p>
<!-- raw HTML omitted -->
<p><em>hrStatus</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>HRESULT</strong></p>
<p><strong>HRESULT</strong> that is the status code received by <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiadatacallback-bandeddatacallback"><strong>BandedDataCallback</strong></a>.</p>
<!-- raw HTML omitted -->
<p><em>cbResLength</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LONG</strong></p>
<p><strong>LONG</strong> that is the size of the data referred to by <em>pbData</em>.</p>
<!-- raw HTML omitted -->
<p><em>pbData</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>BYTE*</strong></p>
<p>Pointer to the data buffer as received by <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiadatacallback-bandeddatacallback"><strong>BandedDataCallback</strong></a>.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>HRESULT</strong></p>
<p>Returns <em>hrStatus</em> if the error cannot be recovered from. Otherwise, it returns one of the following values.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_OK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The appropriate action was taken to correct the error and the transfer can continue. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>S_FALSE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>No action was taken to handle the error or report status to the user. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_ABORT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The user chose to abort the transfer in response to the displayed dialog box. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<p>Windows Image Acquisition (WIA)Â 2.0 calls <strong>IWiaErrorHandler::ReportStatus</strong> when the driver sends an <strong>IT_MSG_DEVICE_STATUS</strong> message to <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiadatacallback-bandeddatacallback"><strong>BandedDataCallback</strong></a>. This method handles the message and displays information to the user about the status or error. If the message is about an error, the method lets the user choose, if possible, whether to try to recover from the error and continue the transfer or to abort.</p>
<p><em>hrStatus</em> is set to WIA_STATUS_TRANSFER_BEGIN to inform the handler a transfer has started. It is set to WIA_STATUS_TRANSFER_END when the transfer is complete.</p>
<p>If <em>hrStatus</em> is SEVERITY_SUCCESS, the user should be allowed to cancel the transfer.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wia.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IDL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wia.idl<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wiaguid.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
