<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Previewing Video (WIA)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The IWiaVideo interface enables an application to view video and capture still images from it.
ms.assetid: 59eddbdc-4957-44be-a602-0763f3385e89
title: Previewing Video (WIA)
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Previewing Video (WIA)</h1>
<p>The <a href="/windows/desktop/api/Wiavideo/nn-wiavideo-iwiavideo"><strong>IWiaVideo</strong></a> interface enables an application to view video and capture still images from it. Perform the following steps to select the streaming video device and display a video stream in a window.</p>
<ul>
<li>Call <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance">CoCreateInstance</a> to retrieve a pointer to the <a href="/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr"><strong>IWiaDevMgr</strong></a> interface.</li>
<li>Use the <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-enumdeviceinfo"><strong>IWiaDevMgr::EnumDeviceInfo</strong></a> method of the <a href="/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr"><strong>IWiaDevMgr</strong></a> interface to obtain a pointer to the <a href="/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_info"><strong>IEnumWIA_DEV_INFO</strong></a> interface. For instructions on how to enumerate devices, see Enumerating System Devices.</li>
<li>Use the <a href="/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_info"><strong>IEnumWIA_DEV_INFO</strong></a> interface to obtain an <a href="/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage"><strong>IWiaPropertyStorage</strong></a> interface pointer for each Windows Image Acquisition (WIA) device found.</li>
<li>Use the <a href="/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage"><strong>IWiaPropertyStorage</strong></a> interface to get the DeviceID property of the desired device. A streaming video device has the StiDeviceTypeStreamingVideo flag of the WIA_DIP_DEV_TYPE property set.</li>
<li>Use the <a href="/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage"><strong>IWiaPropertyStorage</strong></a> interface to get the WIA_DPV_IMAGES_DIRECTORY property value.</li>
<li>Call <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance">CoCreateInstance</a> to retrieve a pointer to the <a href="/windows/desktop/api/Wiavideo/nn-wiavideo-iwiavideo"><strong>IWiaVideo</strong></a> interface.</li>
<li>Set the <a href="/windows/desktop/api/Wiavideo/nf-wiavideo-iwiavideo-get_imagesdirectory"><strong>IWiaVideo::ImagesDirectory</strong></a> property of the <a href="/windows/desktop/api/Wiavideo/nn-wiavideo-iwiavideo"><strong>IWiaVideo</strong></a> interface to the value received from the WIA_DPV_IMAGES_DIRECTORY property value.</li>
<li>Call <a href="/windows/desktop/api/Wiavideo/nf-wiavideo-iwiavideo-createvideobywiadevid"><strong>IWiaVideo::CreateVideoByWiaDevID</strong></a> on the <a href="/windows/desktop/api/Wiavideo/nn-wiavideo-iwiavideo"><strong>IWiaVideo</strong></a> interface, passing the device ID of the streaming image device and the handle of the window in which the video is to be displayed.</li>
</ul>
<blockquote>
<p>[!Note]<br />
WIA does not support video devices in Windows ServerÂ 2003, WindowsÂ Vista, or later. For those versions of the Windows, use <a href="/previous-versions//ms783323(v=vs.85)">DirectShow</a> to acquire images from video.</p>
</blockquote>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
