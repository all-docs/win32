<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Capturing a Still Image from a Video Stream</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: After beginning preview of a video stream, call the IWiaVideo::TakePicture method of the IWiaVideo interface to capture a still image from the streaming video.
ms.assetid: 2b8c465b-0dbf-4741-a701-200862cc3de3
title: Capturing a Still Image from a Video Stream
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Capturing a Still Image from a Video Stream</h1>
<p>After beginning preview of a video stream, call the <a href="/windows/desktop/api/Wiavideo/nf-wiavideo-iwiavideo-takepicture"><strong>IWiaVideo::TakePicture</strong></a> method of the <a href="/windows/desktop/api/Wiavideo/nn-wiavideo-iwiavideo"><strong>IWiaVideo</strong></a> interface to capture a still image from the streaming video. For instructions on how to get an <strong>IWiaVideo</strong> pointer and begin previewing streaming video, see <a href="-wia-previewing-video.html">Previewing Video</a>.</p>
<p>When the <a href="/windows/desktop/api/Wiavideo/nf-wiavideo-iwiavideo-takepicture"><strong>IWiaVideo::TakePicture</strong></a> method returns, the <em>pbstrNewImageFilename</em> parameter contains the full path and filename of the resulting image file. The file is in JPEG format. The directory in which the file is created is specified by the value of the <a href="/windows/desktop/api/Wiavideo/nf-wiavideo-iwiavideo-get_imagesdirectory"><strong>IWiaVideo::ImagesDirectory</strong></a> property of the <a href="/windows/desktop/api/Wiavideo/nn-wiavideo-iwiavideo"><strong>IWiaVideo</strong></a> interface.</p>
<blockquote>
<p>[!Note]<br />
Windows Image Acquisition (WIA) does not support video devices in Windows ServerÂ 2003, WindowsÂ Vista, or later. For those versions of the Windows, use <a href="/previous-versions//ms783323(v=vs.85)">DirectShow</a> to acquire images from video.</p>
</blockquote>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
