<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Registering for Events</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The following example uses the Windows Image Acquisition (WIA)Â 1.0Â IWiaDevMgr::RegisterEventCallbackCLSID method to register for notification when any Windows Image Acquisition (WIA) device is connected to the system.
ms.assetid: 1f2c7bc9-876a-4693-9439-52735e4b9d5f
title: Registering for Events
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Registering for Events</h1>
<p>The following example uses the Windows Image Acquisition (WIA)Â 1.0Â <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackclsid"><strong>IWiaDevMgr::RegisterEventCallbackCLSID</strong></a> method to register for notification when any Windows Image Acquisition (WIA) device is connected to the system. Applications can also use WIA 1.0Â <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackinterface"><strong>IWiaDevMgr::RegisterEventCallbackInterface</strong></a> and WIA 1.0Â <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackprogram"><strong>IWiaDevMgr::RegisterEventCallbackProgram</strong></a> to register for events. With WindowsÂ Vista and later, you can use the Windows Image Acquisition (WIA)Â 2.0Â <a href="-wia-iwiadevmgr2-registereventcallbackclsid.html"><strong>IWiaDevMgr2::RegisterEventCallbackCLSID</strong></a>, <a href="-wia-iwiadevmgr2-registereventcallbackinterface.html"><strong>IWiaDevMgr2::RegisterEventCallbackInterface</strong></a>, or <a href="-wia-iwiadevmgr2-registereventcallbackprogram.html"><strong>IWiaDevMgr2::RegisterEventCallbackProgram</strong></a> methods to register for events.</p>
<p>It is assumed that the example is taken from an application that is registered as a Component Object Model (COM) out-of-process server object.</p>
<p>The call to <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackclsid"><strong>IWiaDevMgr::RegisterEventCallbackCLSID</strong></a> (or <a href="-wia-iwiadevmgr2-registereventcallbackclsid.html"><strong>IWiaDevMgr2::RegisterEventCallbackCLSID</strong></a>) is as follows:</p>
<pre><code>    pWiaDevMgr-&gt;RegisterEventCallbackCLSID( WIA_REGISTER_EVENT_CALLBACK,
                                            NULL,
                                            WIA_EVENT_DEVICE_CONNECTED,
                                            pCLSID,
                                            bstrName,
                                            bstrDescription,
                                            bstrIcon
                                            );
</code></pre>
<p>In the previous code, <strong>pWiaDevMgr</strong> is a valid pointer to the <a href="/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr"><strong>IWiaDevMgr</strong></a> (or <a href="-wia-iwiadevmgr2.html"><strong>IWiaDevMgr2</strong></a>) interface, WIA_REGISTER_EVENT_CALLBACK is a constant that specifies that this call is to register for the event as opposed to unregistering for the event, WIA_EVENT_DEVICE_CONNECTED is a constant that specifies that the application is registering to be notified whenever a device is connected to the user's computer, <strong>pCLSID</strong> is a pointer to the registered CLSID of the application, <strong>bstrName</strong> is the name of the application, <strong>bstrDescription</strong> is a text description of the application, and <strong>bstrIcon</strong> is the name of an image file to be used for the icon for the application registering for the event.</p>
<p>The application must then implement the <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback"><strong>IWiaEventCallback::ImageEventCallback</strong></a> method, which is called whenever an event occurs for which the application is registered.</p>
<p>An application can use the <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiaitem-enumregistereventinfo"><strong>IWiaItem::EnumRegisterEventInfo</strong></a> (or <a href="-wia-iwiaitem2-enumregistereventinfo.html"><strong>IWiaItem2::EnumRegisterEventInfo</strong></a>) method to enumerate the information about events for which it is registered.</p>
<p>Â </p>
<p>Â </p>
</body>
