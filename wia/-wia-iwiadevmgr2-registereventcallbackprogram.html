<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IWiaDevMgr2::RegisterEventCallbackProgram method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: The IWiaDevMgr2::RegisterEventCallbackProgram method registers an application to receive device events. It is primarily provided for backward compatibility with applications that were not written for Windows Image Acquisition (WIA)Â 2.0.
ms.assetid: 6b427f19-719b-44ce-8e2c-3c44672345c8
title: IWiaDevMgr2::RegisterEventCallbackProgram method (Wia.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>IWiaDevMgr2.RegisterEventCallbackProgram
api_type:</li>
<li>COM
api_location:</li>
<li>Wia.h</li>
</ul>
<hr />
<h1>IWiaDevMgr2::RegisterEventCallbackProgram method</h1>
<p>The <strong>IWiaDevMgr2::RegisterEventCallbackProgram</strong> method registers an application to receive device events. It is primarily provided for backward compatibility with applications that were not written for Windows Image Acquisition (WIA)Â 2.0.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT RegisterEventCallbackProgram(
  [in]Â Â Â Â Â Â Â LONG lFlags,
  [in]Â Â Â Â Â Â Â BSTR bstrDeviceID,
  [in]Â const GUID *pEventGUID,
  [in]Â Â Â Â Â Â Â BSTR bstrFullAppName,
  [in]Â Â Â Â Â Â Â BSTR bstrCommandlineArg,
  [in]Â Â Â Â Â Â Â BSTR bstrName,
  [in]Â Â Â Â Â Â Â BSTR bstrDescription,
  [in]Â Â Â Â Â Â Â BSTR bstrIcon
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>lFlags</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LONG</strong></p>
<p>The registration flags. Can be set to the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>WIA_REGISTER_EVENT_CALLBACK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Register for the event.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>WIA_UNREGISTER_EVENT_CALLBACK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Delete the registration for the event.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>WIA_SET_DEFAULT_HANDLER</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Set the application as the default event handler.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p><em>bstrDeviceID</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>BSTR</strong></p>
<p>A device identifier. Pass <strong>NULL</strong> to register for the event on all WIA 2.0 devices.</p>
<!-- raw HTML omitted -->
<p><em>pEventGUID</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>const GUID*</strong></p>
<p>The event that the application is registering for. For a list of valid event GUIDs, see <a href="-wia-wia-event-identifiers.html">WIA Event Identifiers</a>.</p>
<!-- raw HTML omitted -->
<p><em>bstrFullAppName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>BSTR</strong></p>
<p>The full path name of the application.</p>
<!-- raw HTML omitted -->
<p><em>bstrCommandlineArg</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>BSTR</strong></p>
<p>The appropriate command-line arguments for the application.</p>
<!-- raw HTML omitted -->
<p><em>bstrName</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>BSTR</strong></p>
<p>The name of the application. The name is displayed to the user when multiple applications register for the same event.</p>
<!-- raw HTML omitted -->
<p><em>bstrDescription</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>BSTR</strong></p>
<p>The description of the application. The description is displayed to the user when multiple applications register for the same event.</p>
<!-- raw HTML omitted -->
<p><em>bstrIcon</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>BSTR</strong></p>
<p>The icon that represents the application. The icon is displayed to the user when multiple applications register for the same event. The string contains the name of the application and the zero-based index of the icon separated by a comma, for example, &quot;MyApp, 0&quot;. There might be more than one icon that represents an application.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>HRESULT</strong></p>
<p>If this method succeeds, it returns <strong>S_OK</strong>. Otherwise, it returns an <strong>HRESULT</strong> error code.</p>
<h2>Remarks</h2>
<p>Use <strong>IWiaDevMgr2::RegisterEventCallbackProgram</strong> to register for hardware device events. When an event occurs that an application is registered for, the application is launched, and the event information is transmitted to the application.</p>
<p>Use the <a href="-wia-iwiaitem2-enumregistereventinfo.html"><strong>EnumRegisterEventInfo</strong></a> method to retrieve a pointer to an enumerator object for event registration properties.</p>
<p>Only use the <strong>IWiaDevMgr2::RegisterEventCallbackProgram</strong> method for backward compatibility with applications not written for the WIA 2.0 architecture. Use the Component Object Model (COM) interfaces provided by the WIA 2.0 architecture for new applications. Specifically, call <a href="-wia-iwiadevmgr2-registereventcallbackinterface.html"><strong>IWiaDevMgr2::RegisterEventCallbackInterface</strong></a> or <a href="-wia-iwiadevmgr2-registereventcallbackclsid.html"><strong>IWiaDevMgr2::RegisterEventCallbackCLSID</strong></a> to register a new application for device events.</p>
<p>Typically, this method is called by an install program or a script. The install program or script registers the application to receive WIA 2.0 device events. When the event occurs, the application is started by the WIA 2.0 run-time system.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wia.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
