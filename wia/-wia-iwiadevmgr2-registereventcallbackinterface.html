<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IWiaDevMgr2::RegisterEventCallbackInterface method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Registers a running application for Windows Image Acquisition (WIA)Â 2.0 event notification.
ms.assetid: 978dcd41-d63b-421d-b7e1-8e9368b36180
title: IWiaDevMgr2::RegisterEventCallbackInterface method (Wia.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>IWiaDevMgr2.RegisterEventCallbackInterface
api_type:</li>
<li>COM
api_location:</li>
<li>Wia.h</li>
</ul>
<hr />
<h1>IWiaDevMgr2::RegisterEventCallbackInterface method</h1>
<p>Registers a running application for Windows Image Acquisition (WIA)Â 2.0 event notification.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT RegisterEventCallbackInterface(
  [in]Â Â Â Â Â Â Â Â LONG Â Â Â Â Â Â Â Â Â Â Â Â Â lFlags,
  [in]Â Â Â Â Â Â Â Â BSTR Â Â Â Â Â Â Â Â Â Â Â Â Â bstrDeviceID,
  [in]Â Â const GUID Â Â Â Â Â Â Â Â Â Â Â Â Â *pEventGUID,
  [in]Â Â Â Â Â Â Â Â IWiaEventCallback *pIWiaEventCallback,
  [out]Â Â Â Â Â Â Â IUnknown Â Â Â Â Â Â Â Â Â **pEventObject
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>lFlags</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>LONG</strong></p>
<p>Currently unused. Should be set to zero.</p>
<!-- raw HTML omitted -->
<p><em>bstrDeviceID</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>BSTR</strong></p>
<p>Specifies the unique identifier of a WIA 2.0 device. Set this parameter to <strong>NULL</strong> to register for the event on all WIA 2.0 devices.</p>
<!-- raw HTML omitted -->
<p><em>pEventGUID</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>const GUID*</strong></p>
<p>Specifies a pointer to the event identifier that the application is registering for. See <a href="-wia-wia-event-identifiers.html">WIA Event Identifiers</a> for standard event identifiers.</p>
<!-- raw HTML omitted -->
<p><em>pIWiaEventCallback</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="/windows/desktop/api/wia_xp/nn-wia_xp-iwiaeventcallback"><strong>IWiaEventCallback</strong></a>*</strong></p>
<p>Specifies a pointer to the <a href="/windows/desktop/api/wia_xp/nn-wia_xp-iwiaeventcallback"><strong>IWiaEventCallback</strong></a> interface that the WIA 2.0 uses to send event notification.</p>
<!-- raw HTML omitted -->
<p><em>pEventObject</em> [out]</p>
<!-- raw HTML omitted -->
<p>Type: <strong><a href="/windows/win32/api/unknwn/nn-unknwn-iunknown">IUnknown</a>**</strong></p>
<p>Receives the address of a pointer to the <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown">IUnknown</a> interface.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>HRESULT</strong></p>
<p>Returns the standard COM error codes or the following.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>E_NOTIMPL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>The <a href="/windows/win32/api/unknwn/nn-unknwn-iunknown">IUnknown</a> interface cannot be returned. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Remarks</h2>
<blockquote>
<p>[!WARNING]
Using the <a href="/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackinterface"><strong>IWiaDevMgr::RegisterEventCallbackInterface</strong></a>, <strong>IWiaDevMgr2::RegisterEventCallbackInterface</strong>, and <a href="/previous-versions/windows/desktop/wiaaut/-wiaaut-idevicemanager-registerevent"><strong>DeviceManager.RegisterEvent</strong></a> methods from the same process after the Still Image Service is restarted may cause an access violation, if the functions were used before the service was stopped.</p>
</blockquote>
<p>Â </p>
<p>When WIA 2.0 applications begin executing, they use this method to register to receive hardware device events. This prevents the application from being restarted when another event for which it is registered occurs. Once an application calls <strong>IWiaDevMgr2::RegisterEventCallbackInterface</strong> to register itself to receive WIA 2.0 events from a device, the registered events are routed to the program by WIA 2.0.</p>
<p>Applications must call the <a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-release">IUnknown::Release</a> method on the interface pointers they receive through the <em>pEventObject</em> parameter.</p>
<blockquote>
<p>[!Note]<br />
In a multithreaded application, the event notification callback may come in on a different thread from the one that registered the callback.</p>
</blockquote>
<p>Â </p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wia.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IDL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wia.idl<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
</body>
