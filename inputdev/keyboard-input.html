<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Keyboard Input</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Keyboard Input
description: This section discusses how the system generates keyboard input and how an application receives and processes that input.
ms.assetid: 'vs|winui|~\winui\windowsuserinterface\userinput\keyboardinput.htm'
keywords:</p>
<ul>
<li>user input,keyboard input</li>
<li>capturing user input,keyboard input</li>
<li>keyboard input
ms.topic: article
ms.date: 08/01/2022</li>
</ul>
<hr />
<h1>Keyboard Input</h1>
<p>This section describes how the system generates keyboard input and how an application receives and processes that input.</p>
<h2>In This Section</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="about-keyboard-input.html">About Keyboard Input</a></td>
<td>Discusses keyboard input.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="using-keyboard-input.html">Using Keyboard Input</a></td>
<td>Covers tasks that are associated with keyboard input. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="keyboard-input-reference.html">Keyboard Input Reference</a></td>
<td>Contains the API reference.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Functions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-activatekeyboardlayout"><strong>ActivateKeyboardLayout</strong></a></td>
<td>Sets the input locale identifier (formerly called the keyboard layout handle) for the calling thread or the current process. The input locale identifier specifies a locale as well as the physical layout of the keyboard.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-blockinput"><strong>BlockInput</strong></a></td>
<td>Blocks keyboard and mouse input events from reaching applications. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-enablewindow"><strong>EnableWindow</strong></a></td>
<td>Enables or disables mouse and keyboard input to the specified window or control. When input is disabled, the window does not receive input such as mouse clicks and key presses. When input is enabled, the window receives all input.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-getactivewindow"><strong>GetActiveWindow</strong></a></td>
<td>Retrieves the window handle to the active window attached to the calling thread's message queue. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-getasynckeystate"><strong>GetAsyncKeyState</strong></a></td>
<td>Determines whether a key is up or down at the time the function is called, and whether the key was pressed after a previous call to <a href="/windows/win32/api/winuser/nf-winuser-getasynckeystate"><strong>GetAsyncKeyState</strong></a>. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-getfocus"><strong>GetFocus</strong></a></td>
<td>Retrieves the handle to the window that has the keyboard focus, if the window is attached to the calling thread's message queue. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-getkeyboardlayout"><strong>GetKeyboardLayout</strong></a></td>
<td>Retrieves the active input locale identifier (formerly called the keyboard layout) for the specified thread. If the <em>idThread</em> parameter is zero, the input locale identifier for the active thread is returned.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-getkeyboardlayoutlist"><strong>GetKeyboardLayoutList</strong></a></td>
<td>Retrieves the input locale identifiers (formerly called keyboard layout handles) corresponding to the current set of input locales in the system. The function copies the identifiers to the specified buffer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-getkeyboardlayoutnamea"><strong>GetKeyboardLayoutName</strong></a></td>
<td>Retrieves the name of the active input locale identifier (formerly called the keyboard layout). <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-getkeyboardstate"><strong>GetKeyboardState</strong></a></td>
<td>Copies the status of the 256 virtual keys to the specified buffer. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-getkeynametexta"><strong>GetKeyNameText</strong></a></td>
<td>Retrieves a string that represents the name of a key. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-getkeystate"><strong>GetKeyState</strong></a></td>
<td>Retrieves the status of the specified virtual key. The status specifies whether the key is up, down, or toggled (on, off alternating each time the key is pressed). <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-getlastinputinfo"><strong>GetLastInputInfo</strong></a></td>
<td>Retrieves the time of the last input event.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-iswindowenabled"><strong>IsWindowEnabled</strong></a></td>
<td>Determines whether the specified window is enabled for mouse and keyboard input. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-loadkeyboardlayouta"><strong>LoadKeyboardLayout</strong></a></td>
<td>Loads a new input locale identifier (formerly called the keyboard layout) into the system. Several input locale identifiers can be loaded at a time, but only one per process is active at a time. Loading multiple input locale identifiers makes it possible to rapidly switch between them.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-mapvirtualkeya"><strong>MapVirtualKey</strong></a></td>
<td>Translates (maps) a virtual-key code into a scan code or character value, or translates a scan code into a virtual-key code. <!-- raw HTML omitted --> To specify a handle to the keyboard layout to use for translating the specified code, use the <a href="/windows/win32/api/winuser/nf-winuser-mapvirtualkeyexa"><strong>MapVirtualKeyEx</strong></a> function.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-mapvirtualkeyexa"><strong>MapVirtualKeyEx</strong></a></td>
<td>Maps a virtual-key code into a scan code or character value, or translates a scan code into a virtual-key code. The function translates the codes using the input language and an input locale identifier.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-oemkeyscan"><strong>OemKeyScan</strong></a></td>
<td>Maps OEMASCII codes 0 through 0x0FF into the OEM scan codes and shift states. The function provides information that allows a program to send OEM text to another program by simulating keyboard input. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-registerhotkey"><strong>RegisterHotKey</strong></a></td>
<td>Defines a system-wide hot key.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-sendinput"><strong>SendInput</strong></a></td>
<td>Synthesizes keystrokes, mouse motions, and button clicks.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-setactivewindow"><strong>SetActiveWindow</strong></a></td>
<td>Activates a window. The window must be attached to the calling thread's message queue. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-setfocus"><strong>SetFocus</strong></a></td>
<td>Sets the keyboard focus to the specified window. The window must be attached to the calling thread's message queue. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-setkeyboardstate"><strong>SetKeyboardState</strong></a></td>
<td>Copies a 256-byte array of keyboard key states into the calling thread's keyboard input-state table. This is the same table accessed by the <a href="/windows/win32/api/winuser/nf-winuser-getkeyboardstate"><strong>GetKeyboardState</strong></a> and <a href="/windows/win32/api/winuser/nf-winuser-getkeystate"><strong>GetKeyState</strong></a> functions. Changes made to this table do not affect keyboard input to any other thread. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-toascii"><strong>ToAscii</strong></a></td>
<td>Translates the specified virtual-key code and keyboard state to the corresponding character or characters. The function translates the code using the input language and physical keyboard layout identified by the keyboard layout handle.<!-- raw HTML omitted --> To specify a handle to the keyboard layout to use to translate the specified code, use the <a href="/windows/win32/api/winuser/nf-winuser-toasciiex"><strong>ToAsciiEx</strong></a> function.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-toasciiex"><strong>ToAsciiEx</strong></a></td>
<td>Translates the specified virtual-key code and keyboard state to the corresponding character or characters. The function translates the code using the input language and physical keyboard layout identified by the input locale identifier.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-tounicode"><strong>ToUnicode</strong></a></td>
<td>Translates the specified virtual-key code and keyboard state to the corresponding Unicode character or characters. <!-- raw HTML omitted --> To specify a handle to the keyboard layout to use to translate the specified code, use the <a href="/windows/win32/api/winuser/nf-winuser-tounicodeex"><strong>ToUnicodeEx</strong></a> function.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-tounicodeex"><strong>ToUnicodeEx</strong></a></td>
<td>Translates the specified virtual-key code and keyboard state to the corresponding Unicode character or characters.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-unloadkeyboardlayout"><strong>UnloadKeyboardLayout</strong></a></td>
<td>Unloads an input locale identifier (formerly called a keyboard layout). <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-unregisterhotkey"><strong>UnregisterHotKey</strong></a></td>
<td>Frees a hot key previously registered by the calling thread. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-vkkeyscanexa"><strong>VkKeyScanEx</strong></a></td>
<td>Translates a character to the corresponding virtual-key code and shift state. The function translates the character using the input language and physical keyboard layout identified by the input locale identifier. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>The following functions are obsolete.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-getkbcodepage"><strong>GetKBCodePage</strong></a></td>
<td>Retrieves the current code page.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-keybd_event"><strong>keybd_event</strong></a></td>
<td>Synthesizes a keystroke. The system can use such a synthesized keystroke to generate a <a href="wm-keyup.html"><strong>WM_KEYUP</strong></a> or <a href="wm-keydown.html"><strong>WM_KEYDOWN</strong></a> message. The keyboard driver's interrupt handler calls the <a href="/windows/win32/api/winuser/nf-winuser-keybd_event"><strong>keybd_event</strong></a> function.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/nf-winuser-vkkeyscana"><strong>VkKeyScan</strong></a></td>
<td>Translates a character to the corresponding virtual-key code and shift state for the current keyboard.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Messages</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="wm-gethotkey.html"><strong>WM_GETHOTKEY</strong></a></td>
<td>Determines the hot key associated with a window. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-sethotkey.html"><strong>WM_SETHOTKEY</strong></a></td>
<td>Associates a hot key with the window. When the user presses the hot key, the system activates the window. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Notifications</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="wm-activate.html"><strong>WM_ACTIVATE</strong></a></td>
<td>Sent to both the window being activated and the window being deactivated. If the windows use the same input queue, the message is sent synchronously, first to the window procedure of the top-level window being deactivated, then to the window procedure of the top-level window being activated. If the windows use different input queues, the message is sent asynchronously, so the window is activated immediately. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-appcommand.html"><strong>WM_APPCOMMAND</strong></a></td>
<td>Notifies a window that the user generated an application command event, for example, by clicking an application command button using the mouse or typing an application command key on the keyboard.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-char.html"><strong>WM_CHAR</strong></a></td>
<td>Posted to the window with the keyboard focus when a <a href="wm-keydown.html"><strong>WM_KEYDOWN</strong></a> message is translated by the <a href="/windows/desktop/api/winuser/nf-winuser-translatemessage"><strong>TranslateMessage</strong></a> function. The <a href="wm-char.html"><strong>WM_CHAR</strong></a> message contains the character code of the key that was pressed. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-deadchar.html"><strong>WM_DEADCHAR</strong></a></td>
<td>Posted to the window with the keyboard focus when a <a href="wm-keyup.html"><strong>WM_KEYUP</strong></a> message is translated by the <a href="/windows/desktop/api/winuser/nf-winuser-translatemessage"><strong>TranslateMessage</strong></a> function. <a href="wm-deadchar.html"><strong>WM_DEADCHAR</strong></a> specifies a character code generated by a dead key. A dead key is a key that generates a character, such as the umlaut (double-dot), that is combined with another character to form a composite character. For example, the umlaut-O character ( ) is generated by typing the dead key for the umlaut character, and then typing the O key. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-hotkey.html"><strong>WM_HOTKEY</strong></a></td>
<td>Posted when the user presses a hot key registered by the <a href="/windows/win32/api/winuser/nf-winuser-registerhotkey"><strong>RegisterHotKey</strong></a> function. The message is placed at the top of the message queue associated with the thread that registered the hot key. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-keydown.html"><strong>WM_KEYDOWN</strong></a></td>
<td>Posted to the window with the keyboard focus when a nonsystem key is pressed. A nonsystem key is a key that is pressed when the ALT key is not pressed. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-keyup.html"><strong>WM_KEYUP</strong></a></td>
<td>Posted to the window with the keyboard focus when a nonsystem key is released. A nonsystem key is a key that is pressed when the ALT key is not pressed, or a keyboard key that is pressed when a window has the keyboard focus. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-killfocus.html"><strong>WM_KILLFOCUS</strong></a></td>
<td>Sent to a window immediately before it loses the keyboard focus. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-setfocus.html"><strong>WM_SETFOCUS</strong></a></td>
<td>Sent to a window after it has gained the keyboard focus. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-sysdeadchar.html"><strong>WM_SYSDEADCHAR</strong></a></td>
<td>Sent to the window with the keyboard focus when a <a href="wm-syskeydown.html"><strong>WM_SYSKEYDOWN</strong></a> message is translated by the <a href="/windows/desktop/api/winuser/nf-winuser-translatemessage"><strong>TranslateMessage</strong></a> function. <a href="wm-sysdeadchar.html"><strong>WM_SYSDEADCHAR</strong></a> specifies the character code of a system dead key   that is, a dead key that is pressed while holding down the ALT key. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-syskeydown.html"><strong>WM_SYSKEYDOWN</strong></a></td>
<td>Posted to the window with the keyboard focus when the user presses the F10 key (which activates the menu bar) or holds down the ALT key and then presses another key. It also occurs when no window currently has the keyboard focus; in this case, the <a href="wm-syskeydown.html"><strong>WM_SYSKEYDOWN</strong></a> message is sent to the active window. The window that receives the message can distinguish between these two contexts by checking the context code in the <em>lParam</em> parameter. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-syskeyup.html"><strong>WM_SYSKEYUP</strong></a></td>
<td>Posted to the window with the keyboard focus when the user releases a key that was pressed while the ALT key was held down. It also occurs when no window currently has the keyboard focus; in this case, the <a href="wm-syskeyup.html"><strong>WM_SYSKEYUP</strong></a> message is sent to the active window. The window that receives the message can distinguish between these two contexts by checking the context code in the <em>lParam</em> parameter. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="wm-unichar.html"><strong>WM_UNICHAR</strong></a></td>
<td>Posted to the window with the keyboard focus when a <a href="wm-keydown.html"><strong>WM_KEYDOWN</strong></a> message is translated by the <a href="/windows/desktop/api/winuser/nf-winuser-translatemessage"><strong>TranslateMessage</strong></a> function. The <a href="wm-unichar.html"><strong>WM_UNICHAR</strong></a> message contains the character code of the key that was pressed.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Structures</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/winuser/ns-winuser-hardwareinput"><strong>HARDWAREINPUT</strong></a></td>
<td>Contains information about a simulated message generated by an input device other than a keyboard or mouse. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/ns-winuser-input"><strong>INPUT</strong></a></td>
<td>Contains information used for synthesizing input events such as keystrokes, mouse movement, and mouse clicks.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/ns-winuser-keybdinput"><strong>KEYBDINPUT</strong></a></td>
<td>Contains information about a simulated keyboard event. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/ns-winuser-lastinputinfo"><strong>LASTINPUTINFO</strong></a></td>
<td>Contains the time of the last input.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/winuser/ns-winuser-mouseinput"><strong>MOUSEINPUT</strong></a></td>
<td>Contains information about a simulated mouse event.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Constants</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="virtual-key-codes.html"><strong>Virtual-Key Codes</strong></a></td>
<td>The symbolic constant names, hexadecimal values, and mouse or keyboard equivalents for the virtual-key codes used by the system. The codes are listed in numeric order. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<ul>
<li><a href="about-keyboard-input.html">About Keyboard Input</a></li>
</ul>
</body>
