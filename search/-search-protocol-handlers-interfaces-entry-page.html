<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Protocol Handlers Interfaces</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This Windows Search reference section consists of protocol handler interfaces.
ms.assetid: 7089a107-ef3c-4215-aa75-3107815807a1
title: Protocol Handlers Interfaces
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Protocol Handlers Interfaces</h1>
<p>This Windows Search reference section consists of protocol handler interfaces.</p>
<h2>In this section</h2>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="iitempropertybag.html"><strong>IItemPropertyBag</strong></a><!-- raw HTML omitted --></td>
<td>Defines methods to obtain information about the properties of a search item. This interface is supported only on WindowsÂ XP and Windows Server 2003, and should no longer be used.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Searchapi/nn-searchapi-ioplockstatus"><strong>IOpLockStatus</strong></a><!-- raw HTML omitted --></td>
<td>Provides methods to check the opportunistic lock that is used by MicrosoftÂ Windows Desktop Search (WDS) on items while indexing. If another process locks the file in an incompatible manner, WDS will lose its lock and allow the other process to have the file. This mechanism allows WDS to run in the background. Consequently, WDS needs to check its locks to ensure another process has not taken precedence while WDS indexes the item. <!-- raw HTML omitted --> A third-party <a href="/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor"><strong>IUrlAccessor</strong></a> object can implement this interface if the underlying data store provides a mechanism to track concurrent access to items. If this interface is exposed by <strong>IUrlAccessor</strong>, WDS will check the <a href="/windows/desktop/api/Searchapi/nn-searchapi-ioplockstatus"><strong>IOpLockStatus</strong></a> while indexing items from that store. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/previous-versions/windows/desktop/legacy/bb231447(v=vs.85)"><strong>IProtocolHandlerServices</strong></a><!-- raw HTML omitted --></td>
<td></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Searchapi/nn-searchapi-iprotocolhandlersite"><strong>IProtocolHandlerSite</strong></a><!-- raw HTML omitted --></td>
<td>Provides methods for a protocol handler's <a href="/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor"><strong>IUrlAccessor</strong></a> object to query the Filter Daemon for the appropriate filter for the URL item. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol"><strong>ISearchProtocol</strong></a><!-- raw HTML omitted --></td>
<td>Provides methods for invoking, initializing, and managing <a href="/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor"><strong>IUrlAccessor</strong></a> objects. Methods in this interface are called by the protocol host when processing URLs from the gatherer. <!-- raw HTML omitted --> The protocol handler implements the protocol for accessing a content source in its native format. Use this interface to implement a custom protocol handler to expand the data sources that can be indexed. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2"><strong>ISearchProtocol2</strong></a><!-- raw HTML omitted --></td>
<td>Provides methods for invoking, initializing, and managing <a href="/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor"><strong>IUrlAccessor</strong></a> objects. Methods in this interface are called by the protocol host when processing URLs from the gatherer. <!-- raw HTML omitted --> The protocol handler implements the protocol for accessing a content source in its native format. Use this interface to implement a custom protocol handler to expand the data sources that can be indexed. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocolthreadcontext"><strong>ISearchProtocolThreadContext</strong></a><!-- raw HTML omitted --></td>
<td>This optional interface enables the protocol handler to perform an action on the thread used for filtering in the protocol host. When the protocol host starts, it first initializes all the protocol handlers, and then it creates the filtering thread(s). The methods on this interface enable protocol handlers to manage their resources that are used by a filtering thread.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="-search-isearchprotocolui.html"><strong>ISearchProtocolUI</strong></a><!-- raw HTML omitted --></td>
<td>Provides a method for invoking <a href="-search-isearchitem.html"><strong>ISearchItem</strong></a> objects. Methods in this interface are called by the protocol host when processing URLs from the gatherer. The protocol handler implements the protocol for accessing a content source in its native format, and this interface implements a custom protocol handler to expand the data sources that can be indexed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor"><strong>IUrlAccessor</strong></a><!-- raw HTML omitted --></td>
<td>Provides methods for processing an individual item in a content source whose URL is provided by the gatherer to the filter host. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor2"><strong>IUrlAccessor2</strong></a><!-- raw HTML omitted --></td>
<td>Extends functionality of the <a href="/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor"><strong>IUrlAccessor</strong></a> interface.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor3"><strong>IUrlAccessor3</strong></a><!-- raw HTML omitted --></td>
<td>Extends the functionality of the <a href="/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor2"><strong>IUrlAccessor2</strong></a> interface with the <a href="/windows/desktop/api/Searchapi/nf-searchapi-iurlaccessor3-getimpersonationsidblobs"><strong>IUrlAccessor3::GetImpersonationSidBlobs</strong></a> method to identify user security identifiers (SIDs) for a specified URL.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor4"><strong>IUrlAccessor4</strong></a><!-- raw HTML omitted --></td>
<td>Extends the functionality of the <a href="/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor3"><strong>IUrlAccessor3</strong></a> interface with the <a href="/windows/desktop/api/Searchapi/nf-searchapi-iurlaccessor4-shouldindexitemcontent"><strong>IUrlAccessor4::ShouldIndexItemContent</strong></a> method that identifies whether the content of the item should be indexed. <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
