<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SCOPE and DIRECTORY Predicates</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Folder depth predicates control the scope of a search by specifying a path and whether to perform a deep or shallow traversal.
ms.assetid: 8eadbd42-3538-412e-9bf8-b2355d23437e
title: SCOPE and DIRECTORY Predicates
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>SCOPE and DIRECTORY Predicates</h1>
<p>Folder depth predicates control the scope of a search by specifying a path and whether to perform a deep or shallow traversal. The following shows the syntax of the folder depth predicates:</p>
<pre><code>... WHERE [{SCOPE | DIRECTORY}='&lt;protocol&gt;:[{SID}]&lt;path&gt;']
</code></pre>
<p>The predicate is followed by an equal sign. The path is exclosed in single quotes and must begin with a protocol and a colon (for example, <code>file:</code>, <code>mapi:</code>, or <code>csc:</code>). The SCOPE predicate performs a deep traversal of the path, including all subfolders, while the DIRECTORY predicate does a shallow traversal of only the folder specified. Like other Structured Query Language (SQL) restrictions, you can specify more than one folder depth restriction in a single query.</p>
<p>To query the local catalog of a remote computer, include the computer name before the catalog and a Universal Naming Convention (UNC) path on the remote computer in the SCOPE or DIRECTORY clause.</p>
<h2>Examples</h2>
<pre><code>SELECT System.ItemName FROM SystemIndex WHERE SCOPE='file:C:/Files/Reports'

SELECT System.ItemName FROM SystemIndex WHERE DIRECTORY='file:C:/Files/Reports' 

SELECT System.ItemName FROM SystemIndex WHERE SCOPE='file:C:/Files/Published' OR SCOPE='file:C:/Files/Reports' AND NOT SCOPE='file:C:/Files/Reports/Confidential'

SELECT System.ItemName FROM zarasmachine.SystemIndex WHERE SCOPE='file://zarasmachine/C:/Files/Reports'

SELECT System.ItemURL FROM SystemIndex WHERE SCOPE='mapi://{S-1-5-21-2117521111-1604012920-1887927527-2285604}/Mailbox user/' AND CONTAINS('Microsoft')
</code></pre>
<p>The first SCOPE example searches the C:\Files\Reports folder and all its subfolders. The DIRECTORY example searches only the root folder C:\Files\Reports.</p>
<blockquote>
<p>[!Note]<br />
The file system backslashes (\) become a URL-style slash marks (sometimes called forward slashes) (/).</p>
</blockquote>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><strong>Reference</strong></p>
<!-- raw HTML omitted -->
<p><a href="-search-sql-from.html">FROM Clause</a></p>
<!-- raw HTML omitted -->
<p><a href="-search-sql-where.html">WHERE Clause</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
