<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IItemPreviewerExt::SuggestBrowserPolicy method</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Suggests the security policy to be applied to the browser.
ms.assetid: 73541611-2024-4c33-ab03-e3204244c46c
title: IItemPreviewerExt::SuggestBrowserPolicy method
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>IItemPreviewerExt.SuggestBrowserPolicy
api_type:</li>
<li>COM
api_location:</li>
</ul>
<hr />
<h1>IItemPreviewerExt::SuggestBrowserPolicy method</h1>
<p>Suggests the security policy to be applied to the browser.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>HRESULT SuggestBrowserPolicy(
  [in]Â Â Â Â Â Â Â Â Â Â DWORD dwContext,
  [out, retval]Â DWORD *pdwFlags
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>dwContext</em> [in]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD</strong></p>
<p>The context identifier for the operation. Override the <em>dwContext</em> default to set the context identifier to a value of your choosing.</p>
<!-- raw HTML omitted -->
<p><em>pdwFlags</em> [out, retval]</p>
<!-- raw HTML omitted -->
<p>Type: <strong>DWORD*</strong></p>
<p>A pointer to a DWORD value containing verification check flags. The <strong>BROWSERPOLICY_UNTRUSTED_CONTENT</strong> flag disables any possibility of the preview being able to run script or ActiveX. The parameter <em>pdwFlags</em> must not be a <strong>NULL</strong> pointer.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>Type: <strong>HRESULT</strong></p>
<p>If this method succeeds, it returns <strong>S_OK</strong>. Otherwise, it returns an <strong>HRESULT</strong> error code.</p>
<h2>Remarks</h2>
<p>The <a href="-search-iitempreviewerext.html"><strong>IItemPreviewerExt</strong></a> interface is supported only on WindowsÂ XP and Windows Server 2003, and should no longer be used.</p>
<p>To preview attachments with a third-party protocol handler on computers running WindowsÂ XP or Windows Server 2003, it may be necessary to use the <a href="-search-iitempreviewerext.html"><strong>IItemPreviewerExt</strong></a> interface, and the following APIs: the <a href="-search-isearchprotocolui.html"><strong>ISearchProtocolUI</strong></a>, <a href="iitempropertybag.html"><strong>IItemPropertyBag</strong></a> and <a href="-search-isearchitem.html"><strong>ISearchItem</strong></a> interfaces, the <a href="-search-linkinfo.html"><strong>LINKINFO</strong></a> structure, and the <a href="-search-linktype.html"><strong>LINKTYPE</strong></a> enumeration.</p>
<p>Using the <strong>BROWSERPOLICY_UNTRUSTED_CONTENT</strong> flag is strongly recommended to disable any possibility of the preview being able to run script or ActiveX. The <strong>IItemPreviewerExt::SuggestBrowserPolicy</strong> method can return information on whether the item being previewed is trusted or not. This will allow the previewer trident control to execute script, and even ActiveX controls. Because the previewer often uses temporary files to generate the preview, doing so can result in unexpected script and code execution in the Local Computer zone.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ XP with SP2 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Redistributable<!-- raw HTML omitted --></td>
<td>Windows Desktop Search (WDS) 3.0<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="-search-iitempreviewerext.html"><strong>IItemPreviewerExt</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
