<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Parental Controls WMI Provider Schema</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The Parental Controls WMI Provider is an instance and method provider. Instantiation of new class instances, reading or modification of existing instance properties, and invocation of methods is controlled by the Wpcsprov.mof file.
ms.assetid: 28d46969-448e-4a67-bfb3-4240b5cebe57
title: Parental Controls WMI Provider Schema
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Parental Controls WMI Provider Schema</h1>
<p>The Parental Controls WMI Provider is an instance and method provider. Instantiation of new class instances, reading or modification of existing instance properties, and invocation of methods is controlled by the Wpcsprov.mof file.</p>
<p>The following syntax is from Namespace.mof</p>
<pre lang="syntax"><code>#pragma autorecover

#pragma namespace(&quot;\\\\.\\ROOT\\CIMV2&quot;)

instance of __Namespace
{
    Name = &quot;Applications&quot;;
};

#pragma namespace(&quot;\\\\.\\ROOT\\CIMV2\\Applications&quot;)

//**************************************************************************
//* Windows Parental Controls Namespace 
//**************************************************************************
instance of __NAMESPACE
{
    Name = &quot;WindowsParentalControls&quot;;
};
</code></pre>
<p>The following syntax is from Ratings.mof</p>
<pre lang="syntax"><code>//**************************************************************************
//* MOF describing Ratings Systems
//**************************************************************************
#pragma namespace(&quot;\\\\.\\ROOT\\CIMV2\\Applications\\WindowsParentalControls&quot;)

//**************************************************************************
//* Class: WpcRating
//* Derived from: 
//**************************************************************************
[Description(&quot;A rating within a ratings system&quot;): ToInstance ToSubClass, dynamic: DisableOverride ToInstance, provider(&quot;WpcSProv&quot;): ToInstance ToSubClass]
class WpcRating
{
    [read: ToInstance ToSubClass, Description(&quot;Rating ID&quot;): ToInstance ToSubClass, key, Not_null: ToInstance ToSubClass] string ID;
    [read: ToInstance ToSubClass, Description(&quot;Long Name for this Rating&quot;): ToInstance ToSubClass] string LongName;
    [Description(&quot;ID of the Ratings System this rating belongs to&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass, key, Not_null: ToInstance ToSubClass] string SystemID;
    [read: ToInstance ToSubClass, Description(&quot;Short Name for this Rating&quot;): ToInstance ToSubClass] string ShortName;
    [read: ToInstance ToSubClass, Description(&quot;Description of this rating&quot;): ToInstance ToSubClass] string Description;
    [read: ToInstance ToSubClass, Description(&quot;Has this rating been deprecated&quot;): ToInstance ToSubClass, Not_null: ToInstance ToSubClass] string IsDeprecated = &quot;false&quot;;
    [read: ToInstance ToSubClass, Description(&quot;Link to updated rating&quot;): ToInstance ToSubClass] string UpdatedRating;
    [read: ToInstance ToSubClass, Description(&quot;Relative level index of this rating&quot;): ToInstance ToSubClass, Not_null: ToInstance ToSubClass] uint32 Level;
    [read: ToInstance ToSubClass, Description(&quot;Recommended minimum age&quot;): ToInstance ToSubClass] uint32 MinAge = 0;
    [read: ToInstance ToSubClass, Description(&quot;Path to the logo for the ratings system&quot;): ToInstance ToSubClass] string IconPath;
    [read: ToInstance ToSubClass, Description(&quot;Resource ID of the logo for the ratings system&quot;): ToInstance ToSubClass] string IconResourceID;
    [read: ToInstance ToSubClass, Description(&quot;Resource Type of the logo for the ratings system&quot;): ToInstance ToSubClass] string IconType;
};

//**************************************************************************
//* Class: WpcRatingsDescriptor
//* Derived from: 
//**************************************************************************
[Description(&quot;Optional textual descriptor for a rating system&quot;): ToInstance ToSubClass, dynamic: DisableOverride ToInstance, provider(&quot;WpcSProv&quot;): ToInstance ToSubClass]
class WpcRatingsDescriptor
{
    [read: ToInstance ToSubClass, Description(&quot;ID for descriptor&quot;): ToInstance ToSubClass, key, Not_null: ToInstance ToSubClass] string ID;
    [key, Description(&quot;GUID representing the ratings system the descriptor belongs to&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass, Not_null: ToInstance ToSubClass] string SystemID;
    [read: ToInstance ToSubClass, Description(&quot;Name of the descriptor&quot;): ToInstance ToSubClass, Not_null: ToInstance ToSubClass] string Name;
    [read: ToInstance ToSubClass, Description(&quot;Description of the descriptor&quot;): ToInstance ToSubClass] string Description;
    [read: ToInstance ToSubClass, Description(&quot;Has the description been deprecated&quot;): ToInstance ToSubClass, Not_null: ToInstance ToSubClass] boolean IsDeprecated = FALSE;
    [read: ToInstance ToSubClass, Description(&quot;Link to updated descriptor&quot;): ToInstance ToSubClass] string UpdatedDescriptor;
    [read: ToInstance ToSubClass, Description(&quot;Path to the logo for the ratings system&quot;): ToInstance ToSubClass] string IconPath;
    [read: ToInstance ToSubClass, Description(&quot;Resource ID of the logo for the ratings system&quot;): ToInstance ToSubClass] string IconResourceID;
    [read: ToInstance ToSubClass, Description(&quot;Resource Type of the logo for the ratings system&quot;): ToInstance ToSubClass] string IconType;
    [read: ToInstance ToSubClass, Description(&quot;Extended properties for this descriptor&quot;): ToInstance ToSubClass] uint32 Properties;
};

//**************************************************************************
//* Class: WpcRatingsSystem
//* Derived from: 
//**************************************************************************
[Description(&quot;Third Party Ratings System&quot;): ToInstance ToSubClass, dynamic: DisableOverride ToInstance, provider(&quot;WPCSprov&quot;): ToInstance ToSubClass]
class WpcRatingsSystem
{
    [key, read: ToInstance ToSubClass, Description(&quot;GUID identifying the ratings system&quot;): ToInstance ToSubClass] string ID;
    [read: ToInstance ToSubClass, Description(&quot;Type of the ratings system&quot;): ToInstance ToSubClass] uint32 Type;
    [read: ToInstance ToSubClass, Description(&quot;Long name for the system&quot;): ToInstance ToSubClass] string LongName;
    [read: ToInstance ToSubClass, Description(&quot;Short name for the ratings system&quot;): ToInstance ToSubClass] string ShortName;
    [read: ToInstance ToSubClass, Description(&quot;Description of the ratings system&quot;): ToInstance ToSubClass, Not_null: ToInstance ToSubClass] string Description;
    [read: ToInstance ToSubClass, Description(&quot;Web address for the ratings system&quot;): ToInstance ToSubClass] string WebAddress;
    [read: ToInstance ToSubClass, Description(&quot;Path to the logo for the ratings system&quot;): ToInstance ToSubClass] string LogoPath;
    [read: ToInstance ToSubClass, Description(&quot;Resource ID of the logo for the ratings system&quot;): ToInstance ToSubClass] string LogoResourceID;
    [read: ToInstance ToSubClass, Description(&quot;Resource type of the logo for the ratings system&quot;): ToInstance ToSubClass] string LogoResourceType;
    [read: ToInstance ToSubClass, Description(&quot;Version of this data&quot;): ToInstance ToSubClass] string Version;
};

</code></pre>
<p>The following syntax is from WpcSettings.mof</p>
<pre lang="syntax"><code>// WPC Class definitions

#pragma namespace(&quot;\\\\.\\ROOT\\CIMV2\\Applications\\WindowsParentalControls&quot;)

//**************************************************************************
//* Class: WpcSystemSettings
//* Derived from: 
//**************************************************************************
[Singleton: DisableOverride ToInstance ToSubClass, Description(&quot;Stores system-wide Wpc settings&quot;): ToInstance ToSubClass, provider(&quot;WpcSProv&quot;): ToInstance, dynamic: ToInstance]
class WpcSystemSettings
{
    [read: ToInstance ToSubClass, write: ToInstance ToSubClass, Description(&quot;Link to the current games rating system in force for the computer&quot;): ToInstance ToSubClass] string CurrentGamesRatingSystem;
    [read: ToInstance ToSubClass, write: ToInstance ToSubClass, Description(&quot;HTTP app filter exemption list&quot;): ToInstance ToSubClass] string HTTPExemptionList[];
    [read: ToInstance ToSubClass, Description(&quot;Windows HTTP app filter exemption list&quot;): ToInstance ToSubClass] string WinHTTPExemptionList[];
    [read: ToInstance ToSubClass, write: ToInstance ToSubClass, Description(&quot;HTTP URL filter exemption list&quot;): ToInstance ToSubClass] string URLExemptionList[];
    [read: ToInstance ToSubClass, Description(&quot;Windows HTTP URL filter exemption list&quot;): ToInstance ToSubClass] string WinURLExemptionList[];
    [read: ToInstance ToSubClass, write: ToInstance ToSubClass, Description(&quot;Number of days until a balloon reminder for checking the logs&quot;): ToInstance ToSubClass] uint32 LogViewReminderInterval;
    [read: ToInstance ToSubClass, write: ToInstance ToSubClass, Description(&quot;Last time the admin checked the log viewer&quot;): ToInstance ToSubClass] DateTime LastLogView;
    [read: ToInstance ToSubClass, write: ToInstance ToSubClass, Description(&quot;ID of current web filter&quot;): ToInstance ToSubClass] string FilterID;
    [read: ToInstance ToSubClass, write: ToInstance ToSubClass, Description(&quot;Name of current web filter&quot;): ToInstance ToSubClass] string FilterName;
    [Description(&quot;Creates settings for a new User SID&quot;): ToInstance ToSubClass, Implemented: ToInstance ToSubClass, Static: ToInstance ToSubClass] uint32 AddUser([Description(&quot;SID to create settings for&quot;): ToInstance ToSubClass, IN] string strSID);
    [Description(&quot;Removes settings for a user account&quot;): ToInstance ToSubClass, Implemented: ToInstance ToSubClass, Static: ToInstance ToSubClass] uint32 RemoveUser([Description(&quot;SID of the account to delete settings for&quot;): ToInstance ToSubClass, IN] string strSID);
};

//**************************************************************************
//* Class: WpcUserSettings
//* Derived from: 
//**************************************************************************
[Description(&quot;Per-account Windows Parental Controls Settings&quot;): ToInstance ToSubClass, provider(&quot;WpcSprov&quot;): ToInstance, dynamic: ToInstance]
class WpcUserSettings
{
    [key, read: ToInstance ToSubClass, Description(&quot;SID of the user account owning these settings&quot;): ToInstance ToSubClass] string SID;
    [read: ToInstance ToSubClass, write: ToInstance ToSubClass, Description(&quot;Is WPC enabled for this user&quot;): ToInstance ToSubClass] boolean WpcEnabled;
    [write: ToInstance ToSubClass, Description(&quot;Is logging enabled for this user&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass] boolean LoggingRequired;
    [write: ToInstance ToSubClass, Description(&quot;Are hourly restrictions enabled for this user&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass] boolean HourlyRestrictions;
    [write: ToInstance ToSubClass, Description(&quot;Are override requests enabled for this user&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass] boolean OverrideRequests;
    [write: ToInstance ToSubClass, Description(&quot;Logon Hours mask for this user&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass] uint32 LogonHours[7];
    [write: ToInstance ToSubClass, Description(&quot;Are application restrictions enabled for this user&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass] boolean AppRestrictions;
};

//**************************************************************************
//* Class: WpcExtension
//* Derived from: 
//**************************************************************************
[Description(&quot;Windows Parental Controls Extension&quot;): ToInstance ToSubClass, provider(&quot;WpcSprov&quot;): ToInstance, dynamic: ToInstance]
class WpcExtension
{
    [key, read: ToInstance ToSubClass, Description(&quot;GUID ID for the extension&quot;): ToInstance ToSubClass] string ID;
    [key, read: ToInstance ToSubClass, Description(&quot;SiloID for the extension&quot;): ToInstance ToSubClass, MinValue(0): ToInstance ToSubClass, MaxValue(6): ToInstance ToSubClass] uint32 Subsystem;
    [read: ToInstance ToSubClass, write: ToInstance ToSubClass, Description(&quot;Image resource path for the icon for the extension&quot;): ToInstance ToSubClass] string ImagePath;
    [read: ToInstance ToSubClass, write: ToInstance ToSubClass, Description(&quot;Image resource path for the disabled icon for the extension&quot;): ToInstance ToSubClass] string DisabledImagePath;
    [write: ToInstance ToSubClass, read: ToInstance ToSubClass, Description(&quot;Path to the extension executable&quot;): ToInstance ToSubClass] string Path;
    [write: ToInstance ToSubClass, Description(&quot;Display name for the extension&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass] string Name;
    [write: ToInstance ToSubClass, Description(&quot;Subtitle for the extension&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass] string SubTitle;
};

//**************************************************************************
//* Class: WpcGameOverride
//* Derived from: 
//**************************************************************************
[Description(&quot;Entry in game silo override list for Windows Parental Controls&quot;): ToInstance ToSubClass, dynamic: DisableOverride ToInstance, provider(&quot;WpcSProv&quot;): ToInstance ToSubClass]
class WpcGameOverride
{
    [key, read: ToInstance ToSubClass, Description(&quot;Application ID identifying the game&quot;): ToInstance ToSubClass] string AppID;
    [key, read: ToInstance ToSubClass, Description(&quot;SID of the account owning this entry&quot;): ToInstance ToSubClass] string SID;
    [Description(&quot;Whether the entry is allowed or denied&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass, write: ToInstance ToSubClass, MinValue(0): ToInstance ToSubClass, MaxValue(2): ToInstance ToSubClass] uint32 Allowed;
};

//**************************************************************************
//* Class: WpcAppOverride
//* Derived from: 
//**************************************************************************
[Description(&quot;Entry in user silo application override list for Windows Parental Controls&quot;): ToInstance ToSubClass, dynamic: DisableOverride ToInstance, provider(&quot;WpcSProv&quot;): ToInstance ToSubClass]
class WpcAppOverride
{
    [key, read: ToInstance ToSubClass, Description(&quot;Rule ID for this entry&quot;): ToInstance ToSubClass] string RuleID;
    [key, read: ToInstance ToSubClass, Description(&quot;SID of the account owning this entry&quot;): ToInstance ToSubClass] string SID;
    [read: ToInstance ToSubClass, Description(&quot;Path to the overridden app&quot;): ToInstance ToSubClass] string Path;
};

//**************************************************************************
//* Class: WpcGamesSettings
//* Derived from: 
//**************************************************************************
[Description(&quot;Games silo settings for Windows Parental Controls&quot;): ToInstance ToSubClass, dynamic: DisableOverride ToInstance, provider(&quot;WpcSProv&quot;): ToInstance ToSubClass]
class WpcGamesSettings
{
    [key, read: ToInstance ToSubClass, Description(&quot;SID of the account owning these settings&quot;): ToInstance ToSubClass] string SID;
    [read: ToInstance ToSubClass, write: ToInstance ToSubClass, Description(&quot;Whether games are permitted&quot;): ToInstance ToSubClass] boolean Blocked;
    [read: ToInstance ToSubClass, Description(&quot;GUID of the rating system these settings are for&quot;): ToInstance ToSubClass] string SystemID;
    [read: ToInstance ToSubClass, Description(&quot;Whether to allow unrated games&quot;): ToInstance ToSubClass, write: ToInstance ToSubClass] boolean AllowUnrated;
    [read: ToInstance ToSubClass, Description(&quot;ID of the maximum rating allowed under the current system&quot;): ToInstance ToSubClass, write: ToInstance ToSubClass] string MaxAllowed;
    [read: ToInstance ToSubClass, Description(&quot;Collection of denied descriptors&quot;): ToInstance ToSubClass, write: ToInstance ToSubClass] string DeniedDescriptors[];
};

//**************************************************************************
//* Class: WpcURLOverride
//* Derived from: 
//**************************************************************************
[Description(&quot;Entry in web silo URL override list for Windows Parental Controls&quot;): ToInstance ToSubClass, dynamic: DisableOverride ToInstance, provider(&quot;WpcSProv&quot;): ToInstance ToSubClass]
class WpcURLOverride
{
    [key, read: ToInstance ToSubClass, Description(&quot;URL to be affected&quot;): ToInstance ToSubClass] string URL;
    [key, read: ToInstance ToSubClass, Description(&quot;SID of the account owning this entry&quot;): ToInstance ToSubClass] string SID;
    [Description(&quot;Whether the entry is allowed or denied&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass, write: ToInstance ToSubClass, MinValue(0): ToInstance ToSubClass, MaxValue(2): ToInstance ToSubClass] uint32 Allowed;
};

//**************************************************************************
//* Class: WpcCustomEvent
//* Derived from: 
//**************************************************************************
[Description(&quot;The registered custom events to be used in the log viewer&quot;): ToInstance ToSubClass, dynamic: DisableOverride ToInstance, provider(&quot;WpcSProv&quot;): ToInstance ToSubClass]
class WpcCustomEvent
{
    [key, read: ToInstance ToSubClass, Description(&quot;Publisher of the event&quot;): ToInstance ToSubClass] string Publisher;
    [key, read: ToInstance ToSubClass, Description(&quot;Application making the event&quot;): ToInstance ToSubClass] string Application;
    [key, read: ToInstance ToSubClass, Description(&quot;Event name to use&quot;): ToInstance ToSubClass] string Event;
    [read: ToInstance ToSubClass, Description(&quot;Collection of headers&quot;): ToInstance ToSubClass, write: ToInstance ToSubClass] string Headers[];
};


//**************************************************************************
//* Class: WpcWebSettings
//* Derived from: 
//**************************************************************************
[Description(&quot;Per-account Windows Parental Controls Web Settings&quot;): ToInstance ToSubClass, provider(&quot;WpcSprov&quot;): ToInstance, dynamic: ToInstance]
class WpcWebSettings
{
    [key, Description(&quot;SID of the user account owning these settings&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass] string SID;
    [Description(&quot;Is filter on for this user&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass, write: ToInstance ToSubClass] boolean FilterOn;
    [Description(&quot;Filter level for this user&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass, write: ToInstance ToSubClass, MinValue(0): ToInstance ToSubClass, MaxValue(5): ToInstance ToSubClass] Uint32 FilterLevel;
    [Description(&quot;Are file downloads blocked for this user&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass, write: ToInstance ToSubClass] boolean FileDownloadsBlocked;
    [Description(&quot;Are unrated sites blocked for this user&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass, write: ToInstance ToSubClass] boolean BlockUnrated;
    [Description(&quot;Blocked Category list&quot;): ToInstance ToSubClass, read: ToInstance ToSubClass, write: ToInstance ToSubClass] uint32 BlockedCategoryList[];
};

[Description(&quot;Games Clamper for Windows Parental Controls Media Settings&quot;): ToInstance ToSubClass, 
 provider(&quot;WpcClamperProv&quot;): ToInstance, 
 dynamic: ToInstance]
class WpcClamper      
{                                                                  
    [
    Description(&quot;Creates settings for a new User SID&quot;): ToInstance ToSubClass, 
    Implemented: ToInstance ToSubClass, 
    Static: ToInstance ToSubClass
    ] 
    uint32 LockDownGameInstance([Description(&quot;Instance ID to lock down&quot;): ToInstance ToSubClass, IN] string guidInstanceID);
    [
    Description(&quot;Removes settings for any admin users&quot;): ToInstance ToSubClass, 
    Implemented: ToInstance ToSubClass, 
    Static: ToInstance ToSubClass
    ] 
    uint32 CleanupUsers();
};                                                                 

// End of WPC Class Definitions
</code></pre>
<p>The following syntax is from WpcProvider.mof</p>
<pre lang="syntax"><code>#pragma namespace (&quot;\\\\.\\root\\CIMV2\\Applications\\WindowsParentalControls&quot;)

class Win32_ProviderEx : __Win32Provider
{
    [Description ( &quot;Hosting Model, provides compatibility with Windows XP and Windows Server 2003. Do not override.&quot; ) , Override(&quot;HostingModel&quot;)]
    string HostingModel = &quot;NetworkServiceHost&quot;;
    [Description(&quot;...&quot;),Override(&quot;SecurityDescriptor&quot;)] 
    string SecurityDescriptor; 
    UInt32 version = 1;
} ;

instance of Win32_ProviderEx as $WpcSProv
{
    Name    = &quot;WpcSProv&quot; ;  //Name is the key property for __Provider objects.
                            //vendor|provider|version is the suggested format
                            //to prevent name collisions.

    ClsId   = &quot;{355DFFAA-3B9F-435c-B428-5D44290BC5F2}&quot; ;     //provider GUID

    DefaultMachineName = NULL;       //NULL for local computer

    ClientLoadableCLSID = NULL;      //reserved

    ImpersonationLevel = 0;          //reserved

    InitializationReentrancy = 0;       //Set of flags that provide information about serialization:
                                        //0 = all initialization of this provider must be serialized
                                        //1 = all initializations of this provider in the same namespace must be serialized
                                        //2 = no initialization serialization is necessary

    InitializeAsAdminFirst = FALSE;     //Request to be fully initialized as &quot;Admin&quot; before 
                                        //initializations begin for users

    PerLocaleInitialization = FALSE;    //Indicates whether the provider is initialized for each 
                                        //locale if a user connects to the same namespace more 
                                        //than once using different locales.

    PerUserInitialization = FALSE;      //Indicates whether the provider is initialized once for each actual 
                                        //Windows 2000 NTLM user making requests of the provider. 
                                        //If set to FALSE, the provider is initialized once for all users

    Pure = TRUE;                        //A pure provider exists only to service requests from 
                                        //applications and WMI. Most providers are pure providers
                                        //Non-pure providers transition to the role of client after they have 
                                        //finished servicing requests. 


    UnloadTimeout = NULL;               //Currently ignored
                                        //Use __CacheControl class in the root namespace to control provider unloading
                                        //A string in the DMTF date/time format that specifies how long WMI 
                                        //allows the provider to remain idle before it is unloaded.
                                        

} ;    

instance of __InstanceProviderRegistration
{
    Provider = $WpcSProv;

    SupportsPut = &quot;TRUE&quot;; 
    SupportsGet = &quot;TRUE&quot;; 
    SupportsDelete = &quot;TRUE&quot;; 
    SupportsEnumeration = &quot;TRUE&quot;; 

};

instance of __MethodProviderRegistration
{
    Provider = $WpcSProv;
};

instance of __Win32Provider as $WpcClamperProv
{
    Name    = &quot;WpcClamperProv&quot; ;
    ClsId   = &quot;{355DFFAA-3B9F-435c-B428-5D44290BC5F2}&quot; ;
    HostingModel = &quot;LocalSystemHost&quot; ;
};    

instance of __MethodProviderRegistration
{
    Provider = $WpcClamperProv;
};
</code></pre>
<p>Â </p>
<p>Â </p>
</body>
