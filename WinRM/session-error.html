<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Session.Error property</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Session.Error property (WSManDisp.h)
description: Gets additional error information in an XML stream.
ms.assetid: f291c11c-012f-45eb-b851-5661d881ee79
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>Error property Windows Remote Management</li>
<li>Error property Windows Remote Management , Session object</li>
<li>Session object Windows Remote Management , Error property
topic_type:</li>
<li>apiref
api_name:</li>
<li>Session.Error
api_location:</li>
<li>WSMAuto.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Session.Error property</h1>
<p>Gets additional error information in an XML stream. Error information can also be obtained from the VBScript <a href="/previous-versions//sbf5ze0e(v=vs.85)">Err</a> object.</p>
<p>This property is read-only.</p>
<h2>Syntax</h2>
<pre lang="VB"><code>Session.Error As BSTR
</code></pre>
<h2>Property value</h2>
<p>XML representation of error information.</p>
<h2>Examples</h2>
<p>The following VBScript code example shows a script that contains an error in the <a href="windows-remote-management-glossary.html"><em>resource URI</em></a>. The correct resource URI is <code>http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/Win32\_QuotaSetting?VolumePath=c:\\</code>.</p>
<pre lang="VB"><code>'Create a WSMan object.
Set objWsman = CreateObject( &quot;WSMAN.Automation&quot; )
If objWsman is Nothing Then
    WScript.Echo &quot;Failed to create WSMAN Automation object&quot;
    WScript.Quit
End If 

'Create a Session object.
Set objSession = objWsman.CreateSession
If objSession is Nothing Then
    WScript.Echo &quot;Failed to create WSMAN Session object&quot;
    WScript.Quit
End If 

strResourceUri = &quot;http://schemas.microsoft.com/wbem/wsman/1/&quot;_
    &amp; &quot;wmi/root/cimv2/Win32_QuotaSetting&quot;

On Error Resume Next
strResponse = objSession.Get( strResourceUri )
If Err.number &lt;&gt; 0 Then
    DisplayErrorInfo()
    strErrorXML = objSession.Error
    WScript.Echo strErrorXML
Else
    Call DisplayOutput(strResponse)
End If
On Error Goto 0

'*************************************************************
' Displays Error information from Err object and Session.Error
'*************************************************************
Sub DisplayErrorInfo()

    WScript.Echo &quot;An error has occurred.&quot;     
    WScript.Echo &quot;Error Info&quot;
    WScript.Echo &quot;-----------&quot;
    WScript.Echo &quot;Number      : 0x&quot; &amp; hex(Err.number)
    WScript.Echo &quot;Description : &quot; &amp; Err.Description
    WScript.Echo &quot;Source      : &quot; &amp; Err.Source
    WScript.Echo &quot;HelpFile    : &quot; &amp; Err.helpfile
    WScript.Echo &quot;HelpContext : &quot; &amp; Err.HelpContext    
    Err.Clear
End Sub
</code></pre>
<p>The following text is the error output from the script.</p>
<pre lang="syntax"><code>Number      : 0x803380FA
Description : The WinRM client cannot process the request. 
The resource URI is not valid: it does not contain keys, but
the class selected is not a singleton. To access an instance which 
is not a singleton, keys must be provided. Use the following 
command to get more information about how to construct a 
resource URI: &quot;winrm help uris&quot;.
Source      : Session
HelpFile    :
HelpContext : 0
&lt;f:WSManFault 
xmlns:f=&quot;http://schemas.microsoft.com/wbem/wsman/1/wsmanfault&quot; 
Code=&quot;2150859002&quot; Machine=&quot;Server1&quot; xml:lang=&quot;en-US&quot;&gt;
&lt;f:Message&gt;
&lt;f:ProviderFault provider=&quot;WMIv1 plugin for Windows Remote Management &quot; 
path=&quot;%systemroot%\system32\WsmWmiPl.dll&quot;&gt;
&lt;f:WSManFault 
xmlns:f=&quot;http://schemas.microsoft.com/wbem/wsman/1/wsmanfault&quot; 
Code=&quot;2150859002&quot; Machine=&quot;&quot; xml:lang=&quot;en-US&quot;&gt;
&lt;f:Message&gt;The WinRM client cannot process the request. 
The resource URI is not valid: it does not contain keys, but the 
class selected is not a singleton. To access an instance which is 
not a singleton, keys must be provided. Use the following command 
to get more information in how to construct a resource URI: 
&amp;quot;winrm help uris&amp;quot;. 
&lt;/f:Message&gt;&lt;/f:WSManFault&gt;
&lt;/f:ProviderFault&gt;
&lt;/f:Message
&gt;&lt;/f:WSManFault&gt;
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WSManDisp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IDL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WSManDisp.idl<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WSManDisp.tlb<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WSMAuto.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="session.html"><strong>Session</strong></a></p>
<!-- raw HTML omitted -->
</body>
