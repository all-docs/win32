<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Remote Shell Infrastructure Improvements</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Remote Shell Infrastructure Improvements
description: Windows Remote Management version 2.0 (WinRM 2.0) offers many remote shell infrastructure improvements.
ms.assetid: b22693ba-fa43-44bb-9b2d-0c64fad6e3cc
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Remote Shell Infrastructure Improvements</h1>
<p>Windows Remote Management version 2.0 (WinRM 2.0) offers many remote shell infrastructure improvements. The following topics describe these improvements in detail:</p>
<ul>
<li><a href="multi-hop-support.html">Multi-Hop Support</a></li>
<li><a href="quotas.html">Quota Management for Remote Shells</a></li>
</ul>
<p>One of the improvements to the WinRM remote shell infrastructure is the addition of a more robust shell manager that maintains user-specific shell information. WinRM users can create shells on remote computers to run commands or scripts. In addition, users can create multiple shells on a computer. Users and administrators both need the ability to manage shells. Users can enumerate, get, and delete the shells that they have created. Administrators can enumerate over all active shells and retrieve details about specific shells on a local or remote host. Administrators can also delete any active shells on a local or remote host.</p>
<p>When a user or administrator enumerates the active shells, the following information can be returned by the WinRM service.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ShellId</p>
<!-- raw HTML omitted -->
<p>Specifies the unique identifier for the shell.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Environment variables</p>
<!-- raw HTML omitted -->
<p>Specifies any environment variables set by the user.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->WorkingDirectory</p>
<!-- raw HTML omitted -->
<p>Specifies the starting directory for the shell.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ResourceURI</p>
<!-- raw HTML omitted -->
<p>Specifies the resource URI for the shell operation. The resource URI can be used to retrieve plug-in configuration that is specific to the shell instance.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->IdleTimeout</p>
<!-- raw HTML omitted -->
<p>Specifies the maximum duration, in milliseconds, that the shell will stay open without any request.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->InputStreams</p>
<!-- raw HTML omitted -->
<p>Specifies the input streams for the shell.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->OutputStreams</p>
<!-- raw HTML omitted -->
<p>Specifies the output streams for the shell.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Shell creation time</p>
<!-- raw HTML omitted -->
<p>Specifies the creation timestamp for the shell.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->IdleTime</p>
<!-- raw HTML omitted -->
<p>Specifies the duration, in milliseconds, that the shell has been idle.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->UserId</p>
<!-- raw HTML omitted -->
<p>Specifies the user ID.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Hostname or IP address</p>
<!-- raw HTML omitted -->
<p>Specifies either the host name or IP address of the computer that created the shell.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Shell memory usage</p>
<!-- raw HTML omitted -->
<p>Specifies the amount of memory that has been used by the shell.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Number of processes</p>
<!-- raw HTML omitted -->
<p>Specifies the number of processes that have been created by the shell.</p>
<!-- raw HTML omitted -->
<h2>Enumerating a Shell on a Local Host</h2>
<p>The following command demonstrates how to use the winrm utility to enumerate shells on a WinRM client: <strong>winrm enumerate shell</strong>.</p>
<p>The following text-based example displays the output for shell enumeration:</p>
<pre lang="syntax"><code>Shell
    ShellId = 0A6E6A01-8AB2-4037-86CC-BFC826A1244E
    ResourceUri = http://schemas.microsoft.com/wbem/wsman/1/windows/shell/cmd
    Owner = FABRIKAM\myAccount
    ClientIP = ::1
    IdleTimeOut = PT180.000S
    InputStreams = stdin
    OutputStreams = stdout stderr
    ShellRunTime = P0DT0H0M36S
    ShellInactivity = P0DT0H0M35S

Shell
    ShellId = EE3F11CE-FB3C-4C4E-B113-6F4D643C97D8
    ResourceUri = http://schemas.microsoft.com/powershell/Microsoft.PowerShell
    Owner = FABRIKAM\myAccount
    ClientIP = ::1
    IdleTimeOut = PT180.000S
    InputStreams = stdin pr
    OutputStreams = stdout
    ShellRunTime = P0DT0H1M46S
    ShellInactivity = P0DT0H0M45S
    MemoryUsed = 48MB
    ChildProcesses = 0

Shell
    ShellId = 8FD7F2C4-A434-4D58-A7E8-46F8BF202D0B
    ResourceUri = http://schemas.microsoft.com/powershell/Microsoft.PowerShell
    Owner = FABRIKAM\myAccount
    ClientIP = ::1
    IdleTimeOut = PT180.000S
    InputStreams = stdin pr
    OutputStreams = stdout
    ShellRunTime = P0DT0H1M47S
    ShellInactivity = P0DT0H0M47S
    MemoryUsed = 48MB
    ChildProcesses = 0
</code></pre>
<p>For more information, see the online help provided by running the following command: <strong>winrm enumerate -?</strong>.</p>
<h2>Retrieving Information About a Specific Shell</h2>
<p>An administrator or user can also use the ShellId identifier to retrieve information about the shell. The following command demonstrates how to use the winrm utility to get information about a specific shell: <strong>winrm get shell?ShellId=0A6E6A01-8AB2-4037-86CC-BFC826A1244E</strong>.</p>
<p>The following text-based example displays the output for shell information:</p>
<pre lang="syntax"><code>Shell
    ShellId = 0A6E6A01-8AB2-4037-86CC-BFC826A1244E
    ResourceUri = http://schemas.microsoft.com/wbem/wsman/1/windows/shell/cmd
    Owner = FABRIKAM\myAccount
    ClientIP = ::1
    IdleTimeOut = PT180.000S
    InputStreams = stdin
    OutputStreams = stdout stderr
    ShellRunTime = P0DT0H0M36S
    ShellInactivity = P0DT0H0M35S
</code></pre>
<p>For more information, see the online help provided by the following command: <strong>winrm get -?</strong>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="multi-hop-support.html">Multi-Hop Support</a></p>
<!-- raw HTML omitted -->
<p><a href="quotas.html">Quota Management for Remote Shells</a></p>
<!-- raw HTML omitted -->
<p><a href="winrm-powershell-commandlets.html">Managed Reference for WS-Management PowerShell Commands</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
