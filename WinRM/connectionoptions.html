<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ConnectionOptions object</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: ConnectionOptions object (WSManDisp.h)
description: The ConnectionOptions object is passed to the CreateSession method to provide the user name and password associated with the local account on the remote computer.
ms.assetid: 7a87a5f7-78ed-452c-9b9f-ad48811a3339
ms.tgt_platform: multiple
keywords:</p>
<ul>
<li>ConnectionOptions object Windows Remote Management</li>
<li>ConnectionOptions object Windows Remote Management , described
topic_type:</li>
<li>apiref
api_name:</li>
<li>ConnectionOptions
api_location:</li>
<li>WSMAuto.dll
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>ConnectionOptions object</h1>
<p>The <strong>ConnectionOptions</strong> object is passed to the <a href="wsman-createsession.html"><strong>CreateSession</strong></a> method to provide the user name and password associated with the local account on the remote computer. If no parameters are supplied, then the credentials of the account running the script are set to the default values.</p>
<h2>Members</h2>
<p>The <strong>ConnectionOptions</strong> object has these types of members:</p>
<ul>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Properties</h3>
<p>The <strong>ConnectionOptions</strong> object has these properties.</p>
<table>
<thead>
<tr>
<th align="left">Property</th>
<th align="left">Access type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="connectionoptions-password.html"><strong>Password</strong></a><!-- raw HTML omitted --></td>
<td align="left">Write-only<!-- raw HTML omitted --></td>
<td align="left">Sets the password of a local or domain account on the remote computer.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><a href="connectionoptions-username.html"><strong>UserName</strong></a><!-- raw HTML omitted --></td>
<td align="left">Read/write<!-- raw HTML omitted --></td>
<td align="left">Sets and gets the user name of a local or domain account on the remote computer.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>The <strong>ConnectionOptions</strong> object corresponds to the <a href="/windows/desktop/api/WSManDisp/nn-wsmandisp-iwsmanconnectionoptions"><strong>IWSManConnectionOptions</strong></a> interface.</p>
<p>If a Windows Remote Management client application is running under impersonation, then a failure occurs if you set the <a href="connectionoptions-password.html"><strong>Password</strong></a> property. A client application is a script or other program that sends a request to WinRM on the local or a remote computer. The client application may be running under impersonation because it called a function like <a href="/previous-versions/windows/desktop/legacy/aa375494(v=vs.85)"><strong>ImpersonateClient</strong></a>. An Active Server Page (ASP) or service cannot request a user name and password if the ASP process runs under an account that impersonates a client.</p>
<p>The <strong>WSManFlagCredUserNamePassword</strong> flag should be set on the <a href="wsman-createsession.html"><strong>WSman.CreateSession</strong></a> call when using the <a href="connectionoptions-username.html"><strong>UserName</strong></a> and <a href="connectionoptions-password.html"><strong>Password</strong></a> for authentication.</p>
<h2>Examples</h2>
<p>The following VBScript code example shows how to create a <strong>ConnectionOptions</strong> object, set the properties for the account on the remote computer, and use it in creating a <a href="session.html"><strong>Session</strong></a> object.</p>
<pre lang="VB"><code>Set objWsman = CreateObject( &quot;Wsman.Automation&quot; )
'Create ConnectionOptions object.
Set objConnectionOptions = objWsman.CreateConnectionOptions
objConnectionOptions.UserName = &quot;johns &quot;
objConnectionOptions.Password = &quot;Dtf#4542?98&quot;
iFlags = objWsman.SessionFlagUseBasic Or _
  objWsman.SessionFlagCredUserNamePassword
Set objSession = objWsman.CreateSession _
  (&quot;https://172.30.168.2&quot;, iFlags, objConnectionOptions)
strResource = objSession.Get(&quot;winrm/config&quot;)
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WSManDisp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IDL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WSManDisp.idl<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WSManDisp.tlb<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->WSMAuto.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="authentication-for-remote-connections.html">Authentication for Remote Connections</a></p>
<!-- raw HTML omitted -->
<p><a href="winrm-scripting-api.html">WinRM Scripting API</a></p>
<!-- raw HTML omitted -->
<p><a href="about-windows-remote-management.html">About Windows Remote Management</a></p>
<!-- raw HTML omitted -->
<p><a href="using-windows-remote-management.html">Using Windows Remote Management</a></p>
<!-- raw HTML omitted -->
<p><a href="scripting-in-windows-remote-management.html">Scripting in Windows Remote Management</a></p>
<!-- raw HTML omitted -->
<p><a href="obtaining-data-from-the-local-computer.html">Obtaining Data from the Local Computer</a></p>
<!-- raw HTML omitted -->
<p><a href="obtaining-data-from-a-remote-computer.html">Obtaining Data from a Remote Computer</a></p>
<!-- raw HTML omitted -->
</body>
