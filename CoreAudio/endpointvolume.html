<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>EndpointVolume</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This sample application uses the Core Audio APIs to change the volume of the device, as specified by the user.
ms.assetid: 2597f3b1-5339-4fd4-9938-39ff917626b4
title: EndpointVolume
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>EndpointVolume</h1>
<p>This sample application uses the Core Audio APIs to change the volume of the device, as specified by the user.</p>
<p>This topic contains the following sections.</p>
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#downloading-the-sample">Downloading the Sample</a></li>
<li><a href="#building-the-sample">Building the Sample</a></li>
<li><a href="#running-the-sample">Running the Sample</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Description</h2>
<p>This sample demonstrates the following features.</p>
<ul>
<li><a href="mmdevice-api.html">MMDevice API</a> for multimedia device enumeration and selection.</li>
<li><a href="endpointvolume-api.html">EndpointVolume API</a> to control volume levels of the device endpoint.</li>
</ul>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Product</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://msdn.microsoft.com/windowsvista/bb980924.aspx">Windows SDK</a></td>
<td>WindowsÂ 7</td>
</tr>
<tr>
<td>Visual Studio</td>
<td>2008</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Downloading the Sample</h2>
<p>This sample is available in the following locations.</p>
<table>
<thead>
<tr>
<th>Location</th>
<th>Path/URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows SDK</td>
<td>\Program Files\Microsoft SDKs\Windows\v7.0\Samples\Multimedia\Audio\EndpointVolume\...</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Building the Sample</h2>
<p>To build the x sample, use the following steps:</p>
<p>To build the EndpointVolumeChanger sample, use the following steps:</p>
<ol>
<li>Open the CMD shell for the Windows SDK and change to the EndpointVolume sample directory.</li>
<li>Run the command <code>start EndpointVolumeChanger.sln</code> in the EndpointVolume directory to open the EndpointVolumeChanger project in the Visual Studio window.</li>
<li>From within the window, select the <strong>Debug</strong> or <strong>Release</strong> solution configuration, select the <strong>Build</strong> menu from the menu bar, and select the <strong>Build</strong> option. If you do not open Visual Studio from the CMD shell for the SDK, Visual Studio will not have access to the SDK build environment. In that case, the sample will not build unless you explicitly set environment variable MSSdk, which is used in the project file, WASAPIEndpointVolume.vcproj.</li>
</ol>
<h2>Running the Sample</h2>
<p>If you build the demo application successfully, an executable file, EndpointVolumeChanger.exe, is generated. To run it, type <code>EndpointVolumeChanger</code> in a command window followed by required or optional arguments. The following example shows how to toggle the mute setting on the default console device.</p>
<p><code>EndpointVolumeChanger.exe -console -m</code></p>
<p>The following table shows the arguments.</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-?</td>
<td>Shows help.</td>
</tr>
<tr>
<td>-h</td>
<td>Shows help.</td>
</tr>
<tr>
<td>-+</td>
<td>Increments the volume level on audio endpoint device by one step. .</td>
</tr>
<tr>
<td>-up</td>
<td>Increments the volume level on audio endpoint device by one step.</td>
</tr>
<tr>
<td>--</td>
<td>Decrements the volume level on audio endpoint device by one step.</td>
</tr>
<tr>
<td>-down</td>
<td>Decrements the volume level on audio endpoint device by one step.</td>
</tr>
<tr>
<td>-v</td>
<td>Sets the master volume level on the audio endpoint device.</td>
</tr>
<tr>
<td>-console</td>
<td>Use the default console device.</td>
</tr>
<tr>
<td>-communications</td>
<td>Use the default communication device.</td>
</tr>
<tr>
<td>-multimedia</td>
<td>Use the default multimedia device.</td>
</tr>
<tr>
<td>-endpoint</td>
<td>Use the endpoint identifier specified in the switch value.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>If the application is run without arguments, it enumerates the available devices and prompts the user to select a device. After the user specifies the device, the application displays the current volume settings for the endpoint. The volume can be controlled by using the switches described in the preceding table.</p>
<p>For more information about controlling the volume levels of audio endpoint devices, see <a href="endpointvolume-api.html">EndpointVolume API</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="sdk-samples-that-use-the-core-audio-apis.html">SDK Samples That Use the Core Audio APIs</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
