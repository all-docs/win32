<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DeviceTopology API</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: DeviceTopology API
ms.assetid: 051311ef-dd29-4014-bb9c-4cdccf7ce7de
title: DeviceTopology API
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim</h2>
<h1>DeviceTopology API</h1>
<p>See the <a href="https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/audio/aecmicarray">Microsoft high quality voice capture DMO sample</a>.</p>
<p>The DeviceTopology API provides client applications with the ability to traverse the functional hardware topologies of audio rendering and capture devices. Through the interfaces and methods in the DeviceTopology API, clients can discover the functional subunits (for example, volume control) that lie along the data paths that lead to and from <a href="audio-endpoint-devices.html">audio endpoint devices</a>. Clients can traverse the internal topologies of both audio adapter devices and audio endpoint devices and step across the connections that link one device to another. For more information, see <a href="device-topologies.html">Device Topologies</a>.</p>
<p>Header file Devicetopology.h defines the interfaces in the DeviceTopology API.</p>
<p>To access the DeviceTopology API interfaces, a client first obtains a reference to the <a href="/windows/desktop/api/Devicetopology/nn-devicetopology-idevicetopology"><strong>IDeviceTopology</strong></a> interface for an audio endpoint device by following these steps:</p>
<ol>
<li>By using one of the techniques described in <a href="/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice"><strong>IMMDevice Interface</strong></a>, obtain a reference to the <strong>IMMDevice</strong> interface for an audio endpoint device.</li>
<li>Call the <a href="/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate"><strong>IMMDevice::Activate</strong></a> method with parameter <em>iid</em> set to <strong>REFIID</strong> IID_IDeviceTopology.</li>
</ol>
<p>The client can obtain references to the other interfaces in the DeviceTopology API by calling the methods in the <a href="/windows/desktop/api/Devicetopology/nn-devicetopology-idevicetopology"><strong>IDeviceTopology</strong></a> interface.</p>
<p>The DeviceTopology API implements the following interfaces.</p>
<table>
<thead>
<tr>
<th>Interface</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iaudioautogaincontrol"><strong>IAudioAutoGainControl</strong></a></td>
<td>Provides access to a hardware automatic gain control (AGC).</td>
</tr>
<tr>
<td><a href="/windows/win32/api/devicetopology/nn-devicetopology-iaudiobass"><strong>IAudioBass</strong></a></td>
<td>Provides access to a hardware bass-level control.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iaudiochannelconfig"><strong>IAudioChannelConfig</strong></a></td>
<td>Provides access to a hardware channel-configuration control.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iaudioinputselector"><strong>IAudioInputSelector</strong></a></td>
<td>Provides access to a hardware multiplexer control (input selector).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iaudioloudness"><strong>IAudioLoudness</strong></a></td>
<td>Provides access to a &quot;loudness&quot; compensation control.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/devicetopology/nn-devicetopology-iaudiomidrange"><strong>IAudioMidrange</strong></a></td>
<td>Provides access to a hardware midrange-level control.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iaudiomute"><strong>IAudioMute</strong></a></td>
<td>Provides access to a hardware mute control.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iaudiooutputselector"><strong>IAudioOutputSelector</strong></a></td>
<td>Provides access to a hardware demultiplexer control (output selector).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iaudiopeakmeter"><strong>IAudioPeakMeter</strong></a></td>
<td>Provides access to a hardware peak-meter control.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/devicetopology/nn-devicetopology-iaudiotreble"><strong>IAudioTreble</strong></a></td>
<td>Provides access to a hardware treble-level control.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/devicetopology/nn-devicetopology-iaudiovolumelevel"><strong>IAudioVolumeLevel</strong></a></td>
<td>Provides access to a hardware volume control.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iconnector"><strong>IConnector</strong></a></td>
<td>Represents a point of connection between components.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-icontrolinterface"><strong>IControlInterface</strong></a></td>
<td>Represents a control interface on a part (subunit or connector).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-idevicespecificproperty"><strong>IDeviceSpecificProperty</strong></a></td>
<td>Represents a device-specific property of a connector or subunit.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-idevicetopology"><strong>IDeviceTopology</strong></a></td>
<td>Provides access to the topology of an audio device.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iksformatsupport"><strong>IKsFormatSupport</strong></a></td>
<td>Provides information about the audio data formats that are supported by a software-configured I/O connection (typically a DMA channel) between the audio device and system memory.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription"><strong>IKsJackDescription</strong></a></td>
<td>Provides information about the jacks or internal connectors that provide a physical connection between a device on an audio adapter and an external or internal endpoint device (for example, a microphone or CD player).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-ipart"><strong>IPart</strong></a></td>
<td>Represents a part (connector or subunit) of a device topology.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-ipartslist"><strong>IPartsList</strong></a></td>
<td>Represents a list of parts (connectors and subunits).</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iperchanneldblevel"><strong>IPerChannelDbLevel</strong></a></td>
<td>Represents a generic subunit control interface that provides per-channel control over the volume level, in decibels, of an audio stream or of a frequency band in an audio stream.</td>
</tr>
<tr>
<td><a href="/windows/win32/api/devicetopology/nn-devicetopology-isubunit"><strong>ISubunit</strong></a></td>
<td>Represents a hardware subunit (for example, a volume-level control) that lies in the data path between a client and an audio endpoint device.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>DeviceTopology API clients that require notification of control-change events in connectors and subunits should implement the following interface.</p>
<table>
<thead>
<tr>
<th>Interface</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-icontrolchangenotify"><strong>IControlChangeNotify</strong></a></td>
<td>Provides notifications when the status of a part (connector or subunit) changes.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="device-topologies.html">Device Topologies</a></p>
<!-- raw HTML omitted -->
<p><a href="programming-reference.html"><strong>Programming Reference</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
