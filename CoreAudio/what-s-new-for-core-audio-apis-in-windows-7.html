<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>What's New for Core Audio APIs in Windows 7</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The Core Audio APIs were introduced in WindowsÂ Vista, which provided a new set of user-mode audio components that a client application can use to render or capture audio streams with improved audio capabilities.
ms.assetid: eb99c266-16d2-4a14-bc1d-059a0a94db13
title: What's New for Core Audio APIs in Windows 7
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>What's New for Core Audio APIs in Windows 7</h1>
<p>The Core Audio APIs were introduced in WindowsÂ Vista, which provided a new set of user-mode audio components that a client application can use to render or capture audio streams with improved audio capabilities. For a general overview of this API set, see <a href="about-the-windows-core-audio-apis.html">About the Windows Core Audio APIs</a>.</p>
<p>The Core Audio APIs have been improved in WindowsÂ 7. The following table summarizes the new features and the improvements to the Core Audio APIs:</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Generic improvements</td>
<td>The following features have been improved in WindowsÂ 7:<!-- raw HTML omitted --><!-- raw HTML omitted -->In WindowsÂ 7 share mode streams run in <!-- raw HTML omitted -->low-latency mode<!-- raw HTML omitted -->. The audio engine runs in pull mode with a significant reduction in latency. This is very useful for communication applications that require low audio stream latency for faster streaming.<!-- raw HTML omitted --><!-- raw HTML omitted -->WindowsÂ 7 provides better device role detection when a new device is added to the system. For more information, see <!-- raw HTML omitted -->Working with Device Roles<!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted -->In WindowsÂ 7 you can listen to music from your portable media player through your computer speakers. You can use this Capture Monitor feature by plugging a portable media player into your computer with an analog audio cable. In the past some OEMs have provided this functionality in the audio driver by using a hardware loopback. In WindowsÂ 7, this functionality has been added to the operating system. Because this is in the system and not the driver, you can use this for any other device connected to the system, such as a USB headset.<!-- raw HTML omitted --><!-- raw HTML omitted -->HDMI audio has been enhanced in WindowsÂ 7, which provides support for high-bit-rate format. With this improvement, you can support multichannel audio and compressed audio formats over an HDMI connector to an audio receiver.<!-- raw HTML omitted --><!-- raw HTML omitted -->In WindowsÂ Vista, Windows Media Player plays music only through the default audio device, which cannot be changed by the user. For Windows Media Player to render audio to a particular device, the default device must be changed in the <!-- raw HTML omitted -->Sounds<!-- raw HTML omitted --> control panel. In WindowsÂ 7, Windows Media Player provides APIs that enable an application to render to any device selected by the user and not just the default device.<!-- raw HTML omitted --><!-- raw HTML omitted -->In WindowsÂ Vista, if a computer that is playing audio switches to the power-save mode, the computer is locked, and if the user wants to interrupt the playback, the user must log on and press the stop key to stop the playback. In WindowsÂ 7, if the computer is locked, you can still control the playback by using the HID control on the keyboard.<!-- raw HTML omitted --><!-- raw HTML omitted -->WindowsÂ 7 reduces power consumption for any application that uses DirectSound and DirectShow to render media. In addition, the Multimedia Class Scheduler Service enables glitch-resilient audio and uses less power while the audio samples are being generated.<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Communication device (New)</td>
<td>In this release a new device type has been added to the <!-- raw HTML omitted -->Sounds<!-- raw HTML omitted --> control panel: <!-- raw HTML omitted -->Communications<!-- raw HTML omitted --> device. This device is used primarily for communications, that is, to place or receive phone calls on the computer. A communication application can use Core Audio components to get a reference to the endpoint of the default communication device and render audio streams for communication purposes. The operating system considers the stream opened on a communication device to be a communication stream. The WASAPI operations on a communication stream are similar to any other audio stream. For more information, see <!-- raw HTML omitted -->Working with Device Roles<!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td>Stream attenuation or audio ducking (New)</td>
<td>Automatic ducking or <!-- raw HTML omitted -->Stream Attenuation<!-- raw HTML omitted --> is a new feature in WindowsÂ 7 that is intended for VoIP and Unified Communication applications. By default, the operating system reduces the intensity of an audio stream when a communication stream, such as a phone call, is received on the communication device through the computer. The volume options are set by the user in the <!-- raw HTML omitted -->Sound<!-- raw HTML omitted --> control panel. New APIs have been added in the Windows SDK that enable applications to replace the default ducking behavior. For more information about implementing a custom ducking feature, see <!-- raw HTML omitted -->Providing a Custom Ducking Behavior<!-- raw HTML omitted -->. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Stream routing (New)</td>
<td>In WindowsÂ 7, the Core Audio APIs have been improved to transfer an audio stream seamlessly from an existing device to a new default audio endpoint. High-level audio API sets that use Core Audio APIs, such as Media Foundation, DirectSound, and WAVE APIs, implement the stream routing feature. Media applications that use these API sets to play or capture a stream use the default implementation and do not have to modify the application. However, if your media application uses Core Audio APIs directly, the application needs to provide the stream routing implementation. To do so, the application must handle new events that have been added that notify a WASAPI client when the default device is connected or removed. For more information about this feature, see <!-- raw HTML omitted -->Stream Routing<!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td>Protected User Mode Audio (PUMA) (Improved)</td>
<td>PUMA has been updated for WindowsÂ 7 to provide the following features:<!-- raw HTML omitted --><!-- raw HTML omitted -->Setting Serial Copying Management System (SCMS) bits on S/PDIF endpoints and High-bandwidth Digital Content Protection (HDCP) bits on High-Definition Multimedia Interface (HDMI) endpoints.<!-- raw HTML omitted --><!-- raw HTML omitted -->Enabling SCMS and HDMI protection controls outside of a Protected Environment (PE).<!-- raw HTML omitted --><!-- raw HTML omitted -->For more information about the improvements, see <!-- raw HTML omitted -->Protected User Mode Audio (PUMA)<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>The <!-- raw HTML omitted -->WAVEFORMATEXTENSIBLE<!-- raw HTML omitted --> structure has been extended to the <!-- raw HTML omitted -->WAVEFORMATEXTENSIBLE_IEC61937<!-- raw HTML omitted --> structure (New)</td>
<td>In WindowsÂ 7, a new structure has been added to support IEC 61937 transmissions. <!-- raw HTML omitted -->WAVEFORMATEXTENSIBLE_IEC61937<!-- raw HTML omitted --> extends the <!-- raw HTML omitted -->WAVEFORMATEXTENSIBLE<!-- raw HTML omitted --> structure to store two sets of audio stream characteristics: the encoded audio format before transmission and characteristics of the audio stream after it has been decoded. The new structure explicitly specifies the effective number of channels, sample size, and data rate of a non-PCM format. With this information, an application can infer the quality level of the non-PCM stream after it is decompressed and played. For more information, see <!-- raw HTML omitted -->Representing Formats for IEC 61937 Transmissions<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->IAudioClient::Initialize<!-- raw HTML omitted --><!-- raw HTML omitted --> (Improved)</td>
<td>The <!-- raw HTML omitted --><!-- raw HTML omitted -->IAudioClient::Initialize<!-- raw HTML omitted --><!-- raw HTML omitted --> method has been improved to indicate specific errors that might occur while opening an audio stream. The new error codes are:<!-- raw HTML omitted --><!-- raw HTML omitted -->AUDCLNT_E_BUFFER_SIZE_NOT_ALIGNED<!-- raw HTML omitted --><!-- raw HTML omitted -->AUDCLNT_E_BUFFER_SIZE_ERROR<!-- raw HTML omitted --><!-- raw HTML omitted -->AUDCLNT_E_INVALID_DEVICE_PERIOD<!-- raw HTML omitted --><!-- raw HTML omitted -->For more information about these errors, see the Return Value section in <!-- raw HTML omitted --><!-- raw HTML omitted -->IAudioClient::Initialize<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->IAudioCaptureClient::GetBuffer<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IAudioRenderClient::GetBuffer<!-- raw HTML omitted --><!-- raw HTML omitted --> (Improved)</td>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->IAudioCaptureClient::GetBuffer<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IAudioRenderClient::GetBuffer<!-- raw HTML omitted --><!-- raw HTML omitted --> methods have been improved to return the AUDCLNT_E_BUFFER_ERROR error code that indicates that the endpoint buffer in the exclusive mode was not retrieved. For more information, see Remarks in <!-- raw HTML omitted --><!-- raw HTML omitted -->IAudioCaptureClient::GetBuffer<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IAudioRenderClient::GetBuffer<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td>Jack detection capability (Improved)</td>
<td>A new interface in WindowsÂ 7, <!-- raw HTML omitted --><!-- raw HTML omitted -->IKsJackDescription2<!-- raw HTML omitted --><!-- raw HTML omitted -->, extends <!-- raw HTML omitted --><!-- raw HTML omitted -->IKsJackDescription<!-- raw HTML omitted --><!-- raw HTML omitted -->. By using the new interface, the audio stack or an application can get additional jack information. This includes the jack's detection capability and whether the format of the device has changed dynamically.</td>
</tr>
<tr>
<td>Windows Samples (New)</td>
<td>New samples have been added to the Windows SDK that demonstrate the use of the Core Audio APIs. For more information, see <!-- raw HTML omitted -->SDK Samples That Use the Core Audio APIs<!-- raw HTML omitted -->.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Major New Interfaces</h2>
<p>The following interfaces are new for WindowsÂ 7:</p>
<ul>
<li><a href="/windows/desktop/api/audioclient/nn-audioclient-iaudioclock2"><strong>IAudioClock2</strong></a></li>
<li><a href="/windows/desktop/api/audioclient/nn-audioclient-iaudioclockadjustment"><strong>IAudioClockAdjustment</strong></a></li>
<li><a href="/windows/desktop/api/Endpointvolume/nn-endpointvolume-iaudioendpointvolumeex"><strong>IAudioEndpointVolumeEx</strong></a></li>
<li><a href="/windows/desktop/api/audiopolicy/nn-audiopolicy-iaudiosessionmanager2"><strong>IAudioSessionManager2</strong></a></li>
<li><a href="/windows/desktop/api/audiopolicy/nn-audiopolicy-iaudiosessioncontrol2"><strong>IAudioSessionControl2</strong></a></li>
<li><a href="/windows/desktop/api/audiopolicy/nn-audiopolicy-iaudiosessionenumerator"><strong>IAudioSessionEnumerator</strong></a></li>
<li><a href="/windows/desktop/api/audiopolicy/nn-audiopolicy-iaudiosessionnotification"><strong>IAudioSessionNotification</strong></a></li>
<li><a href="/windows/desktop/api/AudioPolicy/nn-audiopolicy-iaudiovolumeducknotification"><strong>IAudioVolumeDuckNotification</strong></a></li>
<li><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription2"><strong>IKsJackDescription2</strong></a></li>
<li><a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iksjacksinkinformation"><strong>IKsJackSinkInformation</strong></a></li>
</ul>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="about-the-windows-core-audio-apis.html">About the Windows Core Audio APIs</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
