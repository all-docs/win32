<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DuckingMediaPlayer</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This sample application demonstrates stream attenuation by implementing a media player that shows the default attenuation behavior provided by the system, opts out of ducking events, and implements custom handling when ducking events are received.
ms.assetid: 667c8751-1d17-4b59-8ced-ed5f0c333ae9
title: DuckingMediaPlayer
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>DuckingMediaPlayer</h1>
<p>This sample application demonstrates stream attenuation by implementing a media player that shows the default attenuation behavior provided by the system, opts out of ducking events, and implements custom handling when ducking events are received. This sample must be used in conjuction with <a href="duckingcapturesample.html">DuckingCaptureSample</a>. For more information about ducking or stream attenuation, see <a href="stream-attenuation.html">Default Ducking Experience</a>.</p>
<p>This topic contains the following sections.</p>
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#downloading-the-sample">Downloading the Sample</a></li>
<li><a href="#building-the-sample">Building the Sample</a></li>
<li><a href="#running-the-sample">Running the Sample</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Description</h2>
<p>This sample demonstrates the following features.</p>
<ul>
<li>DirectShow to play a media file.</li>
<li><a href="wasapi.html">WASAPI</a> for stream management and handling ducking events.</li>
</ul>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Product</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://msdn.microsoft.com/windowsvista/bb980924.aspx">Windows SDK</a></td>
<td>WindowsÂ 7</td>
</tr>
<tr>
<td>Visual Studio</td>
<td>2008</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Downloading the Sample</h2>
<p>This sample is available in the following locations.</p>
<table>
<thead>
<tr>
<th>Location</th>
<th>Path/URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows SDK</td>
<td>\Program Files\Microsoft SDKs\Windows\v7.0\Samples\Multimedia\Audio\DuckingMediaPlayer\...</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Building the Sample</h2>
<p>To build the DuckingMediaPlayer sample, use the following steps:</p>
<ol>
<li>Open the DuckingMediaPlayer.sln in Visual Studio 2008.</li>
<li>From within the window, select the <strong>Debug</strong> or <strong>Release</strong> solution configuration, select the <strong>Build</strong> menu from the menu bar, and select the <strong>Build</strong> option. If you do not open Visual Studio from the CMD shell for the SDK, Visual Studio will not have access to the SDK build environment. In that case, the sample will not build unless you explicitly set environment variable MSSdk, which is used in the project file, DuckingMediaPlayer.vcproj.</li>
</ol>
<h2>Running the Sample</h2>
<p>If you build the application successfully, an executable file, DuckingMediaPlayer.exe, is generated. To run it, select <strong>Start Debugging</strong> or <strong>Start Without Debugging</strong> from the <strong>Debug</strong> menu or type <code>DuckingMediaPlayer</code> in a command window.</p>
<p>To view a demonstration of ducking, you must execute DuckingMediaPlayer and DuckingCaptureSample simultaneously. DuckingCaptureSample opens a communication stream and signals the system to generate a ducking event. The DuckingMediaPlayer is notified by the system when a ducking event occurs, and the media player performs the action requested by the user.</p>
<p>To disable ducking behavior:</p>
<ol>
<li>On the DuckingCaptureSample window, select <strong>Use default input device</strong>, and click <strong>Start</strong> to start a capture session from the communication device.</li>
<li>On the DuckingMediaPlayer, select a media file to play, and specify the ducking option as <strong>Opt out of Ducking</strong>.</li>
</ol>
<p>Notice that the media file is played without any interruption. The events generated by the system when the communication stream opened are ignored.</p>
<p>To demonstrate the default ducking behavior provided by the system, do the following:</p>
<ol>
<li>Select the <strong>Sounds</strong> option from the control panel. On the <strong>Communications</strong> tab, select <strong>Reduce the volume of other sounds by 80%</strong>.</li>
<li>On the DuckingCaptureSample window, select <strong>Use default input device</strong>, and click <strong>Start</strong> to start a capture session from the communication device.</li>
<li>On the DuckingMediaPlayer, select a media file to play, without choosing any of the ducking options.</li>
<li>On the DuckingCaptureSample window, click <strong>Stop</strong> to stop the communication stream.</li>
</ol>
<p>Notice that when DuckingCaptureSample opens the communication stream, the media file played by DuckingMediaPlayer plays without interruption, but the volume level is lowered. When the communication session is stopped, the volume is reset to the original setting. This stream attenuation behavior is the default ducking behavior implemented by the system.</p>
<p>To view a customized ducking behavior implemented by the media player:</p>
<ol>
<li>On the DuckingCaptureSample window, select <strong>Use default input device</strong>, and click <strong>Start</strong> to start a capture session from the communication device.</li>
<li>On the DuckingMediaPlayer, select a media file to play, and specify the ducking option as <strong>Pause on Duck</strong>.</li>
<li>On the DuckingCaptureSample window, click <strong>Stop</strong> to stop the communication stream.</li>
</ol>
<p>Notice that when DuckingCaptureSample opens the communication stream, the media file played by DuckingMediaPlayer is paused. The playback resumes when the communication session is stopped. This stream attenuation behavior is the ducking behavior implemented by the media player.</p>
<p>DuckingMediaPlayer also demonstrates how to integrate volume control for each application with the volume mixer.</p>
<p>For more information about the stream attenuation feature, see <a href="stream-attenuation.html">Default Ducking Experience</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="sdk-samples-that-use-the-core-audio-apis.html">SDK Samples That Use the Core Audio APIs</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
