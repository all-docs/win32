<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PKEY_AudioEndpoint_GUID</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The PKEY_AudioEndpoint_GUID property supplies the DirectSound device identifier that corresponds to the audio endpoint device.
ms.assetid: d3119504-9b6a-47b8-b3c6-15cb329929cb
title: PKEY_AudioEndpoint_GUID (Mmdeviceapi.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>PKEY_AudioEndpoint_GUID</h1>
<p>The <strong>PKEY_AudioEndpoint_GUID</strong> property supplies the DirectSound device identifier that corresponds to the audio endpoint device. The property value is a GUID that the client can supply as the device identifier to the <strong>DirectSoundCreate</strong> or <strong>DirectSoundCaptureCreate</strong> function in the DirectSound API. This value uniquely identifies the audio endpoint device across all audio endpoint devices in the system. For more information about DirectSound, see the DirectX SDK documentation.</p>
<p>The <strong>vt</strong> member of the <strong>PROPVARIANT</strong> structure is set to VT_LPWSTR.</p>
<p>The <strong>pwszVal</strong> member of the <strong>PROPVARIANT</strong> structure points to a null-terminated, wide-character string that contains a GUID that identifies the audio endpoint device in DirectSound.</p>
<p>As explained previously, the <a href="mmdevice-api.html">MMDevice API</a> supports <a href="device-roles.html">device roles</a>. Although DirectSound does not directly support device roles, a DirectSound client can use the PKEY_AudioEndpoint_GUID property to select a DirectSound rendering or capture device based on its device role.</p>
<p>For example, a DirectSound application performs the following steps to create a DirectSound device that corresponds to the rendering endpoint device that the user has assigned the eMultimedia role to:</p>
<ol>
<li>Call the <a href="/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint"><strong>IMMDeviceEnumerator::GetDefaultAudioEndpoint</strong></a> method to get the <a href="/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice"><strong>IMMDevice</strong></a> interface of the rendering endpoint device that has the eMultimedia role.</li>
<li>Call the <a href="/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-openpropertystore"><strong>IMMDevice::OpenPropertyStore</strong></a> method to obtain the <strong>IPropertyStore</strong> interface of the eMultimedia device. For more information about <strong>IPropertyStore</strong>, see the Windows SDK documentation.</li>
<li>Call the <strong>IPropertyStore::GetValue</strong> method to obtain the PKEY_AudioEndpoint_GUID property value.</li>
<li>Convert the property value from a GUID in string format to a 16-byte GUID structure.</li>
<li>Call the <strong>DirectSoundCreate</strong> function with the GUID to create the device with the eMultimedia role.</li>
</ol>
<blockquote>
<p>[!Note]<br />
<strong>PKEY_AudioEndpoint_GUID</strong> is a read-only property regardless of the storage-access mode requested by the application in <a href="/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-openpropertystore"><strong>IMMDevice::OpenPropertyStore</strong></a>. If an application attempts to set a value by using <strong>IPropertyStore::SetValue</strong>, this call fails with the E_ACCESSDENIED error code.</p>
</blockquote>
<p>Â </p>
<p>Note that the 16-byte GUID generated in step 4 matches the device GUID that identifies the device during DirectSound device enumeration. The <strong>DirectSoundEnumerate</strong> function enumerates rendering endpoint devices, and the <strong>DirectSoundCaptureEnumerate</strong> function enumerates capture endpoint devices. In either case, the device GUID is the first parameter passed to the enumeration callback function. For more information about DirectSound enumeration, see the DirectX SDK documentation.</p>
<p>For a code example that uses the PKEY_AudioEndpoint_GUID property, see <a href="device-roles-for-directsound-applications.html">Device Roles for DirectSound Applications</a>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mmdeviceapi.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="audio-endpoint-properties.html"><strong>Audio Endpoint Properties</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="core-audio-properties.html">Core Audio Properties</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
