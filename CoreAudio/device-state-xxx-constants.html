<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DEVICE_STATE_XXX Constants</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The DEVICE_STATE_XXX constants indicate the current state of an audio endpoint device.
ms.assetid: d03f2fbc-313a-42cf-902a-fd9f6dce2a35
title: DEVICE_STATE_XXX Constants (Mmdeviceapi.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>DEVICE_STATE_XXX Constants</h1>
<p>The DEVICE_STATE_XXX constants indicate the current state of an audio endpoint device.</p>
<table>
<thead>
<tr>
<th align="left">Constant/value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DEVICE_STATE_ACTIVE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000001<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">The audio endpoint device is active. That is, the audio adapter that connects to the endpoint device is present and enabled. In addition, if the endpoint device plugs into a jack on the adapter, then the endpoint device is plugged in.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DEVICE_STATE_DISABLED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000002<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">The audio endpoint device is disabled. The user has disabled the device in the Windows multimedia control panel, Mmsys.cpl. For more information, see Remarks.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DEVICE_STATE_NOTPRESENT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000004<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">The audio endpoint device is not present because the audio adapter that connects to the endpoint device has been removed from the system, or the user has disabled the adapter device in Device Manager.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DEVICE_STATE_UNPLUGGED</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x00000008<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">The audio endpoint device is unplugged. The audio adapter that contains the jack for the endpoint device is present and enabled, but the endpoint device is not plugged into the jack. Only a device with jack-presence detection can be in this state. For more information about jack-presence detection, see <a href="audio-endpoint-devices.html">Audio Endpoint Devices</a>.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td align="left"><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DEVICE_STATEMASK_ALL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0000000F<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td align="left">Includes audio endpoint devices in all states active, disabled, not present, and unplugged.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>The <a href="/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-enumaudioendpoints"><strong>IMMDeviceEnumerator::EnumAudioEndpoints</strong></a>, <a href="/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-getstate"><strong>IMMDevice::GetState</strong></a>, and <a href="/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondevicestatechanged"><strong>IMMNotificationClient::OnDeviceStateChanged</strong></a> methods use the DEVICE_STATE_XXX constants. These methods enable clients to obtain information about endpoint devices that are in any of the states represented by the DEVICE_STATE_XXX constants.</p>
<p>However, a client can open a stream (for example, by obtaining an <a href="/windows/desktop/api/Audioclient/nn-audioclient-iaudioclient"><strong>IAudioClient</strong></a> interface for the device) only on a device that is in the DEVICE_STATE_ACTIVE state.</p>
<p>The Windows multimedia control panel, Mmsys.cpl, displays the audio endpoint devices in the system. Disabling a device in Mmsys.cpl hides the device from the device-discovery mechanisms in higher-level audio APIs, but it does not invalidate any stream objects that a client might have instantiated before the device was disabled. For example, if a stream is playing on the device when the user disables it in Mmsys.cpl, the stream continues to play uninterrupted.</p>
<p>In contrast, disabling a device in Device Manager effectively removes the device from the system.</p>
<p>To use Mmsys.cpl to view the rendering devices, open a Command Prompt window and enter the following command:</p>
<p><strong>control mmsys.cpl,,0</strong></p>
<p>To view the capture devices, enter the following command:</p>
<p><strong>control mmsys.cpl,,1</strong></p>
<p>Alternatively, you can view the rendering devices or the capture devices in Mmsys.cpl by right-clicking the speaker icon in the notification area, which is located on the right side of the taskbar, and selecting <strong>Playback Devices</strong> or <strong>Recording Devices</strong>.</p>
<p>Mmsys.cpl always displays endpoint devices that are in the DEVICE_STATE_ACTIVE state. In addition, it can be configured to display disabled and disconnected devices.</p>
<p>To view endpoint devices that are in the DEVICE_STATE_DISABLED and DEVICE_STATE_NOTPRESENT states, right-click in the Mmsys.cpl window and select the <strong>Show Disabled Devices</strong> option.</p>
<p>To view endpoint devices that are in the DEVICE_STATE_UNPLUGGED state, right-click in the Mmsys.cpl window and select the <strong>Show Disconnected Devices</strong> option.</p>
<p>To view only endpoint devices that are in the DEVICE_STATE_ACTIVE state, deselect both the <strong>Show Disabled Devices</strong> and <strong>Show Disconnected Devices</strong> options.</p>
<p>To enable or disable an endpoint device in Mmsys.cpl, click <strong>Playback</strong> or <strong>Recording</strong>, depending on whether the device is a playback or recording device. Next, select the device and click <strong>Properties</strong>. In the <strong>Properties</strong> window, next to <strong>Device usage</strong>, select either <strong>Use this device (enable)</strong> or <strong>Don't use this device (disable)</strong>.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows Server 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mmdeviceapi.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="core-audio-constants.html">Core Audio Constants</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-getstate"><strong>IMMDevice::GetState</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator"><strong>IMMDeviceEnumerator Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-enumaudioendpoints"><strong>IMMDeviceEnumerator::EnumAudioEndpoints</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondevicestatechanged"><strong>IMMNotificationClient::OnDeviceStateChanged</strong></a></p>
<!-- raw HTML omitted -->
</body>
