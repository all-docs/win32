<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>AECMicArray</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: This sample uses the Core Audio APIs to capture a high-quality voice stream. The sample supports acoustic echo cancellation (AEC) and microphone array processing by using the AEC DMO, also called the Voice capture DSP, provided by Microsoft .
ms.assetid: 932d3442-1beb-4938-9382-031c61cd9b05
title: AECMicArray
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>AECMicArray</h1>
<p>This sample uses the Core Audio APIs to capture a high-quality voice stream. The sample supports acoustic echo cancellation (AEC) and microphone array processing by using the AEC DMO, also called the Voice capture DSP, provided by Microsoft .</p>
<p>This topic containes the following sections.</p>
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#downloading-the-sample">Downloading the Sample</a></li>
<li><a href="#building-the-sample">Building the Sample</a></li>
<li><a href="#running-the-sample">Running the Sample</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Description</h2>
<p>This sample demonstrates the following features.</p>
<ul>
<li><a href="mmdevice-api.html">MMDevice</a> for multimedia device enumeration and selection.</li>
<li><a href="wasapi.html">WASAPI</a> for stream management operations such as starting and stopping the stream, stream switching.</li>
<li><a href="devicetopology-api.html">DeviceTopology</a> for enumerating audio adapters.</li>
<li><a href="endpointvolume-api.html">EndpointVolume</a> control the volume levels of <a href="audio-sessions.html">audio sessions</a>.</li>
</ul>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Product</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://msdn.microsoft.com/windowsvista/bb980924.aspx">Windows SDK</a></td>
<td>WindowsÂ Vista or later</td>
</tr>
<tr>
<td>Visual Studio</td>
<td>2005 (non-express editions)</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Downloading the Sample</h2>
<p>This sample is available in the following locations.</p>
<table>
<thead>
<tr>
<th>Location</th>
<th>Path/URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows SDK</td>
<td>\Program Files\Microsoft SDKs\Windows\v7.0\Samples\Multimedia\Audio\AECMicArray\...</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Building the Sample</h2>
<p>To build the AecSDKDemo sample, use the following steps:</p>
<ol>
<li>
<p>Open an SDK command window.</p>
</li>
<li>
<p>Type <strong>cd %MSSDK%\Setup</strong>.</p>
</li>
<li>
<p>Run VCIntegrate.exe.</p>
<p>From this point forward, command windows will have the proper environment settings to build an application that takes advantage of the SDK.</p>
</li>
<li>
<p>Build the sample.</p>
</li>
</ol>
<h2>Running the Sample</h2>
<p>If you build the demo application successfully, an executable file, AecSDKDemo.exe is generated. To run it, type <code>AecSDKDemo</code> in a command window followed by required or optional arguments as described below.</p>
<p><code>AecSDKDemo -out mic_out.pcm -mod system_mode [-option value] </code></p>
<p>The following table shows the arguments.</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-out</td>
<td>Required. Specifies output file name.</td>
</tr>
<tr>
<td>-mod</td>
<td>Required. Specifies voice capture system mode. Refer to &quot;Configuring the voice capture DMO&quot; section in the sample readme for details.</td>
</tr>
<tr>
<td>-feat</td>
<td>Optional. Turns feature mode on (1) or off (0).</td>
</tr>
<tr>
<td>-ns</td>
<td>Optional. Turns noise suppression on (1) or off (0). Feature mode must be on for specifying this.</td>
</tr>
<tr>
<td>-agc</td>
<td>Optional. Turns digital AGC on (1) or off (0). Feature mode must be on for specifying this.</td>
</tr>
<tr>
<td>-cntrclip</td>
<td>Optional. Turns center clipping on (1) or off (0). Feature mode must be on for specifying this.</td>
</tr>
<tr>
<td>-spkdev</td>
<td>Optional. Specifies speaker device index. If not specified, the user will be asked to select.</td>
</tr>
<tr>
<td>-micdev</td>
<td>Optional. Specifies microphone device index. If not specified, the user will be asked to select.</td>
</tr>
<tr>
<td>-duration</td>
<td>Optional. Specifies how long the application runs.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>This sample application does not play any signals. To run the demo properly for AEC enabled modes (mode 0 and 4), users must play some audio signals through the same speaker device specified for the DMO (that is, the device specified by the &quot;-spkdev&quot; option), which simulates the far-end voice in a two-way chatting scenario. Users can use any player to play any audio signals. If there is no active render stream on the selected speaker device, the DMO will fail to process.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="sdk-samples-that-use-the-core-audio-apis.html">SDK Samples That Use the Core Audio APIs</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
