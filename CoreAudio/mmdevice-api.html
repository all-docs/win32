<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>About MMDevice API</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: About MMDevice API
ms.assetid: 3a8fd734-0761-4b5b-ba04-677c7c040988
title: About MMDevice API
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>About MMDevice API</h1>
<p>The Windows Multimedia Device (MMDevice) API enables audio clients to discover <a href="audio-endpoint-devices.html">audio endpoint devices</a>, determine their capabilities, and create driver instances for those devices.</p>
<p>Header file Mmdeviceapi.h defines the interfaces in the MMDevice API.</p>
<p>The MMDevice API consists of several interfaces. The first of these is the <a href="/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator"><strong>IMMDeviceEnumerator</strong></a> interface. To access the interfaces in the MMDevice API, a client obtains a reference to the <strong>IMMDeviceEnumerator</strong> interface of a device-enumerator object by calling the <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> function, as shown in the following code fragment:</p>
<pre lang="C++"><code>  const CLSID CLSID_MMDeviceEnumerator = __uuidof(MMDeviceEnumerator);
  const IID IID_IMMDeviceEnumerator = __uuidof(IMMDeviceEnumerator);
  hr = CoCreateInstance(
         CLSID_MMDeviceEnumerator, NULL,
         CLSCTX_ALL, IID_IMMDeviceEnumerator,
         (void**)&amp;pEnumerator);
</code></pre>
<p>In the preceding code fragment, CLSID_MMDeviceEnumerator and IID_IMMDeviceEnumerator are the GUID values that are attached as attributes to the <strong>MMDeviceEnumerator</strong> class object and to the <a href="/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator"><strong>IMMDeviceEnumerator</strong></a> interface. The <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> call passes these values by reference. Variable <code>hr</code> is of type <strong>HRESULT</strong>, and variable <code>pEnumerator</code> is a pointer to the <strong>IMMDeviceEnumerator</strong> interface of a device-enumerator object. <strong>IMMDeviceEnumerator</strong> provides methods for enumerating audio endpoint devices. For information about the <strong>__uuidof</strong> operator, the <strong>CoCreateInstance</strong> function, and the CLSCTX_<em>Xxx</em> constants, see the Windows SDK documentation.</p>
<p>Through the <a href="/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator"><strong>IMMDeviceEnumerator</strong></a> interface, the client can obtain references to the other interfaces in the MMDevice API. The MMDevice API implements the following interfaces.</p>
<table>
<thead>
<tr>
<th>Interface</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice"><strong>IMMDevice</strong></a></td>
<td>Represents an audio device.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevicecollection"><strong>IMMDeviceCollection</strong></a></td>
<td>Represents a collection of audio devices.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator"><strong>IMMDeviceEnumerator</strong></a></td>
<td>Provides methods for enumerating audio devices.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immendpoint"><strong>IMMEndpoint</strong></a></td>
<td>Represents an audio endpoint device.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>In addition, clients of the MMDevice API that require notification of status changes in audio endpoint devices should implement the following interface.</p>
<table>
<thead>
<tr>
<th>Interface</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient"><strong>IMMNotificationClient</strong></a></td>
<td>Provides notifications when an audio endpoint device is added or removed, when the state or properties of a device change, or when there is a change in the default role assigned to a device.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="audio-endpoint-devices.html">Audio Endpoint Devices</a></p>
<!-- raw HTML omitted -->
<p><a href="programming-reference.html"><strong>Programming Reference</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
