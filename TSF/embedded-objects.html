<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Embedded Objects (Text Services Framework)</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Embedded Objects (Text Services Framework)
description: Text Services Framework enables a text service to embed objects in an application text stream.
ms.assetid: 44cb22b5-707b-4f21-b986-5258ed273543
keywords:</p>
<ul>
<li>Text Services Framework (TSF),embedded objects</li>
<li>TSF (Text Services Framework),embedded objects</li>
<li>TSF-enabled applications,embedded objects</li>
<li>embedded objects
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Embedded Objects (Text Services Framework)</h1>
<p>Text Services Framework enables a text service to embed objects in an application text stream. Embedded objects are inserted into the text stream using the value <a href="ts-char--constants.html">TS_CHAR_EMBEDDED</a>. This value resolves to the Unicode object replacement character U+fffc, using hexadecimal notation. For example, the following illustration shows the rendering of an embedded object that represents the Japanese ideograph <em>hi</em>, in combination with the sequence of Unicode characters that represent the English translation of &quot;Sun.&quot;</p>
<p><img src="images/emb-obj.gif" alt="character encoding of an embedded object" /></p>
<p>The top row of the figure contains the translated text, consisting of the word &quot;Sun&quot; followed by the Japanese character for sun, <em>hi</em>. The center row of the figure shows the Unicode character. In the case of U+fffc, this is the object replacement character. The bottom row of the figure shows the hexadecimal value of each character.</p>
<h2>Supporting Embedded Objects in an Application</h2>
<p>The TSF manager inserts an embedded object into the text stream by calling <a href="/windows/desktop/api/textstor/nf-textstor-itextstoreacp-insertembedded">ITextStoreACP::InsertEmbedded</a> for an ACP-based application, or <a href="/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-insertembedded">ITextStoreAnchor::InsertEmbedded</a> for an anchor-based application. When an embedded object is inserted, the application should place the <strong>TS_CHAR_EMBEDDED</strong> value at the character position (or anchor location) where the object is embedded and store the IDataObject associated with the embedded object. When <a href="/windows/desktop/api/textstor/nf-textstor-itextstoreacp-gettext">ITextStoreACP::GetText</a> or <a href="/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-gettext">ITextStoreAnchor::GetText</a> is called and an embedded object is contained within the text obtained, the <strong>TS_CHAR_EMBEDDED</strong> value indicates the presence and location of the embedded object. To obtain the embedded object, call <a href="/windows/desktop/api/textstor/nf-textstor-itextstoreacp-getembedded">ITextStoreACP::GetEmbedded</a> with the character position of the embedded object, or <a href="/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-getembedded">ITextStoreAnchor::GetEmbedded</a> with the anchor location of the embedded object.</p>
<p>The application does not normally recognize the embedded object contents. The application can attempt to obtain display information from the object itself. If the embedded object can supply data in a format that the application recognizes, such as CF_UNICODETEXT or CF_BITMAP, the application can display graphic information supplied by the object.</p>
<h2>Inserting Embedded Objects</h2>
<p>A text service inserts an embedded object into a context by calling <a href="/windows/desktop/api/msctf/nf-msctf-itfrange-insertembedded">ITfRange::InsertEmbedded</a> or <a href="/windows/desktop/api/msctf/nf-msctf-itfinsertatselection-insertembeddedatselection">ITfInsertAtSelection::InsertEmbeddedAtSelection</a>. The text service must supply the embedded IDataObject.</p>
<p>Â </p>
<p>Â </p>
</body>
