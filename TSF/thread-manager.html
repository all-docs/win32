<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Thread Manager</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Thread Manager
description: The thread manager is the base component of the TSF manager.
ms.assetid: fd43b4c3-80bb-4118-a880-bdea07022c95
keywords:</p>
<ul>
<li>Text Services Framework (TSF),thread manager</li>
<li>TSF (Text Services Framework),thread manager</li>
<li>text services,thread manager</li>
<li>TSF-enabled applications,thread manager</li>
<li>thread manager</li>
<li>TSF manager</li>
<li>event notifications
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Thread Manager</h1>
<p>The thread manager is the base component of the TSF manager. The thread manager performs common tasks related to both applications and text services (clients). These tasks include, but are not limited to, the activation and deactivation of TSF text services, the creation of document managers, and maintenance of the proper relationship between documents and the input focus. The thread manager is defined by the <a href="/windows/desktop/api/Msctf/nn-msctf-itfthreadmgr">ITfThreadMgr</a> interface.</p>
<p>The majority of the interfaces and objects provided by the TSF manager can be obtained using the methods that the thread manager interface provides.</p>
<h2>Applications</h2>
<p>An application creates a thread manager object by calling <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance">CoCreateInstance</a> with CLSID_TFThreadMgr.</p>
<h2>Text Services</h2>
<p>A text service obtains a thread manager object in the text service <a href="/windows/desktop/api/Msctf/nf-msctf-itftextinputprocessor-activate">ITfTextInputProcessor::Activate</a> method.</p>
<h2>Event Notifications</h2>
<p>The thread manager also provides event notification to clients. In TSF, event notifications are provided by means of an event sink, which is a COM object. To receive notifications from the thread manager, a client implements an <a href="/windows/desktop/api/Msctf/nn-msctf-itfthreadmgreventsink">ITfThreadMgrEventSink</a> object and installs the event sink. The event sink is installed by querying the thread manager for IID_ITfSource and calling <a href="/windows/desktop/api/Msctf/nf-msctf-itfsource-advisesink">ITfSource::AdviseSink</a> with IID_ITfThreadMgrEventSink.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Msctf/nn-msctf-itfthreadmgr">ITfThreadMgr</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance">CoCreateInstance</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Msctf/nf-msctf-itftextinputprocessor-activate">ITfTextInputProcessor::Activate</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Msctf/nn-msctf-itfthreadmgreventsink">ITfThreadMgrEventSink</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Msctf/nf-msctf-itfsource-advisesink">ITfSource::AdviseSink</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
