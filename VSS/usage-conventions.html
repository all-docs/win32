<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>VSS Application Compatibility</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: When developing your own VSS application, you should observe the following guidelines and restrictions.
ms.assetid: d4edc16c-f768-4095-9b2a-b706f19f9e61
title: VSS Application Compatibility
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>VSS Application Compatibility</h1>
<p>When developing your own VSS application, you should observe the following guidelines and restrictions. You may find it helpful to refer to the sample code for VSS requesters, providers, and writers that is provided in the Microsoft Windows Software Development Kit (SDK).</p>
<blockquote>
<p>[!Note]<br />
The Windows SDK can be used to develop VSS applications only for WindowsÂ Vista and later Windows operating system versions. It cannot be used to develop VSS requesters, providers, or writers for Windows ServerÂ 2003Â R2, Windows ServerÂ 2003, or WindowsÂ XP.</p>
</blockquote>
<p><strong>Windows ServerÂ 2003Â R2, Windows ServerÂ 2003 and WindowsÂ XP:</strong> VSS is available in the Volume Shadow Copy Service 7.2 SDK, which you can download from <a href="https://www.microsoft.com/download/details.aspx?id=23490">https://www.microsoft.com/download/details.aspx?id=23490</a>. Note that the 64-bit vssapi.lib files in the directories under the Win2003\Obj directory can be used for the 64-bit versions of Windows ServerÂ 2003Â R2, Windows ServerÂ 2003, and WindowsÂ XP. This SDK also provides sample code for VSS requesters, providers, and writers.</p>
<h2>Compiling VSS Applications</h2>
<p>When developing a requester, such as a backup application:</p>
<ul>
<li>Include the following headers: <!-- raw HTML omitted --> Vss.h<br />
VsWriter.h<br />
VsBackup.h
<!-- raw HTML omitted -->
</li>
<li>Link the following library: <!-- raw HTML omitted --> VssApi.Lib
<!-- raw HTML omitted -->
</li>
</ul>
<p>When developing a writer:</p>
<ul>
<li>Include the following headers: <!-- raw HTML omitted --> Vss.h<br />
VsWriter.h
<!-- raw HTML omitted -->
</li>
<li>Link the following library: <!-- raw HTML omitted --> VssApi.lib
<!-- raw HTML omitted -->
</li>
</ul>
<h2>Supported Configurations and Restrictions</h2>
<p>The following list describes supported configurations and restrictions:</p>
<ul>
<li>
<p>VSS is provided and supported on versions of the Windows operating system beginning with WindowsÂ XP.</p>
</li>
<li>
<p>The following table summarizes compatibility information across Windows versions. Note that if a VSS application is &quot;compiled for&quot; a specified Windows version, this means that the application was compiled using the header files and libraries that are specific to that version.</p>
<blockquote>
<p>[!Note]<br />
Hardware providers will run only on Windows server operating system versions. They will not run on Windows client operating system versions.</p>
</blockquote>
<blockquote>
<p>[!Note]<br />
In the following tables, Windows ServerÂ 2008 with Service PackÂ 2 (SP2) should be considered the same as Windows ServerÂ 2008. For more information about Windows ServerÂ 2008 with SP2, see <a href="https://go.microsoft.com/fwlink/p/?linkid=178730">https://go.microsoft.com/fwlink/p/?linkid=178730</a>. Windows ServerÂ 2003Â R2 should be considered the same as Windows ServerÂ 2003.</p>
</blockquote>
<blockquote>
<p>[!Note]<br />
If a VSS application is compiled for Windows ServerÂ 2003 or later, it will also run on later versions of Windows.</p>
</blockquote>
</li>
</ul>
<table>
<thead>
<tr>
<th>VSS requesters, writers, and providers compiled for</th>
<th>Will run on</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows ServerÂ 2008Â R2 (64-bit), WindowsÂ 7 (64-bit), Windows ServerÂ 2008 (64-bit) and WindowsÂ Vista (64-bit)</td>
<td>Windows ServerÂ 2008Â R2 (64-bit), WindowsÂ 7 (64-bit), Windows ServerÂ 2008 (64-bit) and WindowsÂ Vista (64-bit)</td>
</tr>
<tr>
<td>Windows ServerÂ 2008Â R2 (32-bit), WindowsÂ 7 (32-bit), Windows ServerÂ 2008 (32-bit) and WindowsÂ Vista (32-bit)</td>
<td>Windows ServerÂ 2008Â R2 (32-bit), WindowsÂ 7 (32-bit), Windows ServerÂ 2008 (32-bit) and WindowsÂ Vista (32-bit)</td>
</tr>
<tr>
<td>Windows ServerÂ 2003 (64-bit)</td>
<td>Windows ServerÂ 2008Â R2 (64-bit), WindowsÂ 7 (64-bit), Windows ServerÂ 2008 (64-bit), WindowsÂ Vista (64-bit), and Windows ServerÂ 2003 (64-bit)</td>
</tr>
<tr>
<td>Windows ServerÂ 2003 (32-bit)</td>
<td>Windows ServerÂ 2008Â R2 (32-bit), WindowsÂ 7 (32-bit), Windows ServerÂ 2008 (32-bit), WindowsÂ Vista (32-bit), and Windows ServerÂ 2003 (32-bit)         <strong>Note:</strong>     Requesters will also run on Windows ServerÂ 2003 (64-bit).    <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>WindowsÂ XP 64-Bit Edition</td>
<td>Windows ServerÂ 2003 (64-bit) and WindowsÂ XP 64-Bit Edition</td>
</tr>
<tr>
<td>WindowsÂ XP (32-bit)</td>
<td>WindowsÂ XP (32-bit)</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>To compile a VSS requester, writer, or provider for</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows ServerÂ 2008Â R2 or WindowsÂ 7</td>
<td>Windows SDK for WindowsÂ 7 (Available from the <a href="https://www.microsoft.com/download/details.aspx?id=8279">Windows Download Center</a>.)</td>
</tr>
<tr>
<td>Windows ServerÂ 2008 or WindowsÂ Vista</td>
<td>Windows SDK for Windows ServerÂ 2008 (Available from the <a href="https://msdn.microsoft.com/windows/bb980924.aspx">Windows SDK Developer Center</a>.)</td>
</tr>
<tr>
<td>Windows ServerÂ 2003Â R2, Windows ServerÂ 2003, or WindowsÂ XP</td>
<td><a href="https://www.microsoft.com/download/details.aspx?id=23490">Volume Shadow Copy Service 7.2 SDK</a></td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>All 32-bit VSS applications (requesters, providers, and writers) must run as native 32-bit or 64-bit applications. Running them under WOW64 is not supported.</p>
<p><strong>Windows ServerÂ 2003 and WindowsÂ XP:</strong> Running 32-bit VSS requesters under WOW64 is supported, but not for system-state backups. Running 32-bit VSS providers and writers under WOW64 is not supported. Support for running 32- bit requesters under WOW64 was removed in WindowsÂ Vista and subsequent versions.</p>
</li>
<li>
<p>A shadow copy that was created on Windows ServerÂ 2003Â R2 or Windows ServerÂ 2003 cannot be used on a computer that is running Windows ServerÂ 2008Â R2 or Windows ServerÂ 2008. A shadow copy that was created on Windows ServerÂ 2008Â R2 or Windows ServerÂ 2008 cannot be used on a computer that is running Windows ServerÂ 2003. However, a shadow copy that was created on Windows ServerÂ 2008 can be used on a computer that is running Windows ServerÂ 2008Â R2, and vice versa.</p>
</li>
<li>
<p>To support shadow copies, a system running VSS must have at least one NTFS file system. This file system will host the shadow copy's &quot;diff area.&quot; For more information, see <a href="providers.html">System Provider</a>.</p>
</li>
<li>
<p>Given the presence of one NTFS file system, and given the appropriate choice of context (see <a href="shadow-copy-context-configurations.html">Shadow Copy Context Configurations</a>), any supported local file system can be shadow copied.</p>
</li>
<li>
<p>You can make shadow copies only for locally mounted file systems. Remote shares and other cross-mounted file systems cannot be shadow copied by the system that mounts them. These file systems can be shadow copied only by the systems that serve out the file systems.</p>
</li>
<li>
<p>Writers and requesters should specify only local resources. Local resources are sets of files whose absolute path starts with a drive letter, and the drive letter cannot be associated with a mounted folder on a remote share.</p>
</li>
<li>
<p>The maximum number is of software shadow copies for each volume is 512. However, by default you can only maintain 64 shadow copies that are used by the Shadow Copies of Shared Folders feature. To change the limit for the Shadow Copies of Shared Folders feature, use the <a href="../backup/registry-keys-for-backup-and-restore.html">MaxShadowCopies</a> registry key.</p>
</li>
<li>
<p>The Backup Components infrastructure does not support backing up cluster resources as writer components. To back up cluster resources, applications should assume that the path is local to a specified particular cluster node.</p>
</li>
<li>
<p>[!Note]</p>
<blockquote>
<p>Microsoft does not provide developer or IT professional technical support for implementing online system state restores on Windows (all releases).</p>
</blockquote>
<p>When backing up and recovering system state, the recommended strategy is to back up and recover the system and boot volumes in addition to the files enumerated by the system state writers.</p>
<blockquote>
<p>[!Note]<br />
System state writers are writers that have the <a href="/windows/win32/api/VsWriter/ne-vswriter-vss_usage_type"><strong>VSS_USAGE_TYPE</strong></a> attribute set to either VSS_UT_BOOTABLESYSTEMSTATE or VSS_UT_SYSTEMSERVICE.</p>
</blockquote>
</li>
</ul>
</body>
