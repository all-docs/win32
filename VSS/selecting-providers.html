<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Selecting Providers</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: A requester should select a specific provider only if it has some information about the providers available.
ms.assetid: 1a3bc938-2754-4fa2-bd7f-e9b3e876bf6c
title: Selecting Providers
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Selecting Providers</h1>
<p>A requester should select a specific provider only if it has some information about the providers available.</p>
<p>Because this will not generally be the case, it is recommended that a requester supply GUID_NULL as a provider ID to <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addtosnapshotset"><strong>IVssBackupComponents::AddToSnapshotSet</strong></a>, which allows the system to choose a provider according to the following algorithm:</p>
<ol>
<li>If a hardware provider that supports the given volume is available, it is selected.</li>
<li>If no hardware provider is available, then if any software provider specific to the given volume is available, it is selected.</li>
<li>If no hardware provider and no software provider specific to the volumes is available, the system provider is selected.</li>
</ol>
<p>However, a requester can obtain information about available providers by using <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-query"><strong>IVssBackupComponents::Query</strong></a>. With this information, and only if the backup application has a good understanding of the various providers, a requester can supply a valid provider ID to <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addtosnapshotset"><strong>IVssBackupComponents::AddToSnapshotSet</strong></a>.</p>
<p>Note that all volumes do not need to have the same provider.</p>
<p>Â </p>
<p>Â </p>
</body>
