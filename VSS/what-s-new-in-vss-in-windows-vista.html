<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>What's New in VSS in Windows Vista</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: WindowsÂ Vista.
ms.assetid: 3b16744d-b9c2-4462-a409-de94d9103c39
title: What's New in VSS in Windows Vista
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>What's New in VSS in Windows Vista</h1>
<p>WindowsÂ Vista introduces the following changes to the Volume Shadow Copy Service.</p>
<p>Note that all changes for WindowsÂ Vista also apply to Windows ServerÂ 2008 and WindowsÂ Vista with Service PackÂ 1 (SP1).</p>
<h2>New VSS Interfaces</h2>
<p><a href="/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponentsex2"><strong>IVssBackupComponentsEx2</strong></a></p>
<p><a href="/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponentex"><strong>IVssComponentEx</strong></a></p>
<p><a href="/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadataex"><strong>IVssCreateWriterMetadataEx</strong></a></p>
<p><a href="/windows/desktop/api/VsMgmt/nn-vsmgmt-ivssdifferentialsoftwaresnapshotmgmt2"><strong>IVssDifferentialSoftwareSnapshotMgmt2</strong></a></p>
<p><a href="/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadataex2"><strong>IVssExamineWriterMetadataEx2</strong></a></p>
<h2>New VSS Classes</h2>
<p><a href="/windows/desktop/api/VsWriter/nl-vswriter-cvsswriterex"><strong>CVssWriterEx</strong></a></p>
<h2>New VSS Enumerations</h2>
<p><a href="/windows/desktop/api/Vss/ne-vss-vss_rollforward_type"><strong>VSS_ROLLFORWARD_TYPE</strong></a></p>
<h2>Existing VSS Enumeration Modifications</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Vss/ne-vss-vss_backup_schema"><strong>VSS_BACKUP_SCHEMA</strong></a> enumeration</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Added values:</p>
<!-- raw HTML omitted -->
<p>VSS_BS_AUTHORITATIVE_RESTORE</p>
<p>VSS_BS_INDEPENDENT_SYSTEM_STATE</p>
<p>VSS_BS_RESTORE_RENAME</p>
<p>VSS_BS_ROLLFORWARD_RESTORE</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/VsWriter/ne-vswriter-vss_component_flags"><strong>VSS_COMPONENT_FLAGS</strong></a> enumeration</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Added values:</p>
<!-- raw HTML omitted -->
<p>VSS_CF_NOT_SYSTEM_STATE</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Vss/ne-vss-vss_volume_snapshot_attributes"><strong>_VSS_VOLUME_SNAPSHOT_ATTRIBUTES</strong></a> enumeration</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Added values:</p>
<!-- raw HTML omitted -->
<p>VSS_VOLSNAP_ATTR_NO_AUTORECOVERY</p>
<p>VSS_VOLSNAP_ATTR_NOT_TRANSACTED</p>
<!-- raw HTML omitted -->
<h2>VSS Event Tracing and Logging</h2>
<ul>
<li>The VSS trace file can now be located on any local volume. On versions of Windows prior to WindowsÂ Vista, the VSS trace file could not be located on a volume that was in the shadow copy set.</li>
<li>Many event log entries have been reworded to make them clearer.</li>
<li>All VSS event log entries now contain context information.</li>
</ul>
<h2>VSS Error Reporting</h2>
<ul>
<li>Descriptions of all VSS error codes can now be retrieved by calling the <a href="/windows/win32/api/winbase/nf-winbase-formatmessage"><strong>FormatMessage</strong></a> function with the FORMAT_MESSAGE_FROM_HMODULE flag specified in the <em>dwFlags</em> parameter.</li>
<li>The VSS error code messages are contained in vsstrace.dll. A handle to this module must be specified in the <em>lpSource</em> parameter.</li>
</ul>
<h2>Excluding Files from Shadow Copies</h2>
<p>Applications or services can use the FilesNotToSnapshot registry key to specify files to be deleted from newly created shadow copies. For more information, see <a href="excluding-files-from-shadow-copies.html">Excluding Files from Shadow Copies</a>.</p>
<h2>Backup and Restore Application Compatibility</h2>
<p>Developers of backup and restore applications need to be aware of certain new features in WindowsÂ Vista and Windows ServerÂ 2008. For an application compatibility checklist, see <a href="application-compatibility-for-backup-and-restore.html">Application Compatibility for Backup and Restore</a>.</p>
<p>Â </p>
<p>Â </p>
</body>
