<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Summary of VSS API Changes in Windows Server 2003</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Summary of VSS API Changes in Windows Server 2003
ms.assetid: 35572fc6-9147-4726-ae7a-d78292683ba0
title: Summary of VSS API Changes in Windows Server 2003
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Summary of VSS API Changes in Windows Server 2003</h1>
<h2>Changes in the VSS Service</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Events added:</p>
<!-- raw HTML omitted -->
<p><a href="vssgloss-b.html"><em>BackupShutdown</em></a></p>
<!-- raw HTML omitted -->
<h2>Changes in VSS Functionality</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Additional functionality:</p>
<!-- raw HTML omitted -->
<p><a href="vssgloss-p.html"><em>partial file support</em></a></p>
<p><a href="vssgloss-d.html"><em>directed targeting</em></a></p>
<!-- raw HTML omitted -->
<h2>New VSS Interfaces</h2>
<p><a href="/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency"><strong>IVssWMDependency</strong></a></p>
<h2>Existing VSS Interface Modifications</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Vss/nn-vss-ivssasync"><strong>IVssAsync</strong></a> interface</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Methods modified:</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/Vss/nf-vss-ivssasync-wait"><strong>IVssAsync::Wait</strong></a></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents"><strong>IVssBackupComponents</strong></a> interface</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Methods added:</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget"><strong>IVssBackupComponents::AddNewTarget</strong></a></p>
<p><a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-queryrevertstatus"><strong>IVssBackupComponents::QueryRevertStatus</strong></a></p>
<p><a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-reverttosnapshot"><strong>IVssBackupComponents::RevertToSnapshot</strong></a></p>
<p><a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath"><strong>IVssBackupComponents::SetRangesFilePath</strong></a></p>
<p><a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestorestate"><strong>IVssBackupComponents::SetRestoreState</strong></a></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata"><strong>IVssCreateWriterMetadata</strong></a> interface</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Methods added:</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency"><strong>IVssCreateWriterMetadata::AddComponentDependency</strong></a></p>
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema"><strong>IVssCreateWriterMetadata::SetBackupSchema</strong></a></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Methods modified:</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent"><strong>IVssCreateWriterMetadata::AddComponent</strong></a></p>
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles"><strong>IVssCreateWriterMetadata::AddDatabaseFiles</strong></a></p>
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles"><strong>IVssCreateWriterMetadata::AddDatabaseLogFiles</strong></a></p>
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup"><strong>IVssCreateWriterMetadata::AddFilesToFileGroup</strong></a></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata"><strong>IVssExamineWriterMetadata</strong></a> interface</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Methods added:</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema"><strong>IVssExamineWriterMetadata::GetBackupSchema</strong></a></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent"><strong>IVssComponent</strong></a> interface</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Methods removed:</p>
<!-- raw HTML omitted -->
<p><strong>IVssComponent::AddNewTarget</strong></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Methods added:</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime"><strong>IVssComponent::AddDifferencedFilesByLastModifyTime</strong></a></p>
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile"><strong>IVssComponent::GetDifferencedFile</strong></a></p>
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfilescount"><strong>IVssComponent::GetDifferencedFilesCount</strong></a></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Methods no longer reserved:</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget"><strong>IVssComponent::AddDirectedTarget</strong></a></p>
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget"><strong>IVssComponent::GetDirectedTarget</strong></a></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent"><strong>IVssWMComponent</strong></a> interface</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Methods added:</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency"><strong>IVssWMComponent::GetDependency</strong></a></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc"><strong>IVssWMFiledesc</strong></a> interface</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Methods added:</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask"><strong>IVssWMFiledesc::GetBackupTypeMask</strong></a></p>
<!-- raw HTML omitted -->
<h2>Existing VSS Class Modifications</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/VsWriter/nl-vswriter-cvsswriter"><strong>CVssWriter</strong></a> class</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Methods modified:</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize"><strong>CVssWriter::Initialize</strong></a></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Methods added:</p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getcontext"><strong>CVssWriter::GetContext</strong></a></p>
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getrestoretype"><strong>CVssWriter::GetRestoreType</strong></a></p>
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getsnapshotdevicename"><strong>CVssWriter::GetSnapshotDeviceName</strong></a></p>
<p><a href="/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupshutdown"><strong>CVssWriter::OnBackupShutdown</strong></a></p>
<!-- raw HTML omitted -->
<h2>New VSS Enumerations</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Vss/ne-vss-vss_backup_schema"><strong>VSS_BACKUP_SCHEMA</strong></a></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/VsWriter/ne-vswriter-vss_component_flags"><strong>VSS_COMPONENT_FLAGS</strong></a></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type"><strong>VSS_FILE_SPEC_BACKUP_TYPE</strong></a></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Vss/ne-vss-vss_restore_type"><strong>VSS_RESTORE_TYPE</strong></a></p>
<!-- raw HTML omitted -->
<h2>Existing VSS Enumeration Modifications</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Vss/ne-vss-vss_backup_type"><strong>VSS_BACKUP_TYPE</strong></a> enumeration</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Added values:</p>
<!-- raw HTML omitted -->
<p>VSS_BT_COPY</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/VsWriter/ne-vswriter-vss_restore_target"><strong>VSS_RESTORE_TARGET</strong></a> enumeration</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Removed values:</p>
<!-- raw HTML omitted -->
<p>VSS_RT_NEW</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/VsWriter/ne-vswriter-vss_restoremethod_enum"><strong>VSS_RESTOREMETHOD_ENUM</strong></a> enumeration</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Added values:</p>
<!-- raw HTML omitted -->
<p>VSS_RME_RESTORE_AT_REBOOT_IF_CANNOT_REPLACE</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Vss/ne-vss-vss_snapshot_state"><strong>VSS_SNAPSHOT_STATE</strong></a> enumeration</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Added values:</p>
<!-- raw HTML omitted -->
<p>VSS_SS_PROCESSING_POSTCOMMIT</p>
<p>VSS_SS_PROCESSING_PREFINALCOMMIT</p>
<p>VSS_SS_PREFINALCOMMITTED</p>
<p>VSS_SS_PROCESSING_POSTFINALCOMMIT</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Vss/ne-vss-vss_volume_snapshot_attributes"><strong>_VSS_VOLUME_SNAPSHOT_ATTRIBUTES</strong></a> enumeration</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Added values:</p>
<!-- raw HTML omitted -->
<p>VSS_VOLSNAP_ATTR_AUTORECOVER</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Reserved values now support:</p>
<!-- raw HTML omitted -->
<p>VSS_VOLSNAP_ATTR_HARDWARE_ASSISTED</p>
<p>VSS_VOLSNAP_ATTR_IMPORTED</p>
<p>VSS_VOLSNAP_ATTR_EXPOSED_LOCALLY</p>
<p>VSS_VOLSNAP_ATTR_EXPOSED_REMOTELY</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/Vss/ne-vss-vss_writer_state"><strong>VSS_WRITER_STATE</strong></a> enumeration</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Added values:</p>
<!-- raw HTML omitted -->
<p>VSS_WS_FAILED_AT_BACKUPSHUTDOWN</p>
<!-- raw HTML omitted -->
<h2>Changes to VSS Structures</h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="/windows/desktop/api/VsBackup/ns-vsbackup-vss_componentinfo"><strong>VSS_COMPONENTINFO</strong></a> structure</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Added members:</p>
<!-- raw HTML omitted -->
<p><strong>bSelectableForRestore</strong></p>
<p><strong>dwComponentFlags</strong></p>
<p><strong>cDependencies</strong></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
