<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>NDdeGetTrustedShare function</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>description: Retrieves the options associated with a DDE share that is in the server users list of trusted shares.
ms.assetid: e5f2b4f8-f922-4734-9fe3-8a74a7f5f619
title: NDdeGetTrustedShare function (Nddeapi.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:</p>
<ul>
<li>APIRef</li>
<li>kbSyntax
api_name:</li>
<li>NDdeGetTrustedShare</li>
<li>NDdeGetTrustedShareA</li>
<li>NDdeGetTrustedShareW
api_type:</li>
<li>DllExport
api_location:</li>
<li>Nddeapi.dll</li>
</ul>
<hr />
<h1>NDdeGetTrustedShare function</h1>
<p>[Network DDE is no longer supported. Nddeapi.dll is present on Windows Vista, but all function calls return NDDE_NOT_IMPLEMENTED.]</p>
<p>Retrieves the options associated with a DDE share that is in the server user's list of trusted shares.</p>
<h2>Syntax</h2>
<pre lang="C++"><code>UINT NDdeGetTrustedShare(
  _In_  LPTSTR  lpszServer,
  _In_  LPTSTR  lpszShareName,
  _Out_ LPDWORD lpdwTrustOptions,
  _Out_ LPDWORD lpdwShareModId0,
  _Out_ LPDWORD lpdwShareModId1
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>lpszServer</em> [in]</p>
<!-- raw HTML omitted -->
<p>The name of the server on which the DSDM resides.</p>
<!-- raw HTML omitted -->
<p><em>lpszShareName</em> [in]</p>
<!-- raw HTML omitted -->
<p>The share name whose trusted status is being queried. This parameter cannot be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpdwTrustOptions</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives the trust options. This parameter cannot be <strong>NULL</strong>. The following trust options are available.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>NDDE_CMD_SHOW_MASK</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x0000FFFFL<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Mask used to obtain the value used to override the DDE share show state, if NDDE_TRUST_CMD_SHOW is set.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>NDDE_TRUST_CMD_SHOW</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x10000000L<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Override the show state specified in the DDE share DSDM.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>NDDE_TRUST_SHARE_DEL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x20000000L<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Remove the share's trusted status.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>NDDE_TRUST_SHARE_INIT</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x40000000L<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Allow a client to initiate to the application if it is already running in the user's context.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>NDDE_TRUST_SHARE_START</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0x80000000L<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>Allow the application to be started in the user's context.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>lpdwShareModId0</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives the first part of the trusted share modify identifier. This parameter cannot be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<p><em>lpdwShareModId1</em> [out]</p>
<!-- raw HTML omitted -->
<p>A pointer to a variable that receives the second part of the trusted share modify identifier. This parameter cannot be <strong>NULL</strong>.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the function succeeds, the return value is NDDE_NO_ERROR.</p>
<p>If the function fails, the return value is an error code, which can be translated into a text error message by calling <a href="nddegeterrorstring.html"><strong>NDdeGetErrorString</strong></a>.</p>
<h2>Remarks</h2>
<p>The trusted share modify identifier reflects the version of the DDE share in the DSDM at the time the DDE share was initially granted trusted status. The trusted share modify identifier is primarily used to remove obsolete trusted shares. However, the user does not need to remove obsolete trusted shares. The network DDE agent removes obsolete shares on the user's behalf.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 2000 Professional [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows 2000 Server [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Nddeapi.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Library<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Nddeapi.lib<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Nddeapi.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Unicode and ANSI names<!-- raw HTML omitted --></td>
<td><strong>NDdeGetTrustedShareW</strong> (Unicode) and <strong>NDdeGetTrustedShareA</strong> (ANSI)<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="network-dynamic-data-exchange.html">Network Dynamic Data Exchange Overview</a></p>
<!-- raw HTML omitted -->
<p><a href="network-dde-functions.html">Network DDE Functions</a></p>
<!-- raw HTML omitted -->
<p><a href="nddesettrustedshare.html"><strong>NDdeSetTrustedShare</strong></a></p>
<!-- raw HTML omitted -->
</body>
