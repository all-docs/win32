<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Call cancellation</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Call cancellation
description: Call cancellation notification cancels the operation of server side service operations and service-model callbacks.
ms.assetid: dc371921-869f-4775-98d3-80a1006358ba
keywords:</p>
<ul>
<li>Call cancellation Web Services for Windows</li>
<li>WWSAPI</li>
<li>WWS
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Call cancellation</h1>
<p>Call cancellation notification cancels the operation of <a href="server-side-service-operations.html">server side service operations</a> and service-model callbacks. Such cancellation can be for one of two reasons:</p>
<ul>
<li>The service host has stopped operations because of a call to the <a href="/windows/desktop/api/WebServices/nf-webservices-wsabortservicehost"><strong>WsAbortServiceHost</strong></a> function.</li>
<li>The underlying channel has raised a fault.</li>
</ul>
<p>To receive a cancellation notification, the service operation or service-model callback must register a <a href="/windows/desktop/api/WebServices/nc-webservices-ws_operation_cancel_callback"><strong>WS_OPERATION_CANCEL_CALLBACK</strong></a> callback by calling the <a href="/windows/desktop/api/WebServices/nf-webservices-wsregisteroperationforcancel"><strong>WsRegisterOperationForCancel</strong></a> function.</p>
<p>Optionally, as part of the registering for cancellation notification, the service operation or service-model callback can also register application-specific state data and the <a href="/windows/desktop/api/WebServices/nc-webservices-ws_operation_free_state_callback"><strong>WS_OPERATION_FREE_STATE_CALLBACK</strong></a> callback.</p>
<p>The state data is made available to the <a href="/windows/desktop/api/WebServices/nc-webservices-ws_operation_cancel_callback"><strong>WS_OPERATION_CANCEL_CALLBACK</strong></a> callback. On call completion, the <a href="/windows/desktop/api/WebServices/nc-webservices-ws_operation_free_state_callback"><strong>WS_OPERATION_FREE_STATE_CALLBACK</strong></a> callback is called to give the application an opportunity to free the state data.</p>
<p>For a code example, see <a href="blockingserviceexample.html">BlockingServiceExample</a>.</p>
<p>The cancellation callback is called only once for the lifetime of the <a href="server-side-service-operations.html">server side service operations</a> or callback function.</p>
<p>Call cancellation is available in for all service host callbacks that take <a href="ws-operation-context.html">WS_OPERATION_CONTEXT</a> as a parameter.</p>
<p>The following API elements relate to call cancellation.</p>
<table>
<thead>
<tr>
<th>Callback</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/WebServices/nc-webservices-ws_operation_cancel_callback"><strong>WS_OPERATION_CANCEL_CALLBACK</strong></a></td>
<td>Invoked by service model to notify a cancellation of an asynchronous service operation as a result of an aborted shutdown of service host.</td>
</tr>
<tr>
<td><a href="/windows/desktop/api/WebServices/nc-webservices-ws_operation_free_state_callback"><strong>WS_OPERATION_FREE_STATE_CALLBACK</strong></a></td>
<td>Invoked by service model to allow an application to clean up state data that was registered with the cancellation callback.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/WebServices/nf-webservices-wsregisteroperationforcancel"><strong>WsRegisterOperationForCancel</strong></a></td>
<td>Allows a service operation or service-model callback to register for a cancellation notification.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>Â </p>
<p>Â </p>
</body>
