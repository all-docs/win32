<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MDM_WindowsLicensing class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: MDM_WindowsLicensing class
description: The MDM_WindowsLicensing class is designed for licensing related management scenarios.
ms.assetid: 9b26d8dc-aab6-4c67-9dbc-4b53525b9354
keywords:</p>
<ul>
<li>MDM_WindowsLicensing class</li>
<li>MDM_WindowsLicensing class, described
topic_type:</li>
<li>apiref
api_name:</li>
<li>MDM_WindowsLicensing</li>
<li>MDM_WindowsLicensing.InstanceID</li>
<li>MDM_WindowsLicensing.ParentID
api_location:</li>
<li>DMWmiBridgeProv.dll
api_type:</li>
<li>DllExport
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>MDM_WindowsLicensing class</h1>
<p>The <strong>MDM_WindowsLicensing</strong> class is designed for licensing related management scenarios. Currently the scope is limited to edition upgrades of Windows 10 desktop and mobile devices, such as Windows 10 Pro to Windows 10 Enterprise. In addition, this CSP provides the capability to activate or change the product key of Windows 10 desktop devices.</p>
<p>The following syntax is simplified from MOF code and includes all inherited properties.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>[InPartition(&quot;local-system&quot;), dynamic, provider(&quot;DMWmiBridgeProv&quot;)]
class MDM_WindowsLicensing
{
  string InstanceID;
  string ParentID;
  sint32 Edition;
  sint32 Status;
  string LicenseKeyType;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>MDM_WindowsLicensing</strong> class has these types of members:</p>
<ul>
<li><a href="#methods">Methods</a></li>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Methods</h3>
<p>The <strong>MDM_WindowsLicensing</strong> class has these methods.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->ChangeProductKeyMethod<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Installs a product key for Windows 10 desktop devices. Does not reboot.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CheckApplicabilityMethod<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Method to check if the entered product key can be used for an edition upgrade, activation or changing a product key of Windows 10 for desktop devices.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="mdm-windowslicensing-upgradeeditionwithlicensemethod.html"><strong>UpgradeEditionWithLicenseMethod</strong></a></td>
<td>Provide a license for an edition upgrade of Windows 10 mobile devices.<!-- raw HTML omitted --> <strong>Note:</strong> This upgrade process does not require a system restart.<!-- raw HTML omitted --> The date type is XML.<!-- raw HTML omitted --> The supported operation is Execute.<!-- raw HTML omitted --> <strong>Important:</strong> <!-- raw HTML omitted -->The XML license file contents must be properly escaped (that is, it should not simply be a copied XML), otherwise the edition upgrade on Windows 10 mobile devices will fail. For more information on proper escaping of the XML license file, see Section 2.4 of the <a href="https://www.w3.org/TR/xml/">W3C XML spec</a>. The XML license file is acquired from the Microsoft Volume Licensing Service Center. Your organization must have a Volume Licensing contract with Microsoft to access the portal.<!-- raw HTML omitted --> The following are valid edition upgrade paths when using this node through an MDM or provisioning package:<!-- raw HTML omitted -->- Windows 10 Mobileto Windows 10 Mobile Enterprise<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->UpgradeEditionWithProductKeyMethod<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Triggers the device to take the product key and upgrade the edition of the client.<!-- raw HTML omitted -->[!Note]<!-- raw HTML omitted -->This upgrade process requires a system restart.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> The supported operation is Execute.<!-- raw HTML omitted --> When a product key is pushed from an MDM server to a user's device, <!-- raw HTML omitted -->changepk.exe<!-- raw HTML omitted --> runs using the product key. After it completes, a notification is shown to the user that a new edition of Windows 10 is available. The user can then restart their system manually or, after two hours, the device will restart automatically to complete the upgrade. The user will receive a reminder notification 10 minutes before the automatic restart.<!-- raw HTML omitted --> After the device restarts, the edition upgrade process completes. The user will receive a notification of the successful upgrade.<!-- raw HTML omitted -->[!Important]<!-- raw HTML omitted -->If another policy requires a system reboot that occurs when <!-- raw HTML omitted -->changepk.exe<!-- raw HTML omitted --> is running, the edition upgrade will fail.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> If a product key is entered in a provisioning package and the user begins installation of the package, a notification is shown to the user that their system will restart to complete the package installation. Upon explicit consent from the user to proceed, the package continues installation and <!-- raw HTML omitted -->changepk.exe<!-- raw HTML omitted --> runs using the product key. The user will receive a reminder notification 30 seconds before the automatic restart. <!-- raw HTML omitted --> After the device restarts, the edition upgrade process completes. The user will receive a notification of the successful upgrade. <!-- raw HTML omitted --> This node can also be used to activate or change a product key on a particular edition of Windows 10 desktop device by entering a product key. Activation or changing a product key does not require a reboot and is a silent process for the user.<!-- raw HTML omitted --><!-- raw HTML omitted -->[!Important]<!-- raw HTML omitted -->The product key entered must be 29 characters (that is, it should include dashes), otherwise the activation, edition upgrade, or product key change on Windows 10 desktop devices will fail. The product key is acquired from Microsoft Volume Licensing Service Center. Your organization must have a Volume Licensing contract with Microsoft to access the portal.<!-- raw HTML omitted --><!-- raw HTML omitted --> The following are valid edition upgrade paths when using this node through an MDM:<!-- raw HTML omitted --><!-- raw HTML omitted -->Windows 10 Enterprise to Windows 10 Education<!-- raw HTML omitted --><!-- raw HTML omitted -->Windows 10 Home to Windows 10 Education<!-- raw HTML omitted --><!-- raw HTML omitted -->Windows 10 Pro to Windows 10 Education<!-- raw HTML omitted --><!-- raw HTML omitted -->Windows 10 Pro to Windows 10 Enterprise<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> Activation or changing a product key can be carried out on the following editions:<!-- raw HTML omitted --><!-- raw HTML omitted -->Windows 10 Education<!-- raw HTML omitted --><!-- raw HTML omitted -->Windows 10 Enterprise<!-- raw HTML omitted --><!-- raw HTML omitted -->Windows 10 Home<!-- raw HTML omitted --><!-- raw HTML omitted -->Windows 10 Pro<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<p>The <strong>MDM_WindowsLicensing</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/client-management/mdm/windowslicensing-csp#edition">Edition</a></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>sint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>InstanceID</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="/windows/desktop/WmiSdk/key-qualifier"><strong>key</strong></a></p>
<!-- raw HTML omitted -->
<p>Identifies the name of the parent node.</p>
<!-- raw HTML omitted -->
<p><a href="/windows/client-management/mdm/windowslicensing-csp#licensekeytype">LicenseKeyType</a></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>ParentID</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>string</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>Qualifiers: <a href="/windows/desktop/WmiSdk/key-qualifier"><strong>key</strong></a></p>
<!-- raw HTML omitted -->
<p>Describes the full path to the parent node. For this class, the string is &quot;./Vendor/MSFT/&quot;</p>
<!-- raw HTML omitted -->
<p><a href="/windows/client-management/mdm/windowslicensing-csp#subscriptions-subscriptionid-status">Status</a></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>sint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read/write</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows 10 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\CIMv2\MDM\DMMap<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->DMWmiBridgeProv.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->DMWmiBridgeProv.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/client-management/mdm/using-powershell-scripting-with-the-wmi-bridge-provider">Using PowerShell scripting with the WMI Bridge Provider</a></p>
<!-- raw HTML omitted -->
</body>
