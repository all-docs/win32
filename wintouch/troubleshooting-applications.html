<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Troubleshooting Applications</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Troubleshooting Applications
description: This section gives solutions to common problems.
ms.assetid: dfdc5a97-aa0a-4011-8f61-6e405e28b6f8
keywords:</p>
<ul>
<li>Windows Touch,troubleshooting applications</li>
<li>Windows Touch,palm rejection</li>
<li>palm rejection</li>
<li>Windows Touch,legacy support</li>
<li>troubleshooting Windows Touch</li>
<li>inertia,troubleshooting applications</li>
<li>manipulations,troubleshooting applications</li>
<li>gestures,troubleshooting applications
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Troubleshooting Applications</h1>
<p>This section gives solutions to common problems.</p>
<h2>General Troubleshooting</h2>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Issue</td>
<td>I am running Windows Server 2008 and Windows Touch features are not working.</td>
</tr>
<tr>
<td>Cause</td>
<td>You haven't enabled the Desktop Experience.</td>
</tr>
<tr>
<td>Solution</td>
<td>Open the Server Manager administrative tool: click <strong>Start</strong>, point to <strong>Administrative Tools</strong>, and then click <strong>Server Manager</strong>. Click the <strong>Features</strong> item in the left column. Click <strong>Add Features</strong> in the <strong>Features</strong> section. Select <strong>Desktop Experience</strong>, click <strong>Next</strong>, and then click <strong>Install</strong>.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Issue</td>
<td>Whenever I move my finger quickly across my application, an arrow appears and my gesture or manipulation is not registering correctly.</td>
</tr>
<tr>
<td>Cause</td>
<td>Having flicks enabled when you don't need it.</td>
</tr>
<tr>
<td>Solution</td>
<td>You have flicks enabled when you want it to be disabled. See <a href="legacy-support-for-panning-with-scrollbars.html">Legacy Support for Panning with Scrollbars</a> for information on disabling pen flicks.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p>if ((GetMessageExtraInfo() &amp; MOUSEEVENTF_FROMTOUCH) == MOUSEEVENTF_FROMTOUCH) {
// Click was generated by wisptis / Windows Touch
}else{
// Click was generated by the mouse.
}
<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>Â </p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Issue</td>
<td>How do I run Microsoft PixelSense applications on Windows 7?</td>
</tr>
<tr>
<td>Cause</td>
<td>Windows Touch and Microsoft PixelSense are incompatible.</td>
</tr>
<tr>
<td>Solution</td>
<td>You either need to target the Windows 7 platform or Microsoft PixelSense platform.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Troubleshooting Manipulations and Inertia</h2>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Issue</td>
<td>My application is freezing for no reason. I'm getting access violations when I initialize my object interfaces.</td>
</tr>
<tr>
<td>Cause</td>
<td>Missing a call to <strong>CoInitialize</strong> when using the <a href="/windows/desktop/api/manipulations/nn-manipulations-imanipulationprocessor"><strong>IManipulationProcessor</strong></a> or <a href="/windows/desktop/api/manipulations/nn-manipulations-iinertiaprocessor"><strong>IInertiaProcessor</strong></a> interfaces.</td>
</tr>
<tr>
<td>Solution</td>
<td>This could be caused by instantiating the Windows Touch Component Object Model (COM) objects without calling CoInitialize. This happens sometimes when you are converting projects from using gestures to using the manipulations or inertia interfaces.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Issue</td>
<td>My object is rotating improperly when it's being translated. Single-finger rotation is not working correctly.</td>
</tr>
<tr>
<td>Cause</td>
<td>Improperly setting pivots on an object.</td>
</tr>
<tr>
<td>Solution</td>
<td>You are not setting up the manipulation pivot points correctly. Set the <a href="/windows/desktop/api/manipulations/nf-manipulations-imanipulationprocessor-get_pivotpointx"><strong>PivotPointX</strong></a> and <a href="/windows/desktop/api/manipulations/nf-manipulations-imanipulationprocessor-get_pivotpointy"><strong>PivotPointY</strong></a> properties to the center of the object or point you want to rotate around, and set the <a href="/windows/desktop/api/manipulations/nf-manipulations-imanipulationprocessor-get_pivotradius"><strong>PivotRadius</strong></a> property to the radius of your object.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Troubleshooting Windows Touch Input</h2>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Issue</td>
<td>After I handle the <a href="wm-touchdown.html"><strong>WM_TOUCH</strong></a> message, I stop getting boundary feedback.</td>
</tr>
<tr>
<td>Cause</td>
<td>Consuming the <a href="wm-touchdown.html"><strong>WM_TOUCH</strong></a> message without handling it.</td>
</tr>
<tr>
<td>Solution</td>
<td>You are probably consuming a Windows Touch message without forwarding it to <strong>DefWindowProc</strong>, which will result in unexpected behavior. Check <a href="getting-started-with-multi-touch-messages.html">Getting Started with Windows Touch Messages</a> for more information on how to properly handle <a href="wm-touchdown.html"><strong>WM_TOUCH</strong></a> messages.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p>Â </p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted -->Note:<!-- raw HTML omitted --><!-- raw HTML omitted -->
To use the <!-- raw HTML omitted --><!-- raw HTML omitted -->ScreenToClient<!-- raw HTML omitted --><!-- raw HTML omitted --> function, you must have high DPI support in your application. For more information on supporting high DPI, see <!-- raw HTML omitted -->High DPI<!-- raw HTML omitted -->.</p>
<!-- raw HTML omitted -->
<p>Â </p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Issue</td>
<td>I'm not seeing <a href="wm-touchdown.html"><strong>WM_TOUCH</strong></a> messages, but I know that Windows Touch is working because I'm seeing <a href="wm-gesture.html"><strong>WM_GESTURE</strong></a> messages.</td>
</tr>
<tr>
<td>Cause</td>
<td>Missing a call to <a href="/windows/desktop/api/winuser/nf-winuser-registertouchwindow"><strong>RegisterTouchWindow</strong></a>.</td>
</tr>
<tr>
<td>Solution</td>
<td><a href="wm-touchdown.html"><strong>WM_TOUCH</strong></a> and <a href="wm-gesture.html"><strong>WM_GESTURE</strong></a> messages are mutually exclusive. If you don't call <a href="/windows/desktop/api/winuser/nf-winuser-registertouchwindow"><strong>RegisterTouchWindow</strong></a>, you will receive only <strong>WM_GESTURE</strong> messages.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Issue</td>
<td>I am noticing small delays from the time I touch my finger down to when I am getting input in my application.</td>
</tr>
<tr>
<td>Cause</td>
<td>Palm rejection is causing delays in input.</td>
</tr>
<tr>
<td>Solution</td>
<td>If <strong>TWF_WANTPALM</strong> is set in calls to <a href="/windows/desktop/api/winuser/nf-winuser-registertouchwindow"><strong>RegisterTouchWindow</strong></a>, palm rejection is enabled. This causes a small (100 ms) delay while the software tests whether input is coming from a finger, pen, or the user's palm. Disable palm rejection by calling <strong>RegisterTouchWindow</strong> with the <strong>TWF_WANTPALM</strong> flag cleared.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Troubleshooting Windows Touch Gestures</h2>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Issue</td>
<td>After handling the <a href="wm-gesture.html"><strong>WM_GESTURE</strong></a> message, I stop getting boundary feedback.Â Or, a gesture that worked previously does not work now.</td>
</tr>
<tr>
<td>Cause</td>
<td>Consuming the <a href="wm-gesture.html"><strong>WM_GESTURE</strong></a> message without handling it.</td>
</tr>
<tr>
<td>Solution</td>
<td>You are probably consuming a Windows Touch message without forwarding it to <a href="/windows/win32/api/winuser/nf-winuser-defwindowproca">DefWindowProc</a>, which will result in unexpected behavior. Check <a href="getting-started-with-multi-touch-gestures.html">Getting Started with Windows Gestures</a> for more information on how to properly handle <a href="wm-gesture.html"><strong>WM_GESTURE</strong></a> messages.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Issue</td>
<td>I'm not seeing <a href="wm-gesture.html"><strong>WM_GESTURE</strong></a> messages, but I know that Windows Touch is working because I'm seeing <a href="wm-touchdown.html"><strong>WM_TOUCH</strong></a> messages.</td>
</tr>
<tr>
<td>Cause</td>
<td>Calling <a href="/windows/desktop/api/winuser/nf-winuser-registertouchwindow"><strong>RegisterTouchWindow</strong></a>.</td>
</tr>
<tr>
<td>Solution</td>
<td><a href="wm-touchdown.html"><strong>WM_TOUCH</strong></a> and <a href="wm-gesture.html"><strong>WM_GESTURE</strong></a> messages are mutually exclusive. If you call <a href="/windows/desktop/api/winuser/nf-winuser-registertouchwindow"><strong>RegisterTouchWindow</strong></a>, you will not receive <strong>WM_GESTURE</strong> messages.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<!-- raw HTML omitted -->
<p>LRESULT CTestWndApp::OnWindowsGestureNotify(
UINT    uMsg,
WPARAM  wParam,
LPARAM  lParam,
BOOL&amp;   bHandled
){
GESTURECONFIG gc;
gc.dwID    = GID_ROTATE; // The gesture identifier.
gc.dwWant  = GC_ROTATE;  // The gesture command you are enabling for GID_ROTATE.
gc.dwBlock = 0;          // Don't block anything.
UINT uiGcs = 1;          // The number of gestures being set.</p>
<p>BOOL bResult = SetGestureConfig(g_hMainWnd, 0, uiGcs, &amp;gc, sizeof(GESTURECONFIG));
if(!bResult) {
// Something went wrong, report the error using your preferred logging.
}</p>
<p>return 0;
}  <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>For more examples of typical gesture configurations, see <!-- raw HTML omitted -->SetGestureConfig<!-- raw HTML omitted -->.<!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>Â </p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Issue</td>
<td>The custom scroll bars in my application are not scrolling when I perform the pan gesture.</td>
</tr>
<tr>
<td>Cause</td>
<td>Missing handlers for the correct WM_*SCROLL messages.</td>
</tr>
<tr>
<td>Solution</td>
<td>You are not handling all of the WM_*SCROLL messages in your custom scroll bars. It is recommended that you handle the <a href="wm-gesture.html"><strong>WM_GESTURE</strong></a> message rather than retain custom scrollbar functionality through legacy support. You need to support messages as detailed in the section <a href="legacy-support-for-panning-with-scrollbars.html">Legacy Support for Panning with Scroll bars</a>.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Issue</td>
<td>I am getting delays for gestures.</td>
</tr>
<tr>
<td>Cause</td>
<td>Flicks may be causing delays for gestures.</td>
</tr>
<tr>
<td>Solution</td>
<td>Flicks can cause delays for how long it takes for your application to receive <a href="wm-gesture.html"><strong>WM_GESTURE</strong></a> messages. See <a href="legacy-support-for-panning-with-scrollbars.html">Legacy Support for Panning with Scrollbars</a> for information on disabling flicks.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="programming-guide.html">Programming Guide</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
