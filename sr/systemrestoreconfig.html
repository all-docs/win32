<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SystemRestoreConfig class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: SystemRestoreConfig class
description: Provides properties for controlling the frequency of scheduled restore point creation and the amount of disk space consumed on each drive.
ms.assetid: ed09e03f-8cc1-4923-8f39-bbe7d9a19b44
keywords:</p>
<ul>
<li>SystemRestoreConfig class System Restore</li>
<li>SystemRestoreConfig class System Restore , described
topic_type:</li>
<li>apiref
api_name:</li>
<li>SystemRestoreConfig</li>
<li>SystemRestoreConfig.RPSessionInterval</li>
<li>SystemRestoreConfig.RPGlobalInterval</li>
<li>SystemRestoreConfig.RPLifeInterval</li>
<li>SystemRestoreConfig.DiskPercent
api_location:</li>
<li>Root\Default
api_type:</li>
<li>Schema
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>SystemRestoreConfig class</h1>
<p>Provides properties for controlling the frequency of scheduled restore point creation and the amount of disk space consumed on each drive.</p>
<h2>Syntax</h2>
<pre lang="syntax"><code>class SystemRestoreConfig
{
  uint32 RPSessionInterval;
  uint32 RPGlobalInterval;
  uint32 RPLifeInterval;
  uint32 DiskPercent;
};
</code></pre>
<h2>Members</h2>
<p>The <strong>SystemRestoreConfig</strong> class has these types of members:</p>
<ul>
<li><a href="#properties">Properties</a></li>
</ul>
<h3>Properties</h3>
<p>The <strong>SystemRestoreConfig</strong> class has these properties.</p>
<!-- raw HTML omitted -->
<p><strong>DiskPercent</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>The maximum amount of disk space on each drive that can be used by System Restore. This value is specified as a percentage of the total drive space. The default value is 12 percent.</p>
<p><strong>Windows Vista:</strong> Receives a value from the Volume Shadow Copy Service (VSS). This is the maximum amount of disk space on each drive that can be used by System Restore. The default value is 15 percent of the total drive space or 30 percent of the available free space, whichever is smaller.</p>
<!-- raw HTML omitted -->
<p><strong>RPGlobalInterval</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>The absolute time interval at which scheduled system checkpoints are created, in seconds. The default value is 86,400 (24 hours).</p>
<p><strong>Windows Vista:</strong> Receives a value from the task scheduler for System Restore. Zero if the task is disabled.</p>
<!-- raw HTML omitted -->
<p><strong>RPLifeInterval</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>The time interval for which restore points are preserved, in seconds. When a restore point becomes older than this specified interval, it is deleted. The default age limit is 90 days.</p>
<p><strong>Windows Vista:</strong> Receives a value of <strong>UINTMAX</strong>.</p>
<!-- raw HTML omitted -->
<p><strong>RPSessionInterval</strong></p>
<!-- raw HTML omitted -->
<p>Data type: <strong>uint32</strong></p>
<!-- raw HTML omitted -->
<p>Access type: Read-only</p>
<!-- raw HTML omitted -->
<p>The time interval at which scheduled system checkpoints are created during the session, in seconds. The default value is zero, indicating that the feature is turned off.</p>
<p><strong>Windows Vista:</strong> Receives zero if System Restore is disabled.</p>
<!-- raw HTML omitted -->
<h2>Examples</h2>
<p>The following sample code is not supported. Use the command-line tool Vssadmin.exe to change the size of reserved drive space.</p>
<p><strong>Windows XP:</strong> This sample is supported.</p>
<pre lang="VB"><code>'The SystemRestoreConfig class provides properties for controlling the frequency of 
'scheduled restore point creation and the amount of disk space consumed on each drive.

Set Args = wscript.Arguments
Set regSR = GetObject(&quot;winmgmts:{impersonationLevel=impersonate}!root/default:SystemRestoreConfig='SR'&quot;)

If Args.Count() = 0 Then
    Wscript.Echo &quot;Usage: RegSR [RP{Session|Global|Life}Interval[=value]] [DiskPercent[=value]]&quot;
Else    
For i = 0 To Args.Count() - 1
    Myarg = Args.Item(i)
    Pos = InStr(Myarg, &quot;=&quot;)
    If Pos &lt;&gt; 0 Then
        Myarray = Split(Myarg, &quot;=&quot;, -1, 1)
        myoption = Myarray(0)
        value = Myarray(1)
    Else 
        myoption = Myarg
    End If    
    If myoption = &quot;RPSessionInterval&quot; Then
        If Pos = 0 Then
            Wscript.Echo &quot;RPSessionInterval = &quot; &amp; regSR.RPSessionInterval
        Else    
            regSR.RPSessionInterval = value
            regSR.Put_
        End If
    ElseIf myoption = &quot;RPGlobalInterval&quot; Then
        If Pos = 0 Then
            Wscript.Echo &quot;RPGlobalInterval = &quot; &amp; regSR.RPGlobalInterval
        Else    
            regSR.RPGlobalInterval = value
            regSR.Put_
        End If
    ElseIf myoption = &quot;RPLifeInterval&quot; Then
        If Pos = 0 Then
            Wscript.Echo &quot;RPLifeInterval = &quot; &amp; regSR.RPLifeInterval
        Else    
            regSR.RPLifeInterval = value
            regSR.Put_
        End If
    ElseIf myoption = &quot;DiskPercent&quot; Then
        If Pos = 0 Then
            Wscript.Echo &quot;DiskPercent = &quot; &amp; regSR.DiskPercent
        Else    
            regSR.DiskPercent = value
            regSR.Put_
        End If
    End If
Next
End If
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\Default<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Sr.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="restore-points.html">Restore Points</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/WmiSdk/wmi-start-page">Windows Management Instrumentation</a></p>
<!-- raw HTML omitted -->
</body>
