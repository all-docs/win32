<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Restore method of the SystemRestore class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Restore method of the SystemRestore class
description: Initiates a system restore.
ms.assetid: ca4aa97b-fa59-407d-b127-951d46932c33
keywords:</p>
<ul>
<li>Restore method System Restore</li>
<li>Restore method System Restore , SystemRestore class</li>
<li>SystemRestore class System Restore , Restore method
topic_type:</li>
<li>apiref
api_name:</li>
<li>SystemRestore.Restore
api_location:</li>
<li>Root\Default
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Restore method of the SystemRestore class</h1>
<p>Initiates a system restore. The caller must force a system reboot. The actual restoration occurs during the reboot.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 Restore(
  [in] uint32 SequenceNumber
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>SequenceNumber</em> [in]</p>
<!-- raw HTML omitted -->
<p>The sequence number of the restore point. To determine the sequence number for a specific restore point, enumerate all restore points on the system.</p>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the method succeeds, the return value is S_OK. Otherwise, the method returns one of the COM error codes defined in WinError.h.</p>
<h2>Examples</h2>
<pre lang="VB"><code>'Restore Method of the SystemRestore Class
'Initiates a system restore. The caller must 
'force a system reboot. The actual restoration 
'occurs during the reboot.
Set Args = wscript.Arguments
RpNum = Args.item(0)
Set obj = GetObject(&quot;winmgmts:{impersonationLevel=impersonate}!root/default:SystemRestore&quot;)
if obj.Restore(RpNum) &lt;&gt; 0 Then
    wscript.Echo &quot;Restore failed&quot;
End If
Set OpSysSet = GetObject(&quot;winmgmts:{(Shutdown)}//./root/cimv2&quot;).ExecQuery(&quot;select * from Win32_OperatingSystem where Primary=true&quot;)
for each OpSys in OpSysSet
    OpSys.Reboot()
next
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\\Default<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Sr.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="systemrestore.html"><strong>SystemRestore</strong></a></p>
<!-- raw HTML omitted -->
</body>
