<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CreateRestorePoint method of the SystemRestore class</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: CreateRestorePoint method of the SystemRestore class
description: Creates a restore point.
ms.assetid: 30e1ff03-816c-463f-9f80-6d84149f0e0b
keywords:</p>
<ul>
<li>CreateRestorePoint method System Restore</li>
<li>CreateRestorePoint method System Restore , SystemRestore class</li>
<li>SystemRestore class System Restore , CreateRestorePoint method
topic_type:</li>
<li>apiref
api_name:</li>
<li>SystemRestore.CreateRestorePoint
api_location:</li>
<li>Root\Default
api_type:</li>
<li>COM
ms.topic: reference
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>CreateRestorePoint method of the SystemRestore class</h1>
<p>Creates a restore point.</p>
<p>This method is the scriptable equivalent of the <a href="/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srsetrestorepointa"><strong>SRSetRestorePoint</strong></a> function.</p>
<h2>Syntax</h2>
<pre lang="mof"><code>uint32 CreateRestorePoint(
  [in] String Description,
  [in] uint32 RestorePointType,
  [in] uint32 EventType
);
</code></pre>
<h2>Parameters</h2>
<!-- raw HTML omitted -->
<p><em>Description</em> [in]</p>
<!-- raw HTML omitted -->
<p>The description to be displayed so the user can easily identify a restore point. The maximum length of an ANSI string is MAX_DESC. The maximum length of a Unicode string is MAX_DESC_W. For more information, see <a href="restore-point-description-text.html">Restore Point Description Text</a>.</p>
<!-- raw HTML omitted -->
<p><em>RestorePointType</em> [in]</p>
<!-- raw HTML omitted -->
<p>The type of restore point. This member can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Restore point type</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>APPLICATION_INSTALL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->0<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An application has been installed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>APPLICATION_UNINSTALL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->1<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An application has been uninstalled.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>DEVICE_DRIVER_INSTALL</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->10<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A device driver has been installed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>MODIFY_SETTINGS</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->12<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An application has had features added or removed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>CANCELLED_OPERATION</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->13<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>An application needs to delete the restore point it created. For example, an application would use this flag when a user cancels an installation.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<p><em>EventType</em> [in]</p>
<!-- raw HTML omitted -->
<p>The type of event. This member can be one of the following values.</p>
<table>
<thead>
<tr>
<th>Event type</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>BEGIN_NESTED_SYSTEM_CHANGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->102<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A system change has begun. A subsequent nested call does not create a new restore point. <!-- raw HTML omitted --> Subsequent calls must use END_NESTED_SYSTEM_CHANGE, not END_SYSTEM_CHANGE.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>BEGIN_SYSTEM_CHANGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->100<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A system change has begun. <!-- raw HTML omitted --> A subsequent call must use END_SYSTEM_CHANGE, not END_NESTED_SYSTEM_CHANGE.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>END_NESTED_SYSTEM_CHANGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->103<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A system change has ended.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><strong>END_SYSTEM_CHANGE</strong><!-- raw HTML omitted --> <!-- raw HTML omitted -->101<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
<td>A system change has ended.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<h2>Return value</h2>
<p>If the method succeeds, the return value is S_OK. Otherwise, the method returns one of the COM error codes defined in WinError.h.</p>
<h2>Remarks</h2>
<p>**Windows 8:  **</p>
<p>A new registry key enables application developers to change the frequency of restore-point creation.</p>
<p>Applications should create this key to use it because it will not preexist in the system. The following will apply by default if the key does not exist. If an application calls the <strong>CreateRestorePoint</strong> method to create a restore point, Windows skips creating this new restore point if any restore points have been created in the last 24 hours. The <strong>CreateRestorePoint</strong> method returns <strong>S_OK</strong>.</p>
<p>Developers can write applications that create the <strong>DWORD</strong> value <strong>SystemRestorePointCreationFrequency</strong> under the registry key <strong>HKLM\Software\Microsoft\Windows NT\CurrentVersion\SystemRestore</strong>. The value of this registry key can change the frequency of restore point creation. The value of this registry key can change the frequency of restore point creation.</p>
<p>If the application calls <strong>CreateRestorePoint</strong> to create a restore point, and the registry key value is 0, system restore does not skip creating the new restore point.</p>
<p>If the application calls <strong>CreateRestorePoint</strong> to create a restore point, and the registry key value is the integer N, system restore skips creating a new restore point if any restore points were created in the previous N minutes.</p>
<h2>Examples</h2>
<pre lang="VB"><code>'CreateRestorePoint Method of the SystemRestore Class
'Creates a restore point. Specifies the beginning and 
'the ending of a set of changes so that System Restore 
'can create a restore point.This method is the 
'scriptable equivalent of the SRSetRestorePoint function.

Set Args = wscript.Arguments
If Args.Count() &gt; 0 Then
    RpName = Args.item(0)
Else 
    RpName = &quot;Vbscript&quot;
End If

Set obj = GetObject(&quot;winmgmts:{impersonationLevel=impersonate}!root/default:SystemRestore&quot;)

If (obj.CreateRestorePoint(RpName, 0, 100)) = 0 Then
    wscript.Echo &quot;Success&quot;
Else 
    wscript.Echo &quot;Failed&quot;
End If
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>Windows XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Namespace<!-- raw HTML omitted --></td>
<td>Root\Default<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MOF<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Sr.mof<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="systemrestore.html"><strong>SystemRestore</strong></a></p>
<!-- raw HTML omitted -->
</body>
