<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Instantiating Codec DMOs</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Instantiating Codec DMOs
ms.assetid: e031d0d4-dd70-409e-8a2e-5a1433fe909e
title: Instantiating Codec DMOs
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Instantiating Codec DMOs</h1>
<p>You can create a codec DMO by calling the <a href="/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance"><strong>CoCreateInstance</strong></a> COM function. You must pass the class identifier of the DMO, the interface identifier of <strong>IMediaObject</strong>, and a pointer to an <strong>IMediaObject</strong> pointer.</p>
<p>The class identifiers of the codec DMOs are defined as constants in the wmcodecdsp.h header file.</p>
<p>The constant for the <strong>IMediaObject</strong> interface identifier is IID_IMediaObject.</p>
<p>The following code example demonstrates how to create an instance of a codec DMO:</p>
<pre><code>HRESULT CreateVideoEncoderDMO(IMediaObject** ppDMO)
{
    if(ppDMO == NULL)
        return E_POINTER;

    return CoCreateInstance(CLSID_CWMV9EncMediaObject,
                            NULL,
                            CLSCTX_INPROC_SERVER, 
                            IID_IMediaObject, 
                            (void**)ppDMO);
}
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="workingwithcodecdmos.html">Working with Codec DMOs</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
