<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using the Windows Media Video 9.1 Image Category</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Using the Windows Media Video 9.1 Image Category
ms.assetid: b77e955b-767b-4b64-9421-bacac9edf09c
title: Using the Windows Media Video 9.1 Image Category
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using the Windows Media Video 9.1 Image Category</h1>
<p>The Windows Media Video 9.1 Image category is different from the other output categories supported by the Windows Media Video 9 encoder and decoder. Instead of processing uncompressed video, it takes special input samples that consist of structured transformation data and, occasionally, RGB bitmap images on which the transformations are performed.</p>
<p>The encoded Windows Media Video 9.1 Image content is virtually identical to regular Windows Media Video 9 encoded content, but it is identified by its own FOURCC (&quot;WMVP&quot;).</p>
<p>The encoder output type for video image is set in exactly the same way as standard Windows Media video, except that the subtype and compression values must be set to the video image identifiers. This includes the need to obtain codec private data and append it to the <a href="/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader"><strong>VIDEOINFOHEADER</strong></a> structure. For more information, see <a href="configuringvideoencoding.html">Configuring Video Encoding</a>.</p>
<p>The input type configuration for video image is also very similar to input configuration for the other video encoders. You can retrieve a partially completed <a href="/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type"><strong>DMO_MEDIA_TYPE</strong></a> from the encoder by calling <a href="/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getinputtype"><strong>IMediaObject::GetInputType</strong></a>, or if you are using the Media Foundation SDK, by calling <a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype"><strong>IMFTransform::GetInputAvailableType</strong></a> and retrieving the <strong>DMO_MEDIA_TYPE</strong> by using <a href="/windows/desktop/api/mfapi/nf-mfapi-mfcreateammediatypefrommfmediatype"><strong>MFCreateAMMediaTypeFromMFMediaType</strong></a>. You then set the frame size and the <a href="/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader"><strong>VIDEOINFOHEADER</strong></a> format structure, just as you would for standard video. As with the output type, you need to ensure that the subtype and compression values are set appropriately.</p>
<h2>Creating Input Samples</h2>
<p>The input samples for the video image codec are structured. The definition of the structure and constants used for video image are not included with the Windows Media Audio and Video codec interfaces. These definitions are included in the Windows Media Format SDK, and their use is fully explained in the Windows Media Format SDK documentation.</p>
<h2>Decoding</h2>
<p>There are no special requirements for decoding screen capture video. Other than a different subtype (MEDIASUBTYPE_WMVP) used for decoder input, the compressed video image stream is essentially identical to a standard Windows Media Video stream.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="workingwithvideo.html">Working with Video</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
