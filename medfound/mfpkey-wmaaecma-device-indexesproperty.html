<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MFPKEY_WMAAECMA_DEVICE_INDEXES Property</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Specifies which audio devices the Voice Capture DSP uses for capturing and rendering audio.
ms.assetid: 42b6b82b-ac64-4a07-956c-473dd57a128d
title: MFPKEY_WMAAECMA_DEVICE_INDEXES Property (Wmcodecdsp.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>MFPKEY_WMAAECMA_DEVICE_INDEXES Property</h1>
<p>Specifies which audio devices the Voice Capture DSP uses for capturing and rendering audio.</p>
<h2>Constant for IPropertyBag</h2>
<p>Available only by using <a href="/windows/win32/api/propsys/nn-propsys-ipropertystore"><strong>IPropertyStore</strong></a>.</p>
<h2>Data Type</h2>
<p>VT_I4</p>
<h2>Default Value</h2>
<p>(-1, -1).</p>
<h2>Applies To</h2>
<ul>
<li><a href="voicecapturedmo.html">Voice Capture DSP</a></li>
</ul>
<h2>Remarks</h2>
<p>Set this property if you are using the DSP in source mode. The DSP ignores this property in filter mode.</p>
<p>The value of the property is two 16-bit <strong>WORD</strong>s packed into a <strong>DWORD</strong>. The upper 16 bits specify the audio rendering device (typically a speaker), and the lower 16 bits specify the capture device (typically a microphone). Each device is specified as an index into the audio device collection. If the index is -1, the default device is used.</p>
<p>The device index corresponds to the collection index used in the <a href="/windows/win32/api/mmdeviceapi/nn-mmdeviceapi-immdevicecollection"><strong>IMMDeviceCollection</strong></a> interface. The application must play the far-end voice through the selected rendering device. (The far-end voice is the voice of the person on the other end of the telephone line, which is played through the speaker on the user's computer.) If the selected rendering device does not have an active stream, the DSP cannot process any output.</p>
<p>The default value of this property is (-1, -1).</p>
<p>The following example shows how to initialize the <strong>PROPVARIANT</strong> for this property.</p>
<pre><code>int iSpeakerIndex = -1;
int iMicrophoneIndex = -1;

// Find the device indexes to initialize iSpeakerIndex and 
// iMicrophone index (not shown).

PROPVARIANT varDeviceIndexes;
PropVariantInit(&amp;varDeviceIndexes);
varDeviceIndexes.vt = VT_I4;
varDeviceIndexes.lVal = (unsigned long)(iSpeakerIndex &lt;&lt; 16) + 
    (unsigned long)(0x0000ffff &amp; iMicrophoneIndex);
</code></pre>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wmcodecdsp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="media-foundation-properties.html">Media Foundation Properties</a></p>
<!-- raw HTML omitted -->
<p><a href="voicecapturedmo.html">Voice Capture DSP</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
