<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Color Converter DSP</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Converts a video stream between color formats.
ms.assetid: 1c15dc2b-0e69-4d16-af02-8056a1eb2c5c
title: Color Converter DSP (Wmcodecdsp.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>Color Converter DSP</h1>
<p>Converts a video stream between color formats.</p>
<h2>CLSID</h2>
<p>CLSID_CColorConvertDMO</p>
<h2>Interfaces</h2>
<ul>
<li><a href="/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject"><strong>IMediaObject</strong></a></li>
<li><a href="/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclient"><strong>IMFRealTimeClient</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nn-mftransform-imftransform"><strong>IMFTransform</strong></a></li>
<li><a href="/windows/win32/api/propsys/nn-propsys-ipropertystore"><strong>IPropertyStore</strong></a></li>
<li><a href="/windows/desktop/api/wmcodecdsp/nn-wmcodecdsp-iwmcolorconvprops">IWMColorConvProps</a></li>
</ul>
<h2>Input Formats</h2>
<ul>
<li>RGB 24</li>
<li>RGB 32</li>
<li>RGB 555</li>
<li>RGB 565</li>
<li>RGB 8</li>
<li>AYUV</li>
<li>I420</li>
<li>IYUV</li>
<li>NV11</li>
<li>NV12</li>
<li>UYVY</li>
<li>V216</li>
<li>V410</li>
<li>Y41P</li>
<li>Y41T</li>
<li>Y42T</li>
<li>YUY2</li>
<li>YV12</li>
<li>YVU9</li>
<li>YVYU</li>
</ul>
<h2>Output Formats</h2>
<ul>
<li>RGB 24</li>
<li>RGB 32</li>
<li>RGB 555</li>
<li>RGB 565</li>
<li>RGB 8</li>
<li>AYUV</li>
<li>I420</li>
<li>IYUV</li>
<li>NV11</li>
<li>NV12</li>
<li>UYVY</li>
<li>V216</li>
<li>V410</li>
<li>YUY2</li>
<li>YV12</li>
<li>YVYU</li>
</ul>
<h2>Properties</h2>
<ul>
<li><a href="mfpkey-colorconv-srcleft.html">MFPKEY_COLORCONV_SRCLEFT</a></li>
<li><a href="mfpkey-colorconv-srctop.html">MFPKEY_COLORCONV_SRCTOP</a></li>
<li><a href="mfpkey-colorconv-dstleft.html">MFPKEY_COLORCONV_DSTLEFT</a></li>
<li><a href="mfpkey-colorconv-dsttop.html">MFPKEY_COLORCONV_DSTTOP</a></li>
<li><a href="mfpkey-colorconv-width.html">MFPKEY_COLORCONV_WIDTH</a></li>
<li><a href="mfpkey-colorconv-height.html">MFPKEY_COLORCONV_HEIGHT</a></li>
<li><a href="mfpkey-colorconv-mode.html">MFPKEY_COLORCONV_MODE</a></li>
</ul>
<h2>Remarks</h2>
<p>The Color Converter DSP is implemented as a COM object that can act as a DirectXMedia Object (DMO) or a Media Foundation Transform (MFT). The object has a single class identifier (CLSID) regardless of whether it acts as a DMO or an MFT. For information about when a DSP acts as a DMO or an MFT, see <a href="windowsmediadigitalsignalprocessors.html">Digital Signal Processors</a>.</p>
<p>The globally unique identifiers (GUIDs) for RGB media subtypes differ depending on whether a DSP is acting as a DMO or an MFT. The GUIDs for non-RGB media subtypes are the same, regardless of whether a DSP is acting as a DMO or an MFT. For information about the GUIDs that represent media subtypes, see <a href="video-subtype-guids.html">Video Subtype GUIDs</a>.</p>
<p>By default, this DSP copies the entire source image to the output buffer. Optionally, you can specify source and destination rectangles. The DSP copies the portion of the source image defined by source rectangle, and writes it into the destination rectangle on the output buffer. The DSP does not perform any scaling; the source and destination rectangles must be the same size. The source and destination rectangles cannot exceed the boundaries of the video frame.</p>
<p>All of the properties except <a href="mfpkey-colorconv-mode.html"><strong>MFPKEY_COLORCONV_MODE</strong></a> must be set in a group. If you set any of these properties, you must set all of the others. Otherwise, the source and destination rectangles might be invalid, in which case both the <a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput"><strong>IMFTransform::ProcessOutput</strong></a> and <a href="/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput"><strong>IMediaObject::ProcessOutput</strong></a> methods will return <strong>E_INVALIDARG</strong>.</p>
<p>The color converter does not support every combination of input format and output format. Usually, you should set the media format that you know, either input or output, and then enumerate the available formats on the opposite stream.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wmcodecdsp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Colorcnv.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="windowsmediadigitalsignalprocessors.html">Digital Signal Processors</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
