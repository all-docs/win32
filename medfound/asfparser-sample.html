<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ASFParser Sample</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: ASFParser Sample
ms.assetid: 6be1e12f-7d4a-4564-88ae-14fd71fd2cf9
title: ASFParser Sample
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>ASFParser Sample</h1>
<p>Shows how to parse data from an Advanced Systems Format (ASF) file by using the low-level ASF components in Media Foundation. The sample demonstrates the following tasks:</p>
<ul>
<li>Enumerating the audio and video streams in an ASF file.</li>
<li>Selecting an audio or a video stream for parsing.</li>
<li>Seeking to a packet at a desired playback time.</li>
<li>Generating compressed samples for the selected stream.</li>
<li>Decoding audio and video samples.</li>
</ul>
<h2>APIs Demonstrated</h2>
<p>This sample demonstrates the following Microsoft Media Foundation interfaces:</p>
<ul>
<li><a href="/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo"><strong>IMFASFContentInfo</strong></a></li>
<li><a href="/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfindexer"><strong>IMFASFIndexer</strong></a></li>
<li><a href="/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfsplitter"><strong>IMFASFSplitter</strong></a></li>
</ul>
<h2>Usage</h2>
<ol>
<li>To open an ASF file, click the <strong>Open Media File...</strong> button.</li>
<li>Select an ASF file and click <strong>Open</strong>. Information about the file is shown on the <strong>Information</strong> pane.</li>
<li>Under <strong>Parser Configuration</strong>, select a stream to parse.</li>
<li>To generate samples in reverse, select <strong>Reverse</strong>.</li>
<li>To specify the start point, drag the slider to the desired location.</li>
<li>To begin parsing, click the <strong>Generate Samples</strong> button. Information about the samples is shown on the <strong>Information</strong> pane.</li>
<li>To test the samples for the audio stream, click the <strong>Test Audio</strong> button.</li>
<li>To test the samples for the video stream, click the <strong>Show Bitmap</strong> button.</li>
</ol>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Product</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://msdn.microsoft.com/windowsvista/bb980924.aspx">Windows SDK</a></td>
<td>WindowsÂ 7</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Downloading the Sample</h2>
<p>This sample is available in the <a href="https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation/asfparser">Windows classic samples github repository</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="media-foundation-sdk-samples.html">Media Foundation SDK Samples</a></p>
<!-- raw HTML omitted -->
<p><a href="asf-support-in-media-foundation.html">ASF Support in Media Foundation</a></p>
<!-- raw HTML omitted -->
<p><a href="tutorial--reading-an-asf-file.html">Tutorial: Reading an ASF File</a></p>
<!-- raw HTML omitted -->
<p><a href="wmcontainer-asf-components.html">WMContainer ASF Components</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
