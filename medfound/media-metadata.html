<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Media Metadata</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Media Metadata
ms.assetid: dd7c4bc9-e2a6-49cd-8f29-865a44d5b5c9
title: Media Metadata
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Media Metadata</h1>
<p>Media files contain properties that describe the contents of the file. In Microsoft Media Foundation, these properties can be categorized as follows:</p>
<ul>
<li><strong>Media-type attributes</strong> specify the encoding parameters, such as the encoding algorithm (media subtype), video frame size, video frame rate, audio bit rate, and audio sample rate. For more information about media-type attributes, see <a href="media-types.html">Media Types</a>.</li>
<li><strong>Metadata</strong> contains descriptive information for the media content, such as title, artist, composer, and genre. Metadata can also describe encoding parameters. It can be faster to access this information through metadata than through media-type attributes.</li>
<li><strong>DRM properties</strong> contain information on usage restrictions. Currently Media Foundation does not support DRM properties through metadata, with the exception of the <strong>PKEY_DRM_IsProtected</strong> property.</li>
</ul>
<p>There are two ways to read metadata in Media Foundation:</p>
<ul>
<li>The <a href="/windows/desktop/api/mfidl/nn-mfidl-imfmetadata"><strong>IMFMetadata</strong></a> interface (Media Foundation version 1 metadata).</li>
<li>The Windows Shell <a href="/windows/win32/api/propsys/nn-propsys-ipropertystore"><strong>IPropertyStore</strong></a> interface (Shell metadata).</li>
</ul>
<p>Shell metadata pertains not only to media files but to a much wider range of files on the system.</p>
<p>The following table compares the features and limitations of each metadata API.</p>
<table>
<thead>
<tr>
<th>Media Foundation v1 Metadata</th>
<th>Shell Metadata</th>
</tr>
</thead>
<tbody>
<tr>
<td>Requires WindowsÂ Vista or later.</td>
<td>Requires WindowsÂ 7. <strong>Note:</strong> Shell metadata in general does not require WindowsÂ 7, but Media Foundation did not support Shell metadata prior to WindowsÂ 7.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Properties are not compatible with Shell property system.</td>
<td>Properties are compatible with the Shell property system.</td>
</tr>
<tr>
<td>Properties can apply to the entire file, or at the stream level.</td>
<td>Only file-level properties are supported. Stream-level properties are not supported.</td>
</tr>
<tr>
<td>Properties can have values in multiple languages.</td>
<td>Values in multiple languages are not supported.</td>
</tr>
<tr>
<td>Property keys are wide-character strings.</td>
<td>Property keys are <!-- raw HTML omitted --><!-- raw HTML omitted -->PROPERTYKEY<!-- raw HTML omitted --><!-- raw HTML omitted --> values.</td>
</tr>
<tr>
<td>Property values are <!-- raw HTML omitted --><!-- raw HTML omitted -->PROPVARIANT<!-- raw HTML omitted --><!-- raw HTML omitted --> values.</td>
<td>Property values are <!-- raw HTML omitted --><!-- raw HTML omitted -->PROPVARIANT<!-- raw HTML omitted --><!-- raw HTML omitted --> values.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>In this section</h2>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="shell-metadata-providers.html">Shell Metadata Providers</a><!-- raw HTML omitted --></td>
<td>Starting in WindowsÂ 7, Media Foundation exposes metadata through the <a href="/windows/win32/api/propsys/nn-propsys-ipropertystore"><strong>IPropertyStore</strong></a> interface.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="metadata-properties-for-media-files.html">Metadata Properties for Media Files</a><!-- raw HTML omitted --></td>
<td>This topic lists the most common metadata properties for media files.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="metadata-providers-in-windows-vista.html">Metadata Providers in Windows Vista</a><!-- raw HTML omitted --></td>
<td>In WindowsÂ Vista, Media Foundation exposes metadata through the <a href="/windows/desktop/api/mfidl/nn-mfidl-imfmetadata"><strong>IMFMetadata</strong></a> interface.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>If you are implementing a custom media source and want to expose Shell metadata, see <a href="custom-metadata-providers-for-media-files.html">Custom Metadata Providers for Media Files</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="media-foundation-programming-guide.html">Media Foundation Programming Guide</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
