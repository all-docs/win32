<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using the Windows Media Audio Voice Codec</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Using the Windows Media Audio Voice Codec
ms.assetid: 771acb04-33a4-4ea3-8f50-e5e3dbdf9495
title: Using the Windows Media Audio Voice Codec
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Using the Windows Media Audio Voice Codec</h1>
<p>The Windows Media Audio Voice codec provides low bit-rate compression optimized for audio containing speech. The ability of the codec to produce such small samples is due to the limited frequency range of the sounds of the human voice. This optimization means that a dedicated voice encoder creates poor-quality output for content that contains more complicated sounds, like music. However, the Windows Media Audio Voice codec compensates for this potential quality issue by providing separate modes for voice, music, and mixed content. The codec analyzes mixed content to determine which mode to use for each portion of the file.</p>
<p>The Windows Media Audio Voice codec is implemented in the encoder object identified by the class identifier CLSID_CWMSPEncMediaObject2, and in the decoder object identified by the class identifier CLSID_CWMSPDecMediaObject. The format tag of media types using this codec is 0x00A.</p>
<h2>Configuring the Encoder</h2>
<p>The voice encoder supports three modes: speech, music, and mixed. Each mode is optimized to get the best results for that type of content. You can configure the mode of the voice encoder by using the methods of <strong>IPropertyStore</strong> to set the <a href="mfpkey-wmavoice-enc-musicspeechclassmodeproperty.html">MFPKEY_WMAVOICE_ENC_MusicSpeechClassMode</a> property.</p>
<p>When configured for mixed content, the Windows Media Audio Voice codec will automatically detect passages of music in the content. If you are not satisfied with the results, you can specify the location of music in the content using an editing decision list (EDL). For more information, see <a href="usingavoiceeditingdecisionlist.html">Using an Editing Decision List for Encoding Voice</a>.</p>
<p>Unlike the other audio encoders, you can set the buffer window value for voice content by using the <a href="mfpkey-wmavoice-enc-bufferwindowproperty.html">MFPKEY_WMAVOICE_ENC_BufferWindow</a> property. However, the default values should work fine in most cases.</p>
<blockquote>
<p>[!Note]<br />
Â Â Â When configuring the voice encoder, it is very important that you set the output type before you set the input type. This is the recommended order of operations for all of the audio codecs, but the voice encoder can report erroneous output types if an input is set when you call <strong>IMediaObject::GetOutputType</strong> or <strong>IMFTransform::GetOutputType</strong>.</p>
</blockquote>
<p>Â </p>
<h2>Decoding</h2>
<p>There are no special requirements for decoding voice audio. Form more information, see <a href="configuringaudiodecoding.html">Configuring Audio Decoding</a>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="workingwithaudio.html">Working with Audio</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
