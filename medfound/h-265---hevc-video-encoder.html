<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>H.265 / HEVC Video Encoder</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: The Media Foundation H.265 video encoder is a Media Foundation Transform that supports encoding content into the H.265/HEVC format.
ms.assetid: 790CFB39-6FC0-432D-A434-5262C30EABF4
title: H.265 / HEVC Video Encoder
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>H.265 / HEVC Video Encoder</h1>
<p>The Media Foundation H.265 video encoder is a <a href="media-foundation-transforms.html">Media Foundation Transform</a> that supports encoding content into the H.265/HEVC format. The encoder supports the following profiles:</p>
<ul>
<li>Main Profile</li>
</ul>
<p>The H.265 video encoder exposes the following interfaces:</p>
<ul>
<li><a href="/windows/win32/api/strmif/nn-strmif-icodecapi"><strong>ICodecAPI</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nn-mftransform-imftransform"><strong>IMFTransform</strong></a></li>
</ul>
<h2>Input Types</h2>
<p>The input media type must have one of the following subtypes:</p>
<ul>
<li><strong>MFVideoFormat_IYUV</strong></li>
<li><strong>MFVideoFormat_NV12</strong></li>
<li><strong>MFVideoFormat_YUY2</strong></li>
<li><strong>MFVideoFormat_YV12</strong></li>
</ul>
<p>For more information about these subtypes, see <a href="video-subtype-guids.html">Video Subtype GUIDs</a>.</p>
<p>The output type must be set before the input type. Until the output type is set, the encoder's <a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype"><strong>IMFTransform::SetInputType</strong></a> method returns <strong>MF_E_TRANSFORM_TYPE_NOT_SET</strong>.</p>
<h2>Output Types</h2>
<p>The encoder supports a single output subtype:</p>
<ul>
<li><strong>MFVideoFormat_H265</strong></li>
</ul>
<p>Set the following attributes on the output media type.</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->MF_MT_MAJOR_TYPE<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Major type. Must be <!-- raw HTML omitted -->MFMediaType_Video<!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->MF_MT_SUBTYPE<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Video subtype. Must be <!-- raw HTML omitted -->MFVideoFormat_HEVC<!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->MF_MT_AVG_BITRATE<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Average encoded bit rate, in bits per second. Must be greater than zero.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->MF_MT_FRAME_RATE<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Frame rate.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->MF_MT_FRAME_SIZE<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Frame size.</td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->MF_MT_INTERLACE_MODE<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Interlace mode.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->MF_MT_VIDEO_PROFILE<!-- raw HTML omitted --></td>
<td>H.265 encoding profile.<!-- raw HTML omitted --> The supported values are: <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->eAVEncH265VProfile_Main_420_8<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->MF_MT_MPEG2_LEVEL<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Specifies the level of the coded video. For more information about profile and level constraints, refer to Annex A of ITU-T H.265.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->MF_MT_PIXEL_ASPECT_RATIO<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Optional. Specifies the pixel aspect ratio. The default value is 1:1.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>After the output type is set, the video encoder updates the type by adding the <a href="mf-mt-mpeg-sequence-header-attribute.html"><strong>MF_MT_MPEG_SEQUENCE_HEADER</strong></a> attribute. This attribute contains the sequence header.</p>
<h2>Supported IMFTransform methods</h2>
<p>The following methods of the <a href="/windows/desktop/api/mftransform/nn-mftransform-imftransform"><strong>IMFTransform</strong></a> interface are supported for the H.265/HEVC encoder:</p>
<ul>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes"><strong>GetAttributes</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype"><strong>GetInputAvailableType</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputcurrenttype"><strong>GetInputCurrentType</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputstatus"><strong>GetInputStatus</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputstreaminfo"><strong>GetInputStreamInfo</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype"><strong>GetOutputAvailableType</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputcurrenttype"><strong>GetOutputCurrentType</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstatus"><strong>GetOutputStatus</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreaminfo"><strong>GetOutputStreamInfo</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getstreamcount"><strong>GetStreamCount</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getstreamlimits"><strong>GetStreamLimits</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-processevent"><strong>ProcessEvent</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-processmessage"><strong>ProcessMessage</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput"><strong>ProcessInput</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput"><strong>ProcessOutput</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype"><strong>SetInputType</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype"><strong>SetOutputType</strong></a></li>
<li><a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputbounds"><strong>SetOutputBounds</strong></a></li>
</ul>
<p>All other <a href="/windows/desktop/api/mftransform/nn-mftransform-imftransform"><strong>IMFTransform</strong></a> methods will return the error E_NOTIMPL.</p>
<h2>Supported ICodecAPI methods</h2>
<p>The following methods of the <a href="/windows/win32/api/strmif/nn-strmif-icodecapi"><strong>ICodecAPI</strong></a> interface are supported for the H.265/HEVC encoder:</p>
<ul>
<li><a href="/windows/win32/api/strmif/nf-strmif-icodecapi-issupported"><strong>IsSupported</strong></a></li>
<li><a href="/windows/win32/api/strmif/nf-strmif-icodecapi-setvalue"><strong>SetValue</strong></a></li>
<li><a href="/windows/win32/api/strmif/nf-strmif-icodecapi-getvalue"><strong>GetValue</strong></a></li>
<li><a href="/windows/win32/api/strmif/nf-strmif-icodecapi-getparameterrange"><strong>GetParameterRange</strong></a></li>
<li><a href="/windows/win32/api/strmif/nf-strmif-icodecapi-getparametervalues"><strong>GetParameterValues</strong></a></li>
</ul>
<p>All other <a href="/windows/win32/api/strmif/nn-strmif-icodecapi"><strong>ICodecAPI</strong></a> methods will return the error E_NOTIMPL.</p>
<h2>Codec Properties</h2>
<p>The H.265 encoder implements the <a href="/windows/win32/api/strmif/nn-strmif-icodecapi"><strong>ICodecAPI</strong></a> interface for setting encoding parameters. It supports the following properties.</p>
<p>For the codec requirements for HCK encoder certification, see the <strong>Certified Hardware Encoder</strong> section below.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted --><!-- raw HTML omitted -->CODECAPI_AVEncCommonRateControlMode<!-- raw HTML omitted --><!-- raw HTML omitted --></td>
<td>Sets the rate control mode. The supported modes are:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->eAVEncCommonRateControlMode_CBR<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->eAVEncCommonRateControlMode_Quality<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->If other modes are specified, the <!-- raw HTML omitted -->eAVEncCommonRateControlMode_CBR<!-- raw HTML omitted --> rate control will be used.<!-- raw HTML omitted --> This is a VT_UI4 value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->CODECAPI_AVEncCommonMeanBitRate<!-- raw HTML omitted --></td>
<td>Sets the average bit rate for the encoded bit stream, in bits per second. <!-- raw HTML omitted --> The valid range is [1 ... 2Â³Â²â€“1]. <!-- raw HTML omitted --> This is a VT_UI4 value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->CODECAPI_AVEncCommonBufferSize<!-- raw HTML omitted --></td>
<td>Sets the buffer size, in bytes, for constant bit rate (CBR) encoding.<!-- raw HTML omitted --> The valid range is [1 ... 2Â³Â²â€“1]. <!-- raw HTML omitted --> This is a VT_UI4 value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->CODECAPI_AVEncCommonMaxBitRate<!-- raw HTML omitted --></td>
<td>Sets the maximum bitrate for rate control modes that allow a peak bitrate. <!-- raw HTML omitted --> The valid range is [1 ... 2Â³Â²â€“1]. <!-- raw HTML omitted --> This is a VT_UI4 value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->CODECAPI_AVEncMPVGOPSize<!-- raw HTML omitted --></td>
<td>Sets the number of pictures from one GOP header to the next, including the leading anchor but not the following one. <!-- raw HTML omitted --> The valid range is [0 ... 2Â³Â²â€“1]. If zero, the encoder selects the GOP size. The default value is zero. <!-- raw HTML omitted --> This is a VT_UI4 value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->CODECAPI_AVLowLatencyMode<!-- raw HTML omitted --></td>
<td>Enables or disables low-latency mode. <!-- raw HTML omitted --> This is a VT_BOOL value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->CODECAPI_AVEncCommonQualityVsSpeed<!-- raw HTML omitted --></td>
<td>Sets the quality/speed tradeoff. This value affects how the encoder performs various encoding operations, such as motion compensation. At higher complexity levels, the encoder runs more slowly but produces better quality at the same bit rate. <!-- raw HTML omitted --> The valid range is 0 â€“ 100. Internally, this value is mapped to a smaller set of quality/speed levels supported by the encoder.<!-- raw HTML omitted --> This is a VT_UI4 value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->CODECAPI_AVEncVideoForceKeyFrame<!-- raw HTML omitted --></td>
<td>Forces the encoder to code the next frame as a key frame.<!-- raw HTML omitted --> This is a VT_UI4 value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->CODECAPI_AVEncVideoEncodeQP<!-- raw HTML omitted --></td>
<td>When this property is set it will cause the encoder to use the specified QP to encode the next frame and all subsequent frames until a new QP is specified. <!-- raw HTML omitted --> Valid range: 0â€“51, inclusive <!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->CODECAPI_AVEncVideoMinQP<!-- raw HTML omitted --></td>
<td>This property will set a limit on the minimum QP that the encoder can use during CBR ratecontrol.<!-- raw HTML omitted --> This is a VT_UI4 value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->CODECAPI_AVEncVideoMaxQP<!-- raw HTML omitted --></td>
<td>This property will set a limit on the maximum QP that the encoder can use during CBR ratecontrol.<!-- raw HTML omitted --> This is a VT_UI4 value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->CODECAPI_VideoEncoderDisplayContentType<!-- raw HTML omitted --></td>
<td>Sets whether the content is full-screen video, as opposed to screen content that might have a smaller window of video or have no video at all.<!-- raw HTML omitted --> This is a VT_UI4 value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->CODECAPI_AVEncNumWorkerThreads<!-- raw HTML omitted --></td>
<td>Sets the number of threads used to perform the compression operation. The encoder will divide the frame into tiles such that the number of threads equals the number of tiles.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The number of logical processors. The number of threads must be less than or equal to the number of logical processors.<!-- raw HTML omitted --><!-- raw HTML omitted -->The size of the frame. The size of a tile must bigger than or equal to 265x64 pixels.<!-- raw HTML omitted --><!-- raw HTML omitted -->Parity. The number of threads must be an even value. If the specified value is odd then the next lower even value will be used.<!-- raw HTML omitted --><!-- raw HTML omitted -->This is a VT_UI4 value.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Certified Hardware Encoder</h2>
<p>If a certified hardware encoder is present, it will generally be used instead of the inbox system encoder for Media Foundation related scenarios. Certified encoders are required to support a certain set of <strong>ICodecAPI</strong> properties and can optionally support another set of properties. The certification process should guarantee that the required properties are properly supported and, if an optional property is supported, that it is also properly supported.</p>
<p>The following is the set of required and optional <strong>ICodecAPI</strong> properties for encoders to pass the HCK encoder certification.</p>
<ul>
<li><a href="../directshow/avenccommonratecontrolmode-property.html">CODECAPI_AVEncCommonRateControlMode</a></li>
<li><a href="../directshow/avenccommonquality-property.html">CODECAPI_AVEncCommonQuality</a></li>
<li><a href="../directshow/avenccommonmeanbitrate-property.html">CODECAPI_AVEncCommonMeanBitRate</a></li>
<li><a href="../directshow/avenccommonbuffersize-property.html">CODECAPI_AVEncCommonBufferSize</a></li>
<li><a href="../directshow/avencmpvgopsize-property.html">CODECAPI_AVEncMPVGOPSize</a></li>
<li><a href="codecapi-avencvideoencodeqp.html">CODECAPI_AVEncVideoEncodeQP</a></li>
<li><a href="codecapi-avencvideoforcekeyframe.html">CODECAPI_AVEncVideoForceKeyFrame</a></li>
</ul>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ 10 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>None supported<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Mfh265enc.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="codecobjects.html">Codec Objects</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
