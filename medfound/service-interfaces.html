<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Service Interfaces</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Service Interfaces
ms.assetid: 264a0e86-49e9-4777-956b-a83e9db52a25
title: Service Interfaces
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Service Interfaces</h1>
<p>Some interfaces in Media Foundation must be obtained by calling <a href="/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice"><strong>IMFGetService::GetService</strong></a> instead of by calling <strong>QueryInterface</strong>. The <a href="/windows/desktop/api/mfidl/nn-mfidl-imfgetservice"><strong>GetService</strong></a> method works like QueryInterface, but with the following differences:</p>
<ul>
<li>It takes a service identifier GUID in addition to the interface identifier.</li>
<li>It can return a pointer to another object that implements the interface, instead of returning a pointer to the original object that is queried.</li>
</ul>
<blockquote>
<p>[!Note]<br />
The <a href="/windows/desktop/api/mfidl/nn-mfidl-imfgetservice"><strong>IMFGetService</strong></a> interface is very similar to the <strong>IServiceProvider</strong> interface used in some other APIs.</p>
</blockquote>
<p>Â </p>
<p>A <em>service</em> is a particular interface obtained from a particular class of objects through the <a href="/windows/desktop/api/mfidl/nn-mfidl-imfgetservice"><strong>IMFGetService</strong></a> interface. The following services are defined.</p>
<table>
<thead>
<tr>
<th>Service identifier</th>
<th>Interface</th>
<th>Objects that might expose this service</th>
</tr>
</thead>
<tbody>
<tr>
<td>MF_METADATA_PROVIDER_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfmetadataprovider"><strong>IMFMetadataProvider</strong></a></td>
<td>Media sources</td>
</tr>
<tr>
<td>MF_MEDIASOURCE_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfmediasource"><strong>IMFMediaSource</strong></a></td>
<td>Supported in WindowsÂ 8.1 and later.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MF_PMP_SERVER_CONTEXT</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfpmpserver"><strong>IMFPMPServer</strong></a></td>
<td>Protected media path (PMP) Media Session.</td>
</tr>
<tr>
<td>MF_QUALITY_SERVICES</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfqualityadvise"><strong>IMFQualityAdvise</strong></a></td>
<td>Media sources.</td>
</tr>
<tr>
<td>MF_RATE_CONTROL_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol"><strong>IMFRateControl</strong></a></td>
<td>Media sources, Media Session</td>
</tr>
<tr>
<td>MF_RATE_CONTROL_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfratesupport"><strong>IMFRateSupport</strong></a></td>
<td>Media sources, media sinks, Media Session</td>
</tr>
<tr>
<td>MF_REMOTE_PROXY</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfremoteproxy"><strong>IMFRemoteProxy</strong></a></td>
<td>Proxies for remote objects.</td>
</tr>
<tr>
<td>MF_SAMI_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfsamistyle"><strong>IMFSAMIStyle</strong></a></td>
<td>Synchronized Accessible Media Interchange (SAMI) media source.</td>
</tr>
<tr>
<td>MF_SOURCE_PRESENTATION_PROVIDER_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfmediasourcepresentationprovider"><strong>IMFMediaSourcePresentationProvider</strong></a></td>
<td>Sequencer source</td>
</tr>
<tr>
<td>MF_TIMECODE_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate"><strong>IMFTimecodeTranslate</strong></a></td>
<td>ASF media source.</td>
</tr>
<tr>
<td>MF_TOPONODE_ATTRIBUTE_EDITOR_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imftopologynodeattributeeditor"><strong>IMFTopologyNodeAttributeEditor</strong></a></td>
<td>Media session</td>
</tr>
<tr>
<td>MF_WRAPPED_OBJECT</td>
<td><a href="/windows/desktop/api/mfobjects/nn-mfobjects-imfbytestream"><strong>IMFByteStream</strong></a></td>
<td>Wrapped objects</td>
</tr>
<tr>
<td>MF_WRAPPED_BUFFER_SERVICE</td>
<td></td>
<td>Supported in WindowsÂ 8.1 and later.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MF_WRAPPED_SAMPLE_SERVIC</td>
<td></td>
<td>Supported in WindowsÂ 8.1 and later.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>MF_WORKQUEUE_SERVICES</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfworkqueueservices"><strong>IMFWorkQueueServices</strong></a></td>
<td>Media session</td>
</tr>
<tr>
<td>MFNET_SAVEJOB_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfsavejob"><strong>IMFSaveJob</strong></a></td>
<td>Byte streams</td>
</tr>
<tr>
<td>MFNETSOURCE_STATISTICS_SERVICE</td>
<td><strong>IPropertyStore</strong></td>
<td>Network source. Use this service to retrieve network statistics. See <a href="mfnetsource-statistics-property.html"><strong>MFNETSOURCE_STATISTICS Property</strong></a>.</td>
</tr>
<tr>
<td>MR_AUDIO_POLICY_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfaudiopolicy"><strong>IMFAudioPolicy</strong></a></td>
<td>Audio renderer</td>
</tr>
<tr>
<td>MR_BUFFER_SERVICE</td>
<td><strong>IDirect3DSurface9</strong></td>
<td>DirectX surface buffers</td>
</tr>
<tr>
<td>MR_CAPTURE_POLICY_VOLUME_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfsimpleaudiovolume"><strong>IMFSimpleAudioVolume</strong></a></td>
<td>Audio capture source</td>
</tr>
<tr>
<td>MR_POLICY_VOLUME_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfsimpleaudiovolume"><strong>IMFSimpleAudioVolume</strong></a></td>
<td>Audio renderer</td>
</tr>
<tr>
<td>MR_STREAM_VOLUME_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfaudiostreamvolume"><strong>IMFAudioStreamVolume</strong></a></td>
<td>Audio renderer</td>
</tr>
<tr>
<td>MR_VIDEO_ACCELERATION_SERVICE</td>
<td><a href="/windows/desktop/api/dxva2api/nn-dxva2api-idirect3ddevicemanager9"><strong>IDirect3DDeviceManager9</strong></a>, <a href="/windows/desktop/api/dxva2api/nn-dxva2api-idirectxvideoaccelerationservice"><strong>IDirectXVideoAccelerationService</strong></a></td>
<td>Enhanced video renderer (EVR)</td>
</tr>
<tr>
<td>MR_VIDEO_ACCELERATION_SERVICE</td>
<td><a href="/windows/desktop/api/dxva2api/nn-dxva2api-idirectxvideomemoryconfiguration"><strong>IDirectXVideoMemoryConfiguration</strong></a></td>
<td>Input pins on the DirectShow EVR filter</td>
</tr>
<tr>
<td>MR_VIDEO_ACCELERATION_SERVICE</td>
<td><a href="/windows/desktop/api/mfidl/nn-mfidl-imfvideosampleallocator"><strong>IMFVideoSampleAllocator Interface</strong></a></td>
<td>EVR stream sinks.</td>
</tr>
<tr>
<td>MR_VIDEO_MIXER_SERVICE</td>
<td>Various interfaces exposed by the EVR mixer. See <a href="using-the-video-mixer-controls.html">Using the Video Mixer Controls</a>.</td>
<td>EVR</td>
</tr>
<tr>
<td>MR_VIDEO_RENDER_SERVICE</td>
<td>Various interfaces exposed by the EVR presenter. See <a href="using-the-video-display-controls.html">Using the Video Display Controls</a>.</td>
<td>EVR</td>
</tr>
<tr>
<td>MF_ACOUSTIC_ECHO_CANCELLATION_CONTROL_SERVICE</td>
<td><a href="/windows/win32/api/audioclient/nn-audioclient-iacousticechocancellationcontrol"><strong>IAcousticEchoCancellationControl</strong></a></td>
<td>Acoustic Echo Cancellation (AEC) effects. Introduced in Windows 11, version 24H2.</td>
</tr>
<tr>
<td>MF_AUDIO_EFFECTS_MANAGER_SERVICE</td>
<td><a href="/windows/win32/api/audioclient/nn-audioclient-iaudioeffectsmanager"><strong>IAudioEffectsManager</strong></a></td>
<td>Media sources. Introduced in Windows 11, version 24H2.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<p>You must use <a href="/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice"><strong>GetService</strong></a> to get the interfaces listed in this table from the objects listed in this table.</p>
<p>In some cases, an interface is returned as a service by one class of objects, and returned through <strong>QueryInterface</strong> by another class of objects. The reference pages for each interface indicate when to use <a href="/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice"><strong>GetService</strong></a> and when to use <strong>QueryInterface</strong>.</p>
<blockquote>
<p>[!Caution]<br />
An object might be implemented in such a way that it returns a service interface through <strong>QueryInterface</strong> as well as <a href="/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice"><strong>GetService</strong></a>. However, using <strong>QueryInterface</strong> when <strong>GetService</strong> is required might lead to compatibility problems later.</p>
</blockquote>
<p>Â </p>
<p>The <a href="/windows/desktop/api/mfidl/nf-mfidl-mfgetservice"><strong>MFGetService</strong></a> function is a helper function that queries an object for <a href="/windows/desktop/api/mfidl/nn-mfidl-imfgetservice"><strong>IMFGetService</strong></a> and then calls the object's <a href="/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice"><strong>GetService</strong></a> method.</p>
<h2>Examples</h2>
<p>The following example queries the Media Session for <a href="/windows/desktop/api/mfidl/nn-mfidl-imfgetservice"><strong>IMFGetService</strong></a> and gets the <a href="/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol"><strong>IMFRateControl</strong></a> interface.</p>
<pre lang="C++"><code>IMFGetService *pGetService = NULL;
IMFRateControl *pRateControl = NULL;
HRESULT hr = S_OK;

hr = pMediaSession-&gt;QueryInterface(
    IID_IMFGetService, 
    (void**)&amp;pGetService);

if (SUCCEEDED(hr))
{
    hr = pGetService-&gt;GetService(
        MF_RATE_CONTROL_SERVICE, 
        IID_IMFRateControl,
        (void**)&amp;pRateControl);
}
if (SUCCEEDED(hr))
{
    // Use IMFRateControl. (Not shown.)
}

// Clean up.
SAFE_REELEASE(pGetService);
SAFE_RELEASE(pRateControl);
</code></pre>
<p>The following example is equivalent to the previous example but uses the <a href="/windows/desktop/api/mfidl/nf-mfidl-mfgetservice"><strong>MFGetService</strong></a> function.</p>
<pre lang="C++"><code>IMFRateControl *pRateControl = NULL;
HRESULT hr = S_OK;

hr = MFGetService(
    pMediaSession, 
    MF_RATE_CONTROL_SERVICE, 
    IID_IMFRateControl, 
    (void**) &amp;pRateCtl 
); 
if (SUCCEEDED(hr))
{
    // Use IMFRateControl. (Not shown.)
}

// Clean up.
SAFE_RELEASE(pRateControl);
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="/windows/desktop/api/mfidl/nn-mfidl-imfgetservice"><strong>IMFGetService Interface</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="media-foundation-platform-apis.html">Media Foundation Platform APIs</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
