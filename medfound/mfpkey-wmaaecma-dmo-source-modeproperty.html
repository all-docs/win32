<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MFPKEY_WMAAECMA_DMO_SOURCE_MODE Property</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Specifies whether the Voice Capture DSP uses source mode or filter mode.
ms.assetid: d1d3beba-678c-48fd-ad12-45e0418e1236
title: MFPKEY_WMAAECMA_DMO_SOURCE_MODE Property (Wmcodecdsp.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>MFPKEY_WMAAECMA_DMO_SOURCE_MODE Property</h1>
<p>Specifies whether the Voice Capture DSP uses source mode or filter mode.</p>
<h2>Constant for IPropertyBag</h2>
<p>Available only by using <a href="/windows/win32/api/propsys/nn-propsys-ipropertystore"><strong>IPropertyStore</strong></a>.</p>
<h2>Data Type</h2>
<p>VT_BOOL</p>
<h2>Default Value</h2>
<p>VARIANT_TRUE</p>
<h2>Applies To</h2>
<ul>
<li><a href="voicecapturedmo.html">Voice Capture DSP</a></li>
</ul>
<h2>Remarks</h2>
<p>In source mode, the application does not need to send input data to the DSP, because the DSP automatically pulls data from the audio devices. In filter mode, the application must send the input data to the DSP.</p>
<p>This property can have the following values.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>VARIANT_FALSE</td>
<td>Filter mode.</td>
</tr>
<tr>
<td>VARIANT_TRUE</td>
<td>Source mode.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<blockquote>
<p>[!Note]<br />
When the DMO is in source mode, you should only call <a href="/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype"><strong>IMediaObject::SetOutputType</strong></a> to set output stream format, and do not call <a href="/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype"><strong>IMediaObject::SetInputType</strong></a> to set input stream formats. Otherwise DMO initialization will fail.</p>
</blockquote>
<p>Â </p>
<p>If the value of this property is VARIANT_TRUE, the DSP has zero inputs. If the value is VARIANT_FALSE, the DSP has one or two inputs, depending on the value of the <a href="mfpkey-wmaaecma-system-modeproperty.html">MFPKEY_WMAAECMA_SYSTEM_MODE</a> property, as shown in the following table.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Number of inputs</th>
</tr>
</thead>
<tbody>
<tr>
<td>OPTIBEAM_ARRAY_AND_AEC</td>
<td>2</td>
</tr>
<tr>
<td>OPTIBEAM_ARRAY_ONLY</td>
<td>1</td>
</tr>
<tr>
<td>SINGLE_CHANNEL_AEC</td>
<td>2</td>
</tr>
<tr>
<td>SINGLE_CHANNEL_NSAGC</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Â </p>
<blockquote>
<p>[!Note]<br />
Only modes with a single input will work with the wrapper filter DMO from the DirectShow 9.0 API.</p>
</blockquote>
<p>Â </p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ Vista [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2008 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wmcodecdsp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="media-foundation-properties.html">Media Foundation Properties</a></p>
<!-- raw HTML omitted -->
<p><a href="voicecapturedmo.html">Voice Capture DSP</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
