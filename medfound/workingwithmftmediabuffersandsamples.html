<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Working with MFT Media Buffers and Samples</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Working with MFT Media Buffers and Samples
ms.assetid: dda4048e-bc4c-40ac-a6bd-34984f3717e0
title: Working with MFT Media Buffers and Samples
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Working with MFT Media Buffers and Samples</h1>
<p>Codec MFTs pass media data back and forth by using media buffers and samples.</p>
<p>A media buffer is a COM object that manages a block of memory, typically to hold media data. When data is passed to or from an MFT, it is always passed in the form of a media buffer.</p>
<p>All media buffers expose the <strong>IMFMediaBuffer</strong> interface. This interface is designed for any type of data. Buffers containing video data often also expose <strong>IMF2DBuffer</strong>.</p>
<p>A media buffer has a maximum size, which is the amount of memory allocated for the buffer. To find the maximum size, call <strong>IMFMediaBuffer::GetMaxLength</strong>. At any point in time, a media buffer also has a current length, which is the amount of valid data in the buffer, ranging from zero bytes up to the maximum size. To get the current length, call <strong>IMFMediaBuffer::GetCurrentLength</strong>. When the buffer is created, the current length is zero. If you write data to the buffer, call <strong>IMFMediaBuffer::SetCurrentLength</strong> to update the current length.</p>
<p>To access the memory in the buffer, call <strong>IMFMediaBuffer::Lock</strong>. This method returns a pointer to the start of the memory block. When you are done using the pointer, call <strong>IMFMediaBuffer::Unlock</strong>. The <strong>Lock</strong> method is not a thread synchronization mechanism; it does not guarantee that other threads cannot access the buffer. The <strong>Lock</strong> method is used to assure that the memory accessed will remain valid until you call the <strong>Unlock</strong> method.</p>
<p>A media sample object (in the context of the Media Foundation SDK) is an object that contains an ordered list of zero or more buffers. Media samples expose the <strong>IMFSample</strong> interface.</p>
<p>To create a new sample, call the <strong>MFCreateSample</strong> function. Initially, the sample's buffer list is empty. To add a buffer to the end of the list, call <strong>IMFSample::AddBuffer</strong>.</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="workingwithcodecdmos.html">Working with Codec DMOs</a></p>
<!-- raw HTML omitted -->
<p><a href="workingwithcodecmfts.html">Working with Codec MFTs</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
