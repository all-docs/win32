<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MFPKEY_WMAAECMA_FEATR_VAD Property</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Specifies the type of voice activity detection that the Voice Capture DSP performs.
ms.assetid: 59c8e348-8c08-4cf8-9c72-8d0f4fabc473
title: MFPKEY_WMAAECMA_FEATR_VAD Property (Wmcodecdsp.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>MFPKEY_WMAAECMA_FEATR_VAD Property</h1>
<p>Specifies the type of voice activity detection that the Voice Capture DSP performs.</p>
<h2>Constant for IPropertyBag</h2>
<p>Available only by using <a href="/windows/win32/api/propsys/nn-propsys-ipropertystore"><strong>IPropertyStore</strong></a>.</p>
<h2>Data Type</h2>
<p>VT_I4</p>
<h2>Default Value</h2>
<p>0</p>
<h2>Applies To</h2>
<ul>
<li><a href="voicecapturedmo.html">Voice Capture DSP</a></li>
</ul>
<h2>Remarks</h2>
<p>The value of this property is a member of the <a href="/windows/desktop/api/wmcodecdsp/ne-wmcodecdsp-aec_vad_mode">AEC_VAD_MODE</a> enumeration. The output from voice activity detection is a number from 0 to 3, calculated for each audio frame. The DSP encodes the result in the lowest bit of the first two audio samples in each audio frame. The meaning of the value depends on the specified mode.</p>
<p>The following code shows how to extract the results from the audio data. In this example, <em>pOutput</em> is a pointer to the start of an audio frame in the output data.</p>
<pre><code>int AecDecodeVAD(short *pOutput)
{
    int iVAD = (*pOutput) &amp; 0x01;
    pOutput++;
    iVAD |= (*pOutput &lt;&lt; 1) &amp; 0x02;
    return iVAD;
}
</code></pre>
<p>The default value of this property is 0 (disabled). Before setting this property, you must set the <a href="mfpkey-wmaaecma-feature-modeproperty.html">MFPKEY_WMAAECMA_FEATURE_MODE</a> property to VARIANT_TRUE.</p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<!-- raw HTML omitted --></td>
<td>WindowsÂ XP [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Minimum supported server<!-- raw HTML omitted --></td>
<td>Windows ServerÂ 2003 [desktop apps only]<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wmcodecdsp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="media-foundation-properties.html">Media Foundation Properties</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
