<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SafeRelease</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: SafeRelease
ms.assetid: 2e9af7bc-f478-4a9c-b28f-b0a72fa9ec75
title: SafeRelease
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>SafeRelease</h1>
<p>Many of the code examples in this documentation use the following function to release COM interface pointers.</p>
<pre lang="C++"><code>template &lt;class T&gt; void SafeRelease(T **ppT)
{
    if (*ppT)
    {
        (*ppT)-&gt;Release();
        *ppT = NULL;
    }
}
</code></pre>
<blockquote>
<p>[!Note]<br />
This function is not defined in an SDK header. To use this function, you must define it in your own code.</p>
</blockquote>
<p>Â </p>
<p>This function releases the pointer <em>ppT</em> and sets it equal to <strong>NULL</strong>.</p>
<p>Another option is to use a smart pointer class, such as <strong>CComPtr</strong>, which is defined in the Active Template Library (ATL).</p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="about-the-media-foundation-sdk.html">About Media Foundation</a></p>
<!-- raw HTML omitted -->
<p><a href="/windows/win32/api/unknwn/nf-unknwn-iunknown-release"><strong>IUnknown::Release</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
