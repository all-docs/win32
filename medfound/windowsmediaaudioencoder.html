<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Windows Media Audio Encoder</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: 'The Windows Media Audio encoder encodes audio streams. The encoder supports three categories of encoded output: Windows Media Audio Standard, Windows Media Audio Professional, and Windows Media Audio Lossless.'
ms.assetid: 1f6a3a9f-b534-4a6b-b773-0315c759624e
title: Windows Media Audio Encoder (Wmcodecdsp.h)
ms.topic: reference
ms.date: 05/31/2018</h2>
<h1>Windows Media Audio Encoder</h1>
<p>The Windows Media Audio encoder encodes audio streams. The encoder supports three categories of encoded output: Windows Media Audio Standard, Windows Media Audio Professional, and Windows Media Audio Lossless.</p>
<h2>Class Identifier</h2>
<p>The class identifier (CLSID) for the Windows Media Audio Encoder is represented by the constant <strong>CLSID_CWMAEncMediaObject</strong>. You can create an instance of the audio encoder by calling <strong>CoCreateInstance</strong>.</p>
<h2>Input Formats</h2>
<p>The following table shows the audio format tags that represent the input categories supported by the Windows Media Audio encoder. For information about how to set the input and output types for the encoder, see <a href="configuringaudioencoding.html">Configuring Audio Encoding</a>.</p>
<table>
<thead>
<tr>
<th>Format tag constant</th>
<th>Format tag value</th>
<th>Audio format</th>
</tr>
</thead>
<tbody>
<tr>
<td>WAVE_FORMAT_PCM</td>
<td>0x0001</td>
<td>PCM format</td>
</tr>
<tr>
<td>WAVE_FORMAT_IEEE_FLOAT</td>
<td>0x0003</td>
<td>IEEE floating point</td>
</tr>
<tr>
<td>WAVE_FORMAT_EXTENSIBLE</td>
<td>0xFFFE</td>
<td>PCM/IEEE format in <strong>WAVEFORMATEXTENSIBLE</strong> structure</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Output Formats</h2>
<p>The following table shows the audio format tags that represent the output categories supported by the Windows Media Audio encoder.</p>
<table>
<thead>
<tr>
<th>Format tag constant</th>
<th>Format tag value</th>
<th>Audio format</th>
</tr>
</thead>
<tbody>
<tr>
<td>WAVE_FORMAT_WMAUDIO2</td>
<td>0x0161</td>
<td>Windows Media Audio Standard</td>
</tr>
<tr>
<td>WAVE_FORMAT_WMAUDIO3</td>
<td>0x0162</td>
<td>Windows Media Audio Professional</td>
</tr>
<tr>
<td>WAVE_FORMAT_WMAUDIO_LOSSLESS</td>
<td>0x0163</td>
<td>Windows Media Audio Lossless</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Interfaces</h2>
<p>An audio endoder object exposes the <strong>IMediaObject</strong> interface so that the object can be used as a DirectX Media Object (DMO), and it exposes the <strong>IMFTransform</strong> interface so that the object can be used as a Media Foundation Transform (MFT).</p>
<p>A Windows Media Audio encoder behaves as a DMO or an MFT depending on which interfaces you obtain and which version of Windows is running. The following table shows the conditions under which an audio encoder behaves as a DMO or an MFT.</p>
<table>
<thead>
<tr>
<th>Operating system</th>
<th>Encoder behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows XP</td>
<td>A Windows Media Audio encoder always behaves as a DMO.</td>
</tr>
<tr>
<td>Windows Vista</td>
<td>By default, a Windows Media Audio encoder behaves as a DMO. If you obtain an <strong>IMFTransform</strong> interface or an <strong>IPropertyStore</strong> interface on an audio encoder, it behaves as an MFT.</td>
</tr>
<tr>
<td>Windows 7</td>
<td>By default, a Windows Media Audio encoder behaves as a DMO. If you obtain an <strong>IMFTransform</strong> interface on an audio encoder, it behaves as an MFT.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Encoder Properties</h2>
<p>The Windows Media Audio encoder supports the following properties.</p>
<!-- raw HTML omitted -->
<p>Â </p>
<h2>Requirements</h2>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Client<!-- raw HTML omitted --></td>
<td>WindowsÂ XP, WindowsÂ Vista or WindowsÂ 7<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Header<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wmcodecdsp.h<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>DLL<!-- raw HTML omitted --></td>
<td><!-- raw HTML omitted --> <!-- raw HTML omitted -->Wmadmoe.dll<!-- raw HTML omitted --> <!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<!-- raw HTML omitted -->
<p><a href="codecobjects.html">Codec Objects</a></p>
<!-- raw HTML omitted -->
<p><a href="codecimplementation.html">Codec Implementation</a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
