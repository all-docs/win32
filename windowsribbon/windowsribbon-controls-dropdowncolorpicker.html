<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Drop-Down Color Picker</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Drop-Down Color Picker
description: The Windows Ribbon framework provides a specialized Drop-Down Color Picker control that exposes a variety of color settings through a split button and customizable drop-down color selector.
ms.assetid: 65e1fc23-7ac0-4bb3-9359-28ce88acf356
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Drop-Down Color Picker</h1>
<p>The Windows Ribbon framework provides a specialized Drop-Down Color Picker control that exposes a variety of color settings through a split button and customizable drop-down color selector.</p>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#markup">Markup</a></li>
<li><a href="#code">Code</a>
<ul>
<li><a href="#properties">Properties</a></li>
<li><a href="#command-handlers">Command handlers</a></li>
</ul>
</li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Introduction</h2>
<p>By emulating the appearance and functionality of the Microsoft Office color picker, the Ribbon framework is able to both benefit from, and contribute to, consistency and familiarity across a wide range of applications.</p>
<h2>Markup</h2>
<p>Like all Ribbon controls, the Drop-Down Color Picker is easily implemented and customized through markup. The framework provides a number of element attributes for the Drop-Down Color Picker to expose various levels of functionality. The following table lists the Drop-Down Color Picker attributes.</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ColorTemplate</td>
<td>Layout templates that specify the type of Drop-Down Color Picker.<!-- raw HTML omitted --> There are three templates, each of which specifies a control layout and default values for associated attributes and property keys. <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->StandardColors<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->HighlightColors<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>ChipSize</td>
<td>The size of each color chip (or swatch).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Small<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Medium<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Large<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Columns</td>
<td>The number of color chip (or swatch) columns.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>CommandName</td>
<td>The name of the associated Command declaration. <!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IsAutomaticColorButtonVisible</td>
<td>Displays (or hides) the <!-- raw HTML omitted -->Automatic<!-- raw HTML omitted --> button.<!-- raw HTML omitted --> Valid only when <!-- raw HTML omitted -->ColorTemplate<!-- raw HTML omitted --> has a value of <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted --> or <!-- raw HTML omitted -->StandardColors<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>IsNoColorButtonVisible</td>
<td>Displays (or hides) the <!-- raw HTML omitted -->No color<!-- raw HTML omitted --> button.<!-- raw HTML omitted --> Valid for all <!-- raw HTML omitted -->ColorTemplate<!-- raw HTML omitted --> values.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>RecentColorGridRows</td>
<td>The number of color chip (or swatch) rows in the <!-- raw HTML omitted -->Recent colors<!-- raw HTML omitted --> area.<!-- raw HTML omitted --> Valid only when <!-- raw HTML omitted -->ColorTemplate<!-- raw HTML omitted --> has a value of <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>StandardColorGridRows</td>
<td>The number of color chip (or swatch) rows in the <!-- raw HTML omitted -->Standard colors<!-- raw HTML omitted --> area.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>ThemeColorGridRows</td>
<td>The number of color chip (or swatch) rows in the <!-- raw HTML omitted -->Theme colors<!-- raw HTML omitted --> area.<!-- raw HTML omitted --> Valid only when <!-- raw HTML omitted -->ColorTemplate<!-- raw HTML omitted --> has a value of <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>The following screen shots illustrate the default Drop-Down Color Picker layouts for the three color templates.</p>
<table>
<thead>
<tr>
<th> </th>
<th> </th>
<th> </th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ThemeColors</code>:[newline] <img src="images/markup/colortemplate.themedcolors.1.png" alt="screen shot of the dropdowncolorpicker element with the colortemplate attribute set to 'themecolors'." />[newline]</td>
<td><code>standardcolors</code>:[newline] <img src="images/markup/colortemplate.standardcolors.3.png" alt="screen shot of the dropdowncolorpicker element with the colortemplate attribute set to 'standardcolors'." />[newline]</td>
<td><code>highlightcolors</code>:[newline] <img src="images/markup/colortemplate.highlightcolors.2.png" alt="screen shot of the dropdowncolorpicker element with the colortemplate attribute set to 'highlightcolors'." /><!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<p>The basic markup required for each Drop-Down Color Picker type is demonstrated in the following examples:</p>
<blockquote>
<p>[!Note]<br />
The Drop-Down Color Picker is a valid <a href="windowsribbon-controls-button.html">Button</a> control in a <a href="windowsribbon-element-sizedefinition.html"><strong>SizeDefinition</strong></a> template.</p>
</blockquote>
<pre lang="XML"><code>&lt;!-- DropDownColorPickers --&gt;
&lt;Command Name=&quot;cmdDropDownColorPickerGroup&quot;
         Symbol=&quot;cmdDropDownColorPickerGroup&quot;
         Comment=&quot;DropDownColorPicker Group&quot;
         Id=&quot;55000&quot;/&gt;
&lt;Command Name=&quot;cmdDropDownColorPickerThemeColors&quot;
         Symbol=&quot;cmdDropDownColorPickerThemeColors&quot;
         Comment=&quot;DropDownColorPicker ThemeColors&quot;
         Id=&quot;55010&quot;
         LabelTitle=&quot;ThemeColors&quot;
         LabelDescription=&quot;ThemeColors\ndescription.&quot;/&gt;
&lt;Command Name=&quot;cmdDropDownColorPickerStandardColors&quot;
         Symbol=&quot;cmdDropDownColorPickerStandardColors&quot;
         Comment=&quot;DropDownColorPicker StandardColors&quot;
         Id=&quot;55011&quot;
         LabelTitle=&quot;StandardColors&quot;/&gt;
&lt;Command Name=&quot;cmdDropDownColorPickerHighlightColors&quot;
         Symbol=&quot;cmdDropDownColorPickerHighlightColors&quot;
         Comment=&quot;DropDownColorPicker HighlightColors&quot;
         Id=&quot;55012&quot;
         LabelTitle=&quot;HighlightColors&quot;/&gt;
</code></pre>
<pre lang="XML"><code>
&lt;Group CommandName=&amp;quot;cmdDropDownColorPickerGroup&amp;quot;
       SizeDefinition=&amp;quot;ThreeButtons&amp;quot;&gt;
  &lt;DropDownColorPicker
    CommandName=&amp;quot;cmdDropDownColorPickerThemeColors&amp;quot;
    ColorTemplate=&amp;quot;ThemeColors&amp;quot;/&gt;
  &lt;DropDownColorPicker
    CommandName=&amp;quot;cmdDropDownColorPickerStandardColors&amp;quot;
    ColorTemplate=&amp;quot;StandardColors&amp;quot;/&gt;
  &lt;DropDownColorPicker
    CommandName=&amp;quot;cmdDropDownColorPickerHighlightColors&amp;quot;
    ColorTemplate=&amp;quot;HighlightColors&amp;quot;
    StandardColorGridRows=&amp;quot;1&amp;quot;/&gt;
&lt;/Group&gt;
</code></pre>
<h2>Code</h2>
<p>As a specialized control that supports customization, any implemention of the Drop-Down Color Picker that takes advantage of these capabilities requires specialized application code to manage properties and handle any Commands issued by the control.</p>
<h3>Properties</h3>
<p>The Ribbon framework defines a collection of <a href="windowsribbon-reference-properties.html">property keys</a> for the Drop-Down Color Picker control.</p>
<p>Typically, a Drop-Down Color Picker property is updated in the ribbon UI by invalidating the Command associated with the control through a call to the <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-invalidateuicommand"><strong>IUIFramework::InvalidateUICommand</strong></a> method. The invalidation event is handled, and the property updates defined, by the <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuicommandhandler-updateproperty"><strong>IUICommandHandler::UpdateProperty</strong></a> callback method.</p>
<p>The <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuicommandhandler-updateproperty"><strong>IUICommandHandler::UpdateProperty</strong></a> callback method is not executed, and the application queried for an updated property value, until the property is required by the framework. For example, when a tab is activated and a control revealed in the ribbon UI, or when a tooltip is displayed.</p>
<blockquote>
<p>[!Note]<br />
In some cases, a property can be retrieved through the <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-getuicommandproperty"><strong>IUIFramework::GetUICommandProperty</strong></a> method and set with the <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setuicommandproperty"><strong>IUIFramework::SetUICommandProperty</strong></a> method.</p>
</blockquote>
<p>The following table lists the property keys that are associated with the Drop-Down Color Picker control.</p>
<table>
<thead>
<tr>
<th>Property Key</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_AutomaticColorLabel<!-- raw HTML omitted --></td>
<td>Defines the label for the <!-- raw HTML omitted -->Automatic<!-- raw HTML omitted --> color button.<!-- raw HTML omitted --> Only valid when <!-- raw HTML omitted -->ColorTemplate<!-- raw HTML omitted --> has a value of <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted --> or <!-- raw HTML omitted -->StandardColors<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
<td>Supports <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::GetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::SetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_Color<!-- raw HTML omitted --></td>
<td>Defines the selected color value as a <!-- raw HTML omitted -->COLORREF<!-- raw HTML omitted -->.<!-- raw HTML omitted --> Only valid when <!-- raw HTML omitted -->UI_PKEY_ColorType<!-- raw HTML omitted --> has a value of <!-- raw HTML omitted -->UI_SWATCHCOLORTYPE_RGB<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
<td>Supports <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::GetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::SetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_ColorType<!-- raw HTML omitted --></td>
<td>Defines the selected color type.<!-- raw HTML omitted --></td>
<td>Supports <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::GetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::SetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_Enabled<!-- raw HTML omitted --></td>
<td>Defines the ability for a control to respond to user interaction.<!-- raw HTML omitted --></td>
<td>Supports <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::GetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::SetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_Keytip<!-- raw HTML omitted --></td>
<td>Can only be updated through invalidation.</td>
<td></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_Label<!-- raw HTML omitted --></td>
<td>Defines the character string for a control label.<!-- raw HTML omitted --></td>
<td>Can only be updated through invalidation.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_LargeHighContrastImage<!-- raw HTML omitted --></td>
<td>Defines the large high-contrast image to display for a control.<!-- raw HTML omitted --></td>
<td>Can only be updated through invalidation.<!-- raw HTML omitted --> For more information on image formats, see <!-- raw HTML omitted -->Specifying Ribbon Image Resources<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_LargeImage<!-- raw HTML omitted --></td>
<td>Defines the large image to display for a control.<!-- raw HTML omitted --></td>
<td>Can only be updated through invalidation.<!-- raw HTML omitted --> For more information on image formats, see <!-- raw HTML omitted -->Specifying Ribbon Image Resources<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_MoreColorsLabel<!-- raw HTML omitted --></td>
<td>Defines the label for the <!-- raw HTML omitted -->More colors...<!-- raw HTML omitted --> button.<!-- raw HTML omitted --> Only valid when <!-- raw HTML omitted -->ColorTemplate<!-- raw HTML omitted --> has a value of <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted --> or <!-- raw HTML omitted -->StandardColors<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
<td>Supports <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::GetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::SetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_NoColorLabel<!-- raw HTML omitted --></td>
<td>Defines the label for the <!-- raw HTML omitted -->No color<!-- raw HTML omitted --> button.<!-- raw HTML omitted --> Valid for all <!-- raw HTML omitted -->ColorTemplate<!-- raw HTML omitted --> values.<!-- raw HTML omitted --></td>
<td>Supports <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::GetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::SetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_RecentColorsCategoryLabel<!-- raw HTML omitted --></td>
<td>Defines the label for the <!-- raw HTML omitted -->Recent colors<!-- raw HTML omitted --> category.<!-- raw HTML omitted --> Only valid when <!-- raw HTML omitted -->ColorTemplate<!-- raw HTML omitted --> has a value of <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted -->. This is the only template that contains labeled categories.<!-- raw HTML omitted --></td>
<td>Supports <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::GetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::SetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_SmallHighContrastImage<!-- raw HTML omitted --></td>
<td>Defines the small high-contrast image to display for a control.<!-- raw HTML omitted --></td>
<td>Can only be updated through invalidation.<!-- raw HTML omitted --> For more information on image formats, see <!-- raw HTML omitted -->Specifying Ribbon Image Resources<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_SmallImage<!-- raw HTML omitted --></td>
<td>Defines the small image to display for a control.<!-- raw HTML omitted --></td>
<td>Can only be updated through invalidation.<!-- raw HTML omitted --> For more information on image formats, see <!-- raw HTML omitted -->Specifying Ribbon Image Resources<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="windowsribbon-reference-properties-uipkey-standardcolors.html">UI_PKEY_StandardColors</a></td>
<td>Defines an array of <a href="/windows/win32/gdi/colorref">COLORREF</a> values for the swatches of a Drop-Down Color Picker.<!-- raw HTML omitted --> Each Drop-Down Color Picker <strong>ColorTemplate</strong> contains a <!-- raw HTML omitted -->StandardColors<!-- raw HTML omitted --> grid. <!-- raw HTML omitted --> <strong>Note:</strong> The <a href="/windows/win32/gdi/colorref">COLORREF</a> values from the initial <strong>StandardColorGridRows</strong> x <strong>Columns</strong> of the array are displayed. If the array defines fewer colors than the number of <!-- raw HTML omitted -->StandardColors<!-- raw HTML omitted --> swatches declared in markup, empty spaces are displayed for the missing chips.<!-- raw HTML omitted --></td>
<td>Supports <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-getuicommandproperty"><strong>IUIFramework::GetUICommandProperty</strong></a> and <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setuicommandproperty"><strong>IUIFramework::SetUICommandProperty</strong></a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_StandardColorsCategoryLabel<!-- raw HTML omitted --></td>
<td>Defines the label for the <!-- raw HTML omitted -->Standard colors<!-- raw HTML omitted --> category.<!-- raw HTML omitted --> Only valid when <!-- raw HTML omitted -->ColorTemplate<!-- raw HTML omitted --> has a value of <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted -->. This is the only template that contains labeled categories.<!-- raw HTML omitted --></td>
<td>Supports <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::GetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::SetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><a href="windowsribbon-reference-properties-uipkey-standardcolorstooltips.html">UI_PKEY_StandardColorsTooltips</a></td>
<td>Defines a string array of color swatch tooltips for the <!-- raw HTML omitted -->StandardColors<!-- raw HTML omitted --> grid.<!-- raw HTML omitted --> Each Drop-Down Color Picker <strong>ColorTemplate</strong> contains a <!-- raw HTML omitted -->StandardColors<!-- raw HTML omitted --> grid. <!-- raw HTML omitted --> <strong>Note:</strong> Only those tool tips required to label the color swatches displayed in the <!-- raw HTML omitted -->StandardColors<!-- raw HTML omitted --> grid are used. If fewer labels are supplied than the number of swatches in the <!-- raw HTML omitted -->StandardColors<!-- raw HTML omitted --> grid, a default is provided for the remainining swatches.<!-- raw HTML omitted --></td>
<td>Supports <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-getuicommandproperty"><strong>IUIFramework::GetUICommandProperty</strong></a> and <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setuicommandproperty"><strong>IUIFramework::SetUICommandProperty</strong></a>.</td>
</tr>
<tr>
<td><a href="windowsribbon-reference-properties-uipkey-themecolors.html">UI_PKEY_ThemeColors</a></td>
<td>Defines an array of <a href="/windows/win32/gdi/colorref">COLORREF</a> values for the swatches of a Drop-Down Color Picker.<!-- raw HTML omitted --> Only valid when <strong>ColorTemplate</strong> has a value of <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted -->. <!-- raw HTML omitted --> <strong>Note:</strong> The <a href="/windows/win32/gdi/colorref">COLORREF</a> values from the initial <strong>ThemeColorGridRows</strong> x <strong>Columns</strong> of the array are displayed. If the array defines fewer colors than the number of <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted --> swatches declared in markup, empty spaces are displayed for the missing chips.<!-- raw HTML omitted --></td>
<td>Supports <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-getuicommandproperty"><strong>IUIFramework::GetUICommandProperty</strong></a> and <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setuicommandproperty"><strong>IUIFramework::SetUICommandProperty</strong></a>.</td>
</tr>
<tr>
<td><a href="windowsribbon-reference-properties-uipkey-themecolorstooltips.html">UI_PKEY_ThemeColorsTooltips</a></td>
<td>Defines the string array of color swatch tooltips for the <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted --> grid.<!-- raw HTML omitted --> Only valid when <strong>ColorTemplate</strong> has a value of <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted -->. <!-- raw HTML omitted --> <strong>Note:</strong> Only those tool tips required to label the color swatches displayed in the <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted --> grid are used. If fewer labels are supplied than the number of swatches in the <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted --> grid, a default is provided for the remainining swatches.<!-- raw HTML omitted --></td>
<td>Supports <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-getuicommandproperty"><strong>IUIFramework::GetUICommandProperty</strong></a> and <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setuicommandproperty"><strong>IUIFramework::SetUICommandProperty</strong></a>.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_ThemeColorsCategoryLabel<!-- raw HTML omitted --></td>
<td>Defines the label for the <!-- raw HTML omitted -->Theme colors<!-- raw HTML omitted --> category.<!-- raw HTML omitted --> Only valid when <!-- raw HTML omitted -->ColorTemplate<!-- raw HTML omitted --> has a value of <!-- raw HTML omitted -->ThemeColors<!-- raw HTML omitted -->. This is the only template that contains labeled categories.<!-- raw HTML omitted --></td>
<td>Supports <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::GetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted --> and <!-- raw HTML omitted --><!-- raw HTML omitted -->IUIFramework::SetUICommandProperty<!-- raw HTML omitted --><!-- raw HTML omitted -->.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_TooltipDescription<!-- raw HTML omitted --></td>
<td>Defines the character string for a tooltip description associated with a <!-- raw HTML omitted -->UI_PKEY_TooltipTitle<!-- raw HTML omitted -->.<!-- raw HTML omitted --></td>
<td>Can only be updated through invalidation.</td>
</tr>
<tr>
<td><!-- raw HTML omitted -->UI_PKEY_TooltipTitle<!-- raw HTML omitted --></td>
<td>Defines the character string for a Command tooltip.<!-- raw HTML omitted --></td>
<td>Can only be updated through invalidation.</td>
</tr>
</tbody>
</table>
<h3>Command handlers</h3>
<p>The <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuicommandhandler-updateproperty"><strong>IUICommandHandler::UpdateProperty</strong></a> method is used to customize a Drop-Down Color Picker through the property keys listed above. The following example demonstrates how to set the color swatches of a Drop-Down Color Picker, based on a custom style preference or a custom swatch grid that is declared in markup.</p>
<pre lang="C++"><code>STDMETHODIMP DropDownColorPickerHandler::UpdateProperty(
              UINT nCmdID,
              __in REFPROPERTYKEY key,
              __in_opt const PROPVARIANT* ppropvarCurrentValue,
              __out PROPVARIANT* ppropvarNewValue)
{
  HRESULT hr = E_NOTIMPL;
  if (key == UI_PKEY_ThemeColors)
  {
    COLORREF rThemeColors[TOT_THEME_COLORS];
    for (LONG i = 0; i &lt; ARRAYSIZE(rThemeColors); i++)
    {
      // any COLORREF
      rThemeColors[i] = RGB(0, 255, 0); 
    }
    hr = InitPropVariantFromUInt32Vector(
           &amp;rThemeColors, ARRAYSIZE(rThemeColors), ppropvarNewValue);
  }

  else if (key == UI_PKEY_StandardColors)
  {
    ULONG rStandardColors[TOT_STANDARD_COLORS];
    for (LONG i = 0; i &lt; ARRAYSIZE(rStandardColors); i++)
    {
      // any COLORREF
      rStandardColors[i] = RGB(255, 0, 0); 
    }
    hr = InitPropVariantFromUInt32Vector(
           &amp;rStandardColors, ARRAYSIZE(rStandardColors),ppropvarNewValue);
  }

  else if (key == UI_PKEY_ThemeColorsTooltips)
  {
    BSTR rThemeTooltips[TOT_THEME_COLORS];
    for (LONG i = 0; i &lt; ARRAYSIZE(rThemeTooltips); i++)
    {
      // any constant character string
      rThemeTooltips[i] = L&quot;Green&quot;; 
    }
    hr = InitPropVariantFromStringVector((PCWSTR *)&amp;rThemeTooltips, 50, ppropvarNewValue);
  }
  else if (key == UI_PKEY_StandardColorsTooltips)
  {
    static BSTR rStandardTooltips[TOT_STANDARD_COLORS];
    for (LONG i = 0; i &lt; ARRAYSize(rStandardTooltips); i++)
    {
      // any constant character string
      rStandardTooltips[i] = L&quot;Red&quot;; 
    }
    hr = InitPropVariantFromStringVector(
           (PCWSTR *)&amp;rStandardTooltips, 20, ppropvarNewValue);
  }
  return hr;
}
</code></pre>
<p>The following example demonstrates an implementation of the <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuicommandhandler-execute"><strong>IUICommandHandler::Execute</strong></a> method that exposes the Drop-Down Color Picker swatch colors to the Ribbon application.</p>
<pre lang="C++"><code>STDMETHODIMP DropDownColorPickerHandler::Execute(
                 UINT nCmdID,
                 UI_EXECUTIONVERB verb,
                 __in_opt const PROPERTYKEY* key,
                 __in_opt const PROPVARIANT* ppropvarValue,
                 __in_opt IUISimplePropertySet* pCommandExecutionProperties)
{
  HRESULT hr = E_NOTIMPL;
  if (*key == UI_PKEY_ColorType)
  {
    UI_SWATCHCOLORTYPE uType = 
      (UI_SWATCHCOLORTYPE)PropVariantToUInt32WithDefault(
        *ppropvarValue, 
        UI_SWATCHCOLORTYPE_NOCOLOR);

    COLORREF color;
    switch(uType)
    {
      case UI_SWATCHCOLORTYPE_RGB:
        PROPVARIANT var;
        pCommandExecutionProperties-&gt;GetValue(UI_PKEY_Color, &amp;var);
        color = PropVariantToUInt32WithDefault(var, 0);
        break;
      case UI_SWATCHCOLORTYPE_AUTOMATIC:
        color = COLOR_WINDOWTEXT;
        break;
      case UI_SWATCHCOLORTYPE_NOCOLOR:
        color = MSONoFill;
        break;
    }

    // do with your color what you will...
    gInternalColor = color;
    hr = S_OK;
  }
  return hr;
}
</code></pre>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="windowsribbon-controls-entry.html">Windows Ribbon Framework Control Library</a></p>
<!-- raw HTML omitted -->
<p><a href="windowsribbon-element-dropdowncolorpicker.html"><strong>DropDownColorPicker markup element</strong></a></p>
<!-- raw HTML omitted -->
<p><a href="windowsribbon-reference-properties-colorpicker.html">Color Picker Properties</a></p>
<!-- raw HTML omitted -->
<p><a href="windowsribbon-templates.html">Customizing a Ribbon Through Size Definitions and Scaling Policies</a></p>
<!-- raw HTML omitted -->
<p><a href="windowsribbon-dropdowncolorpickersample.html">DropDownColorPicker Sample</a></p>
<!-- raw HTML omitted -->
</body>
