<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Application Menu</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>title: Application Menu
description: The Application Menu is the main menu for an application that implements the Windows Ribbon framework.
ms.assetid: 5be93a5b-277b-44c1-be24-a0598a140bfc
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Application Menu</h1>
<p>The Application Menu is the main menu for an application that implements the Windows Ribbon framework.</p>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#components-of-the-application-menu">Components of the Application Menu</a>
<ul>
<li><a href="#application-menu-menugroup">Application Menu MenuGroup</a></li>
</ul>
</li>
<li><a href="#sizing-the-application-menu">Sizing the Application Menu</a></li>
<li><a href="#application-menu-properties">Application Menu Properties</a></li>
<li><a href="#related-topics">Related topics</a></li>
</ul>
<h2>Introduction</h2>
<p>The Application Menu is composed of a drop-down button control that displays a menu containing Commands that expose functionality related to a complete project, such as an entire document, picture, or movie. Examples include the <strong>New</strong>, <strong>Open</strong>, <strong>Save</strong>, and <strong>Exit</strong> Commands.</p>
<p>The following screen shot illustrates the Application Menu.</p>
<p><img src="images/controls/recentitems.png" alt="screen shot of the application menu and recent items list of the paint for windows 7 ribbon." /></p>
<h2>Components of the Application Menu</h2>
<p>The Application Menu is a mandatory element in any Ribbon application. The entry point into the Application Menu is a distinctive button that appears as the first item in the <a href="windowsribbon-controls-tab.html">Tab</a> row, as shown in the following screen shot.</p>
<blockquote>
<p>[!Note]<br />
WindowsÂ 8 and newer: Application Menu button image changed to label: <strong>File</strong>. We recommend that you do not use File as the label for any of your own tabs.</p>
</blockquote>
<p>Â </p>
<p><img src="images/overviews/applicationmenu-button.png" alt="screen shot of the application menu button of wordpad for windows 7." /></p>
<p>When clicked, this button displays the rich menu that is shown in the following screen shot (the Application Menu from WordPad for WindowsÂ 7).</p>
<p><img src="images/overviews/applicationmenu-menu.png" alt="screen shot of the application menu menu of wordpad for windows 7." /></p>
<blockquote>
<p>[!Note]<br />
There is no impact on the tab set when the Application Menu button is clicked; instead, the focus enters the menu.</p>
</blockquote>
<p>Â </p>
<p>The Application Menu contains two panes: a list of Commands represented by one or more <a href="windowsribbon-element-menugroup.html"><strong>MenuGroup</strong></a> elements, and a <a href="windowsribbon-controls-recentitems.html">Recent Items</a> list represented by an <a href="windowsribbon-element-applicationmenu-recentitems.html"><strong>ApplicationMenu.RecentItems</strong></a> element.</p>
<h3>Application Menu MenuGroup</h3>
<p>The <a href="windowsribbon-element-applicationmenu.html"><strong>ApplicationMenu</strong></a> element must contain at least one <a href="windowsribbon-element-menugroup.html"><strong>MenuGroup</strong></a> child element that exposes a list of application-level commands. If multiple <strong>MenuGroup</strong> elements are declared, a divider line is drawn between the groups, as shown in the following screen shot.</p>
<p><img src="images/overviews/applicationmenu-menugroup.png" alt="screen shot of an application menu menugroup." /></p>
<p>The following is a list of constraints for a <a href="windowsribbon-element-menugroup.html"><strong>MenuGroup</strong></a> element of an Application Menu:</p>
<ul>
<li>
<p>All <a href="windowsribbon-element-menugroup.html"><strong>MenuGroup</strong></a> items must be declared with a <em>Class</em> attribute value of <code>MajorItems</code>.</p>
</li>
<li>
<p>An Application MenuÂ <a href="windowsribbon-element-menugroup.html"><strong>MenuGroup</strong></a> supports only the <a href="windowsribbon-controls-button.html">Button</a>, <a href="windowsribbon-controls-dropdownbutton.html">Drop-Down Button</a>, <a href="windowsribbon-controls-splitbutton.html">Split Button</a>, <a href="windowsribbon-controls-dropdowngallery.html">Drop-Down Gallery</a>, and <a href="windowsribbon-controls-splitbuttongallery.html">Split Button Gallery</a> controls.</p>
<blockquote>
<p>![Important]<br />
Command galleries are the only type of gallery that are supported in the Application Menu. See <a href="./ribbon-controls-galleries.html">Working with Galleries</a>, for more information on gallery controls.</p>
</blockquote>
<p>Â </p>
</li>
</ul>
<p>When a <a href="windowsribbon-controls-button.html">Button</a> is used in a <a href="windowsribbon-element-menugroup.html"><strong>MenuGroup</strong></a>, the value of <a href="windowsribbon-element-command-labeltitle.html"><strong>Command.LabelTitle</strong></a> is displayed in the menu and the values of <a href="windowsribbon-element-command-tooltiptitle.html"><strong>Command.TooltipTitle</strong></a> and <a href="windowsribbon-element-command-tooltipdescription.html"><strong>Command.TooltipDescription</strong></a> are displayed as the tooltip, as shown in the following screen shot.</p>
<p><img src="images/overviews/applicationmenu-menubutton.png" alt="screen shot of a button control in an application menu." /></p>
<p>When a <a href="windowsribbon-controls-dropdownbutton.html">Drop-Down Button</a>, <a href="windowsribbon-controls-splitbutton.html">Split Button</a>, <a href="windowsribbon-controls-dropdowngallery.html">Drop-Down Gallery</a>, or <a href="windowsribbon-controls-splitbuttongallery.html">Split Button Gallery</a> is used in the Application Menu, the menu portion is displayed as a flyout that covers and conceals the <strong>Recent items</strong> pane.</p>
<p>For <a href="windowsribbon-controls-splitbutton.html">Split Button</a> and <a href="windowsribbon-controls-dropdownbutton.html">Drop-Down Button</a> controls, the value of <a href="windowsribbon-element-command-labeldescription.html"><strong>Command.LabelDescription</strong></a> is shown inline in the flyout menu to visually assist users with discovering the Command functionality. The displayed value of <strong>Command.LabelDescription</strong> is programmatically broken over a two-line span, and an attempt is made to fit the value exactly over the <strong>Recent items</strong> pane beneath. If the <strong>Command.LabelDescription</strong> value does not fit, the flyout will expand to accommodate the longest <a href="windowsribbon-element-command-comment.html"><strong>Command.Comment</strong></a> value in the <a href="windowsribbon-element-menugroup.html"><strong>MenuGroup</strong></a>.</p>
<p>The following screen shot illustrates these behaviors in a <a href="windowsribbon-controls-splitbutton.html">Split Button</a> flyout.</p>
<p><img src="images/overviews/applicationmenu-menuflyout.png" alt="screen shot of a list control flyout in an application menu." /></p>
<p>With a <a href="windowsribbon-controls-dropdowngallery.html">Drop-Down Gallery</a> and a <a href="windowsribbon-controls-splitbuttongallery.html">Split Button Gallery</a>, only a label and an image are shown.</p>
<h2>Sizing the Application Menu</h2>
<p>Sizing of the Application Menu is handled by the Ribbon framework. If very long strings are supplied for the value of <a href="windowsribbon-element-command-labeltitle.html"><strong>Command.LabelTitle</strong></a> or <a href="windowsribbon-element-command-labeldescription.html"><strong>Command.LabelDescription</strong></a>, or a long list of Commands is used, the menu will adjust its size to accommodate the contents. Some forms of adjustment include expanding the size of flyouts or menu panes, and adding pan viewers when scrolling is required.</p>
<h2>Application Menu Properties</h2>
<p>The Ribbon framework defines a collection of <a href="windowsribbon-reference-properties.html">property keys</a> for the Application Menu control.</p>
<p>Typically, an Application Menu property is updated in the ribbon UI by invalidating the Command associated with the control through a call to the <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-invalidateuicommand"><strong>IUIFramework::InvalidateUICommand</strong></a> method. The invalidation event is handled and the property updates are defined by the <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuicommandhandler-updateproperty"><strong>IUICommandHandler::UpdateProperty</strong></a> callback method.</p>
<p>The <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuicommandhandler-updateproperty"><strong>IUICommandHandler::UpdateProperty</strong></a> callback method is not executed and the application is not queried for an updated property value until the property is required by the framework. For example, the framework requires the property when a tab is activated and a control is revealed in the ribbon UI, or when a tooltip is displayed.</p>
<table>
<thead>
<tr>
<th>Property key</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="windowsribbon-reference-properties-uipkey-tooltipdescription.html">UI_PKEY_TooltipDescription</a></td>
<td>Can only be updated through invalidation.</td>
</tr>
<tr>
<td><a href="windowsribbon-reference-properties-uipkey-tooltiptitle.html">UI_PKEY_TooltipTitle</a></td>
<td>Can only be updated through invalidation.</td>
</tr>
</tbody>
</table>
<p>Â </p>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="windowsribbon-controls-entry.html">Windows Ribbon Framework Control Library</a></p>
<!-- raw HTML omitted -->
<p><a href="windowsribbon-element-applicationmenu.html"><strong>ApplicationMenu markup element</strong></a></p>
<!-- raw HTML omitted -->
<p>Â </p>
<p>Â </p>
</body>
