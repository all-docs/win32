<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Listening for Ribbon Events</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Listening for Ribbon Events
description: The Windows Ribbon framework uses the Event Tracing for Windows (ETW) infrastructure to enable developers to learn how users are interacting with their application's ribbon.
ms.assetid: F29A8E41-C902-410E-BD28-653E078320E9
keywords:</p>
<ul>
<li>Windows Ribbon,events</li>
<li>Ribbon,events
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Listening for Ribbon Events</h1>
<p>The Windows Ribbon framework uses the <a href="../etw/event-tracing-portal.html">Event Tracing for Windows (ETW)</a> infrastructure to enable developers to learn how users are interacting with their application's ribbon.</p>
<h2>Introduction</h2>
<p>The Ribbon framework event mechanism is designed such that the framework reports ribbon UI events to the application so you can monitor user activity, learn their interaction patterns, and assess usage trends. This information can be used to refine the user experience for future iterations of your ribbon app.</p>
<p>Using the Ribbon framework events involves the following:</p>
<ol>
<li>The ribbon application must register an <a href="../etw/event-tracing-portal.html">Event Tracing for Windows (ETW)</a> listener to receive ribbon event notifications from the Ribbon framework.</li>
<li>The Ribbon framework fires ribbon UI event callbacks at run time, if the application has registered an <a href="../etw/event-tracing-portal.html">Event Tracing for Windows (ETW)</a> listener.</li>
</ol>
<h2>Supported events</h2>
<p>The events exposed to ribbon applications are described in the following table.</p>
<table>
<thead>
<tr>
<th>Event</th>
<th>Event report</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tab activated</td>
<td>Command ID<!-- raw HTML omitted --> Command name<!-- raw HTML omitted --> Event verb<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Contextual tab activated</td>
<td>Command ID<!-- raw HTML omitted --> Command name<!-- raw HTML omitted --> Event verb<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Application Menu opened</td>
<td>Event verb<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Application Menu closed</td>
<td>Event verb<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Menu (regular or gallery) opened</td>
<td>Command ID<!-- raw HTML omitted --> Command name<!-- raw HTML omitted --> Event verb<!-- raw HTML omitted --> <strong>Note:</strong> QAT menu events are not exposed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Menu (regular or gallery) closed</td>
<td>Command ID<!-- raw HTML omitted --> Command name<!-- raw HTML omitted --> Event verb<!-- raw HTML omitted --> <strong>Note:</strong> QAT menu events are not exposed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Command</td>
<td>Command ID<!-- raw HTML omitted --> Command name<!-- raw HTML omitted --> Event verb<!-- raw HTML omitted --> One of the following event locations:<!-- raw HTML omitted -->- RIBBON<!-- raw HTML omitted -->- QUICKACCESSTOOLBAR<!-- raw HTML omitted -->- APPLICATIONMENU<!-- raw HTML omitted -->- CONTEXTPOPUP<!-- raw HTML omitted --> Parent Command ID<!-- raw HTML omitted --> Parent Command name<!-- raw HTML omitted --> One of the following invoke methods:<!-- raw HTML omitted -->- CLICK<!-- raw HTML omitted -->- KEYTIP<!-- raw HTML omitted -->- KEYBOARD<!-- raw HTML omitted -->- TOUCH<!-- raw HTML omitted --> <strong>Note:</strong> Item galleries and combo boxes include the selected item index but do not include string and integer values. Spinners do not include the integer value.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Ribbon minimized</td>
<td>Event verb<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Ribbon expanded (expand button clicked or tap pinned)</td>
<td>Event verb<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Application mode switched</td>
<td>Event verb<!-- raw HTML omitted --> Mode ID (value set through <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes"><strong>SetModes</strong></a>)<!-- raw HTML omitted --> <strong>Note:</strong> The application is responsible for unpacking this integer to determine which modes were set.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Tooltip displayed</td>
<td>Event verb<!-- raw HTML omitted --> Parent Command ID<!-- raw HTML omitted --> Parent Command name<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Related topics</h2>
<!-- raw HTML omitted -->
<p><a href="windowsribbon-guides-entry.html">Windows Ribbon Framework Developer Guides</a></p>
<!-- raw HTML omitted -->
<p><a href="./windowsribbon-schema.html">Declaring Commands and Controls with Ribbon Markup</a></p>
<!-- raw HTML omitted -->
<p><a href="https://msdn.microsoft.com/library/cc872782.aspx">Ribbon User Experience Guidelines</a></p>
<!-- raw HTML omitted -->
<p><a href="https://msdn.microsoft.com/library/cc872781.aspx">Ribbon Design Process</a></p>
<!-- raw HTML omitted -->
</body>
