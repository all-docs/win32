<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Security Management Functions</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<h2>description: Lists support functions provided by the Security Configuration tool set.
ms.assetid: 5a771014-1706-490f-8540-ec516652cb83
title: Security Management Functions
ms.topic: article
ms.date: 05/31/2018</h2>
<h1>Security Management Functions</h1>
<p>This section contains topics for the following groups of functions:</p>
<ul>
<li><a href="#attachment-callback-functions">Attachment Callback Functions</a></li>
<li><a href="#attachment-engine-functions">Attachment Engine Functions</a></li>
<li><a href="#lsa-policy-functions">LSA Policy Functions</a>
<ul>
<li><a href="#lsa-policy-functions">Policy Functions</a></li>
<li><a href="#account-functions">Account Functions</a></li>
<li><a href="#trusted-domain-functions">Trusted Domain Functions</a></li>
<li><a href="#private-data-functions">Private Data Functions</a></li>
<li><a href="#miscellaneous-functions">Miscellaneous Functions</a></li>
</ul>
</li>
<li><a href="#managed-service-account-functions">Managed Service Account Functions</a></li>
<li><a href="#password-filter-functions">Password Filter Functions</a></li>
<li><a href="#safer-functions">Safer Functions</a></li>
</ul>
<h2>Attachment Callback Functions</h2>
<p>The following support functions are provided by the Security Configuration tool set and may be used by attachment engines and extension snap-ins to read and write configuration data.</p>
<table>
<thead>
<tr>
<th>Callback function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/win32/api/scesvc/nc-scesvc-pfsce_free_info"><strong>PFSCE_FREE_INFO</strong></a><!-- raw HTML omitted --></td>
<td>Used to free memory allocated by these support functions.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/scesvc/nc-scesvc-pfsce_log_info"><strong>PFSCE_LOG_INFO</strong></a><!-- raw HTML omitted --></td>
<td>Used to log message to the configuration log file or analysis log file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/scesvc/nc-scesvc-pfsce_query_info"><strong>PFSCE_QUERY_INFO</strong></a><!-- raw HTML omitted --></td>
<td>Used to query the configuration and analysis information for a specific service.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/win32/api/scesvc/nc-scesvc-pfsce_set_info"><strong>PFSCE_SET_INFO</strong></a><!-- raw HTML omitted --></td>
<td>Used to set configuration and analysis information for a specific service.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Attachment Engine Functions</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="scesvcattachmentanalyze.html"><strong>SceSvcAttachmentAnalyze</strong></a><!-- raw HTML omitted --></td>
<td>Implemented by the attachment engine DLL. The Security Configuration Engine calls this function when the system is analyzed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="scesvcattachmentconfig.html"><strong>SceSvcAttachmentConfig</strong></a><!-- raw HTML omitted --></td>
<td>Implemented by the attachment engine DLL. The Security Configuration Engine calls this function when the system is configured.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="scesvcattachmentupdate.html"><strong>SceSvcAttachmentUpdate</strong></a><!-- raw HTML omitted --></td>
<td>Implemented by the attachment engine DLL. The Security Configuration Engine calls this function when it receives a configuration update request from the attachment snap-in extension.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>LSA Policy Functions</h2>
<p>The following topics provide reference information for the <a href="/windows/desktop/SecGloss/l-gly"><em>Local Security Authority</em></a> (LSA) Policy functions.</p>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Policy Functions<!-- raw HTML omitted --></td>
<td>Details functions used to open the local <a href="policy-object.html"><strong>Policy</strong></a> object and to set or retrieve global policy information.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Account Functions<!-- raw HTML omitted --></td>
<td>Details functions used to manage account permissions and to create and delete user accounts.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Trusted Domain Functions<!-- raw HTML omitted --></td>
<td>Details functions used to create and delete trusted domain relationships and to set and retrieve information about those trusted domains.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Private Data Functions<!-- raw HTML omitted --></td>
<td>Do not use the LSA private data functions. Instead, use the <a href="/windows/desktop/api/dpapi/nf-dpapi-cryptprotectdata"><strong>CryptProtectData</strong></a> and <a href="/windows/desktop/api/dpapi/nf-dpapi-cryptunprotectdata"><strong>CryptUnprotectData</strong></a> functions.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td>Miscellaneous Functions<!-- raw HTML omitted --></td>
<td>Details functions not described elsewhere.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Policy Functions</h3>
<p>The following functions enumerate user accounts and trusted domains, receive policy change notifications, and lookup account names and SIDs.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaenumerateaccountswithuserright"><strong>LsaEnumerateAccountsWithUserRight</strong></a><!-- raw HTML omitted --></td>
<td>Enumerates all the accounts that have a specified user permission.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaenumeratetrusteddomainsex"><strong>LsaEnumerateTrustedDomainsEx</strong></a><!-- raw HTML omitted --></td>
<td>Enumerates the trusted domains.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsalookupnames"><strong>LsaLookupNames</strong></a><!-- raw HTML omitted --></td>
<td>Maps the specified names to their SIDs. Returns the SID as an RID/Domain SID pair.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsalookupnames2"><strong>LsaLookupNames2</strong></a><!-- raw HTML omitted --></td>
<td>Maps the specified names to their SIDs. Returns the SID as a single element.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/ntlsa/nf-ntlsa-lsalookupprivilegevalue"><strong>LsaLookupPrivilegeValue</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves the <a href="/windows/desktop/SecGloss/l-gly"><em>locally unique identifier</em></a> (LUID) used by the <a href="/windows/desktop/SecGloss/l-gly"><em>Local Security Authority</em></a> (LSA) to represent the specified privilege name.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsalookupsids"><strong>LsaLookupSids</strong></a><!-- raw HTML omitted --></td>
<td>Maps the specified account names to their SIDs.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaregisterpolicychangenotification"><strong>LsaRegisterPolicyChangeNotification</strong></a><!-- raw HTML omitted --></td>
<td>Registers an event object to receive notifications when the local policy information changes.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaunregisterpolicychangenotification"><strong>LsaUnregisterPolicyChangeNotification</strong></a><!-- raw HTML omitted --></td>
<td>Unregisters an event object that is receiving policy change notifications.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Account Functions</h3>
<p>The following functions add, enumerate, and delete permissions for an account.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaaddaccountrights"><strong>LsaAddAccountRights</strong></a><!-- raw HTML omitted --></td>
<td>Add permissions to an account. If the account does not already exist, it is created.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaenumerateaccountrights"><strong>LsaEnumerateAccountRights</strong></a><!-- raw HTML omitted --></td>
<td>Enumerate the permissions granted to an account.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaremoveaccountrights"><strong>LsaRemoveAccountRights</strong></a><!-- raw HTML omitted --></td>
<td>Remove permissions from an account. When all the permissions are removed, the account is deleted.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Trusted Domain Functions</h3>
<p>The following functions create, enumerate, and delete trusted domains and set and retrieve trusted domain information.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsacreatetrusteddomainex"><strong>LsaCreateTrustedDomainEx</strong></a><!-- raw HTML omitted --></td>
<td>Creates a new <a href="trusteddomain-object.html"><strong>TrustedDomain</strong></a> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsadeletetrusteddomain"><strong>LsaDeleteTrustedDomain</strong></a><!-- raw HTML omitted --></td>
<td>Removes a <a href="trusteddomain-object.html"><strong>TrustedDomain</strong></a> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaenumeratetrusteddomains"><strong>LsaEnumerateTrustedDomains</strong></a><!-- raw HTML omitted --> <a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaenumeratetrusteddomainsex"><strong>LsaEnumerateTrustedDomainsEx</strong></a><!-- raw HTML omitted --></td>
<td>Enumerates the domains currently trusted by the local system.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaopentrusteddomainbyname"><strong>LsaOpenTrustedDomainByName</strong></a><!-- raw HTML omitted --></td>
<td>Opens a handle to a <a href="trusteddomain-object.html"><strong>TrustedDomain</strong></a> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaquerytrusteddomaininfo"><strong>LsaQueryTrustedDomainInfo</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves information about a trusted domain. The domain is specified by SID.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaquerytrusteddomaininfobyname"><strong>LsaQueryTrustedDomainInfoByName</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves information about a trusted domain. The domain is specified by name.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsasettrusteddomaininfobyname"><strong>LsaSetTrustedDomainInfoByName</strong></a><!-- raw HTML omitted --></td>
<td>Sets information for a trusted domain. The domain is specified by name.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsasettrusteddomaininformation"><strong>LsaSetTrustedDomainInformation</strong></a><!-- raw HTML omitted --></td>
<td>Sets information for a trusted domain. The domain is specified by SID.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Private Data Functions</h3>
<p>Do not use the LSA private data functions. Instead, use the <a href="/windows/desktop/api/dpapi/nf-dpapi-cryptprotectdata"><strong>CryptProtectData</strong></a> and <a href="/windows/desktop/api/dpapi/nf-dpapi-cryptunprotectdata"><strong>CryptUnprotectData</strong></a> functions.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaretrieveprivatedata"><strong>LsaRetrievePrivateData</strong></a><!-- raw HTML omitted --></td>
<td>Retrieves and decrypts a string.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsastoreprivatedata"><strong>LsaStorePrivateData</strong></a><!-- raw HTML omitted --></td>
<td>Encrypts and stores a string.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h3>Miscellaneous Functions</h3>
<p>The LSA Policy API has the following three functions that do not fit into any of the other LSA Policy function categories.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsaclose"><strong>LsaClose</strong></a><!-- raw HTML omitted --></td>
<td>Closes a handle to a <a href="policy-object.html"><strong>Policy</strong></a> object or a <a href="trusteddomain-object.html"><strong>TrustedDomain</strong></a> object.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsafreememory"><strong>LsaFreeMemory</strong></a><!-- raw HTML omitted --></td>
<td>Frees a buffer allocated by an LSA function.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nf-ntsecapi-lsantstatustowinerror"><strong>LsaNtStatusToWinError</strong></a><!-- raw HTML omitted --></td>
<td>Converts an <strong>NTSTATUS</strong> value to a Windows error code.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Managed Service Account Functions</h2>
<p>The following functions are used to create, enumerate, find, and delete managed service accounts.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Lmaccess/nf-lmaccess-netaddserviceaccount"><strong>NetAddServiceAccount</strong></a><!-- raw HTML omitted --></td>
<td>Creates a managed service account.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Lmaccess/nf-lmaccess-netenumerateserviceaccounts"><strong>NetEnumerateServiceAccounts</strong></a><!-- raw HTML omitted --></td>
<td>Enumerates the server accounts on the specified server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Lmaccess/nf-lmaccess-netisserviceaccount"><strong>NetIsServiceAccount</strong></a><!-- raw HTML omitted --></td>
<td>Tests whether the specified service account exists in the Netlogon store on the specified server.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Lmaccess/nf-lmaccess-netremoveserviceaccount"><strong>NetRemoveServiceAccount</strong></a><!-- raw HTML omitted --></td>
<td>Deletes the specified service account from the <a href="/windows/desktop/AD/active-directory-domain-services">Active Directory</a> database.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Password Filter Functions</h2>
<p>The following <a href="/windows/desktop/SecGloss/p-gly"><em>password filter</em></a> functions are implemented by custom password filter DLLs to provide password filtering and password change notification.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nc-ntsecapi-psam_init_notification_routine"><strong>InitializeChangeNotify</strong></a><!-- raw HTML omitted --></td>
<td>Indicates that a password filter DLL is initialized.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nc-ntsecapi-psam_password_notification_routine"><strong>PasswordChangeNotify</strong></a><!-- raw HTML omitted --></td>
<td>Indicates that a password has been changed.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/Ntsecapi/nc-ntsecapi-psam_password_filter_routine"><strong>PasswordFilter</strong></a><!-- raw HTML omitted --></td>
<td>Validates a new password based on password policy.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h2>Safer Functions</h2>
<p>The following Safer functions can be used to check the safer level of any executable and to log events.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/windows/desktop/api/WinSafer/nf-winsafer-safercloselevel"><strong>SaferCloseLevel</strong></a></td>
<td>Closes a SAFER_LEVEL_HANDLE opened by using the <a href="/windows/desktop/api/WinSafer/nf-winsafer-saferidentifylevel"><strong>SaferIdentifyLevel</strong></a> function or the <a href="/windows/desktop/api/WinSafer/nf-winsafer-safercreatelevel"><strong>SaferCreateLevel</strong></a> function.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/WinSafer/nf-winsafer-safercomputetokenfromlevel"><strong>SaferComputeTokenFromLevel</strong></a></td>
<td>Restricts a token using restrictions specified by a SAFER_LEVEL_HANDLE.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/WinSafer/nf-winsafer-safercreatelevel"><strong>SaferCreateLevel</strong></a></td>
<td>Opens a SAFER_LEVEL_HANDLE.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/WinSafer/nf-winsafer-safergetlevelinformation"><strong>SaferGetLevelInformation</strong></a></td>
<td>Retrieves information about a policy level.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/WinSafer/nf-winsafer-safergetpolicyinformation"><strong>SaferGetPolicyInformation</strong></a></td>
<td>Retrieves information about a policy.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/WinSafer/nf-winsafer-saferidentifylevel"><strong>SaferIdentifyLevel</strong></a></td>
<td>Retrieves information about a level.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/WinSafer/nf-winsafer-saferiisexecutablefiletype"><strong>SaferiIsExecutableFileType</strong></a></td>
<td>Determines whether a specified file is an executable file.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/WinSafer/nf-winsafer-saferrecordeventlogentry"><strong>SaferRecordEventLogEntry</strong></a></td>
<td>Sends a message to the event log.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/WinSafer/nf-winsafer-safersetlevelinformation"><strong>SaferSetLevelInformation</strong></a></td>
<td>Sets the information about a policy level.<!-- raw HTML omitted --></td>
</tr>
<tr>
<td><a href="/windows/desktop/api/WinSafer/nf-winsafer-safersetpolicyinformation"><strong>SaferSetPolicyInformation</strong></a></td>
<td>Sets the global policy controls.<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
</body>
