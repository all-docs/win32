<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Using the Formulas Element</title>
<style>
table th { border: 1px solid; }
table td { border: 1px solid; }
</style>
</head>
<body>
<hr />
<p>title: Using the Formulas Element
description: Using the Formulas Element
ms.assetid: f5a381b4-4132-4b66-b41a-3cada26b41e2
keywords:</p>
<ul>
<li>Web workshop,formulas element</li>
<li>designing Web pages,formulas element</li>
<li>Vector Markup Language (VML),formulas element</li>
<li>VML (Vector Markup Language),formulas element</li>
<li>vector graphics,formulas element</li>
<li>formulas element</li>
<li>VML elements,formulas</li>
<li>VML shapes,formulas element</li>
<li>Vector Markup Language (VML),defining paths for shapes</li>
<li>VML (Vector Markup Language),defining paths for shapes</li>
<li>vector graphics,defining paths for shapes</li>
<li>VML shapes,defining paths</li>
<li>defining paths for shapes
ms.topic: article
ms.date: 05/31/2018</li>
</ul>
<hr />
<h1>Using the Formulas Element</h1>
<p>This topic describes VML, a feature that is deprecated as of Windows Internet ExplorerÂ 9. Webpages and applications that rely on VML should be migrated to SVG or other widely supported standards.</p>
<blockquote>
<p>[!Note]<br />
As of December 2011, this topic has been archived. As a result, it is no longer actively maintained. For more information, see <a href="/previous-versions/windows/internet-explorer/ie-developer/">Archived Content</a>. For information, recommendations, and guidance regarding the current version of Windows Internet Explorer, see <a href="https://msdn.microsoft.com/ie/">Internet Explorer Developer Center</a>.</p>
</blockquote>
<p>Â </p>
<p>In this topic, we will illustrate how to use the <code>&amp;lt;formulas&amp;gt;</code> sub-element to define an adjustable path for a shape.</p>
<p>You can place the &lt;formulas&gt; sub-element inside <code>&lt;shape&gt;</code> or <code>&lt;shapetype&gt;</code> to define formulas that can vary the path of a shape. Inside the <code>&amp;lt;formulas&amp;gt;</code> sub-element, one <strong>f</strong> sub-element defines one formula so that one value is evaluated based upon that formula. For example, the formula, <code>&lt;v:f eqn=&quot;prod 10 4 5&quot;/&gt;</code> defines a value that is equivalent to &quot;10 x 4 / 5&quot;.</p>
<p>You can place many <strong>f</strong> sub-elements inside one<code>&amp;lt;formulas&amp;gt;</code> sub-element. Formulas can reference the values that are defined earlier in other formulas within the same <code>&amp;lt;formulas&amp;gt;</code> sub-element. The value that is defined in the first formula can be referred to as @0, the value that is defined in the second formula can be referred to as @1, and so on.</p>
<p>In addition, you can specify the <strong>adj</strong> property attribute of the <code>&lt;shape&gt;</code> element, such as adj=&quot;100, 200, 150&quot;. Inside the <code>&amp;lt;formulas&amp;gt;</code> element, you can then reference those values in the <strong>adj</strong> list. The first value (100) in the <strong>adj</strong> list can be referred to as #0, the second value (200) can be referred to as #1, and so on.</p>
<p>For example, to draw a smiling face, you can type the following VML representation:</p>
<p><img src="images/shape1f.gif" alt="shape1.gif (735 bytes)" /></p>
<pre lang="HTML"><code>&lt;v:shape style='width:1in;height:1in;' strokecolor=&quot;red&quot;
strokeweight=&quot;2pt&quot; coordsize=&quot;21600,21600&quot; adj=&quot;17520&quot;
path=&quot;m10800,0qx0,10800,10800,21600,21600,10800,10800,0xe
m7340,6445qx6215,7570,7340,8695,8465,7570,7340,6445xnfe
m14260,6445qx13135,7570,14260,8695,15385,7570,14260,6445xnfe
m4960@0c8853@3,12747@3,16640@0nfe&quot;&gt;
&lt;v:formulas&gt;
&lt;v:f eqn=&quot;sum 33030 0 #0&quot;/&gt;
&lt;v:f eqn=&quot;prod #0 4 3&quot;/&gt;
&lt;v:f eqn=&quot;prod @0 1 3&quot;/&gt;
&lt;v:f eqn=&quot;sum @1 0 @2&quot;/&gt;
&lt;/v:formulas&gt;
&lt;/v:shape&gt;
</code></pre>
<ul>
<li><code>adj=&quot;17520&quot;</code> defines a value (= 17520). This value can be referenced as #0.</li>
<li>The first formula, <code>&lt;v:f eqn=&quot;sum 33030 0 #0&quot;/&gt;</code>, defines the value (= 33030 + 0 - #0). This value can be referenced as @0.</li>
<li>The second formula, <code>&lt;v:f eqn=&quot;prod #0 4 3&quot;/&gt;</code>, defines the value (= #0 * 4 / 3). This value can be referenced as @1.</li>
<li>The third formula, <code>&lt;v:f eqn=&quot;prod @0 1 3&quot;/&gt;</code>, defines the value (= @0 * 1 / 3). This value can be referenced as @2.</li>
<li>The fourth formula, <code>&lt;v:f eqn=&quot;sum @1 0 @2&quot;/&gt;</code>, defines the value (=@1 + 0 -@2). This value can be referenced as @3.</li>
<li>Inside the <code>&lt;path&gt;</code> element, the values defined in the first (@0) and the fourth (@3) formulas are used to determine the outline of the shape.</li>
</ul>
<p>If you change the <strong>adj</strong> list, such as <code>adj=&quot;20000&quot;</code>, the values of the formulas that reference the <strong>adj</strong> list will be changed as well, affecting the smiling face as follows:</p>
<p><img src="images/shape2f.gif" alt="shape2.gif (765 bytes)" /></p>
<pre lang="HTML"><code>&lt;v:shape style='width:1in;height:1in;' strokecolor=&quot;red&quot;
strokeweight=&quot;2pt&quot; coordsize=&quot;21600,21600&quot; adj=&quot;20000&quot;
path=&quot;m10800,0qx0,10800,10800,21600,21600,10800,10800,0xe
m7340,6445qx6215,7570,7340,8695,8465,7570,7340,6445xnfe
m14260,6445qx13135,7570,14260,8695,15385,7570,14260,6445xnfe
m4960@0c8853@3,12747@3,16640@0nfe&quot;&gt;
&lt;v:formulas&gt;
&lt;v:f eqn=&quot;sum 33030 0 #0&quot;/&gt;
&lt;v:f eqn=&quot;prod #0 4 3&quot;/&gt;
&lt;v:f eqn=&quot;prod @0 1 3&quot;/&gt;
&lt;v:f eqn=&quot;sum @1 0 @2&quot;/&gt;
&lt;/v:formulas&gt;
&lt;/v:shape&gt;
</code></pre>
<p>For more information about this element, see the <a href="https://www.w3.org/TR/NOTE-VML#-toc416858392">VML specification</a> .</p>
<p>Â </p>
<p>Â </p>
</body>
